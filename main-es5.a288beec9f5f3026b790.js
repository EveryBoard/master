!function(){var e,t,n,r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_,E,b,P,S,O,T,I,A,M,x,R,N,D,L,F,U,V,B,z,H,G,$,Z,q,W,j,Y,K,Q,X,J,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,fe,he,de,ve,pe,ge,ye,me,ke,Ce,we,_e,Ee,be,Pe,Se,Oe,Te,Ie,Ae,Me,xe,Re,Ne,De,Le,Fe,Ue,Ve,Be,ze,He,Ge,$e,Ze,qe,We,je,Ye,Ke,Qe,Xe,Je,et,tt,nt,rt,it,at,ot,st,ut,ct,lt,ft,ht,dt,vt,pt,gt,yt,mt,kt,Ct,wt,_t,Et,bt,Pt,St,Ot,Tt,It,At,Mt,xt,Rt,Nt,Dt,Lt,Ft,Ut,Vt,Bt,zt,Ht,Gt,$t,Zt,qt,Wt,jt,Yt,Kt,Qt,Xt,Jt,en,tn,nn,rn,an,on,sn,un,cn,ln,fn,hn,dn,vn,pn,gn,yn,mn,kn,Cn,wn,_n,En,bn,Pn,Sn,On,Tn,In,An,Mn,xn,Rn,Nn,Dn,Ln,Fn,Un,Vn,Bn,zn,Hn,Gn,$n,Zn,qn,Wn,jn,Yn,Kn,Qn,Xn,Jn,er,tr,nr,rr,ir,ar,or,sr,ur,cr,lr,fr,hr,dr,vr,pr,gr,yr,mr,kr,Cr,wr,_r,Er,br,Pr,Sr,Or,Tr,Ir,Ar,Mr,xr,Rr,Nr,Dr,Lr,Fr,Ur,Vr,Br,zr,Hr,Gr,$r,Zr,qr,Wr,jr,Yr,Kr,Qr,Xr,Jr,ei,ti,ni,ri,ii,ai,oi,si,ui,ci,li,fi,hi,di,vi,pi,gi,yi,mi,ki,Ci,wi,_i,Ei,bi,Pi,Si,Oi,Ti,Ii,Ai,Mi,xi,Ri,Ni,Di,Li,Fi,Ui,Vi,Bi,zi,Hi,Gi,$i,Zi,qi,Wi,ji,Yi,Ki,Qi,Xi,Ji,ea,ta,na,ra,ia,aa,oa,sa,ua,ca,la,fa,ha,da,va,pa,ga,ya,ma,ka,Ca,wa,_a,Ea,ba,Pa,Sa,Oa,Ta,Ia,Aa,Ma,xa,Ra,Na,Da,La,Fa,Ua,Va,Ba,za,Ha,Ga,$a,Za,qa,Wa,ja,Ya,Ka,Qa,Xa,Ja,eo,to,no,ro,io,ao,oo,so,uo,co,lo,fo,ho,vo,po,go,yo,mo,ko,Co,wo,_o,Eo,bo,Po,So,Oo,To,Io,Ao,Mo,xo,Ro,No,Do,Lo,Fo,Uo,Vo,Bo,zo,Ho,Go,$o,Zo,qo,Wo,jo,Yo,Ko,Qo,Xo,Jo,es,ts,ns,rs,is,as,os,ss,us,cs,ls,fs,hs,ds,vs,ps,gs,ys,ms,ks,Cs,ws,_s,Es,bs,Ps,Ss,Os,Ts,Is,As,Ms,xs,Rs,Ns,Ds,Ls,Fs,Us,Vs,Bs,zs,Hs,Gs,$s,Zs,qs,Ws,js,Ys,Ks,Qs,Xs,Js,eu,tu,nu,ru,iu,au,ou,su,uu,cu,lu,fu,hu,du,vu,pu,gu,yu,mu,ku,Cu,wu,_u,Eu,bu,Pu,Su,Ou,Tu,Iu,Au,Mu,xu,Ru,Nu,Du,Lu,Fu,Uu,Vu,Bu,zu,Hu,Gu,$u,Zu,qu,Wu,ju,Yu,Ku,Qu,Xu,Ju,ec,tc,nc,rc,ic,ac,oc,sc,uc,cc,lc,fc,hc,dc,vc,pc,gc,yc,mc,kc,Cc,wc,_c,Ec,bc,Pc,Sc,Oc,Tc,Ic,Ac,Mc,xc,Rc,Nc,Dc,Lc,Fc,Uc,Vc,Bc,zc,Hc,Gc,$c,Zc,qc,Wc,jc,Yc,Kc,Qc,Xc,Jc,el,tl,nl,rl,il,al,ol,sl,ul,cl,ll,fl,hl,dl,vl,pl,gl,yl,ml,kl,Cl,wl,_l,El,bl,Pl,Sl,Ol,Tl,Il,Al,Ml,xl,Rl,Nl,Dl,Ll,Fl,Ul,Vl,Bl,zl,Hl,Gl,$l,Zl,ql,Wl,jl,Yl,Kl,Ql,Xl,Jl,ef,tf,nf,rf,af,of,sf,uf,cf,lf,ff,hf,df,vf,pf,gf,yf,mf,kf,Cf,wf,_f,Ef,bf,Pf,Sf,Of,Tf,If,Af,Mf,xf,Rf,Nf,Df,Lf,Ff,Uf,Vf,Bf,zf,Hf,Gf,$f,Zf,qf,Wf,jf,Yf,Kf,Qf,Xf,Jf,eh,th,nh,rh,ih,ah,oh,sh,uh,ch,lh,fh,hh,dh,vh,ph,gh,yh,mh,kh,Ch,wh,_h,Eh,bh,Ph,Sh,Oh,Th,Ih,Ah,Mh,xh,Rh,Nh,Dh,Lh,Fh,Uh,Vh,Bh,zh,Hh,Gh,$h,Zh,qh,Wh,jh,Yh,Kh,Qh,Xh,Jh,ed,td,nd,rd,id,ad,od,sd,ud,cd,ld,fd,hd,dd,vd,pd,gd,yd,md,kd,Cd,wd,_d,Ed,bd,Pd,Sd,Od,Td,Id,Ad,Md,xd,Rd,Nd,Dd,Ld,Fd,Ud,Vd,Bd,zd,Hd,Gd,$d,Zd,qd,Wd,jd,Yd,Kd,Qd,Xd,Jd,ev,tv,nv,rv,iv,av,ov,sv,uv,cv,lv,fv,hv,dv,vv,pv,gv,yv,mv,kv,Cv,wv,_v,Ev,bv,Pv,Sv,Ov,Tv,Iv,Av,Mv,xv,Rv,Nv,Dv,Lv,Fv,Uv,Vv,Bv,zv,Hv,Gv,$v,Zv,qv,Wv,jv,Yv,Kv,Qv,Xv,Jv,ep,tp,np,rp,ip,ap,op,sp,up,cp,lp,fp,hp,dp,vp,pp,gp,yp,mp,kp,Cp,wp,_p,Ep,bp,Pp,Sp,Op,Tp,Ip,Ap,Mp,xp,Rp,Np,Dp,Lp,Fp,Up,Vp,Bp,zp,Hp,Gp,$p,Zp,qp,Wp,jp,Yp,Kp,Qp,Xp,Jp,eg,tg,ng,rg,ig,ag,og,sg,ug,cg,lg,fg,hg,dg,vg,pg,gg,yg,mg,kg,Cg,wg,_g,Eg,bg,Pg,Sg,Og,Tg,Ig,Ag,Mg,xg,Rg,Ng,Dg,Lg,Fg,Ug,Vg,Bg,zg,Hg,Gg,$g,Zg;function qg(e){return Jg(e)||hy(e)||vy(e)||Xg()}function Wg(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function jg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Yg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jg(Object(n),!0).forEach(function(t){Kg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Kg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qg(e,t){return Jg(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||vy(e,t)||Xg()}function Xg(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Jg(e){if(Array.isArray(e))return e}function ey(e){var t="function"==typeof Map?new Map:void 0;return ey=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return ty(e,arguments,ly(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),ay(r,e)},ey(e)}function ty(e,t,n){return ty=cy()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&ay(i,n.prototype),i},ty.apply(null,arguments)}function ny(){return ny="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=ry(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},ny.apply(this,arguments)}function ry(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ly(e)););return e}function iy(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ay(e,t)}function ay(e,t){return ay=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ay(e,t)}function oy(e){var t=cy();return function(){var n,r=ly(e);if(t){var i=ly(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return sy(this,n)}}function sy(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return uy(e)}function uy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function ly(e){return ly=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ly(e)}function fy(e){return function(e){if(Array.isArray(e))return py(e)}(e)||hy(e)||vy(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hy(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function dy(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=vy(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function vy(e,t){if(e){if("string"==typeof e)return py(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?py(e,t):void 0}}function py(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function my(e,t,n){return t&&yy(e.prototype,t),n&&yy(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,a;!function(o){if("object"==typeof e.exports){var s=o(0,t);void 0!==s&&(e.exports=s)}else i=[n,t],void 0!==(a="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=a)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++){var i;n=null!==(i=arguments[r])&&void 0!==i?i:{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e;return null!==(e=f)&&void 0!==e?e:document}var u={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},u),l={},f=null,h=function(){function e(t){var n=this;r(this,e),this.element=s().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),a=["notification",this.extraClasses];if(this.type&&a.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),u=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";a.push("animate__animated ".concat(o," ").concat(u)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=a.join(" "),this.dismissible){var c=s().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var l=new d(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){l.pause()}),this.element.addEventListener("mouseout",function(){l.resume()}))}return a(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete l.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete l.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),d=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return a(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},u)},e.setDefaults=function(e){c=n(n({},u),e)},e.setDoc=function(e){for(var t in l)l[t].remove();l={},f=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new h(t),i=function(e,t,n,r,i,a){if(l.position)return l.position;var o=s().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,a)),e.appendChild(o),l.position=o,o}(t.appendTo||s().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var a=i.lastElementChild;a;)i.removeChild(a),a=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},2791:function(jg,Xg,Jg){"use strict";var ry,ay;function cy(e){return"function"==typeof e}function hy(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var vy=hy(function(e){return function(t){e(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t}});function py(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var yy=function(){function e(t){gy(this,e),this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return my(e,[{key:"unsubscribe",value:function(){var e;if(!this.closed){this.closed=!0;var t=this._parentage;if(t)if(this._parentage=null,Array.isArray(t)){var n,r=dy(t);try{for(r.s();!(n=r.n()).done;){var i;n.value.remove(this)}}catch(f){r.e(f)}finally{r.f()}}else t.remove(this);var a=this.initialTeardown;if(cy(a))try{a()}catch(i){e=i instanceof vy?i.errors:[i]}var o=this._teardowns;if(o){this._teardowns=null;var s,u=dy(o);try{for(u.s();!(s=u.n()).done;){var c=s.value;try{wy(c)}catch(h){var l;e=null!==(l=e)&&void 0!==l?l:[],h instanceof vy?e=[].concat(fy(e),fy(h.errors)):e.push(h)}}}catch(f){u.e(f)}finally{u.f()}}if(e)throw new vy(e)}}},{key:"add",value:function(t){var n;if(t&&t!==this)if(this.closed)wy(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}},{key:"_hasParent",value:function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)}},{key:"_addParent",value:function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}},{key:"_removeParent",value:function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&py(t,e)}},{key:"remove",value:function(t){var n=this._teardowns;n&&py(n,t),t instanceof e&&t._removeParent(this)}}]),e}();yy.EMPTY=function(){var e=new yy;return e.closed=!0,e}();var ky=yy.EMPTY;function Cy(e){return e instanceof yy||e&&"closed"in e&&cy(e.remove)&&cy(e.add)&&cy(e.unsubscribe)}function wy(e){cy(e)?e():e.unsubscribe()}var _y=null,Ey=null,by=void 0,Py=!1,Sy=!1,Oy={setTimeout:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Oy.delegate;return((null==e?void 0:e.setTimeout)||setTimeout).apply(void 0,arguments)}),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=Oy.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)}),delegate:void 0};function Ty(e){Oy.setTimeout(function(){if(!_y)throw e;_y(e)})}function Iy(){}var Ay=My("C",void 0,void 0);function My(e,t,n){return{kind:e,value:t,error:n}}var xy=null;function Ry(e){if(Py){var t=!xy;if(t&&(xy={errorThrown:!1,error:null}),e(),t){var n=xy,r=n.errorThrown,i=n.error;if(xy=null,r)throw i}}else e()}var Ny=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).isStopped=!1,e?(r.destination=e,Cy(e)&&e.add(uy(r))):r.destination=Vy,r}return my(n,[{key:"next",value:function(e){this.isStopped?Uy(My("N",e,void 0),this):this._next(e)}},{key:"error",value:function(e){this.isStopped?Uy(My("E",void 0,e),this):(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped?Uy(Ay,this):(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,ny(ly(n.prototype),"unsubscribe",this).call(this),this.destination=null)}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){try{this.destination.error(e)}finally{this.unsubscribe()}}},{key:"_complete",value:function(){try{this.destination.complete()}finally{this.unsubscribe()}}}],[{key:"create",value:function(e,t,n){return new Dy(e,t,n)}}]),n}(yy),Dy=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a,o,s;if(gy(this,n),o=t.call(this),cy(e))s=e;else if(e){var u,c;s=(u=e).next,r=u.error,i=u.complete,uy(o)&&Sy?(c=Object.create(e)).unsubscribe=function(){return o.unsubscribe()}:c=e,s=null==s?void 0:s.bind(c),r=null==r?void 0:r.bind(c),i=null==i?void 0:i.bind(c)}return o.destination={next:s?Ly(s):Iy,error:Ly(null!==(a=r)&&void 0!==a?a:Fy),complete:i?Ly(i):Iy},sy(o)}return my(n)}(Ny);function Ly(e,t){return function(){try{e.apply(void 0,arguments)}catch(t){Py?function(e){Py&&xy&&(xy.errorThrown=!0,xy.error=e)}(t):Ty(t)}}}function Fy(e){throw e}function Uy(e,t){var n=Ey;n&&Oy.setTimeout(function(){return n(e,t)})}var Vy={closed:!0,next:Iy,error:Fy,complete:Iy},By="function"==typeof Symbol&&Symbol.observable||"@@observable";function zy(e){return e}var Hy=function(){var e=function(){function e(t){gy(this,e),t&&(this._subscribe=t)}return my(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this,i=function(e){return e&&e instanceof Ny||function(e){return e&&cy(e.next)&&cy(e.error)&&cy(e.complete)}(e)&&Cy(e)}(e)?e:new Dy(e,t,n);return Ry(function(){var e=r.operator,t=r.source;i.add(e?e.call(i,t):t?r._subscribe(i):r._trySubscribe(i))}),i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){e.error(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=Gy(t))(function(t,r){var i=new Dy({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})}},{key:"_subscribe",value:function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}},{key:By,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return 0===e.length?zy:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=Gy(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),e}();return e.create=function(t){return new e(t)},e}();function Gy(e){var t;return null!==(t=null!=e?e:by)&&void 0!==t?t:Promise}var $y=hy(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Zy=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.call(this)).closed=!1,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return my(n,[{key:"lift",value:function(e){var t=new qy(this,this);return t.operator=e,t}},{key:"_throwIfClosed",value:function(){if(this.closed)throw new $y}},{key:"next",value:function(e){var t=this;Ry(function(){if(t._throwIfClosed(),!t.isStopped){var n,r=dy(t.observers.slice());try{for(r.s();!(n=r.n()).done;){n.value.next(e)}}catch(i){r.e(i)}finally{r.f()}}})}},{key:"error",value:function(e){var t=this;Ry(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})}},{key:"complete",value:function(){var e=this;Ry(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})}},{key:"unsubscribe",value:function(){this.isStopped=this.closed=!0,this.observers=null}},{key:"observed",get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}},{key:"_trySubscribe",value:function(e){return this._throwIfClosed(),ny(ly(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}},{key:"_innerSubscribe",value:function(e){var t=this.hasError,n=this.isStopped,r=this.observers;return t||n?ky:(r.push(e),new yy(function(){return py(r,e)}))}},{key:"_checkFinalizedStatuses",value:function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()}},{key:"asObservable",value:function(){var e=new Hy;return e.source=this,e}}]),n}(Hy);return e.create=function(e,t){return new qy(e,t)},e}(),qy=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).destination=e,i.source=r,i}return my(n,[{key:"next",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}},{key:"error",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}},{key:"complete",value:function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}},{key:"_subscribe",value:function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:ky}}]),n}(Zy);function Wy(e){return cy(null==e?void 0:e.lift)}function jy(e){return function(t){if(Wy(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var Yy=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o){var s,u,c,l;return gy(this,n),(l=t.call(this,e)).onFinalize=o,l._next=r?function(t){try{r(t)}catch(n){e.error(n)}}:ny((s=uy(l),ly(n.prototype)),"_next",s),l._error=a?function(t){try{a(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:ny((u=uy(l),ly(n.prototype)),"_error",u),l._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:ny((c=uy(l),ly(n.prototype)),"_complete",c),l}return my(n,[{key:"unsubscribe",value:function(){var e,t=this.closed;ny(ly(n.prototype),"unsubscribe",this).call(this),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}]),n}(Ny);function Ky(e,t){return jy(function(n,r){var i=0;n.subscribe(new Yy(r,function(n){r.next(e.call(t,n,i++))}))})}function Qy(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Xy(e){return this instanceof Xy?(this.v=e,this):new Xy(e)}function Jy(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof Xy?Promise.resolve(e.value.v).then(u,c):l(a[0][2],e)}(i[e](t))}catch(n){l(a[0][3],n)}}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function em(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}var tm=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function nm(e){return cy(null==e?void 0:e.then)}function rm(e){return cy(e[By])}function im(e){return Symbol.asyncIterator&&cy(null==e?void 0:e[Symbol.asyncIterator])}function am(e){return new TypeError("You provided ".concat(null!==e&&"object"==typeof e?"an invalid object":"'".concat(e,"'")," where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable."))}var om="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function sm(e){return cy(null==e?void 0:e[om])}function um(e){return Jy(this,arguments,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getReader(),t.prev=1;case 2:return t.next=4,Xy(n.read());case 4:if(r=t.sent,i=r.value,!r.done){t.next=11;break}return t.next=10,Xy(void 0);case 10:return t.abrupt("return",t.sent);case 11:return t.next=13,Xy(i);case 13:return t.next=15,t.sent;case 15:t.next=2;break;case 17:return t.prev=17,n.releaseLock(),t.finish(17);case 20:case"end":return t.stop()}},t,null,[[1,,17,20]])}))}function cm(e){return cy(null==e?void 0:e.getReader)}function lm(e){if(e instanceof Hy)return e;if(null!=e){if(rm(e))return function(e){return new Hy(function(t){var n=e[By]();if(cy(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(tm(e))return function(e){return new Hy(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(nm(e))return function(e){return new Hy(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,Ty)})}(e);if(im(e))return fm(e);if(sm(e))return function(e){return new Hy(function(t){var n,r=dy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.next(i),t.closed)return}}catch(a){r.e(a)}finally{r.f()}t.complete()})}(e);if(cm(e))return function(e){return fm(um(e))}(e)}throw am(e)}function fm(e){return new Hy(function(t){(function(e,t){var n,r,i,a;return function(e,t,n,r){return new(n||(n=Promise))(function(t,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function o(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,o)}s((r=r.apply(e,[])).next())})}(this,0,void 0,regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,n=em(e);case 2:return o.next=4,n.next();case 4:if((r=o.sent).done){o.next=9;break}if(t.next(r.value),!t.closed){o.next=7;break}return o.abrupt("return");case 7:o.next=2;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),i={error:o.t0};case 14:if(o.prev=14,o.prev=15,o.t1=r&&!r.done&&(a=n.return),!o.t1){o.next=20;break}return o.next=20,a.call(n);case 20:if(o.prev=20,!i){o.next=23;break}throw i.error;case 23:return o.finish(20);case 24:return o.finish(14);case 25:t.complete();case 26:case"end":return o.stop()}},o,null,[[0,11,14,25],[15,,20,24]])}))})(e,t).catch(function(e){return t.error(e)})})}function hm(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function dm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return cy(t)?dm(function(n,r){return Ky(function(e,i){return t(n,e,r,i)})(lm(e(n,r)))},n):("number"==typeof t&&(n=t),jy(function(t,r){return function(e,t,n,r,i,a,o,s){var u=[],c=0,l=0,f=!1,h=function(){f&&!u.length&&!c&&t.complete()},d=function e(i){c++;var a=!1;lm(n(i,l++)).subscribe(new Yy(t,function(e){t.next(e)},function(){a=!0},void 0,function(){if(a)try{for(c--;u.length&&c<r;){var n=u.shift();e(n)}h()}catch(n){t.error(n)}}))};return e.subscribe(new Yy(t,function(e){return c<r?d(e):u.push(e)},function(){f=!0,h()})),function(){}}(t,r,e,n)}))}function vm(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return dm(zy,e)}var pm=new Hy(function(e){return e.complete()});function gm(e){return e[e.length-1]}function ym(e){return cy(gm(e))?e.pop():void 0}function mm(e){return function(e){return e&&cy(e.schedule)}(gm(e))?e.pop():void 0}function km(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return jy(function(n,r){n.subscribe(new Yy(r,function(n){return hm(r,e,function(){return r.next(n)},t)},function(){return hm(r,e,function(){return r.complete()},t)},function(n){return hm(r,e,function(){return r.error(n)},t)}))})}function Cm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return jy(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function wm(e,t){if(!e)throw new Error("Iterable cannot be null");return new Hy(function(n){hm(n,t,function(){var r=e[Symbol.asyncIterator]();hm(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function _m(e,t){return t?function(e,t){if(null!=e){if(rm(e))return function(e,t){return lm(e).pipe(Cm(t),km(t))}(e,t);if(tm(e))return function(e,t){return new Hy(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(nm(e))return function(e,t){return lm(e).pipe(Cm(t),km(t))}(e,t);if(im(e))return wm(e,t);if(sm(e))return function(e,t){return new Hy(function(n){var r;return hm(n,t,function(){r=e[om](),hm(n,t,function(){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(a){return void n.error(a)}t?n.complete():n.next(e)},0,!0)}),function(){return cy(null==r?void 0:r.return)&&r.return()}})}(e,t);if(cm(e))return function(e,t){return wm(um(e),t)}(e,t)}throw am(e)}(e,t):lm(e)}function Em(e){return e<=0?function(){return pm}:jy(function(t,n){var r=0;t.subscribe(new Yy(n,function(t){++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function bm(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return!0===t?(e(),null):!1===t?null:t.apply(void 0,r).pipe(Em(1)).subscribe(function(){return e()})}function Pm(e){for(var t in e)if(e[t]===Pm)return t;throw Error("Could not find renamed property on target object.")}function Sm(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Om(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Om).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function Tm(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var Im=Pm({__forward_ref__:Pm});function Am(e){return e.__forward_ref__=Am,e.toString=function(){return Om(this())},e}function Mm(e){return xm(e)?e():e}function xm(e){return"function"==typeof e&&e.hasOwnProperty(Im)&&e.__forward_ref__===Am}var Rm=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),i=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,r)),i.code=e,i}return my(n)}(ey(Error));function Nm(e){return"string"==typeof e?e:null==e?"":String(e)}function Dm(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Nm(e)}function Lm(e,t){var n=t?" in ".concat(t):"";throw new Rm("201","No provider for ".concat(Dm(e)," found").concat(n))}function Fm(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat(e)+(null==r?"":" [Expected=> ".concat(n," ").concat(r," ").concat(t," <=Actual]")))}function Um(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Vm(e){return{providers:e.providers||[],imports:e.imports||[]}}function Bm(e){return zm(e,$m)||zm(e,qm)}function zm(e,t){return e.hasOwnProperty(t)?e[t]:null}function Hm(e){return e&&(e.hasOwnProperty(Zm)||e.hasOwnProperty(Wm))?e[Zm]:null}var Gm,$m=Pm({"\u0275prov":Pm}),Zm=Pm({"\u0275inj":Pm}),qm=Pm({ngInjectableDef:Pm}),Wm=Pm({ngInjectorDef:Pm}),jm=((jm=jm||{})[jm.Default=0]="Default",jm[jm.Host=1]="Host",jm[jm.Self=2]="Self",jm[jm.SkipSelf=4]="SkipSelf",jm[jm.Optional=8]="Optional",jm);function Ym(e){var t=Gm;return Gm=e,t}function Km(e,t,n){var r=Bm(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&jm.Optional?null:void 0!==t?t:void Lm(Om(e),"Injector")}function Qm(e){return{toString:e}.toString()}var Xm=((Xm=Xm||{})[Xm.OnPush=0]="OnPush",Xm[Xm.Default=1]="Default",Xm),Jm=((Jm=Jm||{})[Jm.Emulated=0]="Emulated",Jm[Jm.None=2]="None",Jm[Jm.ShadowDom=3]="ShadowDom",Jm),ek="undefined"!=typeof globalThis&&globalThis,tk="undefined"!=typeof window&&window,nk="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,rk=ek||"undefined"!=typeof global&&global||tk||nk,ik={},ak=[],ok=Pm({"\u0275cmp":Pm}),sk=Pm({"\u0275dir":Pm}),uk=Pm({"\u0275pipe":Pm}),ck=Pm({"\u0275mod":Pm}),lk=Pm({"\u0275loc":Pm}),fk=Pm({"\u0275fac":Pm}),hk=Pm({__NG_ELEMENT_ID__:Pm}),dk=0;function vk(e){return Qm(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Xm.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||ak,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Jm.Emulated,id:"c",styles:e.styles||ak,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,a=e.pipes;return n.id+=dk++,n.inputs=kk(e.inputs,t),n.outputs=kk(e.outputs),i&&i.forEach(function(e){return e(n)}),n.directiveDefs=r?function(){return("function"==typeof r?r():r).map(pk)}:null,n.pipeDefs=a?function(){return("function"==typeof a?a():a).map(gk)}:null,n})}function pk(e){return _k(e)||function(e){return e[sk]||null}(e)}function gk(e){return function(e){return e[uk]||null}(e)}var yk={};function mk(e){return Qm(function(){var t={type:e.type,bootstrap:e.bootstrap||ak,declarations:e.declarations||ak,imports:e.imports||ak,exports:e.exports||ak,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(yk[e.id]=e.type),t})}function kk(e,t){if(null==e)return ik;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=i;Array.isArray(i)&&(a=i[1],i=i[0]),n[i]=r,t&&(t[i]=a)}return n}var Ck=vk;function wk(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function _k(e){return e[ok]||null}function Ek(e,t){var n=e[ck]||null;if(!n&&!0===t)throw new Error("Type ".concat(Om(e)," does not have '\u0275mod' property."));return n}function bk(e){return Array.isArray(e)&&"object"==typeof e[1]}function Pk(e){return Array.isArray(e)&&!0===e[1]}function Sk(e){return 0!=(8&e.flags)}function Ok(e){return 2==(2&e.flags)}function Tk(e){return 1==(1&e.flags)}function Ik(e){return null!==e.template}function Ak(e){return 0!=(512&e[2])}function Mk(e,t){return e.hasOwnProperty(fk)?e[fk]:null}var xk=function(){function e(t,n,r){gy(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return my(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function Rk(){return Nk}function Nk(e){return e.type.prototype.ngOnChanges&&(e.setInput=Lk),Dk}function Dk(){var e=Uk(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===ik)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function Lk(e,t,n,r){var i=Uk(e)||function(e,t){return e[Fk]=t}(e,{previous:ik,current:null}),a=i.current||(i.current={}),o=i.previous,s=this.declaredInputs[n],u=o[s];a[s]=new xk(u&&u.currentValue,t,o===ik),e[r]=t}Rk.ngInherit=!0;var Fk="__ngSimpleChanges__";function Uk(e){return e[Fk]||null}var Vk,Bk="http://www.w3.org/2000/svg";function zk(){return void 0!==Vk?Vk:"undefined"!=typeof document?document:void 0}function Hk(e){return!!e.listen}var Gk={createRenderer:function(e,t){return zk()}};function $k(e){for(;Array.isArray(e);)e=e[0];return e}function Zk(e,t){return $k(t[e])}function qk(e,t){return $k(t[e.index])}function Wk(e,t){return e.data[t]}function jk(e,t){return e[t]}function Yk(e,t){var n=t[e];return bk(n)?n:n[0]}function Kk(e){return 4==(4&e[2])}function Qk(e){return 128==(128&e[2])}function Xk(e,t){return null==t?null:e[t]}function Jk(e){e[18]=0}function eC(e,t){e[5]+=t;for(var n=e,r=e[3];null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}var tC={lFrame:OC(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function nC(){return tC.bindingsEnabled}function rC(){return tC.lFrame.lView}function iC(){return tC.lFrame.tView}function aC(e){return tC.lFrame.contextLView=e,e[8]}function oC(){for(var e=sC();null!==e&&64===e.type;)e=e.parent;return e}function sC(){return tC.lFrame.currentTNode}function uC(){var e=tC.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function cC(e,t){var n=tC.lFrame;n.currentTNode=e,n.isParent=t}function lC(){return tC.lFrame.isParent}function fC(){tC.lFrame.isParent=!1}function hC(){return tC.isInCheckNoChangesMode}function dC(e){tC.isInCheckNoChangesMode=e}function vC(){var e=tC.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function pC(){return tC.lFrame.bindingIndex}function gC(){return tC.lFrame.bindingIndex++}function yC(e){var t=tC.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function mC(e){tC.lFrame.inI18n=e}function kC(e,t){var n=tC.lFrame;n.bindingIndex=n.bindingRootIndex=e,CC(t)}function CC(e){tC.lFrame.currentDirectiveIndex=e}function wC(){return tC.lFrame.currentQueryIndex}function _C(e){tC.lFrame.currentQueryIndex=e}function EC(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function bC(e,t,n){if(n&jm.SkipSelf){for(var r=t,i=e;!(null!==(r=r.parent)||n&jm.Host||(r=EC(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}var a=tC.lFrame=SC();return a.currentTNode=t,a.lView=e,!0}function PC(e){var t=SC(),n=e[1];tC.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function SC(){var e=tC.lFrame,t=null===e?null:e.child;return null===t?OC(e):t}function OC(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function TC(){var e=tC.lFrame;return tC.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var IC=TC;function AC(){var e=TC();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function MC(){return tC.lFrame.selectedIndex}function xC(e){tC.lFrame.selectedIndex=e}function RC(){var e=tC.lFrame;return Wk(e.tView,e.selectedIndex)}function NC(){tC.lFrame.currentNamespace=Bk}function DC(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n].type.prototype,a=i.ngAfterContentInit,o=i.ngAfterContentChecked,s=i.ngAfterViewInit,u=i.ngAfterViewChecked,c=i.ngOnDestroy;a&&(e.contentHooks||(e.contentHooks=[])).push(-n,a),o&&((e.contentHooks||(e.contentHooks=[])).push(n,o),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function LC(e,t,n){VC(e,t,3,n)}function FC(e,t,n,r){(3&e[2])===n&&VC(e,t,n,r)}function UC(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function VC(e,t,n,r){for(var i=null!=r?r:-1,a=t.length-1,o=0,s=void 0!==r?65535&e[18]:0;s<a;s++)if("number"==typeof t[s+1]){if(o=t[s],null!=r&&o>=r)break}else t[s]<0&&(e[18]+=65536),(o<i||-1==i)&&(BC(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function BC(e,t,n,r){var i=n[r]<0,a=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(o)}finally{}}}else try{a.call(o)}finally{}}var zC=my(function e(t,n,r){gy(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r});function HC(e,t,n){for(var r=Hk(e),i=0;i<n.length;){var a=n[i];if("number"==typeof a){if(0!==a)break;i++;var o=n[i++],s=n[i++],u=n[i++];r?e.setAttribute(t,s,u,o):t.setAttributeNS(o,s,u)}else{var c=a,l=n[++i];$C(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),i++}}return i}function GC(e){return 3===e||4===e||6===e}function $C(e){return 64===e.charCodeAt(0)}function ZC(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||qC(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function qC(e,t,n,r,i){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var u=e[a];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(e[a+1]=i));if(r===e[a+1])return void(e[a+2]=i)}a++,null!==r&&a++,null!==i&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==r&&e.splice(a++,0,r),null!==i&&e.splice(a++,0,i)}function WC(e){return-1!==e}function jC(e){return 32767&e}function YC(e,t){for(var n=function(e){return e>>16}(e),r=t;n>0;)r=r[15],n--;return r}var KC=!0;function QC(e){var t=KC;return KC=e,t}var XC=0;function JC(e,t){var n=tw(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,ew(r.data,e),ew(t,null),ew(r.blueprint,null));var i=nw(e,t),a=e.injectorIndex;if(WC(i))for(var o=jC(i),s=YC(i,t),u=s[1].data,c=0;c<8;c++)t[a+c]=s[o+c]|u[o+c];return t[a+8]=i,a}function ew(e,t){e.push(0,0,0,0,0,0,0,0,t)}function tw(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function nw(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,r=null,i=t;null!==i;){var a=i[1],o=a.type;if(null===(r=2===o?a.declTNode:1===o?i[6]:null))return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function rw(e,t,n){!function(e,t,n){var r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(hk)&&(r=n[hk]),null==r&&(r=n[hk]=XC++);var i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function iw(e,t,n){if(n&jm.Optional)return e;Lm(t,"NodeInjector")}function aw(e,t,n,r){if(n&jm.Optional&&void 0===r&&(r=null),0==(n&(jm.Self|jm.Host))){var i=e[9],a=Ym(void 0);try{return i?i.get(t,r,n&jm.Optional):Km(t,r,n&jm.Optional)}finally{Ym(a)}}return iw(r,t,n)}function ow(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:jm.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(hk)?e[hk]:void 0;return"number"==typeof t?t>=0?255&t:uw:t}(n);if("function"==typeof a){if(!bC(t,e,r))return r&jm.Host?iw(i,n,r):aw(t,n,r,i);try{var o=a(r);if(null!=o||r&jm.Optional)return o;Lm(n)}finally{IC()}}else if("number"==typeof a){var s=null,u=tw(e,t),c=-1,l=r&jm.Host?t[16][6]:null;for((-1===u||r&jm.SkipSelf)&&(-1!==(c=-1===u?nw(e,t):t[u+8])&&dw(r,!1)?(s=t[1],u=jC(c),t=YC(c,t)):u=-1);-1!==u;){var f=t[1];if(hw(a,u,f.data)){var h=cw(u,t,n,s,r,l);if(h!==sw)return h}-1!==(c=t[u+8])&&dw(r,t[1].data[u+8]===l)&&hw(a,u,t)?(s=f,u=jC(c),t=YC(c,t)):u=-1}}}return aw(t,n,r,i)}var sw={};function uw(){return new vw(oC(),rC())}function cw(e,t,n,r,i,a){var o=t[1],s=o.data[e+8],u=lw(s,o,n,null==r?Ok(s)&&KC:r!=o&&0!=(3&s.type),i&jm.Host&&a===s);return null!==u?fw(t,o,u,s):sw}function lw(e,t,n,r,i){for(var a=e.providerIndexes,o=t.data,s=1048575&a,u=e.directiveStart,c=a>>20,l=i?s+c:e.directiveEnd,f=r?s:s+c;f<l;f++){var h=o[f];if(f<u&&n===h||f>=u&&h.type===n)return f}if(i){var d=o[u];if(d&&Ik(d)&&d.type===n)return u}return null}function fw(e,t,n,r){var i=e[n],a=t.data;if(function(e){return e instanceof zC}(i)){var o=i;o.resolving&&function(e,t){throw new Rm("200","Circular dependency in DI detected for ".concat(e))}(Dm(a[n]));var s=QC(o.canSeeViewProviders);o.resolving=!0;var u=o.injectImpl?Ym(o.injectImpl):null;bC(e,r,jm.Default);try{i=e[n]=o.factory(void 0,a,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.type.prototype,i=r.ngOnChanges,a=r.ngOnInit,o=r.ngDoCheck;if(i){var s=Nk(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,a[n],t)}finally{null!==u&&Ym(u),QC(s),o.resolving=!1,IC()}}return i}function hw(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function dw(e,t){return!(e&jm.Self||e&jm.Host&&t)}var vw=function(){function e(t,n){gy(this,e),this._tNode=t,this._lView=n}return my(e,[{key:"get",value:function(e,t,n){return ow(this._tNode,this._lView,e,n,t)}}]),e}();function pw(e){return Qm(function(){for(var t=e.prototype.constructor,n=t[fk]||gw(t),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;i&&i!==r;){var a=i[fk]||gw(i);if(a&&a!==n)return a;i=Object.getPrototypeOf(i)}return function(e){return new e}})}function gw(e){return xm(e)?function(){var t=gw(Mm(e));return t&&t()}:Mk(e)}function yw(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var r=n.length,i=0;i<r;){var a=n[i];if(GC(a))break;if(0===a)i+=2;else if("number"==typeof a)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(a===t)return n[i+1];i+=2}}return null}(oC(),e)}var mw="__parameters__";function kw(e,t,n){return Qm(function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var a=ty(i,t);return o.annotation=a,o;function o(e,t,n){for(var r=e.hasOwnProperty(mw)?e[mw]:Object.defineProperty(e,mw,{value:[]})[mw];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(a),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var Cw=function(){function e(t,n){gy(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Um({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return my(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),ww=new Cw("AnalyzeForEntryComponents"),_w=Function;function Ew(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),Ew(r,t)):t!==e&&t.push(r)}return t}function bw(e,t){e.forEach(function(e){return Array.isArray(e)?bw(e,t):t(e)})}function Pw(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function Sw(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function Ow(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function Tw(e,t,n){var r=Aw(e,t);return r>=0?e[1|r]=n:function(e,t,n,r){var i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r=~r,t,n),r}function Iw(e,t){var n=Aw(e,t);if(n>=0)return e[1|n]}function Aw(e,t){return function(e,t,n){for(var r=0,i=e.length>>1;i!==r;){var a=r+(i-r>>1),o=e[a<<1];if(t===o)return a<<1;o>t?i=a:r=a+1}return~(i<<1)}(e,t)}var Mw,xw={},Rw="__NG_DI_FLAG__",Nw="ngTempTokenPath",Dw=/\n/gm,Lw="__source",Fw=Pm({provide:String,useValue:Pm});function Uw(e){var t=Mw;return Mw=e,t}function Vw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jm.Default;if(void 0===Mw)throw new Error("inject() must be called from an injection context");return null===Mw?Km(e,void 0,t):Mw.get(e,t&jm.Optional?null:void 0,t)}function Bw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jm.Default;return(Gm||Vw)(Mm(e),t)}function zw(e){for(var t=[],n=0;n<e.length;n++){var r=Mm(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,a=jm.Default,o=0;o<r.length;o++){var s=r[o],u=Gw(s);"number"==typeof u?-1===u?i=s.token:a|=u:i=s}t.push(Bw(i,a))}else t.push(Bw(r))}return t}function Hw(e,t){return e[Rw]=t,e.prototype[Rw]=t,e}function Gw(e){return e[Rw]}function $w(e,t,n,r){var i=e[Nw];throw t[Lw]&&i.unshift(t[Lw]),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=Om(t);if(Array.isArray(t))i=t.map(Om).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):Om(s)))}i="{".concat(a.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(Dw,"\n  "))}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[Nw]=null,e}var Zw,qw,Ww=Hw(kw("Inject",function(e){return{token:e}}),-1),jw=Hw(kw("Optional"),8),Yw=Hw(kw("SkipSelf"),4);function Kw(e){var t;return(null===(t=function(){if(void 0===Zw&&(Zw=null,rk.trustedTypes))try{Zw=rk.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Zw}())||void 0===t?void 0:t.createHTML(e))||e}function Qw(e){var t;return(null===(t=function(){if(void 0===qw&&(qw=null,rk.trustedTypes))try{qw=rk.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return qw}())||void 0===t?void 0:t.createHTML(e))||e}var Xw=function(){function e(t){gy(this,e),this.changingThisBreaksApplicationSecurity=t}return my(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),Jw=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(Xw),e_=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(Xw),t_=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(Xw),n_=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(Xw),r_=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(Xw);function i_(e){return e instanceof Xw?e.changingThisBreaksApplicationSecurity:e}function a_(e,t){var n=o_(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function o_(e){return e instanceof Xw&&e.getTypeName()||null}function s_(e){var t=new c_(e);return function(){try{return!!(new window.DOMParser).parseFromString(Kw(""),"text/html")}catch(e){return!1}}()?new u_(t):t}var u_=function(){function e(t){gy(this,e),this.inertDocumentHelper=t}return my(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(Kw(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),c_=function(){function e(t){if(gy(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var r=this.inertDocument.createElement("body");n.appendChild(r)}}return my(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Kw(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=Kw(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;("xmlns:ns1"===r||0===r.indexOf("ns1:"))&&e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),l_=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,f_=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function h_(e){return(e=String(e)).match(l_)||e.match(f_)?e:"unsafe:"+e}function d_(e){return(e=String(e)).split(",").map(function(e){return h_(e.trim())}).join(", ")}function v_(e){var t,n={},r=dy(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function p_(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var g_,y_=v_("area,br,col,hr,img,wbr"),m_=v_("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),k_=v_("rp,rt"),C_=p_(y_,p_(m_,v_("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),p_(k_,v_("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),p_(k_,m_)),w_=v_("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),__=v_("srcset"),E_=p_(w_,__,v_("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),v_("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),b_=v_("script,style,template"),P_=function(){function e(){gy(this,e),this.sanitizedSomething=!1,this.buf=[]}return my(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!C_.hasOwnProperty(t))return this.sanitizedSomething=!0,!b_.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n=e.attributes,r=0;r<n.length;r++){var i=n.item(r),a=i.name,o=a.toLowerCase();if(E_.hasOwnProperty(o)){var s=i.value;w_[o]&&(s=h_(s)),__[o]&&(s=d_(s)),this.buf.push(" ",a,'="',T_(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();C_.hasOwnProperty(t)&&!y_.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(T_(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),S_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,O_=/([^\#-~ |!])/g;function T_(e){return e.replace(/&/g,"&amp;").replace(S_,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(O_,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function I_(e,t){var n=null;try{g_=g_||s_(e);var r=t?String(t):"";n=g_.getInertBodyElement(r);var i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=g_.getInertBodyElement(r)}while(r!==a);return Kw((new P_).sanitizeChildren(A_(n)||n))}finally{if(n)for(var o=A_(n)||n;o.firstChild;)o.removeChild(o.firstChild)}}function A_(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var M_=((M_=M_||{})[M_.NONE=0]="NONE",M_[M_.HTML=1]="HTML",M_[M_.STYLE=2]="STYLE",M_[M_.SCRIPT=3]="SCRIPT",M_[M_.URL=4]="URL",M_[M_.RESOURCE_URL=5]="RESOURCE_URL",M_);function x_(e){var t=N_();return t?Qw(t.sanitize(M_.HTML,e)||""):a_(e,"HTML")?Qw(i_(e)):I_(zk(),Nm(e))}function R_(e){var t=N_();return t?t.sanitize(M_.URL,e)||"":a_(e,"URL")?i_(e):h_(Nm(e))}function N_(){var e=rC();return e&&e[12]}var D_="__ngContext__";function L_(e,t){e[D_]=t}function F_(e){var t=function(e){return e[D_]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function U_(e){return e.ngOriginalError}function V_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var B_=function(){function e(){gy(this,e),this._console=console}return my(e,[{key:"handleError",value:function(e){var t,n=this._findOriginalError(e),r=this._findContext(e),i=(t=e)&&t.ngErrorLogger||V_;i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}},{key:"_findContext",value:function(e){return e?e.ngDebugContext||this._findContext(U_(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=e&&U_(e);t&&U_(t);)t=U_(t);return t||null}}]),e}(),z_=/^>|^->|<!--|-->|--!>|<!-$/g,H_=/(<|>)/,G_=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(rk);function $_(e){return e instanceof Function?e():e}var Z_,q_=((q_=q_||{})[q_.Important=1]="Important",q_[q_.DashCase=2]="DashCase",q_);function W_(e,t){return Z_(e,t)}function j_(e){var t=e[3];return Pk(t)?t[3]:t}function Y_(e){return Q_(e[13])}function K_(e){return Q_(e[4])}function Q_(e){for(;null!==e&&!Pk(e);)e=e[4];return e}function X_(e,t,n,r,i){if(null!=r){var a,o=!1;Pk(r)?a=r:bk(r)&&(o=!0,r=r[0]);var s=$k(r);0===e&&null!==n?null==i?lE(t,n,s):cE(t,n,s,i||null,!0):1===e&&null!==n?cE(t,n,s,i||null,!0):2===e?_E(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,r,i){var a=n[7];a!==$k(n)&&X_(t,e,r,a,i);for(var o=10;o<n.length;o++){var s=n[o];bE(s[1],s,e,t,r,a)}}(t,e,a,n,i)}}function J_(e,t){return Hk(e)?e.createText(t):e.createTextNode(t)}function eE(e,t,n){Hk(e)?e.setValue(t,n):t.textContent=n}function tE(e,t){return e.createComment(function(e){return e.replace(z_,function(e){return e.replace(H_,"\u200b$1\u200b")})}(t))}function nE(e,t,n){return Hk(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function rE(e,t){var n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,eC(i,-1)),n.splice(r,1)}function iE(e,t){if(!(e.length<=10)){var n=10+t,r=e[n];if(r){var i=r[17];null!==i&&i!==e&&rE(i,r),t>0&&(e[n-1][4]=r[4]);var a=Sw(e,10+t);!function(e,t){bE(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);var o=a[19];null!==o&&o.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function aE(e,t){if(!(256&t[2])){var n=t[11];Hk(n)&&n.destroyNode&&bE(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return oE(e[1],e);for(;t;){var n=null;if(bk(t))n=t[13];else{var r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)bk(t)&&oE(t[1],t),t=t[3];null===t&&(t=e),bk(t)&&oE(t[1],t),n=t&&t[4]}t=n}}(t)}}function oE(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];if(!(i instanceof zC)){var a=n[r+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2){var s=i[a[o]],u=a[o+1];try{u.call(s)}finally{}}else try{a.call(i)}finally{}}}}(e,t),function(e,t){var n=e.cleanup,r=t[7],i=-1;if(null!==n)for(var a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var o=n[a+1],s="function"==typeof o?o(t):$k(t[o]),u=r[i=n[a+2]],c=n[a+3];"boolean"==typeof c?s.removeEventListener(n[a],u,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),a+=2}else{var l=r[i=n[a+1]];n[a].call(l)}if(null!==r){for(var f=i+1;f<r.length;f++)r[f]();t[7]=null}}(e,t),1===t[1].type&&Hk(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&Pk(t[3])){n!==t[3]&&rE(n,t);var r=t[19];null!==r&&r.detachView(e)}}}function sE(e,t,n){return uE(e,t.parent,n)}function uE(e,t,n){for(var r=t;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){var i=e.data[r.directiveStart].encapsulation;if(i===Jm.None||i===Jm.Emulated)return null}return qk(r,n)}function cE(e,t,n,r,i){Hk(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function lE(e,t,n){Hk(e)?e.appendChild(t,n):t.appendChild(n)}function fE(e,t,n,r,i){null!==r?cE(e,t,n,r,i):lE(e,t,n)}function hE(e,t){return Hk(e)?e.parentNode(t):t.parentNode}function dE(e,t,n){return gE(e,t,n)}function vE(e,t,n){return 40&e.type?qk(e,n):null}var pE,gE=vE;function yE(e,t){gE=e,pE=t}function mE(e,t,n,r){var i=sE(e,r,t),a=t[11],o=dE(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(var s=0;s<n.length;s++)fE(a,i,n[s],o,!1);else fE(a,i,n,o,!1);void 0!==pE&&pE(a,r,t,n,i)}function kE(e,t){if(null!==t){var n=t.type;if(3&n)return qk(t,e);if(4&n)return wE(-1,e[t.index]);if(8&n){var r=t.child;if(null!==r)return kE(e,r);var i=e[t.index];return Pk(i)?wE(-1,i):$k(i)}if(32&n)return W_(t,e)()||$k(e[t.index]);var a=CE(e,t);return null!==a?Array.isArray(a)?a[0]:kE(j_(e[16]),a):kE(e,t.next)}return null}function CE(e,t){return null!==t?e[16][6].projection[t.projection]:null}function wE(e,t){var n=10+e+1;if(n<t.length){var r=t[n],i=r[1].firstChild;if(null!==i)return kE(r,i)}return t[7]}function _E(e,t,n){var r=hE(e,t);r&&function(e,t,n,r){Hk(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function EE(e,t,n,r,i,a,o){for(;null!=n;){var s=r[n.index],u=n.type;if(o&&0===t&&(s&&L_($k(s),r),n.flags|=4),64!=(64&n.flags))if(8&u)EE(e,t,n.child,r,i,a,!1),X_(t,e,i,s,a);else if(32&u){for(var c=W_(n,r),l=void 0;l=c();)X_(t,e,i,l,a);X_(t,e,i,s,a)}else 16&u?PE(e,t,r,n,i,a):X_(t,e,i,s,a);n=o?n.projectionNext:n.next}}function bE(e,t,n,r,i,a){EE(n,r,e.firstChild,t,i,a,!1)}function PE(e,t,n,r,i,a){var o=n[16],s=o[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)X_(t,e,i,s[u],a);else EE(e,t,s,o[3],i,a,!0)}function SE(e,t,n){Hk(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function OE(e,t,n){Hk(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function TE(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var a=t.length;if(i+a===r||e.charCodeAt(i+a)<=32)return i}n=i+1}}var IE="ng-template";function AE(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==TE((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function ME(e){return 4===e.type&&e.value!==IE}function xE(e,t,n){return t===(4!==e.type||n?e.value:IE)}function RE(e,t,n){for(var r=4,i=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(GC(e[t]))return t;return e.length}(i),o=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!xE(e,u,n)||""===u&&1===t.length){if(NE(r))return!1;o=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!AE(e.attrs,c,n)){if(NE(r))return!1;o=!0}continue}var l=DE(8&r?"class":u,i,ME(e),n);if(-1===l){if(NE(r))return!1;o=!0;continue}if(""!==c){var f;f=l>a?"":i[l+1].toLowerCase();var h=8&r?f:null;if(h&&-1!==TE(h,c,0)||2&r&&c!==f){if(NE(r))return!1;o=!0}}}}else{if(!o&&!NE(r)&&!NE(u))return!1;if(o&&NE(u))continue;o=!1,r=u|1&r}}return NE(r)||o}function NE(e){return 0==(1&e)}function DE(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var a=!1;i<t.length;){var o=t[i];if(o===e)return i;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function LE(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(RE(e,t[r],n))return!0;return!1}function FE(e,t){return e?":not("+t.trim()+")":t}function UE(e){for(var t=e[0],n=1,r=2,i="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&r){var s=e[++n];i+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!NE(o)&&(t+=FE(a,i),i=""),r=o,a=a||!NE(r);n++}return""!==i&&(t+=FE(a,i)),t}var VE={};function BE(e){zE(iC(),rC(),MC()+e,hC())}function zE(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&LC(t,i,n)}else{var a=e.preOrderHooks;null!==a&&FC(t,a,0,n)}xC(n)}function HE(e,t){return e<<17|t<<2}function GE(e){return e>>17&32767}function $E(e){return 2|e}function ZE(e){return(131068&e)>>2}function qE(e,t){return-131069&e|t<<2}function WE(e){return 1|e}function jE(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1];if(-1!==a){var o=e.data[a];_C(i),o.contentQueries(2,t[a],a)}}}function YE(e,t,n,r,i,a,o,s,u,c){var l=t.blueprint.slice();return l[0]=i,l[2]=140|r,Jk(l),l[3]=l[15]=e,l[8]=n,l[10]=o||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=a,l[16]=2==t.type?e[16]:l,l}function KE(e,t,n,r,i){var a=e.data[t];if(null===a)a=QE(e,t,n,r,i),tC.lFrame.inI18n&&(a.flags|=64);else if(64&a.type){a.type=n,a.value=r,a.attrs=i;var o=uC();a.injectorIndex=null===o?-1:o.injectorIndex}return cC(a,!0),a}function QE(e,t,n,r,i){var a=sC(),o=lC(),s=e.data[t]=function(e,t,n,r,i,a){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?a:a&&a.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=s),null!==a&&(o?null==a.child&&null!==s.parent&&(a.child=s):null===a.next&&(a.next=s)),s}function XE(e,t,n,r){if(0===n)return-1;for(var i=t.length,a=0;a<n;a++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function JE(e,t,n){PC(t);try{var r=e.viewQuery;null!==r&&Mb(1,r,n);var i=e.template;null!==i&&nb(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&jE(e,t),e.staticViewQueries&&Mb(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)Sb(e,t[n])}(t,a)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,AC()}}function eb(e,t,n,r){var i=t[2];if(256!=(256&i)){PC(t);var a=hC();try{Jk(t),function(e){tC.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&nb(e,t,n,2,r);var o=3==(3&i);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&LC(t,s,null)}else{var u=e.preOrderHooks;null!==u&&FC(t,u,0,null),UC(t,0)}if(function(e){for(var t=Y_(e);null!==t;t=K_(t))if(t[2])for(var n=t[9],r=0;r<n.length;r++){var i=n[r],a=i[3];0==(1024&i[2])&&eC(a,1),i[2]|=1024}}(t),function(e){for(var t=Y_(e);null!==t;t=K_(t))for(var n=10;n<t.length;n++){var r=t[n],i=r[1];Qk(r)&&eb(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&jE(e,t),!a)if(o){var c=e.contentCheckHooks;null!==c&&LC(t,c)}else{var l=e.contentHooks;null!==l&&FC(t,l,1),UC(t,1)}!function(e,t){var n=e.hostBindingOpCodes;if(null!==n)try{for(var r=0;r<n.length;r++){var i=n[r];if(i<0)xC(~i);else{var a=i,o=n[++r],s=n[++r];kC(o,a),s(2,t[a])}}}finally{xC(-1)}}(e,t);var f=e.components;null!==f&&function(e,t){for(var n=0;n<t.length;n++)bb(e,t[n])}(t,f);var h=e.viewQuery;if(null!==h&&Mb(2,h,r),!a)if(o){var d=e.viewCheckHooks;null!==d&&LC(t,d)}else{var v=e.viewHooks;null!==v&&FC(t,v,2),UC(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,eC(t[3],-1))}finally{AC()}}}function tb(e,t,n,r){var i=t[10],a=!hC(),o=Kk(t);try{a&&!o&&i.begin&&i.begin(),o&&JE(e,t,r),eb(e,t,n,r)}finally{a&&!o&&i.end&&i.end()}}function nb(e,t,n,r,i){var a=MC(),o=2&r;try{xC(-1),o&&t.length>20&&zE(e,t,20,hC()),n(r,i)}finally{xC(a)}}function rb(e,t,n){if(Sk(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var a=e.data[i];a.contentQueries&&a.contentQueries(1,n[i],i)}}function ib(e,t,n){!nC()||(function(e,t,n,r){var i=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||JC(n,t),L_(r,t);for(var o=n.initialInputs,s=i;s<a;s++){var u=e.data[s],c=Ik(u);c&&mb(t,n,u);var l=fw(t,e,s,n);L_(l,t),null!==o&&wb(0,s-i,l,u,0,o),c&&(Yk(n.index,t)[8]=l)}}(e,t,n,qk(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,a=n.index,o=tC.lFrame.currentDirectiveIndex;try{xC(a);for(var s=r;s<i;s++){var u=e.data[s],c=t[s];CC(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&db(u,c)}}finally{xC(-1),CC(o)}}(e,t,n))}function ab(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qk,r=t.localNames;if(null!==r)for(var i=t.index+1,a=0;a<r.length;a+=2){var o=r[a+1],s=-1===o?n(t,e):e[o];e[i++]=s}}function ob(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=sb(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function sb(e,t,n,r,i,a,o,s,u,c){var l=20+r,f=l+i,h=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:VE);return n}(l,f),d="function"==typeof c?c():c;return h[1]={type:e,blueprint:h,template:n,queries:null,viewQuery:s,declTNode:t,data:h.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function ub(e,t,n,r){var i=Rb(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&Nb(e).push(r,i.length-1))}function cb(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function lb(e,t,n,r,i,a,o,s){var u,c=qk(t,n),l=t.inputs;!s&&null!=l&&(u=l[r])?(Lb(e,n,u,r,i),Ok(t)&&function(e,t){var n=Yk(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,Hk(a)?a.setProperty(c,r,i):$C(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function fb(e,t,n,r){var i=!1;if(nC()){var a=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var a=0;a<r.length;a++){var o=r[a];LE(n,o.selectors,!1)&&(i||(i=[]),rw(JC(n,t),e,o.type),Ik(o)?(vb(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==a){i=!0,gb(n,e.data.length,a.length);for(var s=0;s<a.length;s++){var u=a[s];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,f=XE(e,t,a.length,null),h=0;h<a.length;h++){var d=a[h];n.mergedAttrs=ZC(n.mergedAttrs,d.hostAttrs),yb(e,n,t,f,d),pb(f,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);var v=d.type.prototype;!c&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),!l&&(v.ngOnChanges||v.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),f++}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,a=[],o=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs,f=null===i||ME(t)?null:_b(l,i);a.push(f),o=cb(l,u,o),s=cb(c.outputs,u,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var a=n[t[i+1]];if(null==a)throw new Rm("301","Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],a)}}(n,r,o)}return n.mergedAttrs=ZC(n.mergedAttrs,n.attrs),i}function hb(e,t,n,r,i,a){var o=a.hostBindings;if(o){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=u&&s.push(u),s.push(r,i,o)}}function db(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function vb(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function pb(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;Ik(t)&&(n[""]=e)}}function gb(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function yb(e,t,n,r,i){e.data[r]=i;var a=i.factory||(i.factory=Mk(i.type)),o=new zC(a,Ik(i),null);e.blueprint[r]=o,n[r]=o,hb(e,t,0,r,XE(e,n,i.hostVars,VE),i)}function mb(e,t,n){var r=qk(t,e),i=ob(n),a=e[10],o=Ob(e,YE(e,i,null,n.onPush?64:16,r,t,a,a.createRenderer(r,n),null,null));e[t.index]=o}function kb(e,t,n,r,i,a){var o=qk(e,t);Cb(t[11],o,a,e.value,n,r,i)}function Cb(e,t,n,r,i,a,o){if(null==a)Hk(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{var s=null==o?Nm(a):o(a,r||"",i);Hk(e)?e.setAttribute(t,i,s,n):n?t.setAttributeNS(n,i,s):t.setAttribute(i,s)}}function wb(e,t,n,r,i,a){var o=a[t];if(null!==o)for(var s=r.setInput,u=0;u<o.length;){var c=o[u++],l=o[u++],f=o[u++];null!==s?r.setInput(n,f,c,l):n[l]=f}}function _b(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function Eb(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function bb(e,t){var n=Yk(t,e);if(Qk(n)){var r=n[1];80&n[2]?eb(r,n,r.template,n[8]):n[5]>0&&Pb(n)}}function Pb(e){for(var t=Y_(e);null!==t;t=K_(t))for(var n=10;n<t.length;n++){var r=t[n];if(1024&r[2]){var i=r[1];eb(i,r,i.template,r[8])}else r[5]>0&&Pb(r)}var a=e[1].components;if(null!==a)for(var o=0;o<a.length;o++){var s=Yk(a[o],e);Qk(s)&&s[5]>0&&Pb(s)}}function Sb(e,t){var n=Yk(t,e),r=n[1];(function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),JE(r,n,n[8])}function Ob(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Tb(e){for(;e;){e[2]|=64;var t=j_(e);if(Ak(e)&&!t)return e;e=t}return null}function Ib(e,t,n){var r=t[10];r.begin&&r.begin();try{eb(e,t,e.template,n)}catch(i){throw Db(t,i),i}finally{r.end&&r.end()}}function Ab(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=F_(n),i=r[1];tb(i,r,i.template,n)}}(e[8])}function Mb(e,t,n){_C(0),t(e,n)}var xb=Promise.resolve(null);function Rb(e){return e[7]||(e[7]=[])}function Nb(e){return e.cleanup||(e.cleanup=[])}function Db(e,t){var n=e[9],r=n?n.get(B_,null):null;r&&r.handleError(t)}function Lb(e,t,n,r,i){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],u=t[o],c=e.data[o];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function Fb(e,t,n){var r=Zk(t,e);eE(e[11],r,n)}function Ub(e,t,n){var r=n?e.styles:null,i=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?i=Tm(i,s):2==a&&(r=Tm(r,s+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}var Vb,Bb=new Cw("INJECTOR",-1),zb=function(){function e(){gy(this,e)}return my(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xw;if(t===xw){var n=new Error("NullInjectorError: No provider for ".concat(Om(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),Hb=new Cw("Set Injector scope."),Gb={},$b={};function Zb(){return void 0===Vb&&(Vb=new zb),Vb}function qb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new Wb(e,n,t||Zb(),r)}var Wb=function(){function e(t,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;gy(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&bw(n,function(e){return i.processProvider(e,t,n)}),bw([t],function(e){return i.processInjectorType(e,[],o)}),this.records.set(Bb,Kb(void 0,this));var s=this.records.get(Hb);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:Om(t))}return my(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xw,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jm.Default;this.assertNotDestroyed();var r,i=Uw(this),a=Ym(void 0);try{if(!(n&jm.SkipSelf)){var o=this.records.get(e);if(void 0===o){var s=("function"==typeof(r=e)||"object"==typeof r&&r instanceof Cw)&&Bm(e);o=s&&this.injectableDefInScope(s)?Kb(jb(e),Gb):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&jm.Self?Zb():this.parent).get(e,t=n&jm.Optional&&t===xw?null:t)}catch(u){if("NullInjectorError"===u.name){if((u[Nw]=u[Nw]||[]).unshift(Om(e)),i)throw u;return $w(u,e,"R3InjectorError",this.source)}throw u}finally{Ym(a),Uw(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(Om(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=Mm(e)))return!1;var i=Hm(e),a=null==i&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(i=Hm(a)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(o);try{bw(i.imports,function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,i=t.providers;bw(i,function(e){return r.processProvider(e,n,i||ak)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(o);var f=Mk(o)||function(){return new o};this.records.set(o,Kb(f,Gb));var h=i.providers;if(null!=h&&!s){var d=e;bw(h,function(e){return r.processProvider(e,d,h)})}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r,i=Xb(e=Mm(e))?e:Mm(e&&e.provide),a=Qb(r=e)?Kb(void 0,r.useValue):Kb(Yb(r),Gb);if(Xb(e)||!0!==e.multi)this.records.get(i);else{var o=this.records.get(i);o||((o=Kb(void 0,Gb,!0)).factory=function(){return zw(o.multi)},this.records.set(i,o)),i=e,o.multi.push(e)}this.records.set(i,a)}},{key:"hydrate",value:function(e,t){return t.value===Gb&&(t.value=$b,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}},{key:"injectableDefInScope",value:function(e){if(!e.providedIn)return!1;var t=Mm(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}]),e}();function jb(e){var t=Bm(e),n=null!==t?t.factory:Mk(e);if(null!==n)return n;if(e instanceof Cw)throw new Error("Token ".concat(Om(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=Ow(t,"?");throw new Error("Can't resolve all parameters for ".concat(Om(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[$m]||e[qm]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function Yb(e,t,n){var r;if(Xb(e)){var i=Mm(e);return Mk(i)||jb(i)}if(Qb(e))r=function(){return Mm(e.useValue)};else if(function(e){return!(!e||!e.useFactory)}(e))r=function(){return e.useFactory.apply(e,fy(zw(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return Bw(Mm(e.useExisting))};else{var a=Mm(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return Mk(a)||jb(a);r=function(){return ty(a,fy(zw(e.deps)))}}return r}function Kb(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function Qb(e){return null!==e&&"object"==typeof e&&Fw in e}function Xb(e){return"function"==typeof e}var Jb=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=qb(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},eP=function(){var e=function(){function e(){gy(this,e)}return my(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?Jb(e,t,""):Jb(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=xw,e.NULL=new zb,e.\u0275prov=Um({token:e,providedIn:"any",factory:function(){return Bw(Bb)}}),e.__NG_ELEMENT_ID__=-1,e}();function tP(e,t){DC(F_(e)[1],oC())}function nP(e){for(var t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0,r=[e];t;){var i=void 0;if(Ik(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);var a=e;a.inputs=rP(e.inputs),a.declaredInputs=rP(e.declaredInputs),a.outputs=rP(e.outputs);var o=i.hostBindings;o&&oP(e,o);var s=i.viewQuery,u=i.contentQueries;if(s&&iP(e,s),u&&aP(e,u),Sm(e.inputs,i.inputs),Sm(e.declaredInputs,i.declaredInputs),Sm(e.outputs,i.outputs),Ik(i)&&i.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(i.data.animation)}}var l=i.features;if(l)for(var f=0;f<l.length;f++){var h=l[f];h&&h.ngInherit&&h(e),h===nP&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=ZC(i.hostAttrs,n=ZC(n,i.hostAttrs))}}(r)}function rP(e){return e===ik?{}:e===ak?[]:e}function iP(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function aP(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,i){t(e,r,i),n(e,r,i)}:t}function oP(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var sP=null;function uP(){if(!sP){var e=rk.Symbol;if(e&&e.iterator)sP=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(sP=r)}}return sP}var cP=function(){function e(t){gy(this,e),this.wrapped=t}return my(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function lP(e){return!!fP(e)&&(Array.isArray(e)||!(e instanceof Map)&&uP()in e)}function fP(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function hP(e,t,n){return e[t]=n}function dP(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function vP(e,t,n,r){var i=dP(e,t,n);return dP(e,t+1,r)||i}function pP(e,t,n,r){var i=rC();return dP(i,gC(),t)&&(iC(),kb(RC(),i,e,t,n,r)),pP}function gP(e,t,n,r){return dP(e,gC(),n)?t+Nm(n)+r:VE}function yP(e,t,n,r,i,a){var o=vP(e,pC(),n,i);return yC(2),o?t+Nm(n)+r+Nm(i)+a:VE}function mP(e,t,n,r,i,a,o,s){var u=function(e,t,n,r,i){var a=vP(e,t,n,r);return dP(e,t+2,i)||a}(e,pC(),n,i,o);return yC(3),u?t+Nm(n)+r+Nm(i)+a+Nm(o)+s:VE}function kP(e,t,n,r,i,a){var o=rC(),s=gP(o,t,n,r);return s!==VE&&kb(RC(),o,e,s,i,a),kP}function CP(e,t,n,r,i,a,o,s){var u=rC(),c=iC(),l=e+20,f=c.firstCreatePass?function(e,t,n,r,i,a,o,s,u){var c=t.consts,l=KE(t,e,4,o||null,Xk(c,s));fb(t,n,l,Xk(c,u)),DC(t,l);var f=l.tViews=sb(2,l,r,i,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),f.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,a,o):c.data[l];cC(f,!1);var h=u[11].createComment("");mE(c,u,h,f),L_(h,u),Ob(u,u[l]=Eb(h,u,h,f)),Tk(f)&&ib(c,u,f),null!=o&&ab(u,f,s)}function wP(e){return jk(tC.lFrame.contextLView,20+e)}function _P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jm.Default,n=rC();return null===n?Bw(e,t):ow(oC(),n,Mm(e),t)}function EP(e,t,n){var r=rC();return dP(r,gC(),t)&&lb(iC(),RC(),r,e,t,r[11],n,!1),EP}function bP(e,t,n,r,i){var a=i?"class":"style";Lb(e,n,t.inputs[a],a,r)}function PP(e,t,n,r){var i=rC(),a=iC(),o=20+e,s=i[11],u=i[o]=nE(s,t,tC.lFrame.currentNamespace),c=a.firstCreatePass?function(e,t,n,r,i,a,o){var s=t.consts,u=KE(t,e,2,i,Xk(s,a));return fb(t,n,u,Xk(s,o)),null!==u.attrs&&Ub(u,u.attrs,!1),null!==u.mergedAttrs&&Ub(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,a,i,0,t,n,r):a.data[o];cC(c,!0);var l=c.mergedAttrs;null!==l&&HC(s,u,l);var f=c.classes;null!==f&&OE(s,u,f);var h=c.styles;null!==h&&SE(s,u,h),64!=(64&c.flags)&&mE(a,i,u,c),0===tC.lFrame.elementDepthCount&&L_(u,i),tC.lFrame.elementDepthCount++,Tk(c)&&(ib(a,i,c),rb(a,c,i)),null!==r&&ab(i,c)}function SP(){var e=oC();lC()?fC():cC(e=e.parent,!1);var t=e;tC.lFrame.elementDepthCount--;var n=iC();n.firstCreatePass&&(DC(n,e),Sk(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&bP(n,t,rC(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&bP(n,t,rC(),t.stylesWithoutHost,!1)}function OP(e,t,n,r){PP(e,t,n,r),SP()}function TP(e,t,n){var r=rC(),i=iC(),a=e+20,o=i.firstCreatePass?function(e,t,n,r,i){var a=t.consts,o=Xk(a,r),s=KE(t,e,8,"ng-container",o);return null!==o&&Ub(s,o,!0),fb(t,n,s,Xk(a,i)),null!==t.queries&&t.queries.elementStart(t,s),s}(a,i,r,t,n):i.data[a];cC(o,!0);var s=r[a]=r[11].createComment("");mE(i,r,s,o),L_(s,r),Tk(o)&&(ib(i,r,o),rb(i,o,r)),null!=n&&ab(r,o)}function IP(){var e=oC(),t=iC();lC()?fC():cC(e=e.parent,!1),t.firstCreatePass&&(DC(t,e),Sk(e)&&t.queries.elementEnd(e))}function AP(){return rC()}function MP(e){return!!e&&"function"==typeof e.then}var xP=function(e){return!!e&&"function"==typeof e.subscribe};function RP(e,t,n,r){var i=rC(),a=iC(),o=oC();return function(e,t,n,r,i,a,o,s){var u=Tk(r),c=e.firstCreatePass&&Nb(e),l=t[8],f=Rb(t),h=!0;if(3&r.type||s){var d=qk(r,t),v=s?s(d):d,p=f.length,g=s?function(e){return s($k(e[r.index]))}:r.index;if(Hk(n)){var y=null;if(!s&&u&&(y=function(e,t,n,r){var i=e.cleanup;if(null!=i)for(var a=0;a<i.length-1;a+=2){var o=i[a];if(o===n&&i[a+1]===r){var s=t[7],u=i[a+2];return s.length>u?s[u]:null}"string"==typeof o&&(a+=2)}return null}(e,t,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=a,y.__ngLastListenerFn__=a,h=!1;else{a=DP(r,t,l,a,!1);var m=n.listen(v,i,a);f.push(a,m),c&&c.push(i,g,p,p+1)}}else a=DP(r,t,l,a,!0),v.addEventListener(i,a,o),f.push(a),c&&c.push(i,g,p,o)}else a=DP(r,t,l,a,!1);var k,C=r.outputs;if(h&&null!==C&&(k=C[i])){var w=k.length;if(w)for(var _=0;_<w;_+=2){var E=t[k[_]][k[_+1]].subscribe(a),b=f.length;f.push(a,E),c&&c.push(i,r.index,b,-(b+1))}}}(a,i,i[11],o,e,t,!!n,r),RP}function NP(e,t,n,r){try{return!1!==n(r)}catch(i){return Db(e,i),!1}}function DP(e,t,n,r,i){return function n(a){if(a===Function)return r;var o=2&e.flags?Yk(e.index,t):t;0==(32&t[2])&&Tb(o);for(var s=NP(t,0,r,a),u=n.__ngNextListenerFn__;u;)s=NP(t,0,u,a)&&s,u=u.__ngNextListenerFn__;return i&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function LP(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(tC.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,tC.lFrame.contextLView))[8]}(e)}function FP(e,t,n){return UP(e,"",t,"",n),FP}function UP(e,t,n,r,i){var a=rC(),o=gP(a,t,n,r);return o!==VE&&lb(iC(),RC(),a,e,o,a[11],i,!1),UP}function VP(e,t,n,r,i,a,o){var s=rC(),u=yP(s,t,n,r,i,a);return u!==VE&&lb(iC(),RC(),s,e,u,s[11],o,!1),VP}function BP(e,t,n,r,i,a,o,s,u){var c=rC(),l=mP(c,t,n,r,i,a,o,s);return l!==VE&&lb(iC(),RC(),c,e,l,c[11],u,!1),BP}function zP(e,t,n,r,i){for(var a=e[n+1],o=null===t,s=r?GE(a):ZE(a),u=!1;0!==s&&(!1===u||o);){var c=e[s+1];HP(e[s],t)&&(u=!0,e[s+1]=r?WE(c):$E(c)),s=r?GE(c):ZE(c)}u&&(e[n+1]=r?$E(a):WE(a))}function HP(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Aw(e,t)>=0}var GP={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function $P(e){return e.substring(GP.key,GP.keyEnd)}function ZP(e){return e.substring(GP.value,GP.valueEnd)}function qP(e,t){var n=GP.textEnd,r=GP.key=WP(e,t,n);return n===r?-1:(r=GP.keyEnd=function(e,t,n){for(var r;t<n&&(45===(r=e.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(e,r,n),r=jP(e,r,n),r=GP.value=WP(e,r,n),r=GP.valueEnd=function(e,t,n){for(var r=-1,i=-1,a=-1,o=t,s=o;o<n;){var u=e.charCodeAt(o++);if(59===u)return s;34===u||39===u?s=o=YP(e,u,o,n):t===o-4&&85===a&&82===i&&76===r&&40===u?s=o=YP(e,41,o,n):u>32&&(s=o),a=i,i=r,r=-33&u}return s}(e,r,n),jP(e,r,n))}function WP(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function jP(e,t,n,r){return(t=WP(e,t,n))<n&&t++,t}function YP(e,t,n,r){for(var i=-1,a=n;a<r;){var o=e.charCodeAt(a++);if(o==t&&92!==i)return a;i=92==o&&92===i?0:o}throw new Error}function KP(e,t){return function(e,t,n,r){var i=rC(),a=iC(),o=yC(2);a.firstUpdatePass&&eS(a,e,o,true),t!==VE&&dP(i,o,t)&&iS(a,a.data[MC()],i,i[11],e,i[o+1]=function(e,t){return null==e||"object"==typeof e&&(e=Om(i_(e))),e}(t),true,o)}(e,t),KP}function QP(e){!function(e,t,n,r){var i=iC(),a=yC(2);i.firstUpdatePass&&eS(i,null,a,r);var o=rC();if(n!==VE&&dP(o,a,n)){var s=i.data[MC()];if(sS(s,r)&&!JP(i,a)){var u=s.stylesWithoutHost;null!==u&&(n=Tm(u,n||"")),bP(i,s,o,n,r)}else!function(e,t,n,r,i,a,o,s){i===VE&&(i=ak);for(var u=0,c=0,l=0<i.length?i[0]:null,f=0<a.length?a[0]:null;null!==l||null!==f;){var h=u<i.length?i[u+1]:void 0,d=c<a.length?a[c+1]:void 0,v=void 0,p=null;l===f?(u+=2,c+=2,h!==d&&(p=f,v=d)):null===f||null!==l&&l<f?(u+=2,p=l):(c+=2,p=f,v=d),null!==p&&iS(e,t,n,r,p,v,false,s),l=u<i.length?i[u]:null,f=c<a.length?a[c]:null}}(i,s,o,o[11],o[a+1],o[a+1]=function(e,t,n){if(null==n||""===n)return ak;var r=[],i=i_(n);if(Array.isArray(i))for(var a=0;a<i.length;a++)e(r,i[a],!0);else if("object"==typeof i)for(var o in i)i.hasOwnProperty(o)&&e(r,o,i[o]);else"string"==typeof i&&t(r,i);return r}(e,t,n),0,a)}}(rS,XP,e,!1)}function XP(e,t){for(var n=function(e){return function(e){GP.key=0,GP.keyEnd=0,GP.value=0,GP.valueEnd=0,GP.textEnd=e.length}(e),qP(e,WP(e,0,GP.textEnd))}(t);n>=0;n=qP(t,n))rS(e,$P(t),ZP(t))}function JP(e,t){return t>=e.expandoStartIndex}function eS(e,t,n,r){var i=e.data;if(null===i[n+1]){var a=i[MC()],o=JP(e,n);sS(a,r)&&null===t&&!o&&(t=!1),t=function(e,t,n,r){var i=function(e){var t=tC.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),a=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(n=nS(n=tS(null,e,t,n,r),t.attrs,r),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=tS(i,e,t,n,r),null===a){var s=function(e,t,n){var r=n?t.classBindings:t.styleBindings;if(0!==ZE(r))return e[GE(r)]}(e,t,r);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[GE(n?t.classBindings:t.styleBindings)]=r}(e,t,r,s=nS(s=tS(null,e,t,s[1],r),t.attrs,r))}else a=function(e,t,n){for(var r,i=t.directiveEnd,a=1+t.directiveStylingLast;a<i;a++)r=nS(r,e[a].hostAttrs,n);return nS(r,t.attrs,n)}(e,t,r)}return void 0!==a&&(r?t.residualClasses=a:t.residualStyles=a),n}(i,a,t,r),function(e,t,n,r,i,a){var o=a?t.classBindings:t.styleBindings,s=GE(o),u=ZE(o);e[r]=n;var c,l=!1;if(Array.isArray(n)){var f=n;(null===(c=f[1])||Aw(f,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var h=GE(e[s+1]);e[r+1]=HE(h,s),0!==h&&(e[h+1]=qE(e[h+1],r)),e[s+1]=function(e,t){return 131071&e|t<<17}(e[s+1],r)}else e[r+1]=HE(s,0),0!==s&&(e[s+1]=qE(e[s+1],r)),s=r;else e[r+1]=HE(u,0),0===s?s=r:e[u+1]=qE(e[u+1],r),u=r;l&&(e[r+1]=$E(e[r+1])),zP(e,c,r,!0),zP(e,c,r,!1),function(e,t,n,r,i){var a=i?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof t&&Aw(a,t)>=0&&(n[r+1]=WE(n[r+1]))}(t,c,e,r,a),o=HE(s,u),a?t.classBindings=o:t.styleBindings=o}(i,a,t,n,o,r)}}function tS(e,t,n,r,i){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(r=nS(r,(a=t[s]).hostAttrs,i),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function nS(e,t,n){var r=n?1:2,i=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Tw(e,o,!!n||t[++a]))}return void 0===e?null:e}function rS(e,t,n){Tw(e,t,i_(n))}function iS(e,t,n,r,i,a,o,s){if(3&t.type){var u=e.data,c=u[s+1];oS(function(e){return 1==(1&e)}(c)?aS(u,t,n,i,ZE(c),o):void 0)||(oS(a)||function(e){return 2==(2&e)}(c)&&(a=aS(u,null,n,i,s,o)),function(e,t,n,r,i){var a=Hk(e);if(t)i?a?e.addClass(n,r):n.classList.add(r):a?e.removeClass(n,r):n.classList.remove(r);else{var o=-1===r.indexOf("-")?void 0:q_.DashCase;if(null==i)a?e.removeStyle(n,r,o):n.style.removeProperty(r);else{var s="string"==typeof i&&i.endsWith("!important");s&&(i=i.slice(0,-10),o|=q_.Important),a?e.setStyle(n,r,i,o):n.style.setProperty(r,i,s?"important":"")}}}(r,o,Zk(MC(),n),i,a))}}function aS(e,t,n,r,i,a){for(var o,s=null===t;i>0;){var u=e[i],c=Array.isArray(u),l=c?u[1]:u,f=null===l,h=n[i+1];h===VE&&(h=f?ak:void 0);var d=f?Iw(h,r):l===r?h:void 0;if(c&&!oS(d)&&(d=Iw(u,r)),oS(d)&&(o=d,s))return o;var v=e[i+1];i=s?GE(v):ZE(v)}if(null!==t){var p=a?t.residualClasses:t.residualStyles;null!=p&&(o=Iw(p,r))}return o}function oS(e){return void 0!==e}function sS(e,t){return 0!=(e.flags&(t?16:32))}function uS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=rC(),r=iC(),i=e+20,a=r.firstCreatePass?KE(r,i,1,t,null):r.data[i],o=n[i]=J_(n[11],t);mE(r,n,o,a),cC(a,!1)}function cS(e){return lS("",e,""),cS}function lS(e,t,n){var r=rC(),i=gP(r,e,t,n);return i!==VE&&Fb(r,MC(),i),lS}function fS(e,t,n,r,i){var a=rC(),o=yP(a,e,t,n,r,i);return o!==VE&&Fb(a,MC(),o),fS}function hS(e,t,n,r,i,a,o){var s=rC(),u=mP(s,e,t,n,r,i,a,o);return u!==VE&&Fb(s,MC(),u),hS}function dS(e,t,n){var r=rC();return dP(r,gC(),t)&&lb(iC(),RC(),r,e,t,r[11],n,!0),dS}var vS=void 0,pS=["en",[["a","p"],["AM","PM"],vS],[["AM","PM"],vS,vS],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],vS,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],vS,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",vS,"{1} 'at' {0}",vS],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],gS={};function yS(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=kS(t);if(n)return n;var r=t.split("-")[0];if(n=kS(r))return n;if("en"===r)return pS;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function mS(e){return yS(e)[CS.PluralCase]}function kS(e){return e in gS||(gS[e]=rk.ng&&rk.ng.common&&rk.ng.common.locales&&rk.ng.common.locales[e]),gS[e]}var CS=((CS=CS||{})[CS.LocaleId=0]="LocaleId",CS[CS.DayPeriodsFormat=1]="DayPeriodsFormat",CS[CS.DayPeriodsStandalone=2]="DayPeriodsStandalone",CS[CS.DaysFormat=3]="DaysFormat",CS[CS.DaysStandalone=4]="DaysStandalone",CS[CS.MonthsFormat=5]="MonthsFormat",CS[CS.MonthsStandalone=6]="MonthsStandalone",CS[CS.Eras=7]="Eras",CS[CS.FirstDayOfWeek=8]="FirstDayOfWeek",CS[CS.WeekendRange=9]="WeekendRange",CS[CS.DateFormat=10]="DateFormat",CS[CS.TimeFormat=11]="TimeFormat",CS[CS.DateTimeFormat=12]="DateTimeFormat",CS[CS.NumberSymbols=13]="NumberSymbols",CS[CS.NumberFormats=14]="NumberFormats",CS[CS.CurrencyCode=15]="CurrencyCode",CS[CS.CurrencySymbol=16]="CurrencySymbol",CS[CS.CurrencyName=17]="CurrencyName",CS[CS.Currencies=18]="Currencies",CS[CS.Directionality=19]="Directionality",CS[CS.PluralCase=20]="PluralCase",CS[CS.ExtraData=21]="ExtraData",CS),wS=["zero","one","two","few","many"],_S="en-US",ES={marker:"element"},bS={marker:"ICU"},PS=((PS=PS||{})[PS.SHIFT=2]="SHIFT",PS[PS.APPEND_EAGERLY=1]="APPEND_EAGERLY",PS[PS.COMMENT=2]="COMMENT",PS),SS=_S;function OS(e){(function(e,t){null==e&&Fm("Expected localeId to be defined",e,null,"!=")})(e),"string"==typeof e&&(SS=e.toLowerCase().replace(/_/g,"-"))}function TS(e,t,n){var r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?vE(e,0,n):$k(n[i])}function IS(e,t,n,r,i){var a=t.insertBeforeIndex;if(Array.isArray(a)){var o=r,s=null;if(3&t.type||(s=o,o=i),null!==o&&0==(2&t.flags))for(var u=1;u<a.length;u++)cE(e,o,n[a[u]],s,!1)}}function AS(e,t){if(e.push(t),e.length>1)for(var n=e.length-2;n>=0;n--){var r=e[n];MS(r)||xS(r,t)&&null===RS(r)&&NS(r,t.index)}}function MS(e){return!(64&e.type)}function xS(e,t){return MS(t)||e.index>t.index}function RS(e){var t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function NS(e,t){var n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(yE(TS,IS),e.insertBeforeIndex=t)}function DS(e,t){var n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function LS(e,t,n){var r=QE(e,n,64,null,null);return AS(t,r),r}function FS(e,t){var n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function US(e){return e>>>17}function VS(e){return(131070&e)>>>1}var BS=0,zS=0;function HS(e,t,n,r){for(var i,a=n[11],o=null,s=0;s<t.length;s++){var u=t[s];if("string"==typeof u){var c=t[++s];null===n[c]&&(n[c]=J_(a,u))}else if("number"==typeof u)switch(1&u){case 0:var l=US(u),f=void 0,h=void 0;if(null===o&&(o=l,i=hE(a,r)),l===o?(f=r,h=i):(f=null,h=$k(n[l])),null!==h){var d=VS(u);cE(a,h,n[d],f,!1);var v=DS(e,d);if(null!==v&&"object"==typeof v){var p=FS(v,n);null!==p&&HS(e,v.create[p],n,n[v.anchorIdx])}}break;case 1:var g=t[++s],y=t[++s];Cb(a,Zk(u>>>1,n),null,null,g,y,null);break;default:throw new Error('Unable to determine the type of mutate operation for "'.concat(u,'"'))}else switch(u){case bS:var m=t[++s],k=t[++s];null===n[k]&&L_(n[k]=tE(a,m),n);break;case ES:var C=t[++s],w=t[++s];null===n[w]&&L_(n[w]=nE(a,C,null),n)}}}function GS(e,t,n,r,i){for(var a=0;a<n.length;a++){var o=n[a],s=n[++a];if(o&i)for(var u="",c=a+1;c<=a+s;c++){var l=n[c];if("string"==typeof l)u+=l;else if("number"==typeof l)if(l<0)u+=Nm(t[r-l]);else{var f=l>>>2;switch(3&l){case 1:var h=n[++c],d=n[++c],v=e.data[f];"string"==typeof v?Cb(t[11],t[f],null,v,h,u,d):lb(e,v,t,h,u,t[11],d,!1);break;case 0:var p=t[f];null!==p&&eE(t[11],p,u);break;case 2:ZS(e,DS(e,f),t,u);break;case 3:$S(e,DS(e,f),r,t)}}}else{var g=n[a+1];if(g>0&&3==(3&g)){var y=DS(e,g>>>2);t[y.currentCaseLViewIndex]<0&&$S(e,y,r,t)}}a+=s}}function $S(e,t,n,r){var i=r[t.currentCaseLViewIndex];if(null!==i){var a=BS;i<0&&(i=r[t.currentCaseLViewIndex]=~i,a=-1),GS(e,r,t.update[i],n,a)}}function ZS(e,t,n,r){var i=function(e,t){var n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:var r=function(e,t){var n=mS(t)(parseInt(e,10)),r=wS[n];return void 0!==r?r:"other"}(t,SS);-1===(n=e.cases.indexOf(r))&&"other"!==r&&(n=e.cases.indexOf("other"));break;case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(FS(t,n)!==i&&(qS(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){var a=n[t.anchorIdx];a&&HS(e,t.create[i],n,a)}}function qS(e,t,n){var r=FS(t,n);if(null!==r)for(var i=t.remove[r],a=0;a<i.length;a++){var o=i[a];if(o>0){var s=Zk(o,n);null!==s&&_E(n[11],s)}else qS(e,DS(e,~o),n)}}function WS(){var e,t,n=[],r=-1;function i(e,n){r=0;var i=FS(e,n);t=null!==i?e.remove[i]:ak}function a(){if(r<t.length){var o=t[r++];return o>0?e[o]:(n.push(r,t),i(e[1].data[~o],e),a())}return 0===n.length?null:(t=n.pop(),r=n.pop(),a())}return function(t,r){for(e=r;n.length;)n.pop();return i(t.value,r),a}}var jS=/\ufffd(\d+):?\d*\ufffd/gi,YS=/\ufffd(\d+)\ufffd/,KS=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,QS=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,XS=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,JS=/\uE500/g;function eO(e,t,n,r,i,a,o){var s=XE(e,r,1,null),u=s<<PS.SHIFT,c=uC();t===c&&(c=null),null===c&&(u|=PS.APPEND_EAGERLY),o&&(u|=PS.COMMENT,function(e){void 0===Z_&&(Z_=e())}(WS)),i.push(u,null===a?"":a);var l=QE(e,s,o?32:1,null===a?"":a,null);AS(n,l);var f=l.index;return cC(l,!1),null!==c&&t!==c&&function(e,t){var n=e.insertBeforeIndex;null===n?(yE(TS,IS),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){true!=e&&Fm("Expecting array here",e,true,"==")}(Array.isArray(n)),n.push(t))}(c,f),l}function tO(e,t,n,r,i,a,o){var s=o.match(jS),u=eO(e,t,n,a,r,s?null:o,!1);s&&nO(i,o,u.index,null,0,null)}function nO(e,t,n,r,i,a){var o=e.length,s=o+1;e.push(null,null);for(var u=o+2,c=t.split(jS),l=0,f=0;f<c.length;f++){var h=c[f];if(1&f){var d=i+parseInt(h,10);e.push(-1-d),l|=rO(d)}else""!==h&&e.push(h)}return e.push(n<<2|(r?1:0)),r&&e.push(r,a),e[o]=l,e[s]=e.length-u,l}function rO(e){return 1<<Math.min(e,31)}function iO(e){for(var t,n,r="",i=0,a=!1;null!==(t=QS.exec(e));)a?t[0]==="\ufffd/*".concat(n,"\ufffd")&&(i=t.index,a=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],a=!0);return r+=e.substr(i)}function aO(e,t,n,r,i,a){var o=0,s={type:i.type,currentCaseLViewIndex:XE(e,t,1,null),anchorIdx:a,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(rO(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,a),function(e,t,n){var r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,a,s);for(var u=i.values,c=0;c<u.length;c++){for(var l=u[c],f=[],h=0;h<l.length;h++){var d=l[h];if("string"!=typeof d){var v=f.push(d)-1;l[h]="\x3c!--\ufffd".concat(v,"\ufffd--\x3e")}}o=uO(e,s,t,n,r,i.cases[c],l.join(""),f)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,a)}function oO(e){for(var t=[],n=[],r=1,i=0,a=sO(e=e.replace(KS,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""})),o=0;o<a.length;){var s=a[o++].trim();1===r&&(s=s.replace(/\s*(?:=)?(\w+)\s*/,"$1")),s.length&&t.push(s);var u=sO(a[o++]);t.length>n.length&&n.push(u)}return{type:r,mainBinding:i,cases:t,values:n}}function sO(e){if(!e)return[];var t,n=0,r=[],i=[],a=/[{}]/g;for(a.lastIndex=0;t=a.exec(e);){var o=t.index;if("}"==t[0]){if(r.pop(),0==r.length){var s=e.substring(n,o);KS.test(s)?i.push(oO(s)):i.push(s),n=o+1}}else{if(0==r.length){var u=e.substring(n,o);i.push(u),n=o+1}r.push("{")}}var c=e.substring(n);return i.push(c),i}function uO(e,t,n,r,i,a,o,s){var u=[],c=[],l=[];t.cases.push(a),t.create.push(u),t.remove.push(c),t.update.push(l);var f=s_(zk()).getInertBodyElement(o),h=A_(f)||f;return h?cO(e,t,n,r,u,c,l,h,i,s,0):0}function cO(e,t,n,r,i,a,o,s,u,c,l){for(var f=0,h=s.firstChild;h;){var d=XE(e,n,1,null);switch(h.nodeType){case Node.ELEMENT_NODE:var v=h,p=v.tagName.toLowerCase();if(C_.hasOwnProperty(p)){hO(i,ES,p,u,d),e.data[d]=p;for(var g=v.attributes,y=0;y<g.length;y++){var m=g.item(y),k=m.name.toLowerCase();m.value.match(jS)?E_.hasOwnProperty(k)&&nO(o,m.value,d,m.name,0,w_[k]?h_:__[k]?d_:null):dO(i,d,m)}f=cO(e,t,n,r,i,a,o,h,d,c,l+1)|f,lO(a,d,l)}break;case Node.TEXT_NODE:var C=h.textContent||"",w=C.match(jS);hO(i,null,w?"":C,u,d),lO(a,d,l),w&&(f=nO(o,C,d,null,0,null)|f);break;case Node.COMMENT_NODE:var _=YS.exec(h.textContent||"");if(_){var E=c[parseInt(_[1],10)];hO(i,bS,"",u,d),aO(e,n,r,u,E,d),fO(a,d,l)}}h=h.nextSibling}return f}function lO(e,t,n){0===n&&e.push(t)}function fO(e,t,n){0===n&&(e.push(~t),e.push(t))}function hO(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function dO(e,t,n){e.push(t<<1|1,n.name,n.value)}function vO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=iC(),i=rC(),a=20+e,o=Xk(r.consts,t),s=uC();r.firstCreatePass&&function(e,t,n,r,i,a){var o=uC(),s=[],u=[],c=[[]];i=function(e,t){if(function(e){return-1===e}(t))return iO(e);var n=e.indexOf(":".concat(t,"\ufffd"))+2+t.toString().length,r=e.search(new RegExp("\ufffd\\/\\*\\d+:".concat(t,"\ufffd")));return iO(e.substring(n,r))}(i,a);for(var l=function(e){return e.replace(JS," ")}(i).split(XS),f=0;f<l.length;f++){var h=l[f];if(0==(1&f))for(var d=sO(h),v=0;v<d.length;v++){var p=d[v];if(0==(1&v)){var g=p;""!==g&&tO(e,o,c[0],s,u,n,g)}else{var y=p;if("object"!=typeof y)throw new Error('Unable to parse ICU expression in "'.concat(i,'" message.'));aO(e,n,u,t,y,eO(e,o,c[0],n,s,"",!0).index)}}else{var m=47===h.charCodeAt(0),k=(h.charCodeAt(m?1:0),20+Number.parseInt(h.substring(m?2:1)));if(m)c.shift(),cC(uC(),!1);else{var C=LS(e,c[0],k);c.unshift([]),cC(C,!0)}}}e.data[r]={create:s,update:u}}(r,null===s?0:s.index,i,a,o,n);var u=r.data[a],c=uE(r,s===i[6]?null:s,i);(function(e,t,n,r){for(var i=e[11],a=0;a<t.length;a++){var o=t[a++],s=t[a],u=(o&PS.COMMENT)===PS.COMMENT,c=(o&PS.APPEND_EAGERLY)===PS.APPEND_EAGERLY,l=o>>>PS.SHIFT,f=e[l];null===f&&(f=e[l]=u?i.createComment(s):J_(i,s)),c&&null!==n&&cE(i,n,f,r,!1)}})(i,u.create,c,s&&8&s.type?i[s.index]:null),mC(!0)}function pO(){mC(!1)}function gO(e,t,n){vO(e,t,n),pO()}function yO(e){return function(e){e&&(BS|=1<<Math.min(zS,31)),zS++}(dP(rC(),gC(),e)),yO}function mO(e){!function(e,t,n){if(zS>0){var r=e.data[n];GS(e,t,Array.isArray(r)?r:r.update,pC()-zS-1,BS)}BS=0,zS=0}(iC(),rC(),e+20)}function kO(e,t,n,r,i){if(e=Mm(e),Array.isArray(e))for(var a=0;a<e.length;a++)kO(e[a],t,n,r,i);else{var o=iC(),s=rC(),u=Xb(e)?e:Mm(e.provide),c=Yb(e),l=oC(),f=1048575&l.providerIndexes,h=l.directiveStart,d=l.providerIndexes>>20;if(Xb(e)||!e.multi){var v=new zC(c,i,_P),p=_O(u,t,i?f:f+d,h);-1===p?(rw(JC(l,s),o,u),CO(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(v),s.push(v)):(n[p]=v,s[p]=v)}else{var g=_O(u,t,f+d,h),y=_O(u,t,f,f+d),m=g>=0&&n[g],k=y>=0&&n[y];if(i&&!k||!i&&!m){rw(JC(l,s),o,u);var C=function(e,t,n,r,i){var a=new zC(e,n,_P);return a.multi=[],a.index=t,a.componentProviders=0,wO(a,i,r&&!n),a}(i?bO:EO,n.length,i,r,c);!i&&k&&(n[y].providerFactory=C),CO(o,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(C),s.push(C)}else CO(o,e,g>-1?g:y,wO(n[i?y:g],c,!i&&r));!i&&r&&k&&n[y].componentProviders++}}}function CO(e,t,n,r){var i=Xb(t);if(i||function(e){return!!e.useClass}(t)){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[r,a]):o[s+1].push(r,a)}else o.push(n,a)}}}function wO(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function _O(e,t,n,r){for(var i=n;i<r;i++)if(t[i]===e)return i;return-1}function EO(e,t,n,r){return PO(this.multi,[])}function bO(e,t,n,r){var i,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=fw(n,n[1],this.providerFactory.index,r);PO(a,i=s.slice(0,o));for(var u=o;u<s.length;u++)i.push(s[u])}else PO(a,i=[]);return i}function PO(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function SO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=iC();if(r.firstCreatePass){var i=Ik(e);kO(n,r.data,r.blueprint,i,!0),kO(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}}var OO=my(function e(){gy(this,e)}),TO=function(){function e(){gy(this,e)}return my(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(Om(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),IO=function(){var e=my(function e(){gy(this,e)});return e.NULL=new TO,e}();function AO(){}function MO(e,t){return new RO(qk(e,t))}var xO=function(){return MO(oC(),rC())},RO=function(){var e=my(function e(t){gy(this,e),this.nativeElement=t});return e.__NG_ELEMENT_ID__=xO,e}();function NO(e){return e instanceof RO?e.nativeElement:e}var DO=my(function e(){gy(this,e)}),LO=function(){var e=my(function e(){gy(this,e)});return e.__NG_ELEMENT_ID__=function(){return FO()},e}(),FO=function(){var e=rC(),t=Yk(oC().index,e);return function(e){return e[11]}(bk(t)?t:e)},UO=function(){var e=my(function e(){gy(this,e)});return e.\u0275prov=Um({token:e,providedIn:"root",factory:function(){return null}}),e}(),VO=my(function e(t){gy(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}),BO=new VO("12.2.16"),zO=function(){function e(){gy(this,e)}return my(e,[{key:"supports",value:function(e){return lP(e)}},{key:"create",value:function(e){return new GO(e)}}]),e}(),HO=function(e,t){return t},GO=function(){function e(t){gy(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||HO}return my(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var a=!n||t&&t.currentIndex<WO(n,r,i)?t:n,o=WO(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)r++;else{i||(i=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var f=l<i.length?i[l]:i[l]=0,h=f+l;c<=h&&h<u&&(i[l]=f+1)}i[a.previousIndex]=c-u}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!lP(e))throw new Error("Error trying to diff '".concat(Om(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==a&&Object.is(a.trackById,i)?(o&&(a=this._verifyReinsertion(a,r,i,s)),Object.is(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[uP()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==a&&Object.is(a.trackById,i)?(o&&(a=t._verifyReinsertion(a,e,i,n)),Object.is(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,i,n),o=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new $O(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new qO),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new qO),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),$O=my(function e(t,n){gy(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}),ZO=function(){function e(){gy(this,e),this._head=null,this._tail=null}return my(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),qO=function(){function e(){gy(this,e),this.map=new Map}return my(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new ZO,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function WO(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var jO=function(){function e(){gy(this,e)}return my(e,[{key:"supports",value:function(e){return e instanceof Map||fP(e)}},{key:"create",value:function(){return new YO}}]),e}(),YO=function(){function e(){gy(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return my(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||fP(e)))throw new Error("Error trying to diff '".concat(Om(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var a=new KO(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),KO=my(function e(t){gy(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null});function QO(){return new XO([new zO])}var XO=function(){var e=function(){function e(t){gy(this,e),this.factories=t}return my(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(null!=t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||QO())},deps:[[e,new Yw,new jw]]}}}]),e}();return e.\u0275prov=Um({token:e,providedIn:"root",factory:QO}),e}();function JO(){return new eT([new jO])}var eT=function(){var e=function(){function e(t){gy(this,e),this.factories=t}return my(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||JO())},deps:[[e,new Yw,new jw]]}}}]),e}();return e.\u0275prov=Um({token:e,providedIn:"root",factory:JO}),e}();function tT(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var a=t[n.index];if(null!==a&&r.push($k(a)),Pk(a))for(var o=10;o<a.length;o++){var s=a[o],u=s[1].firstChild;null!==u&&tT(s[1],s,u,r)}var c=n.type;if(8&c)tT(e,t,n.child,r);else if(32&c)for(var l=W_(n,t),f=void 0;f=l();)r.push(f);else if(16&c){var h=CE(t,n);if(Array.isArray(h))r.push.apply(r,fy(h));else{var d=j_(t[16]);tT(d[1],d,h,r,!0)}}n=i?n.projectionNext:n.next}return r}var nT=function(){function e(t,n){gy(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return my(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return tT(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(e){this._lView[8]=e}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(Pk(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&(iE(e,n),Sw(t,n))}this._attachedToViewContainer=!1}aE(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){ub(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){Tb(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){Ib(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){dC(!0);try{Ib(e,t,n)}finally{dC(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,bE(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),rT=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e))._view=e,r}return my(n,[{key:"detectChanges",value:function(){Ab(this._view)}},{key:"checkNoChanges",value:function(){!function(e){dC(!0);try{Ab(e)}finally{dC(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(nT),iT=function(e){return function(e,t,n){if(Ok(e)&&!n){var r=Yk(e.index,t);return new nT(r,r)}return 47&e.type?new nT(t[16],t):null}(oC(),rC(),16==(16&e))},aT=function(){var e=my(function e(){gy(this,e)});return e.__NG_ELEMENT_ID__=iT,e}(),oT=[new jO],sT=new XO([new zO]),uT=new eT(oT),cT=function(){return hT(oC(),rC())},lT=function(){var e=my(function e(){gy(this,e)});return e.__NG_ELEMENT_ID__=cT,e}(),fT=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this))._declarationLView=e,a._declarationTContainer=r,a.elementRef=i,a}return my(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=YE(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),JE(t,n,e),new nT(n)}}]),n}(lT);function hT(e,t){return 4&e.type?new fT(t,e,MO(e,t)):null}var dT=my(function e(){gy(this,e)}),vT=my(function e(){gy(this,e)}),pT=function(){return CT(oC(),rC())},gT=function(){var e=my(function e(){gy(this,e)});return e.__NG_ELEMENT_ID__=pT,e}(),yT=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this))._lContainer=e,a._hostTNode=r,a._hostLView=i,a}return my(n,[{key:"element",get:function(){return MO(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new vw(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=nw(this._hostTNode,this._hostLView);if(WC(e)){var t=YC(e,this._hostLView),n=jC(e);return new vw(t[1].data[n+8],t)}return new vw(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=mT(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var a=n||this.parentInjector;if(!i&&null==e.ngModule&&a){var o=a.get(dT,null);o&&(i=o)}var s=e.create(a,r,void 0,i);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var r=e._lView,i=r[1];if(Pk(r[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=r[3],s=new n(o,o[6],o[3]);s.detach(s.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,r){var i=10+r,a=n.length;r>0&&(n[i-1][4]=t),r<a-10?(t[4]=n[i],Pw(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,r,c,u);var l=wE(u,c),f=r[11],h=hE(f,c[7]);return null!==h&&function(e,t,n,r,i,a){r[0]=i,r[6]=t,bE(e,r,n,1,i,a)}(i,c[6],f,r,h,l),e.attachToViewContainerRef(),Pw(kT(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=mT(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=iE(this._lContainer,t);n&&(Sw(kT(this._lContainer),t),aE(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=iE(this._lContainer,t);return n&&null!=Sw(kT(this._lContainer),t)?new nT(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!=e?e:this.length+t}}]),n}(gT);function mT(e){return e[8]}function kT(e){return e[8]||(e[8]=[])}function CT(e,t){var n,r=t[e.index];if(Pk(r))n=r;else{var i;if(8&e.type)i=$k(r);else{var a=t[11];i=a.createComment("");var o=qk(e,t);cE(a,hE(a,o),i,function(e,t){return Hk(e)?e.nextSibling(t):t.nextSibling}(a,o),!1)}t[e.index]=n=Eb(r,t,i,e),Ob(t,n)}return new yT(n,e,t)}var wT={},_T=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).ngModule=e,r}return my(n,[{key:"resolveComponentFactory",value:function(e){var t=_k(e);return new PT(t,this.ngModule)}}]),n}(IO);function ET(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var bT=new Cw("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return G_}}),PT=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(UE).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return my(n,[{key:"inputs",get:function(){return ET(this.componentDef.inputs)}},{key:"outputs",get:function(){return ET(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,r){var i,a,o=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var a=e.get(n,wT,i);return a!==wT||r===wT?a:t.get(n,r,i)}}}(e,r.injector):e,s=o.get(DO,Gk),u=o.get(UO,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",f=n?function(e,t,n){if(Hk(e))return e.selectRootElement(t,n===Jm.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):nE(s.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?Bk:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),h=this.componentDef.onPush?576:528,d={components:[],scheduler:G_,clean:xb,playerHandler:null,flags:0},v=sb(0,null,null,1,0,null,null,null,null,null),p=YE(null,v,d,h,null,null,s,c,u,o);PC(p);try{var g=function(e,t,n,r,i,a){var o=n[1];n[20]=e;var s=KE(o,20,2,"#host",null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(Ub(s,u,!0),null!==e&&(HC(i,e,u),null!==s.classes&&OE(i,e,s.classes),null!==s.styles&&SE(i,e,s.styles)));var c=r.createRenderer(e,t),l=YE(n,ob(t),null,t.onPush?64:16,n[20],s,r,c,null,null);return o.firstCreatePass&&(rw(JC(s,n),o,t.type),vb(o,s),gb(s,n.length,1)),Ob(n,l),n[20]=l}(f,this.componentDef,p,s,c);if(f)if(n)HC(c,f,["ng-version",BO.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var a=e[r];if("string"==typeof a)2===i?""!==a&&t.push(a,e[++r]):8===i&&n.push(a);else{if(!NE(i))break;i=a}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),m=y.attrs,k=y.classes;m&&HC(c,f,m),k&&k.length>0&&OE(c,f,k.join(" "))}if(a=Wk(v,20),void 0!==t)for(var C=a.projection=[],w=0;w<this.ngContentSelectors.length;w++){var _=t[w];C.push(null!=_?Array.from(_):null)}i=function(e,t,n,r,i){var a=n[1],o=function(e,t,n){var r=oC();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),yb(e,r,t,XE(e,t,1,null),n));var i=fw(t,e,r.directiveStart,r);L_(i,t);var a=qk(r,t);return a&&L_(a,t),i}(a,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(function(e){return e(o,t)}),t.contentQueries){var s=oC();t.contentQueries(1,o,s.directiveStart)}var u=oC();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(xC(u.index),hb(n[1],u,0,u.directiveStart,u.directiveEnd,t),db(t,o)),o}(g,this.componentDef,p,d,[tP]),JE(v,p,null)}finally{AC()}return new ST(this.componentType,i,MO(a,p),p,a)}}]),n}(OO),ST=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o){var s;return gy(this,n),(s=t.call(this)).location=i,s._rootLView=a,s._tNode=o,s.instance=r,s.hostView=s.changeDetectorRef=new rT(a),s.componentType=e,s}return my(n,[{key:"injector",get:function(){return new vw(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return my(function e(){gy(this,e)})}()),OT=new Map,TT=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;gy(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=uy(i),i.destroyCbs=[],i.componentFactoryResolver=new _T(uy(i));var a=Ek(e),o=e[lk]||null;return o&&OS(o),i._bootstrapComponents=$_(a.bootstrap),i._r3Injector=qb(e,r,[{provide:dT,useValue:uy(i)},{provide:IO,useValue:i.componentFactoryResolver}],Om(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return my(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eP.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jm.Default;return e===eP||e===dT||e===Bb?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(dT),IT=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).moduleType=e,null!==Ek(e)&&function(e){var t=new Set;!function e(n){var r=Ek(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(Om(t)," vs ").concat(Om(t.name)))}(i,OT.get(i),n),OT.set(i,n));var a,o=dy($_(r.imports));try{for(o.s();!(a=o.n()).done;){var s=a.value;t.has(s)||(t.add(s),e(s))}}catch(u){o.e(u)}finally{o.f()}}(e)}(e),r}return my(n,[{key:"create",value:function(e){return new TT(this.moduleType,e)}}]),n}(vT);function AT(e,t,n){var r=vC()+e,i=rC();return i[r]===VE?hP(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function MT(e,t,n,r){return RT(rC(),vC(),e,t,n,r)}function xT(e,t){var n=e[t];return n===VE?void 0:n}function RT(e,t,n,r,i,a){var o=t+n;return dP(e,o,i)?hP(e,o+1,a?r.call(a,i):r(i)):xT(e,o+1)}function NT(e,t){var n,r=iC(),i=e+20;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new Rm("302","The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var a=n.factory||(n.factory=Mk(n.type)),o=Ym(_P);try{var s=QC(!1),u=a();return QC(s),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(r,rC(),i,u),u}finally{Ym(o)}}function DT(e,t,n){var r=e+20,i=rC(),a=jk(i,r);return FT(i,LT(i,r)?RT(i,vC(),t,a.transform,n,a):a.transform(n))}function LT(e,t){return e[1].data[t].pure}function FT(e,t){return cP.isWrapped(t)&&(t=cP.unwrap(t),e[pC()]=VE),t}function UT(e){return function(t){setTimeout(e,void 0,t)}}var VT=function(e){iy(n,e);var t=oy(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return gy(this,n),(e=t.call(this)).__isAsync=r,e}return my(n,[{key:"emit",value:function(e){ny(ly(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var i,a,o,s=e,u=t||function(){return null},c=r;if(e&&"object"==typeof e){var l=e;s=null===(i=l.next)||void 0===i?void 0:i.bind(l),u=null===(a=l.error)||void 0===a?void 0:a.bind(l),c=null===(o=l.complete)||void 0===o?void 0:o.bind(l)}this.__isAsync&&(u=UT(u),s&&(s=UT(s)),c&&(c=UT(c)));var f=ny(ly(n.prototype),"subscribe",this).call(this,{next:s,error:u,complete:c});return e instanceof yy&&e.add(f),f}}]),n}(Zy);function BT(){return this._results[uP()]()}var zT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];gy(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=uP(),r=e.prototype;r[n]||(r[n]=BT)}return my(e,[{key:"changes",get:function(){return this._changes||(this._changes=new VT)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){var n=this;n.dirty=!1;var r=Ew(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],a=t[r];if(n&&(i=n(i),a=n(a)),a!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}();Symbol;var HT=function(){function e(t){gy(this,e),this.queryList=t,this.matches=null}return my(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),GT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];gy(this,e),this.queries=t}return my(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[],a=0;a<r;a++){var o=n.getByIndex(a);i.push(this.queries[o.indexInDeclarationView].clone())}return new e(i)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==eI(e,t).matches&&this.queries[t].setDirty()}}]),e}(),$T=my(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;gy(this,e),this.predicate=t,this.flags=n,this.read=r}),ZT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];gy(this,e),this.queries=t}return my(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,a=this.getByIndex(r).embeddedTView(t,i);a&&(a.indexInDeclarationView=r,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),qT=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;gy(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return my(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];this.matchTNodeWithReadOption(e,t,WT(t,i)),this.matchTNodeWithReadOption(e,t,lw(t,e,i,!1,!1))}else n===lT?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,lw(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===RO||r===gT||r===lT&&4&t.type)this.addMatch(t.index,-2);else{var i=lw(t,e,r,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function WT(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function jT(e,t,n,r){return-1===n?function(e,t){return 11&e.type?MO(e,t):4&e.type?hT(e,t):null}(t,e):-2===n?function(e,t,n){return n===RO?MO(t,e):n===lT?hT(t,e):n===gT?CT(t,e):void 0}(e,t,r):fw(e,e[1],n,t)}function YT(e,t,n,r){var i=t[19].queries[r];if(null===i.matches){for(var a=e.data,o=n.matches,s=[],u=0;u<o.length;u+=2){var c=o[u];s.push(c<0?null:jT(t,a[c],o[u+1],n.metadata.read))}i.matches=s}return i.matches}function KT(e,t,n,r){var i=e.queries.getByIndex(n),a=i.matches;if(null!==a)for(var o=YT(e,t,i,n),s=0;s<a.length;s+=2){var u=a[s];if(u>0)r.push(o[s/2]);else{for(var c=a[s+1],l=t[-u],f=10;f<l.length;f++){var h=l[f];h[17]===h[3]&&KT(h[1],h,c,r)}if(null!==l[9])for(var d=l[9],v=0;v<d.length;v++){var p=d[v];KT(p[1],p,c,r)}}}return r}function QT(e){var t=rC(),n=iC(),r=wC();_C(r+1);var i=eI(n,r);if(e.dirty&&Kk(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{var a=i.crossesNgTemplate?KT(n,t,r,[]):YT(n,t,i,r);e.reset(a,NO),e.notifyOnChanges()}return!0}return!1}function XT(e,t,n){var r=iC();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new ZT),e.queries.track(new qT(t,-1))}(r,new $T(e,t,n)),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){var r=new zT(4==(4&n));ub(e,t,r,r.destroy),null===t[19]&&(t[19]=new GT),t[19].queries.push(new HT(r))}(r,rC(),t)}function JT(){return e=rC(),t=wC(),e[19].queries[t].queryList;var e,t}function eI(e,t){return e.queries.getByIndex(t)}function tI(e,t){return hT(e,t)}var nI=new Cw("Application Initializer"),rI=function(){var e=function(){function e(t){var n=this;gy(this,e),this.appInits=t,this.resolve=AO,this.reject=AO,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return my(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=function(n){var r=e.appInits[n]();if(MP(r))t.push(r);else if(xP(r)){var i=new Promise(function(e,t){r.subscribe({complete:e,error:t})});t.push(i)}},i=0;i<this.appInits.length;i++)r(i);Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(nI,8))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),iI=new Cw("AppId"),aI={provide:iI,useFactory:function(){return"".concat(oI()).concat(oI()).concat(oI())},deps:[]};function oI(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var sI=new Cw("Platform Initializer"),uI=new Cw("Platform ID"),cI=new Cw("appBootstrapListener"),lI=function(){var e=function(){function e(){gy(this,e)}return my(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),fI=new Cw("LocaleId"),hI=new Cw("DefaultCurrencyCode"),dI=my(function e(t,n){gy(this,e),this.ngModuleFactory=t,this.componentFactories=n}),vI=function(e){return new IT(e)},pI=vI,gI=function(e){return Promise.resolve(vI(e))},yI=function(e){var t=vI(e),n=$_(Ek(e).declarations).reduce(function(e,t){var n=_k(t);return n&&e.push(new PT(n)),e},[]);return new dI(t,n)},mI=yI,kI=function(e){return Promise.resolve(yI(e))},CI=function(){var e=function(){function e(){gy(this,e),this.compileModuleSync=pI,this.compileModuleAsync=gI,this.compileModuleAndAllComponentsSync=mI,this.compileModuleAndAllComponentsAsync=kI}return my(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),wI=Promise.resolve(0);function _I(e){"undefined"==typeof Zone?wI.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var EI=function(){function e(t){var n=t.enableLongStackTrace,r=void 0!==n&&n,i=t.shouldCoalesceEventChangeDetection,a=void 0!==i&&i,o=t.shouldCoalesceRunChangeDetection,s=void 0!==o&&o;if(gy(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new VT(!1),this.onMicrotaskEmpty=new VT(!1),this.onStable=new VT(!1),this.onError=new VT(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!s&&a,u.shouldCoalesceRunChangeDetection=s,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function(){var e=rk.requestAnimationFrame,t=rk.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){var t=function(){!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(rk,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,SI(e),e.isCheckStableRunning=!0,PI(e),e.isCheckStableRunning=!1},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),SI(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(n,r,i,a,o,s){try{return OI(e),n.invokeTask(i,a,o,s)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),TI(e)}},onInvoke:function(n,r,i,a,o,s,u){try{return OI(e),n.invoke(i,a,o,s,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),TI(e)}},onHasTask:function(t,n,r,i){t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,SI(e),PI(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,n,r,i){return t.handleError(r,i),e.runOutsideAngular(function(){return e.onError.emit(i)}),!1}})}(u)}return my(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,e,bI,AO,AO);try{return i.runTask(a,t,n)}finally{i.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),bI={};function PI(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function SI(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function OI(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function TI(e){e._nesting--,PI(e)}var II,AI=function(){function e(){gy(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new VT,this.onMicrotaskEmpty=new VT,this.onStable=new VT,this.onError=new VT}return my(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),MI=function(){var e=function(){function e(t){var n=this;gy(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return my(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){EI.assertNotInAngularZone(),_I(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())_I(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(EI))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),xI=function(){var e=function(){function e(){gy(this,e),this._applications=new Map,RI.addToWindow(this)}return my(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return RI.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),RI=new(function(){function e(){gy(this,e)}return my(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),NI=!0,DI=!1,LI=new Cw("AllowMultipleToken"),FI=my(function e(t,n){gy(this,e),this.name=t,this.token=n});function UI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new Cw(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=VI();if(!a||a.injector.get(LI,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var o=n.concat(t).concat({provide:i,useValue:!0},{provide:Hb,useValue:"platform"});!function(e){if(II&&!II.destroyed&&!II.injector.get(LI,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");II=e.get(BI);var t=e.get(sI,null);t&&t.forEach(function(e){return e()})}(eP.create({providers:o,name:r}))}return function(e){var t=VI();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function VI(){return II&&!II.destroyed?II:null}var BI=function(){var e=function(){function e(t){gy(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return my(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n=this,r=function(e,t){return"noop"===e?new AI:("zone.js"===e?void 0:e)||new EI({enableLongStackTrace:(DI=!0,NI),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)})}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),i=[{provide:EI,useValue:r}];return r.run(function(){var a=eP.create({providers:i,parent:n.injector,name:e.moduleType.name}),o=e.create(a),s=o.injector.get(B_,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.runOutsideAngular(function(){var e=r.onError.subscribe({next:function(e){s.handleError(e)}});o.onDestroy(function(){GI(n._modules,o),e.unsubscribe()})}),function(e,r,i){try{var a=((s=o.injector.get(rI)).runInitializers(),s.donePromise.then(function(){return OS(o.injector.get(fI,_S)||_S),n._moduleDoBootstrap(o),o}));return MP(a)?a.catch(function(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}):a}catch(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}var s}(s,r)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=zI({},n);return function(e,t,n){var r=new IT(n);return Promise.resolve(r)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(HI);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(Om(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(eP))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}();function zI(e,t){return Array.isArray(t)?t.reduce(zI,e):Object.assign(Object.assign({},e),t)}var HI=function(){var e=function(){function e(t,n,r,i,a){var o=this;gy(this,e),this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){o._zone.run(function(){o.tick()})}});var s=new Hy(function(e){o._stable=o._zone.isStable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks,o._zone.runOutsideAngular(function(){e.next(o._stable),e.complete()})}),u=new Hy(function(e){var t;o._zone.runOutsideAngular(function(){t=o._zone.onStable.subscribe(function(){EI.assertNotInAngularZone(),_I(function(){!o._stable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks&&(o._stable=!0,e.next(!0))})})});var n=o._zone.onUnstable.subscribe(function(){EI.assertInAngularZone(),o._stable&&(o._stable=!1,o._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=mm(t),i=function(e,t){return"number"==typeof gm(e)?e.pop():1/0}(t),a=t;return a.length?1===a.length?lm(a[0]):vm(i)(_m(a,r)):pm}(s,u.pipe(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connector,n=void 0===t?function(){return new Zy}:t,r=e.resetOnError,i=void 0===r||r,a=e.resetOnComplete,o=void 0===a||a,s=e.resetOnRefCountZero,u=void 0===s||s;return function(e){var t=null,r=null,a=null,s=0,c=!1,l=!1,f=function(){null==r||r.unsubscribe(),r=null},h=function(){f(),t=a=null,c=l=!1},d=function(){var e=t;h(),null==e||e.unsubscribe()};return jy(function(e,v){var p;s++,!l&&!c&&f();var g=a=null!==(p=a)&&void 0!==p?p:n();v.add(function(){0===--s&&!l&&!c&&(r=bm(d,u))}),g.subscribe(v),t||(t=new Dy({next:function(e){return g.next(e)},error:function(e){l=!0,f(),r=bm(h,i,e),g.error(e)},complete:function(){c=!0,f(),r=bm(h,o),g.complete()}}),_m(e).subscribe(t))})(e)}}()))}return my(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof OO?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(dT),a=n.create(eP.NULL,[],t||n.selector,i),o=a.location.nativeElement,s=a.injector.get(MI,null),u=s&&a.injector.get(xI);return s&&u&&u.registerApplication(o,s),a.onDestroy(function(){r.detachView(a.hostView),GI(r.components,a),u&&u.unregisterApplication(o)}),this._loadComponent(a),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=dy(this._views);try{for(n.s();!(t=n.n()).done;){var r;t.value.detectChanges()}}catch(i){n.e(i)}finally{n.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;GI(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(cI,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(EI),Bw(eP),Bw(B_),Bw(IO),Bw(rI))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}();function GI(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var $I=my(function e(){gy(this,e)}),ZI=my(function e(){gy(this,e)}),qI={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},WI=function(){var e=function(){function e(t,n){gy(this,e),this._compiler=t,this._config=n||qI}return my(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,n=Qg(e.split("#"),2),r=n[0],i=n[1];return void 0===i&&(i="default"),Jg(8255)(r).then(function(e){return e[i]}).then(function(e){return jI(e,r,i)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=Qg(e.split("#"),2),n=t[0],r=t[1],i="NgFactory";return void 0===r&&(r="default",i=""),Jg(8255)(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then(function(e){return e[r+i]}).then(function(e){return jI(e,n,r)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(CI),Bw(ZI,8))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}();function jI(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var YI=UI(null,"core",[{provide:uI,useValue:"unknown"},{provide:BI,deps:[eP]},{provide:xI,deps:[]},{provide:lI,deps:[]}]),KI=[{provide:HI,useClass:HI,deps:[EI,eP,B_,IO,rI]},{provide:bT,deps:[EI],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:rI,useClass:rI,deps:[[new jw,nI]]},{provide:CI,useClass:CI,deps:[]},aI,{provide:XO,useFactory:function(){return sT},deps:[]},{provide:eT,useFactory:function(){return uT},deps:[]},{provide:fI,useFactory:function(e){return OS(e=e||"undefined"!=typeof $localize&&$localize.locale||_S),e},deps:[[new Ww(fI),new jw,new Yw]]},{provide:hI,useValue:"USD"}],QI=function(){var e=my(function e(t){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)(Bw(HI))},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({providers:KI}),e}(),XI=null;function JI(){return XI}var eA=new Cw("DocumentToken"),tA=function(){var e=function(){function e(){gy(this,e)}return my(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({factory:nA,token:e,providedIn:"platform"}),e}();function nA(){return Bw(iA)}var rA=new Cw("Location Initialized"),iA=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this))._doc=e,r._init(),r}return my(n,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return JI().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){var t=JI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),function(){return t.removeEventListener("popstate",e)}}},{key:"onHashChange",value:function(e){var t=JI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),function(){return t.removeEventListener("hashchange",e)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){aA()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){aA()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(e)}},{key:"getState",value:function(){return this._history.state}}]),n}(tA);return e.\u0275fac=function(t){return new(t||e)(Bw(eA))},e.\u0275prov=Um({factory:oA,token:e,providedIn:"platform"}),e}();function aA(){return!!window.history.pushState}function oA(){return new iA(Bw(eA))}function sA(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function uA(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function cA(e){return e&&"?"!==e[0]?"?"+e:e}var lA=function(){var e=function(){function e(){gy(this,e)}return my(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({factory:fA,token:e,providedIn:"root"}),e}();function fA(e){var t=Bw(eA).location;return new dA(Bw(tA),t&&t.origin||"")}var hA=new Cw("appBaseHref"),dA=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;if(gy(this,n),(i=t.call(this))._platformLocation=e,i._removeListenerFns=[],null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,sy(i)}return my(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return sA(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+cA(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+cA(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+cA(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(lA);return e.\u0275fac=function(t){return new(t||e)(Bw(tA),Bw(hA,8))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),vA=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this))._platformLocation=e,i._baseHref="",i._removeListenerFns=[],null!=r&&(i._baseHref=r),i}return my(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=sA(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+cA(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+cA(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(lA);return e.\u0275fac=function(t){return new(t||e)(Bw(tA),Bw(hA,8))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),pA=function(){var e=function(){function e(t,n){var r=this;gy(this,e),this._subject=new VT,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=uA(yA(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return my(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+cA(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,yA(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+cA(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+cA(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformStrategy).historyGo)||void 0===t||t.call(e,n)}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(lA),Bw(tA))},e.normalizeQueryParams=cA,e.joinWithSlash=sA,e.stripTrailingSlash=uA,e.\u0275prov=Um({factory:gA,token:e,providedIn:"root"}),e}();function gA(){return new pA(Bw(lA),Bw(tA))}function yA(e){return e.replace(/\/index.html$/,"")}var mA=((mA=mA||{})[mA.Decimal=0]="Decimal",mA[mA.Percent=1]="Percent",mA[mA.Currency=2]="Currency",mA[mA.Scientific=3]="Scientific",mA),kA=((kA=kA||{})[kA.Zero=0]="Zero",kA[kA.One=1]="One",kA[kA.Two=2]="Two",kA[kA.Few=3]="Few",kA[kA.Many=4]="Many",kA[kA.Other=5]="Other",kA),CA=((CA=CA||{})[CA.Format=0]="Format",CA[CA.Standalone=1]="Standalone",CA),wA=((wA=wA||{})[wA.Narrow=0]="Narrow",wA[wA.Abbreviated=1]="Abbreviated",wA[wA.Wide=2]="Wide",wA[wA.Short=3]="Short",wA),_A=((_A=_A||{})[_A.Short=0]="Short",_A[_A.Medium=1]="Medium",_A[_A.Long=2]="Long",_A[_A.Full=3]="Full",_A),EA=((EA=EA||{})[EA.Decimal=0]="Decimal",EA[EA.Group=1]="Group",EA[EA.List=2]="List",EA[EA.PercentSign=3]="PercentSign",EA[EA.PlusSign=4]="PlusSign",EA[EA.MinusSign=5]="MinusSign",EA[EA.Exponential=6]="Exponential",EA[EA.SuperscriptingExponent=7]="SuperscriptingExponent",EA[EA.PerMille=8]="PerMille",EA[EA.Infinity=9]="Infinity",EA[EA.NaN=10]="NaN",EA[EA.TimeSeparator=11]="TimeSeparator",EA[EA.CurrencyDecimal=12]="CurrencyDecimal",EA[EA.CurrencyGroup=13]="CurrencyGroup",EA);function bA(e,t){return AA(yS(e)[CS.DateFormat],t)}function PA(e,t){return AA(yS(e)[CS.TimeFormat],t)}function SA(e,t){return AA(yS(e)[CS.DateTimeFormat],t)}function OA(e,t){var n=yS(e),r=n[CS.NumberSymbols][t];if(void 0===r){if(t===EA.CurrencyDecimal)return n[CS.NumberSymbols][EA.Decimal];if(t===EA.CurrencyGroup)return n[CS.NumberSymbols][EA.Group]}return r}var TA=mS;function IA(e){if(!e[CS.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[CS.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function AA(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function MA(e){var t=Qg(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var xA=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,RA={},NA=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,DA=((DA=DA||{})[DA.Short=0]="Short",DA[DA.ShortGMT=1]="ShortGMT",DA[DA.Long=2]="Long",DA[DA.Extended=3]="Extended",DA),LA=((LA=LA||{})[LA.FullYear=0]="FullYear",LA[LA.Month=1]="Month",LA[LA.Date=2]="Date",LA[LA.Hours=3]="Hours",LA[LA.Minutes=4]="Minutes",LA[LA.Seconds=5]="Seconds",LA[LA.FractionalSeconds=6]="FractionalSeconds",LA[LA.Day=7]="Day",LA),FA=((FA=FA||{})[FA.DayPeriods=0]="DayPeriods",FA[FA.Days=1]="Days",FA[FA.Months=2]="Months",FA[FA.Eras=3]="Eras",FA);function UA(e,t,n,r){var i=function(e){if(QA(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){var t=e.split("-").map(function(e){return+e}),n=Qg(t,3),r=n[0],i=n[1],a=void 0===i?1:i,o=n[2];return VA(r,a-1,void 0===o?1:o)}var s,u=parseFloat(e);if(!isNaN(e-u))return new Date(u);if(s=e.match(xA))return function(e){var t=new Date(0),n=0,r=0,i=e[8]?t.setUTCFullYear:t.setFullYear,a=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return a.call(t,o,s,u,c),t}(s)}var c=new Date(e);if(!QA(c))throw new Error('Unable to convert "'.concat(e,'" into a date'));return c}(e);t=BA(n,t)||t;for(var a,o=[];t;){if(!(a=NA.exec(t))){o.push(t);break}var s=(o=o.concat(a.slice(1))).pop();if(!s)break;t=s}var u=i.getTimezoneOffset();r&&(u=KA(r,u),i=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(KA(t,r)-r))}(i,r));var c="";return o.forEach(function(e){var t=function(e){if(YA[e])return YA[e];var t;switch(e){case"G":case"GG":case"GGG":t=$A(FA.Eras,wA.Abbreviated);break;case"GGGG":t=$A(FA.Eras,wA.Wide);break;case"GGGGG":t=$A(FA.Eras,wA.Narrow);break;case"y":t=GA(LA.FullYear,1,0,!1,!0);break;case"yy":t=GA(LA.FullYear,2,0,!0,!0);break;case"yyy":t=GA(LA.FullYear,3,0,!1,!0);break;case"yyyy":t=GA(LA.FullYear,4,0,!1,!0);break;case"Y":t=jA(1);break;case"YY":t=jA(2,!0);break;case"YYY":t=jA(3);break;case"YYYY":t=jA(4);break;case"M":case"L":t=GA(LA.Month,1,1);break;case"MM":case"LL":t=GA(LA.Month,2,1);break;case"MMM":t=$A(FA.Months,wA.Abbreviated);break;case"MMMM":t=$A(FA.Months,wA.Wide);break;case"MMMMM":t=$A(FA.Months,wA.Narrow);break;case"LLL":t=$A(FA.Months,wA.Abbreviated,CA.Standalone);break;case"LLLL":t=$A(FA.Months,wA.Wide,CA.Standalone);break;case"LLLLL":t=$A(FA.Months,wA.Narrow,CA.Standalone);break;case"w":t=WA(1);break;case"ww":t=WA(2);break;case"W":t=WA(1,!0);break;case"d":t=GA(LA.Date,1);break;case"dd":t=GA(LA.Date,2);break;case"c":case"cc":t=GA(LA.Day,1);break;case"ccc":t=$A(FA.Days,wA.Abbreviated,CA.Standalone);break;case"cccc":t=$A(FA.Days,wA.Wide,CA.Standalone);break;case"ccccc":t=$A(FA.Days,wA.Narrow,CA.Standalone);break;case"cccccc":t=$A(FA.Days,wA.Short,CA.Standalone);break;case"E":case"EE":case"EEE":t=$A(FA.Days,wA.Abbreviated);break;case"EEEE":t=$A(FA.Days,wA.Wide);break;case"EEEEE":t=$A(FA.Days,wA.Narrow);break;case"EEEEEE":t=$A(FA.Days,wA.Short);break;case"a":case"aa":case"aaa":t=$A(FA.DayPeriods,wA.Abbreviated);break;case"aaaa":t=$A(FA.DayPeriods,wA.Wide);break;case"aaaaa":t=$A(FA.DayPeriods,wA.Narrow);break;case"b":case"bb":case"bbb":t=$A(FA.DayPeriods,wA.Abbreviated,CA.Standalone,!0);break;case"bbbb":t=$A(FA.DayPeriods,wA.Wide,CA.Standalone,!0);break;case"bbbbb":t=$A(FA.DayPeriods,wA.Narrow,CA.Standalone,!0);break;case"B":case"BB":case"BBB":t=$A(FA.DayPeriods,wA.Abbreviated,CA.Format,!0);break;case"BBBB":t=$A(FA.DayPeriods,wA.Wide,CA.Format,!0);break;case"BBBBB":t=$A(FA.DayPeriods,wA.Narrow,CA.Format,!0);break;case"h":t=GA(LA.Hours,1,-12);break;case"hh":t=GA(LA.Hours,2,-12);break;case"H":t=GA(LA.Hours,1);break;case"HH":t=GA(LA.Hours,2);break;case"m":t=GA(LA.Minutes,1);break;case"mm":t=GA(LA.Minutes,2);break;case"s":t=GA(LA.Seconds,1);break;case"ss":t=GA(LA.Seconds,2);break;case"S":t=GA(LA.FractionalSeconds,1);break;case"SS":t=GA(LA.FractionalSeconds,2);break;case"SSS":t=GA(LA.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=ZA(DA.Short);break;case"ZZZZZ":t=ZA(DA.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=ZA(DA.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=ZA(DA.Long);break;default:return null}return YA[e]=t,t}(e);c+=t?t(i,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function VA(e,t,n){var r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function BA(e,t){var n=function(e){return yS(e)[CS.LocaleId]}(e);if(RA[n]=RA[n]||{},RA[n][t])return RA[n][t];var r="";switch(t){case"shortDate":r=bA(e,_A.Short);break;case"mediumDate":r=bA(e,_A.Medium);break;case"longDate":r=bA(e,_A.Long);break;case"fullDate":r=bA(e,_A.Full);break;case"shortTime":r=PA(e,_A.Short);break;case"mediumTime":r=PA(e,_A.Medium);break;case"longTime":r=PA(e,_A.Long);break;case"fullTime":r=PA(e,_A.Full);break;case"short":var i=BA(e,"shortTime"),a=BA(e,"shortDate");r=zA(SA(e,_A.Short),[i,a]);break;case"medium":var o=BA(e,"mediumTime"),s=BA(e,"mediumDate");r=zA(SA(e,_A.Medium),[o,s]);break;case"long":var u=BA(e,"longTime"),c=BA(e,"longDate");r=zA(SA(e,_A.Long),[u,c]);break;case"full":var l=BA(e,"fullTime"),f=BA(e,"fullDate");r=zA(SA(e,_A.Full),[l,f])}return r&&(RA[n][t]=r),r}function zA(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function HA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,a=n));for(var o=String(e);o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),a+o}function GA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(a,o){var s=function(e,t){switch(e){case LA.FullYear:return t.getFullYear();case LA.Month:return t.getMonth();case LA.Date:return t.getDate();case LA.Hours:return t.getHours();case LA.Minutes:return t.getMinutes();case LA.Seconds:return t.getSeconds();case LA.FractionalSeconds:return t.getMilliseconds();case LA.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,a);if((n>0||s>-n)&&(s+=n),e===LA.Hours)0===s&&-12===n&&(s=12);else if(e===LA.FractionalSeconds)return function(e,t){return HA(e,3).substr(0,t)}(s,t);var u=OA(o,EA.MinusSign);return HA(s,t,u,r,i)}}function $A(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:CA.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,a){return function(e,t,n,r,i,a){switch(n){case FA.Months:return function(e,t,n){var r=yS(e),i=AA([r[CS.MonthsFormat],r[CS.MonthsStandalone]],t);return AA(i,n)}(t,i,r)[e.getMonth()];case FA.Days:return function(e,t,n){var r=yS(e),i=AA([r[CS.DaysFormat],r[CS.DaysStandalone]],t);return AA(i,n)}(t,i,r)[e.getDay()];case FA.DayPeriods:var o=e.getHours(),s=e.getMinutes();if(a){var u=function(e){var t=yS(e);return IA(t),(t[CS.ExtraData][2]||[]).map(function(e){return"string"==typeof e?MA(e):[MA(e[0]),MA(e[1])]})}(t),c=function(e,t,n){var r=yS(e);IA(r);var i=AA([r[CS.ExtraData][0],r[CS.ExtraData][1]],t)||[];return AA(i,n)||[]}(t,i,r),l=u.findIndex(function(e){if(Array.isArray(e)){var t=Qg(e,2),n=t[0],r=t[1],i=o>=n.hours&&s>=n.minutes,a=o<r.hours||o===r.hours&&s<r.minutes;if(n.hours<r.hours){if(i&&a)return!0}else if(i||a)return!0}else if(e.hours===o&&e.minutes===s)return!0;return!1});if(-1!==l)return c[l]}return function(e,t,n){var r=yS(e),i=AA([r[CS.DayPeriodsFormat],r[CS.DayPeriodsStandalone]],t);return AA(i,n)}(t,i,r)[o<12?0:1];case FA.Eras:return function(e,t){return AA(yS(e)[CS.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(i,a,e,t,n,r)}}function ZA(e){return function(t,n,r){var i=-1*r,a=OA(n,EA.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case DA.Short:return(i>=0?"+":"")+HA(o,2,a)+HA(Math.abs(i%60),2,a);case DA.ShortGMT:return"GMT"+(i>=0?"+":"")+HA(o,1,a);case DA.Long:return"GMT"+(i>=0?"+":"")+HA(o,2,a)+":"+HA(Math.abs(i%60),2,a);case DA.Extended:return 0===r?"Z":(i>=0?"+":"")+HA(o,2,a)+":"+HA(Math.abs(i%60),2,a);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function qA(e){return VA(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function WA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i;if(t){var a=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+a)/7)}else{var s=qA(n),u=function(e){var t=VA(e,0,1).getDay();return VA(e,0,1+(t<=4?4:11)-t)}(s.getFullYear()),c=s.getTime()-u.getTime();i=1+Math.round(c/6048e5)}return HA(i,e,OA(r,EA.MinusSign))}}function jA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return HA(qA(n).getFullYear(),e,OA(r,EA.MinusSign),t)}}var YA={};function KA(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function QA(e){return e instanceof Date&&!isNaN(e.valueOf())}var XA=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function JA(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var eM=my(function e(){gy(this,e)}),tM=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).locale=e,r}return my(n,[{key:"getPluralCategory",value:function(e,t){switch(TA(t||this.locale)(e)){case kA.Zero:return"zero";case kA.One:return"one";case kA.Two:return"two";case kA.Few:return"few";case kA.Many:return"many";default:return"other"}}}]),n}(eM);return e.\u0275fac=function(t){return new(t||e)(Bw(fI))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}();function nM(e,t){t=encodeURIComponent(t);var n,r=dy(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.indexOf("="),o=Qg(-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var rM=function(){var e=function(){function e(t,n,r,i){gy(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return my(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(lP(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(Om(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(XO),_P(eT),_P(RO),_P(LO))},e.\u0275dir=Ck({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e}(),iM=function(){function e(t,n,r,i){gy(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return my(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),aM=function(){var e=function(){function e(t,n,r){gy(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return my(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(n){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'. NgFor only supports binding to Iterables such as Arrays."))}}if(this._differ){var t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new iM(null,t._ngForOf,-1,-1),null===i?void 0:i),o=new oM(e,a);n.push(o)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new oM(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,a=this._viewContainer.length;i<a;i++){var o=this._viewContainer.get(i);o.context.index=i,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(gT),_P(lT),_P(XO))},e.\u0275dir=Ck({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e}(),oM=my(function e(t,n){gy(this,e),this.record=t,this.view=n}),sM=function(){var e=function(){function e(t,n){gy(this,e),this._viewContainer=t,this._context=new uM,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return my(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){cM("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){cM("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(gT),_P(lT))},e.\u0275dir=Ck({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e}(),uM=my(function e(){gy(this,e),this.$implicit=null,this.ngIf=null});function cM(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(Om(t),"'."))}var lM=function(){var e=function(){function e(t){gy(this,e),this._locale=t}return my(e,[{key:"transform",value:function(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!1;if(isFinite(e)){var c=function(e){var t,n,r,i,a,o=Math.abs(e)+"",s=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(a=o.length))t=[0],n=1;else{for(a--;"0"===o.charAt(a);)a--;for(n-=r,t=[],i=0;r<=a;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),s=n-1,n=1),{digits:t,exponent:s,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,f=t.minFrac,h=t.maxFrac;if(a){var d=a.match(XA);if(null===d)throw new Error("".concat(a," is not a valid digit info"));var v=d[1],p=d[3],g=d[5];null!=v&&(l=JA(v)),null!=p&&(f=JA(p)),null!=g?h=JA(g):null!=p&&f>h&&(h=f)}!function(e,t,n){if(t>n)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(n,")."));var r=e.digits,i=r.length-e.integerLen,a=Math.min(Math.max(t,i),n),o=a+e.integerLen,s=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(var u=o;u<r.length;u++)r[u]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=a+1),r[0]=0;for(var c=1;c<o;c++)r[c]=0}if(s>=5)if(o-1<0){for(var l=0;l>o;l--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,a);i++)r.push(0);var f=0!==a,h=t+e.integerLen,d=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,f&&(0===r[n]&&n>=h?r.pop():f=!1),t>=10?1:0},0);d&&(r.unshift(d),e.integerLen++)}(c,f,h);var y=c.digits,m=c.integerLen,k=c.exponent,C=[];for(u=y.every(function(e){return!e});m<l;m++)y.unshift(0);for(;m<0;m++)y.unshift(0);m>0?C=y.splice(m,y.length):(C=y,y=[0]);var w=[];for(y.length>=t.lgSize&&w.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)w.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&w.unshift(y.join("")),s=w.join(OA(n,r)),C.length&&(s+=OA(n,i)+C.join("")),k&&(s+=OA(n,EA.Exponential)+"+"+k)}else s=OA(n,EA.Infinity);return s=e<0&&!u?t.negPre+s+t.negSuf:t.posPre+s+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],a=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=o[0],u=o[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?n.minFrac=n.maxFrac=c+1:"#"===l?n.maxFrac=c+1:n.posSuf+=l}var f=s.split(",");if(n.gSize=f[1]?f[1].length:0,n.lgSize=f[2]||f[1]?(f[2]||f[1]).length:0,a){var h=i.length-n.posPre.length-n.posSuf.length,d=a.indexOf("#");n.negPre=a.substr(0,d).replace(/'/g,""),n.negSuf=a.substr(d+h).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return yS(e)[CS.NumberFormats][t]}(t,mA.Decimal),OA(t,EA.MinusSign)),t,EA.Group,EA.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),r,n)}catch(i){throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(Om(e),"'"))}(e,i.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(fI,16))},e.\u0275pipe=wk({name:"number",type:e,pure:!0}),e}(),fM=function(){var e=my(function e(){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({providers:[{provide:eM,useClass:tM}]}),e}(),hM=function(){var e=my(function e(){gy(this,e)});return e.\u0275prov=Um({token:e,providedIn:"root",factory:function(){return new dM(Bw(eA),window)}}),e}(),dM=function(){function e(t,n){gy(this,e),this.document=t,this.window=n,this.offset=function(){return[0,0]}}return my(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;i;){var a=i.shadowRoot;if(a){var o=a.getElementById(t)||a.querySelector('[name="'.concat(t,'"]'));if(o)return o}i=r.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=vM(this.window.history)||vM(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(t){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function vM(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var pM,gM=my(function e(){gy(this,e)}),yM=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getBaseHref",value:function(e){var t=(mM=mM||document.querySelector("base"))?mM.getAttribute("href"):null;return null==t?null:function(e){(pM=pM||document.createElement("a")).setAttribute("href",e);var t=pM.pathname;return"/"===t.charAt(0)?t:"/".concat(t)}(t)}},{key:"resetBaseElement",value:function(){mM=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(e){return nM(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,XI||(XI=e)}}]),n}(function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).supportsDOMEvents=!0,e}return my(n)}(function(){return my(function e(){gy(this,e)})}())),mM=null,kM=new Cw("TRANSITION_ID"),CM=[{provide:nI,useFactory:function(e,t,n){return function(){n.get(rI).donePromise.then(function(){for(var n=JI(),r=t.querySelectorAll('style[ng-transition="'.concat(e,'"]')),i=0;i<r.length;i++)n.remove(r[i])})}},deps:[kM,eA,eP],multi:!0}],wM=function(){function e(){gy(this,e)}return my(e,[{key:"addToWindow",value:function(e){rk.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},rk.getAllAngularTestabilities=function(){return e.getAllTestabilities()},rk.getAllAngularRootElements=function(){return e.getAllRootElements()},rk.frameworkStabilizers||(rk.frameworkStabilizers=[]),rk.frameworkStabilizers.push(function(e){var t=rk.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){var r;return null==t?null:null!==(r=e.getTestability(t))&&void 0!==r?r:n?JI().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,RI=t}}]),e}(),_M=function(){var e=function(){function e(){gy(this,e)}return my(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),EM=new Cw("EventManagerPlugins"),bM=function(){var e=function(){function e(t,n){var r=this;gy(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return my(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(EM),Bw(EI))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),PM=function(){function e(t){gy(this,e),this._doc=t}return my(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=JI().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),SM=function(){var e=function(){function e(){gy(this,e),this._stylesSet=new Set}return my(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),OM=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Map,r._hostNodes.set(e.head,[]),r}return my(n,[{key:"_addStylesToHost",value:function(e,t,n){var r=this;e.forEach(function(e){var i=r._doc.createElement("style");i.textContent=e,n.push(t.appendChild(i))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(TM),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n,r){t._addStylesToHost(e,r,n)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(TM)})}}]),n}(SM);return e.\u0275fac=function(t){return new(t||e)(Bw(eA))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}();function TM(e){JI().remove(e)}var IM={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},AM=/%COMP%/g;function MM(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?MM(e,i,n):(i=i.replace(AM,e),n.push(i))}return n}function xM(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var RM=function(){var e=function(){function e(t,n,r){gy(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new NM(t)}return my(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Jm.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new DM(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case Jm.ShadowDom:return new LM(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=MM(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(bM),Bw(OM),Bw(iI))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),NM=function(){function e(t){gy(this,e),this.eventManager=t,this.data=Object.create(null)}return my(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(IM[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=IM[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=IM[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&(q_.DashCase|q_.Important)?e.style.setProperty(t,n,r&q_.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&q_.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,xM(n)):this.eventManager.addEventListener(e,t,xM(n))}}]),e}(),DM=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;gy(this,n),(o=t.call(this,e)).component=i;var s=MM(a+"-"+i.id,i.styles,[]);return r.addStyles(s),o.contentAttr="_ngcontent-%COMP%".replace(AM,a+"-"+i.id),o.hostAttr="_nghost-%COMP%".replace(AM,a+"-"+i.id),o}return my(n,[{key:"applyToHost",value:function(e){ny(ly(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=ny(ly(n.prototype),"createElement",this).call(this,e,t);return ny(ly(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(NM),LM=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;gy(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=i,o.shadowRoot=i.attachShadow({mode:"open"}),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=MM(a.id,a.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return my(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return ny(ly(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return ny(ly(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return ny(ly(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(ny(ly(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(NM),FM=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){return gy(this,n),t.call(this,e)}return my(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(PM);return e.\u0275fac=function(t){return new(t||e)(Bw(eA))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),UM=["alt","control","meta","shift"],VM={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},BM={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},zM={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},HM=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){return gy(this,n),t.call(this,e)}return my(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),a=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return JI().onAndCancel(e,i.domEventName,a)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),a="";if(UM.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),a+=e+".")}),a+=i,0!=t.length||0===i.length)return null;var o={};return o.domEventName=r,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&BM.hasOwnProperty(t)&&(t=BM[t]))}return VM[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),UM.forEach(function(r){r!=n&&zM[r](e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded(function(){return t(i)})}}},{key:"_normalizeKey",value:function(e){return"esc"===e?"escape":e}}]),n}(PM);return e.\u0275fac=function(t){return new(t||e)(Bw(eA))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),GM=function(){var e=my(function e(){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({factory:function(){return Bw($M)},token:e,providedIn:"root"}),e}(),$M=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this))._doc=e,r}return my(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case M_.NONE:return t;case M_.HTML:return a_(t,"HTML")?i_(t):I_(this._doc,String(t)).toString();case M_.STYLE:return a_(t,"Style")?i_(t):t;case M_.SCRIPT:if(a_(t,"Script"))return i_(t);throw new Error("unsafe value used in a script context");case M_.URL:return o_(t),a_(t,"URL")?i_(t):h_(String(t));case M_.RESOURCE_URL:if(a_(t,"ResourceURL"))return i_(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return function(e){return new Jw(e)}(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return function(e){return new e_(e)}(e)}},{key:"bypassSecurityTrustScript",value:function(e){return function(e){return new t_(e)}(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return function(e){return new n_(e)}(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return function(e){return new r_(e)}(e)}}]),n}(GM);return e.\u0275fac=function(t){return new(t||e)(Bw(eA))},e.\u0275prov=Um({factory:function(){return function(e){return new $M(e.get(eA))}(Bw(Bb))},token:e,providedIn:"root"}),e}(),ZM=[{provide:uI,useValue:"browser"},{provide:sI,useValue:function(){yM.makeCurrent(),wM.init()},multi:!0},{provide:eA,useFactory:function(){return e=document,Vk=e,document;var e},deps:[]}],qM=UI(YI,"browser",ZM),WM=[[],{provide:Hb,useValue:"root"},{provide:B_,useFactory:function(){return new B_},deps:[]},{provide:EM,useClass:FM,multi:!0,deps:[eA,EI,uI]},{provide:EM,useClass:HM,multi:!0,deps:[eA]},[],{provide:RM,useClass:RM,deps:[bM,OM,iI]},{provide:DO,useExisting:RM},{provide:SM,useExisting:OM},{provide:OM,useClass:OM,deps:[eA]},{provide:MI,useClass:MI,deps:[EI]},{provide:bM,useClass:bM,deps:[EM,EI]},{provide:gM,useClass:_M,deps:[]},[]],jM=function(){var e=function(){function e(t){if(gy(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return my(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:iI,useValue:t.appId},{provide:kM,useExisting:iI},CM]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(e,12))},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({providers:WM,imports:[fM,QI]}),e}();"undefined"!=typeof window&&window;var YM=Array.isArray,KM=Object.getPrototypeOf,QM=Object.prototype,XM=Object.keys;function JM(e){if(1===e.length){var t=e[0];if(YM(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&KM(e)===QM}(t)){var n=XM(t);return{args:n.map(function(e){return t[e]}),keys:n}}}return{args:e,keys:null}}var ex=Array.isArray;function tx(e){return Ky(function(t){return function(e,t){return ex(t)?e.apply(void 0,fy(t)):e(t)}(e,t)})}function nx(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}var rx=function(){var e=function(){function e(t,n){gy(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return my(e,[{key:"setProperty",value:function(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"setDisabledState",value:function(e){this.setProperty("disabled",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(LO),_P(RO))},e.\u0275dir=Ck({type:e}),e}(),ix=function(){var e,t=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n)}(rx);return t.\u0275fac=function(n){return(e||(e=pw(t)))(n||t)},t.\u0275dir=Ck({type:t,features:[nP]}),t}(),ax=new Cw("NgValueAccessor"),ox={provide:ax,useExisting:Am(function(){return ux}),multi:!0},sx=new Cw("CompositionEventMode"),ux=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r))._compositionMode=i,a._composing=!1,null==a._compositionMode&&(a._compositionMode=!function(){var e=JI()?JI().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}()),a}return my(n,[{key:"writeValue",value:function(e){this.setProperty("value",null!=e?e:"")}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),n}(rx);return e.\u0275fac=function(t){return new(t||e)(_P(LO),_P(RO),_P(sx,8))},e.\u0275dir=Ck({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&RP("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[SO([ox]),nP]}),e}();function cx(e){return null==e||0===e.length}function lx(e){return null!=e&&"number"==typeof e.length}var fx=new Cw("NgValidators"),hx=new Cw("NgAsyncValidators"),dx=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,vx=function(){function e(){gy(this,e)}return my(e,null,[{key:"min",value:function(e){return t=e,function(e){if(cx(e.value)||cx(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null};var t}},{key:"max",value:function(e){return t=e,function(e){if(cx(e.value)||cx(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null};var t}},{key:"required",value:function(e){return px(e)}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return cx((t=e).value)||dx.test(t.value)?null:{email:!0};var t}},{key:"minLength",value:function(e){return t=e,function(e){return cx(e.value)||!lx(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null};var t}},{key:"maxLength",value:function(e){return gx(e)}},{key:"pattern",value:function(e){return function(e){return e?("string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),function(e){if(cx(e.value))return null;var r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}):yx;var t,n}(e)}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){return Ex(e)}},{key:"composeAsync",value:function(e){return Px(e)}}]),e}();function px(e){return cx(e.value)?{required:!0}:null}function gx(e){return function(t){return lx(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}}function yx(e){return null}function mx(e){return null!=e}function kx(e){var t=MP(e)?_m(e):e;return xP(t),t}function Cx(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function wx(e,t){return t.map(function(t){return t(e)})}function _x(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function Ex(e){if(!e)return null;var t=e.filter(mx);return 0==t.length?null:function(e){return Cx(wx(e,t))}}function bx(e){return null!=e?Ex(_x(e)):null}function Px(e){if(!e)return null;var t=e.filter(mx);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=ym(t),i=JM(t),a=i.args,o=i.keys,s=new Hy(function(e){var t=a.length;if(t)for(var n=new Array(t),r=t,i=t,s=function(t){var s=!1;lm(a[t]).subscribe(new Yy(e,function(e){s||(s=!0,i--),n[t]=e},function(){return r--},void 0,function(){(!r||!s)&&(i||e.next(o?nx(o,n):n),e.complete())}))},u=0;u<t;u++)s(u);else e.complete()});return r?s.pipe(tx(r)):s}(wx(e,t).map(kx)).pipe(Ky(Cx))}}function Sx(e){return null!=e?Px(_x(e)):null}function Ox(e,t){return null===e?[t]:Array.isArray(e)?[].concat(fy(e),[t]):[e,t]}function Tx(e){return e._rawValidators}function Ix(e){return e._rawAsyncValidators}function Ax(e){return e?Array.isArray(e)?e:[e]:[]}function Mx(e,t){return Array.isArray(e)?e.includes(t):e===t}function xx(e,t){var n=Ax(t);return Ax(e).forEach(function(e){Mx(n,e)||n.push(e)}),n}function Rx(e,t){return Ax(t).filter(function(t){return!Mx(e,t)})}var Nx=function(){var e=function(){function e(){gy(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return my(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=bx(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Sx(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ck({type:e}),e}(),Dx=function(){var e,t=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(Nx);return t.\u0275fac=function(n){return(e||(e=pw(t)))(n||t)},t.\u0275dir=Ck({type:t,features:[nP]}),t}(),Lx=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return my(n)}(Nx),Fx=function(){function e(t){gy(this,e),this._cd=t}return my(e,[{key:"is",value:function(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}]),e}(),Ux=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){return gy(this,n),t.call(this,e)}return my(n)}(Fx);return e.\u0275fac=function(t){return new(t||e)(_P(Lx,2))},e.\u0275dir=Ck({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&KP("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[nP]}),e}(),Vx=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){return gy(this,n),t.call(this,e)}return my(n)}(Fx);return e.\u0275fac=function(t){return new(t||e)(_P(Dx,10))},e.\u0275dir=Ck({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&KP("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[nP]}),e}();function Bx(e,t){return[].concat(fy(t.path),[e])}function zx(e,t){$x(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&qx(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&qx(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function Hx(e,t){var n=function(){};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),Zx(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(function(){}))}function Gx(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function $x(e,t){var n=Tx(e);null!==t.validator?e.setValidators(Ox(n,t.validator)):"function"==typeof n&&e.setValidators([n]);var r=Ix(e);null!==t.asyncValidator?e.setAsyncValidators(Ox(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);var i=function(){return e.updateValueAndValidity()};Gx(t._rawValidators,i),Gx(t._rawAsyncValidators,i)}function Zx(e,t){var n=!1;if(null!==e){if(null!==t.validator){var r=Tx(e);if(Array.isArray(r)&&r.length>0){var i=r.filter(function(e){return e!==t.validator});i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){var a=Ix(e);if(Array.isArray(a)&&a.length>0){var o=a.filter(function(e){return e!==t.asyncValidator});o.length!==a.length&&(n=!0,e.setAsyncValidators(o))}}}var s=function(){};return Gx(t._rawValidators,s),Gx(t._rawAsyncValidators,s),n}function qx(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Wx(e,t){$x(e,t)}function jx(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function Yx(e,t){e._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function Kx(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===ux?n=e:function(e){return Object.getPrototypeOf(e.constructor)===ix}(e)?r=e:i=e}),i||r||n||null):null;var n,r,i}function Qx(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var Xx="VALID",Jx="INVALID",eR="PENDING",tR="DISABLED";function nR(e){return(oR(e)?e.validators:e)||null}function rR(e){return Array.isArray(e)?bx(e):e||null}function iR(e,t){return(oR(t)?t.asyncValidators:e)||null}function aR(e){return Array.isArray(e)?Sx(e):e||null}function oR(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var sR=function(){function e(t,n){gy(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=rR(this._rawValidators),this._composedAsyncValidatorFn=aR(this._rawAsyncValidators)}return my(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return this.status===Xx}},{key:"invalid",get:function(){return this.status===Jx}},{key:"pending",get:function(){return this.status==eR}},{key:"disabled",get:function(){return this.status===tR}},{key:"enabled",get:function(){return this.status!==tR}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=rR(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=aR(e)}},{key:"addValidators",value:function(e){this.setValidators(xx(e,this._rawValidators))}},{key:"addAsyncValidators",value:function(e){this.setAsyncValidators(xx(e,this._rawAsyncValidators))}},{key:"removeValidators",value:function(e){this.setValidators(Rx(e,this._rawValidators))}},{key:"removeAsyncValidators",value:function(e){this.setAsyncValidators(Rx(e,this._rawAsyncValidators))}},{key:"hasValidator",value:function(e){return Mx(this._rawValidators,e)}},{key:"hasAsyncValidator",value:function(e){return Mx(this._rawAsyncValidators,e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status=eR,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=tR,this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=Xx,this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Xx||this.status===eR)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?tR:Xx}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status=eR,this._hasOwnPendingAsyncValidator=!0;var n=kx(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;var r=e;return t.forEach(function(e){r=r instanceof cR?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof lR&&r.at(e)||null}),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new VT,this.statusChanges=new VT}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?tR:this.errors?Jx:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(eR)?eR:this._anyControlsHaveStatus(Jx)?Jx:Xx}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){oR(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),uR=function(e){iy(n,e);var t=oy(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return gy(this,n),(e=t.call(this,nR(i),iR(a,i)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(i),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!e.asyncValidator}),e}return my(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){Qx(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){Qx(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(sR),cR=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,nR(r),iR(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return my(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"removeControl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof uR?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var r=t.controls[n];r&&e(r,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var r=n[t],i=this.controls[r];if(this.contains(r)&&e(i))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(sR),lR=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,nR(r),iR(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return my(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"insert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof uR?e.value:e.getRawValue()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=dy(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(sR),fR={provide:Dx,useExisting:Am(function(){return dR})},hR=Promise.resolve(null),dR=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new VT,i.form=new cR({},bx(e),Sx(r)),i}return my(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;hR.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),zx(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;hR.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),Qx(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;hR.then(function(){var n=t._findContainer(e.path),r=new cR({});Wx(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;hR.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;hR.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Yx(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(Dx);return e.\u0275fac=function(t){return new(t||e)(_P(fx,10),_P(hx,10))},e.\u0275dir=Ck({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&RP("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[SO([fR]),nP]}),e}(),vR={provide:Lx,useExisting:Am(function(){return gR})},pR=Promise.resolve(null),gR=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this)).control=new uR,o._registered=!1,o.update=new VT,o._parent=e,o._setValidators(r),o._setAsyncValidators(i),o.valueAccessor=Kx(0,a),o}return my(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),jx(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?Bx(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){zx(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;pR.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;pR.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}}]),n}(Lx);return e.\u0275fac=function(t){return new(t||e)(_P(Dx,9),_P(fx,10),_P(hx,10),_P(ax,10))},e.\u0275dir=Ck({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[SO([vR]),nP,Rk]}),e}(),yR=function(){var e=my(function e(){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ck({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e}(),mR=function(){var e=my(function e(){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({}),e}(),kR={provide:ax,useExisting:Am(function(){return CR}),multi:!0},CR=function(){var e,t=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"writeValue",value:function(e){this.setProperty("value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),n}(ix);return t.\u0275fac=function(n){return(e||(e=pw(t)))(n||t)},t.\u0275dir=Ck({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&RP("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[SO([kR]),nP]}),t}(),wR=new Cw("NgModelWithFormControlWarning"),_R={provide:Dx,useExisting:Am(function(){return ER})},ER=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).validators=e,i.asyncValidators=r,i.submitted=!1,i._onCollectionChange=function(){return i._updateDomValue()},i.directives=[],i.form=null,i.ngSubmit=new VT,i._setValidators(e),i._setAsyncValidators(r),i}return my(n,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}},{key:"ngOnDestroy",value:function(){this.form&&(Zx(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(function(){}))}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return zx(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){Hx(e.control||null,e,!1),Qx(this.directives,e)}},{key:"addFormGroup",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormGroup",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormArray",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Yx(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach(function(t){var n=t.control,r=e.form.get(t.path);n!==r&&(Hx(n||null,t),r instanceof uR&&(zx(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_setUpFormContainer",value:function(e){var t=this.form.get(e.path);Wx(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"_cleanUpFormContainer",value:function(e){if(this.form){var t=this.form.get(e.path);t&&function(e,t){return Zx(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}},{key:"_updateRegistrations",value:function(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(function(){})}},{key:"_updateValidators",value:function(){$x(this.form,this),this._oldForm&&Zx(this._oldForm,this)}},{key:"_checkFormPresent",value:function(){}}]),n}(Dx);return e.\u0275fac=function(t){return new(t||e)(_P(fx,10),_P(hx,10))},e.\u0275dir=Ck({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&RP("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[SO([_R]),nP,Rk]}),e}(),bR={provide:Lx,useExisting:Am(function(){return PR})},PR=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o){var s;return gy(this,n),(s=t.call(this))._ngModelWarningConfig=o,s._added=!1,s.update=new VT,s._ngModelWarningSent=!1,s._parent=e,s._setValidators(r),s._setAsyncValidators(i),s.valueAccessor=Kx(0,a),s}return my(n,[{key:"isDisabled",set:function(e){}},{key:"ngOnChanges",value:function(e){this._added||this._setUpControl(),jx(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"path",get:function(){return Bx(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"_checkParentType",value:function(){}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}]),n}(Lx);return e.\u0275fac=function(t){return new(t||e)(_P(Dx,13),_P(fx,10),_P(hx,10),_P(ax,10),_P(wR,8))},e.\u0275dir=Ck({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[SO([bR]),nP,Rk]}),e._ngModelWarningSentOnce=!1,e}(),SR={provide:ax,useExisting:Am(function(){return TR}),multi:!0};function OR(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var TR=function(){var e,t=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return my(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);var n=OR(t,e);this.setProperty("value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(ix);return t.\u0275fac=function(n){return(e||(e=pw(t)))(n||t)},t.\u0275dir=Ck({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&RP("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[SO([SR]),nP]}),t}(),IR=function(){var e=function(){function e(t,n,r){gy(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return my(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(OR(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(RO),_P(LO),_P(TR,9))},e.\u0275dir=Ck({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),AR={provide:ax,useExisting:Am(function(){return xR}),multi:!0};function MR(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var xR=function(){var e,t=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return my(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(void 0!==n.selectedOptions)for(var i=n.selectedOptions,a=0;a<i.length;a++){var o=i.item(a),s=t._getOptionValue(o.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var f=t._getOptionValue(l.value);r.push(f)}}t.value=r,e(r)}}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(ix);return t.\u0275fac=function(n){return(e||(e=pw(t)))(n||t)},t.\u0275dir=Ck({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&RP("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[SO([AR]),nP]}),t}(),RR=function(){var e=function(){function e(t,n,r){gy(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return my(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(MR(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(MR(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(RO),_P(LO),_P(xR,9))},e.\u0275dir=Ck({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),NR={provide:fx,useExisting:Am(function(){return DR}),multi:!0},DR=function(){var e=function(){function e(){gy(this,e),this._required=!1}return my(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?px(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ck({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&pP("required",t.required?"":null)},inputs:{required:"required"},features:[SO([NR])]}),e}(),LR={provide:fx,useExisting:Am(function(){return FR}),multi:!0},FR=function(){var e=function(){function e(){gy(this,e),this._validator=yx}return my(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return this.enabled()?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){this._validator=this.enabled()?gx(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):yx}},{key:"enabled",value:function(){return null!=this.maxlength}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ck({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&pP("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[SO([LR]),Rk]}),e}(),UR=function(){var e=my(function e(){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({imports:[[mR]]}),e}(),VR=function(){var e=my(function e(){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({imports:[UR]}),e}(),BR=function(){var e=function(){function e(){gy(this,e)}return my(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:wR,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({imports:[UR]}),e}(),zR=function(){var e=function(){function e(){gy(this,e)}return my(e,[{key:"group",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),i=null,a=null;return null!=n&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(n)?(i=null!=n.validators?n.validators:null,a=null!=n.asyncValidators?n.asyncValidators:null,t=null!=n.updateOn?n.updateOn:void 0):(i=null!=n.validator?n.validator:null,a=null!=n.asyncValidator?n.asyncValidator:null)),new cR(r,{asyncValidators:a,updateOn:t,validators:i})}},{key:"control",value:function(e,t,n){return new uR(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map(function(e){return r._createControl(e)});return new lR(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._createControl(e[r])}),n}},{key:"_createControl",value:function(e){return e instanceof uR||e instanceof cR||e instanceof lR?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({factory:function(){return new e},token:e,providedIn:BR}),e}();function HR(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _m(t,mm(t))}function GR(e,t){return cy(t)?dm(e,t,1):dm(e,1)}function $R(e,t){return jy(function(n,r){var i=0;n.subscribe(new Yy(r,function(n){return e.call(t,n,i++)&&r.next(n)}))})}var ZR=my(function e(){gy(this,e)}),qR=my(function e(){gy(this,e)}),WR=function(){function e(t){var n=this;gy(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),a=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(a):n.headers.set(i,[a])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return my(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,fy(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var a=this.headers.get(t);if(!a)return;0===(a=a.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),jR=function(){function e(){gy(this,e)}return my(e,[{key:"encodeKey",value:function(e){return QR(e)}},{key:"encodeValue",value:function(e){return QR(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),YR=/%(\d[a-f0-9])/gi,KR={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function QR(e){return encodeURIComponent(e).replace(YR,function(e,t){var n;return null!==(n=KR[t])&&void 0!==n?n:e})}function XR(e){return"".concat(e)}var JR=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(gy(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new jR,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),i=Qg(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),a=i[0],o=i[1],s=n.get(a)||[];s.push(o),n.set(a,s)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}return my(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(XR(t.value)),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(XR(t.value));-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}(),eN=function(){function e(){gy(this,e),this.map=new Map}return my(e,[{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"get",value:function(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}},{key:"delete",value:function(e){return this.map.delete(e),this}},{key:"keys",value:function(){return this.map.keys()}}]),e}();function tN(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function nN(e){return"undefined"!=typeof Blob&&e instanceof Blob}function rN(e){return"undefined"!=typeof FormData&&e instanceof FormData}var iN=function(){function e(t,n,r,i){var a;if(gy(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new WR),this.context||(this.context=new eN),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new JR,this.urlWithParams=n}return my(e,[{key:"serializeBody",value:function(){return null===this.body?null:tN(this.body)||nN(this.body)||rN(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof JR?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||rN(this.body)?null:nN(this.body)?this.body.type||null:tN(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof JR?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.method||this.method,i=n.url||this.url,a=n.responseType||this.responseType,o=void 0!==n.body?n.body:this.body,s=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,u=void 0!==n.reportProgress?n.reportProgress:this.reportProgress,c=n.headers||this.headers,l=n.params||this.params,f=null!==(t=n.context)&&void 0!==t?t:this.context;return void 0!==n.setHeaders&&(c=Object.keys(n.setHeaders).reduce(function(e,t){return e.set(t,n.setHeaders[t])},c)),n.setParams&&(l=Object.keys(n.setParams).reduce(function(e,t){return e.set(t,n.setParams[t])},l)),new e(r,i,o,{params:l,headers:c,context:f,reportProgress:u,responseType:a,withCredentials:s})}}]),e}(),aN=((aN=aN||{})[aN.Sent=0]="Sent",aN[aN.UploadProgress=1]="UploadProgress",aN[aN.ResponseHeader=2]="ResponseHeader",aN[aN.DownloadProgress=3]="DownloadProgress",aN[aN.Response=4]="Response",aN[aN.User=5]="User",aN),oN=my(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";gy(this,e),this.headers=t.headers||new WR,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}),sN=function(e){iy(n,e);var t=oy(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return gy(this,n),(e=t.call(this,r)).type=aN.ResponseHeader,e}return my(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(oN),uN=function(e){iy(n,e);var t=oy(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return gy(this,n),(e=t.call(this,r)).type=aN.Response,e.body=void 0!==r.body?r.body:null,e}return my(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(oN),cN=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return my(n)}(oN);function lN(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var fN=function(){var e=function(){function e(t){gy(this,e),this.handler=t}return my(e,[{key:"request",value:function(e,t){var n,r,i,a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof iN?n=e:(r=o.headers instanceof WR?o.headers:new WR(o.headers),o.params&&(i=o.params instanceof JR?o.params:new JR({fromObject:o.params})),n=new iN(e,t,void 0!==o.body?o.body:null,{headers:r,context:o.context,params:i,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials}));var s=HR(n).pipe(GR(function(e){return a.handler.handle(e)}));if(e instanceof iN||"events"===o.observe)return s;var u=s.pipe($R(function(e){return e instanceof uN}));switch(o.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(Ky(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(Ky(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(Ky(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));default:return u.pipe(Ky(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(o.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new JR).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,lN(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,lN(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,lN(n,t))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(ZR))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),hN=function(){function e(t,n){gy(this,e),this.next=t,this.interceptor=n}return my(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),dN=new Cw("HTTP_INTERCEPTORS"),vN=function(){var e=function(){function e(){gy(this,e)}return my(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),pN=/^\)\]\}',?\n/,gN=function(){var e=function(){function e(t){gy(this,e),this.xhrFactory=t}return my(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Hy(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var a=e.responseType.toLowerCase();r.responseType="json"!==a?a:"text"}var o=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new WR(r.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new sN({headers:i,status:t,statusText:n,url:a})},c=function(){var t=u(),i=t.headers,a=t.status,o=t.statusText,s=t.url,c=null;204!==a&&(c=void 0===r.response?r.responseText:r.response),0===a&&(a=c?200:0);var l=a>=200&&a<300;if("json"===e.responseType&&"string"==typeof c){var f=c;c=c.replace(pN,"");try{c=""!==c?JSON.parse(c):null}catch(h){c=f,l&&(l=!1,c={error:h,text:c})}}l?(n.next(new uN({body:c,headers:i,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new cN({error:c,headers:i,status:a,statusText:o,url:s||void 0}))},l=function(e){var t=u().url,i=new cN({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},f=!1,h=function(t){f||(n.next(u()),f=!0);var i={type:aN.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&!!r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:aN.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),r.addEventListener("timeout",l),r.addEventListener("abort",l),e.reportProgress&&(r.addEventListener("progress",h),null!==o&&r.upload&&r.upload.addEventListener("progress",d)),r.send(o),n.next({type:aN.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("abort",l),r.removeEventListener("load",c),r.removeEventListener("timeout",l),e.reportProgress&&(r.removeEventListener("progress",h),null!==o&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(gM))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),yN=new Cw("XSRF_COOKIE_NAME"),mN=new Cw("XSRF_HEADER_NAME"),kN=my(function e(){gy(this,e)}),CN=function(){var e=function(){function e(t,n,r){gy(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return my(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=nM(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(eA),Bw(uI),Bw(yN))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),wN=function(){var e=function(){function e(t,n){gy(this,e),this.tokenService=t,this.headerName=n}return my(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(kN),Bw(mN))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),_N=function(){var e=function(){function e(t,n){gy(this,e),this.backend=t,this.injector=n,this.chain=null}return my(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(dN,[]);this.chain=t.reduceRight(function(e,t){return new hN(e,t)},this.backend)}return this.chain.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(qR),Bw(eP))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),EN=function(){var e=function(){function e(){gy(this,e)}return my(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:wN,useClass:vN}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:yN,useValue:t.cookieName}:[],t.headerName?{provide:mN,useValue:t.headerName}:[]]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({providers:[wN,{provide:dN,useExisting:wN,multi:!0},{provide:kN,useClass:CN},{provide:yN,useValue:"XSRF-TOKEN"},{provide:mN,useValue:"X-XSRF-TOKEN"}]}),e}(),bN=function(){var e=my(function e(){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({providers:[fN,{provide:ZR,useClass:_N},gN,{provide:qR,useExisting:gN}],imports:[[EN.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e}(),PN=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this))._value=e,r}return my(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=ny(ly(n.prototype),"_subscribe",this).call(this,e);return!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){var e=this.hasError,t=this.thrownError,n=this._value;if(e)throw t;return this._throwIfClosed(),n}},{key:"next",value:function(e){ny(ly(n.prototype),"next",this).call(this,this._value=e)}}]),n}(Zy);function SN(e,t,n){e?hm(n,e,t):t()}var ON=hy(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function TN(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vm(1)(_m(t,mm(t)))}function IN(e){return new Hy(function(t){lm(e()).subscribe(t)})}function AN(){return jy(function(e,t){var n=null;e._refCount++;var r=new Yy(t,void 0,void 0,void 0,function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()}});e.subscribe(r),r.closed||(n=e.connect())})}var MN=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._subject=null,i._refCount=0,i._connection=null,Wy(e)&&(i.lift=e.lift),i}return my(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"_teardown",value:function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()}},{key:"connect",value:function(){var e=this,t=this._connection;if(!t){t=this._connection=new yy;var n=this.getSubject();t.add(this.source.subscribe(new Yy(n,void 0,function(){e._teardown(),n.complete()},function(t){e._teardown(),n.error(t)},function(){return e._teardown()}))),t.closed&&(this._connection=null,t=yy.EMPTY)}return t}},{key:"refCount",value:function(){return AN()(this)}}]),n}(Hy);function xN(e,t){return jy(function(n,r){var i=null,a=0,o=!1,s=function(){return o&&!i&&r.complete()};n.subscribe(new Yy(r,function(n){null==i||i.unsubscribe();var o=0,u=a++;lm(e(n,u)).subscribe(i=new Yy(r,function(e){return r.next(t?t(n,e,u,o++):e)},function(){i=null,s()}))},function(){o=!0,s()}))})}function RN(e,t,n,r,i){return function(a,o){var s=n,u=t,c=0;a.subscribe(new Yy(o,function(t){var n=c++;u=s?e(u,t,n):(s=!0,t),r&&o.next(u)},i&&function(){s&&o.next(u),o.complete()}))}}function NN(e,t){return jy(RN(e,t,arguments.length>=2,!0))}function DN(e){return jy(function(t,n){var r,i=null,a=!1;i=t.subscribe(new Yy(n,void 0,void 0,function(o){r=lm(e(o,DN(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function LN(e){return e<=0?function(){return pm}:jy(function(t,n){var r=[];t.subscribe(new Yy(n,function(t){r.push(t),e<r.length&&r.shift()},function(){var e,t=dy(r);try{for(t.s();!(e=t.n()).done;){var i=e.value;n.next(i)}}catch(a){t.e(a)}finally{t.f()}n.complete()},void 0,function(){r=null}))})}function FN(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:UN;return jy(function(t,n){var r=!1;t.subscribe(new Yy(n,function(e){r=!0,n.next(e)},function(){return r?n.complete():n.error(e())}))})}function UN(){return new ON}function VN(e){return jy(function(t,n){var r=!1;t.subscribe(new Yy(n,function(e){r=!0,n.next(e)},function(){r||n.next(e),n.complete()}))})}function BN(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?$R(function(t,n){return e(t,n,r)}):zy,Em(1),n?VN(t):FN(function(){return new ON}))}}function zN(e,t,n){var r=cy(e)||t||n?{next:e,error:t,complete:n}:e;return r?jy(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(new Yy(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):zy}var HN=my(function e(t,n){gy(this,e),this.id=t,this.url=n}),GN=function(e){iy(n,e);var t=oy(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return gy(this,n),(i=t.call(this,e,r)).navigationTrigger=a,i.restoredState=o,i}return my(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(HN),$N=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a}return my(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(HN),ZN=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r)).reason=i,a}return my(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(HN),qN=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r)).error=i,a}return my(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(HN),WN=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return my(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(HN),jN=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return my(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(HN),YN=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o){var s;return gy(this,n),(s=t.call(this,e,r)).urlAfterRedirects=i,s.state=a,s.shouldActivate=o,s}return my(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(HN),KN=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return my(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(HN),QN=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return my(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(HN),XN=function(){function e(t){gy(this,e),this.route=t}return my(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),JN=function(){function e(t){gy(this,e),this.route=t}return my(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),eD=function(){function e(t){gy(this,e),this.snapshot=t}return my(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),tD=function(){function e(t){gy(this,e),this.snapshot=t}return my(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),nD=function(){function e(t){gy(this,e),this.snapshot=t}return my(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),rD=function(){function e(t){gy(this,e),this.snapshot=t}return my(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),iD=function(){function e(t,n,r){gy(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return my(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),aD="primary",oD=function(){function e(t){gy(this,e),this.params=t||{}}return my(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function sD(e){return new oD(e)}var uD="ngNavigationCancelingError";function cD(e){var t=Error("NavigationCancelingError: "+e);return t[uD]=!0,t}function lD(e,t,n){var r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},a=0;a<r.length;a++){var o=r[a],s=e[a];if(o.startsWith(":"))i[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function fD(e,t){var n,r=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!r||!i||r.length!=i.length)return!1;for(var a=0;a<r.length;a++)if(!hD(e[n=r[a]],t[n]))return!1;return!0}function hD(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=fy(e).sort(),r=fy(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function dD(e){return Array.prototype.concat.apply([],e)}function vD(e){return e.length>0?e[e.length-1]:null}function pD(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function gD(e){return xP(e)?e:MP(e)?_m(Promise.resolve(e)):HR(e)}var yD={exact:function e(t,n,r){if(!SD(t.segments,n.segments)||!_D(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(var i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:CD},mD={exact:function(e,t){return fD(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return hD(e[n],t[n])})},ignored:function(){return!0}};function kD(e,t,n){return yD[n.paths](e.root,t.root,n.matrixParams)&&mD[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function CD(e,t,n){return wD(e,t,t.segments,n)}function wD(e,t,n,r){if(e.segments.length>n.length){var i=e.segments.slice(0,n.length);return!(!SD(i,n)||t.hasChildren()||!_D(i,n,r))}if(e.segments.length===n.length){if(!SD(e.segments,n)||!_D(e.segments,n,r))return!1;for(var a in t.children)if(!e.children[a]||!CD(e.children[a],t.children[a],r))return!1;return!0}var o=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(SD(e.segments,o)&&_D(e.segments,o,r)&&e.children[aD])&&wD(e.children[aD],t,s,r)}function _D(e,t,n){return t.every(function(t,r){return mD[n](e[r].parameters,t.parameters)})}var ED=function(){function e(t,n,r){gy(this,e),this.root=t,this.queryParams=n,this.fragment=r}return my(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=sD(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return ID.serialize(this)}}]),e}(),bD=function(){function e(t,n){var r=this;gy(this,e),this.segments=t,this.children=n,this.parent=null,pD(n,function(e,t){return e.parent=r})}return my(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return AD(this)}}]),e}(),PD=function(){function e(t,n){gy(this,e),this.path=t,this.parameters=n}return my(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=sD(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return FD(this)}}]),e}();function SD(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}var OD=my(function e(){gy(this,e)}),TD=function(){function e(){gy(this,e)}return my(e,[{key:"parse",value:function(e){var t=new HD(e);return new ED(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,n="/".concat(MD(e.root,!0)),r=function(e){var t=Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return"".concat(RD(t),"=").concat(RD(e))}).join("&"):"".concat(RD(t),"=").concat(RD(n))}).filter(function(e){return!!e});return t.length?"?".concat(t.join("&")):""}(e.queryParams);return"".concat(n).concat(r).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),ID=new TD;function AD(e){return e.segments.map(function(e){return FD(e)}).join("/")}function MD(e,t){if(!e.hasChildren())return AD(e);if(t){var n=e.children[aD]?MD(e.children[aD],!1):"",r=[];return pD(e.children,function(e,t){t!==aD&&r.push("".concat(t,":").concat(MD(e,!1)))}),r.length>0?"".concat(n,"(").concat(r.join("//"),")"):n}var i=function(e,t){var n=[];return pD(e.children,function(e,r){r===aD&&(n=n.concat(t(e,r)))}),pD(e.children,function(e,r){r!==aD&&(n=n.concat(t(e,r)))}),n}(e,function(t,n){return n===aD?[MD(e.children[aD],!1)]:["".concat(n,":").concat(MD(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children[aD]?"".concat(AD(e),"/").concat(i[0]):"".concat(AD(e),"/(").concat(i.join("//"),")")}function xD(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function RD(e){return xD(e).replace(/%3B/gi,";")}function ND(e){return xD(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function DD(e){return decodeURIComponent(e)}function LD(e){return DD(e.replace(/\+/g,"%20"))}function FD(e){return"".concat(ND(e.path)).concat(function(e){return Object.keys(e).map(function(t){return";".concat(ND(t),"=").concat(ND(e[t]))}).join("")}(e.parameters))}var UD=/^[^\/()?;=#]+/;function VD(e){var t=e.match(UD);return t?t[0]:""}var BD=/^[^=?&#]+/,zD=/^[^?&#]+/,HD=function(){function e(t){gy(this,e),this.url=t,this.remaining=t}return my(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new bD([],{}):new bD([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[aD]=new bD(e,t)),n}},{key:"parseSegment",value:function(){var e=VD(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new PD(DD(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=VD(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=VD(this.remaining);r&&(n=r,this.capture(n))}e[DD(t)]=DD(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(BD);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(zD);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=LD(t),a=LD(n);if(e.hasOwnProperty(i)){var o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(a)}else e[i]=a}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=VD(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=aD);var a=this.parseChildren();t[i]=1===Object.keys(a).length?a[aD]:new bD([],a),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),GD=function(){function e(t){gy(this,e),this._root=t}return my(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=$D(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=$D(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=ZD(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return ZD(e,this._root).map(function(e){return e.value})}}]),e}();function $D(e,t){if(e===t.value)return t;var n,r=dy(t.children);try{for(r.s();!(n=r.n()).done;){var i=$D(e,n.value);if(i)return i}}catch(a){r.e(a)}finally{r.f()}return null}function ZD(e,t){if(e===t.value)return[t];var n,r=dy(t.children);try{for(r.s();!(n=r.n()).done;){var i=ZD(e,n.value);if(i.length)return i.unshift(t),i}}catch(a){r.e(a)}finally{r.f()}return[]}var qD=function(){function e(t,n){gy(this,e),this.value=t,this.children=n}return my(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function WD(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var jD=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e)).snapshot=r,eL(uy(i),e),i}return my(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(GD);function YD(e,t){var n=function(e,t){var n=new XD([],{},{},"",{},aD,t,null,e.root,-1,{});return new JD("",new qD(n,[]))}(e,t),r=new PN([new PD("",{})]),i=new PN({}),a=new PN({}),o=new PN({}),s=new PN(""),u=new KD(r,i,o,s,a,aD,t,n.root);return u.snapshot=n.root,new jD(new qD(u,[]),n)}var KD=function(){function e(t,n,r,i,a,o,s,u){gy(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=u}return my(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(Ky(function(e){return sD(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ky(function(e){return sD(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function QD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],a=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var XD=function(){function e(t,n,r,i,a,o,s,u,c,l,f){gy(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=f}return my(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=sD(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=sD(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),JD=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,r)).url=e,eL(uy(i),r),i}return my(n,[{key:"toString",value:function(){return tL(this._root)}}]),n}(GD);function eL(e,t){t.value._routerState=e,t.children.forEach(function(t){return eL(e,t)})}function tL(e){var t=e.children.length>0?" { ".concat(e.children.map(tL).join(", ")," } "):"";return"".concat(e.value).concat(t)}function nL(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,fD(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),fD(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!fD(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),fD(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function rL(e,t){var n=fD(e.params,t.params)&&function(e,t){return SD(e,t)&&e.every(function(e,n){return fD(e.parameters,t[n].parameters)})}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||rL(e.parent,t.parent))}function iL(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){var r=n.value;r._futureSnapshot=t.value;var i=function(e,t,n){return t.children.map(function(t){var r,i=dy(n.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(e.shouldReuseRoute(t.value,a.value.snapshot))return iL(e,t,a)}}catch(o){i.e(o)}finally{i.f()}return iL(e,t)})}(e,t,n);return new qD(r,i)}if(e.shouldAttach(t.value)){var a=e.retrieve(t.value);if(null!==a){var o=a.route;return aL(t,o),o}}var s=function(e){return new KD(new PN(e.url),new PN(e.params),new PN(e.queryParams),new PN(e.fragment),new PN(e.data),e.outlet,e.component,e)}(t.value),u=t.children.map(function(t){return iL(e,t)});return new qD(s,u)}function aL(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var n=0;n<e.children.length;++n)aL(e.children[n],t.children[n])}function oL(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function sL(e){return"object"==typeof e&&null!=e&&e.outlets}function uL(e,t,n,r,i){var a={};return r&&pD(r,function(e,t){a[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new ED(n.root===e?t:cL(n.root,e,t),a,i)}function cL(e,t,n){var r={};return pD(e.children,function(e,i){r[i]=e===t?n:cL(e,t,n)}),new bD(e.segments,r)}var lL=function(){function e(t,n,r){if(gy(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&oL(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(sL);if(i&&i!==vD(r))throw new Error("{outlets:{}} has to be the last command")}return my(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),fL=my(function e(t,n,r){gy(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r});function hL(e,t,n){if(e||(e=new bD([],{})),0===e.segments.length&&e.hasChildren())return dL(e,t,n);var r=function(e,t,n){for(var r=0,i=t,a={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return a;var o=e.segments[i],s=n[r];if(sL(s))break;var u="".concat(s),c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!yL(u,c,o))return a;r+=2}else{if(!yL(u,{},o))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var a=new bD(e.segments.slice(0,r.pathIndex),{});return a.children[aD]=new bD(e.segments.slice(r.pathIndex),e.children),dL(a,0,i)}return r.match&&0===i.length?new bD(e.segments,{}):r.match&&!e.hasChildren()?vL(e,t,n):r.match?dL(e,0,i):vL(e,t,n)}function dL(e,t,n){if(0===n.length)return new bD(e.segments,{});var r=function(e){return sL(e[0])?e[0].outlets:Kg({},aD,e)}(n),i={};return pD(r,function(n,r){"string"==typeof n&&(n=[n]),null!==n&&(i[r]=hL(e.children[r],t,n))}),pD(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new bD(e.segments,i)}function vL(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){var a=n[i];if(sL(a)){var o=pL(a.outlets);return new bD(r,o)}if(0===i&&oL(n[0]))r.push(new PD(e.segments[t].path,gL(n[0]))),i++;else{var s=sL(a)?a.outlets[aD]:"".concat(a),u=i<n.length-1?n[i+1]:null;s&&u&&oL(u)?(r.push(new PD(s,gL(u))),i+=2):(r.push(new PD(s,{})),i++)}}return new bD(r,{})}function pL(e){var t={};return pD(e,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(t[n]=vL(new bD([],{}),0,e))}),t}function gL(e){var t={};return pD(e,function(e,n){return t[n]="".concat(e)}),t}function yL(e,t,n){return e==n.path&&fD(t,n.parameters)}var mL=function(){function e(t,n,r,i){gy(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return my(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),nL(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=WD(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),pD(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=WD(e),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];this.deactivateRouteAndItsChildren(i[s],r)}n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=WD(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new rD(e.value.snapshot))}),e.children.length&&this.forwardEvent(new tD(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(nL(r),r===i)if(r.component){var a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),kL(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function kL(e){nL(e.value),e.children.forEach(kL)}var CL=my(function e(t,n){gy(this,e),this.routes=t,this.module=n});function wL(e){return"function"==typeof e}function _L(e){return e instanceof ED}var EL=Symbol("INITIAL_VALUE");function bL(){return xN(function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=mm(t),i=ym(t),a=JM(t),o=a.args,s=a.keys;if(0===o.length)return _m([],r);var u=new Hy(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zy;return function(r){SN(t,function(){for(var i=e.length,a=new Array(i),o=i,s=i,u=function(i){SN(t,function(){var u=_m(e[i],t),c=!1;u.subscribe(new Yy(r,function(e){a[i]=e,c||(c=!0,s--),s||r.next(n(a.slice()))},function(){--o||r.complete()}))},r)},c=0;c<i;c++)u(c)},r)}}(o,r,s?function(e){return nx(s,e)}:zy));return i?u.pipe(tx(i)):u}(e.map(function(e){return e.pipe(Em(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=mm(t);return jy(function(e,n){(r?TN(t,e,r):TN(t,e)).subscribe(n)})}(EL))})).pipe(NN(function(e,t){var n=!1;return t.reduce(function(e,r,i){return e!==EL?e:(r===EL&&(n=!0),n||!1!==r&&i!==t.length-1&&!_L(r)?e:r)},e)},EL),$R(function(e){return e!==EL}),Ky(function(e){return _L(e)?e:!0===e}),Em(1))})}var PL=function(){var e=my(function e(){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=vk({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&OP(0,"router-outlet")},directives:function(){return[_F]},encapsulation:2}),e}();function SL(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];OL(r,TL(t,r))}}function OL(e,t){e.children&&SL(e.children,t)}function TL(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function IL(e){var t=e.children&&e.children.map(IL),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==aD&&(n.component=PL),n}function AL(e){return e.outlet||aD}function ML(e,t){var n=e.filter(function(e){return AL(e)===t});return n.push.apply(n,fy(e.filter(function(e){return AL(e)!==t}))),n}var xL={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function RL(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},xL):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var i=(t.matcher||lD)(n,e,t);if(!i)return Object.assign({},xL);var a={};pD(i.posParams,function(e,t){a[t]=e.path});var o=i.consumed.length>0?Object.assign(Object.assign({},a),i.consumed[i.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function NL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(n.length>0&&function(e,t,n){return n.some(function(n){return DL(e,t,n)&&AL(n)!==aD})}(e,n,r)){var a=new bD(t,function(e,t,n,r){var i={};i[aD]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var a,o=dy(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&AL(s)!==aD){var u=new bD([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,i[AL(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return i}(e,t,r,new bD(n,e.children)));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(function(n){return DL(e,t,n)})}(e,n,r)){var o=new bD(e.segments,function(e,t,n,r,i,a){var o,s={},u=dy(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(DL(e,n,c)&&!i[AL(c)]){var l=new bD([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===a?e.segments.length:t.length,s[AL(c)]=l}}}catch(f){u.e(f)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new bD(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function DL(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function LL(e,t,n,r){return!!(AL(e)===r||r!==aD&&DL(t,n,e))&&("**"===e.path||RL(t,e,n).matched)}function FL(e,t,n){return 0===t.length&&!e.children[n]}var UL=my(function e(t){gy(this,e),this.segmentGroup=t||null}),VL=my(function e(t){gy(this,e),this.urlTree=t});function BL(e){return new Hy(function(t){return t.error(new UL(e))})}function zL(e){return new Hy(function(t){return t.error(new VL(e))})}function HL(e){return new Hy(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var GL=function(){function e(t,n,r,i,a){gy(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=t.get(dT)}return my(e,[{key:"apply",value:function(){var e=this,t=NL(this.urlTree.root,[],[],this.config).segmentGroup,n=new bD(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,aD).pipe(Ky(function(t){return e.createUrlTree($L(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(DN(function(t){if(t instanceof VL)return e.allowRedirects=!1,e.match(t.urlTree);throw t instanceof UL?e.noMatchError(t):t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,aD).pipe(Ky(function(n){return t.createUrlTree($L(n),e.queryParams,e.fragment)})).pipe(DN(function(e){throw e instanceof UL?t.noMatchError(e):e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new bD([],Kg({},aD,e)):e;return new ED(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Ky(function(e){return new bD([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){for(var r=this,i=[],a=0,o=Object.keys(n.children);a<o.length;a++){var s=o[a];"primary"===s?i.unshift(s):i.push(s)}return _m(i).pipe(GR(function(i){var a=n.children[i],o=ML(t,i);return r.expandSegmentGroup(e,o,a,i).pipe(Ky(function(e){return{segment:e,outlet:i}}))}),NN(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?$R(function(t,n){return e(t,n,r)}):zy,LN(1),n?VN(t):FN(function(){return new ON}))}}())}},{key:"expandSegment",value:function(e,t,n,r,i,a){var o=this;return _m(n).pipe(GR(function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,i,a).pipe(DN(function(e){if(e instanceof UL)return HR(null);throw e}))}),BN(function(e){return!!e}),DN(function(e,n){if(e instanceof ON||"EmptyError"===e.name){if(FL(t,r,i))return HR(new bD([],{}));throw new UL(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,a,o){return LL(r,t,i,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a):BL(t):BL(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?zL(a):this.lineralizeSegments(n,a).pipe(dm(function(n){var a=new bD(n,{});return i.expandSegment(e,a,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){var o=this,s=RL(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,f=s.positionalParamSegments;if(!u)return BL(t);var h=this.applyRedirectCommands(c,r.redirectTo,f);return r.redirectTo.startsWith("/")?zL(h):this.lineralizeSegments(r,h).pipe(dm(function(r){return o.expandSegment(e,t,n,r.concat(i.slice(l)),a,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r,i){var a=this;if("**"===n.path)return n.loadChildren?(n._loadedConfig?HR(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(Ky(function(e){return n._loadedConfig=e,new bD(r,{})})):HR(new bD(r,{}));var o=RL(t,n,r),s=o.matched,u=o.consumedSegments,c=o.lastChild;if(!s)return BL(t);var l=r.slice(c);return this.getChildConfig(e,n,r).pipe(dm(function(e){var r=e.module,o=e.routes,s=NL(t,u,l,o),c=s.segmentGroup,f=s.slicedSegments,h=new bD(c.segments,c.children);if(0===f.length&&h.hasChildren())return a.expandChildren(r,o,h).pipe(Ky(function(e){return new bD(u,e)}));if(0===o.length&&0===f.length)return HR(new bD(u,{}));var d=AL(n)===i;return a.expandSegment(r,h,o,f,d?aD:i,!0).pipe(Ky(function(e){return new bD(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?HR(new CL(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?HR(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(dm(function(n){return n?r.configLoader.load(e.injector,t).pipe(Ky(function(e){return t._loadedConfig=e,e})):(i=t,new Hy(function(e){return e.error(cD("Cannot load children because the guard of the route \"path: '".concat(i.path,"'\" returned false")))}));var i})):HR(new CL([],e))}},{key:"runCanLoadGuards",value:function(e,t,n){var r=this,i=t.canLoad;return i&&0!==i.length?HR(i.map(function(r){var i,a,o=e.get(r);if((a=o)&&wL(a.canLoad))i=o.canLoad(t,n);else{if(!wL(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return gD(i)})).pipe(bL(),zN(function(e){if(_L(e)){var t=cD('Redirecting to "'.concat(r.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),Ky(function(e){return!0===e})):HR(!0)}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return HR(n);if(r.numberOfChildren>1||!r.children[aD])return HL(e.redirectTo);r=r.children[aD]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new ED(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return pD(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,a=this.createSegments(e,t.segments,n,r),o={};return pD(t.children,function(t,a){o[a]=i.createSegmentGroup(e,t,n,r)}),new bD(a,o)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,i=dy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.path===e.path)return t.splice(r),a;r++}}catch(o){i.e(o)}finally{i.f()}return e}}]),e}();function $L(e){for(var t={},n=0,r=Object.keys(e.children);n<r.length;n++){var i=r[n],a=$L(e.children[i]);(a.segments.length>0||a.hasChildren())&&(t[i]=a)}return function(e){if(1===e.numberOfChildren&&e.children[aD]){var t=e.children[aD];return new bD(e.segments.concat(t.segments),t.children)}return e}(new bD(e.segments,t))}var ZL=my(function e(t){gy(this,e),this.path=t,this.route=this.path[this.path.length-1]}),qL=my(function e(t,n){gy(this,e),this.component=t,this.route=n});function WL(e,t,n){var r=e._root;return YL(r,t?t._root:null,n,[r.value])}function jL(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function YL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=WD(t);return e.children.forEach(function(e){(function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=e.value,o=t?t.value:null,s=n?n.getContext(e.value.outlet):null;if(o&&a.routeConfig===o.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!SD(e.url,t.url);case"pathParamsOrQueryParamsChange":return!SD(e.url,t.url)||!fD(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!rL(e,t)||!fD(e.queryParams,t.queryParams);default:return!rL(e,t)}}(o,a,a.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new ZL(r)):(a.data=o.data,a._resolvedData=o._resolvedData),YL(e,t,a.component?s?s.children:null:n,r,i),u&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new qL(s.outlet.component,o))}else o&&KL(t,s,i),i.canActivateChecks.push(new ZL(r)),YL(e,null,a.component?s?s.children:null:n,r,i)})(e,a[e.value.outlet],n,r.concat([e.value]),i),delete a[e.value.outlet]}),pD(a,function(e,t){return KL(e,n.getContext(t),i)}),i}function KL(e,t,n){var r=WD(e),i=e.value;pD(r,function(e,r){KL(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new qL(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var QL=my(function e(){gy(this,e)});function XL(e){return new Hy(function(t){return t.error(e)})}var JL=function(){function e(t,n,r,i,a,o){gy(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return my(e,[{key:"recognize",value:function(){var e=NL(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,aD);if(null===t)return null;var n=new XD([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},aD,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new qD(n,t),i=new JD(this.url,r);return this.inheritParamsAndData(i._root),i}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=QD(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,i=Object.keys(t.children);r<i.length;r++){var a=i[r],o=t.children[a],s=ML(e,a),u=this.processSegmentGroup(s,o,a);if(null===u)return null;n.push.apply(n,fy(u))}var c=eF(n);return c.sort(function(e,t){return e.value.outlet===aD?-1:t.value.outlet===aD?1:e.value.outlet.localeCompare(t.value.outlet)}),c}},{key:"processSegment",value:function(e,t,n,r){var i,a=dy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this.processSegmentAgainstRoute(o,t,n,r);if(null!==s)return s}}catch(u){a.e(u)}finally{a.f()}return FL(t,n,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo||!LL(e,t,n,r))return null;var i,a=[],o=[];if("**"===e.path){var s=n.length>0?vD(n).parameters:{};i=new XD(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,rF(e),AL(e),e.component,e,tF(t),nF(t)+n.length,iF(e))}else{var u=RL(t,e,n);if(!u.matched)return null;a=u.consumedSegments,o=n.slice(u.lastChild),i=new XD(a,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,rF(e),AL(e),e.component,e,tF(t),nF(t)+a.length,iF(e))}var c,l=(c=e).children?c.children:c.loadChildren?c._loadedConfig.routes:[],f=NL(t,a,o,l.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),h=f.segmentGroup,d=f.slicedSegments;if(0===d.length&&h.hasChildren()){var v=this.processChildren(l,h);return null===v?null:[new qD(i,v)]}if(0===l.length&&0===d.length)return[new qD(i,[])];var p=AL(e)===r,g=this.processSegment(l,h,d,p?aD:r);return null===g?null:[new qD(i,g)]}}]),e}();function eF(e){var t,n=[],r=new Set,i=dy(e);try{var a=function(){var e,i=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(i))return n.push(i),"continue";var a=n.find(function(e){return i.value.routeConfig===e.value.routeConfig});void 0!==a?((e=a.children).push.apply(e,fy(i.children)),r.add(a)):n.push(i)};for(i.s();!(t=i.n()).done;)a()}catch(l){i.e(l)}finally{i.f()}var o,s=dy(r);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=eF(u.children);n.push(new qD(u.value,c))}}catch(l){s.e(l)}finally{s.f()}return n.filter(function(e){return!r.has(e)})}function tF(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function nF(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function rF(e){return e.data||{}}function iF(e){return e.resolve||{}}function aF(e){return xN(function(t){var n=e(t);return n?_m(n).pipe(Ky(function(){return t})):HR(t)})}var oF=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n)}(function(){function e(){gy(this,e)}return my(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),sF=new Cw("ROUTES"),uF=function(){function e(t,n,r,i){gy(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return my(e,[{key:"load",value:function(e,t){var n=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren).pipe(Ky(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new CL(dD(i.injector.get(sF,void 0,jm.Self|jm.Optional)).map(IL),i)}),DN(function(e){throw t._loader$=void 0,e}));return t._loader$=new MN(r,function(){return new Zy}).pipe(AN()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?_m(this.loader.load(e)):gD(e()).pipe(dm(function(e){return e instanceof vT?HR(e):_m(t.compiler.compileModuleAsync(e))}))}}]),e}(),cF=my(function e(){gy(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new lF,this.attachRef=null}),lF=function(){function e(){gy(this,e),this.contexts=new Map}return my(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new cF,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),fF=function(){function e(){gy(this,e)}return my(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function hF(e){throw e}function dF(e,t,n){return t.parse("/")}function vF(e,t){return HR(null)}var pF={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},gF={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},yF=function(){var e=function(){function e(t,n,r,i,a,o,s,u){var c=this;gy(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Zy,this.errorHandler=hF,this.malformedUriErrorHandler=dF,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:vF,afterPreactivation:vF},this.urlHandlingStrategy=new fF,this.routeReuseStrategy=new oF,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(dT),this.console=a.get(lI);var l=a.get(EI);this.isNgZoneEnabled=l instanceof EI&&EI.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new ED(new bD([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new uF(o,s,function(e){return c.triggerEvent(new XN(e))},function(e){return c.triggerEvent(new JN(e))}),this.routerState=YD(this.currentUrlTree,this.rootComponentType),this.transitions=new PN({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return my(e,[{key:"browserPageId",get:function(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}},{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe($R(function(e){return 0!==e.id}),Ky(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),xN(function(e){var r=!1,i=!1;return HR(e).pipe(zN(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),xN(function(e){var r=t.browserUrlTree.toString(),a=!t.navigated||e.extractedUrl.toString()!==r||r!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||a)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return mF(e.source)&&(t.browserUrlTree=e.extractedUrl),HR(e).pipe(xN(function(e){var r=t.transitions.getValue();return n.next(new GN(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?pm:Promise.resolve(e)}),function(e,t,n,r){return xN(function(i){return function(e,t,n,r,i){return new GL(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(Ky(function(e){return Object.assign(Object.assign({},i),{urlAfterRedirects:e})}))})}(t.ngModule.injector,t.configLoader,t.urlSerializer,t.config),zN(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,n,r,a,o){return dm(function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var s=new JL(e,t,n,r,a,o).recognize();return null===s?XL(new QL):HR(s)}catch(i){return XL(i)}}(e,n,r.urlAfterRedirects,(s=r.urlAfterRedirects,t.serializeUrl(s)),a,o).pipe(Ky(function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})}));var s})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),zN(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,e),t.browserUrlTree=e.urlAfterRedirects);var r=new WN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(a&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var o=e.id,s=e.extractedUrl,u=e.source,c=e.restoredState,l=e.extras,f=new GN(o,t.serializeUrl(s),u,c);n.next(f);var h=YD(s,t.rootComponentType).snapshot;return HR(Object.assign(Object.assign({},e),{targetSnapshot:h,urlAfterRedirects:s,extras:Object.assign(Object.assign({},l),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),pm}),aF(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),zN(function(e){var n=new jN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),Ky(function(e){return Object.assign(Object.assign({},e),{guards:WL(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return dm(function(n){var r=n.targetSnapshot,i=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?HR(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return _m(e).pipe(dm(function(e){return function(e,t,n,r,i){var a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?HR(a.map(function(a){var o,s=jL(a,t,i);if(function(e){return e&&wL(e.canDeactivate)}(s))o=gD(s.canDeactivate(e,t,n,r));else{if(!wL(s))throw new Error("Invalid CanDeactivate guard");o=gD(s(e,t,n,r))}return o.pipe(BN())})).pipe(bL()):HR(!0)}(e.component,e.route,n,t,r)}),BN(function(e){return!0!==e},!0))}(s,r,i,e).pipe(dm(function(n){return n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return _m(t).pipe(GR(function(t){return TN(function(e,t){return null!==e&&t&&t(new eD(e)),HR(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new nD(e)),HR(!0)}(t.route,r),function(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return IN(function(){return HR(t.guards.map(function(i){var a,o=jL(i,t.node,n);if(function(e){return e&&wL(e.canActivateChild)}(o))a=gD(o.canActivateChild(r,e));else{if(!wL(o))throw new Error("Invalid CanActivateChild guard");a=gD(o(r,e))}return a.pipe(BN())})).pipe(bL())})});return HR(i).pipe(bL())}(e,t.path,n),function(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return HR(!0);var i=r.map(function(r){return IN(function(){var i,a=jL(r,t,n);if(function(e){return e&&wL(e.canActivate)}(a))i=gD(a.canActivate(t,e));else{if(!wL(a))throw new Error("Invalid CanActivate guard");i=gD(a(t,e))}return i.pipe(BN())})});return HR(i).pipe(bL())}(e,t.route,n))}),BN(function(e){return!0!==e},!0))}(r,o,e,t):HR(n)}),Ky(function(e){return Object.assign(Object.assign({},n),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),zN(function(e){if(_L(e.guardsResult)){var n=cD('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}var r=new YN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)}),$R(function(e){return!!e.guardsResult||(t.restoreHistory(e),t.cancelNavigationTransition(e,""),!1)}),aF(function(e){if(e.guards.canActivateChecks.length)return HR(e).pipe(zN(function(e){var n=new KN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),xN(function(e){var n=!1;return HR(e).pipe(function(e,t){return dm(function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;if(!i.length)return HR(n);var a=0;return _m(i).pipe(GR(function(n){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return HR({});var a={};return _m(i).pipe(dm(function(i){return function(e,t,n,r){var i=jL(e,t,r);return gD(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(zN(function(e){a[i]=e}))}),LN(1),dm(function(){return Object.keys(a).length===i.length?HR(a):pm}))}(e._resolve,e,t,r).pipe(Ky(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),QD(e,n).resolve),null}))}(n.route,r,e,t)}),zN(function(){return a++}),LN(1),dm(function(e){return a===i.length?HR(n):pm}))})}(t.paramsInheritanceStrategy,t.ngModule.injector),zN({next:function(){return n=!0},complete:function(){n||(t.restoreHistory(e),t.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),zN(function(e){var n=new QN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),aF(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),Ky(function(e){var n=function(e,t,n){var r=iL(e,t._root,n?n._root:void 0);return new jD(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})}),zN(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,e),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,n){return Ky(function(r){return new mL(t,r.targetRouterState,r.currentRouterState,n).activate(e),r})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),zN({next:function(){r=!0},complete:function(){r=!0}}),function(e){return jy(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}(function(){var n;if(!r&&!i){var a="Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId);"replace"===t.canceledNavigationResolution?(t.restoreHistory(e),t.cancelNavigationTransition(e,a)):t.cancelNavigationTransition(e,a)}(null===(n=t.currentNavigation)||void 0===n?void 0:n.id)===e.id&&(t.currentNavigation=null)}),DN(function(r){if(i=!0,function(e){return e&&e[uD]}(r)){var a=_L(r.url);a||(t.navigated=!0,t.restoreHistory(e,!0));var o=new ZN(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),a?setTimeout(function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree),i={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||mF(e.source)};t.scheduleNavigation(n,"imperative",null,i,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.restoreHistory(e,!0);var s=new qN(e.id,t.serializeUrl(e.extractedUrl),r);n.next(s);try{e.resolve(t.errorHandler(r))}catch(o){e.reject(o)}}return pm}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,n)&&setTimeout(function(){var t=n.source,r=n.state,i=n.urlTree,a={replaceUrl:!0};if(r){var o=Object.assign({},r);delete o.navigationId,delete o.\u0275routerPageId,0!==Object.keys(o).length&&(a.state=o)}e.scheduleNavigation(i,t,r,a)},0),e.lastLocationChangeInfo=n}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){SL(e),this.config=e.map(IL),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,a=t.queryParamsHandling,o=t.preserveFragment,s=n||this.routerState.root,u=o?this.currentUrlTree.fragment:i,c=null;switch(a){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return uL(t.root,t.root,t,r,i);var a=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new lL(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var a={};return pD(r.outlets,function(e,t){a[t]="string"==typeof e?e.split("/"):e}),[].concat(fy(e),[{outlets:a}])}if(r.segmentPath)return[].concat(fy(e),[r.segmentPath])}return"string"!=typeof r?[].concat(fy(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(fy(e),[r])},[]);return new lL(n,t,r)}(n);if(a.toRoot())return uL(t.root,new bD([],{}),t,r,i);var o=function(e,t,n){if(e.isAbsolute)return new fL(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){var r=n.snapshot._urlSegment;return new fL(r,r===t.root,0)}var i=oL(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,a=n;a>i;){if(a-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new fL(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(a,t,e),s=o.processChildren?dL(o.segmentGroup,o.index,a.commands):hL(o.segmentGroup,o.index,a.commands);return uL(o.segmentGroup,s,t,r,i)}(s,this.currentUrlTree,e,c,null!=u?u:null)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},n=_L(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){var n;if(n=!0===t?Object.assign({},pF):!1===t?Object.assign({},gF):t,_L(e))return kD(this.currentUrlTree,e,n);var r=this.parseUrl(e);return kD(this.currentUrlTree,r,n)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.currentPageId=t.targetPageId,e.events.next(new $N(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ".concat(t))})}},{key:"scheduleNavigation",value:function(e,t,n,r,i){var a,o;if(this.disposed)return Promise.resolve(!1);var s,u,c,l=this.getTransition(),f=mF(t)&&l&&!mF(l.source),h=(this.lastSuccessfulId===l.id||this.currentNavigation?l.rawUrl:l.urlAfterRedirects).toString()===e.toString();if(f&&h)return Promise.resolve(!0);i?(s=i.resolve,u=i.reject,c=i.promise):c=new Promise(function(e,t){s=e,u=t});var d,v=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),d=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):d=0,this.setTransition({id:v,targetPageId:d,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t){var n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}},{key:"restoreHistory",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var i=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(t=this.currentNavigation)||void 0===t?void 0:t.finalUrl)||0===i?this.currentUrlTree===(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)&&0===i&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(e,t){var n=new ZN(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}},{key:"generateNgRouterState",value:function(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(_w),Bw(OD),Bw(lF),Bw(pA),Bw(eP),Bw($I),Bw(CI),Bw(void 0))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}();function mF(e){return"imperative"!==e}var kF=function(){var e=function(){function e(t,n,r,i,a){gy(this,e),this.router=t,this.route=n,this.commands=[],this.onChanges=new Zy,null==r&&i.setAttribute(a.nativeElement,"tabindex","0")}return my(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:wF(this.skipLocationChange),replaceUrl:wF(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:wF(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(yF),_P(KD),yw("tabindex"),_P(LO),_P(RO))},e.\u0275dir=Ck({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&RP("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Rk]}),e}(),CF=function(){var e=function(){function e(t,n,r){var i=this;gy(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.onChanges=new Zy,this.subscription=t.events.subscribe(function(e){e instanceof $N&&i.updateTargetUrlAndHref()})}return my(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:wF(this.skipLocationChange),replaceUrl:wF(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:wF(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(yF),_P(KD),_P(lA))},e.\u0275dir=Ck({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&RP("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(dS("href",t.href,R_),pP("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Rk]}),e}();function wF(e){return""===e||!!e}var _F=function(){var e=function(){function e(t,n,r,i,a){gy(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new VT,this.deactivateEvents=new VT,this.name=i||aD,t.onChildOutletCreated(this.name,this)}return my(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new EF(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(lF),_P(gT),_P(IO),yw("name"),_P(aT))},e.\u0275dir=Ck({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e}(),EF=function(){function e(t,n,r){gy(this,e),this.route=t,this.childContexts=n,this.parent=r}return my(e,[{key:"get",value:function(e,t){return e===KD?this.route:e===lF?this.childContexts:this.parent.get(e,t)}}]),e}(),bF=my(function e(){gy(this,e)}),PF=function(){function e(){gy(this,e)}return my(e,[{key:"preload",value:function(e,t){return HR(null)}}]),e}(),SF=function(){var e=function(){function e(t,n,r,i,a){gy(this,e),this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new uF(n,r,function(e){return t.triggerEvent(new XN(e))},function(e){return t.triggerEvent(new JN(e))})}return my(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe($R(function(e){return e instanceof $N}),GR(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(dT);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],i=dy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?r.push(this.preloadConfig(e,a)):a.children&&r.push(this.processRoutes(e,a.children))}}catch(s){i.e(s)}finally{i.f()}return _m(r).pipe(vm(),Ky(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?HR(t._loadedConfig):n.loader.load(e.injector,t)).pipe(dm(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(yF),Bw($I),Bw(CI),Bw(eP),Bw(bF))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),OF=function(){var e=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};gy(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return my(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof GN?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof $N&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof iD&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new iD(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(yF),Bw(hM),Bw(void 0))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),TF=new Cw("ROUTER_CONFIGURATION"),IF=new Cw("ROUTER_FORROOT_GUARD"),AF=[pA,{provide:OD,useClass:TD},{provide:yF,useFactory:function(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new yF(null,e,t,n,r,i,a,dD(o));return u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(s,l),s.enableTracing&&l.events.subscribe(function(e){var t,n;null===(t=console.group)||void 0===t||t.call(console,"Router Event: ".concat(e.constructor.name)),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),l},deps:[OD,lF,pA,eP,$I,CI,sF,TF,[function(){return my(function e(){gy(this,e)})}(),new jw],[function(){return my(function e(){gy(this,e)})}(),new jw]]},lF,{provide:KD,useFactory:function(e){return e.routerState.root},deps:[yF]},{provide:$I,useClass:WI},SF,PF,function(){function e(){gy(this,e)}return my(e,[{key:"preload",value:function(e,t){return t().pipe(DN(function(){return HR(null)}))}}]),e}(),{provide:TF,useValue:{enableTracing:!1}}];function MF(){return new FI("Router",yF)}var xF=function(){var e=function(){function e(t,n){gy(this,e)}return my(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[AF,LF(t),{provide:IF,useFactory:DF,deps:[[yF,new jw,new Yw]]},{provide:TF,useValue:n||{}},{provide:lA,useFactory:NF,deps:[tA,[new Ww(hA),new jw],TF]},{provide:OF,useFactory:RF,deps:[yF,hM,TF]},{provide:bF,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:PF},{provide:FI,multi:!0,useFactory:MF},[FF,{provide:nI,multi:!0,useFactory:UF,deps:[FF]},{provide:BF,useFactory:VF,deps:[FF]},{provide:cI,multi:!0,useExisting:BF}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[LF(t)]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(IF,8),Bw(yF,8))},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({}),e}();function RF(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new OF(e,t,n)}function NF(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new vA(e,t):new dA(e,t)}function DF(e){return"guarded"}function LF(e){return[{provide:ww,multi:!0,useValue:e},{provide:sF,multi:!0,useValue:e}]}var FF=function(){var e=function(){function e(t){gy(this,e),this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Zy}return my(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(rA,Promise.resolve(null)).then(function(){if(e.destroyed)return Promise.resolve(!0);var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(yF),i=e.injector.get(TF);return"disabled"===i.initialNavigation?(r.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(r.hooks.afterPreactivation=function(){return e.initNavigation?HR(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()):t(!0),n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(TF),n=this.injector.get(SF),r=this.injector.get(OF),i=this.injector.get(yF),a=this.injector.get(HI);e===a.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(eP))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}();function UF(e){return e.appInitializer.bind(e)}function VF(e){return e.bootstrapListener.bind(e)}var BF=new Cw("Router Initializer"),zF=my(function e(){gy(this,e)}),HF="*";function GF(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function $F(e){return{type:6,styles:e,offset:null}}function ZF(e){Promise.resolve(null).then(e)}var qF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;gy(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return my(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;ZF(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this._started=!1}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),WF=function(){function e(t){var n=this;gy(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,i=0,a=0,o=this.players.length;0==o?ZF(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++r==o&&n._onFinish()}),e.onDestroy(function(){++i==o&&n._onDestroy()}),e.onStart(function(){++a==o&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return my(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function jF(){return"undefined"!=typeof window&&void 0!==window.document}function YF(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function KF(e){switch(e.length){case 0:return new qF;case 1:return e[0];default:return new WF(e)}}function QF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],u=-1,c=null;if(r.forEach(function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach(function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),s){case"!":s=i[n];break;case HF:s=a[n];break;default:s=t.normalizeStyleValue(n,r,s,o)}l[r]=s}),r||s.push(l),c=l,u=n}),o.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(o.join(l)))}return s}function XF(e,t,n,r){switch(t){case"start":e.onStart(function(){return r(n&&JF(n,"start",e))});break;case"done":e.onDone(function(){return r(n&&JF(n,"done",e))});break;case"destroy":e.onDestroy(function(){return r(n&&JF(n,"destroy",e))})}}function JF(e,t,n){var r,i=eU(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null!==(r=n.totalTime)&&void 0!==r?r:e.totalTime,!!n.disabled),a=e._data;return null!=a&&(i._data=a),i}function eU(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!o}}function tU(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function nU(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var rU=function(e,t){return!1},iU=function(e,t){return!1},aU=function(e,t,n){return[]},oU=YF();(oU||"undefined"!=typeof Element)&&(rU=jF()?function(e,t){for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:function(e,t){return e.contains(t)},iU=function(){if(oU||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:iU}(),aU=function(e,t,n){var r=[];if(n)for(var i=e.querySelectorAll(t),a=0;a<i.length;a++)r.push(i[a]);else{var o=e.querySelector(t);o&&r.push(o)}return r});var sU=null,uU=!1;function cU(e){sU||(sU=("undefined"!=typeof document?document.body:null)||{},uU=!!sU.style&&"WebkitAppearance"in sU.style);var t=!0;return sU.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in sU.style)&&uU&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in sU.style)),t}var lU=iU,fU=rU,hU=aU;function dU(e){var t={};return Object.keys(e).forEach(function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}var vU=function(){var e=function(){function e(){gy(this,e)}return my(e,[{key:"validateStyleProperty",value:function(e){return cU(e)}},{key:"matchesElement",value:function(e,t){return lU(e,t)}},{key:"containsElement",value:function(e,t){return fU(e,t)}},{key:"query",value:function(e,t,n){return hU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,i){return new qF(n,r)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),pU=function(){var e=my(function e(){gy(this,e)});return e.NOOP=new vU,e}(),gU="ng-enter",yU="ng-leave",mU="ng-trigger",kU=".ng-trigger",CU="ng-animating",wU=".ng-animating";function _U(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:EU(parseFloat(t[1]),t[2])}function EU(e,t){return"s"===t?1e3*e:e}function bU(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,i=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=EU(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(i=EU(parseFloat(s),o[4]));var u=o[5];u&&(a=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:i,easing:a}}(e,t,n)}function PU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function SU(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else PU(e,n);return n}function OU(e,t,n){return n?t+":"+n+";":""}function TU(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=OU(0,r,e.style.getPropertyValue(r))}for(var i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=OU(0,UU(i),e.style[i]));e.setAttribute("style",t)}function IU(e,t,n){e.style&&(Object.keys(t).forEach(function(r){var i=FU(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),YF()&&TU(e))}function AU(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=FU(t);e.style[n]=""}),YF()&&TU(e))}function MU(e){return Array.isArray(e)?1==e.length?e[0]:GF(e):e}var xU=new RegExp("{{\\s*(.+?)\\s*}}","g");function RU(e){var t=[];if("string"==typeof e){for(var n;n=xU.exec(e);)t.push(n[1]);xU.lastIndex=0}return t}function NU(e,t,n){var r=e.toString(),i=r.replace(xU,function(e,r){var i=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()});return i==r?e:i}function DU(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var LU=/-+([a-z0-9])/g;function FU(e){return e.replace(LU,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function UU(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function VU(e,t){return 0===e||0===t}function BU(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var i=t[0],a=[];if(r.forEach(function(e){i.hasOwnProperty(e)||a.push(e),i[e]=n[e]}),a.length)for(var o=function(){var n=t[s];a.forEach(function(t){n[t]=HU(e,t)})},s=1;s<t.length;s++)o()}return t}function zU(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function HU(e,t){return window.getComputedStyle(e)[t]}function GU(e,t){var n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=i[1],o=i[2],s=i[3];t.push(qU(a,s)),"<"==o[0]&&("*"!=a||"*"!=s)&&t.push(qU(s,a))}(e,n,t)}):n.push(e),n}var $U=new Set(["true","1"]),ZU=new Set(["false","0"]);function qU(e,t){var n=$U.has(e)||ZU.has(e),r=$U.has(t)||ZU.has(t);return function(i,a){var o="*"==e||e==i,s="*"==t||t==a;return!o&&n&&"boolean"==typeof i&&(o=i?$U.has(e):ZU.has(e)),!s&&r&&"boolean"==typeof a&&(s=a?$U.has(t):ZU.has(t)),o&&s}}var WU=new RegExp("s*:selfs*,?","g");function jU(e,t,n){return new YU(e).build(t,n)}var YU=function(){function e(t){gy(this,e),this._driver=t}return my(e,[{key:"build",value:function(e,t){var n=new KU(t);return this._resetContextStyleTimingState(n),zU(this,MU(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,i=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,a.push(n.visitState(s,t))}),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:a,transitions:o,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var i=new Set,a=r||{};if(n.styles.forEach(function(e){if(QU(e)){var t=e;Object.keys(t).forEach(function(e){RU(t[e]).forEach(function(e){a.hasOwnProperty(e)||i.add(e)})})}}),i.size){var o=DU(i.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n=zU(this,MU(e.animation),t);return{type:1,matchers:GU(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:XU(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return zU(n,e,t)}),options:XU(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,i=0,a=e.steps.map(function(e){t.currentTime=r;var a=zU(n,e,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:a,options:XU(e.options)}}},{key:"visitAnimate",value:function(e,t){var n=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return JU(bU(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var i=JU(0,0,"");return i.dynamic=!0,i.strValue=r,i}return JU((n=n||bU(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;var r,i=e.styles?e.styles:$F({});if(5==i.type)r=this.visitKeyframes(i,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};n.easing&&(s.easing=n.easing),a=$F(s)}t.currentTime+=n.duration+n.delay;var u=this.visitStyle(a,t);u.isEmptyStep=o,r=u}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?e==HF?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var r=!1,i=null;return n.forEach(function(e){if(QU(e)){var t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(var a in t)if(t[a].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,i=t.currentTime,a=t.currentTime;r&&a>0&&(a-=r.duration+r.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(r){if(n._driver.validateStyleProperty(r)){var o=t.collectedStyles[t.currentQuerySelector],s=o[r],u=!0;s&&(a!=i&&a>=s.startTime&&i<=s.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(s.startTime,'ms" and "').concat(s.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(i,'ms"')),u=!1),a=s.startTime),u&&(o[r]={startTime:a,endTime:i}),t.options&&function(e,t,n){var r=t.params||{},i=RU(e);i.length&&i.forEach(function(e){r.hasOwnProperty(e)||n.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})}(e[r],t.options,t.errors)}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,a=[],o=!1,s=!1,u=0,c=e.steps.map(function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(QU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(QU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,o=o||l<u,u=l,a.push(l),r});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,f=0;i>0&&i<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(f=1/(l-1));var h=l-1,d=t.currentTime,v=t.currentAnimateTimings,p=v.duration;return c.forEach(function(e,i){var o=f>0?i==h?1:f*i:a[i],s=o*p;t.currentTime=d+v.delay+s,v.duration=s,n._validateStyleAst(e,t),e.offset=o,r.styles.push(e)}),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:zU(this,MU(e.animation),t),options:XU(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:XU(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:XU(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var i=function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(WU,"")),e=e.replace(/@\*/g,kU).replace(/@\w+/g,function(e){return kU+"-"+e.substr(1)}).replace(/:animating/g,wU),[e,t]}(e.selector),a=Qg(i,2),o=a[0],s=a[1];t.currentQuerySelector=n.length?n+" "+o:o,tU(t.collectedStyles,t.currentQuerySelector,{});var u=zU(this,MU(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:u,originalSelector:e.selector,options:XU(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:bU(e.timings,t.errors,!0);return{type:12,animation:zU(this,MU(e.animation),t),timings:n,options:null}}}]),e}(),KU=my(function e(t){gy(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null});function QU(e){return!Array.isArray(e)&&"object"==typeof e}function XU(e){return e?(e=PU(e)).params&&(e.params=function(e){return e?PU(e):null}(e.params)):e={},e}function JU(e,t,n){return{duration:e,delay:t,easing:n}}function eV(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:o,subTimeline:s}}var tV=function(){function e(){gy(this,e),this._map=new Map}return my(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,fy(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),nV=new RegExp(":enter","g"),rV=new RegExp(":leave","g");function iV(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new aV).buildKeyframes(e,t,n,r,i,a,o,s,u,c)}var aV=function(){function e(){gy(this,e)}return my(e,[{key:"buildKeyframes",value:function(e,t,n,r,i,a,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new tV;var l=new sV(e,t,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([a],null,l.errors,s),zU(this,n,l);var f=l.timelines.filter(function(e){return e.containsAnimation()});if(f.length&&Object.keys(o).length){var h=f[f.length-1];h.allowOnlyTimelineStyles()||h.setStyles([o],null,l.errors,s)}return f.length?f.map(function(e){return e.buildKeyframes()}):[eV(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,i=null!=n.duration?_U(n.duration):null,a=null!=n.delay?_U(n.delay):null;return 0!==i&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,i,a);r=Math.max(r,n.duration+n.delay)}),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),zU(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,i=t,a=e.options;if(a&&(a.params||a.delay)&&((i=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=oV);var o=_U(a.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(function(e){return zU(n,e,i)}),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],i=t.currentTimeline.currentTime,a=e.options&&e.options.delay?_U(e.options.delay):0;e.steps.forEach(function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),zU(n,o,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(i),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return bU(t.params?NU(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(function(e){a.forwardTime((e.offset||0)*i),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+i),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,i=e.options||{},a=i.delay?_U(i.delay):0;a&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=oV);var o=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach(function(r,i){t.currentQueryIndex=i;var s=t.createSubContext(e.options,r);a&&s.delayNextStep(a),r===t.element&&(u=s.currentTimeline),zU(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,i=e.timings,a=Math.abs(i.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;zU(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),oV={},sV=function(){function e(t,n,r,i,a,o,s,u){gy(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=oV,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new uV(this._driver,n,0),s.push(this.currentTimeline)}return my(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,i=this.options;null!=r.duration&&(i.duration=_U(r.duration)),null!=r.delay&&(i.delay=_U(r.delay));var a=r.params;if(a){var o=i.params;o||(o=this.options.params={}),Object.keys(a).forEach(function(e){(!t||!o.hasOwnProperty(e))&&(o[e]=NU(a[e],o,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,a=new e(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=oV,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new cV(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,i,a){var o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(nV,"."+this._enterClassName)).replace(rV,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,fy(s))}return!i&&0==o.length&&a.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),uV=function(){function e(t,n,r,i){gy(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return my(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||HF,t._currentKeyframe[e]=HF}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var i=this;t&&(this._previousKeyframe.easing=t);var a=r&&r.params||{},o=function(e,t){var n,r={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){r[e]=HF}):SU(e,!1,r)}),r}(e,this._globalTimelineStyles);Object.keys(o).forEach(function(e){var t=NU(o[e],a,n);i._pendingStyles[e]=t,i._localTimelineStyles.hasOwnProperty(e)||(i._backFill[e]=i._globalTimelineStyles.hasOwnProperty(e)?i._globalTimelineStyles[e]:HF),i._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var r=t._styleSummary[n],i=e._styleSummary[n];(!r||i.time>r.time)&&t._updateStyle(n,i.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach(function(a,o){var s=SU(a,!0);Object.keys(s).forEach(function(e){var r=s[e];"!"==r?t.add(e):r==HF&&n.add(e)}),r||(s.offset=o/e.duration),i.push(s)});var a=t.size?DU(t.values()):[],o=n.size?DU(n.values()):[];if(r){var s=i[0],u=PU(s);s.offset=0,u.offset=1,i=[s,u]}return eV(this.element,i,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),cV=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return gy(this,n),(u=t.call(this,e,r,s.delay)).keyframes=i,u.preStyleProps=a,u.postStyleProps=o,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return my(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,i=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=r+n,s=n/o,u=SU(e[0],!1);u.offset=0,a.push(u);var c=SU(e[0],!1);c.offset=lV(s),a.push(c);for(var l=e.length-1,f=1;f<=l;f++){var h=SU(e[f],!1);h.offset=lV((n+h.offset*r)/o),a.push(h)}r=o,n=0,i="",e=a}return eV(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(uV);function lV(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var fV=my(function e(){gy(this,e)}),hV=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"normalizePropertyName",value:function(e,t){return FU(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var i="",a=n.toString().trim();if(dV[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+i}}]),n}(fV),dV=function(e){var t={};return e.forEach(function(e){return t[e]=!0}),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function vV(e,t,n,r,i,a,o,s,u,c,l,f,h){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:o,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:f,errors:h}}var pV={},gV=function(){function e(t,n,r){gy(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return my(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,i){return e.some(function(e){return e(t,n,r,i)})}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],i=this._stateStyles[e],a=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,r,i,a,o,s,u,c){var l=[],f=this.ast.options&&this.ast.options.params||pV,h=this.buildStyles(n,o&&o.params||pV,l),d=s&&s.params||pV,v=this.buildStyles(r,d,l),p=new Set,g=new Map,y=new Map,m="void"===r,k={params:Object.assign(Object.assign({},f),d)},C=c?[]:iV(e,t,this.ast.animation,i,a,h,v,k,u,l),w=0;if(C.forEach(function(e){w=Math.max(e.duration+e.delay,w)}),l.length)return vV(t,this._triggerName,n,r,m,h,v,[],[],g,y,w,l);C.forEach(function(e){var n=e.element,r=tU(g,n,{});e.preStyleProps.forEach(function(e){return r[e]=!0});var i=tU(y,n,{});e.postStyleProps.forEach(function(e){return i[e]=!0}),n!==t&&p.add(n)});var _=DU(p.values());return vV(t,this._triggerName,n,r,m,h,v,C,_,g,y,w)}}]),e}(),yV=function(){function e(t,n,r){gy(this,e),this.styles=t,this.defaultParams=n,this.normalizer=r}return my(e,[{key:"buildStyles",value:function(e,t){var n=this,r={},i=PU(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach(function(e){var o=a[e];o.length>1&&(o=NU(o,i,t));var s=n.normalizer.normalizePropertyName(e,t);o=n.normalizer.normalizeStyleValue(e,s,o,t),r[s]=o})}}),r}}]),e}(),mV=function(){function e(t,n,r){var i=this;gy(this,e),this.name=t,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states={},n.states.forEach(function(e){i.states[e.name]=new yV(e.style,e.options&&e.options.params||{},r)}),kV(this.states,"true","1"),kV(this.states,"false","0"),n.transitions.forEach(function(e){i.transitionFactories.push(new gV(t,e,i.states))}),this.fallbackTransition=function(e,t,n){return new gV(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},t)}(t,this.states)}return my(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find(function(i){return i.match(e,t,n,r)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function kV(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var CV=new tV,wV=function(){function e(t,n,r){gy(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return my(e,[{key:"register",value:function(e,t){var n=[],r=jU(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,i=QF(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=iV(this._driver,t,o,gU,yU,{},{},i,CV,a)).forEach(function(e){var t=tU(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: ".concat(a.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=r._driver.computeStyle(t,n,HF)})});var u=KF(n.map(function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return r.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,r){var i=eU(t,"","","");return XF(this._getPlayer(e),n,i,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),_V="ng-animate-queued",EV="ng-animate-disabled",bV=".ng-animate-disabled",PV=[],SV={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},OV={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},TV="__ng_removed",IV=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";gy(this,e),this.namespaceId=r;var i=t&&t.hasOwnProperty("value");if(this.value=null!==(n=i?t.value:t)&&void 0!==n?n:null,i){var a=PU(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return my(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),AV="void",MV=new IV(AV),xV=function(){function e(t,n,r){gy(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,BV(n,this._hostClassName)}return my(e,[{key:"listen",value:function(e,t,n,r){var i,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=tU(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);var u=tU(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(BV(e,mU),BV(e,mU+"-"+t),u[t]=MV),function(){a._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete u[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new NV(this.id,t,e),s=this._engine.statesByElement.get(e);s||(BV(e,mU),BV(e,mU+"-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new IV(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=MV),c.value===AV||u.value!==c.value){var l=tU(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()});var f=a.matchTransition(u.value,c.value,e,c.params),h=!1;if(!f){if(!i)return;f=a.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:u,toState:c,player:o,isFallbackTransition:h}),h||(BV(e,_V),o.onStart(function(){zV(e,_V)})),o.onDone(function(){var t=r.players.indexOf(o);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var i=n.indexOf(o);i>=0&&n.splice(i,1)}}),this.players.push(o),l.push(o),o}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(u.params,c.params)){var d=[],v=a.matchStyles(u.value,u.params,d),p=a.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush(function(){AU(e,v),IU(e,p)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,r){t._elementListeners.set(r,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,r=this._engine.driver.query(e,kU,!0);r.forEach(function(e){if(!e[TV]){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return r.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var i=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach(function(t){if(i._triggers[t]){var n=i.trigger(e,t,AV,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&KF(o).onDone(function(){return i._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){var i=new Set;n.forEach(function(n){var a=n.name;if(!i.has(a)){i.add(a);var o=t._triggers[a].fallbackTransition,s=r[a]||MV,u=new IV(AV),c=new NV(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:s,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var i=!1;if(r.totalAnimations){var a=r.players.length?r.playersByQueriedElement.get(e):[];if(a&&a.length)i=!0;else for(var o=e;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{var s=e[TV];(!s||s===SV)&&(r.afterFlush(function(){return n.clearElementCache(e)}),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){BV(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(r){var i=r.player;if(!i.destroyed){var a=r.element,o=t._elementListeners.get(a);o&&o.forEach(function(t){if(t.name==r.triggerName){var n=eU(a,r.triggerName,r.fromState.value,r.toState.value);n._data=e,XF(r.player,t.phase,n,t.callback)}}),i.markedForDestroy?t._engine.afterFlush(function(){i.destroy()}):n.push(r)}}),this._queue=[],n.sort(function(e,n){var r=e.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),RV=function(){function e(t,n,r){gy(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return my(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new xV(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return r.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=n[r[i]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,r){if(DV(t)){var i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(DV(t)){var i=t[TV];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),BV(e,EV)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),zV(e,EV))}},{key:"removeNode",value:function(e,t,n,r){if(DV(t)){var i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t[TV]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,i){return DV(t)?this._fetchNamespace(e).listen(t,n,r,i):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,kU,!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,wU,!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return KF(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e[TV];if(n&&n.setForRemoval){if(e[TV]=SV,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,bV)&&this.markElementAsDisabled(e,!1),this.driver.query(e,bV,!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)BV(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,t)}finally{for(var a=0;a<i.length;a++)i[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?KF(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new tV,i=[],a=new Map,o=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])});var f=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=UV(h,this.collectedEnterElements),v=new Map,p=0;d.forEach(function(e,t){var n=gU+p++;v.set(t,n),e.forEach(function(e){return BV(e,n)})});for(var g=[],y=new Set,m=new Set,k=0;k<this.collectedLeaveElements.length;k++){var C=this.collectedLeaveElements[k],w=C[TV];w&&w.setForRemoval&&(g.push(C),y.add(C),w.hasAnimation?this.driver.query(C,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):m.add(C))}var _=new Map,E=UV(h,Array.from(y));E.forEach(function(e,t){var n=yU+p++;_.set(t,n),e.forEach(function(e){return BV(e,n)})}),e.push(function(){d.forEach(function(e,t){var n=v.get(t);e.forEach(function(e){return zV(e,n)})}),E.forEach(function(e,t){var n=_.get(t);e.forEach(function(e){return zV(e,n)})}),g.forEach(function(e){n.processLeaveNode(e)})});for(var b=[],P=[],S=this._namespaceList.length-1;S>=0;S--)this._namespaceList[S].drainQueuedTransitions(t).forEach(function(e){var t=e.player,a=e.element;if(b.push(t),n.collectedEnterElements.length){var l=a[TV];if(l&&l.setForMove)return void t.destroy()}var h=!f||!n.driver.containsElement(f,a),d=_.get(a),p=v.get(a),g=n._buildInstruction(e,r,p,d,h);if(g.errors&&g.errors.length)P.push(g);else{if(h)return t.onStart(function(){return AU(a,g.fromStyles)}),t.onDestroy(function(){return IU(a,g.toStyles)}),void i.push(t);if(e.isFallbackTransition)return t.onStart(function(){return AU(a,g.fromStyles)}),t.onDestroy(function(){return IU(a,g.toStyles)}),void i.push(t);g.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(a,g.timelines),o.push({instruction:g,player:t,element:a}),g.queriedElements.forEach(function(e){return tU(s,e,[]).push(t)}),g.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach(function(e){return r.add(e)})}}),g.postStyleProps.forEach(function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach(function(e){return r.add(e)})})}});if(P.length){var O=[];P.forEach(function(e){O.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return O.push("- ".concat(e,"\n"))})}),b.forEach(function(e){return e.destroy()}),this.reportError(O)}var T=new Map,I=new Map;o.forEach(function(e){var t=e.element;r.has(t)&&(I.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,T))}),i.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){tU(T,t,[]).push(e),e.destroy()})});var A=g.filter(function(e){return $V(e,u,c)}),M=new Map;FV(M,this.driver,m,c,HF).forEach(function(e){$V(e,u,c)&&A.push(e)});var x=new Map;d.forEach(function(e,t){FV(x,n.driver,new Set(e),u,"!")}),A.forEach(function(e){var t=M.get(e),n=x.get(e);M.set(e,Object.assign(Object.assign({},t),n))});var R=[],N=[],D={};o.forEach(function(e){var t=e.element,o=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return o.onDestroy(function(){return IU(t,s.toStyles)}),o.disabled=!0,o.overrideTotalTime(s.totalTime),void i.push(o);var u=D;if(I.size>1){for(var c=t,f=[];c=c.parentNode;){var h=I.get(c);if(h){u=h;break}f.push(c)}f.forEach(function(e){return I.set(e,u)})}var d=n._buildAnimation(o.namespaceId,s,T,a,x,M);if(o.setRealPlayer(d),u===D)R.push(o);else{var v=n.playersByElement.get(u);v&&v.length&&(o.parentPlayer=KF(v)),i.push(o)}}else AU(t,s.fromStyles),o.onDestroy(function(){return IU(t,s.toStyles)}),N.push(o),l.has(t)&&i.push(o)}),N.forEach(function(e){var t=a.get(e.element);if(t&&t.length){var n=KF(t);e.setRealPlayer(n)}}),i.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var L=0;L<g.length;L++){var F=g[L],U=F[TV];if(zV(F,yU),!U||!U.hasAnimation){var V=[];if(s.size){var B=s.get(F);B&&B.length&&V.push.apply(V,fy(B));for(var z=this.driver.query(F,wU,!0),H=0;H<z.length;H++){var G=s.get(z[H]);G&&G.length&&V.push.apply(V,fy(G))}}var $=V.filter(function(e){return!e.destroyed});$.length?HV(this,F,$):this.processLeaveNode(F)}}return g.length=0,R.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),R}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t[TV];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,i){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var u=!i||i==AV;s.forEach(function(e){e.queued||!u&&e.triggerName!=r||a.push(e)})}}return(n||r)&&(a=a.filter(function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)})),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,i=this,a=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=dy(t.timelines);try{var c=function(){var e=r.value.element,u=e!==a,c=tU(n,e,[]);i._getPreviousPlayers(e,u,o,s,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}AU(a,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,i,a){var o=this,s=t.triggerName,u=t.element,c=[],l=new Set,f=new Set,h=t.timelines.map(function(t){var h=t.element;l.add(h);var d=h[TV];if(d&&d.removedBeforeQueried)return new qF(t.duration,t.delay);var v=h!==u,p=function(e){var t=[];return GV(e,t),t}((n.get(h)||PV).map(function(e){return e.getRealPlayer()})).filter(function(e){return!!e.element&&e.element===h}),g=i.get(h),y=a.get(h),m=QF(0,o._normalizer,0,t.keyframes,g,y),k=o._buildPlayer(t,m,p);if(t.subTimeline&&r&&f.add(h),v){var C=new NV(e,s,h);C.setRealPlayer(k),c.push(C)}return k});c.forEach(function(e){tU(o.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var a=r.indexOf(n);r.splice(a,1)}0==r.length&&delete e[t]}return r}(o.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return BV(e,CU)});var d=KF(h);return d.onDestroy(function(){l.forEach(function(e){return zV(e,CU)}),IU(u,t.toStyles)}),f.forEach(function(e){tU(r,e,[]).push(d)}),d}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new qF(e.duration,e.delay)}}]),e}(),NV=function(){function e(t,n,r){gy(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new qF,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return my(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return XF(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){tU(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function DV(e){return e&&1===e.nodeType}function LV(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function FV(e,t,n,r,i){var a=[];n.forEach(function(e){return a.push(LV(e))});var o=[];r.forEach(function(n,r){var a={};n.forEach(function(e){var n=a[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[TV]=OV,o.push(r))}),e.set(r,a)});var s=0;return n.forEach(function(e){return LV(e,a[s++])}),o}function UV(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var r=new Set(t),i=new Map;function a(e){if(!e)return 1;var t=i.get(e);if(t)return t;var o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:a(o),i.set(e,t),t}return t.forEach(function(e){var t=a(e);1!==t&&n.get(t).push(e)}),n}var VV="$$classes";function BV(e,t){if(e.classList)e.classList.add(t);else{var n=e[VV];n||(n=e[VV]={}),n[t]=!0}}function zV(e,t){if(e.classList)e.classList.remove(t);else{var n=e[VV];n&&delete n[t]}}function HV(e,t,n){KF(n).onDone(function(){return e.processLeaveNode(t)})}function GV(e,t){for(var n=0;n<e.length;n++){var r=e[n];r instanceof WF?GV(r.players,t):t.push(r)}}function $V(e,t,n){var r=n.get(e);if(!r)return!1;var i=t.get(e);return i?r.forEach(function(e){return i.add(e)}):t.set(e,r),n.delete(e),!0}var ZV=function(){function e(t,n,r){var i=this;gy(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new RV(t,n,r),this._timelineEngine=new wV(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return i.onRemovalComplete(e,t)}}return my(e,[{key:"registerTrigger",value:function(e,t,n,r,i){var a=e+"-"+r,o=this._triggerCache[a];if(!o){var s=[],u=jU(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t,n){return new mV(e,t,n)}(r,u,this._normalizer),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,r,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var i=Qg(nU(n),2),a=i[0],o=i[1];this._timelineEngine.command(a,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,i){if("@"==n.charAt(0)){var a=Qg(nU(n),2),o=a[0],s=a[1];return this._timelineEngine.listen(o,t,s,i)}return this._transitionEngine.listen(e,t,n,r,i)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function qV(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=jV(t[0]),t.length>1&&(r=jV(t[t.length-1]))):t&&(n=jV(t)),n||r?new WV(e,n,r):null}var WV=function(){var e=function(){function e(t,n,r){gy(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}return my(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&IU(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(IU(this._element,this._initialStyles),this._endStyles&&(IU(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(AU(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(AU(this._element,this._endStyles),this._endStyles=null),IU(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function jV(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];YV(i)&&((t=t||{})[i]=e[i])}return t}function YV(e){return"display"===e||"position"===e}var KV="animation",QV="animationend",XV=function(){function e(t,n,r,i,a,o,s){var u=this;gy(this,e),this._element=t,this._name=n,this._duration=r,this._delay=i,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return my(e,[{key:"apply",value:function(){(function(e,t){var n=iB(e,"").trim();n.length&&(function(e,t){for(var n=0,r=0;r<e.length;r++)","===e.charAt(r)&&n++}(n),t="".concat(n,", ").concat(t)),rB(e,"",t)})(this._element,"".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name)),nB(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){JV(this._element,this._name,"paused")}},{key:"resume",value:function(){JV(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=eB(this._element,this._name);this._position=e*this._duration,rB(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),nB(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var n=iB(e,"").split(","),r=tB(n,t);r>=0&&(n.splice(r,1),rB(e,"",n.join(",")))}(this._element,this._name))}}]),e}();function JV(e,t,n){rB(e,"PlayState",n,eB(e,t))}function eB(e,t){var n=iB(e,"");return n.indexOf(",")>0?tB(n.split(","),t):tB([n],t)}function tB(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function nB(e,t,n){n?e.removeEventListener(QV,t):e.addEventListener(QV,t)}function rB(e,t,n,r){var i=KV+t;if(null!=r){var a=e.style[i];if(a.length){var o=a.split(",");o[r]=n,n=o.join(",")}}e.style[i]=n}function iB(e,t){return e.style[KV+t]||""}var aB=function(){function e(t,n,r,i,a,o,s,u){gy(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=a,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=i+a,this._buildStyler()}return my(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new XV(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:HU(e.element,r))})}this.currentSnapshot=t}}]),e}(),oB=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=dU(r),i}return my(n,[{key:"init",value:function(){var e=this;this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),ny(ly(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),ny(ly(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;!this._startingStyles||(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,ny(ly(n.prototype),"destroy",this).call(this))}}]),n}(qF),sB=function(){function e(){gy(this,e),this._count=0}return my(e,[{key:"validateStyleProperty",value:function(e){return cU(e)}},{key:"matchesElement",value:function(e,t){return lU(e,t)}},{key:"containsElement",value:function(e,t){return fU(e,t)}},{key:"query",value:function(e,t,n){return hU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return dU(e)});var r="@keyframes ".concat(t," {\n"),i="";n.forEach(function(e){i=" ";var t=parseFloat(e.offset);r+="".concat(i).concat(100*t,"% {\n"),i+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(t,": ").concat(n,";\n"))}}),r+="".concat(i,"}\n")}),r+="}\n";var a=document.createElement("style");return a.textContent=r,a}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=a.filter(function(e){return e instanceof aB}),s={};VU(n,r)&&o.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=BU(e,t,s));if(0==n)return new oB(e,u);var c="gen_css_kf_"+this._count++,l=this.buildKeyframeElement(e,c,t);(function(e){var t,n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(l);var f=qV(e,t),h=new aB(e,t,c,n,r,i,u,f);return h.onDestroy(function(){var e;(e=l).parentNode.removeChild(e)}),h}}]),e}(),uB=function(){function e(t,n,r,i){gy(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return my(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:HU(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),cB=function(){function e(){gy(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(lB().toString()),this._cssKeyframesDriver=new sB}return my(e,[{key:"validateStyleProperty",value:function(e){return cU(e)}},{key:"matchesElement",value:function(e,t){return lU(e,t)}},{key:"containsElement",value:function(e,t){return fU(e,t)}},{key:"query",value:function(e,t,n){return hU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,a);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=a.filter(function(e){return e instanceof uB});VU(n,r)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return u[e]=t[e]})});var l=qV(e,t=BU(e,t=t.map(function(e){return SU(e,!1)}),u));return new uB(e,t,s,l)}}]),e}();function lB(){return jF()&&Element.prototype.animate||{}}var fB=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this))._nextAnimationId=0,i._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Jm.None,styles:[],data:{animation:[]}}),i}return my(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?GF(e):e;return vB(this._renderer,null,t,"register",[n]),new hB(t,this._renderer)}}]),n}(zF);return e.\u0275fac=function(t){return new(t||e)(Bw(DO),Bw(eA))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),hB=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this))._id=e,i._renderer=r,i}return my(n,[{key:"create",value:function(e,t){return new dB(this._id,e,t||{},this._renderer)}}]),n}(function(){return my(function e(){gy(this,e)})}()),dB=function(){function e(t,n,r,i){gy(this,e),this.id=t,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return my(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return vB(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset"),this._started=!1}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function vB(e,t,n,r,i){return e.setProperty(t,"@@".concat(n,":").concat(r),i)}var pB="@.disabled",gB=function(){var e=function(){function e(t,n,r){gy(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return my(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var i=this._rendererCache.get(r);return i||(i=new yB("",r,this.engine),this._rendererCache.set(r,i)),i}var a=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);return t.data.animation.forEach(function t(r){Array.isArray(r)?r.forEach(t):n.engine.registerTrigger(a,o,e,r.name,r)}),new mB(this,o,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return t(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var t=Qg(e,2);(0,t[0])(t[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(DO),Bw(ZV),Bw(EI))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),yB=function(){function e(t,n,r){gy(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return my(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&t==pB?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),mB=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this,r,i,a)).factory=e,o.namespaceId=r,o}return my(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==pB?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r=this;if("@"==t.charAt(0)){var i,a,o=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),s=t.substr(1),u="";return"@"!=s.charAt(0)&&(i=function(e){var t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(s),s=(a=Qg(i,2))[0],u=a[1]),this.engine.listen(this.namespaceId,o,s,u,function(e){r.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}]),n}(yB),kB=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i){return gy(this,n),t.call(this,e.body,r,i)}return my(n,[{key:"ngOnDestroy",value:function(){this.flush()}}]),n}(ZV);return e.\u0275fac=function(t){return new(t||e)(Bw(eA),Bw(pU),Bw(fV))},e.\u0275prov=Um({token:e,factory:e.\u0275fac}),e}(),CB=new Cw("AnimationModuleType"),wB=[{provide:zF,useClass:fB},{provide:fV,useFactory:function(){return new hV}},{provide:ZV,useClass:kB},{provide:DO,useFactory:function(e,t,n){return new gB(e,t,n)},deps:[RM,ZV,EI]}],_B=[{provide:pU,useFactory:function(){return"function"==typeof lB()?new cB:new sB}},{provide:CB,useValue:"BrowserAnimations"}].concat(wB),EB=[{provide:pU,useClass:vU},{provide:CB,useValue:"NoopAnimations"}].concat(wB),bB=function(){var e=function(){function e(){gy(this,e)}return my(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:t.disableAnimations?EB:_B}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({providers:_B,imports:[jM]}),e}(),PB=Jg(9575),SB=Jg.n(PB);function OB(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function TB(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){OB(a,r,i,o,s,"next",e)}function s(e){OB(a,r,i,o,s,"throw",e)}o(void 0)})}}var IB=function(){function e(){gy(this,e)}return my(e,null,[{key:"expectToBe",value:function(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error("A default switch case did not observe the correct value, expected ".concat(t,", but got ").concat(e," instead."))}},{key:"expectToBeMultiple",value:function(e,t){var n,r=!1,i=dy(t);try{for(i.s();!(n=i.n()).done;){if(e===n.value){r=!0;break}}}catch(a){i.e(a)}finally{i.f()}if(!1===r)throw new Error("A default switch case did not observe the correct value, expected a value among ".concat(t,", but got ").concat(e," instead."))}},{key:"getNonNullable",value:function(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}]),e}();function AB(e,t){e&&console.log(t)}function MB(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);for(var n=e,r=t,i=0,a=Object.keys(n);i<a.length;i++){var o=a[i];if(!(o in r))return!1;if(!1===MB(n[o],r[o]))return!1}return!0}return e===t}function xB(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(var t in e)if(null!=e[t]&&!1===xB(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function RB(e,t){if(xB(e)&&xB(t))return MB(e,t);throw new Error("Comparing non comparable objects: ".concat(e.constructor.name," and ").concat(t.constructor.name))}var NB=function(){function e(t){gy(this,e),this.value=t}return my(e,[{key:"isPresent",value:function(){return null!=this.value}},{key:"isAbsent",value:function(){return null==this.value}},{key:"get",value:function(){if(this.isPresent())return this.value;throw new Error("Value is absent")}},{key:"getOrElse",value:function(e){return this.isPresent()?this.value:e}},{key:"equals",value:function(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&RB(this.value,e.value)}},{key:"equalsValue",value:function(t){return this.equals(e.of(t))}},{key:"toString",value:function(){return this.isAbsent()?"MGPOptional.empty()":"MGPOptional.of(".concat(this.value,")")}},{key:"map",value:function(t){return this.isPresent()?e.of(t(this.get())):e.empty()}}],[{key:"of",value:function(t){return new e(t)}},{key:"ofNullable",value:function(t){return null==t?e.empty():e.of(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),DB=function(){function e(){gy(this,e)}return my(e,[{key:"equals",value:function(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&RB(this.get(),e.get())}}],[{key:"success",value:function(e){return new LB(e)}},{key:"failure",value:function(e){return new FB(e)}}]),e}(),LB=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).value=e,r}return my(n,[{key:"isSuccess",value:function(){return!0}},{key:"isFailure",value:function(){return!1}},{key:"get",value:function(){return this.value}},{key:"getReason",value:function(){throw new Error("Cannot get failure reason from a success")}},{key:"getReasonOr",value:function(e){return e}},{key:"toOptional",value:function(){return NB.of(this.value)}},{key:"toString",value:function(){return"MGPFallible.success(".concat(this.value,")")}}]),n}(DB),FB=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).reason=e,r}return my(n,[{key:"isSuccess",value:function(){return!1}},{key:"isFailure",value:function(){return!0}},{key:"get",value:function(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}},{key:"getReason",value:function(){return this.reason}},{key:"getReasonOr",value:function(e){return this.getReason()}},{key:"toOptional",value:function(){return NB.empty()}},{key:"toString",value:function(){return"MGPFallible.failure(".concat(this.reason,")")}}]),n}(DB),UB=function(){function e(t){gy(this,e),this.reason=t}return my(e,[{key:"isFailure",value:function(){return!1===this.isSuccess()}},{key:"isSuccess",value:function(){return null==this.reason}},{key:"getReason",value:function(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}},{key:"toFallible",value:function(e){return this.isSuccess()?DB.success(e):DB.failure(this.getReason())}},{key:"toFailedFallible",value:function(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return DB.failure(this.getReason())}}],[{key:"ofFallible",value:function(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}},{key:"failure",value:function(t){return new e(t)}}]),e}();UB.SUCCESS=new UB(null);var VB=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},BB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,f=63&c;u||(f=64,o||(l=64)),r.push(n[a>>2],n[(3&a)<<4|s>>4],n[l],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(VB(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();r.push(a<<2|o>>4),64!==s&&(r.push(o<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},zB=function(e){return function(e){var t=VB(e);return BB.encodeByteArray(t,!0)}(e).replace(/\./g,"")},HB=function(){function e(){var t=this;gy(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return my(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}}}]),e}();function GB(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function $B(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(GB())}function ZB(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function qB(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function WB(){var e=GB();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function jB(){return"object"==typeof indexedDB}function YB(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function KB(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}var QB=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(uy(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(uy(a),XB.prototype.create),a}return my(n)}(ey(Error)),XB=function(){function e(t,n,r){gy(this,e),this.service=t,this.serviceName=n,this.errors=r}return my(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(JB,function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error";return new QB(n,"".concat(this.serviceName,": ").concat(i," (").concat(n,")."),t)}}]),e}(),JB=/\{\$([^}]+)}/g;function ez(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(tz(s)&&tz(u)){if(!ez(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function tz(e){return null!==e&&"object"==typeof e}function nz(e){for(var t=[],n=function(){var e=Qg(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function rz(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=Qg(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}}),t}function iz(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var az=function(){function e(t,n){var r=this;gy(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(e){r.error(e)})}return my(e,[{key:"next",value:function(e){this.forEachObserver(function(t){t.next(e)})}},{key:"error",value:function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)}},{key:"complete",value:function(){this.forEachObserver(function(e){e.complete()}),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=oz),void 0===r.error&&(r.error=oz),void 0===r.complete&&(r.complete=oz);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))}}]),e}();function oz(){}function sz(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function uz(e){return e&&e._delegate?e._delegate:e}var cz,lz,fz=function(){function e(t,n,r){gy(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return my(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),hz="[DEFAULT]",dz=function(){function e(t,n){gy(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return my(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new HB;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:hz})}catch(u){}var t,n=dy(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=Qg(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hz;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(e.instances.values()),t.next=3,Promise.all([].concat(fy(n.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()})),fy(n.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))));case 3:case"end":return t.stop()}},t)}))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hz;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hz;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=dy(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=Qg(i.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(a)}}catch(l){o.e(l)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=dy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(o){}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===hz?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hz;return this.component?this.component.multipleInstances?e:hz:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}(),vz=function(){function e(t){gy(this,e),this.name=t,this.providers=new Map}return my(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new dz(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),pz=[],gz=function(){return(e=gz||(gz={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",gz;var e}(),yz={debug:gz.DEBUG,verbose:gz.VERBOSE,info:gz.INFO,warn:gz.WARN,error:gz.ERROR,silent:gz.SILENT},mz=gz.INFO,kz=(Kg(ry={},gz.DEBUG,"log"),Kg(ry,gz.VERBOSE,"log"),Kg(ry,gz.INFO,"info"),Kg(ry,gz.WARN,"warn"),Kg(ry,gz.ERROR,"error"),ry),Cz=function(e,t){var n;if(!(t<e.logLevel)){var r=(new Date).toISOString(),i=kz[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(n=console)[i].apply(n,["[".concat(r,"]  ").concat(e.name,":")].concat(o))}},wz=function(){function e(t){gy(this,e),this.name=t,this._logLevel=mz,this._logHandler=Cz,this._userLogHandler=null,pz.push(this)}return my(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in gz))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?yz[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,gz.DEBUG].concat(t)),this._logHandler.apply(this,[this,gz.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,gz.VERBOSE].concat(t)),this._logHandler.apply(this,[this,gz.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,gz.INFO].concat(t)),this._logHandler.apply(this,[this,gz.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,gz.WARN].concat(t)),this._logHandler.apply(this,[this,gz.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,gz.ERROR].concat(t)),this._logHandler.apply(this,[this,gz.ERROR].concat(t))}}]),e}(),_z=new WeakMap,Ez=new WeakMap,bz=new WeakMap,Pz=new WeakMap,Sz=new WeakMap,Oz={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ez.get(e);if("objectStoreNames"===t)return e.objectStoreNames||bz.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Tz(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function Tz(e){if(e instanceof IDBRequest)return function(e){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(Tz(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)});return t.then(function(t){t instanceof IDBCursor&&_z.set(t,e)}).catch(function(){}),Sz.set(t,e),t}(e);if(Pz.has(e))return Pz.get(e);var t=function(e){return"function"==typeof e?function(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(lz||(lz=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Iz(this),n),Tz(_z.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tz(e.apply(Iz(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[Iz(this),t].concat(r));return bz.set(a,t.sort?t.sort():[t]),Tz(a)}}(e):(e instanceof IDBTransaction&&function(e){if(!Ez.has(e)){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)});Ez.set(e,t)}}(e),function(e,t){return t.some(function(t){return e instanceof t})}(e,cz||(cz=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Oz):e)}(e);return t!==e&&(Pz.set(e,t),Sz.set(t,e)),t}var Iz=function(e){return Sz.get(e)};function Az(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=Tz(s);return i&&s.addEventListener("upgradeneeded",function(e){i(Tz(s.result),e.oldVersion,e.newVersion,Tz(s.transaction))}),r&&s.addEventListener("blocked",function(){return r()}),u.then(function(e){o&&e.addEventListener("close",function(){return o()}),a&&e.addEventListener("versionchange",function(){return a()})}).catch(function(){}),u}function Mz(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.blocked,r=indexedDB.deleteDatabase(e);return n&&r.addEventListener("blocked",function(){return n()}),Tz(r).then(function(){})}var xz,Rz=["get","getKey","getAll","getAllKeys","count"],Nz=["put","add","delete","clear"],Dz=new Map;function Lz(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(Dz.get(t))return Dz.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=Nz.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||Rz.includes(n))){var a,o=(a=TB(regeneratorRuntime.mark(function e(t){var a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,i?"readwrite":"readonly"),s=o.store,u=f.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=f[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(a=s)[n].apply(a,c),i&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)});return Dz.set(t,o),o}}}Oz=Yg(Yg({},xz=Oz),{},{get:function(e,t,n){return Lz(e,t)||xz.get(e,t,n)},has:function(e,t){return!!Lz(e,t)||xz.has(e,t)}});var Fz=function(){function e(t){gy(this,e),this.container=t}return my(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(function(e){return e}).join(" ")}}]),e}(),Uz="@firebase/app",Vz=new wz("@firebase/app"),Bz="[DEFAULT]",zz=(Kg(ay={},Uz,"fire-core"),Kg(ay,"@firebase/app-compat","fire-core-compat"),Kg(ay,"@firebase/analytics","fire-analytics"),Kg(ay,"@firebase/analytics-compat","fire-analytics-compat"),Kg(ay,"@firebase/app-check","fire-app-check"),Kg(ay,"@firebase/app-check-compat","fire-app-check-compat"),Kg(ay,"@firebase/auth","fire-auth"),Kg(ay,"@firebase/auth-compat","fire-auth-compat"),Kg(ay,"@firebase/database","fire-rtdb"),Kg(ay,"@firebase/database-compat","fire-rtdb-compat"),Kg(ay,"@firebase/functions","fire-fn"),Kg(ay,"@firebase/functions-compat","fire-fn-compat"),Kg(ay,"@firebase/installations","fire-iid"),Kg(ay,"@firebase/installations-compat","fire-iid-compat"),Kg(ay,"@firebase/messaging","fire-fcm"),Kg(ay,"@firebase/messaging-compat","fire-fcm-compat"),Kg(ay,"@firebase/performance","fire-perf"),Kg(ay,"@firebase/performance-compat","fire-perf-compat"),Kg(ay,"@firebase/remote-config","fire-rc"),Kg(ay,"@firebase/remote-config-compat","fire-rc-compat"),Kg(ay,"@firebase/storage","fire-gcs"),Kg(ay,"@firebase/storage-compat","fire-gcs-compat"),Kg(ay,"@firebase/firestore","fire-fst"),Kg(ay,"@firebase/firestore-compat","fire-fst-compat"),Kg(ay,"fire-js","fire-js"),Kg(ay,"firebase","fire-js-all"),ay),Hz=new Map,Gz=new Map;function $z(e,t){try{e.container.addComponent(t)}catch(n){Vz.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Zz(e){var t=e.name;if(Gz.has(t))return Vz.debug("There were multiple attempts to register component ".concat(t,".")),!1;Gz.set(t,e);var n,r=dy(Hz.values());try{for(r.s();!(n=r.n()).done;){$z(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function qz(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var Wz=new XB("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."}),jz=function(){function e(t,n,r){var i=this;gy(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new fz("app",function(){return i},"PUBLIC"))}return my(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Wz.create("app-deleted",{appName:this._name})}}]),e}(),Yz="9.9.0";function Kz(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bz,t=Hz.get(e);if(!t)throw Wz.create("no-app",{appName:e});return t}function Qz(){return Array.from(Hz.values())}function Xz(e,t,n){var r,i=null!==(r=zz[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Vz.warn(s.join(" "))}Zz(new fz("".concat(i,"-version"),function(){return{library:i,version:t}},"VERSION"))}var Jz="firebase-heartbeat-store",eH=null;function tH(){return eH||(eH=Az("firebase-heartbeat-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(Jz)}}).catch(function(e){throw Wz.create("storage-open",{originalErrorMessage:e.message})})),eH}function nH(){return nH=TB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,tH();case 3:return e.abrupt("return",e.sent.transaction(Jz).objectStore(Jz).get(aH(t)));case 6:throw e.prev=6,e.t0=e.catch(0),Wz.create("storage-get",{originalErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 9:case"end":return e.stop()}},e,null,[[0,6]])})),nH.apply(this,arguments)}function rH(e,t){return iH.apply(this,arguments)}function iH(){return iH=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,tH();case 3:return i=e.sent.transaction(Jz,"readwrite"),e.next=6,i.objectStore(Jz).put(n,aH(t));case 6:return e.abrupt("return",i.done);case 9:throw e.prev=9,e.t0=e.catch(0),Wz.create("storage-set",{originalErrorMessage:null===(r=e.t0)||void 0===r?void 0:r.message});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),iH.apply(this,arguments)}function aH(e){return"".concat(e.name,"!").concat(e.options.appId)}var oH=function(){function e(t){var n=this;gy(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new uH(r),this._heartbeatsCachePromise=this._storage.read().then(function(e){return n._heartbeatsCache=e,e})}return my(e,[{key:"triggerHeartbeat",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=sH(),t.t0=null===e._heartbeatsCache,!t.t0){t.next=6;break}return t.next=5,e._heartbeatsCachePromise;case 5:e._heartbeatsCache=t.sent;case 6:if(e._heartbeatsCache.lastSentHeartbeatDate===r||e._heartbeatsCache.heartbeats.some(function(e){return e.date===r})){t.next=8;break}return t.abrupt("return",(e._heartbeatsCache.heartbeats.push({date:r,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),e._storage.overwrite(e._heartbeatsCache)));case 8:case"end":return t.stop()}},t)}))()}},{key:"getHeartbeatsHeader",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===e._heartbeatsCache,!t.t0){t.next=4;break}return t.next=4,e._heartbeatsCachePromise;case 4:if(null!==e._heartbeatsCache&&0!==e._heartbeatsCache.heartbeats.length){t.next=6;break}return t.abrupt("return","");case 6:if(n=sH(),r=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=dy(e);try{var o=function(){var e=t.value,a=r.find(function(t){return t.agent===e.agent});if(a){if(a.dates.push(e.date),cH(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),cH(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){var s=o();if("break"===s)break}}catch(u){a.e(u)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}(e._heartbeatsCache.heartbeats),i=r.heartbeatsToSend,a=r.unsentEntries,o=zB(JSON.stringify({version:2,heartbeats:i})),e._heartbeatsCache.lastSentHeartbeatDate=n,!(a.length>0)){t.next=14;break}return e._heartbeatsCache.heartbeats=a,t.next=12,e._storage.overwrite(e._heartbeatsCache);case 12:t.next=15;break;case 14:e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache);case 15:return t.abrupt("return",o);case 16:case"end":return t.stop()}},t)}))()}}]),e}();function sH(){return(new Date).toISOString().substring(0,10)}var uH=function(){function e(t){gy(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return my(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){return TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!!jB()&&YB().then(function(){return!0}).catch(function(){return!1}));case 1:case"end":return e.stop()}},e)}))()}},{key:"read",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._canUseIndexedDBPromise;case 2:if(t.t1=t.sent,!t.t1){t.next=7;break}return t.next=6,function(e){return nH.apply(this,arguments)}(e.app);case 6:t.t1=t.sent;case 7:if(t.t0=t.t1,t.t0){t.next=10;break}t.t0={heartbeats:[]};case 10:return t.abrupt("return",t.t0);case 11:case"end":return t.stop()}},t)}))()}},{key:"overwrite",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",rH(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats}));case 7:case"end":return n.stop()}},n)}))()}},{key:"add",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",rH(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[].concat(fy(i.heartbeats),fy(e.heartbeats))}));case 7:case"end":return n.stop()}},n)}))()}}]),e}();function cH(e){return zB(JSON.stringify({version:2,heartbeats:e})).length}Zz(new fz("platform-logger",function(e){return new Fz(e)},"PRIVATE")),Zz(new fz("heartbeat",function(e){return new oH(e)},"PRIVATE")),Xz(Uz,"0.7.28",""),Xz(Uz,"0.7.28","esm2017"),Xz("fire-js","");var lH,fH="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},hH={},dH=dH||{},vH=fH||self;function pH(){}function gH(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function yH(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var mH="closure_uid_"+(1e9*Math.random()>>>0),kH=0;function CH(e,t,n){return e.call.apply(e.bind,arguments)}function wH(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function _H(e,t,n){return(_H=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?CH:wH).apply(null,arguments)}function EH(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function bH(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function PH(){this.s=this.s,this.o=this.o}var SH={};PH.prototype.s=!1,PH.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,mH)&&e[mH]||(e[mH]=++kH)}(this);delete SH[e]}},PH.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var OH=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},TH=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function IH(e){return Array.prototype.concat.apply([],arguments)}function AH(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function MH(e){return/^[\s\xa0]*$/.test(e)}var xH,RH=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function NH(e,t){return-1!=e.indexOf(t)}function DH(e,t){return e<t?-1:e>t?1:0}e:{var LH=vH.navigator;if(LH){var FH=LH.userAgent;if(FH){xH=FH;break e}}xH=""}function UH(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function VH(e){var t={};for(var n in e)t[n]=e[n];return t}var BH="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function zH(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<BH.length;a++)n=BH[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function HH(e){return HH[" "](e),e}HH[" "]=pH;var GH,$H=NH(xH,"Opera"),ZH=NH(xH,"Trident")||NH(xH,"MSIE"),qH=NH(xH,"Edge"),WH=qH||ZH,jH=NH(xH,"Gecko")&&!(NH(xH.toLowerCase(),"webkit")&&!NH(xH,"Edge"))&&!(NH(xH,"Trident")||NH(xH,"MSIE"))&&!NH(xH,"Edge"),YH=NH(xH.toLowerCase(),"webkit")&&!NH(xH,"Edge");function KH(){var e=vH.document;return e?e.documentMode:void 0}e:{var QH="",XH=function(){var e=xH;return jH?/rv:([^\);]+)(\)|;)/.exec(e):qH?/Edge\/([\d\.]+)/.exec(e):ZH?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):YH?/WebKit\/(\S+)/.exec(e):$H?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(XH&&(QH=XH?XH[1]:""),ZH){var JH=KH();if(null!=JH&&JH>parseFloat(QH)){GH=String(JH);break e}}GH=QH}var eG={};var tG=vH.document&&ZH&&(KH()||parseInt(GH,10))||void 0,nG=function(){if(!vH.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{vH.addEventListener("test",pH,t),vH.removeEventListener("test",pH,t)}catch(n){}return e}();function rG(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function iG(e,t){if(rG.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(jH){e:{try{HH(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:aG[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&iG.Z.h.call(this)}}rG.prototype.h=function(){this.defaultPrevented=!0},bH(iG,rG);var aG={2:"touch",3:"pen",4:"mouse"};iG.prototype.h=function(){iG.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var oG="closure_listenable_"+(1e6*Math.random()|0),sG=0;function uG(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++sG,this.ca=this.fa=!1}function cG(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function lG(e){this.src=e,this.g={},this.h=0}function fG(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=OH(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(cG(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function hG(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}lG.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=hG(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new uG(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var dG="closure_lm_"+(1e6*Math.random()|0),vG={};function pG(e,t,n,r,i){if(r&&r.once)return yG(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)pG(e,t[a],n,r,i);return null}return n=bG(n),e&&e[oG]?e.N(t,n,yH(r)?!!r.capture:!!r,i):gG(e,t,n,!1,r,i)}function gG(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=yH(i)?!!i.capture:!!i,s=_G(e);if(s||(e[dG]=s=new lG(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){var e=wG;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)nG||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(CG(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function yG(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)yG(e,t[a],n,r,i);return null}return n=bG(n),e&&e[oG]?e.O(t,n,yH(r)?!!r.capture:!!r,i):gG(e,t,n,!0,r,i)}function mG(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)mG(e,t[a],n,r,i);else r=yH(r)?!!r.capture:!!r,n=bG(n),e&&e[oG]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=hG(a=e.g[t],n,r,i))&&(cG(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--))):e&&(e=_G(e))&&(t=e.g[t.toString()],e=-1,t&&(e=hG(t,n,r,i)),(n=-1<e?t[e]:null)&&kG(n))}function kG(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[oG])fG(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(CG(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=_G(t))?(fG(n,e),0==n.h&&(n.src=null,t[dG]=null)):cG(e)}}}function CG(e){return e in vG?vG[e]:vG[e]="on"+e}function wG(e,t){if(e.ca)e=!0;else{t=new iG(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&kG(e),e=n.call(r,t)}return e}function _G(e){return(e=e[dG])instanceof lG?e:null}var EG="__closure_events_fn_"+(1e9*Math.random()>>>0);function bG(e){return"function"==typeof e?e:(e[EG]||(e[EG]=function(t){return e.handleEvent(t)}),e[EG])}function PG(){PH.call(this),this.i=new lG(this),this.P=this,this.I=null}function SG(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new rG(t,e);else if(t instanceof rG)t.target=t.target||e;else{var i=t;zH(t=new rG(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=OG(o,r,!0,t)&&i}if(i=OG(o=t.g=e,r,!0,t)&&i,i=OG(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=OG(o=t.g=n[a],r,!1,t)&&i}function OG(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&fG(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}bH(PG,PH),PG.prototype[oG]=!0,PG.prototype.removeEventListener=function(e,t,n,r){mG(this,e,t,n,r)},PG.prototype.M=function(){if(PG.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)cG(n[r]);delete t.g[e],t.h--}}this.I=null},PG.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},PG.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var TG=vH.JSON.stringify;function IG(){var e=LG,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var AG,MG=new(function(){function e(t,n){gy(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return my(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())(function(){return new xG},function(e){return e.reset()}),xG=function(){function e(){gy(this,e),this.next=this.g=this.h=null}return my(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function RG(e){vH.setTimeout(function(){throw e},0)}function NG(e,t){AG||function(){var e=vH.Promise.resolve(void 0);AG=function(){e.then(FG)}}(),DG||(AG(),DG=!0),LG.add(e,t)}var DG=!1,LG=new(function(){function e(){gy(this,e),this.h=this.g=null}return my(e,[{key:"add",value:function(e,t){var n=MG.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}());function FG(){for(var e;e=IG();){try{e.h.call(e.g)}catch(n){RG(n)}var t=MG;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}DG=!1}function UG(e,t){PG.call(this),this.h=e||1,this.g=t||vH,this.j=_H(this.kb,this),this.l=Date.now()}function VG(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function BG(e,t,n){if("function"==typeof e)n&&(e=_H(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=_H(e.handleEvent,e)}return 2147483647<Number(t)?-1:vH.setTimeout(e,t||0)}function zG(e){e.g=BG(function(){e.g=null,e.i&&(e.i=!1,zG(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}bH(UG,PG),(lH=UG.prototype).da=!1,lH.S=null,lH.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),SG(this,"tick"),this.da&&(VG(this),this.start()))}},lH.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},lH.M=function(){UG.Z.M.call(this),VG(this),delete this.g};var HG=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return my(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:zG(this)}},{key:"M",value:function(){ny(ly(n.prototype),"M",this).call(this),this.g&&(vH.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(PH);function GG(e){PH.call(this),this.h=e,this.g={}}bH(GG,PH);var $G=[];function ZG(e,t,n,r){Array.isArray(n)||(n&&($G[0]=n.toString()),n=$G);for(var i=0;i<n.length;i++){var a=pG(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function qG(e){UH(e.g,function(e,t){this.g.hasOwnProperty(t)&&kG(e)},e),e.g={}}function WG(){this.g=!0}function jG(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return TG(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}GG.prototype.M=function(){GG.Z.M.call(this),qG(this)},GG.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},WG.prototype.Aa=function(){this.g=!1},WG.prototype.info=function(){};var YG={},KG=null;function QG(){return KG=KG||new PG}function XG(e){rG.call(this,YG.Ma,e)}function JG(e){var t=QG();SG(t,new XG(t,e))}function e$(e,t){rG.call(this,YG.STAT_EVENT,e),this.stat=t}function t$(e){var t=QG();SG(t,new e$(t,e))}function n$(e,t){rG.call(this,YG.Na,e),this.size=t}function r$(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return vH.setTimeout(function(){e()},t)}YG.Ma="serverreachability",bH(XG,rG),YG.STAT_EVENT="statevent",bH(e$,rG),YG.Na="timingevent",bH(n$,rG);var i$={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},a$={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function o$(){}function s$(){}o$.prototype.h=null;var u$,c$={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function l$(){rG.call(this,"d")}function f$(){rG.call(this,"c")}function h$(){}function d$(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new GG(this),this.P=p$,this.W=new UG(e=WH?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new v$}function v$(){this.i=null,this.g="",this.h=!1}bH(l$,rG),bH(f$,rG),bH(h$,o$),h$.prototype.g=function(){return new XMLHttpRequest},h$.prototype.i=function(){return{}},u$=new h$;var p$=45e3,g$={},y$={};function m$(e,t,n){e.K=1,e.v=z$(D$(t)),e.s=n,e.U=!0,k$(e,null)}function k$(e,t){e.F=Date.now(),E$(e),e.A=D$(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),eZ(n.h,"t",r),e.C=0,n=e.l.H,e.h=new v$,e.g=eq(e.l,n?t:null,!e.s),0<e.O&&(e.L=new HG(_H(e.Ia,e,e.g),e.O)),ZG(e.V,e.g,"readystatechange",e.gb),t=e.H?VH(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),JG(1),function(e,t,n,r,i,a){e.info(function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var f=l.split("_");o=2<=f.length&&"type"==f[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function C$(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function w$(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=_$(e,n))==y$){4==t&&(e.o=4,t$(14),i=!1),jG(e.j,e.m,null,"[Incomplete Response]");break}if(r==g$){e.o=4,t$(15),jG(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}jG(e.j,e.m,r,null),T$(e,r)}C$(e)&&r!=y$&&r!=g$&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,t$(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),qZ(t),t.L=!0,t$(11))):(jG(e.j,e.m,n,"[Invalid Chunked Response]"),O$(e),S$(e))}function _$(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?y$:(n=Number(t.substring(n,r)),isNaN(n)?g$:(r+=1)+n>t.length?y$:(t=t.substr(r,n),e.C=r+n,t))}function E$(e){e.Y=Date.now()+e.P,b$(e,e.P)}function b$(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=r$(_H(e.eb,e),t)}function P$(e){e.B&&(vH.clearTimeout(e.B),e.B=null)}function S$(e){0==e.l.G||e.I||YZ(e.l,e)}function O$(e){P$(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,VG(e.W),qG(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function T$(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||oZ(n.i,e)))if(n.I=e.N,!e.J&&oZ(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=r$(_H(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;jZ(n),FZ(n)}ZZ(n),t$(18)}if(1>=aZ(n.i)&&n.ka){try{n.ka()}catch(y){}n.ka=void 0}}else QZ(n,11)}else if((e.J||n.g==e)&&jZ(n),!MH(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var f=r.i;!f.g&&(NH(l,"spdy")||NH(l,"quic")||NH(l,"h2"))&&(f.j=f.l,f.g=new Set,f.h&&(sZ(f,f.h),f.h=null))}if(r.D){var h=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.sa=h,B$(r.F,r.D,h))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=JZ(r,r.H?r.la:null,r.W),d.J){uZ(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(P$(v),E$(v)),r.g=d}else $Z(r);0<n.l.length&&BZ(n)}else"stop"!=a[0]&&"close"!=a[0]||QZ(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?QZ(n,7):LZ(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}JG(4)}catch(m){}}function I$(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(gH(e)||"string"==typeof e)TH(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(gH(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(gH(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function A$(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof A$)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function M$(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];x$(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)x$(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function x$(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(lH=d$.prototype).setTimeout=function(e){this.P=e},lH.gb=function(e){e=e.target;var t=this.L;t&&3==MZ(e)?t.l():this.Ia(e)},lH.Ia=function(e){try{if(e==this.g)e:{var t=MZ(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||WH||this.g&&(this.h.h||this.g.ga()||xZ(this.g)))){this.I||4!=t||7==n||JG(8==n||0>=r?3:2),P$(this);var i=this.g.ba();this.N=i;t:if(C$(this)){var a=xZ(this.g);e="";var o=a.length,s=4==MZ(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){O$(this),S$(this);var u="";break t}this.h.i=new vH.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!MH(c)){var f=c;break t}}f=null}if(!(i=f)){this.i=!1,this.o=3,t$(12),O$(this),S$(this);break e}jG(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,T$(this,i)}this.U?(w$(this,t,u),WH&&this.i&&3==t&&(ZG(this.V,this.W,"tick",this.fb),this.W.start())):(jG(this.j,this.m,u,null),T$(this,u)),4==t&&O$(this),this.i&&!this.I&&(4==t?YZ(this.l,this):(this.i=!1,E$(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,t$(12)):(this.o=0,t$(13)),O$(this),S$(this)}}}catch(h){}},lH.fb=function(){if(this.g){var e=MZ(this.g),t=this.g.ga();this.C<t.length&&(P$(this),w$(this,e,t),this.i&&4!=e&&E$(this))}},lH.cancel=function(){this.I=!0,O$(this)},lH.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(JG(3),t$(17)),O$(this),this.o=2,S$(this)):b$(this,this.Y-e)},(lH=A$.prototype).R=function(){M$(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},lH.T=function(){return M$(this),this.g.concat()},lH.get=function(e,t){return x$(this.h,e)?this.h[e]:t},lH.set=function(e,t){x$(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},lH.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var R$=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function N$(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof N$){this.g=void 0!==t?t:e.g,L$(this,e.j),this.s=e.s,F$(this,e.i),U$(this,e.m),this.l=e.l,t=e.h;var n=new K$;n.i=t.i,t.g&&(n.g=new A$(t.g),n.h=t.h),V$(this,n),this.o=e.o}else e&&(n=String(e).match(R$))?(this.g=!!t,L$(this,n[1]||"",!0),this.s=H$(n[2]||""),F$(this,n[3]||"",!0),U$(this,n[4]),this.l=H$(n[5]||"",!0),V$(this,n[6]||"",!0),this.o=H$(n[7]||"")):(this.g=!!t,this.h=new K$(null,this.g))}function D$(e){return new N$(e)}function L$(e,t,n){e.j=n?H$(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function F$(e,t,n){e.i=n?H$(t,!0):t}function U$(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function V$(e,t,n){t instanceof K$?(e.h=t,function(e,t){t&&!e.j&&(Q$(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(X$(this,t),eZ(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=G$(t,j$)),e.h=new K$(t,e.g))}function B$(e,t,n){e.h.set(t,n)}function z$(e){return B$(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function H$(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function G$(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,$$),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function $$(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}N$.prototype.toString=function(){var e=[],t=this.j;t&&e.push(G$(t,Z$,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(G$(t,Z$,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(G$(n,"/"==n.charAt(0)?W$:q$,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",G$(n,Y$)),e.join("")};var Z$=/[#\/\?@]/g,q$=/[#\?:]/g,W$=/[#\?]/g,j$=/[#\?@]/g,Y$=/#/g;function K$(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Q$(e){e.g||(e.g=new A$,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function X$(e,t){Q$(e),t=tZ(e,t),x$(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,x$((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&M$(e)))}function J$(e,t){return Q$(e),t=tZ(e,t),x$(e.g.h,t)}function eZ(e,t,n){X$(e,t),0<n.length&&(e.i=null,e.g.set(tZ(e,t),AH(n)),e.h+=n.length)}function tZ(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function nZ(e){this.l=e||rZ,e=vH.PerformanceNavigationTiming?0<(e=vH.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(vH.g&&vH.g.Ea&&vH.g.Ea()&&vH.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(lH=K$.prototype).add=function(e,t){Q$(this),this.i=null,e=tZ(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},lH.forEach=function(e,t){Q$(this),this.g.forEach(function(n,r){TH(n,function(n){e.call(t,n,r,this)},this)},this)},lH.T=function(){Q$(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},lH.R=function(e){Q$(this);var t=[];if("string"==typeof e)J$(this,e)&&(t=IH(t,this.g.get(tZ(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=IH(t,e[n])}return t},lH.set=function(e,t){return Q$(this),this.i=null,J$(this,e=tZ(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},lH.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},lH.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var rZ=10;function iZ(e){return!!e.h||!!e.g&&e.g.size>=e.j}function aZ(e){return e.h?1:e.g?e.g.size:0}function oZ(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function sZ(e,t){e.g?e.g.add(t):e.h=t}function uZ(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function cZ(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=dy(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return AH(e.i)}function lZ(){}function fZ(){this.g=new lZ}function hZ(e,t,n){var r=n||"";try{I$(e,function(e,n){var i=e;yH(e)&&(i=TG(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function dZ(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function vZ(e){this.l=e.$b||null,this.j=e.ib||!1}function pZ(e,t){PG.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=gZ,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}nZ.prototype.cancel=function(){if(this.i=cZ(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=dy(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},lZ.prototype.stringify=function(e){return vH.JSON.stringify(e,void 0)},lZ.prototype.parse=function(e){return vH.JSON.parse(e,void 0)},bH(vZ,o$),vZ.prototype.g=function(){return new pZ(this.l,this.j)},vZ.prototype.i=function(e){return function(){return e}}({}),bH(pZ,PG);var gZ=0;function yZ(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function mZ(e){e.readyState=4,e.l=null,e.j=null,e.A=null,kZ(e)}function kZ(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(lH=pZ.prototype).open=function(e,t){if(this.readyState!=gZ)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,kZ(this)},lH.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||vH).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},lH.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,mZ(this)),this.readyState=gZ},lH.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,kZ(this)),this.g&&(this.readyState=3,kZ(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==vH.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;yZ(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},lH.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?mZ(this):kZ(this),3==this.readyState&&yZ(this)}},lH.Ua=function(e){this.g&&(this.response=this.responseText=e,mZ(this))},lH.Ta=function(e){this.g&&(this.response=e,mZ(this))},lH.ha=function(){this.g&&mZ(this)},lH.setRequestHeader=function(e,t){this.v.append(e,t)},lH.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},lH.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(pZ.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var CZ=vH.JSON.parse;function wZ(e){PG.call(this),this.headers=new A$,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=_Z,this.K=this.L=!1}bH(wZ,PG);var _Z="",EZ=/^https?$/i,bZ=["POST","PUT"];function PZ(e){return"content-type"==e.toLowerCase()}function SZ(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,OZ(e),IZ(e)}function OZ(e){e.D||(e.D=!0,SG(e,"complete"),SG(e,"error"))}function TZ(e){if(e.h&&void 0!==dH&&(!e.C[1]||4!=MZ(e)||2!=e.ba()))if(e.v&&4==MZ(e))BG(e.Fa,0,e);else if(SG(e,"readystatechange"),4==MZ(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(R$)[1]||null;if(!a&&vH.self&&vH.self.location){var o=vH.self.location.protocol;a=o.substr(0,o.length-1)}i=!EZ.test(a?a.toLowerCase():"")}t=i}if(t)SG(e,"complete"),SG(e,"success");else{e.m=6;try{var s=2<MZ(e)?e.g.statusText:""}catch(u){s=""}e.j=s+" ["+e.ba()+"]",OZ(e)}}finally{IZ(e)}}}function IZ(e,t){if(e.g){AZ(e);var n=e.g,r=e.C[0]?pH:null;e.g=null,e.C=null,t||SG(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function AZ(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(vH.clearTimeout(e.A),e.A=null)}function MZ(e){return e.g?e.g.readyState:0}function xZ(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case _Z:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function RZ(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return UH(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):B$(e,t,n))}function NZ(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function DZ(e){this.za=0,this.l=[],this.h=new WG,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=NZ("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=NZ("baseRetryDelayMs",5e3,e),this.$a=NZ("retryDelaySeedMs",1e4,e),this.Ya=NZ("forwardChannelMaxRetries",2,e),this.ra=NZ("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new nZ(e&&e.concurrentRequestLimit),this.Ca=new fZ,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function LZ(e){if(UZ(e),3==e.G){var t=e.V++,n=D$(e.F);B$(n,"SID",e.J),B$(n,"RID",t),B$(n,"TYPE","terminate"),HZ(e,n),(t=new d$(e,e.h,t,void 0)).K=2,t.v=z$(D$(n)),n=!1,vH.navigator&&vH.navigator.sendBeacon&&(n=vH.navigator.sendBeacon(t.v.toString(),"")),!n&&vH.Image&&((new Image).src=t.v,n=!0),n||(t.g=eq(t.l,null),t.g.ea(t.v)),t.F=Date.now(),E$(t)}XZ(e)}function FZ(e){e.g&&(qZ(e),e.g.cancel(),e.g=null)}function UZ(e){FZ(e),e.u&&(vH.clearTimeout(e.u),e.u=null),jZ(e),e.i.cancel(),e.m&&("number"==typeof e.m&&vH.clearTimeout(e.m),e.m=null)}function VZ(e,t){e.l.push(new(function(){return my(function e(t,n){gy(this,e),this.h=t,this.g=n})}())(e.Za++,t)),3==e.G&&BZ(e)}function BZ(e){iZ(e.i)||e.m||(e.m=!0,NG(e.Ha,e),e.C=0)}function zZ(e,t){var n;n=t?t.m:e.V++;var r=D$(e.F);B$(r,"SID",e.J),B$(r,"RID",n),B$(r,"AID",e.U),HZ(e,r),e.o&&e.s&&RZ(r,e.o,e.s),n=new d$(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=GZ(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),sZ(e.i,n),m$(n,r,t)}function HZ(e,t){e.j&&I$({},function(e,n){B$(t,n,e)})}function GZ(e,t,n){n=Math.min(e.l.length,n);var r=e.j?_H(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{hZ(l,o,"req"+c+"_")}catch(f){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function $Z(e){e.g||e.u||(e.Y=1,NG(e.Ga,e),e.A=0)}function ZZ(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=r$(_H(e.Ga,e),KZ(e,e.A)),e.A++,0))}function qZ(e){null!=e.B&&(vH.clearTimeout(e.B),e.B=null)}function WZ(e){e.g=new d$(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=D$(e.oa);B$(t,"RID","rpc"),B$(t,"SID",e.J),B$(t,"CI",e.N?"0":"1"),B$(t,"AID",e.U),HZ(e,t),B$(t,"TYPE","xmlhttp"),e.o&&e.s&&RZ(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=z$(D$(t)),n.s=null,n.U=!0,k$(n,e)}function jZ(e){null!=e.v&&(vH.clearTimeout(e.v),e.v=null)}function YZ(e,t){var n=null;if(e.g==t){jZ(e),qZ(e),e.g=null;var r=2}else{if(!oZ(e.i,t))return;n=t.D,uZ(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;SG(r=QG(),new n$(r,n,t,i)),BZ(e)}else $Z(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(aZ(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=r$(_H(e.Ha,e,t),KZ(e,e.C)),e.C++,0)))}(e,t)||2==r&&ZZ(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:QZ(e,5);break;case 4:QZ(e,10);break;case 3:QZ(e,6);break;default:QZ(e,2)}}function KZ(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function QZ(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=_H(e.jb,e);n||(n=new N$("//www.google.com/images/cleardot.gif"),vH.location&&"http"==vH.location.protocol||L$(n,"https"),z$(n)),function(e,t){var n=new WG;if(vH.Image){var r=new Image;r.onload=EH(dZ,n,r,"TestLoadImage: loaded",!0,t),r.onerror=EH(dZ,n,r,"TestLoadImage: error",!1,t),r.onabort=EH(dZ,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=EH(dZ,n,r,"TestLoadImage: timeout",!1,t),vH.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else t$(2);e.G=0,e.j&&e.j.va(t),XZ(e),UZ(e)}function XZ(e){e.G=0,e.I=-1,e.j&&((0!=cZ(e.i).length||0!=e.l.length)&&(e.i.i.length=0,AH(e.l),e.l.length=0),e.j.ua())}function JZ(e,t,n){var r=function(e){return e instanceof N$?D$(e):new N$(e,void 0)}(n);if(""!=r.i)t&&F$(r,t+"."+r.i),U$(r,r.m);else{var i=vH.location;r=function(e,t,n,r){var i=new N$(null,void 0);return e&&L$(i,e),t&&F$(i,t),n&&U$(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&UH(e.aa,function(e,t){B$(r,t,e)}),n=e.sa,(t=e.D)&&n&&B$(r,t,n),B$(r,"VER",e.ma),HZ(e,r),r}function eq(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new wZ(n&&e.Ba&&!e.qa?new vZ({ib:!0}):e.qa)).L=e.H,t}function tq(){}function nq(){if(ZH&&!(10<=Number(tG)))throw Error("Environmental error: no available transport.")}function rq(e,t){PG.call(this),this.g=new DZ(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!MH(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!MH(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new oq(this)}function iq(e){l$.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function aq(){f$.call(this),this.status=1}function oq(e){this.g=e}(lH=wZ.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():u$.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:u$),this.g.onreadystatechange=_H(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void SZ(this,a)}e=n||"";var i=new A$(this.headers);r&&I$(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=PZ,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=vH.FormData&&e instanceof vH.FormData,!(0<=OH(bZ,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{AZ(this),0<this.B&&((this.K=function(e){return ZH&&function(){return e=eG,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=RH(String(GH)).split("."),n=RH("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=DH(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||DH(0==a[2].length,0==o[2].length)||DH(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_H(this.pa,this)):this.A=BG(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){SZ(this,a)}},lH.pa=function(){void 0!==dH&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,SG(this,"timeout"),this.abort(8))},lH.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,SG(this,"complete"),SG(this,"abort"),IZ(this))},lH.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),IZ(this,!0)),wZ.Z.M.call(this)},lH.Fa=function(){this.s||(this.F||this.v||this.l?TZ(this):this.cb())},lH.cb=function(){TZ(this)},lH.ba=function(){try{return 2<MZ(this)?this.g.status:-1}catch(e){return-1}},lH.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},lH.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),CZ(t)}},lH.Da=function(){return this.m},lH.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(lH=DZ.prototype).ma=8,lH.G=1,lH.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},lH.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new d$(this,this.h,e,void 0),n=this.s;if(this.P&&(n?zH(n=VH(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=GZ(this,t,r),B$(i=D$(this.F),"RID",e),B$(i,"CVER",22),this.D&&B$(i,"X-HTTP-Session-Id",this.D),HZ(this,i),this.o&&n&&RZ(i,this.o,n),sZ(this.i,t),this.Ra&&B$(i,"TYPE","init"),this.ja?(B$(i,"$req",r),B$(i,"SID","null"),t.$=!0,m$(t,i,null)):m$(t,i,r),this.G=2}}else 3==this.G&&(e?zZ(this,e):0==this.l.length||iZ(this.i)||zZ(this))},lH.Ga=function(){if(this.u=null,WZ(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=r$(_H(this.bb,this),e)}},lH.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,t$(10),FZ(this),WZ(this))},lH.ab=function(){null!=this.v&&(this.v=null,FZ(this),ZZ(this),t$(19))},lH.jb=function(e){e?(this.h.info("Successfully pinged google.com"),t$(2)):(this.h.info("Failed to ping google.com"),t$(1))},(lH=tq.prototype).xa=function(){},lH.wa=function(){},lH.va=function(){},lH.ua=function(){},lH.Oa=function(){},nq.prototype.g=function(e,t){return new rq(e,t)},bH(rq,PG),rq.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),NG(_H(e.hb,e,t))),t$(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=JZ(e,null,e.W),BZ(e)},rq.prototype.close=function(){LZ(this.g)},rq.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,VZ(this.g,t)}else this.v?((t={}).__data__=TG(e),VZ(this.g,t)):VZ(this.g,e)},rq.prototype.M=function(){this.g.j=null,delete this.j,LZ(this.g),delete this.g,rq.Z.M.call(this)},bH(iq,l$),bH(aq,f$),bH(oq,tq),oq.prototype.xa=function(){SG(this.g,"a")},oq.prototype.wa=function(e){SG(this.g,new iq(e))},oq.prototype.va=function(e){SG(this.g,new aq(e))},oq.prototype.ua=function(){SG(this.g,"b")},nq.prototype.createWebChannel=nq.prototype.g,rq.prototype.send=rq.prototype.u,rq.prototype.open=rq.prototype.m,rq.prototype.close=rq.prototype.close,i$.NO_ERROR=0,i$.TIMEOUT=8,i$.HTTP_ERROR=6,a$.COMPLETE="complete",s$.EventType=c$,c$.OPEN="a",c$.CLOSE="b",c$.ERROR="c",c$.MESSAGE="d",PG.prototype.listen=PG.prototype.N,wZ.prototype.listenOnce=wZ.prototype.O,wZ.prototype.getLastError=wZ.prototype.La,wZ.prototype.getLastErrorCode=wZ.prototype.Da,wZ.prototype.getStatus=wZ.prototype.ba,wZ.prototype.getResponseJson=wZ.prototype.Qa,wZ.prototype.getResponseText=wZ.prototype.ga,wZ.prototype.send=wZ.prototype.ea;var sq=hH.createWebChannelTransport=function(){return new nq},uq=hH.getStatEventTarget=function(){return QG()},cq=hH.ErrorCode=i$,lq=hH.EventType=a$,fq=hH.Event=YG,hq=hH.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},dq=hH.FetchXmlHttpFactory=vZ,vq=hH.WebChannel=s$,pq=hH.XhrIo=wZ,gq="@firebase/firestore",yq=function(){function e(t){gy(this,e),this.uid=t}return my(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();yq.UNAUTHENTICATED=new yq(null),yq.GOOGLE_CREDENTIALS=new yq("google-credentials-uid"),yq.FIRST_PARTY=new yq("first-party-uid"),yq.MOCK_USER=new yq("mock-user");var mq="9.9.0",kq=new wz("@firebase/firestore");function Cq(){return kq.logLevel}function wq(e){if(kq.logLevel<=gz.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(bq);kq.debug.apply(kq,["Firestore (".concat(mq,"): ").concat(e)].concat(fy(i)))}}function _q(e){if(kq.logLevel<=gz.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(bq);kq.error.apply(kq,["Firestore (".concat(mq,"): ").concat(e)].concat(fy(i)))}}function Eq(e){if(kq.logLevel<=gz.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(bq);kq.warn.apply(kq,["Firestore (".concat(mq,"): ").concat(e)].concat(fy(i)))}}function bq(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pq(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(mq,") INTERNAL ASSERTION FAILED: ")+e;throw _q(t),new Error(t)}function Sq(e,t){e||Pq()}function Oq(e,t){return e}var Tq={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Iq=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return my(n)}(QB),Aq=my(function e(){var t=this;gy(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),Mq=my(function e(t,n){gy(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),xq=function(){function e(){gy(this,e)}return my(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(yq.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}(),Rq=function(){function e(t){gy(this,e),this.t=t,this.currentUser=yq.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return my(e,[{key:"start",value:function(e,t){var n=this,r=this,i=this.i,a=function(e){return n.i!==i?(i=n.i,t(e)):Promise.resolve()},o=new Aq;this.o=function(){n.i++,n.currentUser=n.u(),o.resolve(),o=new Aq,e.enqueueRetryable(function(){return a(n.currentUser)})};var s=function(){var t=o;e.enqueueRetryable(TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(r.currentUser);case 4:case"end":return e.stop()}},e)})))},u=function(e){wq("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),s()};this.t.onInit(function(e){return u(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(wq("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Aq)}},0),s()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(wq("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Sq("string"==typeof n.accessToken),new Mq(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Sq(null===e||"string"==typeof e),new yq(e)}}]),e}(),Nq=my(function e(t,n,r){gy(this,e),this.type="FirstParty",this.user=yq.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}),Dq=function(){function e(t,n,r){gy(this,e),this.h=t,this.l=n,this.m=r}return my(e,[{key:"getToken",value:function(){return Promise.resolve(new Nq(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(yq.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),Lq=my(function e(t){gy(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),Fq=function(){function e(t){gy(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}return my(e,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable(function(){return function(e){null!=e.error&&wq("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.p;return n.p=e.token,wq("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)})};var r=function(e){wq("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit(function(e){return r(e)}),setTimeout(function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):wq("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(function(t){return t?(Sq("string"==typeof t.token),e.p=t.token,new Lq(t.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function Uq(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var Vq=function(){function e(){gy(this,e)}return my(e,null,[{key:"I",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=Uq(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function Bq(e,t){return e<t?-1:e>t?1:0}function zq(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}var Hq=function(){function e(t,n){if(gy(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new Iq(Tq.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Iq(Tq.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new Iq(Tq.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Iq(Tq.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return my(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?Bq(this.nanoseconds,e.nanoseconds):Bq(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),Gq=function(){function e(t){gy(this,e),this.timestamp=t}return my(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new Hq(0,0))}},{key:"max",value:function(){return new e(new Hq(253402300799,999999999))}}]),e}(),$q=function(){function e(t,n,r){gy(this,e),void 0===n?n=0:n>t.length&&Pq(),void 0===r?r=t.length-n:r>t.length-n&&Pq(),this.segments=t,this.offset=n,this.len=r}return my(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),Zq=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new Iq(Tq.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,fy(s.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}($q),qq=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Wq=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return qq.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new Iq(Tq.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new Iq(Tq.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Iq(Tq.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new Iq(Tq.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}($q),jq=function(){function e(t){gy(this,e),this.path=t}return my(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===Zq.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(Zq.fromString(t))}},{key:"fromName",value:function(t){return new e(Zq.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(Zq.emptyPath())}},{key:"comparator",value:function(e,t){return Zq.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new Zq(t.slice()))}}]),e}();function Yq(e){return new Kq(e.readTime,e.key,-1)}var Kq=function(){function e(t,n,r){gy(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return my(e,null,[{key:"min",value:function(){return new e(Gq.min(),jq.empty(),-1)}},{key:"max",value:function(){return new e(Gq.max(),jq.empty(),-1)}}]),e}();function Qq(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=jq.comparator(e.documentKey,t.documentKey))?n:Bq(e.largestBatchId,t.largestBatchId)}var Xq="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function Jq(e){return eW.apply(this,arguments)}function eW(){return eW=TB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===Tq.FAILED_PRECONDITION&&t.message===Xq){e.next=2;break}throw t;case 2:wq("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)})),eW.apply(this,arguments)}var tW=function(){function e(t){var n=this;gy(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return my(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&Pq(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(n){return e.reject(n)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=dy(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e(function(e,r){for(var i=t.length,a=new Array(i),o=0,s=function(s){var u=s;n(t[u]).next(function(t){a[u]=t,++o===i&&e(a)},function(e){return r(e)})},u=0;u<i;u++)s(u)})}},{key:"doWhile",value:function(t,n){return new e(function(e,r){!function i(){!0===t()?n().next(function(){i()},r):e()}()})}}]),e}();function nW(e){return"IndexedDbTransactionError"===e.name}var rW=function(){function e(t,n){var r=this;gy(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.it(e)},this.rt=function(e){return n.writeSequenceNumber(e)})}return my(e,[{key:"it",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.rt&&this.rt(e),e}}]),e}();function iW(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function aW(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function oW(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}rW.ot=-1;var sW=function(){function e(t,n){gy(this,e),this.comparator=t,this.root=n||cW.EMPTY}return my(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,cW.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,cW.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new uW(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new uW(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new uW(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new uW(this.root,e,this.comparator,!0)}}]),e}(),uW=function(){function e(t,n,r,i){gy(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return my(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),cW=function(){function e(t,n,r,i,a){gy(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return my(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Pq();var e=this.left.check();if(e!==this.right.check())throw Pq();return e+(this.isRed()?0:1)}}]),e}();cW.EMPTY=null,cW.RED=!0,cW.BLACK=!1,cW.EMPTY=new(function(){function e(){gy(this,e),this.size=0}return my(e,[{key:"key",get:function(){throw Pq()}},{key:"value",get:function(){throw Pq()}},{key:"color",get:function(){throw Pq()}},{key:"left",get:function(){throw Pq()}},{key:"right",get:function(){throw Pq()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new cW(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var lW=function(){function e(t){gy(this,e),this.comparator=t,this.data=new sW(this.comparator)}return my(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new fW(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new fW(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),fW=function(){function e(t){gy(this,e),this.iter=t}return my(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}(),hW=function(){function e(t){gy(this,e),this.fields=t,t.sort(Wq.comparator)}return my(e,[{key:"unionWith",value:function(t){var n,r=new lW(Wq.comparator),i=dy(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,s=dy(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=dy(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return zq(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}],[{key:"empty",value:function(){return new e([])}}]),e}(),dW=function(e){function t(e){gy(this,t),this.binaryString=e}return my(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return btoa(this.binaryString)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return Bq(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();dW.EMPTY_BYTE_STRING=new dW("");var vW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pW(e){if(Sq(!!e),"string"==typeof e){var t=0,n=vW.exec(e);if(Sq(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:gW(e.seconds),nanos:gW(e.nanos)}}function gW(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function yW(e){return"string"==typeof e?dW.fromBase64String(e):dW.fromUint8Array(e)}function mW(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function kW(e){var t=e.mapValue.fields.__previous_value__;return mW(t)?kW(t):t}function CW(e){var t=pW(e.mapValue.fields.__local_write_time__.timestampValue);return new Hq(t.seconds,t.nanos)}var wW=my(function e(t,n,r,i,a,o,s,u){gy(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u}),_W=function(){function e(t,n){gy(this,e),this.projectId=t,this.database=n||"(default)"}return my(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function EW(e){return null==e}function bW(e){return 0===e&&1/e==-1/0}var PW={fields:{__type__:{stringValue:"__max__"}}};function SW(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?mW(e)?4:BW(e)?9007199254740991:10:Pq()}function OW(e,t){if(e===t)return!0;var n,r=SW(e);if(r!==SW(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return CW(e).isEqual(CW(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=pW(e.timestampValue),r=pW(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,yW(e.bytesValue).isEqual(yW(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return gW(e.geoPointValue.latitude)===gW(t.geoPointValue.latitude)&&gW(e.geoPointValue.longitude)===gW(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return gW(e.integerValue)===gW(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=gW(e.doubleValue),r=gW(t.doubleValue);return n===r?bW(n)===bW(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return zq(e.arrayValue.values||[],t.arrayValue.values||[],OW);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(iW(n)!==iW(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!OW(n[i],r[i])))return!1;return!0}(e,t);default:return Pq()}}function TW(e,t){return void 0!==(e.values||[]).find(function(e){return OW(e,t)})}function IW(e,t){if(e===t)return 0;var n,r,i,a,o=SW(e),s=SW(t);if(o!==s)return Bq(o,s);switch(o){case 0:case 9007199254740991:return 0;case 1:return Bq(e.booleanValue,t.booleanValue);case 2:return r=t,i=gW((n=e).integerValue||n.doubleValue),a=gW(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return AW(e.timestampValue,t.timestampValue);case 4:return AW(CW(e),CW(t));case 5:return Bq(e.stringValue,t.stringValue);case 6:return function(e,t){var n=yW(e),r=yW(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=Bq(n[i],r[i]);if(0!==a)return a}return Bq(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=Bq(gW(e.latitude),gW(t.latitude));return 0!==n?n:Bq(gW(e.longitude),gW(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=IW(n[i],r[i]);if(a)return a}return Bq(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===PW&&t===PW)return 0;if(e===PW)return 1;if(t===PW)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=Bq(r[o],a[o]);if(0!==s)return s;var u=IW(n[r[o]],i[a[o]]);if(0!==u)return u}return Bq(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Pq()}}function AW(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Bq(e,t);var n=pW(e),r=pW(t),i=Bq(n.seconds,r.seconds);return 0!==i?i:Bq(n.nanos,r.nanos)}function MW(e){return xW(e)}function xW(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(t=e.timestampValue,n=pW(t),"time(".concat(n.seconds,",").concat(n.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?yW(e.bytesValue).toBase64():"referenceValue"in e?jq.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo(".concat((r=e.geoPointValue).latitude,",").concat(r.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=dy(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=xW(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=dy(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(xW(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):Pq();var t,n,r}function RW(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function NW(e){return!!e&&"integerValue"in e}function DW(e){return!!e&&"arrayValue"in e}function LW(e){return!!e&&"nullValue"in e}function FW(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function UW(e){return!!e&&"mapValue"in e}function VW(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return aW(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=VW(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=VW(e.arrayValue.values[r]);return n}return Object.assign({},e)}function BW(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}var zW=function(){function e(t){gy(this,e),this.value=t}return my(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!UW(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=VW(t)}},{key:"setAll",value:function(e){var t=this,n=Wq.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=VW(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());UW(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return OW(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];UW(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){aW(t,function(t,n){return e[t]=n});var r,i=dy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(VW(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function HW(e){var t=[];return aW(e.fields,function(e,n){var r=new Wq([e]);if(UW(n)){var i=HW(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=dy(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)}),new hW(t)}var GW=function(){function e(t,n,r,i,a,o){gy(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.data=a,this.documentState=o}return my(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=zW.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=zW.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=Gq.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,Gq.min(),Gq.min(),zW.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,Gq.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,Gq.min(),zW.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,Gq.min(),zW.empty(),2)}}]),e}(),$W=my(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;gy(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.ut=null});function ZW(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new $W(e,t,n,r,i,a,o)}function qW(e){var t=Oq(e);if(null===t.ut){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return(t=e).field.canonicalString()+t.op.toString()+MW(t.value);var t}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return(t=e).field.canonicalString()+t.dir;var t}).join(","),EW(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(function(e){return MW(e)}).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(function(e){return MW(e)}).join(",")),t.ut=n}return t.ut}function WW(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!oj(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(a=t.filters[r]).op||!i.field.isEqual(a.field)||!OW(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!uj(e.startAt,t.startAt)&&uj(e.endAt,t.endAt)}function jW(e){return jq.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var YW=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return my(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(IW(t,this.value)):null!==t&&SW(this.value)===SW(t)&&this.at(IW(t,this.value))}},{key:"at",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Pq()}}},{key:"ht",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new KW(e,t,r):"array-contains"===t?new ej(e,r):"in"===t?new tj(e,r):"not-in"===t?new nj(e,r):"array-contains-any"===t?new rj(e,r):new n(e,t,r)}},{key:"ct",value:function(e,t,n){return"in"===t?new QW(e,n):new XW(e,n)}}]),n}(function(){return my(function e(){gy(this,e)})}()),KW=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r,i)).key=jq.fromName(i.referenceValue),a}return my(n,[{key:"matches",value:function(e){var t=jq.comparator(e.key,this.key);return this.at(t)}}]),n}(YW),QW=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e,"in",r)).keys=JW(0,r),i}return my(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(YW),XW=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e,"not-in",r)).keys=JW(0,r),i}return my(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(YW);function JW(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return jq.fromName(e.referenceValue)})}var ej=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this,e,"array-contains",r)}return my(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return DW(t)&&TW(t.arrayValue,this.value)}}]),n}(YW),tj=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this,e,"in",r)}return my(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&TW(this.value.arrayValue,t)}}]),n}(YW),nj=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this,e,"not-in",r)}return my(n,[{key:"matches",value:function(e){if(TW(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!TW(this.value.arrayValue,t)}}]),n}(YW),rj=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this,e,"array-contains-any",r)}return my(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!DW(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return TW(t.value.arrayValue,e)})}}]),n}(YW),ij=my(function e(t,n){gy(this,e),this.position=t,this.inclusive=n}),aj=my(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";gy(this,e),this.field=t,this.dir=n});function oj(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function sj(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?jq.comparator(jq.fromName(o.referenceValue),n.key):IW(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function uj(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!OW(e.position[n],t.position[n]))return!1;return!0}var cj=my(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;gy(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.lt=null,this.ft=null});function lj(e){return new cj(e)}function fj(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function hj(e){var t,n=dy(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.ht())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function dj(e){return null!==e.collectionGroup}function vj(e){var t=Oq(e);if(null===t.lt){t.lt=[];var n=hj(t),r=fj(t);if(null!==n&&null===r)n.isKeyField()||t.lt.push(new aj(n)),t.lt.push(new aj(Wq.keyField(),"asc"));else{var i,a=!1,o=dy(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.lt.push(s),s.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new aj(Wq.keyField(),u))}}}return t.lt}function pj(e){var t=Oq(e);if(!t.ft)if("F"===t.limitType)t.ft=ZW(t.path,t.collectionGroup,vj(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=dy(vj(t));try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(new aj(a.field,"desc"===a.dir?"asc":"desc"))}}catch(u){i.e(u)}finally{i.f()}var o=t.endAt?new ij(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new ij(t.startAt.position,t.startAt.inclusive):null;t.ft=ZW(t.path,t.collectionGroup,r,t.filters,t.limit,o,s)}return t.ft}function gj(e,t,n){return new cj(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function yj(e,t){return WW(pj(e),pj(t))&&e.limitType===t.limitType}function mj(e){return"".concat(qW(pj(e)),"|lt:").concat(e.limitType)}function kj(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(MW(t.value));var t}).join(", "),"]")),EW(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t}).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(function(e){return MW(e)}).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(function(e){return MW(e)}).join(",")),"Target(".concat(t,")")}(pj(e)),"; limitType=").concat(e.limitType,")")}function Cj(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):jq.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=dy(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=dy(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&(s=t,!((o=e).startAt&&(n=o.startAt,r=vj(o),i=s,a=sj(n,r,i),!(n.inclusive?a<=0:a<0))||o.endAt&&!function(e,t,n){var r=sj(e,t,n);return e.inclusive?r>=0:r>0}(o.endAt,vj(o),s)));var n,r,i,a,o,s}function wj(e){return function(t,n){var r,i=!1,a=dy(vj(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=_j(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(u){a.e(u)}finally{a.f()}return 0}}function _j(e,t,n){var r,i,a,o,s=e.field.isKeyField()?jq.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),o=i.data.field(r),null!==a&&null!==o?IW(a,o):Pq());switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return Pq()}}function Ej(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bW(t)?"-0":t}}function bj(e){return{integerValue:""+e}}var Pj=my(function e(){gy(this,e),this._=void 0});function Sj(e,t,n){return e instanceof Ij?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof Aj?Mj(e,t):e instanceof xj?Rj(e,t):function(e,t){var n=Tj(e,t),r=Dj(n)+Dj(e._t);return NW(n)&&NW(e._t)?bj(r):Ej(e.wt,r)}(e,t);var r,i,a}function Oj(e,t,n){return e instanceof Aj?Mj(e,t):e instanceof xj?Rj(e,t):n}function Tj(e,t){return e instanceof Nj?NW(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}var Ij=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n)}(Pj),Aj=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).elements=e,r}return my(n)}(Pj);function Mj(e,t){var n,r=Lj(t),i=dy(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return OW(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var xj=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).elements=e,r}return my(n)}(Pj);function Rj(e,t){var n,r=Lj(t),i=dy(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!OW(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Nj=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).wt=e,i._t=r,i}return my(n)}(Pj);function Dj(e){return gW(e.integerValue||e.doubleValue)}function Lj(e){return DW(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var Fj=my(function e(t,n){gy(this,e),this.field=t,this.transform=n}),Uj=my(function e(t,n){gy(this,e),this.version=t,this.transformResults=n}),Vj=function(){function e(t,n){gy(this,e),this.updateTime=t,this.exists=n}return my(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Bj(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var zj=my(function e(){gy(this,e)});function Hj(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new eY(e.key,Vj.none()):new Wj(e.key,e.data,Vj.none());var n,r=e.data,i=zW.empty(),a=new lW(Wq.comparator),o=dy(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!a.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?i.delete(s):i.set(s,u),a=a.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new jj(e.key,i,new hW(a.toArray()),Vj.none())}function Gj(e,t,n){var r,i,a,o,s;e instanceof Wj?(i=t,a=n,o=(r=e).value.clone(),s=Kj(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):e instanceof jj?function(e,t,n){if(Bj(e.precondition,t)){var r=Kj(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Yj(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function $j(e,t,n,r){return e instanceof Wj?function(e,t,n,r){if(!Bj(e.precondition,t))return n;var i=e.value.clone(),a=Qj(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof jj?function(e,t,n,r){if(!Bj(e.precondition,t))return n;var i=Qj(e.fieldTransforms,r,t),a=t.data;return a.setAll(Yj(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(function(e){return e.field}))}(e,t,n,r):(a=n,Bj(e.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function Zj(e,t){var n,r=null,i=dy(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=Tj(a.transform,o||null);null!=s&&(null===r&&(r=zW.empty()),r.set(a.field,s))}}catch(u){i.e(u)}finally{i.f()}return r||null}function qj(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&zq(n,r,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof Aj&&r instanceof Aj||n instanceof xj&&r instanceof xj?zq(n.elements,r.elements,OW):n instanceof Nj&&r instanceof Nj?OW(n._t,r._t):n instanceof Ij&&r instanceof Ij);var n,r}(e,t)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}var Wj=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return gy(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return my(n,[{key:"getFieldMask",value:function(){return null}}]),n}(zj),jj=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return gy(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return my(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(zj);function Yj(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function Kj(e,t,n){var r=new Map;Sq(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,Oj(o,s,n[i]))}return r}function Qj(e,t,n){var r,i=new Map,a=dy(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);i.set(o.field,Sj(s,u,t))}}catch(c){a.e(c)}finally{a.f()}return i}var Xj,Jj,eY=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return my(n,[{key:"getFieldMask",value:function(){return null}}]),n}(zj),tY=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return my(n,[{key:"getFieldMask",value:function(){return null}}]),n}(zj),nY=my(function e(t){gy(this,e),this.count=t});function rY(e){switch(e){default:return Pq();case Tq.CANCELLED:case Tq.UNKNOWN:case Tq.DEADLINE_EXCEEDED:case Tq.RESOURCE_EXHAUSTED:case Tq.INTERNAL:case Tq.UNAVAILABLE:case Tq.UNAUTHENTICATED:return!1;case Tq.INVALID_ARGUMENT:case Tq.NOT_FOUND:case Tq.ALREADY_EXISTS:case Tq.PERMISSION_DENIED:case Tq.FAILED_PRECONDITION:case Tq.ABORTED:case Tq.OUT_OF_RANGE:case Tq.UNIMPLEMENTED:case Tq.DATA_LOSS:return!0}}function iY(e){if(void 0===e)return _q("GRPC error has no .code"),Tq.UNKNOWN;switch(e){case Xj.OK:return Tq.OK;case Xj.CANCELLED:return Tq.CANCELLED;case Xj.UNKNOWN:return Tq.UNKNOWN;case Xj.DEADLINE_EXCEEDED:return Tq.DEADLINE_EXCEEDED;case Xj.RESOURCE_EXHAUSTED:return Tq.RESOURCE_EXHAUSTED;case Xj.INTERNAL:return Tq.INTERNAL;case Xj.UNAVAILABLE:return Tq.UNAVAILABLE;case Xj.UNAUTHENTICATED:return Tq.UNAUTHENTICATED;case Xj.INVALID_ARGUMENT:return Tq.INVALID_ARGUMENT;case Xj.NOT_FOUND:return Tq.NOT_FOUND;case Xj.ALREADY_EXISTS:return Tq.ALREADY_EXISTS;case Xj.PERMISSION_DENIED:return Tq.PERMISSION_DENIED;case Xj.FAILED_PRECONDITION:return Tq.FAILED_PRECONDITION;case Xj.ABORTED:return Tq.ABORTED;case Xj.OUT_OF_RANGE:return Tq.OUT_OF_RANGE;case Xj.UNIMPLEMENTED:return Tq.UNIMPLEMENTED;case Xj.DATA_LOSS:return Tq.DATA_LOSS;default:return Pq()}}(Jj=Xj||(Xj={}))[Jj.OK=0]="OK",Jj[Jj.CANCELLED=1]="CANCELLED",Jj[Jj.UNKNOWN=2]="UNKNOWN",Jj[Jj.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Jj[Jj.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Jj[Jj.NOT_FOUND=5]="NOT_FOUND",Jj[Jj.ALREADY_EXISTS=6]="ALREADY_EXISTS",Jj[Jj.PERMISSION_DENIED=7]="PERMISSION_DENIED",Jj[Jj.UNAUTHENTICATED=16]="UNAUTHENTICATED",Jj[Jj.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Jj[Jj.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Jj[Jj.ABORTED=10]="ABORTED",Jj[Jj.OUT_OF_RANGE=11]="OUT_OF_RANGE",Jj[Jj.UNIMPLEMENTED=12]="UNIMPLEMENTED",Jj[Jj.INTERNAL=13]="INTERNAL",Jj[Jj.UNAVAILABLE=14]="UNAVAILABLE",Jj[Jj.DATA_LOSS=15]="DATA_LOSS";var aY=function(){function e(t,n){gy(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return my(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=dy(n);try{for(i.s();!(r=i.n()).done;){var a=Qg(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(u){i.e(u)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){aW(this.inner,function(t,n){var r,i=dy(n);try{for(i.s();!(r=i.n()).done;){var a=Qg(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(u){i.e(u)}finally{i.f()}})}},{key:"isEmpty",value:function(){return oW(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),oY=new sW(jq.comparator);function sY(){return oY}var uY=new sW(jq.comparator);function cY(){for(var e=uY,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function lY(e){var t=uY;return e.forEach(function(e,n){return t=t.insert(e,n.overlayedDocument)}),t}function fY(){return dY()}function hY(){return dY()}function dY(){return new aY(function(e){return e.toString()},function(e,t){return e.isEqual(t)})}var vY=new sW(jq.comparator),pY=new lW(jq.comparator);function gY(){for(var e=pY,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var yY=new lW(Bq);function mY(){return yY}var kY=function(){function e(t,n,r,i,a){gy(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return my(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,CY.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(Gq.min(),r,mY(),sY(),gY())}}]),e}(),CY=function(){function e(t,n,r,i,a){gy(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return my(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(dW.EMPTY_BYTE_STRING,n,gY(),gY(),gY())}}]),e}(),wY=my(function e(t,n,r,i){gy(this,e),this.gt=t,this.removedTargetIds=n,this.key=r,this.yt=i}),_Y=my(function e(t,n){gy(this,e),this.targetId=t,this.It=n}),EY=my(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:dW.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;gy(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),bY=function(){function e(){gy(this,e),this.Tt=0,this.Et=OY(),this.At=dW.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}return my(e,[{key:"current",get:function(){return this.Rt}},{key:"resumeToken",get:function(){return this.At}},{key:"Pt",get:function(){return 0!==this.Tt}},{key:"vt",get:function(){return this.bt}},{key:"Vt",value:function(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}},{key:"St",value:function(){var e=gY(),t=gY(),n=gY();return this.Et.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Pq()}}),new CY(this.At,this.Rt,e,t,n)}},{key:"Dt",value:function(){this.bt=!1,this.Et=OY()}},{key:"Ct",value:function(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}},{key:"xt",value:function(e){this.bt=!0,this.Et=this.Et.remove(e)}},{key:"Nt",value:function(){this.Tt+=1}},{key:"kt",value:function(){this.Tt-=1}},{key:"Ot",value:function(){this.bt=!0,this.Rt=!0}}]),e}(),PY=function(){function e(t){gy(this,e),this.Mt=t,this.Ft=new Map,this.$t=sY(),this.Bt=SY(),this.Lt=new lW(Bq)}return my(e,[{key:"Ut",value:function(e){var t,n=dy(e.gt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.yt&&e.yt.isFoundDocument()?this.qt(r,e.yt):this.Kt(r,e.key,e.yt)}}catch(s){n.e(s)}finally{n.f()}var i,a=dy(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Kt(o,e.key,e.yt)}}catch(s){a.e(s)}finally{a.f()}}},{key:"Gt",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.Qt(n);switch(e.state){case 0:t.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||t.removeTarget(n);break;case 3:t.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:t.jt(n)&&(t.Wt(n),r.Vt(e.resumeToken));break;default:Pq()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach(function(e,r){n.jt(r)&&t(r)})}},{key:"zt",value:function(e){var t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){var i=r.target;if(jW(i))if(0===n){var a=new jq(i.path);this.Kt(t,a,GW.newNoDocument(a,Gq.min()))}else Sq(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}},{key:"Yt",value:function(e){var t=this,n=new Map;this.Ft.forEach(function(r,i){var a=t.Ht(i);if(a){if(r.current&&jW(a.target)){var o=new jq(a.target.path);null!==t.$t.get(o)||t.Xt(i,o)||t.Kt(i,o,GW.newNoDocument(o,e))}r.vt&&(n.set(i,r.St()),r.Dt())}});var r=gY();this.Bt.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.Ht(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))}),this.$t.forEach(function(t,n){return n.setReadTime(e)});var i=new kY(e,n,this.Lt,this.$t,r);return this.$t=sY(),this.Bt=SY(),this.Lt=new lW(Bq),i}},{key:"qt",value:function(e,t){if(this.jt(e)){var n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}}},{key:"Kt",value:function(e,t,n){if(this.jt(e)){var r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Ft.delete(e)}},{key:"Jt",value:function(e){var t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Nt",value:function(e){this.Qt(e).Nt()}},{key:"Qt",value:function(e){var t=this.Ft.get(e);return t||(t=new bY,this.Ft.set(e,t)),t}},{key:"Zt",value:function(e){var t=this.Bt.get(e);return t||(t=new lW(Bq),this.Bt=this.Bt.insert(e,t)),t}},{key:"jt",value:function(e){var t=null!==this.Ht(e);return t||wq("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Ht",value:function(e){var t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}},{key:"Wt",value:function(e){var t=this;this.Ft.set(e,new bY),this.Mt.getRemoteKeysForTarget(e).forEach(function(n){t.Kt(e,n,null)})}},{key:"Xt",value:function(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}]),e}();function SY(){return new sW(jq.comparator)}function OY(){return new sW(jq.comparator)}var TY={asc:"ASCENDING",desc:"DESCENDING"},IY={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},AY=my(function e(t,n){gy(this,e),this.databaseId=t,this.dt=n});function MY(e,t){return e.dt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function xY(e,t){return e.dt?t.toBase64():t.toUint8Array()}function RY(e,t){return MY(e,t.toTimestamp())}function NY(e){return Sq(!!e),Gq.fromTimestamp((t=pW(e),new Hq(t.seconds,t.nanos)));var t}function DY(e,t){return(n=e,new Zq(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function LY(e){var t=Zq.fromString(e);return Sq(eK(t)),t}function FY(e,t){return DY(e.databaseId,t.path)}function UY(e,t){var n=LY(t);if(n.get(1)!==e.databaseId.projectId)throw new Iq(Tq.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Iq(Tq.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new jq(zY(n))}function VY(e,t){return DY(e.databaseId,t)}function BY(e){return new Zq(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function zY(e){return Sq(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function HY(e,t,n){return{name:FY(e,t),fields:n.value.mapValue.fields}}function GY(e,t){return{documents:[VY(e,t.path)]}}function $Y(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=VY(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=VY(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(FW(e.value))return{unaryFilter:{field:YY(e.field),op:"IS_NAN"}};if(LW(e.value))return{unaryFilter:{field:YY(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(FW(e.value))return{unaryFilter:{field:YY(e.field),op:"IS_NOT_NAN"}};if(LW(e.value))return{unaryFilter:{field:YY(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:YY(e.field),op:jY(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return{field:YY((t=e).field),direction:WY(t.dir)};var t})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s,u,c=(o=t.limit,e.dt||EW(o)?o:{value:o});return null!==c&&(n.structuredQuery.limit=c),t.startAt&&(n.structuredQuery.startAt={before:(s=t.startAt).inclusive,values:s.position}),t.endAt&&(n.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),n}function ZY(e){var t=function(e){var t=LY(e);return 4===t.length?Zq.emptyPath():zY(t)}(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Sq(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=qY(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(e){return new aj(KY((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));var u=null;n.limit&&(u=function(e){var t;return EW(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c,l=null;n.startAt&&(l=new ij((c=n.startAt).values||[],!!c.before));var f=null;return n.endAt&&(f=function(e){return new ij(e.values||[],!e.before)}(n.endAt)),function(e,t,n,r,i,a,o,s){return new cj(e,t,n,r,i,"F",o,s)}(t,i,s,o,u,0,l,f)}function qY(e){return e?void 0!==e.unaryFilter?[XY(e)]:void 0!==e.fieldFilter?[QY(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return qY(e)}).reduce(function(e,t){return e.concat(t)}):Pq():[]}function WY(e){return TY[e]}function jY(e){return IY[e]}function YY(e){return{fieldPath:e.canonicalString()}}function KY(e){return Wq.fromServerFormat(e.fieldPath)}function QY(e){return YW.create(KY(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Pq()}}(e.fieldFilter.op),e.fieldFilter.value)}function XY(e){switch(e.unaryFilter.op){case"IS_NAN":var t=KY(e.unaryFilter.field);return YW.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=KY(e.unaryFilter.field);return YW.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=KY(e.unaryFilter.field);return YW.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=KY(e.unaryFilter.field);return YW.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Pq()}}function JY(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function eK(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var tK=function(){function e(t,n,r,i){gy(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return my(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&Gj(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=dy(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=$j(i,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var a,o=dy(this.mutations);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.key.isEqual(e.key)&&(t=$j(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=hY();return this.mutations.forEach(function(i){var a=e.get(i.key),o=a.overlayedDocument,s=n.applyToLocalView(o,a.mutatedFields),u=Hj(o,s=t.has(i.key)?null:s);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Gq.min())}),r}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},gY())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&zq(this.mutations,e.mutations,function(e,t){return qj(e,t)})&&zq(this.baseMutations,e.baseMutations,function(e,t){return qj(e,t)})}}]),e}(),nK=function(){function e(t,n,r,i){gy(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return my(e,null,[{key:"from",value:function(t,n,r){Sq(t.mutations.length===r.length);for(var i=vY,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),rK=function(){function e(t,n){gy(this,e),this.largestBatchId=t,this.mutation=n}return my(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),iK=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Gq.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Gq.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:dW.EMPTY_BYTE_STRING;gy(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return my(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),aK=my(function e(t){gy(this,e),this.ne=t});function oK(e){var t=ZY({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?gj(t,t.limit,"L"):t}var sK=function(){function e(){gy(this,e)}return my(e,[{key:"re",value:function(e,t){this.oe(e,t),t.ue()}},{key:"oe",value:function(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(gW(e.integerValue));else if("doubleValue"in e){var n=gW(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),bW(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he("".concat(r.seconds||"")),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(yW(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ce(t,45),t.ae(i.latitude||0),t.ae(i.longitude||0)}else"mapValue"in e?BW(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):Pq()}},{key:"le",value:function(e,t){this.ce(t,25),this.ge(e,t)}},{key:"ge",value:function(e,t){t.he(e)}},{key:"we",value:function(e,t){var n=e.fields||{};this.ce(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.le(a,t),this.oe(n[a],t)}}},{key:"me",value:function(e,t){var n=e.values||[];this.ce(t,50);var r,i=dy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.oe(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"_e",value:function(e,t){var n=this;this.ce(t,37),jq.fromName(e).path.forEach(function(e){n.ce(t,60),n.ge(e,t)})}},{key:"ce",value:function(e,t){e.ae(t)}},{key:"fe",value:function(e){e.ae(2)}}]),e}();sK.ye=new sK;var uK=function(){function e(){gy(this,e),this.ze=new cK}return my(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.ze.add(t),tW.resolve()}},{key:"getCollectionParents",value:function(e,t){return tW.resolve(this.ze.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return tW.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return tW.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return tW.resolve(null)}},{key:"getIndexType",value:function(e,t){return tW.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return tW.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return tW.resolve(null)}},{key:"getMinOffset",value:function(e,t){return tW.resolve(Kq.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return tW.resolve(Kq.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return tW.resolve()}},{key:"updateIndexEntries",value:function(e,t){return tW.resolve()}}]),e}(),cK=function(){function e(){gy(this,e),this.index={}}return my(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new lW(Zq.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new lW(Zq.comparator)).toArray()}}]),e}();new Uint8Array(0);var lK=function(){function e(t,n,r){gy(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return my(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();lK.DEFAULT_COLLECTION_PERCENTILE=10,lK.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,lK.DEFAULT=new lK(41943040,lK.DEFAULT_COLLECTION_PERCENTILE,lK.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),lK.DISABLED=new lK(-1,0,0);var fK=function(){function e(t){gy(this,e),this.En=t}return my(e,[{key:"next",value:function(){return this.En+=2,this.En}}],[{key:"An",value:function(){return new e(0)}},{key:"Rn",value:function(){return new e(-1)}}]),e}(),hK=my(function e(t,n){gy(this,e),this.overlayedDocument=t,this.mutatedFields=n}),dK=function(){function e(t,n,r,i){gy(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return my(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next(function(i){return r=i,n.getBaseDocument(e,t,r)}).next(function(e){return null!==r&&$j(r.mutation,e,hW.empty(),Hq.now()),e})}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.getLocalViewOfDocuments(e,t,gY()).next(function(){return t})})}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gY(),i=fY();return this.populateOverlays(e,i,t).next(function(){return n.computeViews(e,t,i,r).next(function(e){var t=cY();return e.forEach(function(e,n){t=t.insert(e,n.overlayedDocument)}),t})})}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=fY();return this.populateOverlays(e,r,t).next(function(){return n.computeViews(e,t,r,gY())})}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach(function(e){t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(function(e){e.forEach(function(e,n){t.set(e,n)})})}},{key:"computeViews",value:function(e,t,n,r){var i=sY(),a=dY(),o=dY();return t.forEach(function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof jj)?i=i.insert(t.key,t):void 0!==o&&(a.set(t.key,o.mutation.getFieldMask()),$j(o.mutation,t,o.mutation.getFieldMask(),Hq.now()))}),this.recalculateAndSaveOverlays(e,i).next(function(e){return e.forEach(function(e,t){return a.set(e,t)}),t.forEach(function(e,t){var n;return o.set(e,new hK(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),o})}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=dY(),i=new sW(function(e,t){return e-t}),a=gY();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){var n,a=dy(e);try{var o=function(){var e=n.value;e.keys().forEach(function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||hW.empty();o=e.applyToLocalView(a,o),r.set(n,o);var s=(i.get(e.batchId)||gY()).add(n);i=i.insert(e.batchId,s)}})};for(a.s();!(n=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}).next(function(){for(var o=[],s=i.getReverseIterator(),u=function(){var i=s.getNext(),u=i.key,c=i.value,l=hY();c.forEach(function(e){if(!a.has(e)){var n=Hj(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}}),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return tW.waitFor(o)}).next(function(){return r})}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.recalculateAndSaveOverlays(e,t)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return jq.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):dj(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):tW.resolve(fY()),s=-1,u=a;return o.next(function(t){return tW.forEach(t,function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?tW.resolve():i.getBaseDocument(e,t,n).next(function(e){u=u.insert(t,e)})}).next(function(){return i.populateOverlays(e,t,a)}).next(function(){return i.computeViews(e,u,t,gY())}).next(function(e){return{batchId:s,changes:lY(e)}})})})}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new jq(t)).next(function(e){var t=cY();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=cY();return this.indexManager.getCollectionParents(e,i).next(function(o){return tW.forEach(o,function(o){var s,u,c=(s=t,u=o.child(i),new cj(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.getDocumentsMatchingCollectionQuery(e,c,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)}).next(function(e){e.forEach(function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,GW.newInvalidDocument(n)))});var n=cY();return r.forEach(function(r,i){var a=e.get(r);void 0!==a&&$j(a.mutation,i,hW.empty(),Hq.now()),Cj(t,i)&&(n=n.insert(r,i))}),n})}},{key:"getBaseDocument",value:function(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):tW.resolve(GW.newInvalidDocument(t))}}]),e}(),vK=function(){function e(t){gy(this,e),this.wt=t,this.Jn=new Map,this.Yn=new Map}return my(e,[{key:"getBundleMetadata",value:function(e,t){return tW.resolve(this.Jn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:NY(n.createTime)}),tW.resolve()}},{key:"getNamedQuery",value:function(e,t){return tW.resolve(this.Yn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Yn.set(t.name,{name:(n=t).name,query:oK(n.bundledQuery),readTime:NY(n.readTime)}),tW.resolve();var n}}]),e}(),pK=function(){function e(){gy(this,e),this.overlays=new sW(jq.comparator),this.Xn=new Map}return my(e,[{key:"getOverlay",value:function(e,t){return tW.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=fY();return tW.forEach(t,function(t){return n.getOverlay(e,t).next(function(e){null!==e&&r.set(t,e)})}).next(function(){return r})}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach(function(n,i){r.ie(e,t,i)}),tW.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.Xn.get(n);return void 0!==i&&(i.forEach(function(e){return r.overlays=r.overlays.remove(e)}),this.Xn.delete(n)),tW.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=fY(),i=t.length+1,a=new jq(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&s.largestBatchId>n&&r.set(s.getKey(),s)}return tW.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new sW(function(e,t){return e-t}),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=i.get(o.largestBatchId);null===s&&(s=fY(),i=i.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=fY(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach(function(e,t){return u.set(e,t)}),!(u.size()>=r)););return tW.resolve(u)}},{key:"ie",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new rK(t,n));var a=this.Xn.get(t);void 0===a&&(a=gY(),this.Xn.set(t,a)),this.Xn.set(t,a.add(n.key))}}]),e}(),gK=function(){function e(){gy(this,e),this.Zn=new lW(yK.ts),this.es=new lW(yK.ns)}return my(e,[{key:"isEmpty",value:function(){return this.Zn.isEmpty()}},{key:"addReference",value:function(e,t){var n=new yK(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}},{key:"ss",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.rs(new yK(e,t))}},{key:"os",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"us",value:function(e){var t=this,n=new jq(new Zq([])),r=new yK(n,e),i=new yK(n,e+1),a=[];return this.es.forEachInRange([r,i],function(e){t.rs(e),a.push(e.key)}),a}},{key:"cs",value:function(){var e=this;this.Zn.forEach(function(t){return e.rs(t)})}},{key:"rs",value:function(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}},{key:"hs",value:function(e){var t=new jq(new Zq([])),n=new yK(t,e),r=new yK(t,e+1),i=gY();return this.es.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new yK(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),yK=function(){function e(t,n){gy(this,e),this.key=t,this.ls=n}return my(e,null,[{key:"ts",value:function(e,t){return jq.comparator(e.key,t.key)||Bq(e.ls,t.ls)}},{key:"ns",value:function(e,t){return Bq(e.ls,t.ls)||jq.comparator(e.key,t.key)}}]),e}(),mK=function(){function e(t,n){gy(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new lW(yK.ts)}return my(e,[{key:"checkEmpty",value:function(e){return tW.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.fs;this.fs++;var a=new tK(i,t,n,r);this.mutationQueue.push(a);var o,s=dy(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.ds=this.ds.add(new yK(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return tW.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return tW.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this.ws(t+1),r=n<0?0:n;return tW.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return tW.resolve(0===this.mutationQueue.length?-1:this.fs-1)}},{key:"getAllMutationBatches",value:function(e){return tW.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new yK(t,0),i=new yK(t,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],function(e){var t=n._s(e.ls);a.push(t)}),tW.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new lW(Bq);return t.forEach(function(e){var t=new yK(e,0),i=new yK(e,Number.POSITIVE_INFINITY);n.ds.forEachInRange([t,i],function(e){r=r.add(e.ls)})}),tW.resolve(this.gs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;jq.isDocumentKey(i)||(i=i.child(""));var a=new yK(new jq(i),0),o=new lW(Bq);return this.ds.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)},a),tW.resolve(this.gs(o))}},{key:"gs",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t._s(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Sq(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();var r=this.ds;return tW.forEach(t.mutations,function(i){var a=new yK(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ds=r})}},{key:"In",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new yK(t,0),r=this.ds.firstAfterOrEqual(n);return tW.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return tW.resolve()}},{key:"ys",value:function(e,t){return this.ws(e)}},{key:"ws",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"_s",value:function(e){var t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),kK=function(){function e(t){gy(this,e),this.ps=t,this.docs=new sW(jq.comparator),this.size=0}return my(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return tW.resolve(n?n.document.mutableCopy():GW.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=sY();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():GW.newInvalidDocument(e))}),tW.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=sY(),i=new jq(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value.document;if(!t.isPrefixOf(s.path))break;s.path.length>t.length+1||Qq(Yq(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return tW.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){Pq()}},{key:"Is",value:function(e,t){return tW.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new CK(this)}},{key:"getSize",value:function(e){return tW.resolve(this.size)}}]),e}(),CK=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).zn=e,r}return my(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.isValidDocument()?n.push(t.zn.addEntry(e,i)):t.zn.removeEntry(r)}),tW.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.zn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.zn.getEntries(e,t)}}]),n}(function(){function e(){gy(this,e),this.changes=new aY(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return my(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,GW.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?tW.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}()),wK=function(){function e(t){gy(this,e),this.persistence=t,this.Ts=new aY(function(e){return qW(e)},WW),this.lastRemoteSnapshotVersion=Gq.min(),this.highestTargetId=0,this.Es=0,this.As=new gK,this.targetCount=0,this.Rs=fK.An()}return my(e,[{key:"forEachTarget",value:function(e,t){return this.Ts.forEach(function(e,n){return t(n)}),tW.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return tW.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return tW.resolve(this.Es)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Rs.next(),tW.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),tW.resolve()}},{key:"vn",value:function(e){this.Ts.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Rs=new fK(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.vn(t),this.targetCount+=1,tW.resolve()}},{key:"updateTargetData",value:function(e,t){return this.vn(t),tW.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,tW.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Ts.forEach(function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Ts.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),tW.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return tW.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Ts.get(t)||null;return tW.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.As.ss(t,n),tW.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.As.os(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),tW.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.As.us(t),tW.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.As.hs(t);return tW.resolve(n)}},{key:"containsKey",value:function(e,t){return tW.resolve(this.As.containsKey(t))}}]),e}(),_K=function(){function e(t,n){var r=this;gy(this,e),this.bs={},this.overlays={},this.Ps=new rW(0),this.vs=!1,this.vs=!0,this.referenceDelegate=t(this),this.Vs=new wK(this),this.indexManager=new uK,this.remoteDocumentCache=new kK(function(e){return r.referenceDelegate.Ss(e)}),this.wt=new aK(n),this.Ds=new vK(this.wt)}return my(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.vs=!1,Promise.resolve()}},{key:"started",get:function(){return this.vs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new pK,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.bs[e.toKey()];return n||(n=new mK(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Vs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ds}},{key:"runTransaction",value:function(e,t,n){var r=this;wq("MemoryPersistence","Starting transaction:",e);var i=new EK(this.Ps.next());return this.referenceDelegate.Cs(),n(i).next(function(e){return r.referenceDelegate.xs(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Ns",value:function(e,t){return tW.or(Object.values(this.bs).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),EK=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return my(n)}(function(){function e(){gy(this,e),this.onCommittedListeners=[]}return my(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}()),bK=function(){function e(t){gy(this,e),this.persistence=t,this.ks=new gK,this.Os=null}return my(e,[{key:"Fs",get:function(){if(this.Os)return this.Os;throw Pq()}},{key:"addReference",value:function(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),tW.resolve()}},{key:"removeReference",value:function(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),tW.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Fs.add(t.toString()),tW.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.ks.us(t.targetId).forEach(function(e){return n.Fs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.Fs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Cs",value:function(){this.Os=new Set}},{key:"xs",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return tW.forEach(this.Fs,function(r){var i=jq.fromPath(r);return t.$s(e,i).next(function(e){e||n.removeEntry(i,Gq.min())})}).next(function(){return t.Os=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next(function(e){e?n.Fs.delete(t.toString()):n.Fs.add(t.toString())})}},{key:"Ss",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return tW.or([function(){return tW.resolve(n.ks.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ns(e,t)}])}}],[{key:"Ms",value:function(t){return new e(t)}}]),e}(),PK=function(){function e(t,n,r,i){gy(this,e),this.targetId=t,this.fromCache=n,this.Pi=r,this.vi=i}return my(e,null,[{key:"Vi",value:function(t,n){var r,i=gY(),a=gY(),o=dy(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),SK=function(){function e(){gy(this,e),this.Si=!1}return my(e,[{key:"initialize",value:function(e,t){this.Di=e,this.indexManager=t,this.Si=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.Ci(e,t).next(function(a){return a||i.xi(e,t,r,n)}).next(function(n){return n||i.Ni(e,t)})}},{key:"Ci",value:function(e,t){return tW.resolve(null)}},{key:"xi",value:function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(Gq.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next(function(a){var o=i.ki(t,a);return i.Oi(t,o,n,r)?i.Ni(e,t):(Cq()<=gz.DEBUG&&wq("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),kj(t)),i.Mi(e,o,t,function(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Gq.fromTimestamp(1e9===r?new Hq(n+1,0):new Hq(n,r));return new Kq(i,jq.empty(),-1)}(r)))})}},{key:"ki",value:function(e,t){var n=new lW(wj(e));return t.forEach(function(t,r){Cj(e,r)&&(n=n.add(r))}),n}},{key:"Oi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Ni",value:function(e,t){return Cq()<=gz.DEBUG&&wq("QueryEngine","Using full collection scan to execute query:",kj(t)),this.Di.getDocumentsMatchingQuery(e,t,Kq.min())}},{key:"Mi",value:function(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next(function(e){return t.forEach(function(t){e=e.insert(t.key,t)}),e})}}]),e}(),OK=function(){function e(t,n,r,i){gy(this,e),this.persistence=t,this.Fi=n,this.wt=i,this.$i=new sW(Bq),this.Bi=new aY(function(e){return qW(e)},WW),this.Li=new Map,this.Ui=t.getRemoteDocumentCache(),this.Vs=t.getTargetCache(),this.Ds=t.getBundleCache(),this.qi(r)}return my(e,[{key:"qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dK(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.$i)})}}]),e}();function TK(e,t){return IK.apply(this,arguments)}function IK(){return IK=TB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Oq(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next(function(i){return t=i,r.qi(n),r.mutationQueue.getAllMutationBatches(e)}).next(function(n){var i,a=[],o=[],s=gY(),u=dy(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;a.push(c.batchId);var l,f=dy(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;s=s.add(h.key)}}catch(k){f.e(k)}finally{f.f()}}}catch(k){u.e(k)}finally{u.f()}var d,v=dy(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(p.batchId);var g,y=dy(p.mutations);try{for(y.s();!(g=y.n()).done;){var m=g.value;s=s.add(m.key)}}catch(k){y.e(k)}finally{y.f()}}}catch(k){v.e(k)}finally{v.f()}return r.localDocuments.getDocuments(e,s).next(function(e){return{Ki:e,removedBatchIds:a,addedBatchIds:o}})})});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)})),IK.apply(this,arguments)}function AK(e,t){var n=Oq(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r,i,a,o,s,u,c,l=t.batch.keys(),f=n.Ui.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,o=f,s=a.batch,u=s.keys(),c=tW.resolve(),u.forEach(function(e){c=c.next(function(){return o.getEntry(i,e)}).next(function(t){var n=a.docVersions.get(e);Sq(null!==n),t.version.compareTo(n)<0&&(s.applyToRemoteDocument(t,a),t.isValidDocument()&&(t.setReadTime(a.commitVersion),o.addEntry(t)))})}),c.next(function(){return r.mutationQueue.removeMutationBatch(i,s)})).next(function(){return f.apply(e)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,l,t.batch.batchId)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=gY(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))}).next(function(){return n.localDocuments.getDocuments(e,l)})})}function MK(e){var t=Oq(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.Vs.getLastRemoteSnapshotVersion(e)})}function xK(e,t){var n=Oq(e),r=t.snapshotVersion,i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;var o=[];t.targetChanges.forEach(function(a,s){var u=i.get(s);if(u){o.push(n.Vs.removeMatchingKeys(e,a.removedDocuments,s).next(function(){return n.Vs.addMatchingKeys(e,a.addedDocuments,s)}));var c,l,f,h=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?h=h.withResumeToken(dW.EMPTY_BYTE_STRING,Gq.min()).withLastLimboFreeSnapshotVersion(Gq.min()):a.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(a.resumeToken,r)),i=i.insert(s,h),l=h,f=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||f.addedDocuments.size+f.modifiedDocuments.size+f.removedDocuments.size>0)&&o.push(n.Vs.updateTargetData(e,h))}});var s=sY(),u=gY();if(t.documentUpdates.forEach(function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){var r=gY(),i=gY();return n.forEach(function(e){return r=r.add(e)}),t.getEntries(e,r).next(function(e){var r=sY();return n.forEach(function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(Gq.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):wq("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)}),{Gi:r,Qi:i}})}(e,a,t.documentUpdates).next(function(e){s=e.Gi,u=e.Qi})),!r.isEqual(Gq.min())){var c=n.Vs.getLastRemoteSnapshotVersion(e).next(function(t){return n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r)});o.push(c)}return tW.waitFor(o).next(function(){return a.apply(e)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)}).next(function(){return s})}).then(function(e){return n.$i=i,e})}function RK(e,t){var n=Oq(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)})}function NK(e,t){var n=Oq(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.Vs.getTargetData(e,t).next(function(i){return i?(r=i,tW.resolve(r)):n.Vs.allocateTargetId(e).next(function(i){return r=new iK(t,i,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e})}function DK(e,t,n){return LK.apply(this,arguments)}function LK(){return LK=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Oq(t),a=i.$i.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),nW(e.t1)){e.next=12;break}throw e.t1;case 12:wq("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.$i=i.$i.remove(n),i.Bi.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])})),LK.apply(this,arguments)}function FK(e,t,n){var r=Oq(e),i=Gq.min(),a=gY();return r.persistence.runTransaction("Execute query","readonly",function(e){return(o=r,s=e,u=pj(t),c=Oq(o),l=c.Bi.get(u),void 0!==l?tW.resolve(c.$i.get(l)):c.Vs.getTargetData(s,u)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Fi.getDocumentsMatchingQuery(e,t,n?i:Gq.min(),n?a:gY())}).next(function(e){return function(e,t,n){var r=Gq.min();n.forEach(function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Li.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ji:a}});var o,s,u,c,l})}var UK=function(){function e(){gy(this,e),this.activeTargetIds=mY()}return my(e,[{key:"Xi",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Zi",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Yi",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),VK=function(){function e(){gy(this,e),this.Fr=new UK,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return my(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.$r[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Fr.Zi(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.$r[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Fr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Fr=new UK,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),BK=function(){function e(){gy(this,e)}return my(e,[{key:"Br",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),zK=function(){function e(){var t=this;gy(this,e),this.Lr=function(){return t.Ur()},this.qr=function(){return t.Kr()},this.Gr=[],this.Qr()}return my(e,[{key:"Br",value:function(e){this.Gr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}},{key:"Qr",value:function(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}},{key:"Ur",value:function(){wq("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=dy(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Kr",value:function(){wq("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=dy(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"V",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),HK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},GK=function(){function e(t){gy(this,e),this.jr=t.jr,this.Wr=t.Wr}return my(e,[{key:"zr",value:function(e){this.Hr=e}},{key:"Jr",value:function(e){this.Yr=e}},{key:"onMessage",value:function(e){this.Xr=e}},{key:"close",value:function(){this.Wr()}},{key:"send",value:function(e){this.jr(e)}},{key:"Zr",value:function(){this.Hr()}},{key:"eo",value:function(e){this.Yr(e)}},{key:"no",value:function(e){this.Xr(e)}}]),e}(),$K=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return my(n,[{key:"co",value:function(e,t,n,r){return new Promise(function(i,a){var o=new pq;o.listenOnce(lq.COMPLETE,function(){try{switch(o.getLastErrorCode()){case cq.NO_ERROR:var t=o.getResponseJson();wq("Connection","XHR received:",JSON.stringify(t)),i(t);break;case cq.TIMEOUT:wq("Connection",'RPC "'+e+'" timed out'),a(new Iq(Tq.DEADLINE_EXCEEDED,"Request time out"));break;case cq.HTTP_ERROR:var n=o.getStatus();if(wq("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(Tq).indexOf(c)>=0?c:Tq.UNKNOWN);a(new Iq(s,r.message))}else a(new Iq(Tq.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new Iq(Tq.UNAVAILABLE,"Connection failed."));break;default:Pq()}}finally{wq("Connection",'RPC "'+e+'" completed.')}var u,c});var s=JSON.stringify(r);o.send(t,"POST",s,n,15)})}},{key:"ho",value:function(e,t,n){var r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=sq(),a=uq(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new dq({})),this.uo(o.initMessageHeaders,t,n),$B()||qB()||GB().indexOf("Electron/")>=0||WB()||GB().indexOf("MSAppHost/")>=0||ZB()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");wq("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,f=new GK({jr:function(e){l?wq("Connection","Not sending because WebChannel is closed:",e):(c||(wq("Connection","Opening WebChannel transport."),u.open(),c=!0),wq("Connection","WebChannel sending:",e),u.send(e))},Wr:function(){return u.close()}}),h=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(t){setTimeout(function(){throw t},0)}})};return h(u,vq.EventType.OPEN,function(){l||wq("Connection","WebChannel transport opened.")}),h(u,vq.EventType.CLOSE,function(){l||(l=!0,wq("Connection","WebChannel transport closed"),f.eo())}),h(u,vq.EventType.ERROR,function(e){l||(l=!0,Eq("Connection","WebChannel transport errored:",e),f.eo(new Iq(Tq.UNAVAILABLE,"The operation could not be completed")))}),h(u,vq.EventType.MESSAGE,function(e){var t;if(!l){var n=e.data[0];Sq(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){wq("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=Xj[e];if(void 0!==t)return iY(t)}(a),s=i.message;void 0===o&&(o=Tq.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,f.eo(new Iq(o,s)),u.close()}else wq("Connection","WebChannel received:",n),f.no(n)}}),h(a,fq.STAT_EVENT,function(e){e.stat===hq.PROXY?wq("Connection","Detected buffering proxy"):e.stat===hq.NOPROXY&&wq("Connection","Detected no buffering proxy")}),setTimeout(function(){f.Zr()},0),f}}]),n}(function(){function e(t){gy(this,e),this.databaseInfo=t,this.databaseId=t.databaseId,this.so=(t.ssl?"https":"http")+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return my(e,[{key:"ro",value:function(e,t,n,r,i){var a=this.oo(e,t);wq("RestConnection","Sending: ",a,n);var o={};return this.uo(o,r,i),this.co(e,a,o,n).then(function(e){return wq("RestConnection","Received: ",e),e},function(t){throw Eq("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t})}},{key:"ao",value:function(e,t,n,r,i,a){return this.ro(e,t,n,r,i)}},{key:"uo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+mq,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(function(t,n){return e[n]=t}),n&&n.headers.forEach(function(t,n){return e[n]=t})}},{key:"oo",value:function(e,t){return"".concat(this.so,"/v1/").concat(t,":").concat(HK[e])}}]),e}());function ZK(){return"undefined"!=typeof document?document:null}function qK(e){return new AY(e,!0)}var WK=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;gy(this,e),this.js=t,this.timerId=n,this.lo=r,this.fo=i,this._o=a,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}return my(e,[{key:"reset",value:function(){this.wo=0}},{key:"po",value:function(){this.wo=this._o}},{key:"Io",value:function(e){var t=this;this.cancel();var n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,n-r);i>0&&wq("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.wo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.mo=this.js.enqueueAfterDelay(this.timerId,i,function(){return t.yo=Date.now(),e()}),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}},{key:"Eo",value:function(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}},{key:"cancel",value:function(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}},{key:"To",value:function(){return(Math.random()-.5)*this.wo}}]),e}(),jK=function(){function e(t,n,r,i,a,o,s,u){gy(this,e),this.js=t,this.Ao=r,this.Ro=i,this.bo=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new WK(t,n)}return my(e,[{key:"Do",value:function(){return 1===this.state||5===this.state||this.Co()}},{key:"Co",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.xo()}},{key:"stop",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.Do(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}},t)}))()}},{key:"No",value:function(){this.state=0,this.So.reset()}},{key:"ko",value:function(){var e=this;this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,function(){return e.Oo()}))}},{key:"Mo",value:function(e){this.Fo(),this.stream.send(e)}},{key:"Oo",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.Co()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}},t)}))()}},{key:"Fo",value:function(){this.vo&&(this.vo.cancel(),this.vo=null)}},{key:"$o",value:function(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}},{key:"close",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.Fo(),n.$o(),n.So.cancel(),n.Po++,4!==e?n.So.reset():t&&t.code===Tq.RESOURCE_EXHAUSTED?(_q(t.toString()),_q("Using maximum backoff delay to prevent overloading the backend."),n.So.po()):t&&t.code===Tq.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Bo(),n.stream.close(),n.stream=null),n.state=e,r.next=9,n.listener.Jr(t);case 9:case"end":return r.stop()}},r)}))()}},{key:"Bo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=Qg(t,2),i=r[0],a=r[1];e.Po===n&&e.Uo(i,a)},function(n){t(function(){var t=new Iq(Tq.UNKNOWN,"Fetching auth token failed: "+n.message);return e.qo(t)})})}},{key:"Uo",value:function(e,t){var n=this,r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(function(){r(function(){return n.state=2,n.Vo=n.js.enqueueAfterDelay(n.Ro,1e4,function(){return n.Co()&&(n.state=3),Promise.resolve()}),n.listener.zr()})}),this.stream.Jr(function(e){r(function(){return n.qo(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"xo",value:function(){var e=this;this.state=5,this.So.Io(TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"qo",value:function(e){return wq("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Lo",value:function(e){var t=this;return function(n){t.js.enqueueAndForget(function(){return t.Po===e?n():(wq("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),YK=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s){var u;return gy(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u}return my(n,[{key:"Ko",value:function(e,t){return this.bo.ho("Listen",e,t)}},{key:"onMessage",value:function(e){this.So.reset();var t=function(e,t){var n,r;if("targetChange"in t){var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:Pq(),a=t.targetChange.targetIds||[],o=function(e,t){return e.dt?(Sq(void 0===t||"string"==typeof t),dW.fromBase64String(t||"")):(Sq(void 0===t||t instanceof Uint8Array),dW.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?Tq.UNKNOWN:iY(e.code);return new Iq(t,e.message||"")}(s);n=new EY(i,a,o,u||null)}else if("documentChange"in t){var c=t.documentChange,l=UY(e,c.document.name),f=NY(c.document.updateTime),h=new zW({mapValue:{fields:c.document.fields}}),d=GW.newFoundDocument(l,f,h);n=new wY(c.targetIds||[],c.removedTargetIds||[],d.key,d)}else if("documentDelete"in t){var v=t.documentDelete,p=UY(e,v.document),g=v.readTime?NY(v.readTime):Gq.min(),y=GW.newNoDocument(p,g);n=new wY([],v.removedTargetIds||[],y.key,y)}else if("documentRemove"in t){var m=t.documentRemove,k=UY(e,m.document);n=new wY([],m.removedTargetIds||[],k,null)}else{if(!("filter"in t))return Pq();var C=t.filter,w=new nY(C.count||0);n=new _Y(C.targetId,w)}return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return Gq.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?Gq.min():t.readTime?NY(t.readTime):Gq.min()}(e);return this.listener.Go(t,n)}},{key:"Qo",value:function(e){var t,n,r,i,a={};a.database=BY(this.wt),a.addTarget=(t=this.wt,i=(n=e).target,(r=jW(i)?{documents:GY(t,i)}:{query:$Y(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=xY(t,n.resumeToken):n.snapshotVersion.compareTo(Gq.min())>0&&(r.readTime=MY(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pq()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);o&&(a.labels=o),this.Mo(a)}},{key:"jo",value:function(e){var t={};t.database=BY(this.wt),t.removeTarget=e,this.Mo(t)}}]),n}(jK),KK=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s){var u;return gy(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u.Wo=!1,u}return my(n,[{key:"zo",get:function(){return this.Wo}},{key:"start",value:function(){this.Wo=!1,this.lastStreamToken=void 0,ny(ly(n.prototype),"start",this).call(this)}},{key:"Bo",value:function(){this.Wo&&this.Ho([])}},{key:"Ko",value:function(e,t){return this.bo.ho("Write",e,t)}},{key:"onMessage",value:function(e){if(Sq(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();var t=function(e,t){return e&&e.length>0?(Sq(void 0!==t),e.map(function(e){return function(e,t){var n=NY(e.updateTime?e.updateTime:t);return n.isEqual(Gq.min())&&(n=NY(t)),new Uj(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=NY(e.commitTime);return this.listener.Jo(n,t)}return Sq(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}},{key:"Xo",value:function(){var e={};e.database=BY(this.wt),this.Mo(e)}},{key:"Ho",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return function(e,t){var n,r;if(t instanceof Wj)n={update:HY(e,t.key,t.value)};else if(t instanceof eY)n={delete:FY(e,t.key)};else if(t instanceof jj)n={update:HY(e,t.key,t.data),updateMask:JY(t.fieldMask)};else{if(!(t instanceof tY))return Pq();n={verify:FY(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof Ij)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Aj)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof xj)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Nj)return{fieldPath:t.field.canonicalString(),increment:n._t};throw Pq()}(0,e)})),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:RY(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:Pq()),n}(t.wt,e)})};this.Mo(n)}}]),n}(jK),QK=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.bo=i,o.wt=a,o.Zo=!1,o}return my(n,[{key:"tu",value:function(){if(this.Zo)throw new Iq(Tq.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ro",value:function(e,t,n){var r=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=Qg(i,2),o=a[0],s=a[1];return r.bo.ro(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===Tq.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new Iq(Tq.UNKNOWN,e.toString())})}},{key:"ao",value:function(e,t,n,r){var i=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(a){var o=Qg(a,2),s=o[0],u=o[1];return i.bo.ao(e,t,n,s,u,r)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===Tq.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new Iq(Tq.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.Zo=!0}}]),n}(function(){return my(function e(){gy(this,e)})}()),XK=function(){function e(t,n){gy(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}return my(e,[{key:"iu",value:function(){var e=this;0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.nu=null,e.ou("Backend didn't respond within 10 seconds."),e.ru("Offline"),Promise.resolve()}))}},{key:"uu",value:function(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ru("Offline")))}},{key:"set",value:function(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}},{key:"ru",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"ou",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.su?(_q(t),this.su=!1):wq("OnlineStateTracker",t)}},{key:"cu",value:function(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}]),e}(),JK=my(function e(t,n,r,i,a){gy(this,e);var o=this;this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=a,this.du.Br(function(e){r.enqueueAndForget(TB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=lQ(o),!e.t0){e.next=5;break}return wq("RemoteStore","Restarting streams for network reachability change."),e.next=5,(t=TB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Oq(t)).lu.add(4),e.next=4,nQ(n);case 4:return n._u.set("Unknown"),n.lu.delete(4),e.next=8,eQ(n);case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})(o);case 5:case"end":return e.stop()}},e)})))}),this._u=new XK(r,i)});function eQ(e){return tQ.apply(this,arguments)}function tQ(){return tQ=TB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!lQ(t)){e.next=18;break}n=dy(t.fu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])})),tQ.apply(this,arguments)}function nQ(e){return rQ.apply(this,arguments)}function rQ(){return rQ=TB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=dy(t.fu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})),rQ.apply(this,arguments)}function iQ(e,t){var n=Oq(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),cQ(n)?uQ(n):UQ(n).Co()&&oQ(n,t))}function aQ(e,t){var n=Oq(e),r=UQ(n);n.hu.delete(t),r.Co()&&sQ(n,t),0===n.hu.size&&(r.Co()?r.ko():lQ(n)&&n._u.set("Unknown"))}function oQ(e,t){e.wu.Nt(t.targetId),UQ(e).Qo(t)}function sQ(e,t){e.wu.Nt(t),UQ(e).jo(t)}function uQ(e){e.wu=new PY({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},te:function(t){return e.hu.get(t)||null}}),UQ(e).start(),e._u.iu()}function cQ(e){return lQ(e)&&!UQ(e).Do()&&e.hu.size>0}function lQ(e){return 0===Oq(e).lu.size}function fQ(e){e.wu=void 0}function hQ(e){return dQ.apply(this,arguments)}function dQ(){return dQ=TB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.hu.forEach(function(e,n){oQ(t,e)});case 1:case"end":return e.stop()}},e)})),dQ.apply(this,arguments)}function vQ(e,t){return pQ.apply(this,arguments)}function pQ(){return pQ=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fQ(t),cQ(t)?(t._u.uu(n),uQ(t)):t._u.set("Unknown");case 1:case"end":return e.stop()}},e)})),pQ.apply(this,arguments)}function gQ(e,t,n){return yQ.apply(this,arguments)}function yQ(){return yQ=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._u.set("Online"),!(n instanceof EY&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,(a=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=dy(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.hu.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.hu.delete(o),t.wu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])})),function(e,t){return a.apply(this,arguments)})(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),wq("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,mQ(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof wY?t.wu.Ut(n):n instanceof _Y?t.wu.zt(n):t.wu.Gt(n),r.isEqual(Gq.min())){e.next=29;break}return e.prev=14,e.next=17,MK(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.wu.Yt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.hu.get(t);if(n){e.hu.set(t,n.withResumeToken(dW.EMPTY_BYTE_STRING,n.snapshotVersion)),sQ(e,t);var r=new iK(n.target,t,1,n.sequenceNumber);oQ(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),wq("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,mQ(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])})),yQ.apply(this,arguments)}function mQ(e,t,n){return kQ.apply(this,arguments)}function kQ(){return kQ=TB(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(nW(n)){e.next=2;break}throw n;case 2:return t.lu.add(1),e.next=5,nQ(t);case 5:t._u.set("Offline"),r||(r=function(){return MK(t.localStore)}),t.asyncQueue.enqueueRetryable(TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return wq("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.lu.delete(1),e.next=6,eQ(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)})),kQ.apply(this,arguments)}function CQ(e,t){return t().catch(function(n){return mQ(e,n,t)})}function wQ(e){return _Q.apply(this,arguments)}function _Q(){return _Q=TB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Oq(t),r=VQ(n),i=n.au.length>0?n.au[n.au.length-1].batchId:-1;case 2:if(!EQ(n)){e.next=19;break}return e.prev=3,e.next=6,RK(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.au.length&&r.ko(),e.abrupt("break",19);case 10:i=a.batchId,bQ(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,mQ(n,e.t0);case 17:e.next=2;break;case 19:PQ(n)&&SQ(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])})),_Q.apply(this,arguments)}function EQ(e){return lQ(e)&&e.au.length<10}function bQ(e,t){e.au.push(t);var n=VQ(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function PQ(e){return lQ(e)&&!VQ(e).Do()&&e.au.length>0}function SQ(e){VQ(e).start()}function OQ(e){return TQ.apply(this,arguments)}function TQ(){return TQ=TB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:VQ(t).Xo();case 1:case"end":return e.stop()}},e)})),TQ.apply(this,arguments)}function IQ(e){return AQ.apply(this,arguments)}function AQ(){return AQ=TB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=VQ(t),r=dy(t.au);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Ho(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}},e)})),AQ.apply(this,arguments)}function MQ(e,t,n){return xQ.apply(this,arguments)}function xQ(){return xQ=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.au.shift(),a=nK.from(i,n,r),e.next=3,CQ(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,wQ(t);case 5:case"end":return e.stop()}},e)})),xQ.apply(this,arguments)}function RQ(e,t){return NQ.apply(this,arguments)}function NQ(){return NQ=TB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&VQ(t).zo,!e.t0){e.next=4;break}return e.next=4,(r=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!rY(i=n.code)||i===Tq.ABORTED){e.next=7;break}return r=t.au.shift(),VQ(t).No(),e.next=5,CQ(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,wQ(t);case 7:case"end":return e.stop()}},e)})),function(e,t){return r.apply(this,arguments)})(t,n);case 4:PQ(t)&&SQ(t);case 5:case"end":return e.stop()}},e)})),NQ.apply(this,arguments)}function DQ(e,t){return LQ.apply(this,arguments)}function LQ(){return LQ=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Oq(t)).asyncQueue.verifyOperationInProgress(),wq("RemoteStore","RemoteStore received new credentials"),i=lQ(r),r.lu.add(3),e.next=6,nQ(r);case 6:return i&&r._u.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.lu.delete(3),e.next=12,eQ(r);case 12:case"end":return e.stop()}},e)})),LQ.apply(this,arguments)}function FQ(){return FQ=TB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Oq(t),!n){e.next=7;break}return r.lu.delete(2),e.next=5,eQ(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.lu.add(2),e.next=12,nQ(r);case 12:r._u.set("Unknown");case 13:case"end":return e.stop()}},e)})),FQ.apply(this,arguments)}function UQ(e){return e.mu||(e.mu=(t=e.datastore,n=e.asyncQueue,r={zr:hQ.bind(null,e),Jr:vQ.bind(null,e),Go:gQ.bind(null,e)},(i=Oq(t)).tu(),new YK(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=TB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.mu.No(),cQ(e)?uQ(e):e._u.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.mu.stop();case 6:fQ(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.mu;var t,n,r,i}function VQ(e){return e.gu||(e.gu=(t=e.datastore,n=e.asyncQueue,r={zr:OQ.bind(null,e),Jr:RQ.bind(null,e),Yo:IQ.bind(null,e),Jo:MQ.bind(null,e)},(i=Oq(t)).tu(),new KK(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=TB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.gu.No(),t.next=4,wQ(e);case 4:t.next=9;break;case 6:return t.next=8,e.gu.stop();case 8:e.au.length>0&&(wq("RemoteStore","Stopping write stream with ".concat(e.au.length," pending writes")),e.au=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.gu;var t,n,r,i}var BQ=function(){function e(t,n,r,i,a){gy(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Aq,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return my(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Iq(Tq.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function zQ(e,t){if(_q("AsyncQueue","".concat(t,": ").concat(e)),nW(e))return new Iq(Tq.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var HQ=function(){function e(t){gy(this,e),this.comparator=t?function(e,n){return t(e,n)||jq.comparator(e.key,n.key)}:function(e,t){return jq.comparator(e.key,t.key)},this.keyedMap=cY(),this.sortedSet=new sW(this.comparator)}return my(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),GQ=function(){function e(){gy(this,e),this.yu=new sW(jq.comparator)}return my(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):Pq():this.yu=this.yu.insert(t,e)}},{key:"pu",value:function(){var e=[];return this.yu.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),$Q=function(){function e(t,n,r,i,a,o,s,u){gy(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return my(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yj(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach(function(e){a.push({type:0,doc:e})}),new e(t,n,HQ.emptySet(n),a,r,i,!0,!1)}}]),e}(),ZQ=my(function e(){gy(this,e),this.Iu=void 0,this.listeners=[]}),qQ=my(function e(){gy(this,e),this.queries=new aY(function(e){return mj(e)},yj),this.onlineState="Unknown",this.Tu=new Set});function WQ(e,t){return jQ.apply(this,arguments)}function jQ(){return jQ=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Oq(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new ZQ),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.Iu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=zQ(e.t0,"Initialization of query '".concat(kj(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(i,o),o.listeners.push(n),n.Eu(r.onlineState),o.Iu&&n.Au(o.Iu)&&JQ(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])})),jQ.apply(this,arguments)}function YQ(e,t){return KQ.apply(this,arguments)}function KQ(){return KQ=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Oq(t),i=n.query,a=!1,(o=r.queries.get(i))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)})),KQ.apply(this,arguments)}function QQ(e,t){var n,r=Oq(e),i=!1,a=dy(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.queries.get(o.query);if(s){var u,c=dy(s.listeners);try{for(c.s();!(u=c.n()).done;){u.value.Au(o)&&(i=!0)}}catch(l){c.e(l)}finally{c.f()}s.Iu=o}}}catch(l){a.e(l)}finally{a.f()}i&&JQ(r)}function XQ(e,t,n){var r=Oq(e),i=r.queries.get(t);if(i){var a,o=dy(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function JQ(e){e.Tu.forEach(function(e){e.next()})}var eX=function(){function e(t,n,r){gy(this,e),this.query=t,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}return my(e,[{key:"Au",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=dy(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new $Q(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),a=!0):this.Vu(e,this.onlineState)&&(this.Su(e),a=!0),this.Pu=e,a}},{key:"onError",value:function(e){this.Ru.error(e)}},{key:"Eu",value:function(e){this.onlineState=e;var t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}},{key:"Vu",value:function(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}},{key:"vu",value:function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}},{key:"Su",value:function(e){e=$Q.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}]),e}(),tX=my(function e(t){gy(this,e),this.key=t}),nX=my(function e(t){gy(this,e),this.key=t}),rX=function(){function e(t,n){gy(this,e),this.query=t,this.Fu=n,this.$u=null,this.current=!1,this.Bu=gY(),this.mutatedKeys=gY(),this.Lu=wj(t),this.Uu=new HQ(this.Lu)}return my(e,[{key:"qu",get:function(){return this.Fu}},{key:"Ku",value:function(e,t){var n=this,r=t?t.Gu:new GQ,i=t?t.Uu:this.Uu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),f=Cj(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),v=!0):n.Qu(l,f)||(r.track({type:2,doc:f}),v=!0,(u&&n.Lu(f,u)>0||c&&n.Lu(f,c)<0)&&(s=!0)):!l&&f?(r.track({type:0,doc:f}),v=!0):l&&!f&&(r.track({type:1,doc:l}),v=!0,(u||c)&&(s=!0)),v&&(f?(o=o.add(f),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Uu:o,Gu:r,Oi:s,mutatedKeys:a}}},{key:"Qu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;var a=e.Gu.pu();a.sort(function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pq()}})(n)-a(i)||r.Lu(e.doc,t.doc);var n,i,a}),this.ju(n);var o=t?this.Wu():[],s=0===this.Bu.size&&this.current?1:0,u=s!==this.$u;return this.$u=s,0!==a.length||u?{snapshot:new $Q(this.query,e.Uu,i,a,e.mutatedKeys,0===s,u,!1),zu:o}:{zu:o}}},{key:"Eu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new GQ,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}},{key:"Hu",value:function(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}},{key:"ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.Fu=t.Fu.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.Fu=t.Fu.delete(e)}),this.current=e.current)}},{key:"Wu",value:function(){var e=this;if(!this.current)return[];var t=this.Bu;this.Bu=gY(),this.Uu.forEach(function(t){e.Hu(t.key)&&(e.Bu=e.Bu.add(t.key))});var n=[];return t.forEach(function(t){e.Bu.has(t)||n.push(new nX(t))}),this.Bu.forEach(function(e){t.has(e)||n.push(new tX(e))}),n}},{key:"Ju",value:function(e){this.Fu=e.ji,this.Bu=gY();var t=this.Ku(e.documents);return this.applyChanges(t,!0)}},{key:"Yu",value:function(){return $Q.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}]),e}(),iX=my(function e(t,n,r){gy(this,e),this.query=t,this.targetId=n,this.view=r}),aX=my(function e(t){gy(this,e),this.key=t,this.Xu=!1}),oX=function(){function e(t,n,r,i,a,o){gy(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new aY(function(e){return mj(e)},yj),this.ec=new Map,this.nc=new Set,this.sc=new sW(jq.comparator),this.ic=new Map,this.rc=new gK,this.oc={},this.uc=new Map,this.cc=fK.Rn(),this.onlineState="Unknown",this.ac=void 0}return my(e,[{key:"isPrimaryClient",get:function(){return!0===this.ac}}]),e}();function sX(e,t){return uX.apply(this,arguments)}function uX(){return uX=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=DX(t),!(o=r.tc.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.Yu(),e.next=15;break;case 6:return e.next=8,NK(r.localStore,pj(n));case 8:return s=e.sent,r.isPrimaryClient&&iQ(r.remoteStore,s),u=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,e.next=14,cX(r,n,i,"current"===u);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)})),uX.apply(this,arguments)}function cX(e,t,n,r){return lX.apply(this,arguments)}function lX(){return lX=TB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.hc=function(e,n,r){return(i=TB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Ku(r),e.t0=a.Oi,!e.t0){e.next=6;break}return e.next=5,FK(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.Ku(t,a)});case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(OX(t,n.targetId,s.zu),s.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,FK(t.localStore,n,!0);case 3:return a=e.sent,o=new rX(n,a.ji),s=o.Ku(a.documents),u=CY.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(s,t.isPrimaryClient,u),OX(t,r,c.zu),l=new iX(n,r,o),e.abrupt("return",(t.tc.set(n,l),t.ec.has(r)?t.ec.get(r).push(n):t.ec.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}},e)})),lX.apply(this,arguments)}function fX(e,t){return hX.apply(this,arguments)}function hX(){return hX=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Oq(t),i=r.tc.get(n),!((a=r.ec.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.ec.set(i.targetId,a.filter(function(e){return!yj(e,n)})),void r.tc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,DK(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),aQ(r.remoteStore,i.targetId),PX(r,i.targetId)}).catch(Jq);case 9:e.next=14;break;case 11:return PX(r,i.targetId),e.next=14,DK(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)})),hX.apply(this,arguments)}function dX(){return dX=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=LX(t),e.prev=1,e.next=4,function(e,t){var n,r,i=Oq(e),a=Hq.now(),o=t.reduce(function(e,t){return e.add(t.key)},gY());return i.persistence.runTransaction("Locally write mutations","readwrite",function(e){var s=sY(),u=gY();return i.Ui.getEntries(e,o).next(function(e){(s=e).forEach(function(e,t){t.isValidDocument()||(u=u.add(e))})}).next(function(){return i.localDocuments.getOverlayedDocuments(e,s)}).next(function(r){n=r;var o,s=[],u=dy(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Zj(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new jj(c.key,l,HW(l.value.mapValue),Vj.exists(!0)))}}catch(f){u.e(f)}finally{u.f()}return i.mutationQueue.addMutationBatch(e,a,s,t)}).next(function(t){r=t;var a=t.applyToLocalDocumentSet(n,u);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(function(){return{batchId:r.batchId,changes:lY(n)}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.oc[e.currentUser.toKey()];r||(r=new sW(Bq)),r=r.insert(t,n),e.oc[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,AX(i,a.changes);case 9:return e.next=11,wQ(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=zQ(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}},e,null,[[1,13]])})),dX.apply(this,arguments)}function vX(e,t){return pX.apply(this,arguments)}function pX(){return pX=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Oq(t),e.prev=1,e.next=4,xK(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.ic.get(t);n&&(Sq(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Xu=!0:e.modifiedDocuments.size>0?Sq(n.Xu):e.removedDocuments.size>0&&(Sq(n.Xu),n.Xu=!1))}),e.next=8,AX(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Jq(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])})),pX.apply(this,arguments)}function gX(e,t,n){var r=Oq(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.tc.forEach(function(e,n){var r=n.view.Eu(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=Oq(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=dy(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.Eu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}}),r&&JQ(n)}(r.eventManager,t),i.length&&r.Zu.Go(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function yX(e,t,n){return mX.apply(this,arguments)}function mX(){return mX=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=Oq(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.ic.get(n),!(o=a&&a.key)){e.next=14;break}return s=(s=new sW(jq.comparator)).insert(o,GW.newNoDocument(o,Gq.min())),u=gY().add(o),c=new kY(Gq.min(),new Map,new lW(Bq),s,u),e.next=9,vX(i,c);case 9:i.sc=i.sc.remove(o),i.ic.delete(n),IX(i),e.next=16;break;case 14:return e.next=16,DK(i.localStore,n,!1).then(function(){return PX(i,n,r)}).catch(Jq);case 16:case"end":return e.stop()}},e)})),mX.apply(this,arguments)}function kX(e,t){return CX.apply(this,arguments)}function CX(){return CX=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Oq(t),i=n.batch.batchId,e.prev=1,e.next=4,AK(r.localStore,n);case 4:return a=e.sent,bX(r,i,null),EX(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,AX(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Jq(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),CX.apply(this,arguments)}function wX(e,t,n){return _X.apply(this,arguments)}function _X(){return _X=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Oq(t),e.prev=1,e.next=4,function(e,t){var n=Oq(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next(function(t){return Sq(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)}).next(function(){return n.localDocuments.getDocuments(e,r)})})}(i.localStore,n);case 4:return a=e.sent,bX(i,n,r),EX(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,AX(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Jq(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),_X.apply(this,arguments)}function EX(e,t){(e.uc.get(t)||[]).forEach(function(e){e.resolve()}),e.uc.delete(t)}function bX(e,t,n){var r=Oq(e),i=r.oc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.oc[r.currentUser.toKey()]=i}}function PX(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=dy(e.ec.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.tc.delete(a),n&&e.Zu.lc(a,n)}}catch(o){i.e(o)}finally{i.f()}e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach(function(t){e.rc.containsKey(t)||SX(e,t)})}function SX(e,t){e.nc.delete(t.path.canonicalString());var n=e.sc.get(t);null!==n&&(aQ(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),IX(e))}function OX(e,t,n){var r,i=dy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof tX?(e.rc.addReference(a.key,t),TX(e,a)):a instanceof nX?(wq("SyncEngine","Document no longer in limbo: "+a.key),e.rc.removeReference(a.key,t),e.rc.containsKey(a.key)||SX(e,a.key)):Pq()}}catch(o){i.e(o)}finally{i.f()}}function TX(e,t){var n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(wq("SyncEngine","New document in limbo: "+n),e.nc.add(r),IX(e))}function IX(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){var t=e.nc.values().next().value;e.nc.delete(t);var n=new jq(Zq.fromString(t)),r=e.cc.next();e.ic.set(r,new aX(n)),e.sc=e.sc.insert(n,r),iQ(e.remoteStore,new iK(pj(lj(n.path)),r,2,rW.ot))}}function AX(e,t,n){return MX.apply(this,arguments)}function MX(){return MX=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Oq(t),a=[],o=[],s=[],e.t0=i.tc.isEmpty(),e.t0){e.next=9;break}return i.tc.forEach(function(e,t){s.push(i.hc(t,n,r).then(function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=PK.Vi(t.targetId,e);o.push(n)}}))}),e.next=6,Promise.all(s);case 6:return i.Zu.Go(a),e.next=9,(u=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Oq(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return tW.forEach(n,function(t){return tW.forEach(t.Pi,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return tW.forEach(t.vi,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),nW(e.t0)){e.next=10;break}throw e.t0;case 10:wq("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=dy(n);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.targetId,o.fromCache||(u=r.$i.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),r.$i=r.$i.insert(s,c))}catch(l){i.e(l)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])})),function(e,t){return u.apply(this,arguments)})(i.localStore,o);case 9:case"end":return e.stop()}},e)})),MX.apply(this,arguments)}function xX(e,t){return RX.apply(this,arguments)}function RX(){return RX=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Oq(t)).currentUser.isEqual(n)){e.next=12;break}return wq("SyncEngine","User change. New user:",n.toKey()),e.next=5,TK(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,(a=r).uc.forEach(function(e){e.forEach(function(e){e.reject(new Iq(Tq.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.uc.clear(),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=12,AX(r,i.Ki);case 12:case"end":return e.stop()}},e)})),RX.apply(this,arguments)}function NX(e,t){var n=Oq(e),r=n.ic.get(t);if(r&&r.Xu)return gY().add(r.key);var i=gY(),a=n.ec.get(t);if(!a)return i;var o,s=dy(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.tc.get(u);i=i.unionWith(c.view.qu)}}catch(l){s.e(l)}finally{s.f()}return i}function DX(e){var t=Oq(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=vX.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=NX.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=yX.bind(null,t),t.Zu.Go=QQ.bind(null,t.eventManager),t.Zu.lc=XQ.bind(null,t.eventManager),t}function LX(e){var t=Oq(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=kX.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=wX.bind(null,t),t}var FX=function(){function e(){gy(this,e),this.synchronizeTabs=!1}return my(e,[{key:"initialize",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.wt=qK(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),n.next=5,t.persistence.start();case 5:t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore);case 8:case"end":return n.stop()}},n)}))()}},{key:"mc",value:function(e,t){return null}},{key:"gc",value:function(e,t){return null}},{key:"wc",value:function(e){return function(e,t,n,r){return new OK(e,t,n,r)}(this.persistence,new SK,e.initialUser,this.wt)}},{key:"_c",value:function(e){return new _K(bK.Ms,this.wt)}},{key:"dc",value:function(e){return new VK}},{key:"terminate",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}},t)}))()}}]),e}(),UX=function(){function e(){gy(this,e)}return my(e,[{key:"initialize",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=n.localStore,r.t0){r.next=12;break}return n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=function(e){return gX(n.syncEngine,e,1)},n.remoteStore.remoteSyncer.handleCredentialChange=xX.bind(null,n.syncEngine),r.next=12,function(e,t){return FQ.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient);case 12:case"end":return r.stop()}},r)}))()}},{key:"createEventManager",value:function(e){return new qQ}},{key:"createDatastore",value:function(e){var t=qK(e.databaseInfo.databaseId),n=new $K(e.databaseInfo);return new QK(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return gX(o.syncEngine,e,0)},a=zK.V()?new zK:new BK,new JK(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=e.initialUser,s=e.maxConcurrentLimboResolutions,u=t,c=new oX(n,r,i,a,o,s),u&&(c.ac=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(e=TB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Oq(t),wq("RemoteStore","RemoteStore shutting down."),n.lu.add(5),e.next=5,nQ(n);case 5:n.du.shutdown(),n._u.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}(),VX=function(){function e(t){gy(this,e),this.observer=t,this.muted=!1}return my(e,[{key:"next",value:function(e){this.observer.next&&this.Ic(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"Tc",value:function(){this.muted=!0}},{key:"Ic",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),BX=function(){function e(t,n,r,i){var a=this;gy(this,e);var o,s=this;this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=yq.UNAUTHENTICATED,this.clientId=Vq.I(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,(o=TB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return wq("FirestoreClient","Received user=",t.uid),e.next=3,s.authCredentialListener(t);case 3:s.user=t;case 4:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})),this.appCheckCredentials.start(r,function(e){return wq("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)})}return my(e,[{key:"getConfiguration",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}},t)}))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Iq(Tq.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Aq;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=zQ(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function zX(e,t){return HX.apply(this,arguments)}function HX(){return HX=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),wq("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=TB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,TK(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)})),HX.apply(this,arguments)}function GX(e,t){return $X.apply(this,arguments)}function $X(){return $X=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,ZX(t);case 3:return r=e.sent,wq("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return DQ(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return DQ(n.remoteStore,t)}),t.onlineComponents=n;case 13:case"end":return e.stop()}},e)})),$X.apply(this,arguments)}function ZX(e){return qX.apply(this,arguments)}function qX(){return qX=TB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return wq("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,zX(t,new FX);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)})),qX.apply(this,arguments)}function WX(e){return jX.apply(this,arguments)}function jX(){return jX=TB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return wq("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,GX(t,new UX);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)})),jX.apply(this,arguments)}function YX(e){return KX.apply(this,arguments)}function KX(){return KX=TB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,WX(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=sX.bind(null,n.syncEngine),r.onUnlisten=fX.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)})),KX.apply(this,arguments)}var QX=new Map;function XX(e,t,n){if(!n)throw new Iq(Tq.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function JX(e){if(!jq.isDocumentKey(e))throw new Iq(Tq.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function eJ(e){if(jq.isDocumentKey(e))throw new Iq(Tq.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function tJ(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":Pq()}function nJ(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Iq(Tq.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=tJ(e);throw new Iq(Tq.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var rJ=function(){function e(t){var n;if(gy(this,e),void 0===t.host){if(void 0!==t.ssl)throw new Iq(Tq.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Iq(Tq.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new Iq(Tq.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return my(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),iJ=function(){function e(t,n,r){gy(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rJ({}),this._settingsFrozen=!1,t instanceof _W?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Iq(Tq.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _W(e.options.projectId)}(t))}return my(e,[{key:"app",get:function(){if(!this._app)throw new Iq(Tq.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new Iq(Tq.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rJ(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new xq;switch(e.type){case"gapi":var t=e.client;return Sq(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new Dq(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new Iq(Tq.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=QX.get(e))&&(wq("ComponentProvider","Removing Datastore"),QX.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}(),aJ=function(){function e(t,n,r){gy(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return my(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new sJ(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),oJ=function(){function e(t,n,r){gy(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return my(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),sJ=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r,lj(i)))._path=i,a.type="collection",a}return my(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new aJ(this.firestore,null,new jq(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(oJ);function uJ(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=uz(e),1===arguments.length&&(t=Vq.I()),XX("doc","path",t),e instanceof iJ){var a=Zq.fromString.apply(Zq,[t].concat(r));return JX(a),new aJ(e,null,new jq(a))}if(!(e instanceof aJ||e instanceof sJ))throw new Iq(Tq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Zq.fromString.apply(Zq,[t].concat(r)));return JX(o),new aJ(e.firestore,e instanceof sJ?e.converter:null,new jq(o))}var cJ=function(){function e(){var t=this;gy(this,e),this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new WK(this,"async_queue_retry"),this.Kc=function(){var e=ZK();e&&wq("AsyncQueue","Visibility state changed to "+e.visibilityState),t.So.Eo()};var n=ZK();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Kc)}return my(e,[{key:"isShuttingDown",get:function(){return this.Fc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Gc(),this.Qc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;var t=ZK();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Gc(),this.Fc)return new Promise(function(){});var n=new Aq;return this.Qc(function(){return t.Fc&&t.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.Mc.push(e),t.jc()})}},{key:"jc",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.Mc.length){t.next=14;break}return t.prev=1,t.next=4,e.Mc[0]();case 4:e.Mc.shift(),e.So.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),nW(t.t0)){t.next=12;break}throw t.t0;case 12:wq("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.Mc.length>0&&e.So.Io(function(){return e.jc()});case 14:case"end":return t.stop()}},t,null,[[1,8]])}))()}},{key:"Qc",value:function(e){var t=this,n=this.Oc.then(function(){return t.Lc=!0,e().catch(function(e){throw t.Bc=e,t.Lc=!1,_q("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e;var n,r}).then(function(e){return t.Lc=!1,e})});return this.Oc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Gc(),this.qc.indexOf(e)>-1&&(t=0);var i=BQ.createAndSchedule(this,e,t,n,function(e){return r.Wc(e)});return this.$c.push(i),i}},{key:"Gc",value:function(){this.Bc&&Pq()}},{key:"verifyOperationInProgress",value:function(){}},{key:"zc",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.Oc,t.next=3,n;case 3:if(n!==e.Oc){t.next=0;break}case 4:case"end":return t.stop()}},t)}))()}},{key:"Hc",value:function(e){var t,n=dy(this.$c);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Jc",value:function(e){var t=this;return this.zc().then(function(){t.$c.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=dy(t.$c);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.zc()})}},{key:"Yc",value:function(e){this.qc.push(e)}},{key:"Wc",value:function(e){var t=this.$c.indexOf(e);this.$c.splice(t,1)}}]),e}();function lJ(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var a=i[r];if(a in n&&"function"==typeof n[a])return!0}return!1}(e)}var fJ=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new cJ,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return my(n,[{key:"_terminate",value:function(){return this._firestoreClient||dJ(this),this._firestoreClient.terminate()}}]),n}(iJ);function hJ(e){return e._firestoreClient||dJ(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function dJ(e){var t,n,r,i=e._freezeSettings(),a=(n=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new wW(e._databaseId,n,e._persistenceKey,(r=i).host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams));e._firestoreClient=new BX(e._authCredentials,e._appCheckCredentials,e._queue,a)}var vJ=function(){function e(){gy(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new Iq(Tq.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Wq(n)}return my(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}(),pJ=function(){function e(t){gy(this,e),this._byteString=t}return my(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(dW.fromBase64String(t))}catch(n){throw new Iq(Tq.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}},{key:"fromUint8Array",value:function(t){return new e(dW.fromUint8Array(t))}}]),e}(),gJ=my(function e(t){gy(this,e),this._methodName=t}),yJ=function(){function e(t,n){if(gy(this,e),!isFinite(t)||t<-90||t>90)throw new Iq(Tq.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Iq(Tq.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return my(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return Bq(this._lat,e._lat)||Bq(this._long,e._long)}}]),e}(),mJ=/^__.*__$/,kJ=function(){function e(t,n,r){gy(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return my(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new jj(e,this.data,this.fieldMask,t,this.fieldTransforms):new Wj(e,this.data,t,this.fieldTransforms)}}]),e}(),CJ=function(){function e(t,n,r){gy(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return my(e,[{key:"toMutation",value:function(e,t){return new jj(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function wJ(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pq()}}var _J=function(){function e(t,n,r,i,a,o){gy(this,e),this.settings=t,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Xc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return my(e,[{key:"path",get:function(){return this.settings.path}},{key:"Zc",get:function(){return this.settings.Zc}},{key:"ta",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ea",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}},{key:"ia",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}},{key:"ra",value:function(e){return this.ta({path:void 0,na:!0})}},{key:"oa",value:function(e){return DJ(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"Xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.sa(this.path.get(e))}},{key:"sa",value:function(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(wJ(this.Zc)&&mJ.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}]),e}(),EJ=function(){function e(t,n,r){gy(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.wt=r||qK(t)}return my(e,[{key:"aa",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new _J({Zc:e,methodName:t,ca:n,path:Wq.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}]),e}();function bJ(e){var t=e._freezeSettings(),n=qK(e._databaseId);return new EJ(e._databaseId,!!t.ignoreUndefinedProperties,n)}function PJ(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.aa(a.merge||a.mergeFields?2:0,t,n,i);MJ("Data must be an object, but it was:",o,r);var s,u,c=IJ(r,o);if(a.merge)s=new hW(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l,f=[],h=dy(a.mergeFields);try{for(h.s();!(l=h.n()).done;){var d=l.value,v=xJ(t,d,n);if(!o.contains(v))throw new Iq(Tq.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));LJ(f,v)||f.push(v)}}catch(p){h.e(p)}finally{h.f()}s=new hW(f),u=o.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=o.fieldTransforms;return new kJ(new zW(c),s,u)}var SJ=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.Zc)throw e.oa(1===e.Zc?"".concat(this._methodName,"() can only appear at the top level of your update data"):"".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(gJ),OJ=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"_toFieldTransform",value:function(e){return new Fj(e.path,new Ij)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(gJ);function TJ(e,t){if(AJ(e=uz(e)))return MJ("Unsupported field value:",t,e),IJ(e,t);if(e instanceof gJ)return function(e,t){if(!wJ(t.Zc))throw t.oa("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.oa("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=dy(e);try{for(a.s();!(n=a.n()).done;){var o=TJ(n.value,t.ra(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=uz(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!bW(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?bj(t):Ej(e,t)}(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=Hq.fromDate(e);return{timestampValue:MY(t.wt,n)}}if(e instanceof Hq){var r=new Hq(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:MY(t.wt,r)}}if(e instanceof yJ)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof pJ)return{bytesValue:xY(t.wt,e._byteString)};if(e instanceof aJ){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.oa("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:DY(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa("Unsupported field value: ".concat(tJ(e)))}(e,t)}function IJ(e,t){var n={};return oW(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):aW(e,function(e,r){var i=TJ(r,t.ea(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function AJ(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Hq||e instanceof yJ||e instanceof pJ||e instanceof aJ||e instanceof gJ)}function MJ(e,t,n){if(!AJ(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){var r=tJ(n);throw t.oa("an object"===r?e+" a custom object":e+" "+r)}var i}function xJ(e,t,n){if((t=uz(t))instanceof vJ)return t._internalPath;if("string"==typeof t)return NJ(e,t);throw DJ("Field path arguments must be of type string or ",e,!1,void 0,n)}var RJ=new RegExp("[~\\*/\\[\\]]");function NJ(e,t,n){if(t.search(RJ)>=0)throw DJ("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return ty(vJ,fy(t.split(".")))._internalPath}catch(r){throw DJ("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function DJ(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new Iq(Tq.INVALID_ARGUMENT,s+e+u)}function LJ(e,t){return e.some(function(e){return e.isEqual(t)})}var FJ=function(){function e(t,n,r,i,a){gy(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return my(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new aJ(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new UJ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(VJ("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),UJ=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"data",value:function(){return ny(ly(n.prototype),"data",this).call(this)}}]),n}(FJ);function VJ(e,t){return"string"==typeof t?NJ(e,t):t instanceof vJ?t._internalPath:t._delegate._internalPath}var BJ=function(){function e(t,n){gy(this,e),this.hasPendingWrites=t,this.fromCache=n}return my(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),zJ=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s){var u;return gy(this,n),(u=t.call(this,e,r,i,a,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return my(n,[{key:"exists",value:function(){return ny(ly(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new HJ(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(VJ("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(FJ),HJ=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ny(ly(n.prototype),"data",this).call(this,e)}}]),n}(zJ),GJ=function(){function e(t,n,r,i){gy(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new BJ(i.hasPendingWrites,i.fromCache),this.query=r}return my(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new HJ(n._firestore,n._userDataWriter,r.key,r,new BJ(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Iq(Tq.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new HJ(e._firestore,e._userDataWriter,t.doc.key,t.doc,new BJ(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new HJ(e._firestore,e._userDataWriter,t.doc.key,t.doc,new BJ(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:$J(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function $J(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pq()}}function ZJ(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Iq(Tq.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var qJ=my(function e(){gy(this,e)});var WJ=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this)).fa=e,a.da=r,a._a=i,a.type="where",a}return my(n,[{key:"_apply",value:function(e){var t,n,r,i=bJ(e.firestore),a=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Iq(Tq.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){QJ(o,a);var u,c=[],l=dy(o);try{for(l.s();!(u=l.n()).done;){var f=u.value;c.push(KJ(r,e,f))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=KJ(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||QJ(o,a),s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return TJ(n,e.aa(r?4:3,t))}(n,"where",o,"in"===a||"not-in"===a);var h=YW.create(i,a,s);return function(e,t){if(t.ht()){var n=hj(e);if(null!==n&&!n.isEqual(t.field))throw new Iq(Tq.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=fj(e);null!==r&&XJ(0,t.field,r)}var i=function(e,t){var n,r=dy(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new Iq(Tq.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter."):"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,h),h}(e._query,0,i,e.firestore._databaseId,this.fa,this.da,this._a);return new oJ(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new cj(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(qJ);var jJ=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).fa=e,i.wa=r,i.type="orderBy",i}return my(n,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new Iq(Tq.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Iq(Tq.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new aj(t,n);return function(e,t){if(null===fj(e)){var n=hj(e);null!==n&&XJ(0,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new oJ(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new cj(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(qJ);var YJ=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this)).type=e,a.ma=r,a.ga=i,a}return my(n,[{key:"_apply",value:function(e){return new oJ(e.firestore,e.converter,gj(e._query,this.ma,this.ga))}}]),n}(qJ);function KJ(e,t,n){if("string"==typeof(n=uz(n))){if(""===n)throw new Iq(Tq.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dj(t)&&-1!==n.indexOf("/"))throw new Iq(Tq.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(Zq.fromString(n));if(!jq.isDocumentKey(r))throw new Iq(Tq.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return RW(e,new jq(r))}if(n instanceof aJ)return RW(e,n._key);throw new Iq(Tq.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(tJ(n),"."))}function QJ(e,t){if(!Array.isArray(e)||0===e.length)throw new Iq(Tq.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new Iq(Tq.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function XJ(e,t,n){if(!n.isEqual(t))throw new Iq(Tq.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}function JJ(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var e1=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).firestore=e,r}return my(n,[{key:"convertBytes",value:function(e){return new pJ(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new aJ(this.firestore,null,t)}}]),n}(function(){function e(){gy(this,e)}return my(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(SW(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gW(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(yW(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Pq()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return aW(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new yJ(gW(e.latitude),gW(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=kW(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(CW(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=pW(e);return new Hq(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=Zq.fromString(e);Sq(eK(n));var r=new _W(n.get(1),n.get(3)),i=new jq(n.popFirst(5));return r.isEqual(t)||_q("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}());function t1(e,t){return n=hJ(e),r=t,i=new Aq,n.asyncQueue.enqueueAndForget(TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n){return dX.apply(this,arguments)},e.next=3,function(e){return WX(e).then(function(e){return e.syncEngine})}(n);case 3:return e.t1=e.sent,e.t2=r,e.t3=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}},e)}))),i.promise;var n,r,i}function n1(e,t,n){var r=n.docs.get(t._key),i=new e1(e);return new zJ(e,i,t._key,r,new BJ(n.hasPendingWrites,n.fromCache),t.converter)}function r1(){return new OJ("serverTimestamp")}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];mq="9.9.0",Zz(new fz("firestore",function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new fJ(i,new Rq(e.getProvider("auth-internal")),new Fq(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC")),Xz(gq,"3.4.12",e),Xz(gq,"3.4.12","esm2017")}(),Xz("firebase","9.9.0","app");var i1="@firebase/installations",a1="0.5.12",o1="w:".concat(a1),s1="FIS_v2",u1=new XB("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function c1(e){return e instanceof QB&&e.code.includes("request-failed")}function l1(e){var t=e.projectId;return"https://firebaseinstallations.googleapis.com/v1/projects/".concat(t,"/installations")}function f1(e){return{token:e.token,requestStatus:2,expiresIn:m1(e.expiresIn),creationTime:Date.now()}}function h1(e,t){return d1.apply(this,arguments)}function d1(){return d1=TB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return r=e.sent.error,e.abrupt("return",u1.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status}));case 4:case"end":return e.stop()}},e)})),d1.apply(this,arguments)}function v1(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function p1(e,t){var n=t.refreshToken,r=v1(e);return r.append("Authorization",function(e){return"".concat(s1," ").concat(e)}(n)),r}function g1(e){return y1.apply(this,arguments)}function y1(){return y1=TB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,e.abrupt("return",n.status>=500&&n.status<600?t():n);case 4:case"end":return e.stop()}},e)})),y1.apply(this,arguments)}function m1(e){return Number(e.replace("s","000"))}function k1(e,t){return C1.apply(this,arguments)}function C1(){return C1=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=n.fid,o=l1(r),s=v1(r),!(u=i.getImmediate({optional:!0}))){e.next=8;break}return e.next=6,u.getHeartbeatsHeader();case 6:(c=e.sent)&&s.append("x-firebase-client",c);case 8:return l={method:"POST",headers:s,body:JSON.stringify({fid:a,authVersion:s1,appId:r.appId,sdkVersion:o1})},e.next=11,g1(function(){return fetch(o,l)});case 11:if(!(f=e.sent).ok){e.next=17;break}return e.next=15,f.json();case 15:return h=e.sent,e.abrupt("return",{fid:h.fid||a,registrationStatus:2,refreshToken:h.refreshToken,authToken:f1(h.authToken)});case 17:return e.next=19,h1("Create Installation",f);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),C1.apply(this,arguments)}function w1(e){return new Promise(function(t){setTimeout(t,e)})}var _1=/^[cdef][\w-]{21}$/;function E1(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return function(e){return btoa(String.fromCharCode.apply(String,fy(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return _1.test(t)?t:""}catch(n){return""}}function b1(e){return"".concat(e.appName,"!").concat(e.appId)}var P1=new Map;function S1(e,t){var n=b1(e);O1(n,t),function(e,t){var n=(!T1&&"BroadcastChannel"in self&&((T1=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){O1(e.data.key,e.data.fid)}),T1);n&&n.postMessage({key:e,fid:t}),0===P1.size&&T1&&(T1.close(),T1=null)}(n,t)}function O1(e,t){var n=P1.get(e);if(n){var r,i=dy(n);try{for(i.s();!(r=i.n()).done;){(0,r.value)(t)}}catch(a){i.e(a)}finally{i.f()}}}var T1=null,I1="firebase-installations-store",A1=null;function M1(){return A1||(A1=Az("firebase-installations-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(I1)}})),A1}function x1(e,t){return R1.apply(this,arguments)}function R1(){return R1=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=b1(t),e.next=3,M1();case 3:return i=e.sent.transaction(I1,"readwrite"),a=i.objectStore(I1),e.next=7,a.get(r);case 7:return o=e.sent,e.next=10,a.put(n,r);case 10:return e.next=12,i.done;case 12:return(!o||o.fid!==n.fid)&&S1(t,n.fid),e.abrupt("return",n);case 14:case"end":return e.stop()}},e)})),R1.apply(this,arguments)}function N1(e){return D1.apply(this,arguments)}function D1(){return D1=TB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=b1(t),e.next=3,M1();case 3:return r=e.sent.transaction(I1,"readwrite"),e.next=6,r.objectStore(I1).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),D1.apply(this,arguments)}function L1(e,t){return F1.apply(this,arguments)}function F1(){return F1=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=b1(t),e.next=3,M1();case 3:return i=e.sent.transaction(I1,"readwrite"),a=i.objectStore(I1),e.next=7,a.get(r);case 7:if(o=e.sent,void 0!==(s=n(o))){e.next=14;break}return e.next=12,a.delete(r);case 12:e.next=16;break;case 14:return e.next=16,a.put(s,r);case 16:return e.next=18,i.done;case 18:return s&&(!o||o.fid!==s.fid)&&S1(t,s.fid),e.abrupt("return",s);case 20:case"end":return e.stop()}},e)})),F1.apply(this,arguments)}function U1(e){return V1.apply(this,arguments)}function V1(){return V1=TB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L1(t.appConfig,function(e){var r=B1(e),i=z1(t,r);return n=i.registrationPromise,i.installationEntry});case 2:if(""!==(r=e.sent).fid){e.next=10;break}return e.next=6,n;case 6:e.t1=e.sent,e.t0={installationEntry:e.t1},e.next=11;break;case 10:e.t0={installationEntry:r,registrationPromise:n};case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),V1.apply(this,arguments)}function B1(e){return q1(e||{fid:E1(),registrationStatus:0})}function z1(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(u1.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return H1.apply(this,arguments)}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:G1(e)}:{installationEntry:t}}function H1(){return H1=TB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k1(t,n);case 3:return r=e.sent,e.abrupt("return",x1(t.appConfig,r));case 7:if(e.prev=7,e.t0=e.catch(0),!c1(e.t0)||409!==e.t0.customData.serverCode){e.next=14;break}return e.next=12,N1(t.appConfig);case 12:e.next=16;break;case 14:return e.next=16,x1(t.appConfig,{fid:n.fid,registrationStatus:0});case 16:throw e.t0;case 17:case"end":return e.stop()}},e,null,[[0,7]])})),H1.apply(this,arguments)}function G1(e){return $1.apply(this,arguments)}function $1(){return $1=TB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z1(t.appConfig);case 2:n=e.sent;case 3:if(1!==n.registrationStatus){e.next=11;break}return e.next=6,w1(100);case 6:return e.next=8,Z1(t.appConfig);case 8:n=e.sent;case 9:e.next=3;break;case 11:if(0!==n.registrationStatus){e.next=18;break}return e.next=14,U1(t);case 14:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",a||i);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e)})),$1.apply(this,arguments)}function Z1(e){return L1(e,function(e){if(!e)throw u1.create("installation-not-found");return q1(e)})}function q1(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function W1(e,t){return j1.apply(this,arguments)}function j1(){return j1=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=Y1(r,n),o=p1(r,n),!(s=i.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,s.getHeartbeatsHeader();case 5:(u=e.sent)&&o.append("x-firebase-client",u);case 7:return c={method:"POST",headers:o,body:JSON.stringify({installation:{sdkVersion:o1,appId:r.appId}})},e.next=10,g1(function(){return fetch(a,c)});case 10:if(!(l=e.sent).ok){e.next=17;break}return e.t0=f1,e.next=15,l.json();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 17:return e.next=19,h1("Generate Auth Token",l);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),j1.apply(this,arguments)}function Y1(e,t){var n=t.fid;return"".concat(l1(e),"/").concat(n,"/authTokens:generate")}function K1(e){return Q1.apply(this,arguments)}function Q1(){return Q1=TB(regeneratorRuntime.mark(function e(t){var n,r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.next=3,L1(t.appConfig,function(e){if(!r0(e))throw u1.create("not-registered");var i=e.authToken;if(!n&&i0(i))return e;if(1===i.requestStatus)return r=X1(t,n),e;if(!navigator.onLine)throw u1.create("app-offline");var a=a0(e);return r=t0(t,a),a});case 3:if(i=e.sent,!r){e.next=10;break}return e.next=7,r;case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=i.authToken;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),Q1.apply(this,arguments)}function X1(e,t){return J1.apply(this,arguments)}function J1(){return J1=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,e0(t.appConfig);case 2:r=e.sent;case 3:if(1!==r.authToken.requestStatus){e.next=11;break}return e.next=6,w1(100);case 6:return e.next=8,e0(t.appConfig);case 8:r=e.sent;case 9:e.next=3;break;case 11:return i=r.authToken,e.abrupt("return",0===i.requestStatus?K1(t,n):i);case 13:case"end":return e.stop()}},e)})),J1.apply(this,arguments)}function e0(e){return L1(e,function(e){if(!r0(e))throw u1.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function t0(e,t){return n0.apply(this,arguments)}function n0(){return n0=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,W1(t,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{authToken:r}),e.next=7,x1(t.appConfig,i);case 7:return e.abrupt("return",r);case 10:if(e.prev=10,e.t0=e.catch(0),c1(e.t0)&&(401===e.t0.customData.serverCode||404===e.t0.customData.serverCode)){e.next=18;break}return a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),e.next=16,x1(t.appConfig,a);case 16:e.next=20;break;case 18:return e.next=20,N1(t.appConfig);case 20:throw e.t0;case 21:case"end":return e.stop()}},e,null,[[0,10]])})),n0.apply(this,arguments)}function r0(e){return void 0!==e&&2===e.registrationStatus}function i0(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function a0(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function o0(){return o0=TB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,U1(n);case 3:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",(a?a.catch(console.error):K1(n).catch(console.error),i.fid));case 7:case"end":return e.stop()}},e)})),o0.apply(this,arguments)}function s0(){return s0=TB(regeneratorRuntime.mark(function e(t){var n,r,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],r=t,e.next=4,u0(r);case 4:return e.next=6,K1(r,n);case 6:return e.abrupt("return",e.sent.token);case 7:case"end":return e.stop()}},e)})),s0.apply(this,arguments)}function u0(e){return c0.apply(this,arguments)}function c0(){return c0=TB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U1(t);case 2:if(n=e.sent,r=n.registrationPromise,e.t0=r,!e.t0){e.next=8;break}return e.next=8,r;case 8:case"end":return e.stop()}},e)})),c0.apply(this,arguments)}function l0(e){return u1.create("missing-app-config-values",{valueName:e})}var f0="installations";Zz(new fz(f0,function(e){var t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw l0("App Configuration");if(!e.name)throw l0("App Name");for(var t=0,n=["projectId","apiKey","appId"];t<n.length;t++){var r=n[t];if(!e.options[r])throw l0(r)}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:qz(t,"heartbeat"),_delete:function(){return Promise.resolve()}}},"PUBLIC")),Zz(new fz("installations-internal",function(e){var t=qz(e.getProvider("app").getImmediate(),f0).getImmediate();return{getId:function(){return function(e){return o0.apply(this,arguments)}(t)},getToken:function(e){return function(e){return s0.apply(this,arguments)}(t,e)}}},"PRIVATE")),Xz(i1,a1),Xz(i1,a1,"esm2017");var h0="@firebase/remote-config",d0=new XB("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),v0=function(){function e(t,n,r,i){gy(this,e),this.client=t,this.storage=n,this.storageCache=r,this.logger=i}return my(e,[{key:"isCachedDataFresh",value:function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: ".concat(n,". Cache max age millis (minimumFetchIntervalMillis setting): ").concat(e,". Is cache hit: ").concat(r,".")),r}},{key:"fetch",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);case 2:if(r=n.sent,i=Qg(r,2),a=i[0],!(o=i[1])||!t.isCachedDataFresh(e.cacheMaxAgeMillis,a)){n.next=8;break}return n.abrupt("return",o);case 8:return e.eTag=o&&o.eTag,n.next=11,t.client.fetch(e);case 11:return s=n.sent,u=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===s.status&&u.push(t.storage.setLastSuccessfulFetchResponse(s)),n.next=16,Promise.all(u);case 16:return n.abrupt("return",s);case 17:case"end":return n.stop()}},n)}))()}}]),e}();function p0(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.languages&&e.languages[0]||e.language}var g0=function(){function e(t,n,r,i,a,o){gy(this,e),this.firebaseInstallations=t,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=a,this.appId=o}return my(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]);case 2:return o=n.sent,s=Qg(o,2),u=s[0],c=s[1],l="".concat(window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com","/v1/projects/").concat(t.projectId,"/namespaces/").concat(t.namespace,":fetch?key=").concat(t.apiKey),f={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},h={sdk_version:t.sdkVersion,app_instance_id:u,app_instance_id_token:c,app_id:t.appId,language_code:p0()},d={method:"POST",headers:f,body:JSON.stringify(h)},v=fetch(l,d),p=new Promise(function(t,n){e.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)})}),n.prev=12,n.next=15,Promise.race([v,p]);case 15:return n.next=17,v;case 17:g=n.sent,n.next=24;break;case 20:throw n.prev=20,n.t0=n.catch(12),y="fetch-client-network","AbortError"===(null===(r=n.t0)||void 0===r?void 0:r.name)&&(y="fetch-timeout"),d0.create(y,{originalErrorMessage:null===(i=n.t0)||void 0===i?void 0:i.message});case 24:if(m=g.status,k=g.headers.get("ETag")||void 0,200!==g.status){n.next=37;break}return n.prev=27,n.next=30,g.json();case 30:_=n.sent,n.next=36;break;case 33:throw n.prev=33,n.t1=n.catch(27),d0.create("fetch-client-parse",{originalErrorMessage:null===(a=n.t1)||void 0===a?void 0:a.message});case 36:C=_.entries,w=_.state;case 37:if("INSTANCE_STATE_UNSPECIFIED"===w?m=500:"NO_CHANGE"===w?m=304:("NO_TEMPLATE"===w||"EMPTY_CONFIG"===w)&&(C={}),304===m||200===m){n.next=39;break}throw d0.create("fetch-status",{httpStatus:m});case 39:return n.abrupt("return",{status:m,eTag:k,config:C});case 40:case"end":return n.stop()}},n,null,[[12,20],[27,33]])}))()})}]),e}(),y0=function(){function e(t,n){gy(this,e),this.client=t,this.storage=n}return my(e,[{key:"fetch",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.getThrottleMetadata();case 2:if(n.t0=n.sent,n.t0){n.next=5;break}n.t0={backoffCount:0,throttleEndTimeMillis:Date.now()};case 5:return r=n.t0,n.abrupt("return",t.attemptFetch(e,r));case 7:case"end":return n.stop()}},n)}))()}},{key:"attemptFetch",value:function(e,t){var n=t.throttleEndTimeMillis,r=t.backoffCount,i=this;return TB(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(d0.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,n);case 2:return t.prev=2,t.next=5,i.client.fetch(e);case 5:return a=t.sent,t.next=8,i.storage.deleteThrottleMetadata();case 8:return t.abrupt("return",a);case 11:if(t.prev=11,t.t0=t.catch(2),function(e){if(!(e instanceof QB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t.t0)){t.next=15;break}throw t.t0;case 15:return o={throttleEndTimeMillis:Date.now()+sz(r),backoffCount:r+1},t.next=18,i.storage.setThrottleMetadata(o);case 18:return t.abrupt("return",i.attemptFetch(e,o));case 19:case"end":return t.stop()}},t,null,[[2,11]])}))()}}]),e}(),m0=function(){function e(t,n,r,i,a){gy(this,e),this.app=t,this._client=n,this._storageCache=r,this._storage=i,this._logger=a,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return my(e,[{key:"fetchTimeMillis",get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}},{key:"lastFetchStatus",get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}]),e}();function k0(e,t){var n,r=e.target.error||void 0;return d0.create(t,{originalErrorMessage:r&&(null===(n=r)||void 0===n?void 0:n.message)})}var C0="app_namespace_store",w0=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Promise(function(e,t){var n;try{var i=indexedDB.open("firebase_remote_config",1);i.onerror=function(e){t(k0(e,"storage-open"))},i.onsuccess=function(t){e(t.target.result)},i.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(C0,{keyPath:"compositeKey"})}}catch(r){t(d0.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}});gy(this,e),this.appId=t,this.appName=n,this.namespace=r,this.openDbPromise=i}return my(e,[{key:"getLastFetchStatus",value:function(){return this.get("last_fetch_status")}},{key:"setLastFetchStatus",value:function(e){return this.set("last_fetch_status",e)}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.get("last_successful_fetch_timestamp_millis")}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.set("last_successful_fetch_timestamp_millis",e)}},{key:"getLastSuccessfulFetchResponse",value:function(){return this.get("last_successful_fetch_response")}},{key:"setLastSuccessfulFetchResponse",value:function(e){return this.set("last_successful_fetch_response",e)}},{key:"getActiveConfig",value:function(){return this.get("active_config")}},{key:"setActiveConfig",value:function(e){return this.set("active_config",e)}},{key:"getActiveConfigEtag",value:function(){return this.get("active_config_etag")}},{key:"setActiveConfigEtag",value:function(e){return this.set("active_config_etag",e)}},{key:"getThrottleMetadata",value:function(){return this.get("throttle_metadata")}},{key:"setThrottleMetadata",value:function(e){return this.set("throttle_metadata",e)}},{key:"deleteThrottleMetadata",value:function(){return this.delete("throttle_metadata")}},{key:"get",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([C0],"readonly").objectStore(C0),s=t.createCompositeKey(e);try{var u=o.get(s);u.onerror=function(e){i(k0(e,"storage-get"))},u.onsuccess=function(e){var t=e.target.result;n(t?t.value:void 0)}}catch(u){i(d0.create("storage-get",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"set",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.openDbPromise;case 2:return i=r.sent,r.abrupt("return",new Promise(function(r,a){var o,s=i.transaction([C0],"readwrite").objectStore(C0),u=n.createCompositeKey(e);try{var c=s.put({compositeKey:u,value:t});c.onerror=function(e){a(k0(e,"storage-set"))},c.onsuccess=function(){r()}}catch(c){a(d0.create("storage-set",{originalErrorMessage:null===(o=c)||void 0===o?void 0:o.message}))}}));case 4:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([C0],"readwrite").objectStore(C0),s=t.createCompositeKey(e);try{var u=o.delete(s);u.onerror=function(e){i(k0(e,"storage-delete"))},u.onsuccess=function(){n()}}catch(u){i(d0.create("storage-delete",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"createCompositeKey",value:function(e){return[this.appId,this.appName,this.namespace,e].join()}}]),e}(),_0=function(){function e(t){gy(this,e),this.storage=t}return my(e,[{key:"getLastFetchStatus",value:function(){return this.lastFetchStatus}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.lastSuccessfulFetchTimestampMillis}},{key:"getActiveConfig",value:function(){return this.activeConfig}},{key:"loadFromStorage",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),t.next=5,n;case 5:return(a=t.sent)&&(e.lastFetchStatus=a),t.next=9,r;case 9:return(o=t.sent)&&(e.lastSuccessfulFetchTimestampMillis=o),t.next=13,i;case 13:(s=t.sent)&&(e.activeConfig=s);case 15:case"end":return t.stop()}},t)}))()}},{key:"setLastFetchStatus",value:function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}},{key:"setActiveConfig",value:function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}]),e}();function E0(){return(E0=TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(jB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,YB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}Zz(new fz("remote-config",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw d0.create("registration-window");if(!jB())throw d0.create("indexed-db-unavailable");var a=r.options,o=a.projectId,s=a.apiKey,u=a.appId;if(!o)throw d0.create("registration-project-id");if(!s)throw d0.create("registration-api-key");if(!u)throw d0.create("registration-app-id");var c=new w0(u,r.name,n=n||"firebase"),l=new _0(c),f=new wz(h0);f.logLevel=gz.ERROR;var h=new g0(i,Yz,n,o,s,u),d=new y0(h,c),v=new v0(d,c,l,f),p=new m0(r,v,l,c,f);return function(e){var t=uz(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0}))}(p),p},"PUBLIC").setMultipleInstances(!0)),Xz(h0,"0.3.11"),Xz(h0,"0.3.11","esm2017");var b0="/firebase-messaging-sw.js",P0="/firebase-cloud-messaging-push-scope",S0="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",O0="google.c.a.c_id",T0="google.c.a.c_l",I0="google.c.a.ts",A0="google.c.a.e",M0=(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(M0||(M0={})),M0);function x0(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,fy(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function R0(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var N0="fcm_token_details_db",D0="fcm_token_object_Store";function L0(e){return F0.apply(this,arguments)}function F0(){return F0=TB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="databases"in indexedDB,!e.t0){e.next=5;break}return e.next=4,indexedDB.databases();case 4:e.t0=!e.sent.map(function(e){return e.name}).includes(N0);case 5:if(!e.t0){e.next=7;break}return e.abrupt("return",null);case 7:return n=null,e.next=10,Az(N0,5,{upgrade:(r=TB(regeneratorRuntime.mark(function e(r,i,a,o){var s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<2)&&r.objectStoreNames.contains(D0)){e.next=2;break}return e.abrupt("return");case 2:return u=o.objectStore(D0),e.next=5,u.index("fcmSenderId").get(t);case 5:return c=e.sent,e.next=8,u.clear();case 8:if(!c){e.next=17;break}if(2!==i){e.next=16;break}if((l=c).auth&&l.p256dh&&l.endpoint){e.next=13;break}return e.abrupt("return");case 13:n={token:l.fcmToken,createTime:null!==(s=l.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:l.auth,p256dh:l.p256dh,endpoint:l.endpoint,swScope:l.swScope,vapidKey:"string"==typeof l.vapidKey?l.vapidKey:x0(l.vapidKey)}},e.next=17;break;case 16:3===i?n={token:(f=c).fcmToken,createTime:f.createTime,subscriptionOptions:{auth:x0(f.auth),p256dh:x0(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:x0(f.vapidKey)}}:4===i&&(n={token:(h=c).fcmToken,createTime:h.createTime,subscriptionOptions:{auth:x0(h.auth),p256dh:x0(h.p256dh),endpoint:h.endpoint,swScope:h.swScope,vapidKey:x0(h.vapidKey)}});case 17:case"end":return e.stop()}},e)})),function(e,t,n,i){return r.apply(this,arguments)})});case 10:return e.sent.close(),e.next=13,Mz(N0);case 13:return e.next=15,Mz("fcm_vapid_details_db");case 15:return e.next=17,Mz("undefined");case 17:return e.abrupt("return",U0(n)?n:null);case 18:case"end":return e.stop()}},e)})),F0.apply(this,arguments)}function U0(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}var V0="firebase-messaging-store",B0=null;function z0(){return B0||(B0=Az("firebase-messaging-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(V0)}})),B0}function H0(e){return G0.apply(this,arguments)}function G0(){return G0=TB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=j0(t),e.next=3,z0();case 3:return e.next=5,e.sent.transaction(V0).objectStore(V0).get(n);case 5:if(!(r=e.sent)){e.next=8;break}return e.abrupt("return",r);case 8:return e.next=10,L0(t.appConfig.senderId);case 10:if(!(i=e.sent)){e.next=15;break}return e.next=14,$0(t,i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}},e)})),G0.apply(this,arguments)}function $0(e,t){return Z0.apply(this,arguments)}function Z0(){return Z0=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=j0(t),e.next=3,z0();case 3:return i=e.sent.transaction(V0,"readwrite"),e.next=6,i.objectStore(V0).put(n,r);case 6:return e.next=8,i.done;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),Z0.apply(this,arguments)}function q0(e){return W0.apply(this,arguments)}function W0(){return W0=TB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=j0(t),e.next=3,z0();case 3:return r=e.sent.transaction(V0,"readwrite"),e.next=6,r.objectStore(V0).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),W0.apply(this,arguments)}function j0(e){return e.appConfig.appId}var Y0=new XB("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function K0(e,t){return Q0.apply(this,arguments)}function Q0(){return Q0=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r2(t);case 2:return i=e.sent,a=a2(n),o={method:"POST",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch(n2(t.appConfig),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),Y0.create("token-subscribe-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw Y0.create("token-subscribe-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw Y0.create("token-subscribe-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),Q0.apply(this,arguments)}function X0(e,t){return J0.apply(this,arguments)}function J0(){return J0=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r2(t);case 2:return i=e.sent,a=a2(n.subscriptionOptions),o={method:"PATCH",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch("".concat(n2(t.appConfig),"/").concat(n.token),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),Y0.create("token-update-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw Y0.create("token-update-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw Y0.create("token-update-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),J0.apply(this,arguments)}function e2(e,t){return t2.apply(this,arguments)}function t2(){return t2=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r2(t);case 2:return e.t0=e.sent,i={method:"DELETE",headers:e.t0},e.prev=4,e.next=7,fetch("".concat(n2(t.appConfig),"/").concat(n),i);case 7:return e.next=9,e.sent.json();case 9:if(!(a=e.sent).error){e.next=12;break}throw Y0.create("token-unsubscribe-failed",{errorInfo:a.error.message});case 12:e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(4),Y0.create("token-unsubscribe-failed",{errorInfo:null===(r=e.t1)||void 0===r?void 0:r.toString()});case 17:case"end":return e.stop()}},e,null,[[4,14]])})),t2.apply(this,arguments)}function n2(e){var t=e.projectId;return"https://fcmregistrations.googleapis.com/v1/projects/".concat(t,"/registrations")}function r2(e){return i2.apply(this,arguments)}function i2(){return i2=TB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appConfig,r=t.installations,e.next=3,r.getToken();case 3:return i=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(i)}));case 5:case"end":return e.stop()}},e)})),i2.apply(this,arguments)}function a2(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==S0&&(a.web.applicationPubKey=i),a}function o2(e){return s2.apply(this,arguments)}function s2(){return s2=TB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v2(t.swRegistration,t.vapidKey);case 2:return n=e.sent,r={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:n.endpoint,auth:x0(n.getKey("auth")),p256dh:x0(n.getKey("p256dh"))},e.next=6,H0(t.firebaseDependencies);case 6:if(!(i=e.sent)){e.next=19;break}if(!g2(i.subscriptionOptions,r)){e.next=10;break}return e.abrupt("return",Date.now()>=i.createTime+6048e5?l2(t,{token:i.token,createTime:Date.now(),subscriptionOptions:r}):i.token);case 10:return e.prev=10,e.next=13,e2(t.firebaseDependencies,i.token);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.warn(e.t0);case 18:case 19:return e.abrupt("return",h2(t.firebaseDependencies,r));case 20:case"end":return e.stop()}},e,null,[[10,15]])})),s2.apply(this,arguments)}function u2(e){return c2.apply(this,arguments)}function c2(){return c2=TB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H0(t.firebaseDependencies);case 2:if(n=e.sent,e.t0=n,!e.t0){e.next=9;break}return e.next=7,e2(t.firebaseDependencies,n.token);case 7:return e.next=9,q0(t.firebaseDependencies);case 9:return e.next=11,t.swRegistration.pushManager.getSubscription();case 11:return r=e.sent,e.abrupt("return",!r||r.unsubscribe());case 13:case"end":return e.stop()}},e)})),c2.apply(this,arguments)}function l2(e,t){return f2.apply(this,arguments)}function f2(){return f2=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X0(t.firebaseDependencies,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{token:r,createTime:Date.now()}),e.next=7,$0(t.firebaseDependencies,i);case 7:return e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,u2(t);case 14:throw e.t0;case 15:case"end":return e.stop()}},e,null,[[0,10]])})),f2.apply(this,arguments)}function h2(e,t){return d2.apply(this,arguments)}function d2(){return d2=TB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K0(t,n);case 2:return e.t0=e.sent,e.t1=Date.now(),e.t2=n,r={token:e.t0,createTime:e.t1,subscriptionOptions:e.t2},e.next=8,$0(t,r);case 8:return e.abrupt("return",r.token);case 9:case"end":return e.stop()}},e)})),d2.apply(this,arguments)}function v2(e,t){return p2.apply(this,arguments)}function p2(){return p2=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:R0(n)});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)})),p2.apply(this,arguments)}function g2(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function y2(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i)}}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){var n,r,i,a,o;if(t.fcmOptions||(null===(n=t.notification)||void 0===n?void 0:n.click_action)){e.fcmOptions={};var s=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(a=t.notification)||void 0===a?void 0:a.click_action;s&&(e.fcmOptions.link=s);var u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(e.fcmOptions.analyticsLabel=u)}}(t,e),t}function m2(e){return"object"==typeof e&&!!e&&O0 in e}function k2(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function C2(e){return Y0.create("missing-app-config-values",{valueName:e})}k2("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),k2("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var w2=function(){function e(t,n,r){gy(this,e),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var i=function(e){if(!e||!e.options)throw C2("App Configuration Object");if(!e.name)throw C2("App Name");for(var t=e.options,n=0,r=["projectId","apiKey","appId","messagingSenderId"];n<r.length;n++){var i=r[n];if(!t[i])throw C2(i)}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:n,analyticsProvider:r}}return my(e,[{key:"_delete",value:function(){return Promise.resolve()}}]),e}();function _2(e){return E2.apply(this,arguments)}function E2(){return E2=TB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register(b0,{scope:P0});case 3:t.swRegistration=e.sent,t.swRegistration.update().catch(function(){}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),Y0.create("failed-service-worker-registration",{browserErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),E2.apply(this,arguments)}function b2(e,t){return P2.apply(this,arguments)}function P2(){return P2=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!n&&!t.swRegistration,!e.t0){e.next=4;break}return e.next=4,_2(t);case 4:if(!n&&t.swRegistration){e.next=8;break}if(n instanceof ServiceWorkerRegistration){e.next=7;break}throw Y0.create("invalid-sw-registration");case 7:t.swRegistration=n;case 8:case"end":return e.stop()}},e)})),P2.apply(this,arguments)}function S2(e,t){return O2.apply(this,arguments)}function O2(){return O2=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n?t.vapidKey=n:t.vapidKey||(t.vapidKey=S0);case 1:case"end":return e.stop()}},e)})),O2.apply(this,arguments)}function T2(){return T2=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw Y0.create("only-available-in-window");case 2:if(e.t0="default"===Notification.permission,!e.t0){e.next=6;break}return e.next=6,Notification.requestPermission();case 6:if("granted"===Notification.permission){e.next=8;break}throw Y0.create("permission-blocked");case 8:return e.next=10,S2(t,null==n?void 0:n.vapidKey);case 10:return e.next=12,b2(t,null==n?void 0:n.serviceWorkerRegistration);case 12:return e.abrupt("return",o2(t));case 13:case"end":return e.stop()}},e)})),T2.apply(this,arguments)}function I2(e,t,n){return A2.apply(this,arguments)}function A2(){return A2=TB(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=M2(n),e.next=3,t.firebaseDependencies.analyticsProvider.get();case 3:e.sent.logEvent(i,{message_id:r[O0],message_name:r[T0],message_time:r[I0],message_device_time:Math.floor(Date.now()/1e3)});case 4:case"end":return e.stop()}},e)})),A2.apply(this,arguments)}function M2(e){switch(e){case M0.NOTIFICATION_CLICKED:return"notification_open";case M0.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function x2(){return x2=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.data).isFirebaseMessaging){e.next=3;break}return e.abrupt("return");case 3:if(t.onMessageHandler&&r.messageType===M0.PUSH_RECEIVED&&("function"==typeof t.onMessageHandler?t.onMessageHandler(y2(r)):t.onMessageHandler.next(y2(r))),i=r.data,e.t0=m2(i)&&"1"===i[A0],!e.t0){e.next=9;break}return e.next=9,I2(t,r.messageType,i);case 9:case"end":return e.stop()}},e)})),x2.apply(this,arguments)}var R2="@firebase/messaging";function N2(){return(N2=TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,YB();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",!1);case 8:return e.abrupt("return","undefined"!=typeof window&&jB()&&KB()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"));case 9:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}Zz(new fz("messaging",function(e){var t=new w2(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",function(e){return function(e,t){return x2.apply(this,arguments)}(t,e)}),t},"PUBLIC")),Zz(new fz("messaging-internal",function(e){var t=e.getProvider("messaging").getImmediate();return{getToken:function(e){return function(e,t){return T2.apply(this,arguments)}(t,e)}}},"PRIVATE")),Xz(R2,"0.9.16"),Xz(R2,"0.9.16","esm2017");var D2="analytics",L2="firebase_id",F2="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",U2="https://www.googletagmanager.com/gtag/js",V2=new wz("@firebase/analytics");function B2(e){return Promise.all(e.map(function(e){return e.catch(function(e){return e})}))}function z2(e,t){var n=document.createElement("script");n.src="".concat(U2,"?l=").concat(e,"&id=").concat(t),n.async=!0,document.head.appendChild(n)}function H2(e,t,n,r,i,a){return G2.apply(this,arguments)}function G2(){return G2=TB(regeneratorRuntime.mark(function e(t,n,r,i,a,o){var s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i[a],e.prev=1,!s){e.next=7;break}return e.next=5,n[s];case 5:e.next=14;break;case 7:return e.next=9,B2(r);case 9:if(u=e.sent.find(function(e){return e.measurementId===a}),e.t0=u,!e.t0){e.next=14;break}return e.next=14,n[u.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),V2.error(e.t1);case 19:t("config",a,o);case 20:case"end":return e.stop()}},e,null,[[1,16]])})),G2.apply(this,arguments)}function $2(e,t,n,r,i){return Z2.apply(this,arguments)}function Z2(){return Z2=TB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,u,c,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=[],!a||!a.send_to){e.next=26;break}return s=a.send_to,Array.isArray(s)||(s=[s]),e.next=7,B2(r);case 7:u=e.sent,c=dy(s),e.prev=9,f=function(){var e=l.value,t=u.find(function(t){return t.measurementId===e}),r=t&&n[t.appId];if(!r)return o=[],"break";o.push(r)},c.s();case 12:if((l=c.n()).done){e.next=18;break}if("break"!==f()){e.next=16;break}return e.abrupt("break",18);case 16:e.next=12;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return 0===o.length&&(o=Object.values(n)),e.next=29,Promise.all(o);case 29:t("event",i,a||{}),e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),V2.error(e.t1);case 35:case"end":return e.stop()}},e,null,[[0,32],[9,20,23,26]])})),Z2.apply(this,arguments)}function q2(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(U2))return r}return null}var W2=new XB("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),j2=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;gy(this,e),this.throttleMetadata=t,this.intervalMillis=n}return my(e,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),e}());function Y2(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function K2(e){return Q2.apply(this,arguments)}function Q2(){return Q2=TB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appId,i=t.apiKey,a={method:"GET",headers:Y2(i)},o=F2.replace("{app-id}",r),e.next=6,fetch(o,a);case 6:if(200===(s=e.sent).status||304===s.status){e.next=19;break}return u="",e.prev=9,e.next=12,s.json();case 12:c=e.sent,(null===(n=c.error)||void 0===n?void 0:n.message)&&(u=c.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw W2.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 19:return e.abrupt("return",s.json());case 20:case"end":return e.stop()}},e,null,[[9,16]])})),Q2.apply(this,arguments)}function X2(e){return J2.apply(this,arguments)}function J2(){return J2=TB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:j2,r=l.length>2?l[2]:void 0,i=t.options,a=i.appId,o=i.apiKey,s=i.measurementId,a){e.next=5;break}throw W2.create("no-app-id");case 5:if(o){e.next=9;break}if(!s){e.next=8;break}return e.abrupt("return",{measurementId:s,appId:a});case 8:throw W2.create("no-api-key");case 9:return u=n.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new o3,e.abrupt("return",(setTimeout(TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.abort();case 1:case"end":return e.stop()}},e)})),void 0!==r?r:6e4),e3({appId:a,apiKey:o,measurementId:s},u,c,n)));case 11:case"end":return e.stop()}},e)})),J2.apply(this,arguments)}function e3(e,t,n){return t3.apply(this,arguments)}function t3(){return t3=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d,v,p=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.throttleEndTimeMillis,a=n.backoffCount,o=p.length>3&&void 0!==p[3]?p[3]:j2,c=t.appId,l=t.measurementId,e.prev=3,e.next=6,n3(r,i);case 6:e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(3),!l){e.next=12;break}return e.abrupt("return",(V2.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null===(s=e.t0)||void 0===s?void 0:s.message,"]")),{appId:c,measurementId:l}));case 12:throw e.t0;case 13:return e.prev=13,e.next=16,K2(t);case 16:return f=e.sent,e.abrupt("return",(o.deleteThrottleMetadata(c),f));case 20:if(e.prev=20,e.t1=e.catch(13),r3(h=e.t1)){e.next=27;break}if(o.deleteThrottleMetadata(c),!l){e.next=26;break}return e.abrupt("return",(V2.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null==h?void 0:h.message,"]")),{appId:c,measurementId:l}));case 26:throw e.t1;case 27:return d=503===Number(null===(u=null==h?void 0:h.customData)||void 0===u?void 0:u.httpStatus)?sz(a,o.intervalMillis,30):sz(a,o.intervalMillis),v={throttleEndTimeMillis:Date.now()+d,backoffCount:a+1},e.abrupt("return",(o.setThrottleMetadata(c,v),V2.debug("Calling attemptFetch again in ".concat(d," millis")),e3(t,v,r,o)));case 29:case"end":return e.stop()}},e,null,[[3,8],[13,20]])})),t3.apply(this,arguments)}function n3(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(W2.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function r3(e){if(!(e instanceof QB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var i3,a3,o3=function(){function e(){gy(this,e),this.listeners=[]}return my(e,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach(function(e){return e()})}}]),e}();function s3(){return s3=TB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=4;break}t("event",r,i),e.next=8;break;case 4:return e.next=6,n;case 6:o=e.sent,t("event",r,Object.assign(Object.assign({},i),{send_to:o}));case 8:case"end":return e.stop()}},e)})),s3.apply(this,arguments)}function u3(e){a3=e}function c3(e){i3=e}function l3(){return f3.apply(this,arguments)}function f3(){return f3=TB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(jB()){e.next=2;break}return e.abrupt("return",(V2.warn(W2.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1));case 2:return e.prev=2,e.next=5,YB();case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",(V2.warn(W2.create("indexeddb-unavailable",{errorInfo:null===(t=e.t0)||void 0===t?void 0:t.toString()}).message),!1));case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,null,[[2,7]])})),f3.apply(this,arguments)}function h3(){return h3=TB(regeneratorRuntime.mark(function e(t,n,r,i,a,o,s){var u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(c=X2(t)).then(function(e){r[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&V2.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,") does not match the measurement ID fetched from the server (").concat(e.measurementId,"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config."))}).catch(function(e){return V2.error(e)}),n.push(c),l=l3().then(function(e){if(e)return i.getId()}),e.next=5,Promise.all([c,l]);case 5:return f=e.sent,h=Qg(f,2),d=h[0],v=h[1],q2()||z2(o,d.measurementId),a3&&(a("consent","default",a3),u3(void 0)),a("js",new Date),p=null!==(u=null==s?void 0:s.config)&&void 0!==u?u:{},e.abrupt("return",(p.origin="firebase",p.update=!0,null!=v&&(p[L2]=v),a("config",d.measurementId,p),i3&&(a("set",i3),c3(void 0)),d.measurementId));case 12:case"end":return e.stop()}},e)})),h3.apply(this,arguments)}var d3,v3,p3=function(){function e(t){gy(this,e),this.app=t}return my(e,[{key:"_delete",value:function(){return delete g3[this.app.options.appId],Promise.resolve()}}]),e}(),g3={},y3=[],m3={},k3="dataLayer",C3=!1;function w3(){return(w3=TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!ZB()&&KB()&&jB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,YB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var _3="@firebase/analytics";Zz(new fz(D2,function(e,t){var n=t.options;return function(e,t,n){!function(){var e=[];if(ZB()&&e.push("This is a browser extension environment."),KB()||e.push("Cookies are not available."),e.length>0){var t=e.map(function(e,t){return"(".concat(t+1,") ").concat(e)}).join(" "),n=W2.create("invalid-analytics-context",{errorInfo:t});V2.warn(n.message)}}();var r=e.options.appId;if(!r)throw W2.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw W2.create("no-api-key");V2.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '.concat(e.options.measurementId,' provided in the "measurementId" field in the local Firebase config.'))}if(null!=g3[r])throw W2.create("already-exists",{id:r});if(!C3){!function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(k3);var i=function(e,t,n,r,i){var a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(a=window[i]),window[i]=function(e,t,n,r){function i(){return(i=TB(regeneratorRuntime.mark(function i(a,o,s){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,"event"!==a){i.next=6;break}return i.next=4,$2(e,t,n,o,s);case 4:i.next=12;break;case 6:if("config"!==a){i.next=11;break}return i.next=9,H2(e,t,n,r,o,s);case 9:i.next=12;break;case 11:"consent"===a?e("consent","update",s):e("set",o);case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),V2.error(i.t0);case 17:case"end":return i.stop()}},i,null,[[0,14]])}))).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(g3,y3,m3,k3,"gtag"),a=i.wrappedGtag,o=i.gtagCore;v3=a,d3=o,C3=!0}return g3[r]=function(e,t,n,r,i,a,o){return h3.apply(this,arguments)}(e,y3,m3,t,d3,k3,n),new p3(e)}(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),Zz(new fz("analytics-internal",function(e){try{var t=e.getProvider(D2).getImmediate();return{logEvent:function(e,n,r){return function(e,t,n,r){e=uz(e),function(e,t,n,r,i){return s3.apply(this,arguments)}(v3,g3[e.app.options.appId],t,n,r).catch(function(e){return V2.error(e)})}(t,e,n,r)}}}catch(t){throw W2.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),Xz(_3,"0.8.0"),Xz(_3,"0.8.0","esm2017");var E3=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this)}return my(n,[{key:"schedule",value:function(e){return this}}]),n}(yy),b3={setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=b3.delegate;return((null==e?void 0:e.setInterval)||setInterval).apply(void 0,arguments)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=b3.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)}),delegate:void 0},P3=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return my(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return b3.setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!=n&&this.delay===n&&!1===this.pending)return t;b3.clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}},{key:"unsubscribe",value:function(){if(!this.closed){var e=this.id,t=this.scheduler,r=t.actions;this.work=this.state=this.scheduler=null,this.pending=!1,py(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,ny(ly(n.prototype),"unsubscribe",this).call(this)}}}]),n}(E3),S3={now:function(){return(S3.delegate||Date).now()},delegate:void 0},O3=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;gy(this,e),this.schedulerActionCtor=t,this.now=n}return my(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.schedulerActionCtor(this,e).schedule(n,t)}}]),e}();O3.now=S3.now;var T3=function(e){iy(n,e);var t=oy(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O3.now;return gy(this,n),(r=t.call(this,e,i)).actions=[],r._active=!1,r._scheduled=void 0,r}return my(n,[{key:"flush",value:function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(O3),I3=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n)}(T3))(function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return my(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?ny(ly(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?ny(ly(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=r&&r>0||null==r&&this.delay>0?ny(ly(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(P3)),A3=new T3(P3),M3=new VO("7.4.1"),x3="__angularfire_symbol__analyticsIsSupportedValue",R3="__angularfire_symbol__analyticsIsSupported",N3="__angularfire_symbol__remoteConfigIsSupportedValue",D3="__angularfire_symbol__remoteConfigIsSupported",L3="__angularfire_symbol__messagingIsSupportedValue",F3="__angularfire_symbol__messagingIsSupported";function U3(e,t,n){if(t){if(1===t.length)return t[0];var r=t.filter(function(e){return e.app===n});if(1===r.length)return r[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[R3]||(globalThis[R3]=function(){return w3.apply(this,arguments)}().then(function(e){return globalThis[x3]=e}).catch(function(){return globalThis[x3]=!1})),globalThis[F3]||(globalThis[F3]=function(){return N2.apply(this,arguments)}().then(function(e){return globalThis[L3]=e}).catch(function(){return globalThis[L3]=!1})),globalThis[D3]||(globalThis[D3]=function(){return E0.apply(this,arguments)}().then(function(e){return globalThis[N3]=e}).catch(function(){return globalThis[N3]=!1}));var V3=function(e,t){var n=t?[t]:Qz(),r=[];return n.forEach(function(t){t.container.getProvider(e).instances.forEach(function(e){r.includes(e)||r.push(e)})}),r};function B3(){}var z3=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I3;gy(this,e),this.zone=t,this.delegate=n}return my(e,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(e,t,n){var r=this.zone;return this.delegate.schedule(function(t){var n=this;r.runGuarded(function(){e.apply(n,[t])})},t,n)}}]),e}(),H3=function(){function e(t){gy(this,e),this.zone=t,this.task=null}return my(e,[{key:"call",value:function(e,t){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",B3,{},B3,B3)}),t.pipe(zN({next:n,complete:n,error:n})).subscribe(e).add(n)}},{key:"unscheduleTask",value:function(){var e=this;setTimeout(function(){null!=e.task&&"scheduled"===e.task.state&&(e.task.invoke(),e.task=null)},10)}}]),e}(),G3=function(){var e=my(function e(t){gy(this,e),this.ngZone=t,this.outsideAngular=t.runOutsideAngular(function(){return new z3(Zone.current)}),this.insideAngular=t.run(function(){return new z3(Zone.current,A3)}),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)});return e.\u0275fac=function(t){return new(t||e)(Bw(EI))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function $3(){var e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function Z3(e){return $3().ngZone.runOutsideAngular(function(){return e()})}function q3(e){return $3().ngZone.run(function(){return e()})}function W3(e){return $3(),function(e){return function(t){return(t=t.lift(new H3(e.ngZone))).pipe(Cm(e.outsideAngular),km(e.insideAngular))}}($3())(e)}var j3=function(e,t){var n=void 0;return function(){var r=arguments;return t&&setTimeout(function(){"scheduled"===t.state&&t.invoke()},10),q3(function(){return e.apply(n,r)})}},Y3=function(e,t){return function(){for(var n,r=this,i=arguments,a=0;a<arguments.length;a++)"function"==typeof i[a]&&(t&&(n||(n=q3(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",B3,{},B3,B3)}))),i[a]=j3(i[a],n));var o=Z3(function(){return e.apply(r,i)});if(!t){if(o instanceof Hy){var s=$3();return o.pipe(Cm(s.outsideAngular),km(s.insideAngular))}return q3(function(){return o})}return o instanceof Hy?o.pipe(W3):o instanceof Promise?q3(function(){return new Promise(function(e,t){return o.then(function(t){return q3(function(){return e(t)})},function(e){return q3(function(){return t(e)})})})}):"function"==typeof o&&n?function(){return setTimeout(function(){n&&"scheduled"===n.state&&n.invoke()},10),o.apply(this,arguments)}:q3(function(){return o})}},K3=my(function e(t){return gy(this,e),t}),Q3=my(function e(){return gy(this,e),Qz()}),X3=new Cw("angularfire2._apps"),J3={provide:K3,useFactory:function(e){return e&&1===e.length?e[0]:new K3(Kz())},deps:[[new jw,X3]]},e4={provide:Q3,deps:[[new jw,X3]]};function t4(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new K3(r)}}var n4=function(){var e=my(function e(t){gy(this,e),Xz("angularfire",M3.full,"core"),Xz("angularfire",M3.full,"app"),Xz("angular",BO.full,t.toString())});return e.\u0275fac=function(t){return new(t||e)(Bw(uI))},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({providers:[J3,e4]}),e}(),r4=Y3(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"!=typeof t&&(t={name:t});var n=Object.assign({name:Bz,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw Wz.create("bad-app-name",{appName:String(r)});var i=Hz.get(r);if(i){if(ez(e,i.options)&&ez(n,i.config))return i;throw Wz.create("duplicate-app",{appName:r})}var a,o=new vz(r),s=dy(Gz.values());try{for(s.s();!(a=s.n()).done;){var u=a.value;o.addComponent(u)}}catch(l){s.e(l)}finally{s.f()}var c=new jz(e,n,o);return Hz.set(r,c),c},!0),i4=new Map,a4={activated:!1,tokenObservers:[]},o4={initialized:!1,enabled:!1};function s4(e){return i4.get(e)||a4}function u4(e,t){i4.set(e,t)}function c4(){return o4}var l4=function(){function e(t,n,r,i,a){if(gy(this,e),this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}return my(e,[{key:"start",value:function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(function(){})}},{key:"stop",value:function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}},{key:"isRunning",value:function(){return!!this.pending}},{key:"process",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stop(),n.prev=1,t.pending=new HB,n.next=5,function(e){return new Promise(function(t){setTimeout(t,e)})}(t.getNextRun(e));case 5:return t.pending.resolve(),n.next=8,t.pending.promise;case 8:return t.pending=new HB,n.next=11,t.operation();case 11:return t.pending.resolve(),n.next=14,t.pending.promise;case 14:t.process(!0).catch(function(){}),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(1),t.retryPolicy(n.t0)?t.process(!1).catch(function(){}):t.stop();case 20:case"end":return n.stop()}},n,null,[[1,17]])}))()}},{key:"getNextRun",value:function(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}]),e}(),f4=new XB("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function h4(e){if(!s4(e).activated)throw f4.create("use-before-activation",{appName:e.name})}function d4(e,t){return v4.apply(this,arguments)}function v4(){return v4=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,i=t.body,s={"Content-Type":"application/json"},!(u=n.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,u.getHeartbeatsHeader();case 5:(c=e.sent)&&(s["X-Firebase-Client"]=c);case 7:return l={method:"POST",body:JSON.stringify(i),headers:s},e.prev=8,e.next=11,fetch(r,l);case 11:f=e.sent,e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(8),f4.create("fetch-network-error",{originalErrorMessage:null===(a=e.t0)||void 0===a?void 0:a.message});case 17:if(200===f.status){e.next=19;break}throw f4.create("fetch-status-error",{httpStatus:f.status});case 19:return e.prev=19,e.next=22,f.json();case 22:h=e.sent,e.next=28;break;case 25:throw e.prev=25,e.t1=e.catch(19),f4.create("fetch-parse-error",{originalErrorMessage:null===(o=e.t1)||void 0===o?void 0:o.message});case 28:if((d=h.ttl.match(/^([\d.]+)(s)$/))&&d[2]&&!isNaN(Number(d[1]))){e.next=31;break}throw f4.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: ".concat(h.ttl)});case 31:return v=1e3*Number(d[1]),p=Date.now(),e.abrupt("return",{token:h.token,expireTimeMillis:p+v,issuedAtTimeMillis:p});case 33:case"end":return e.stop()}},e,null,[[8,14],[19,25]])})),v4.apply(this,arguments)}function p4(e,t){var n=e.options,r=n.projectId,i=n.appId,a=n.apiKey;return{url:"https://content-firebaseappcheck.googleapis.com/v1/projects/".concat(r,"/apps/").concat(i,":exchangeDebugToken?key=").concat(a),body:{debug_token:t}}}var g4="firebase-app-check-store",y4=null;function m4(){return y4||(y4=new Promise(function(e,t){var n;try{var r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=function(t){e(t.target.result)},r.onerror=function(e){var n;t(f4.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},r.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(g4,{keyPath:"compositeKey"})}}catch(r){t(f4.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}}),y4)}function k4(){return k4=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m4();case 2:return r=e.sent.transaction(g4,"readwrite"),i=r.objectStore(g4).put({compositeKey:t,value:n}),e.abrupt("return",new Promise(function(e,t){i.onsuccess=function(t){e()},r.onerror=function(e){var n;t(f4.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}));case 5:case"end":return e.stop()}},e)})),k4.apply(this,arguments)}var C4=new wz("@firebase/app-check");function w4(e,t){return jB()?function(e,t){return function(e,t){return k4.apply(this,arguments)}(function(e){return"".concat(e.options.appId,"-").concat(e.name)}(e),t)}(e,t).catch(function(e){C4.warn("Failed to write token to IndexedDB. Error: ".concat(e))}):Promise.resolve()}function _4(){return c4().enabled}function E4(){return b4.apply(this,arguments)}function b4(){return b4=TB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=c4()).enabled||!t.token){e.next=3;break}return e.abrupt("return",t.token.promise);case 3:throw Error("\n            Can't get debug token in production mode.\n        ");case 4:case"end":return e.stop()}},e)})),b4.apply(this,arguments)}var P4={error:"UNKNOWN_ERROR"};function S4(e){return BB.encodeString(JSON.stringify(e),!1)}function O4(e){return T4.apply(this,arguments)}function T4(){return T4=TB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]&&f[1],h4(r=t.app),i=s4(r),o=i.token){e.next=10;break}return e.next=8,i.cachedTokenPromise;case 8:(s=e.sent)&&x4(s)&&(o=s);case 10:if(n||!o||!x4(o)){e.next=12;break}return e.abrupt("return",{token:o.token});case 12:if(c=!1,!_4()){e.next=33;break}if(e.t0=i.exchangeTokenPromise,e.t0){e.next=26;break}return e.t1=d4,e.t2=p4,e.t3=r,e.next=21,E4();case 21:e.t4=e.sent,e.t5=(0,e.t2)(e.t3,e.t4),e.t6=t.heartbeatServiceProvider,i.exchangeTokenPromise=(0,e.t1)(e.t5,e.t6).then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0;case 26:return e.next=28,i.exchangeTokenPromise;case 28:return l=e.sent,e.next=31,w4(r,l);case 31:return u4(r,Object.assign(Object.assign({},i),{token:l})),e.abrupt("return",{token:l.token});case 33:return e.prev=33,i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0),e.next=37,i.exchangeTokenPromise;case 37:o=e.sent,e.next=43;break;case 40:e.prev=40,e.t7=e.catch(33),"appCheck/throttled"===e.t7.code?C4.warn(e.t7.message):C4.error(e.t7),a=e.t7;case 43:if(!o){e.next=50;break}return u={token:o.token},u4(r,Object.assign(Object.assign({},i),{token:o})),e.next=48,w4(r,o);case 48:e.next=51;break;case 50:u=R4(a);case 51:return c&&M4(r,u),e.abrupt("return",u);case 53:case"end":return e.stop()}},e,null,[[33,40]])})),T4.apply(this,arguments)}function I4(e,t){var n=s4(e),r=n.tokenObservers.filter(function(e){return e.next!==t});0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),u4(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function A4(e){var t=e.app,n=s4(t),r=n.tokenRefresher;r||(r=function(e){var t=e.app;return new l4(TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!s4(t).token){n.next=6;break}return n.next=3,O4(e,!0);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,O4(e);case 8:n.t0=n.sent;case 9:if(!(r=n.t0).error){n.next=12;break}throw r.error;case 12:case"end":return n.stop()}},n)})),function(){return!0},function(){var e=s4(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,e.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(e),u4(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function M4(e,t){var n,r=dy(s4(e).tokenObservers);try{for(r.s();!(n=r.n()).done;){var i=n.value;try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch(a){}}}catch(o){r.e(o)}finally{r.f()}}function x4(e){return e.expireTimeMillis-Date.now()>0}function R4(e){return{token:S4(P4),error:e}}var N4=function(){function e(t,n){gy(this,e),this.app=t,this.heartbeatServiceProvider=n}return my(e,[{key:"_delete",value:function(){var e,t=dy(s4(this.app).tokenObservers);try{for(t.s();!(e=t.n()).done;){var n=e.value;I4(this.app,n.next)}}catch(r){t.e(r)}finally{t.f()}return Promise.resolve()}}]),e}(),D4="app-check-internal";Zz(new fz("app-check",function(e){return function(e,t){return new N4(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("heartbeat"))},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider(D4).initialize()})),Zz(new fz(D4,function(e){return function(e){return{getToken:function(t){return O4(e,t)},addTokenListener:function(t){return function(e,t,n,r){var i=e.app,a=s4(i),o={next:n,error:void 0,type:"INTERNAL"};if(u4(i,Object.assign(Object.assign({},a),{tokenObservers:[].concat(fy(a.tokenObservers),[o])})),a.token&&x4(a.token)){var s=a.token;Promise.resolve().then(function(){n({token:s.token}),A4(e)}).catch(function(){})}a.cachedTokenPromise.then(function(){return A4(e)})}(e,0,t)},removeTokenListener:function(t){return I4(e.app,t)}}}(e.getProvider("app-check").getImmediate())},"PUBLIC").setInstantiationMode("EXPLICIT")),Xz("@firebase/app-check","0.5.11");var L4=my(function e(){return gy(this,e),V3("app-check")});"undefined"!=typeof window&&window;var F4=new XB("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),U4=new wz("@firebase/auth");function V4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];U4.logLevel<=gz.ERROR&&U4.error.apply(U4,["Auth (9.9.0): ".concat(e)].concat(n))}function B4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw $4.apply(void 0,[e].concat(n))}function z4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return $4.apply(void 0,[e].concat(n))}function H4(e,t,n){var r=Object.assign(Object.assign({},{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Kg({},t,n));return new XB("auth","Firebase",r).create(t,{appName:e.name})}function G4(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&B4(e,"argument-error"),H4(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.Did you pass a reference from a different Auth SDK?"))}function $4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!=typeof e){var i,a=n[0],o=fy(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(fy(o)))}return F4.create.apply(F4,[e].concat(n))}function Z4(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e)throw $4.apply(void 0,[t].concat(r))}function q4(e){var t="INTERNAL ASSERTION FAILED: "+e;throw V4(t),new Error(t)}function W4(e,t){e||q4(t)}var j4=new Map;function Y4(e){W4(e instanceof Function,"Expected a class definition");var t=j4.get(e);return t?(W4(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,j4.set(e,t),t)}function K4(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Q4(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var X4=function(){function e(t,n){gy(this,e),this.shortDelay=t,this.longDelay=n,W4(n>t,"Short delay should be less than long delay!"),this.isMobile=$B()||qB()}return my(e,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Q4()||"https:"===Q4()||ZB()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function J4(e,t){W4(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var e5=function(){function e(){gy(this,e)}return my(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void q4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void q4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void q4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),t5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},n5=new X4(3e4,6e4);function r5(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function i5(e,t,n,r){return a5.apply(this,arguments)}function a5(){return a5=TB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",o5(t,a,TB(regeneratorRuntime.mark(function e(){var a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),s=nz(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=5,t._getAdditionalHeaders();case 5:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),e5.fetch()(l5(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},a))));case 7:case"end":return e.stop()}},e)}))));case 2:case"end":return e.stop()}},e)})),a5.apply(this,arguments)}function o5(e,t,n){return s5.apply(this,arguments)}function s5(){return s5=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},t5),n),e.prev=2,a=new f5(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw h5(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=15;break}return e.abrupt("return",s);case 15:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),l=Qg(c,2),f=l[0],h=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){e.next=18;break}throw h5(t,"credential-already-in-use",s);case 18:if("EMAIL_EXISTS"!==f){e.next=20;break}throw h5(t,"email-already-in-use",s);case 20:if("USER_DISABLED"!==f){e.next=22;break}throw h5(t,"user-disabled",s);case 22:if(d=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!h){e.next=25;break}throw H4(t,d,h);case 25:B4(t,d),e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(2),!(e.t0 instanceof QB)){e.next=32;break}throw e.t0;case 32:B4(t,"network-request-failed");case 33:case"end":return e.stop()}},e,null,[[2,28]])})),s5.apply(this,arguments)}function u5(e,t,n,r){return c5.apply(this,arguments)}function c5(){return c5=TB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,i5(t,n,r,i,a);case 3:return o=e.sent,e.abrupt("return",("mfaPendingCredential"in o&&B4(t,"multi-factor-auth-required",{_serverResponse:o}),o));case 5:case"end":return e.stop()}},e)})),c5.apply(this,arguments)}function l5(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?J4(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var f5=function(){function e(t){var n=this;gy(this,e),this.auth=t,this.timer=null,this.promise=new Promise(function(e,t){n.timer=setTimeout(function(){return t(z4(n.auth,"network-request-failed"))},n5.get())})}return my(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function h5(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=z4(e,t,r);return i.customData._tokenResponse=n,i}function d5(){return d5=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i5(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}},e)})),d5.apply(this,arguments)}function v5(e,t){return p5.apply(this,arguments)}function p5(){return p5=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i5(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}},e)})),p5.apply(this,arguments)}function g5(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function y5(){return y5=TB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=uz(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,Z4((a=k5(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"==typeof a.firebase?a.firebase:void 0,s=null==o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:g5(m5(a.auth_time)),issuedAtTime:g5(m5(a.iat)),expirationTime:g5(m5(a.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null});case 9:case"end":return e.stop()}},e)})),y5.apply(this,arguments)}function m5(e){return 1e3*Number(e)}function k5(e){var t,n=Qg(e.split("."),3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return V4("JWT malformed, contained fewer than 3 sections"),null;try{var o=function(e){try{return BB.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(i);return o?JSON.parse(o):(V4("Failed to decode base64 JWT payload"),null)}catch(s){return V4("Caught error parsing JWT payload as JSON",null===(t=s)||void 0===t?void 0:t.toString()),null}}function C5(e,t){return w5.apply(this,arguments)}function w5(){return w5=TB(regeneratorRuntime.mark(function e(t,n){var r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),e.t1=e.t0 instanceof QB&&_5(e.t0)&&t.auth.currentUser===t,!e.t1){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}},e,null,[[3,9]])})),w5.apply(this,arguments)}function _5(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}var E5=function(){function e(t){gy(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return my(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(this.isRunning){var n=this.getInterval(e);this.timerId=setTimeout(TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.iteration();case 2:case"end":return e.stop()}},e)})),n)}}},{key:"iteration",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.user.getIdToken(!0);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",void("auth/network-request-failed"===(null===(n=t.t0)||void 0===n?void 0:n.code)&&e.schedule(!0)));case 8:e.schedule();case 9:case"end":return t.stop()}},t,null,[[0,5]])}))()}}]),e}(),b5=function(){function e(t,n){gy(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return my(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=g5(this.lastLoginAt),this.creationTime=g5(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function P5(e){return S5.apply(this,arguments)}function S5(){return S5=TB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,C5(t,v5(r,{idToken:i}));case 6:Z4(null==(a=e.sent)?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?I5(o.providerUserInfo):[],u=T5(t.providerData,s),c=!!t.isAnonymous&&!(t.email&&o.passwordHash||(null==u?void 0:u.length)),l={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new b5(o.createdAt,o.lastLoginAt),isAnonymous:c},Object.assign(t,l);case 12:case"end":return e.stop()}},e)})),S5.apply(this,arguments)}function O5(){return O5=TB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=uz(t),e.next=3,P5(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}},e)})),O5.apply(this,arguments)}function T5(e,t){return[].concat(fy(e.filter(function(e){return!t.some(function(t){return t.providerId===e.providerId})})),fy(t))}function I5(e){return e.map(function(e){var t=e.providerId,n=Qy(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function A5(){return A5=TB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o5(t,{},TB(regeneratorRuntime.mark(function e(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=nz({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,s=l5(t,a,"/v1/token","key=".concat(o)),e.next=7,t._getAdditionalHeaders();case 7:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/x-www-form-urlencoded",e5.fetch()(s,{method:"POST",headers:u,body:r})));case 9:case"end":return e.stop()}},e)})));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}},e)})),A5.apply(this,arguments)}var M5=function(){function e(){gy(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return my(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){Z4(e.idToken,"internal-error"),Z4(void 0!==e.idToken,"internal-error"),Z4(void 0!==e.refreshToken,"internal-error");var t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){var t=k5(e);return Z4(t,"internal-error"),Z4(void 0!==t.exp,"internal-error"),Z4(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(Z4(!n.accessToken||n.refreshToken,e,"user-token-expired"),!t&&n.accessToken&&!n.isExpired){r.next=12;break}if(!n.refreshToken){r.next=8;break}return r.next=5,n.refresh(e,n.refreshToken);case 5:r.t1=n.accessToken,r.next=9;break;case 8:r.t1=null;case 9:r.t0=r.t1,r.next=13;break;case 12:r.t0=n.accessToken;case 13:return r.abrupt("return",r.t0);case 14:case"end":return r.stop()}},r)}))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e,t){return A5.apply(this,arguments)}(e,t);case 2:i=r.sent,a=i.accessToken,o=i.refreshToken,s=i.expiresIn,n.updateTokensAndExpiration(a,o,Number(s));case 7:case"end":return r.stop()}},r)}))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return q4("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(Z4("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(Z4("string"==typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(Z4("number"==typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function x5(e,t){Z4("string"==typeof e||void 0===e,"internal-error",{appName:t})}var R5=function(){function e(t){gy(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=Qy(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new E5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?fy(a.providerData):[],this.metadata=new b5(a.createdAt||void 0,a.lastLoginAt||void 0)}return my(e,[{key:"getIdToken",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,C5(t,t.stsTokenManager.getToken(t.auth,e));case 2:if(Z4(r=n.sent,t.auth,"internal-error"),n.t0=t.accessToken!==r,!n.t0){n.next=10;break}return t.accessToken=r,n.next=9,t.auth._persistUserIfCurrent(t);case 9:t.auth._notifyListenersIfCurrent(t);case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n)}))()}},{key:"getIdTokenResult",value:function(e){return function(e){return y5.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return O5.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(Z4(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(function(e){return Object.assign({},e)}),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){Z4(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!1,e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),r.t0=t,!r.t0){r.next=6;break}return r.next=6,P5(n);case 6:return r.next=8,n.auth._persistUserIfCurrent(n);case 8:i&&n.auth._notifyListenersIfCurrent(n);case 9:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getIdToken();case 2:return n=t.sent,t.next=5,C5(e,function(e,t){return d5.apply(this,arguments)}(e.auth,{idToken:n}));case 5:return e.stsTokenManager.clearRefreshToken(),t.abrupt("return",e.auth.signOut());case 7:case"end":return t.stop()}},t)}))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(e){return Object.assign({},e)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,s,u,c,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,h=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,y=null!==(c=n.createdAt)&&void 0!==c?c:void 0,m=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,C=n.emailVerified,w=n.isAnonymous,_=n.providerData,E=n.stsTokenManager;Z4(k&&E,t,"internal-error");var b=M5.fromJSON(this.name,E);Z4("string"==typeof k,t,"internal-error"),x5(f,t.name),x5(h,t.name),Z4("boolean"==typeof C,t,"internal-error"),Z4("boolean"==typeof w,t,"internal-error"),x5(d,t.name),x5(v,t.name),x5(p,t.name),x5(g,t.name),x5(y,t.name),x5(m,t.name);var P=new e({uid:k,auth:t,email:h,emailVerified:C,displayName:f,isAnonymous:w,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:b,createdAt:y,lastLoginAt:m});return _&&Array.isArray(_)&&(P.providerData=_.map(function(e){return Object.assign({},e)})),g&&(P._redirectEventId=g),P}},{key:"_fromIdTokenResponse",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return TB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(a=new M5).updateFromServerResponse(n),o=new e({uid:n.localId,auth:t,stsTokenManager:a,isAnonymous:r}),i.next=5,P5(o);case 5:return i.abrupt("return",o);case 6:case"end":return i.stop()}},i)}))()}}]),e}(),N5=function(){var e=function(){function e(){gy(this,e),this.type="NONE",this.storage={}}return my(e,[{key:"_isAvailable",value:function(){return TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}))()}},{key:"_set",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n.storage[e]=t;case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.storage[e],n.abrupt("return",void 0===r?null:r);case 2:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:delete t.storage[e];case 1:case"end":return n.stop()}},n)}))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();return e.type="NONE",e}();function D5(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var L5=function(){function e(t,n,r){gy(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=D5(this.userKey,a.apiKey,o),this.fullPersistenceKey=D5("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return my(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.persistence._get(e.fullUserKey);case 2:return n=t.sent,t.abrupt("return",n?R5._fromJSON(e.auth,n):null);case 4:case"end":return t.stop()}},t)}))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.persistence!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.getCurrentUser();case 4:return r=n.sent,n.next=7,t.removeCurrentUser();case 7:return t.persistence=e,n.abrupt("return",r?t.setCurrentUser(r):void 0);case 9:case"end":return n.stop()}},n)}))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return TB(regeneratorRuntime.mark(function i(){var a,o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n.length){i.next=2;break}return i.abrupt("return",new e(Y4(N5),t,r));case 2:return i.next=4,Promise.all(n.map(function(){var e=TB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:a=i.sent.filter(function(e){return e}),o=a[0]||Y4(N5),s=D5(r,t.config.apiKey,t.name),u=null,c=dy(n),i.prev=9,c.s();case 11:if((l=c.n()).done){i.next=27;break}return f=l.value,i.prev=13,i.next=16,f._get(s);case 16:if(!(h=i.sent)){i.next=21;break}return d=R5._fromJSON(t,h),f!==o&&(u=d),o=f,i.abrupt("break",27);case 21:i.next=25;break;case 23:i.prev=23,i.t0=i.catch(13);case 25:i.next=11;break;case 27:i.next=32;break;case 29:i.prev=29,i.t1=i.catch(9),c.e(i.t1);case 32:return i.prev=32,c.f(),i.finish(32);case 35:if(v=a.filter(function(e){return e._shouldAllowMigration}),!o._shouldAllowMigration||!v.length){i.next=47;break}if(o=v[0],i.t3=u,!i.t3){i.next=42;break}return i.next=42,o._set(s,u.toJSON());case 42:return i.next=44,Promise.all(n.map(function(){var e=TB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()));case 44:i.t2=new e(o,t,r),i.next=48;break;case 47:i.t2=new e(o,t,r);case 48:return i.abrupt("return",i.t2);case 49:case"end":return i.stop()}},i,null,[[9,29,32,35],[13,23]])}))()}}]),e}();function F5(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(z5(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(U5(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(G5(t))return"Blackberry";if($5(t))return"Webos";if(V5(t))return"Safari";if((t.includes("chrome/")||B5(t))&&!t.includes("edge/"))return"Chrome";if(H5(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function U5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB();return/firefox\//i.test(e)}function V5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function B5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB();return/crios\//i.test(e)}function z5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB();return/iemobile/i.test(e)}function H5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB();return/android/i.test(e)}function G5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB();return/blackberry/i.test(e)}function $5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB();return/webos/i.test(e)}function Z5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function q5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB();return Z5(e)||H5(e)||$5(e)||G5(e)||/windows phone/i.test(e)||z5(e)}function W5(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=F5(GB());break;case"Worker":t="".concat(F5(GB()),"-").concat(e);break;default:t=e}return"".concat(t,"/JsCore/9.9.0/").concat(n.length?n.join(","):"FirebaseCore-web")}var j5=function(){function e(t){gy(this,e),this.auth=t,this.queue=[]}return my(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise(function(n,r){try{n(e(t))}catch(i){r(i)}})};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.auth.currentUser!==e){n.next=2;break}return n.abrupt("return");case 2:i=[],n.prev=3,a=dy(t.queue),n.prev=5,a.s();case 7:if((o=a.n()).done){n.next=14;break}return s=o.value,n.next=11,s(e);case 11:s.onAbort&&i.push(s.onAbort);case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(5),a.e(n.t0);case 19:return n.prev=19,a.f(),n.finish(19);case 22:n.next=30;break;case 24:n.prev=24,n.t1=n.catch(3),i.reverse(),u=dy(i);try{for(u.s();!(c=u.n()).done;){l=c.value;try{l()}catch(f){}}}catch(h){u.e(h)}finally{u.f()}throw t.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=n.t1)||void 0===r?void 0:r.message});case 30:case"end":return n.stop()}},n,null,[[3,24],[5,16,19,22]])}))()}}]),e}(),Y5=function(){function e(t,n,r){gy(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Q5(this),this.idTokenSubscription=new Q5(this),this.beforeStateQueue=new j5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=F4,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return my(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=Y4(t)),this._initializationPromise=this.queue(TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!n._deleted,!r.t0){r.next=6;break}return r.next=4,L5.create(n,e);case 4:n.persistenceManager=r.sent,r.t0=!n._deleted;case 6:if(!r.t0){r.next=19;break}if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t1=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted&&(n._isInitialized=!0);case 19:case"end":return r.stop()}},r,null,[[8,13]])}))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._deleted){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.assertedPersistence.getCurrentUser();case 4:if(n=t.sent,!e.currentUser&&!n){t.next=13;break}if(!e.currentUser||!n||e.currentUser.uid!==n.uid){t.next=11;break}return e._currentUser._assign(n),t.next=10,e.currentUser.getIdToken();case 10:return t.abrupt("return",void t.sent);case 11:return t.next=13,e._updateCurrentUser(n,!0);case 13:case"end":return t.stop()}},t)}))()}},{key:"initializeCurrentUser",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.getCurrentUser();case 2:if(i=n.sent,a=i,o=!1,!e||!t.config.authDomain){n.next=13;break}return n.next=7,t.getOrInitRedirectPersistenceManager();case 7:return s=null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId,u=null==a?void 0:a._redirectEventId,n.next=11,t.tryRedirectSignIn(e);case 11:c=n.sent,(!s||s===u)&&(null==c?void 0:c.user)&&(a=c.user,o=!0);case 13:if(a){n.next=15;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 15:if(a._redirectEventId){n.next=26;break}if(!o){n.next=25;break}return n.prev=17,n.next=20,t.beforeStateQueue.runMiddleware(a);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(17),a=i,t._popupRedirectResolver._overrideRedirectResult(t,function(){return Promise.reject(n.t0)});case 25:return n.abrupt("return",a?t.reloadAndSetCurrentUserOrClear(a):t.directlySetCurrentUser(null));case 26:return Z4(t._popupRedirectResolver,t,"argument-error"),n.next=29,t.getOrInitRedirectPersistenceManager();case 29:return n.abrupt("return",t.redirectUser&&t.redirectUser._redirectEventId===a._redirectEventId?t.directlySetCurrentUser(a):t.reloadAndSetCurrentUserOrClear(a));case 30:case"end":return n.stop()}},n,null,[[17,22]])}))()}},{key:"tryRedirectSignIn",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,t._popupRedirectResolver._completeRedirectFn(t,e,!0);case 4:r=n.sent,n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(1),n.next=11,t._setRedirectUser(null);case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}},n,null,[[1,7]])}))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,P5(e);case 3:n.next=9;break;case 5:if(n.prev=5,n.t0=n.catch(0),"auth/network-request-failed"===(null===(r=n.t0)||void 0===r?void 0:r.code)){n.next=9;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 9:return n.abrupt("return",t.directlySetCurrentUser(e));case 10:case"end":return n.stop()}},n,null,[[0,5]])}))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e._deleted=!0;case 1:case"end":return t.stop()}},t)}))()}},{key:"updateCurrentUser",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e?uz(e):null,n.abrupt("return",(r&&Z4(r.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(r&&r._clone(t))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_updateCurrentUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n._deleted){r.next=7;break}if(e&&Z4(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),r.t0=t,r.t0){r.next=6;break}return r.next=6,n.beforeStateQueue.runMiddleware(e);case 6:return r.abrupt("return",n.queue(TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.directlySetCurrentUser(e);case 2:n.notifyAuthListeners();case 3:case"end":return t.stop()}},t)}))));case 7:case"end":return r.stop()}},r)}))()}},{key:"signOut",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.beforeStateQueue.runMiddleware(null);case 2:if(t.t0=e.redirectPersistenceManager||e._popupRedirectResolver,!t.t0){t.next=6;break}return t.next=6,e._setRedirectUser(null);case 6:return t.abrupt("return",e._updateCurrentUser(null,!0));case 7:case"end":return t.stop()}},t)}))()}},{key:"setPersistence",value:function(e){var t=this;return this.queue(TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(Y4(e));case 2:case"end":return n.stop()}},n)})))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new XB("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getOrInitRedirectPersistenceManager(t);case 2:return i=r.sent,r.abrupt("return",null===e?i.removeCurrentUser():i.setCurrentUser(e));case 4:case"end":return r.stop()}},r)}))()}},{key:"getOrInitRedirectPersistenceManager",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.redirectPersistenceManager){n.next=9;break}return Z4(r=e&&Y4(e)||t._popupRedirectResolver,t,"argument-error"),n.next=5,L5.create(t,[Y4(r._redirectPersistence)],"redirectUser");case 5:return t.redirectPersistenceManager=n.sent,n.next=8,t.redirectPersistenceManager.getCurrentUser();case 8:t.redirectUser=n.sent;case 9:return n.abrupt("return",t.redirectPersistenceManager);case 10:case"end":return n.stop()}},n)}))()}},{key:"_redirectUserForId",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t._isInitialized,!n.t0){n.next=4;break}return n.next=4,t.queue(TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})));case 4:return n.abrupt("return",(null===(r=t._currentUser)||void 0===r?void 0:r._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null);case 5:case"end":return n.stop()}},n)}))()}},{key:"_persistUserIfCurrent",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.currentUser){n.next=2;break}return n.abrupt("return",t.queue(TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.directlySetCurrentUser(e));case 1:case"end":return n.stop()}},n)}))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return Z4(o,this,"internal-error"),o.then(function(){return a(i.currentUser)}),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,!e){n.next=7;break}return n.next=5,t.assertedPersistence.setCurrentUser(e);case 5:n.next=9;break;case 7:return n.next=9,t.assertedPersistence.removeCurrentUser();case 9:case"end":return n.stop()}},n)}))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return Z4(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=W5(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={"X-Client-Version":e.clientVersion},e.app.options.appId&&(r["X-Firebase-gmpid"]=e.app.options.appId),t.next=4,null===(n=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===n?void 0:n.getHeartbeatsHeader();case 4:return i=t.sent,t.abrupt("return",(i&&(r["X-Firebase-Client"]=i),r));case 6:case"end":return t.stop()}},t)}))()}}]),e}();function K5(e){return uz(e)}var Q5=function(){function e(t){var n,r=this;gy(this,e),this.auth=t,this.observer=null,this.addObserver=(n=new az(function(e){return r.observer=e},void 0)).subscribe.bind(n)}return my(e,[{key:"next",get:function(){return Z4(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}(),X5=function(){function e(t,n){gy(this,e),this.providerId=t,this.signInMethod=n}return my(e,[{key:"toJSON",value:function(){return q4("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return q4("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return q4("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return q4("not implemented")}}]),e}();function J5(){return J5=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i5(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),J5.apply(this,arguments)}function e6(){return e6=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u5(t,"POST","/v1/accounts:signInWithPassword",r5(t,n)));case 1:case"end":return e.stop()}},e)})),e6.apply(this,arguments)}function t6(e,t){return n6.apply(this,arguments)}function n6(){return n6=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i5(t,"POST","/v1/accounts:sendOobCode",r5(t,n)));case 1:case"end":return e.stop()}},e)})),n6.apply(this,arguments)}function r6(e,t){return i6.apply(this,arguments)}function i6(){return i6=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t6(t,n));case 1:case"end":return e.stop()}},e)})),i6.apply(this,arguments)}function a6(e,t){return o6.apply(this,arguments)}function o6(){return o6=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t6(t,n));case 1:case"end":return e.stop()}},e)})),o6.apply(this,arguments)}function s6(){return s6=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u5(t,"POST","/v1/accounts:signInWithEmailLink",r5(t,n)));case 1:case"end":return e.stop()}},e)})),s6.apply(this,arguments)}function u6(){return u6=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u5(t,"POST","/v1/accounts:signInWithEmailLink",r5(t,n)));case 1:case"end":return e.stop()}},e)})),u6.apply(this,arguments)}var c6=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return gy(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return my(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.signInMethod,n.next="password"===n.t0?3:"emailLink"===n.t0?4:5;break;case 3:return n.abrupt("return",function(e,t){return e6.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password}));case 4:return n.abrupt("return",function(e,t){return s6.apply(this,arguments)}(e,{email:t._email,oobCode:t._password}));case 5:B4(e,"internal-error");case 6:case"end":return n.stop()}},n)}))()}},{key:"_linkToIdToken",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.signInMethod,r.next="password"===r.t0?3:"emailLink"===r.t0?4:5;break;case 3:return r.abrupt("return",function(e,t){return J5.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password}));case 4:return r.abrupt("return",function(e,t){return u6.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password}));case 5:B4(e,"internal-error");case 6:case"end":return r.stop()}},r)}))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(X5);function l6(e,t){return f6.apply(this,arguments)}function f6(){return f6=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u5(t,"POST","/v1/accounts:signInWithIdp",r5(t,n)));case 1:case"end":return e.stop()}},e)})),f6.apply(this,arguments)}var h6=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return my(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return l6(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,l6(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,l6(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=nz(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):B4("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=Qy(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(X5),d6=function(){function e(t){var n,r,i,a,o,s;gy(this,e);var u=rz(iz(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=u.mode)&&void 0!==i?i:null);Z4(c&&l&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=l,this.continueUrl=null!==(a=u.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return my(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=rz(iz(e)).link,n=t?rz(iz(t)).deep_link_id:null,r=rz(iz(e)).deep_link_id;return(r?rz(iz(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}(),v6=function(){var e=function(){function e(){gy(this,e),this.providerId=e.PROVIDER_ID}return my(e,null,[{key:"credential",value:function(e,t){return c6._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=d6.parseLink(t);return Z4(n,"argument-error"),c6._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e}(),p6=function(){function e(t){gy(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return my(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),g6=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).scopes=[],e}return my(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return fy(this.scopes)}}]),n}(p6),y6=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return my(n,null,[{key:"credential",value:function(e,t){return h6._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(g6);return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}();function m6(e,t){return k6.apply(this,arguments)}function k6(){return k6=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u5(t,"POST","/v1/accounts:signUp",r5(t,n)));case 1:case"end":return e.stop()}},e)})),k6.apply(this,arguments)}var C6=function(){function e(t){gy(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return my(e,null,[{key:"_fromIdTokenResponse",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return TB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,R5._fromIdTokenResponse(t,r,i);case 2:return o=a.sent,s=w6(r),a.abrupt("return",new e({user:o,providerId:s,_tokenResponse:r,operationType:n}));case 5:case"end":return a.stop()}},a)}))()}},{key:"_forOperation",value:function(t,n,r){return TB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t._updateTokensIfNecessary(r,!0);case 2:return a=w6(r),i.abrupt("return",new e({user:t,providerId:a,_tokenResponse:r,operationType:n}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function w6(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var _6=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o,s;return gy(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(uy(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return my(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(QB);function E6(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(function(n){throw"auth/multi-factor-auth-required"===n.code?_6._fromErrorAndOperation(e,n,t,r):n})}function b6(e,t){return P6.apply(this,arguments)}function P6(){return P6=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=C5,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",C6._forOperation(t,"link",i));case 14:case"end":return e.stop()}},e)})),P6.apply(this,arguments)}function S6(){return S6=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],a=t.auth,o="reauthenticate",e.prev=2,e.next=5,C5(t,E6(a,o,n,t),r);case 5:return Z4((s=e.sent).idToken,a,"internal-error"),Z4(u=k5(s.idToken),a,"internal-error"),c=u.sub,e.abrupt("return",(Z4(t.uid===c,a,"user-mismatch"),C6._forOperation(t,o,s)));case 13:throw e.prev=13,e.t0=e.catch(2),"auth/user-not-found"===(null===(i=e.t0)||void 0===i?void 0:i.code)&&B4(a,"user-mismatch"),e.t0;case 16:case"end":return e.stop()}},e,null,[[2,13]])})),S6.apply(this,arguments)}function O6(e,t){return T6.apply(this,arguments)}function T6(){return T6=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i="signIn",e.next=4,E6(t,i,n);case 4:return a=e.sent,e.next=7,C6._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,e.t0=r,e.t0){e.next=12;break}return e.next=12,t._updateCurrentUser(o.user);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e)})),T6.apply(this,arguments)}function I6(){return I6=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O6(K5(t),n));case 1:case"end":return e.stop()}},e)})),I6.apply(this,arguments)}function A6(e,t,n){var r;Z4((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),Z4(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Z4(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Z4(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function M6(){return M6=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=uz(t),a={requestType:"PASSWORD_RESET",email:n},r&&A6(i,a,r),e.next=4,a6(i,a);case 4:case"end":return e.stop()}},e)})),M6.apply(this,arguments)}function x6(){return x6=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=K5(t),e.next=3,m6(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,C6._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)})),x6.apply(this,arguments)}function R6(){return R6=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=uz(t),e.next=3,t.getIdToken();case 3:return e.t0=e.sent,i={requestType:"VERIFY_EMAIL",idToken:e.t0},n&&A6(r.auth,i,n),e.next=8,r6(r.auth,i);case 8:if(a=e.sent,o=a.email,e.t1=o!==t.email,!e.t1){e.next=14;break}return e.next=14,t.reload();case 14:case"end":return e.stop()}},e)})),R6.apply(this,arguments)}function N6(e,t){return D6.apply(this,arguments)}function D6(){return D6=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i5(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),D6.apply(this,arguments)}function L6(){return L6=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=uz(t),e.next=6,a.getIdToken();case 6:return e.t0=e.sent,e.t1=r,e.t2=i,e.t3=!0,o={idToken:e.t0,displayName:e.t1,photoUrl:e.t2,returnSecureToken:e.t3},e.next=13,C5(a,N6(a.auth,o));case 13:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(u=a.providerData.find(function(e){return"password"===e.providerId}))&&(u.displayName=a.displayName,u.photoURL=a.photoURL),e.next=19,a._updateTokensIfNecessary(s);case 19:case"end":return e.stop()}},e)})),L6.apply(this,arguments)}new WeakMap;var F6="__sak",U6=function(){function e(t,n){gy(this,e),this.storageRetriever=t,this.type=n}return my(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(F6,"1"),this.storage.removeItem(F6),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}(),V6=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.call(this,function(){return window.localStorage},"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=GB();return V5(e)||Z5(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=q5(),e._shouldAllowMigration=!0,e}return my(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);!n&&t.localCache[r]===e||t.notifyListeners(r,e)},o=this.storage.getItem(r);WB()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys(function(e,n,r){t.notifyListeners(e,r)})}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t&&JSON.parse(t))}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(function(){e.forAllChangedKeys(function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)})},1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(e,t){var r=this,i=this;return TB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ny(ly(n.prototype),"_set",r).call(i,e,t);case 2:i.localCache[e]=JSON.stringify(t);case 3:case"end":return a.stop()}},a)}))()}},{key:"_get",value:function(e){var t=this,r=this;return TB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,ny(ly(n.prototype),"_get",t).call(r,e);case 2:return a=i.sent,i.abrupt("return",(r.localCache[e]=JSON.stringify(a),a));case 4:case"end":return i.stop()}},i)}))()}},{key:"_remove",value:function(e){var t=this,r=this;return TB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,ny(ly(n.prototype),"_remove",t).call(r,e);case 2:delete r.localCache[e];case 3:case"end":return i.stop()}},i)}))()}}]),n}(U6);return e.type="LOCAL",e}(),B6=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.call(this,function(){return window.sessionStorage},"SESSION")}return my(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(U6);return e.type="SESSION",e}(),z6=function(){var e=function(){function e(t){gy(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return my(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(r=e).data,a=i.eventId,o=i.eventType,s=i.data,null==(u=t.handlersMap[o])?void 0:u.size){n.next=3;break}return n.abrupt("return");case 3:return r.ports[0].postMessage({status:"ack",eventId:a,eventType:o}),c=Array.from(u).map(function(){var e=TB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r.origin,s));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.next=7,function(e){return Promise.all(e.map((t=TB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=!0,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",{fulfilled:e.t0,value:e.t1});case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t2});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return t.apply(this,arguments)})));var t}(c);case 7:l=n.sent,r.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:l});case 9:case"end":return n.stop()}},n)}))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find(function(e){return e.isListeningto(t)});if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();return e.receivers=[],e}();function H6(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}var G6=function(){function e(t){gy(this,e),this.target=t,this.handlers=new Set}return my(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=this;return TB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a="undefined"!=typeof MessageChannel?new MessageChannel:null){i.next=3;break}throw new Error("connection_unavailable");case 3:return i.abrupt("return",new Promise(function(i,u){var c=H6("",20);a.port1.start();var l=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:a,onMessage:function(e){var t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),o=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),i(t.data.response);break;default:clearTimeout(l),clearTimeout(o),u(new Error("invalid_response"))}}},r.handlers.add(s),a.port1.addEventListener("message",s.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[a.port2])}).finally(function(){s&&r.removeMessageHandler(s)}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function $6(){return window}function Z6(){return void 0!==$6().WorkerGlobalScope&&"function"==typeof $6().importScripts}function q6(){return(q6=TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return e.abrupt("return",e.sent.active);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var W6="firebaseLocalStorageDb",j6="firebaseLocalStorage",Y6="fbase_key",K6=function(){function e(t){gy(this,e),this.request=t}return my(e,[{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.request.addEventListener("success",function(){t(e.request.result)}),e.request.addEventListener("error",function(){n(e.request.error)})})}}]),e}();function Q6(e,t){return e.transaction([j6],t?"readwrite":"readonly").objectStore(j6)}function X6(){var e=indexedDB.open(W6,1);return new Promise(function(t,n){e.addEventListener("error",function(){n(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(j6,{keyPath:Y6})}catch(r){n(r)}}),e.addEventListener("success",TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.result).objectStoreNames.contains(j6)){n.next=5;break}t(r),n.next=13;break;case 5:return r.close(),n.next=8,function(){var e=indexedDB.deleteDatabase(W6);return new K6(e).toPromise()}();case 8:return n.t0=t,n.next=11,X6();case 11:n.t1=n.sent,(0,n.t0)(n.t1);case 13:case"end":return n.stop()}},n)})))})}function J6(e,t,n){return e8.apply(this,arguments)}function e8(){return e8=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Q6(t,!0).put((Kg(i={},Y6,n),Kg(i,"value",r),i)),e.abrupt("return",new K6(a).toPromise());case 2:case"end":return e.stop()}},e)})),e8.apply(this,arguments)}function t8(){return t8=TB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Q6(t,!1).get(n),e.next=3,new K6(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}},e)})),t8.apply(this,arguments)}function n8(e,t){var n=Q6(e,!0).delete(t);return new K6(n).toPromise()}var r8=function(){var e=function(){function e(){gy(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return my(e,[{key:"_openDb",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.db,t.t0){t.next=5;break}return t.next=4,X6();case 4:e.db=t.sent;case 5:return t.abrupt("return",e.db);case 6:case"end":return t.stop()}},t)}))()}},{key:"_withRetries",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=0;case 1:return n.prev=1,n.next=4,t._openDb();case 4:return i=n.sent,n.next=7,e(i);case 7:return n.abrupt("return",n.sent);case 10:if(n.prev=10,n.t0=n.catch(1),!(r++>3)){n.next=14;break}throw n.t0;case 14:t.db&&(t.db.close(),t.db=void 0);case 15:n.next=1;break;case 17:case"end":return n.stop()}},n,null,[[1,10]])}))()}},{key:"initializeServiceWorkerMessaging",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Z6()?e.initializeReceiver():e.initializeSender());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeReceiver",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.receiver=z6._getInstance(Z6()?self:null),e.receiver._subscribe("keyChanged",function(){var t=TB(regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._poll();case 2:return t.t0=t.sent.includes(r.key),t.abrupt("return",{keyProcessed:t.t0});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=TB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeSender",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){return q6.apply(this,arguments)}();case 2:if(e.activeServiceWorker=t.sent,e.activeServiceWorker){t.next=5;break}return t.abrupt("return");case 5:return e.sender=new G6(e.activeServiceWorker),t.next=8,e.sender._send("ping",{},800);case 8:!(i=t.sent)||(null===(n=i[0])||void 0===n?void 0:n.fulfilled)&&(null===(r=i[0])||void 0===r?void 0:r.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0);case 10:case"end":return t.stop()}},t)}))()}},{key:"notifyServiceWorker",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.sender||!t.activeServiceWorker||function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()!==t.activeServiceWorker){n.next=8;break}return n.prev=1,n.next=4,t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])}))()}},{key:"_isAvailable",value:function(){return TB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,X6();case 5:return t=e.sent,e.next=8,J6(t,F6,"1");case 8:return e.next=10,n8(t,F6);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,null,[[0,13]])}))()}},{key:"_withPendingWrite",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pendingWrites++,n.prev=1,n.next=4,e();case 4:return n.prev=4,t.pendingWrites--,n.finish(4);case 7:case"end":return n.stop()}},n,null,[[1,,4,7]])}))()}},{key:"_set",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n._withRetries(function(n){return J6(n,e,t)});case 2:return n.localCache[e]=t,r.abrupt("return",n.notifyServiceWorker(e));case 4:case"end":return r.stop()}},r)}))));case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return function(e,t){return t8.apply(this,arguments)}(t,e)});case 2:return r=n.sent,n.abrupt("return",(t.localCache[e]=r,r));case 4:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._withPendingWrite(TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return n8(t,e)});case 2:return delete t.localCache[e],n.abrupt("return",t.notifyServiceWorker(e));case 4:case"end":return n.stop()}},n)}))));case 1:case"end":return n.stop()}},n)}))()}},{key:"_poll",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._withRetries(function(e){var t=Q6(e,!1).getAll();return new K6(t).toPromise()});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",[]);case 5:if(0===e.pendingWrites){t.next=7;break}return t.abrupt("return",[]);case 7:r=[],i=new Set,a=dy(n);try{for(a.s();!(o=a.n()).done;)s=o.value,u=s.fbase_key,c=s.value,i.add(u),JSON.stringify(e.localCache[u])!==JSON.stringify(c)&&(e.notifyListeners(u,c),r.push(u))}catch(d){a.e(d)}finally{a.f()}for(l=0,f=Object.keys(e.localCache);l<f.length;l++)h=f[l],e.localCache[h]&&!i.has(h)&&(e.notifyListeners(h,null),r.push(h));return t.abrupt("return",r);case 12:case"end":return t.stop()}},t)}))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}},t)})),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();return e.type="LOCAL",e}();function i8(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}function a8(e,t){return t?Y4(t):(Z4(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}i8("rcb"),new X4(3e4,6e4);var o8=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,"custom","custom")).params=e,r}return my(n,[{key:"_getIdTokenResponse",value:function(e){return l6(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return l6(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return l6(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(X5);function s8(e){return O6(e.auth,new o8(e),e.bypassAuthState)}function u8(e){var t=e.auth,n=e.user;return Z4(n,t,"internal-error"),function(e,t){return S6.apply(this,arguments)}(n,new o8(e),e.bypassAuthState)}function c8(e){return l8.apply(this,arguments)}function l8(){return l8=TB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,r=t.user,e.abrupt("return",(Z4(r,n,"internal-error"),b6(r,new o8(t),t.bypassAuthState)));case 2:case"end":return e.stop()}},e)})),l8.apply(this,arguments)}var f8=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];gy(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return my(e,[{key:"execute",value:function(){var e,t=this;return new Promise((e=TB(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.pendingPromise={resolve:n,reject:r},e.prev=1,e.next=4,t.resolver._initialize(t.auth);case 4:return t.eventManager=e.sent,e.next=7,t.onExecution();case 7:t.eventManager.registerConsumer(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t.reject(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])})),function(t,n){return e.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.urlResponse,i=e.sessionId,a=e.postBody,o=e.tenantId,s=e.error,u=e.type,!s){n.next=3;break}return n.abrupt("return",void t.reject(s));case 3:return c={auth:t.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:a||void 0,user:t.user,bypassAuthState:t.bypassAuthState},n.prev=4,n.t0=t,n.next=8,t.getIdpTask(u)(c);case 8:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=15;break;case 12:n.prev=12,n.t2=n.catch(4),t.reject(n.t2);case 15:case"end":return n.stop()}},n,null,[[4,12]])}))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return s8;case"linkViaPopup":case"linkViaRedirect":return c8;case"reauthViaPopup":case"reauthViaRedirect":return u8;default:B4(this.auth,"internal-error")}}},{key:"resolve",value:function(e){W4(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){W4(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),h8=new X4(2e3,1e4);function d8(){return d8=TB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=K5(t),G4(t,n,p6),a=a8(i,r),e.abrupt("return",new v8(i,"signInViaPopup",n,a).executeNotNull());case 4:case"end":return e.stop()}},e)})),d8.apply(this,arguments)}var v8=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o){var s;return gy(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=uy(s),s}return my(n,[{key:"executeNotNull",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.execute();case 2:return n=t.sent,t.abrupt("return",(Z4(n,e.auth,"internal-error"),n));case 4:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return W4(1===e.filter.length,"Popup operations only handle one event"),n=H6(),t.next=4,e.resolver._openPopup(e.auth,e.provider,e.filter[0],n);case 4:e.authWindow=t.sent,e.authWindow.associatedEvent=n,e.resolver._originValidation(e.auth).catch(function(t){e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,function(t){t||e.reject(z4(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation();case 9:case"end":return t.stop()}},t)}))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(z4(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;e.pollId=(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?window.setTimeout(function(){e.pollId=null,e.reject(z4(e.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,h8.get())}()}}]),n}(f8);return e.currentPopupAction=null,e}(),p8=new Map,g8=function(e){iy(n,e);var t=oy(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return gy(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return my(n,[{key:"execute",value:function(){var e=this,t=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=p8.get(t.auth._key())){r.next=20;break}return r.prev=2,r.next=5,function(e,t){return y8.apply(this,arguments)}(t.resolver,t.auth);case 5:if(!r.sent){r.next=11;break}return r.next=8,ny(ly(n.prototype),"execute",e).call(t);case 8:r.t0=r.sent,r.next=12;break;case 11:r.t0=null;case 12:a=r.t0,i=function(){return Promise.resolve(a)},r.next=19;break;case 16:r.prev=16,r.t1=r.catch(2),i=function(){return Promise.reject(r.t1)};case 19:p8.set(t.auth._key(),i);case 20:return r.abrupt("return",(t.bypassAuthState||p8.set(t.auth._key(),function(){return Promise.resolve(null)}),i()));case 21:case"end":return r.stop()}},r,null,[[2,16]])}))()}},{key:"onAuthEvent",value:function(e){var t=this,r=function(){return ny(ly(n.prototype),"onAuthEvent",t)},i=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("signInViaRedirect"!==e.type){t.next=2;break}return t.abrupt("return",r().call(i,e));case 2:if("unknown"===e.type){t.next=12;break}if(!e.eventId){t.next=10;break}return t.next=6,i.auth._redirectUserForId(e.eventId);case 6:if(!(n=t.sent)){t.next=9;break}return t.abrupt("return",(i.user=n,r().call(i,e)));case 9:i.resolve(null);case 10:t.next=13;break;case 12:i.resolve(null);case 13:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){return TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()}},{key:"cleanUp",value:function(){}}]),n}(f8);function y8(){return y8=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=C8(n),i=k8(t),e.next=3,i._isAvailable();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,i._get(r);case 7:return e.t0=e.sent,a="true"===e.t0,e.next=11,i._remove(r);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}},e)})),y8.apply(this,arguments)}function m8(e,t){p8.set(e._key(),t)}function k8(e){return Y4(e._redirectPersistence)}function C8(e){return D5("pendingRedirect",e.config.apiKey,e.name)}function w8(e,t){return _8.apply(this,arguments)}function _8(){return _8=TB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=K5(t),a=a8(i,n),e.next=5,new g8(i,a,r).execute();case 5:if(o=e.sent,e.t0=o&&!r,!e.t0){e.next=13;break}return delete o.user._redirectEventId,e.next=11,i._persistUserIfCurrent(o.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e)})),_8.apply(this,arguments)}var E8=function(){function e(t){gy(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return my(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach(function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return P8(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!P8(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(z4(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(b8(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(b8(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function b8(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(function(e){return e}).join("-")}function P8(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function S8(e){return O8.apply(this,arguments)}function O8(){return O8=TB(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",i5(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}},e)})),O8.apply(this,arguments)}var T8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,I8=/^https?/;function A8(){return A8=TB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,S8(t);case 4:n=e.sent,r=n.authorizedDomains,i=dy(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!M8(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:B4(t,"unauthorized-domain");case 29:case"end":return e.stop()}},e,null,[[7,22,25,28],[11,16]])})),A8.apply(this,arguments)}function M8(e){var t=K4(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!I8.test(r))return!1;if(T8.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var x8=new X4(3e4,6e4);function R8(){var e=$6().___jsl;if(null==e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=fy(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var N8=null;function D8(e){return N8=N8||function(e){return new Promise(function(t,n){var r,i,a;function o(){R8(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){R8(),n(z4(e,"network-request-failed"))},timeout:x8.get()})}if(null===(i=null===(r=$6().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=$6().gapi)||void 0===a?void 0:a.load)){var s=i8("iframefcb");return $6()[s]=function(){gapi.load?o():n(z4(e,"network-request-failed"))},function(e){return new Promise(function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=z4("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}("https://apis.google.com/js/api.js?onload=".concat(s)).catch(function(e){return n(e)})}o()}}).catch(function(e){throw N8=null,e})}(e),N8}var L8=new X4(5e3,15e3),F8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},U8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function V8(e){var t=e.config;Z4(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?J4(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:Yz},i=U8.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(nz(r).slice(1))}function B8(){return B8=TB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D8(t);case 2:return n=e.sent,r=$6().gapi,e.abrupt("return",(Z4(r,t,"internal-error"),n.open({where:document.body,url:V8(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:F8,dontclear:!0},function(e){return new Promise((n=TB(regeneratorRuntime.mark(function n(r,i){var a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){$6().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=z4(t,"network-request-failed"),o=$6().setTimeout(function(){i(a)},L8.get()),e.ping(s).then(s,function(){i(a)});case 5:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)}));var n})));case 5:case"end":return e.stop()}},e)})),B8.apply(this,arguments)}var z8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},H8=function(){function e(t){gy(this,e),this.window=t,this.associatedEvent=null}return my(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function G8(e,t,n,r,i,a){Z4(e.config.authDomain,e,"auth-domain-config-required"),Z4(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Yz,eventId:i};if(t instanceof p6){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var s=0,u=Object.entries(a||{});s<u.length;s++){var c=Qg(u[s],2),l=c[0],f=c[1];o[l]=f}}if(t instanceof g6){var h=t.getScopes().filter(function(e){return""!==e});h.length>0&&(o.scopes=h.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,v=0,p=Object.keys(d);v<p.length;v++){var g=p[v];void 0===d[g]&&delete d[g]}return"".concat(function(e){var t=e.config;return t.emulator?J4(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/__/auth/handler")}(e),"?").concat(nz(d).slice(1))}var $8="webStorageSupport",Z8=function(){function e(){gy(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=B6,this._completeRedirectFn=w8,this._overrideRedirectResult=m8}return my(e,[{key:"_openPopup",value:function(e,t,n,r){var i=this;return TB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return W4(null===(o=i.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()"),s=G8(e,t,n,K4(),r),a.abrupt("return",function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},z8),{width:r.toString(),height:i.toString(),top:a,left:o}),c=GB().toLowerCase();n&&(s=B5(c)?"_blank":n),U5(c)&&(t=t||"http://localhost",u.scrollbars="yes");var l=Object.entries(u).reduce(function(e,t){var n=Qg(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")},"");if(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB();return Z5(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new H8(null);var f=window.open(t||"",s,l);Z4(f,e,"popup-blocked");try{f.focus()}catch(h){}return new H8(f)}(e,s,H6()));case 3:case"end":return a.stop()}},a)}))()}},{key:"_openRedirect",value:function(e,t,n,r){var i=this;return TB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i._originValidation(e);case 2:return function(e){$6().location.href=e}(G8(e,t,n,K4(),r)),a.abrupt("return",new Promise(function(){}));case 4:case"end":return a.stop()}},a)}))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(W4(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(function(){delete t.eventManagers[n]}),o}},{key:"initAndGetManager",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,function(e){return B8.apply(this,arguments)}(e);case 2:return r=n.sent,i=new E8(e),n.abrupt("return",(r.register("authEvent",function(t){return Z4(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:i.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=r,i));case 5:case"end":return n.stop()}},n)}))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send($8,{type:$8},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[$8];void 0!==i&&t(!!i),B4(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return A8.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return q5()||V5()||Z5()}}]),e}(),q8="@firebase/auth",W8=function(){function e(t){gy(this,e),this.auth=t,this.internalListeners=new Map}return my(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.assertAuthConfigured(),n.next=3,t.auth._initializationPromise;case 3:if(!t.auth.currentUser){n.next=10;break}return n.next=6,t.auth.currentUser.getIdToken(e);case 6:n.t1=n.sent,n.t0={accessToken:n.t1},n.next=11;break;case 10:n.t0=null;case 11:return n.abrupt("return",n.t0);case 12:case"end":return n.stop()}},n)}))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged(function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){Z4(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();!function(e){Zz(new fz("auth",function(t,n){var r=n.options,i=t.getProvider("app").getImmediate(),a=t.getProvider("heartbeat"),o=i.options,s=o.apiKey,u=o.authDomain;return function(t,n){Z4(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),Z4(!(null==u?void 0:u.includes(":")),"argument-error",{appName:t.name});var i={apiKey:s,authDomain:u,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:W5(e)},a=new Y5(t,n,i);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Y4);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(a,r),a}(i,a)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider("auth-internal").initialize()})),Zz(new fz("auth-internal",function(e){var t=K5(e.getProvider("auth").getImmediate());return new W8(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xz(q8,"0.20.5",void 0),Xz(q8,"0.20.5","esm2017")}("Browser");var j8=my(function e(t){return gy(this,e),t}),Y8=my(function e(){return gy(this,e),V3("auth")}),K8=new Cw("angularfire2.auth-instances");function Q8(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new j8(r)}}var X8={provide:Y8,deps:[[new jw,K8]]},J8={provide:j8,useFactory:function(e,t){var n=U3("auth",e,t);return n&&new j8(n)},deps:[[new jw,K8],K3]},e7=function(){var e=my(function e(){gy(this,e),Xz("angularfire",M3.full,"auth")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({providers:[J8,X8]}),e}(),t7=Y3(function(e,t,n){return x6.apply(this,arguments)},!0),n7=Y3(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kz(),t=qz(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){var n=qz(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(ez(n.getOptions(),null!=t?t:{}))return r;B4(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Z8,persistence:[r8,V6,B6]})},!0),r7=Y3(function(e,t,n,r){return uz(e).onAuthStateChanged(t,n,r)},!0),i7=Y3(function(e,t){return R6.apply(this,arguments)},!0),a7=Y3(function(e,t,n){return M6.apply(this,arguments)},!0),o7=Y3(function(e,t,n){return function(e,t){return I6.apply(this,arguments)}(uz(e),v6.credential(t,n))},!0),s7=Y3(function(e,t,n){return d8.apply(this,arguments)},!0),u7=Y3(function(e,t){return L6.apply(this,arguments)},!0),c7=my(function e(t){return gy(this,e),t}),l7=new Cw("angularfire2.firestore-instances");function f7(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new c7(r)}}var h7={provide:my(function e(){return gy(this,e),V3("firestore")}),deps:[[new jw,l7]]},d7={provide:c7,useFactory:function(e,t){var n=U3("firestore",e,t);return n&&new c7(n)},deps:[[new jw,l7],K3]},v7=function(){var e=my(function e(){gy(this,e),Xz("angularfire",M3.full,"fst")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({providers:[d7,h7]}),e}(),p7=Y3(function(e,t){var n=nJ(e.firestore,fJ),r=uJ(e),i=JJ(e.converter,t);return t1(n,[PJ(bJ(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Vj.exists(!1))]).then(function(){return r})},!0),g7=Y3(function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=uz(e),XX("collection","path",t),e instanceof iJ){var a=Zq.fromString.apply(Zq,[t].concat(r));return eJ(a),new sJ(e,null,a)}if(!(e instanceof aJ||e instanceof sJ))throw new Iq(Tq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Zq.fromString.apply(Zq,[t].concat(r)));return eJ(o),new sJ(e.firestore,null,o)},!0),y7=Y3(function(e){return t1(nJ(e.firestore,fJ),[new eY(e._key,Vj.none())])},!0),m7=Y3(uJ,!0),k7=Y3(function(e){e=nJ(e,aJ);var t=nJ(e.firestore,fJ);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Aq;return e.asyncQueue.enqueueAndForget(TB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new VX({next:function(a){t.enqueueAndForget(function(){return YQ(e,o)});var s=a.docs.has(n);!s&&a.fromCache?i.reject(new Iq(Tq.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new Iq(Tq.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new eX(lj(n.path),a,{includeMetadataChanges:!0,Du:!0});return WQ(e,o)},i.next=3,YX(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(hJ(t),e._key).then(function(n){return n1(t,e,n)})},!0),C7=Y3(function(e){e=nJ(e,oJ);var t=nJ(e.firestore,fJ),n=hJ(t),r=new e1(t);return ZJ(e._query),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Aq;return e.asyncQueue.enqueueAndForget(TB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new VX({next:function(n){t.enqueueAndForget(function(){return YQ(e,o)}),n.fromCache&&"server"===r.source?i.reject(new Iq(Tq.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new eX(n,a,{includeMetadataChanges:!0,Du:!0});return WQ(e,o)},i.next=3,YX(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(n,e._query).then(function(n){return new GJ(t,r,e,n)})},!0),w7=Y3(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kz();return qz(e,"firestore").getImmediate()},!0),_7=Y3(function(e){return function(e,t){if(t<=0)throw new Iq(Tq.INVALID_ARGUMENT,"Function ".concat("limit","() requires a positive number, but it was: ").concat(t,"."))}(0,e),new YJ("limit",e,"F")},!0),E7=Y3(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=uz(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||lJ(n[u])||(s=n[u],u++);var c,l,f,h={includeMetadataChanges:s.includeMetadataChanges};if(lJ(n[u])){var d=n[u];n[u]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[u+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof aJ)l=nJ(e.firestore,fJ),f=lj(e._key.path),c={next:function(t){n[u]&&n[u](n1(l,e,t))},error:n[u+1],complete:n[u+2]};else{var v=nJ(e,oJ);l=nJ(v.firestore,fJ),f=v._query;var p=new e1(l);c={next:function(e){n[u]&&n[u](new GJ(l,p,v,e))},error:n[u+1],complete:n[u+2]},ZJ(e._query)}return function(e,t,n,r){var i=new VX(r),a=new eX(t,i,n);return e.asyncQueue.enqueueAndForget(TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=WQ,t.next=3,YX(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.Tc(),e.asyncQueue.enqueueAndForget(TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=YQ,t.next=3,YX(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(hJ(l),f,h,c)},!0),b7=Y3(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=VJ("orderBy",e);return new jJ(r,n)},!0),P7=Y3(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e},!0),S7=Y3(function(e,t,n){e=nJ(e,aJ);var r=nJ(e.firestore,fJ),i=JJ(e.converter,t,n);return t1(r,[PJ(bJ(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Vj.none())])},!0),O7=Y3(function(e,t,n){e=nJ(e,aJ);for(var r,i=nJ(e.firestore,fJ),a=bJ(i),o=arguments.length,s=new Array(o>3?o-3:0),u=3;u<o;u++)s[u-3]=arguments[u];return r="string"==typeof(t=uz(t))||t instanceof vJ?function(e,t,n,r,i,a){var o=e.aa(1,t,n),s=[xJ(t,r,n)],u=[i];if(a.length%2!=0)throw new Iq(Tq.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(xJ(t,a[c])),u.push(a[c+1]);for(var l=[],f=zW.empty(),h=s.length-1;h>=0;--h)if(!LJ(l,s[h])){var d=s[h],v=u[h];v=uz(v);var p=o.ia(d);if(v instanceof SJ)l.push(d);else{var g=TJ(v,p);null!=g&&(l.push(d),f.set(d,g))}}var y=new hW(l);return new CJ(f,y,o.fieldTransforms)}(a,"updateDoc",e._key,t,n,s):function(e,t,n,r){var i=e.aa(1,t,n);MJ("Data must be an object, but it was:",i,r);var a=[],o=zW.empty();aW(r,function(e,r){var s=NJ(t,e,n);r=uz(r);var u=i.ia(s);if(r instanceof SJ)a.push(s);else{var c=TJ(r,u);null!=c&&(a.push(s),o.set(s,c))}});var s=new hW(a);return new CJ(o,s,i.fieldTransforms)}(a,"updateDoc",e._key,t),t1(i,[r.toMutation(e._key,Vj.exists(!0))])},!0),T7=Y3(function(e,t,n){var r=t,i=VJ("where",e);return new WJ(i,r,n)},!0),I7=function(){var e=function(){function e(t,n){gy(this,e),this.collectionName=t,this.firestore=n,this.subDAOs={},this.collection=g7(n,this.collectionName).withConverter({fromFirestore:function(e){return e.data()},toFirestore:function(e){return e}})}return my(e,[{key:"create",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return AB(e.VERBOSE,{called:n.collectionName+".create",newElement:t}),r.next=3,p7(n.collection,t);case 3:return r.abrupt("return",r.sent.id);case 4:case"end":return r.stop()}},r)}))()}},{key:"read",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return AB(e.VERBOSE,{called:n.collectionName+".read",id:t}),r.next=3,k7(m7(n.collection,t));case 3:return i=r.sent,r.abrupt("return",i.exists()?NB.of(IB.getNonNullable(i.data())):NB.empty());case 5:case"end":return r.stop()}},r)}))()}},{key:"exists",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return AB(e.VERBOSE,{called:n.collectionName+".exists",id:t}),r.next=3,n.read(t);case 3:return r.abrupt("return",r.sent.isPresent());case 4:case"end":return r.stop()}},r)}))()}},{key:"update",value:function(t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(AB(e.VERBOSE,{called:r.collectionName+".update",id:t,update:n}),O7(m7(r.collection,t),n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"delete",value:function(t){return AB(e.VERBOSE,{called:this.collectionName+".delete",id:t}),y7(m7(this.collection,t))}},{key:"set",value:function(t,n){return AB(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),S7(m7(this.collection,t),n)}},{key:"subscribeToChanges",value:function(e,t){return new yy(E7(m7(this.collection,e),function(e){t(NB.ofNullable(e.data()))}))}},{key:"findWhere",value:function(e,t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.constructQuery(e,t,n),i.next=3,C7(a);case 3:return i.abrupt("return",i.sent.docs.map(function(e){return{id:e.id,data:e.data()}}));case 4:case"end":return i.stop()}},i)}))()}},{key:"observingWhere",value:function(t,n,r){var i=this;AB(e.VERBOSE,{called:this.collectionName+".observingWhere"});var a=this.constructQuery(t,r);return new yy(E7(a,function(t){var r=[],a=[],o=[];t.docChanges().forEach(function(e){var t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":a.push(t);break;case"removed":o.push(t)}}),r.length>0&&(AB(e.VERBOSE,"firebase gave us "+r.length+" NEW "+i.collectionName),n.onDocumentCreated(r)),a.length>0&&(AB(e.VERBOSE,"firebase gave us "+a.length+" MODIFIED "+i.collectionName),n.onDocumentModified(a)),o.length>0&&(AB(e.VERBOSE,"firebase gave us "+o.length+" DELETED "+i.collectionName),n.onDocumentDeleted(o))}))}},{key:"constructQuery",value:function(e,t,n){var r=P7(this.collection);null!=t&&(r=P7(r,b7(t))),null!=n&&(r=P7(r,_7(n)));var i,a=dy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;r=P7(r,T7(o[0],o[1],o[2]))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"subCollectionDAO",value:function(t,n){var r="".concat(this.collection.path,"/").concat(t,"/").concat(n);if(r in this.subDAOs)return this.subDAOs[r];var i=new(function(e){iy(n,e);var t=oy(n);function n(e){return gy(this,n),t.call(this,r,e)}return my(n)}(e))(this.firestore);return this.subDAOs[r]=i,i}}]),e}();return e.VERBOSE=!1,e}(),A7=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),r=t.call(this,"chats",e),AB(n.VERBOSE,"ChatDAO.constructor"),r}return my(n)}(I7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Bw(c7))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),M7=function(){var n=my(function e(){gy(this,e)});return n.CANNOT_SEND_MESSAGE=function(){return $localize(e||(e=Wg(["You're not allowed to send a message here."])))},n.FORBIDDEN_MESSAGE=function(){return $localize(t||(t=Wg(["This message is forbidden."])))},n}(),x7=function(){var e=function(){function e(t){gy(this,e),this.chatDAO=t,AB(e.VERBOSE,"ChatService.constructor")}return my(e,[{key:"addMessage",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.chatDAO.subCollectionDAO(e,"messages").create(t));case 1:case"end":return r.stop()}},r)}))()}},{key:"getLastMessages",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t));case 1:case"end":return r.stop()}},r)}))()}},{key:"subscribeToMessages",value:function(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}},{key:"deleteChat",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(AB(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"createNewChat",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chatDAO.set(e,{}));case 1:case"end":return n.stop()}},n)}))()}},{key:"sendMessage",value:function(e,t,n,r){var i=this;return TB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!1!==i.userCanSendMessage(t.name,e)){a.next=2;break}return a.abrupt("return",UB.failure(M7.CANNOT_SEND_MESSAGE()));case 2:if(!i.isForbiddenMessage(n)){a.next=4;break}return a.abrupt("return",UB.failure(M7.FORBIDDEN_MESSAGE()));case 4:return o={content:n,sender:t,postedTime:r1(),currentTurn:r},a.next=7,i.addMessage(e,o);case 7:return a.abrupt("return",UB.SUCCESS);case 8:case"end":return a.stop()}},a)}))()}},{key:"userCanSendMessage",value:function(e,t){return""!==e}},{key:"isForbiddenMessage",value:function(e){return""===e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Bw(A7))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),R7=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){return gy(this,n),t.call(this,"errors",e)}return my(n)}(I7);return e.\u0275fac=function(t){return new(t||e)(Bw(c7))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),N7=Jg(5378),D7=function(){var e=function(){function e(){gy(this,e)}return my(e,[{key:"infoMessage",value:function(e){this.message(e,"is-info")}},{key:"gameMessage",value:function(e){this.message(e,"is-warning")}},{key:"criticalMessage",value:function(e){this.message(e,"is-danger")}},{key:"message",value:function(e,t){(0,N7.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),L7=function(){function e(t,n,r){gy(this,e),this.errorDAO=t,this.router=n,this.messageDisplayer=r,e.setSingletonInstance(this)}return my(e,[{key:"findErrors",value:function(e,t,n,r){return this.errorDAO.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}},{key:"logError",value:function(e,t,r){var i=this;return TB(regeneratorRuntime.mark(function a(){var o,s,u,c,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.messageDisplayer.criticalMessage($localize(n||(n=Wg(["An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible."])))),o=i.router.url,a.next=4,i.findErrors(e,o,t,r);case 4:if(0!==(s=a.sent).length){a.next=12;break}return u={component:e,route:o,message:t,firstEncounter:r1(),lastEncounter:r1(),occurences:1},null!=r&&(u.data=r),a.next=10,i.errorDAO.create(u);case 10:a.next=15;break;case 12:return c=s[0].id,l=s[0].data,a.next=15,i.errorDAO.update(c,{lastEncounter:r1(),occurences:l.occurences+1});case 15:case"end":return a.stop()}},a)}))()}}],[{key:"setSingletonInstance",value:function(t){e.singleton=NB.of(t)}},{key:"logErrorAndFail",value:function(t,n,r){throw e.logError(t,n,r),new Error("".concat(t,": ").concat(n," (extra data: ").concat(JSON.stringify(r),")"))}},{key:"logError",value:function(e,t,n){if(this.singleton.isAbsent())throw new Error("".concat(e,": ").concat(t," (extra data: ").concat(JSON.stringify(n),")"));return this.singleton.get().logError(e,t,n),UB.failure(e+": "+t)}}]),e}();function F7(e,t){if(!1===e)throw L7.logError("Assertion failure",t),new Error("Assertion failure: ".concat(t))}L7.singleton=NB.empty(),L7.\u0275fac=function(e){return new(e||L7)(Bw(R7),Bw(yF),Bw(D7))},L7.\u0275prov=Um({token:L7,factory:L7.\u0275fac,providedIn:"root"});var U7=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),r=t.call(this,n.COLLECTION_NAME,e),AB(n.VERBOSE,"UserDAO.constructor"),r}return my(n)}(I7);return e.VERBOSE=!1,e.COLLECTION_NAME="users",e.\u0275fac=function(t){return new(t||e)(Bw(c7))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),V7=function(){var e=function(){function e(t){gy(this,e),this.userDAO=t}return my(e,[{key:"usernameIsAvailable",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.findWhere([["username","==",e]]);case 2:return n.t0=n.sent.length,n.abrupt("return",0===n.t0);case 4:case"end":return n.stop()}},n)}))()}},{key:"setUsername",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.userDAO.update(e,{username:t});case 2:case"end":return r.stop()}},r)}))()}},{key:"markAsVerified",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.update(e,{verified:!0});case 2:case"end":return n.stop()}},n)}))()}},{key:"observeUser",value:function(e,t){return this.userDAO.subscribeToChanges(e,t)}},{key:"getUserLastUpdateTime",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.read(e);case 2:if(!(r=n.sent).isAbsent()){n.next=5;break}return n.abrupt("return",NB.empty());case 5:return i=r.get().lastUpdateTime,n.abrupt("return",(F7(null!=i,"should not receive a lastUpdateTime equal to null"),NB.of(i)));case 7:case"end":return n.stop()}},n)}))()}},{key:"updatePresenceToken",value:function(e){return this.userDAO.update(e,{lastUpdateTime:r1()})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(U7))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),B7=function(e){iy(n,e);var t=oy(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S3;return gy(this,n),(e=t.call(this))._bufferSize=r,e._windowTime=i,e._timestampProvider=a,e._buffer=[],e._infiniteTimeWindow=!0,e._infiniteTimeWindow=i===1/0,e._bufferSize=Math.max(1,r),e._windowTime=Math.max(1,i),e}return my(n,[{key:"next",value:function(e){var t=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,a=this._timestampProvider,o=this._windowTime;t||(r.push(e),!i&&r.push(a.now()+o)),this._trimBuffer(),ny(ly(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t}},{key:"_trimBuffer",value:function(){var e=this._bufferSize,t=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var a=t.now(),o=0,s=1;s<n.length&&n[s]<=a;s+=2)o=s;o&&n.splice(0,o+1)}}}]),n}(Zy),z7=function(){function e(){gy(this,e)}return my(e,null,[{key:"createUserWithEmailAndPassword",value:function(e,t,n){return t7(e,t,n)}},{key:"sendEmailVerification",value:function(e){return i7(e)}},{key:"sendPasswordResetEmail",value:function(e,t){return a7(e,t)}},{key:"signInWithEmailAndPassword",value:function(e,t,n){return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o7(e,t,n);case 2:return r.abrupt("return",r.sent.user);case 3:case"end":return r.stop()}},r)}))()}},{key:"signInWithPopup",value:function(e,t){return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s7(e,t);case 2:return n.abrupt("return",n.sent.user);case 3:case"end":return n.stop()}},n)}))()}},{key:"updateProfile",value:function(e,t){return u7(e,t)}}]),e}(),H7=function(){function e(t,n,r,i){gy(this,e),this.id=t,this.email=n,this.username=r,this.verified=i}return my(e,[{key:"isConnected",value:function(){return this.email.isPresent()}},{key:"toMinimalUser",value:function(){return{id:this.id,name:this.username.get()}}}]),e}();H7.NOT_CONNECTED=new H7("",NB.empty(),NB.empty(),!1);var G7=function(){var e=function(){function e(t,n,r){gy(this,e);var i,a=this;this.userDAO=t,this.userService=n,this.auth=r,this.user=NB.empty(),this.userSubscription=new yy,AB(e.VERBOSE,"ConnectedUserService constructor"),this.userRS=new B7(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new yy(r7(this.auth,(i=TB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:null==n?(AB(e.VERBOSE,"User is not connected"),a.userSubscription.unsubscribe(),a.userRS.next(H7.NOT_CONNECTED),a.user=NB.empty()):(F7(a.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),a.userSubscription=a.userDAO.subscribeToChanges(n.uid,function(t){if(t.isPresent()){var r=t.get().username;AB(e.VERBOSE,"User ".concat(r," is connected, and the verified status is ").concat(a.emailVerified(n)));var i=!0===a.emailVerified(n)&&null!=r;if(!0===i&&!1===t.get().verified)return a.userService.markAsVerified(n.uid);var o=new H7(n.uid,NB.ofNullable(n.email),NB.ofNullable(r),i);a.user=NB.of(o),a.userRS.next(o)}}));case 1:case"end":return t.stop()}},t)})),function(e){return i.apply(this,arguments)})))}return my(e,[{key:"emailVerified",value:function(e){return e.emailVerified}},{key:"sendPasswordResetEmail",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,z7.sendPasswordResetEmail(t.auth,e);case 3:return n.abrupt("return",UB.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",UB.failure(t.mapFirebaseError(n.t0)));case 9:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"doRegister",value:function(t,n,i){var a=this;return TB(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return AB(e.VERBOSE,"ConnectedUserService.doRegister("+n+")"),o.next=3,a.userService.usernameIsAvailable(t);case 3:if(!o.sent){o.next=7;break}o.t0=a.registerAfterUsernameCheck(t,n,i),o.next=8;break;case 7:o.t0=DB.failure($localize(r||(r=Wg(["This username is already in use."]))));case 8:return o.abrupt("return",o.t0);case 9:case"end":return o.stop()}},o)}))()}},{key:"registerAfterUsernameCheck",value:function(e,t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,z7.createUserWithEmailAndPassword(r.auth,t,n);case 3:return a=i.sent,i.next=6,z7.signInWithEmailAndPassword(r.auth,t,n);case 6:return o=IB.getNonNullable(a.user),i.next=9,r.createUser(o.uid,e);case 9:return i.abrupt("return",DB.success(o));case 12:return i.prev=12,i.t0=i.catch(0),i.abrupt("return",DB.failure(r.mapFirebaseError(i.t0)));case 15:case"end":return i.stop()}},i,null,[[0,12]])}))()}},{key:"mapFirebaseError",value:function(e){switch(e.code){case"auth/email-already-in-use":return $localize(i||(i=Wg(["This email address is already in use."])));case"auth/invalid-email":return $localize(a||(a=Wg(["This email address is invalid."])));case"auth/user-not-found":case"auth/wrong-password":return $localize(o||(o=Wg(["You have entered invalid credentials."])));case"auth/invalid-credential":return $localize(s||(s=Wg(["The credential is invalid or has expired, please try again."])));case"auth/weak-password":return $localize(u||(u=Wg(["Your password is too weak, please use a stronger password."])));case"auth/too-many-requests":return $localize(c||(c=Wg(["There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later."])));case"auth/popup-closed-by-user":return $localize(l||(l=Wg(["You closed the authentication popup without finalizing your log in."])));case"auth/popup-blocked":return $localize(f||(f=Wg(["The authentication popup was blocked. Try again after disabling popup blocking."])));default:return L7.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}},{key:"sendEmailVerification",value:function(){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(AB(e.VERBOSE,"ConnectedUserService.sendEmailVerification()"),(r=NB.ofNullable(t.auth.currentUser)).isPresent()){n.next=4;break}return n.abrupt("return",L7.logError("ConnectedUserService","Unlogged users cannot request for email verification"));case 4:if(!t.emailVerified(r.get())){n.next=6;break}return n.abrupt("return",L7.logError("ConnectedUserService","Verified users should not ask email verification after being verified"));case 6:return n.prev=6,n.next=9,z7.sendEmailVerification(r.get());case 9:return n.abrupt("return",UB.SUCCESS);case 12:return n.prev=12,n.t0=n.catch(6),n.abrupt("return",UB.failure(t.mapFirebaseError(n.t0)));case 15:case"end":return n.stop()}},n,null,[[6,12]])}))()}},{key:"doEmailLogin",value:function(t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return AB(e.VERBOSE,"ConnectedUserService.doEmailLogin("+t+")"),i.prev=1,i.next=4,z7.signInWithEmailAndPassword(r.auth,t,n);case 4:return i.abrupt("return",UB.SUCCESS);case 7:return i.prev=7,i.t0=i.catch(1),i.abrupt("return",UB.failure(r.mapFirebaseError(i.t0)));case 10:case"end":return i.stop()}},i,null,[[1,7]])}))()}},{key:"createUser",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t){r.next=5;break}return r.next=3,n.userDAO.set(e,{verified:!1});case 3:r.next=7;break;case 5:return r.next=7,n.userDAO.set(e,{username:t,verified:!1});case 7:case"end":return r.stop()}},r)}))()}},{key:"doGoogleLogin",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=UB,t.next=3,e.registerOrLoginWithGoogle();case 3:return t.t1=t.sent,t.abrupt("return",t.t0.ofFallible.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t)}))()}},{key:"registerOrLoginWithGoogle",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new y6).addScope("profile"),n.addScope("email"),t.next=5,z7.signInWithPopup(e.auth,n);case 5:return r=t.sent,t.t0=!1,t.next=9,e.userDAO.exists(r.uid);case 9:if(t.t1=t.sent,t.t2=t.t0===t.t1,!t.t2){t.next=14;break}return t.next=14,e.createUser(r.uid);case 14:return t.abrupt("return",DB.success(r));case 17:return t.prev=17,t.t3=t.catch(0),t.abrupt("return",DB.failure(e.mapFirebaseError(t.t3)));case 20:case"end":return t.stop()}},t,null,[[0,17]])}))()}},{key:"disconnect",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!NB.ofNullable(e.auth.currentUser).isPresent()){t.next=6;break}return t.next=3,e.auth.signOut();case 3:t.t0=UB.SUCCESS,t.next=7;break;case 6:t.t0=UB.failure("Cannot disconnect a non-connected user");case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}},t)}))()}},{key:"subscribeToUser",value:function(e){return this.userObs.subscribe(e)}},{key:"setUsername",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e){n.next=2;break}return n.abrupt("return",UB.failure($localize(h||(h=Wg(["Your username may not be empty."])))));case 2:return n.prev=2,n.t0=!1,n.next=6,t.userService.usernameIsAvailable(e);case 6:if(n.t1=n.sent,n.t0!==n.t1){n.next=9;break}return n.abrupt("return",UB.failure($localize(d||(d=Wg(["This username is already in use, please select a different one."])))));case 9:return r=IB.getNonNullable(t.auth.currentUser),n.next=12,z7.updateProfile(r,{displayName:e});case 12:return n.next=14,t.userService.setUsername(r.uid,e);case 14:return n.next=16,t.userService.markAsVerified(r.uid);case 16:return n.next=18,t.reloadUser();case 18:return n.abrupt("return",UB.SUCCESS);case 21:return n.prev=21,n.t2=n.catch(2),n.abrupt("return",UB.failure(t.mapFirebaseError(n.t2)));case 24:case"end":return n.stop()}},n,null,[[2,21]])}))()}},{key:"setPicture",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=IB.getNonNullable(t.auth.currentUser),n.next=4,z7.updateProfile(r,{photoURL:e});case 4:return n.abrupt("return",UB.SUCCESS);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",UB.failure(t.mapFirebaseError(n.t0)));case 10:case"end":return n.stop()}},n,null,[[0,7]])}))()}},{key:"reloadUser",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=IB.getNonNullable(e.auth.currentUser),t.next=3,n.getIdToken(!0);case 3:return t.next=5,n.reload();case 5:case"end":return t.stop()}},t)}))()}},{key:"updateObservedPart",value:function(e){return F7(this.user.isPresent(),"Should not call updateObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:e})}},{key:"removeObservedPart",value:function(){return F7(this.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:null})}},{key:"sendPresenceToken",value:function(){return F7(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Bw(U7),Bw(V7),Bw(j8))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),$7=my(function e(t){gy(this,e),this.value=t});$7.HARD_DRAW=new $7(0),$7.RESIGN=new $7(1),$7.ESCAPE=new $7(2),$7.VICTORY=new $7(3),$7.TIMEOUT=new $7(4),$7.UNACHIEVED=new $7(5),$7.AGREED_DRAW_BY_ZERO=new $7(6),$7.AGREED_DRAW_BY_ONE=new $7(7);var Z7=function(){function e(t,n){gy(this,e),this.id=t,this.data=n}return my(e,[{key:"getTurn",value:function(){return this.data.turn}},{key:"isHardDraw",value:function(){return this.data.result===$7.HARD_DRAW.value}},{key:"isAgreedDraw",value:function(){return this.data.result===$7.AGREED_DRAW_BY_ZERO.value||this.data.result===$7.AGREED_DRAW_BY_ONE.value}},{key:"getDrawAccepter",value:function(){return this.data.result===$7.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(F7(this.data.result===$7.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),IB.getNonNullable(this.data.playerOne))}},{key:"isWin",value:function(){return this.data.result===$7.VICTORY.value}},{key:"isTimeout",value:function(){return this.data.result===$7.TIMEOUT.value}},{key:"isResign",value:function(){return this.data.result===$7.RESIGN.value}},{key:"getWinner",value:function(){return NB.ofNullable(this.data.winner)}},{key:"getLoser",value:function(){return NB.ofNullable(this.data.loser)}},{key:"setWinnerAndLoser",value:function(t,n){return new e(this.id,Yg(Yg({},this.data),{},{winner:t,loser:n}))}}]),e}(),q7=function(){function e(t){gy(this,e),this.value=t}return my(e,null,[{key:"of",value:function(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return F7("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}]),e}();q7.CREATOR=new q7("CREATOR"),q7.RANDOM=new q7("RANDOM"),q7.CHOSEN_PLAYER=new q7("CHOSEN_PLAYER");var W7=function(){function e(t){gy(this,e),this.value=t}return my(e,null,[{key:"of",value:function(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}]),e}();W7.STANDARD=new W7("STANDARD"),W7.BLITZ=new W7("BLITZ"),W7.CUSTOM=new W7("CUSTOM"),W7.NORMAL_MOVE_DURATION=120,W7.NORMAL_PART_DURATION=1800,W7.BLITZ_MOVE_DURATION=30,W7.BLITZ_PART_DURATION=900;var j7=my(function e(t){gy(this,e),this.value=t});j7.PART_CREATED=new j7(0),j7.CONFIG_PROPOSED=new j7(2),j7.PART_STARTED=new j7(3),j7.PART_FINISHED=new j7(4);var Y7=my(function e(){gy(this,e)}),K7=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"encode",value:function(e){return this.encodeMove(e)}},{key:"decode",value:function(e){return F7(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}],[{key:"disjunction3",value:function(e,t,r,i,a){return new(function(n){iy(s,n);var o=oy(s);function s(){return gy(this,s),o.apply(this,arguments)}return my(s,[{key:"encodeMove",value:function(n){return i(n)?{type:"T1",encoded:e.encode(n)}:a(n)?{type:"T2",encoded:t.encode(n)}:{type:"T3",encoded:r.encode(n)}}},{key:"decodeMove",value:function(n){var i=IB.getNonNullable(n).type,a=IB.getNonNullable(n).encoded;return"T1"===i?e.decode(a):"T2"===i?t.decode(a):r.decode(a)}}]),s}(n))}}]),n}(Y7),Q7=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"shift",value:function(){return this.maxValue()+1}},{key:"encodeMove",value:function(e){return this.encodeNumber(e)}},{key:"decodeMove",value:function(e){return F7("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}],[{key:"ofN",value:function(e,t,r){return new(function(n){iy(a,n);var i=oy(a);function a(){return gy(this,a),i.apply(this,arguments)}return my(a,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(e){return t(e)}},{key:"decodeNumber",value:function(e){return r(e)}}]),a}(n))}},{key:"tuple",value:function(e,t,r){return new(function(n){iy(a,n);var i=oy(a);function a(){return gy(this,a),i.apply(this,arguments)}return my(a,[{key:"maxValue",value:function(){var t=0;return Object.keys(e).forEach(function(n){t=t*e[n].shift()+e[n].maxValue()}),t}},{key:"encodeNumber",value:function(n){var r=t(n),i=0;return Object.keys(r).forEach(function(t){i=i*e[t].shift()+e[t].encode(r[t])}),i}},{key:"decodeNumber",value:function(t){var n={},i=t;return Object.keys(e).reverse().forEach(function(t){var r=i%e[t].shift();i=(i-r)/e[t].shift(),n[t]=e[t].decode(r)}),r(n)}}]),a}(n))}},{key:"disjunction",value:function(e,t,r){return new(function(n){iy(a,n);var i=oy(a);function a(){return gy(this,a),i.apply(this,arguments)}return my(a,[{key:"maxValue",value:function(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}},{key:"encodeNumber",value:function(n){return r(n)?2*e.encodeNumber(n):2*t.encodeNumber(n)+1}},{key:"decodeNumber",value:function(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}]),a}(n))}},{key:"numberEncoder",value:function(e){return new(function(t){iy(r,t);var n=oy(r);function r(){return gy(this,r),n.apply(this,arguments)}return my(r,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}},{key:"decodeNumber",value:function(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}]),r}(n))}}]),n}(K7);Q7.booleanEncoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 1}},{key:"encodeNumber",value:function(e){return e?1:0}},{key:"decodeNumber",value:function(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}}]),n}(Q7));var X7=function(){function e(){gy(this,e),this.value=2}return my(e,[{key:"isPlayer",value:function(){return!1}},{key:"toString",value:function(){return"PLAYER_NONE"}},{key:"equals",value:function(e){return this===e}}]),e}();X7.NONE=new X7;var J7,e9=function(){function e(t){gy(this,e),this.value=t}return my(e,[{key:"isPlayer",value:function(){return!0}},{key:"toString",value:function(){return this===e.ZERO?"PLAYER_ZERO":(IB.expectToBe(this,e.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}},{key:"equals",value:function(e){return this===e}},{key:"getScoreModifier",value:function(){return 0===this.value?-1:1}},{key:"getPreVictory",value:function(){return this.getVictoryValue()-this.getScoreModifier()}},{key:"getDefeatValue",value:function(){return this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}},{key:"getVictoryValue",value:function(){return this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}},{key:"getOpponent",value:function(){return this===e.ZERO?e.ONE:(IB.expectToBe(this,e.ONE),e.ZERO)}}],[{key:"of",value:function(t){return 0===t?e.ZERO:(IB.expectToBe(t,1),e.ONE)}},{key:"fromTurn",value:function(t){return t%2==0?e.ZERO:e.ONE}}]),e}();e9.numberEncoder=Q7.ofN(2,function(e){return e.value},function(e){return 2===e?J7.NONE:e9.of(e)}),e9.ZERO=new e9(0),e9.ONE=new e9(1),e9.PLAYERS=[e9.ZERO,e9.ONE],function(e){e.ZERO=e9.ZERO,e.ONE=e9.ONE,e.NONE=X7.NONE}(J7||(J7={}));var t9=function(){function e(){gy(this,e)}return my(e,null,[{key:"rematchAccepted",value:function(e,t){return n9("RematchAccepted",{typeGame:e,partId:t})}},{key:"getPlayer",value:function(e){return e9.of(IB.getNonNullable(e.data).player)}},{key:"getTypeGame",value:function(e){return IB.getNonNullable(e.data).typeGame}},{key:"getPartId",value:function(e){return IB.getNonNullable(e.data).partId}}]),e}();function n9(e,t){return{code:e,data:t}}function r9(e){return function(t){return n9(e,{player:t.value})}}t9.drawProposed=r9("DrawProposed"),t9.drawAccepted=n9("DrawAccepted",{}),t9.drawRefused=r9("DrawRefused"),t9.takeBackAsked=r9("TakeBackAsked"),t9.takeBackRefused=r9("TakeBackRefused"),t9.takeBackAccepted=r9("TakeBackAccepted"),t9.rematchProposed=r9("RematchProposed"),t9.addTurnTime=r9("AddTurnTime"),t9.addGlobalTime=r9("AddGlobalTime");var i9=function(){function e(){gy(this,e)}return my(e,null,[{key:"mapBiArray",value:function(e,t){for(var n=[],r=0;r<e.length;){n[r]=[];for(var i=0;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}},{key:"createTable",value:function(e,t,n){for(var r=[],i=t-1;i>=0;){r[i]=[];for(var a=e-1;a>=0;)r[i][a]=n,a--;i--}return r}},{key:"copyBiArray",value:function(t){for(var n=[],r=0;r<t.length;)n[r]=e.copyImmutableArray(t[r]),r++;return n}},{key:"copyImmutableArray",value:function(e){for(var t=[],n=0;n<e.length;)t[n]=e[n],n++;return t}},{key:"sortByDescending",value:function(e,t){e.sort(function(e,n){var r=t(e),i=t(n);return r<i?1:r>i?-1:0})}},{key:"compareArray",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!1===RB(e[n],t[n]))return!1;return!0}},{key:"compareTable",value:function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!1===e.compareArray(t[r],n[r]))return!1;return!0}}]),e}(),a9=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),r=t.call(this,"parts",e),AB(n.VERBOSE,"PartDAO.constructor"),r}return my(n)}(I7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Bw(c7))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),o9=my(function e(t,n,r){gy(this,e),this.onDocumentCreated=t,this.onDocumentModified=n,this.onDocumentDeleted=r}),s9=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),r=t.call(this,"config-room",e),AB(n.VERBOSE,"ConfigRoomDAO.constructor"),r}return my(n)}(I7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Bw(c7))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),u9=function(){var e=function(){function e(t,n){gy(this,e),this.configRoomDAO=t,this.connectedUserService=n,AB(e.VERBOSE,"ConfigRoomService.constructor")}return my(e,[{key:"addCandidate",value:function(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}},{key:"removeCandidate",value:function(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}},{key:"subscribeToChanges",value:function(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}},{key:"subscribeToCandidates",value:function(e,t){var n=[],r=new o9(function(e){var r,i=dy(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.push(a.data)}}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=dy(e);try{var a=function(){var e=r.value;n=n.map(function(t){return t.id===e.data.id?e.data:t})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=dy(e);try{var a=function(){var e=r.value;n=n.filter(function(t){return t.id!==e.data.id})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],r)}},{key:"createInitialConfigRoom",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return AB(e.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.abrupt("return",n.configRoomDAO.set(t,{chosenOpponent:null,firstPlayer:q7.RANDOM.value,partType:W7.STANDARD.value,partStatus:j7.PART_CREATED.value,maximalMoveDuration:W7.NORMAL_MOVE_DURATION,totalPartDuration:W7.NORMAL_PART_DURATION,creator:i}));case 3:case"end":return r.stop()}},r)}))()}},{key:"joinGame",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return AB(e.VERBOSE,"ConfigRoomService.joinGame("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.next=4,n.configRoomDAO.read(t);case 4:if(!(a=r.sent).isAbsent()){r.next=9;break}r.t0=UB.failure(e.GAME_DOES_NOT_EXIST()),r.next=14;break;case 9:if(r.t1=a.get().creator.id!==i.id,!r.t1){r.next=13;break}return r.next=13,n.addCandidate(t,i);case 13:r.t0=UB.SUCCESS;case 14:return r.abrupt("return",r.t0);case 15:case"end":return r.stop()}},r)}))()}},{key:"cancelJoining",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return AB(e.VERBOSE,"ConfigRoomService.cancelJoining(".concat(t,")")),i=n.connectedUserService.user.get().toMinimalUser(),r.next=4,n.configRoomDAO.read(t);case 4:if((a=r.sent).isAbsent()){r.next=10;break}return s=a.get(),u=[n.removeCandidate(t,i)],(null===(o=s.chosenOpponent)||void 0===o?void 0:o.id)===i.id&&u.push(n.configRoomDAO.update(t,{chosenOpponent:null,partStatus:j7.PART_CREATED.value})),r.next=10,Promise.all(u);case 10:case"end":return r.stop()}},r)}))()}},{key:"deleteConfigRoom",value:function(t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return AB(e.VERBOSE,"ConfigRoomService.deleteConfigRoom(".concat(t)),i.next=3,Promise.all(n.map(function(e){return r.removeCandidate(t,e)}));case 3:return i.next=5,r.configRoomDAO.delete(t);case 5:case"end":return i.stop()}},i)}))()}},{key:"proposeConfig",value:function(t,n,r,i,a,o){var s=this;return TB(regeneratorRuntime.mark(function u(){return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(AB(e.VERBOSE,{configRoomService_proposeConfig:{configRoomId:t,maximalMoveDuration:i,firstPlayer:a,totalPartDuration:o}}),s.configRoomDAO.update(t,{partStatus:j7.CONFIG_PROPOSED.value,chosenOpponent:n,partType:r.value,maximalMoveDuration:i,totalPartDuration:o,firstPlayer:a.value})));case 1:case"end":return u.stop()}},u)}))()}},{key:"setChosenOpponent",value:function(t,n){return AB(e.VERBOSE,"ConfigRoomService.setChosenOpponent(".concat(t,", ").concat(n.name,")")),this.configRoomDAO.update(t,{chosenOpponent:n})}},{key:"reviewConfig",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(AB(e.VERBOSE,"ConfigRoomService.reviewConfig(".concat(t,")")),n.configRoomDAO.update(t,{partStatus:j7.PART_CREATED.value})));case 1:case"end":return r.stop()}},r)}))()}},{key:"reviewConfigAndRemoveChosenOpponent",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(AB(e.VERBOSE,"ConfigRoomService.reviewConfigAndRemoveChosenOpponent(".concat(t,")")),n.configRoomDAO.update(t,{partStatus:j7.PART_CREATED.value,chosenOpponent:null})));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(t){return AB(e.VERBOSE,"ConfigRoomService.acceptConfig(".concat(t)),this.configRoomDAO.update(t,{partStatus:j7.PART_STARTED.value})}},{key:"createConfigRoom",value:function(t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(AB(e.VERBOSE,"ConfigRoomService.create(".concat(t)+JSON.stringify(n)+")"),r.configRoomDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"readConfigRoomById",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return AB(e.VERBOSE,"ConfigRoomService.readConfigRoomById(".concat(t,")")),r.next=3,n.configRoomDAO.read(t);case 3:return r.abrupt("return",r.sent.get());case 4:case"end":return r.stop()}},r)}))()}}]),e}();return e.VERBOSE=!1,e.GAME_DOES_NOT_EXIST=function(){return $localize(v||(v=Wg(["Game does not exist"])))},e.\u0275fac=function(t){return new(t||e)(Bw(s9),Bw(G7))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),c9=function(){var e=function(){function e(t,n,r,i){gy(this,e),this.partDAO=t,this.connectedUserService=n,this.configRoomService=r,this.chatService=i,AB(e.VERBOSE,"GameService.constructor")}return my(e,[{key:"updateAndBumpIndex",value:function(e,t,n,r){var i=this;return TB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(r=Yg(Yg({},r),{},{lastUpdate:{index:n+1,player:t.value}}),i.partDAO.update(e,r)));case 1:case"end":return a.stop()}},a)}))()}},{key:"getPartValidity",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.partDAO.read(e);case 2:return i=r.sent,r.abrupt("return",i.isAbsent()?UB.failure("NONEXISTENT_PART"):i.get().typeGame===t?UB.SUCCESS:UB.failure("WRONG_GAME_TYPE"));case 4:case"end":return r.stop()}},r)}))()}},{key:"createUnstartedPart",value:function(t){AB(e.VERBOSE,"GameService.createPart("+t+")");var n=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:t,playerZero:n,turn:-1,result:$7.UNACHIEVED.value,listMoves:[]})}},{key:"createChat",value:function(t){return AB(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}},{key:"createPartConfigRoomAndChat",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return AB(e.VERBOSE,"GameService.createGame(".concat(t,")")),r.next=3,n.createUnstartedPart(t);case 3:return i=r.sent,r.next=6,n.configRoomService.createInitialConfigRoom(i);case 6:return r.next=8,n.createChat(i);case 8:return r.abrupt("return",i);case 9:case"end":return r.stop()}},r)}))()}},{key:"startGameWithConfig",value:function(t,n,r,i){AB(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));var a=this.getStartingConfig(i);return this.updateAndBumpIndex(t,n,r,a)}},{key:"getStartingConfig",value:function(e){var t,n,r=q7.of(e.firstPlayer);return r===q7.RANDOM&&(r=Math.random()<.5?q7.CREATOR:q7.CHOSEN_PLAYER),r===q7.CREATOR?(t=e.creator,n=IB.getNonNullable(e.chosenOpponent)):(t=IB.getNonNullable(e.chosenOpponent),n=e.creator),{playerZero:t,playerOne:n,turn:0,beginning:r1(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}},{key:"deletePart",value:function(t){return AB(e.VERBOSE,"GameService.deletePart("+t+")"),this.partDAO.delete(t)}},{key:"acceptConfig",value:function(t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return AB(e.VERBOSE,{gameService_acceptConfig:{partId:t,configRoom:n}}),i.next=3,r.configRoomService.acceptConfig(t);case 3:return i.abrupt("return",r.startGameWithConfig(t,e9.ONE,0,n));case 4:case"end":return i.stop()}},i)}))()}},{key:"subscribeToChanges",value:function(e,t){return this.partDAO.subscribeToChanges(e,t)}},{key:"resign",value:function(e,t,n,r,i){return this.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:$7.RESIGN.value,request:null})}},{key:"notifyTimeout",value:function(e,t,n,r,i){return this.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:$7.TIMEOUT.value,request:null})}},{key:"sendRequest",value:function(e,t,n,r){return this.updateAndBumpIndex(e,t,n,{request:r})}},{key:"proposeDraw",value:function(e,t,n){return this.sendRequest(e,n,t,t9.drawProposed(n))}},{key:"acceptDraw",value:function(e,t,n){return this.updateAndBumpIndex(e,n,t,{result:(n===e9.ZERO?$7.AGREED_DRAW_BY_ZERO:$7.AGREED_DRAW_BY_ONE).value,request:null})}},{key:"refuseDraw",value:function(e,t,n){return this.sendRequest(e,n,t,t9.drawRefused(n))}},{key:"proposeRematch",value:function(e,t,n){return this.sendRequest(e,n,t,t9.rematchProposed(n))}},{key:"acceptRematch",value:function(t,n,r){var i=this;return TB(regeneratorRuntime.mark(function a(){var o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return AB(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t}),o=IB.getNonNullable(t.data),a.next=4,i.configRoomService.readConfigRoomById(t.id);case 4:return s=a.sent,c=i.connectedUserService.user.get().toMinimalUser(),o.playerZero.id===c.id?(l=IB.getNonNullable(o.playerOne),u=q7.CHOSEN_PLAYER):(l=o.playerZero,u=q7.CREATOR),f=Yg(Yg({},s),{},{firstPlayer:u.value,creator:c,chosenOpponent:l,partStatus:j7.PART_STARTED.value}),h=i.getStartingConfig(f),d=Yg({lastUpdate:{index:0,player:r.value},typeGame:o.typeGame,result:$7.UNACHIEVED.value,listMoves:[]},h),a.next=12,i.partDAO.create(d);case 12:return v=a.sent,a.next=15,i.configRoomService.createConfigRoom(v,f);case 15:return a.next=17,i.createChat(v);case 17:return a.abrupt("return",i.sendRequest(t.id,r,n,t9.rematchAccepted(o.typeGame,v)));case 18:case"end":return a.stop()}},a)}))()}},{key:"askTakeBack",value:function(e,t,n){return this.sendRequest(e,n,t,t9.takeBackAsked(n))}},{key:"acceptTakeBack",value:function(e,t,n,r){var i=this;return TB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return F7(t9.getPlayer(IB.getNonNullable(t.data.request))!==n,"Illegal to accept your own request"),o=t9.takeBackAccepted(n),(s=t.data.listMoves.slice(0,t.data.listMoves.length-1)).length%2===n.value&&(s=s.slice(0,s.length-1)),u={request:o,listMoves:s,turn:s.length,lastUpdateTime:r1(),remainingMsForZero:IB.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:IB.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index,a.next=7,i.updateAndBumpIndex(e,n,c,u);case 7:return a.abrupt("return",a.sent);case 8:case"end":return a.stop()}},a)}))()}},{key:"refuseTakeBack",value:function(e,t,n){var r=t9.takeBackRefused(n);return this.updateAndBumpIndex(e,n,t,{request:r})}},{key:"addGlobalTime",value:function(e,t,n,r){var i=this;return TB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o={request:t9.addGlobalTime(r.getOpponent())},o=r===e9.ZERO?Yg(Yg({},o),{},{remainingMsForOne:IB.getNonNullable(n.remainingMsForOne)+3e5}):Yg(Yg({},o),{},{remainingMsForZero:IB.getNonNullable(n.remainingMsForZero)+3e5}),a.next=4,i.updateAndBumpIndex(e,r,t,o);case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},a)}))()}},{key:"addTurnTime",value:function(e,t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={request:t9.addTurnTime(e.getOpponent())},i.next=3,r.updateAndBumpIndex(n,e,t,a);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(t,n,r,i,a,o,s,u){var c=this;return TB(regeneratorRuntime.mark(function l(){var f,h,d,v,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return AB(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:a,msToSubstract:i,notifyDraw:o,winner:s,loser:u}}),l.next=3,c.partDAO.read(t);case 3:return f=l.sent.get(),h=f.lastUpdate.index,d=f.turn+1,(v=i9.copyImmutableArray(f.listMoves))[v.length]=r,p={listMoves:v,turn:d,request:null,lastUpdateTime:r1()},p=c.updateScore(p,a),p=c.substractMs(p,f,i),null!=s?p=Yg(Yg({},p),{},{winner:s,loser:u,result:$7.VICTORY.value}):!0===o&&(p=Yg(Yg({},p),{},{result:$7.HARD_DRAW.value})),l.next=14,c.updateAndBumpIndex(t,n,h,p);case 14:return l.abrupt("return",l.sent);case 15:case"end":return l.stop()}},l)}))()}},{key:"updateScore",value:function(e,t){return void 0!==t?Yg(Yg({},e),{},{scorePlayerZero:t[0],scorePlayerOne:t[1]}):e}},{key:"substractMs",value:function(e,t,n){return n[0]>0?Yg(Yg({},e),{},{remainingMsForZero:IB.getNonNullable(t.remainingMsForZero)-n[0]}):n[1]>0?Yg(Yg({},e),{},{remainingMsForOne:IB.getNonNullable(t.remainingMsForOne)-n[1]}):e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Bw(a9),Bw(G7),Bw(u9),Bw(x7))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),l9={prefix:"fab",iconName:"facebook",icon:[512,512,[],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},f9={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},h9={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]},d9=function(){function e(){gy(this,e)}return my(e,null,[{key:"getNavigatorLanguage",value:function(){return navigator.language}},{key:"getLocale",value:function(){var t,n,r=(null!==(t=null!==(n=localStorage.getItem("locale"))&&void 0!==n?n:e.getNavigatorLanguage())&&void 0!==t?t:"fr").slice(0,2).toLowerCase();return["en","fr"].some(function(e){return e===r})?r:"fr"}}]),e}(),v9=function(){var e=function(){function e(){gy(this,e)}return my(e,[{key:"changeTheme",value:function(e){localStorage.setItem("theme",e)}},{key:"getTheme",value:function(){return NB.ofNullable(localStorage.getItem("theme"))}},{key:"changeLanguage",value:function(e){localStorage.setItem("locale",e.toLowerCase())}},{key:"getLanguage",value:function(){return d9.getLocale()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),p9=function(){var e=function(){function e(t,n){gy(this,e),this.document=t,this.userSettingsService=n,this.availableThemes=["dark","light"];var r=this.getStoredTheme();r.isPresent()?this.loadTheme(r.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}return my(e,[{key:"getStoredTheme",value:function(){var e=this.userSettingsService.getTheme();if(e.isPresent()){var t=e.get();if(this.availableThemes.some(function(e){return e===t}))return NB.of(t)}return NB.empty()}},{key:"loadTheme",value:function(e){this.loadStyle(e+".css"),this.theme=e}},{key:"loadStyle",value:function(e){var t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{var r=this.document.createElement("link");r.id="theme",r.rel="stylesheet",r.href="".concat(e),t.appendChild(r)}}},{key:"getTheme",value:function(){return this.theme}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(eA),Bw(v9))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),g9={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},y9={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},m9={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},k9={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},C9={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},w9={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]},_9={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"]};function E9(e){return(E9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b9(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P9(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){b9(e,t,n[t])})}return e}function S9(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){i=!0,a=u}finally{try{!r&&null!=s.return&&s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var O9={},T9={};try{"undefined"!=typeof window&&(O9=window),"undefined"!=typeof document&&(T9=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(Vme){}var I9=(O9.navigator||{}).userAgent,A9=void 0===I9?"":I9,M9=O9,x9=T9,R9=!!x9.documentElement&&!!x9.head&&"function"==typeof x9.addEventListener&&"function"==typeof x9.createElement,N9=(~A9.indexOf("MSIE")||A9.indexOf("Trident/"),"___FONT_AWESOME___"),D9="svg-inline--fa",L9=[1,2,3,4,5,6,7,8,9,10],F9=L9.concat([11,12,13,14,15,16,17,18,19,20]),U9={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},V9=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",U9.GROUP,U9.SWAP_OPACITY,U9.PRIMARY,U9.SECONDARY].concat(L9.map(function(e){return"".concat(e,"x")})).concat(F9.map(function(e){return"w-".concat(e)})),M9.FontAwesomeConfig||{});x9&&"function"==typeof x9.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=S9(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=x9.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(V9[n]=r)});var B9=P9({},{familyPrefix:"fa",replacementClass:D9,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},V9);B9.autoReplaceSvg||(B9.observeMutations=!1);var z9=P9({},B9);M9.FontAwesomeConfig=z9;var H9=M9||{};H9[N9]||(H9[N9]={}),H9[N9].styles||(H9[N9].styles={}),H9[N9].hooks||(H9[N9].hooks={}),H9[N9].shims||(H9[N9].shims=[]);var G9=H9[N9],$9=[];R9&&((x9.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(x9.readyState)||x9.addEventListener("DOMContentLoaded",function e(){x9.removeEventListener("DOMContentLoaded",e),$9.map(function(e){return e()})}));var Z9,q9="pending",W9="fulfilled",j9="rejected",Y9=function(){},K9="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,Q9="undefined"==typeof setImmediate?setTimeout:setImmediate,X9=[];function J9(){for(var e=0;e<X9.length;e++)X9[e][0](X9[e][1]);X9=[],Z9=!1}function eee(e,t){X9.push([e,t]),Z9||(Z9=!0,Q9(J9,0))}function tee(e){var t=e.owner,n=t._state,r=t._data,i=e[n],a=e.then;if("function"==typeof i){n=W9;try{r=i(r)}catch(o){aee(a,o)}}nee(a,r)||(n===W9&&ree(a,r),n===j9&&aee(a,r))}function nee(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===E9(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?iee(e,r):ree(e,r))},function(t){n||(n=!0,aee(e,t))}),!0}}catch(i){return n||aee(e,i),!0}return!1}function ree(e,t){(e===t||!nee(e,t))&&iee(e,t)}function iee(e,t){e._state===q9&&(e._state="settled",e._data=t,eee(see,e))}function aee(e,t){e._state===q9&&(e._state="settled",e._data=t,eee(uee,e))}function oee(e){e._then=e._then.forEach(tee)}function see(e){e._state=W9,oee(e)}function uee(e){e._state=j9,oee(e),!e._handled&&K9&&global.process.emit("unhandledRejection",e._data,e)}function cee(e){global.process.emit("rejectionHandled",e)}function lee(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof lee))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){aee(t,e)}try{e(function(e){ree(t,e)},n)}catch(r){n(r)}}(e,this)}lee.prototype={constructor:lee,_state:q9,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(Y9),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===j9&&K9&&eee(cee,this)),this._state===W9||this._state===j9?eee(tee,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},lee.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new lee(function(t,n){var r=[],i=0;function a(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),n):r[s]=o;i||t(r)})},lee.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new lee(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},lee.resolve=function(e){return e&&"object"===E9(e)&&e.constructor===lee?e:new lee(function(t){t(e)})},lee.reject=function(e){return new lee(function(t,n){n(e)})};var fee={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function hee(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function dee(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function vee(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function pee(e){return e.size!==fee.size||e.x!==fee.x||e.y!==fee.y||e.rotate!==fee.rotate||e.flipX||e.flipY}function gee(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(a," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var yee={x:0,y:0,width:"100%",height:"100%"};function mee(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function kee(e){return"g"===e.tag?e.children:[e]}function Cee(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,a=e.iconName,o=e.transform,s=e.symbol,u=e.title,c=e.maskId,l=e.titleId,f=e.extra,h=e.watchable,d=void 0!==h&&h,v=r.found?r:n,p=v.width,g=v.height,y="fak"===i,m=y?"":"fa-w-".concat(Math.ceil(p/g*16)),k=[z9.replacementClass,a?"".concat(z9.familyPrefix,"-").concat(a):"",m].filter(function(e){return-1===f.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(f.classes).join(" "),C={children:[],attributes:P9({},f.attributes,{"data-prefix":i,"data-icon":a,class:k,role:f.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(g)})},w=y&&!~f.classes.indexOf("fa-fw")?{width:"".concat(p/g*16*.0625,"em")}:{};d&&(C.attributes["data-fa-i2svg"]=""),u&&C.children.push({tag:"title",attributes:{id:C.attributes["aria-labelledby"]||"title-".concat(l||hee())},children:[u]});var _=P9({},C,{prefix:i,iconName:a,main:n,mask:r,maskId:c,transform:o,symbol:s,styles:P9({},w,f.styles)}),E=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,a=e.maskId,o=r.icon,s=i.icon,u=gee({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:P9({},yee,{fill:"white"})},l=o.children?{children:o.children.map(mee)}:{},f={tag:"g",attributes:P9({},u.inner),children:[mee(P9({tag:o.tag,attributes:P9({},o.attributes,u.path)},l))]},h={tag:"g",attributes:P9({},u.outer),children:[f]},d="mask-".concat(a||hee()),v="clip-".concat(a||hee()),p={tag:"mask",attributes:P9({},yee,{id:d,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,h]},g={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:kee(s)},p]};return t.push(g,{tag:"rect",attributes:P9({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(d,")")},yee)}),{children:t,attributes:n}}(_):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,a=vee(e.styles);if(a.length>0&&(n.style=a),pee(i)){var o=gee({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:P9({},o.outer),children:[{tag:"g",attributes:P9({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:P9({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(_),b=E.attributes;return _.children=E.children,_.attributes=b,s?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:P9({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(z9.familyPrefix,"-").concat(t):r}),children:n}]}]}(_):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,a=e.styles,o=e.transform;if(pee(o)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=vee(P9({},a,{"transform-origin":"".concat(s.x+o.x/16,"em ").concat(s.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(_)}var wee=function(e,t,n,r){var i,a,o,s=Object.keys(e),u=s.length,c=void 0!==r?function(e,t){return function(n,r,i,a){return e.call(t,n,r,i,a)}}(t,r):t;for(void 0===n?(i=1,o=e[s[0]]):(i=0,o=n);i<u;i++)o=c(o,e[a=s[i]],a,e);return o};function _ee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,a=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof G9.hooks.addPack||i?G9.styles[e]=P9({},G9.styles[e]||{},a):G9.hooks.addPack(e,a),"fas"===e&&_ee("fa",t)}var Eee=G9.styles,bee=G9.shims,Pee=function(){var e=function(e){return wee(Eee,function(t,n,r){return t[r]=wee(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in Eee;wee(bee,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function See(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function Oee(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,a=void 0===i?[]:i;return"string"==typeof e?dee(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(dee(e[n]),'" ')},"").trim()}(r),">").concat(a.map(Oee).join(""),"</").concat(t,">")}function Tee(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}Pee(),(Tee.prototype=Object.create(Error.prototype)).constructor=Tee;var Iee={fill:"currentColor"},Aee={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},Mee=(P9({},Iee,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),P9({},Aee,{attributeName:"opacity"}));function xee(e){var t=e[0],n=e[1],r=S9(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(z9.familyPrefix,"-").concat(U9.GROUP)},children:[{tag:"path",attributes:{class:"".concat(z9.familyPrefix,"-").concat(U9.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(z9.familyPrefix,"-").concat(U9.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}P9({},Iee,{cx:"256",cy:"364",r:"28"}),P9({},Aee,{attributeName:"r",values:"28;14;28;28;14;28;"}),P9({},Mee,{values:"1;0;1;1;0;1;"}),P9({},Iee,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),P9({},Mee,{values:"1;0;0;0;0;1;"}),P9({},Iee,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),P9({},Mee,{values:"0;0;1;1;0;0;"});var Ree=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=P9({},e.definitions[t]||{},i[t]),_ee(t,i[t]),Pee()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,a=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][a]=o}),e}}]),e}();function Nee(){z9.autoAddCss&&!Uee&&(function(e){if(e&&R9){var t=x9.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=x9.head.childNodes,r=null,i=n.length-1;i>-1;i--){var a=n[i],o=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=a)}x9.head.insertBefore(t,r)}}(function(){var e="fa",t=D9,n=z9.familyPrefix,r=z9.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var a=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(a,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(s,".".concat(r))}return i}()),Uee=!0)}function Dee(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return Oee(e)})}}),Object.defineProperty(e,"node",{get:function(){if(R9){var t=x9.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function Lee(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return See(Fee.definitions,n,r)||See(G9.styles,n,r)}var Fee=new Ree,Uee=!1,Vee=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:Lee(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:Lee(i||{})),e(r,P9({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?fee:n,i=t.symbol,a=void 0!==i&&i,o=t.mask,s=void 0===o?null:o,u=t.maskId,c=void 0===u?null:u,l=t.title,f=void 0===l?null:l,h=t.titleId,d=void 0===h?null:h,v=t.classes,p=void 0===v?[]:v,g=t.attributes,y=void 0===g?{}:g,m=t.styles,k=void 0===m?{}:m;if(e){var C=e.prefix,w=e.iconName,_=e.icon;return Dee(P9({type:"icon"},e),function(){return Nee(),z9.autoA11y&&(f?y["aria-labelledby"]="".concat(z9.replacementClass,"-title-").concat(d||hee()):(y["aria-hidden"]="true",y.focusable="false")),Cee({icons:{main:xee(_),mask:s?xee(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:C,iconName:w,transform:P9({},fee,r),symbol:a,title:f,maskId:c,titleId:d,extra:{attributes:y,styles:k,classes:p}})})}}),Bee=["*"],zee=function(e){var t,n=(Kg(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip},"fa-".concat(e.size),null!==e.size),Kg(t,"fa-rotate-".concat(e.rotate),null!==e.rotate),Kg(t,"fa-pull-".concat(e.pull),null!==e.pull),Kg(t,"fa-stack-".concat(e.stackItemSize),null!=e.stackItemSize),t);return Object.keys(n).map(function(e){return n[e]?e:null}).filter(function(e){return e})},Hee=function(){var e=my(function e(){gy(this,e),this.defaultPrefix="fas",this.fallbackIcon=null});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Gee=function(){var e=function(){function e(){gy(this,e),this.definitions={}}return my(e,[{key:"addIcons",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];a.prefix in this.definitions||(this.definitions[a.prefix]={}),this.definitions[a.prefix][a.iconName]=a;var o,s=dy(a.icon[2]);try{for(s.s();!(o=s.n()).done;){var u=o.value;"string"==typeof u&&(this.definitions[a.prefix][u]=a)}}catch(c){s.e(c)}finally{s.f()}}}},{key:"addIconPacks",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=o[a],n=Object.keys(t).map(function(e){return t[e]});e.addIcons.apply(e,fy(n))},a=0,o=n;a<o.length;a++)i()}},{key:"getIconDefinition",value:function(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),$ee=function(){var e=function(){function e(){gy(this,e),this.stackItemSize="1x"}return my(e,[{key:"ngOnChanges",value:function(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ck({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[Rk]}),e}(),Zee=function(){var e=function(){function e(t,n){gy(this,e),this.renderer=t,this.elementRef=n}return my(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}},{key:"ngOnChanges",value:function(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,"fa-".concat(e.size.currentValue)),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,"fa-".concat(e.size.previousValue)))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(LO),_P(RO))},e.\u0275cmp=vk({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[Rk],ngContentSelectors:Bee,decls:1,vars:0,template:function(e,t){1&e&&(function(e){var t=rC()[16][6];if(!t.projection)for(var n=t.projection=Ow(1,null),r=n.slice(),i=t.child;null!==i;){r[0]?r[0].projectionNext=i:n[0]=i,r[0]=i,i=i.next}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=rC(),i=iC(),a=KE(i,20+e,16,null,n||null);null===a.projection&&(a.projection=t),fC(),64!=(64&a.flags)&&function(e,t,n){PE(t[11],0,t,n,sE(e,n,t),dE(n.parent||t[6],n,t))}(i,r,a)}(0))},encapsulation:2}),e}(),qee=function(){var e=function(){function e(t,n,r,i,a){gy(this,e),this.sanitizer=t,this.config=n,this.iconLibrary=r,this.stackItem=i,this.classes=[],null!=a&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}return my(e,[{key:"ngOnChanges",value:function(e){var t;if(null==this.icon&&null==this.config.fallbackIcon)return function(){throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")}();var n;if(n=null!==(t=this.icon)&&void 0!==t?t:this.config.fallbackIcon,e){var r=this.findIconDefinition(n);if(null!=r){var i=this.buildParams();this.renderIcon(r,i)}}}},{key:"render",value:function(){this.ngOnChanges({})}},{key:"findIconDefinition",value:function(e){var t,n,r,i,a=(n=e,r=this.config.defaultPrefix,void 0!==(i=n).prefix&&void 0!==i.iconName?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:r,iconName:n}:void 0);return"icon"in a?a:null!==(t=this.iconLibrary.getIconDefinition(a.prefix,a.iconName))&&void 0!==t?t:(function(e){throw new Error("Could not find icon with iconName=".concat(e.iconName," and prefix=").concat(e.prefix," in the icon library."))}(a),null)}},{key:"buildParams",value:function(){var e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(this.transform):this.transform;return{title:this.title,transform:t,classes:[].concat(fy(zee(e)),fy(this.classes)),mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}},{key:"renderIcon",value:function(e,t){var n=Vee(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(GM),_P(Hee),_P(Gee),_P($ee,8),_P(Zee,8))},e.\u0275cmp=vk({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(dS("innerHTML",t.renderedIconHTML,x_),pP("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[Rk],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),Wee=function(){var e=my(function e(){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e}),e.\u0275inj=Vm({}),e}();function jee(e,t){if(1&e&&(TP(0),OP(1,"fa-icon",24),IP()),2&e){var n=LP();BE(1),EP("icon",n.faSpinner)}}function Yee(e,t){if(1&e){var n=AP();TP(0),PP(1,"div",9),PP(2,"a",10),uS(3),SP(),PP(4,"div",12),PP(5,"a",26),RP("click",function(){return aC(n),LP(2).logout()}),gO(6,27),SP(),SP(),SP(),IP()}if(2&e){var r=LP(2);BE(3),cS(r.username.get())}}var Kee=function(){return["/register"]},Qee=function(){return["/login"]};function Xee(e,t){1&e&&(PP(0,"div",28),PP(1,"a",29),PP(2,"strong"),gO(3,30),SP(),SP(),PP(4,"a",31),gO(5,32),SP(),SP()),2&e&&(BE(1),EP("routerLink",AT(2,Kee)),BE(3),EP("routerLink",AT(3,Qee)))}function Jee(e,t){if(1&e&&(CP(0,Yee,7,1,"ng-container",22),CP(1,Xee,6,4,"ng-template",null,25,tI)),2&e){var n=wP(2);EP("ngIf",LP().username.isPresent())("ngIfElse",n)}}var ete=function(){return["/"]},tte=function(){return["/play"]},nte=function(){return["/lobby"]},rte=function(){return["/local"]},ite=function(){return["/tutorial"]},ate=function(){return["/settings"]},ote=function(){var e=function(){function e(t,n,r){gy(this,e),this.router=t,this.connectedUserService=n,this.userService=r,this.loading=!0,this.username=NB.empty(),this.faCog=y9,this.faSpinner=_9,this.showMenu=!1}return my(e,[{key:"ngOnInit",value:function(){var e=this;this.userSub=this.connectedUserService.subscribeToUser(function(t){e.loading=!1,e.username=t.username.isPresent()?t.username:t.email})}},{key:"logout",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.disconnect();case 2:return t.next=4,e.router.navigate(["/"]);case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(yF),_P(G7),_P(V7))},e.\u0275cmp=vk({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){return[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],$localize(p||(p=Wg(["Home"]))),[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],$localize(g||(g=Wg(["Play online"]))),[1,"navbar-dropdown"],$localize(y||(y=Wg(["Create a game"]))),$localize(m||(m=Wg(["Join a game"]))),$localize(k||(k=Wg(["Play offline"]))),$localize(C||(C=Wg(["Create a game"]))),$localize(w||(w=Wg(["Learn the rules"]))),[1,"navbar-end"],["data-tooltip",$localize(_||(_=Wg(["Settings"]))),1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","logout",1,"navbar-item",3,"click"],$localize(E||(E=Wg(["Log out"]))),[1,"buttons"],[1,"button","is-primary",3,"routerLink"],$localize(b||(b=Wg(["Register"]))),[1,"button","is-light",3,"routerLink"],$localize(P||(P=Wg(["Log in"])))]},template:function(e,t){if(1&e&&(PP(0,"nav",0),PP(1,"div",1),PP(2,"a",2),OP(3,"img",3),SP(),PP(4,"a",4),RP("click",function(){return t.showMenu=!t.showMenu}),OP(5,"span",5),OP(6,"span",5),OP(7,"span",5),SP(),SP(),PP(8,"div",6),RP("click",function(){return t.showMenu=!t.showMenu}),PP(9,"div",7),PP(10,"a",2),gO(11,8),SP(),PP(12,"div",9),PP(13,"a",10),gO(14,11),SP(),PP(15,"div",12),PP(16,"a",2),gO(17,13),SP(),PP(18,"a",2),gO(19,14),SP(),SP(),SP(),PP(20,"div",9),PP(21,"a",10),gO(22,15),SP(),PP(23,"div",12),PP(24,"a",2),gO(25,16),SP(),PP(26,"a",2),gO(27,17),SP(),SP(),SP(),SP(),PP(28,"div",18),PP(29,"a",19),OP(30,"fa-icon",20),SP(),PP(31,"div",21),CP(32,jee,2,1,"ng-container",22),CP(33,Jee,3,2,"ng-template",null,23,tI),SP(),SP(),SP(),SP()),2&e){var n=wP(34);BE(2),EP("routerLink",AT(12,ete)),BE(2),EP("ngClass",t.showMenu?"is-active":""),BE(4),EP("ngClass",t.showMenu?"is-active":""),BE(2),EP("routerLink",AT(13,ete)),BE(6),EP("routerLink",AT(14,tte)),BE(2),EP("routerLink",AT(15,nte)),BE(6),EP("routerLink",AT(16,rte)),BE(2),EP("routerLink",AT(17,ite)),BE(3),EP("routerLink",AT(18,ate)),BE(1),EP("icon",t.faCog),BE(2),EP("ngIf",t.loading)("ngIfElse",n)}},directives:[CF,rM,qee,sM],encapsulation:2}),e}(),ste=function(){var e=my(function e(t,n){gy(this,e),this._themeService=t,this._errorLoggerService=n,this.faTwitter=h9,this.faFacebook=l9,this.faGithub=f9});return e.\u0275fac=function(t){return new(t||e)(_P(p9),_P(L7))},e.\u0275cmp=vk({type:e,selectors:[["app-root"]],decls:18,vars:3,consts:function(){return[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],$localize(S||(S=Wg(["If you like ",":START_TAG_STRONG:EveryBoard",":CLOSE_TAG_STRONG:, follow us!"])),"\ufffd#8\ufffd","\ufffd/#8\ufffd"),["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoard"],["href","https://facebook.com/EveryBoard"]]},template:function(e,t){1&e&&(OP(0,"app-header"),PP(1,"main",0),OP(2,"router-outlet"),SP(),PP(3,"footer",1),PP(4,"div",2),PP(5,"p"),PP(6,"span"),vO(7,3),OP(8,"strong"),pO(),SP(),uS(9," \xa0 "),PP(10,"a",4),OP(11,"fa-icon",5),SP(),uS(12,"\xa0 "),PP(13,"a",6),OP(14,"fa-icon",5),SP(),uS(15,"\xa0 "),PP(16,"a",7),OP(17,"fa-icon",5),SP(),SP(),SP(),SP()),2&e&&(BE(11),EP("icon",t.faGithub),BE(3),EP("icon",t.faTwitter),BE(3),EP("icon",t.faFacebook))},directives:[ote,_F,qee],encapsulation:2}),e}(),ute=function(){function e(t,n){gy(this,e),this.x=t,this.y=n}return my(e,[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),cte=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"isDown",value:function(){return 1===this.y}},{key:"isUp",value:function(){return-1===this.y}},{key:"isLeft",value:function(){return-1===this.x}},{key:"isRight",value:function(){return 1===this.x}},{key:"toInt",value:function(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}},{key:"toString",value:function(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}]),n}(ute),lte=function(){function e(){gy(this,e)}return my(e,[{key:"of",value:function(e,t){var n,r=dy(this.all);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.x===e&&i.y===t)return DB.success(i)}}catch(a){r.e(a)}finally{r.f()}return DB.failure("Invalid x and y in direction construction")}},{key:"fromDelta",value:function(e,t){return 0===e&&0===t?DB.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):DB.failure(vte.DIRECTION_MUST_BE_LINEAR())}},{key:"fromMove",value:function(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}},{key:"fromString",value:function(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return DB.failure("Invalid direction string ".concat(e))}}},{key:"fromInt",value:function(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return DB.failure("Invalid int direction: ".concat(e))}}}]),e}(),fte=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this,e,r)}return my(n,[{key:"isDiagonal",value:function(){return 0!==this.x&&0!==this.y}},{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(cte);fte.UP=new fte(0,-1),fte.UP_RIGHT=new fte(1,-1),fte.RIGHT=new fte(1,0),fte.DOWN_RIGHT=new fte(1,1),fte.DOWN=new fte(0,1),fte.DOWN_LEFT=new fte(-1,1),fte.LEFT=new fte(-1,0),fte.UP_LEFT=new fte(-1,-1),fte.factory=new(function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).all=[fte.UP,fte.UP_RIGHT,fte.RIGHT,fte.DOWN_RIGHT,fte.DOWN,fte.DOWN_LEFT,fte.LEFT,fte.UP_LEFT],e}return my(n)}(lte)),fte.DIRECTIONS=fte.factory.all,fte.DIAGONALS=[fte.UP_RIGHT,fte.DOWN_RIGHT,fte.DOWN_LEFT,fte.UP_LEFT],fte.ORTHOGONALS=[fte.UP,fte.RIGHT,fte.DOWN,fte.LEFT],fte.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return F7("string"==typeof e,"Invalid encoded direction"),fte.factory.fromString(e).get()}}]),n}(Y7));var hte=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this,e,r)}return my(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}},{key:"rotateClockwise",value:function(){return n.factory.of(-this.y,this.x).get()}}]),n}(cte);hte.UP=new hte(0,-1),hte.RIGHT=new hte(1,0),hte.DOWN=new hte(0,1),hte.LEFT=new hte(-1,0),hte.factory=new(function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).all=[hte.UP,hte.RIGHT,hte.DOWN,hte.LEFT],e}return my(n,[{key:"of",value:function(e,t){return 0===e&&-1===t?DB.success(hte.UP):1===e&&0===t?DB.success(hte.RIGHT):0===e&&1===t?DB.success(hte.DOWN):-1===e&&0===t?DB.success(hte.LEFT):DB.failure("Invalid orthogonal from x and y")}}]),n}(lte)),hte.ORTHOGONALS=hte.factory.all,hte.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return F7("string"==typeof e,"Invalid encoded orthogonal"),hte.factory.fromString(e).get()}}]),n}(Y7));var dte=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 3}},{key:"encodeNumber",value:function(e){return e===hte.UP?0:e===hte.RIGHT?1:e===hte.DOWN?2:3}},{key:"decodeNumber",value:function(e){switch(e){case 0:return hte.UP;case 1:return hte.RIGHT;case 2:return hte.DOWN;default:return IB.expectToBe(e,3,"Encoded orthogonal should be 3 for LEFT but got ".concat(e," instead")),hte.LEFT}}}]),n}(Q7),vte=function(){var e=my(function e(){gy(this,e)});return e.DIRECTION_MUST_BE_LINEAR=function(){return $localize(O||(O=Wg(["You must move in a straight line! You can only move orthogonally or diagonally!"])))},e}(),pte=function(){function e(t,n){gy(this,e),this.x=t,this.y=n}return my(e,[{key:"getNext",value:function(t,n){var r;return new e(this.x+(n=null!==(r=n)&&void 0!==r?r:1)*t.x,this.y+n*t.y)}},{key:"getPrevious",value:function(e,t){var n;return this.getNext(e,-(t=null!==(n=t)&&void 0!==n?n:1))}},{key:"getLeft",value:function(t){return new e(this.x+t.y,this.y+-t.x)}},{key:"getRight",value:function(t){return new e(this.x+-t.y,this.y+t.x)}},{key:"getOpposite",value:function(){return new e(-this.x,-this.y)}},{key:"isInRange",value:function(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}},{key:"isNotInRange",value:function(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}},{key:"getDirectionToward",value:function(e){return fte.factory.fromMove(this,e)}},{key:"getOrthogonalDistance",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"getDistance",value:function(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}},{key:"isHexagonallyAlignedWith",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}},{key:"isAlignedWith",value:function(e){var t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}},{key:"getVectorToward",value:function(t){return new e(t.x-this.x,t.y-this.y)}},{key:"getMinimalVectorToward",value:function(e){return this.getVectorToward(e).toVector()}},{key:"getCoordsToward",value:function(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];for(var t=this.getDirectionToward(e).get(),n=this.getNext(t,1),r=[];!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}},{key:"toVector",value:function(){for(var t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n),i=this.x,a=this.y,o=2;o<=r;)i%o==0&&a%o==0?(i/=o,a/=o):o++;return new e(i,a)}},{key:"isBetween",value:function(e,t){var n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}},{key:"getUntil",value:function(e){for(var t=[],n=this.getDirectionToward(e).get(),r=this.getNext(n);!1===r.equals(e);)t.push(r),r=r.getNext(n);return t}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y}},{key:"compareTo",value:function(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}],[{key:"numberEncoder",value:function(t,n){return Q7.tuple([Q7.numberEncoder(t),Q7.numberEncoder(n)],function(e){return[e.x,e.y]},function(t){return new e(t[0],t[1])})}}]),e}();pte.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"encode",value:function(e){return{x:e.x,y:e.y}}},{key:"decode",value:function(e){var t=e;return F7(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new pte(t.x,t.y)}}]),n}(Y7));var gte=function(){var e=function(){function e(t){gy(this,e),this.messageDisplayer=t,this.Player=e9,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=NB.empty(),this.imagesLocation="assets/images/",this.hasAsymetricBoard=!1,this.rotation=""}return my(e,[{key:"message",value:function(e){this.messageDisplayer.gameMessage(e)}},{key:"cancelMove",value:function(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?UB.SUCCESS:(this.messageDisplayer.gameMessage(e),UB.failure(e))}},{key:"cancelMoveAttempt",value:function(){}},{key:"getPlayerClass",value:function(e){switch(e){case e9.ZERO:return"player0-fill";case e9.ONE:return"player1-fill";default:return IB.expectToBe(e,J7.NONE),""}}},{key:"pass",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",L7.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name}));case 1:case"end":return t.stop()}},t)}))()}},{key:"getTurn",value:function(){return this.rules.node.gameState.turn}},{key:"getCurrentPlayer",value:function(){return this.rules.node.gameState.getCurrentPlayer()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"range",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),yte=function(){var e,t=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getHexaCoordsBy",value:function(e,t){var n=new pte(e,t);return this.getHexaCoordsAt(n)}},{key:"getHexaCoordsAt",value:function(e){var t,n="",r=this.hexaLayout.getHexaCoordsAt(e),i=dy(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;n+=a.x+" "+a.y+" "}}catch(o){i.e(o)}finally{i.f()}return n+=r[0].x+" "+r[0].y}},{key:"getCenterBy",value:function(e,t){var n=new pte(e,t);return this.getCenterAt(n)}},{key:"getCenterAt",value:function(e){return this.hexaLayout.getCenterAt(e)}}]),n}(gte);return t.\u0275fac=function(n){return(e||(e=pw(t)))(n||t)},t.\u0275cmp=vk({type:t,selectors:[["ng-component"]],features:[nP],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),mte=function(){function e(t){gy(this,e),this.value=t}return my(e,[{key:"equals",value:function(e){return this===e}},{key:"is",value:function(e){return this.value===e.value}},{key:"isPlayer",value:function(){return this===e.ZERO||this===e.ONE}}],[{key:"from",value:function(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.UNREACHABLE.value:return e.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}},{key:"ofPlayer",value:function(t){return t===e9.ZERO?e.ZERO:(IB.expectToBe(t,e9.ONE),e.ONE)}}]),e}();mte.ZERO=new mte(e9.ZERO.value),mte.ONE=new mte(e9.ONE.value),mte.EMPTY=new mte(J7.NONE.value),mte.UNREACHABLE=new mte(3);var kte=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this,e,r)}return my(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}],[{key:"getAngle",value:function(e){switch(e){case n.UP:return 0;case n.UP_RIGHT:return 60;case n.RIGHT:return 120;case n.DOWN:return 180;case n.DOWN_LEFT:return 240;default:return IB.expectToBe(e,n.LEFT),300}}}]),n}(cte);kte.UP=new kte(0,-1),kte.LEFT=new kte(-1,0),kte.UP_RIGHT=new kte(1,-1),kte.DOWN_LEFT=new kte(-1,1),kte.RIGHT=new kte(1,0),kte.DOWN=new kte(0,1),kte.factory=new(function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).all=[kte.UP,kte.UP_RIGHT,kte.RIGHT,kte.DOWN,kte.DOWN_LEFT,kte.LEFT],e}return my(n)}(lte)),kte.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){switch(e){case kte.UP:return 0;case kte.UP_RIGHT:return 1;case kte.RIGHT:return 2;case kte.DOWN:return 3;case kte.DOWN_LEFT:return 4;default:return 5}}},{key:"decodeNumber",value:function(e){return F7(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),kte.factory.all[e]}}]),n}(Q7));var Cte=function(){function e(t,n,r){gy(this,e),this.size=t,this.origin=n,this.orientation=r}return my(e,[{key:"getCenterAt",value:function(e){var t=this.orientation.conversionMatrix;return new pte(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}},{key:"getCornerOffset",value:function(e){var t=2*Math.PI*(this.orientation.startAngle+e)/6;return new pte(this.size*Math.cos(t),this.size*Math.sin(t))}},{key:"getHexaCoordsAt",value:function(e){for(var t=this.getCenterAt(e),n=[],r=0;r<6;r+=1){var i=this.getCornerOffset(r);n.push(new pte(t.x+i.x,t.y+i.y))}return n}}]),e}(),wte=my(function e(){gy(this,e)}),_te=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.call(this)).startAngle=.5,e.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],e.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3],e}return my(n)}(wte);_te.INSTANCE=new _te;var Ete=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.call(this)).startAngle=0,e.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],e.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3],e}return my(n,[{key:"isOnBorder",value:function(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}},{key:"isOnTopRightBorder",value:function(e,t){return 0===t.y}},{key:"isOnRightBorder",value:function(e,t){return t.x===e.width-1}},{key:"isOnLeftBorder",value:function(e,t){return 0===t.x}},{key:"isOnBottomLeftBorder",value:function(e,t){return t.y===e.height-1}},{key:"isOnTopLeftBorder",value:function(e,t){return null!=e.excludedSpaces[t.y]?t.x===e.excludedSpaces[t.y]:t.y===e.excludedSpaces.length&&0===t.x}},{key:"isOnBottomRightBorder",value:function(e,t){return null!=e.excludedSpaces[e.height-1-t.y]?e.width-1-t.x===e.excludedSpaces[e.height-1-t.y]:e.height-1-t.y===e.excludedSpaces.length&&t.x===e.width-1}},{key:"getAllBorders",value:function(e){var t=this,n=[];return e.forEachCoord(function(r,i){t.isOnBorder(e,r)&&n.push(r)}),n}},{key:"isTopCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}},{key:"isTopLeftCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isTopRightCorner",value:function(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}},{key:"isBottomCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}},{key:"isBottomLeftCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isBottomRightCorner",value:function(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}]),n}(wte);Ete.INSTANCE=new Ete;var bte=function(){var e=my(function e(){gy(this,e)});return e.CANNOT_CHOOSE_OPPONENT_PIECE=function(){return $localize(T||(T=Wg(["You cannot pick a piece of the opponent."])))},e.MUST_CLICK_ON_EMPTY_SPACE=function(){return $localize(I||(I=Wg(["You must click on an empty space."])))},e.MUST_CLICK_ON_EMPTY_SQUARE=function(){return $localize(A||(A=Wg(["You must click on an empty square."])))},e.CANNOT_SELF_CAPTURE=function(){return $localize(M||(M=Wg(["Your landing space should be empty or contain a piece of the opponent."])))},e.MUST_CHOOSE_PLAYER_PIECE=function(){return $localize(x||(x=Wg(["You must pick one of your pieces."])))},e.CANNOT_PASS=function(){return $localize(R||(R=Wg(["You cannot pass your turn."])))},e.MUST_LAND_ON_EMPTY_SPACE=function(){return $localize(N||(N=Wg(["You must drop your piece on an empty space."])))},e.MUST_PASS=function(){return $localize(D||(D=Wg(["You must pass your turn."])))},e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=function(){return $localize(L||(L=Wg(["You have selected an empty space, you must select one of your own pieces."])))},e.MOVE_CANNOT_BE_STATIC=function(){return $localize(F||(F=Wg(["You must choose different starting and ending coordinates."])))},e.SOMETHING_IN_THE_WAY=function(){return $localize(U||(U=Wg(["There is a piece between the piece you chose and its landing space."])))},e}(),Pte=function(){function e(t,n){gy(this,e),this.ruler=t,this.name=n}return my(e,[{key:"toString",value:function(){return this.name}}]),e}(),Ste=function(){function e(t){gy(this,e),this.value=t}return my(e,[{key:"toString",value:function(){return""+this.value}}],[{key:"fromWinner",value:function(t){return t.isPlayer()?new e(t.getVictoryValue()):new e(0)}}]),e}(),Ote=function(){function e(){gy(this,e)}return my(e,null,[{key:"toComparableObjectSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return t.equals(e)})||t.push(e)}),t}},{key:"toComparableSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return RB(t,e)})||t.push(e)}),t}}]),e}(),Tte=function(e){function t(e){gy(this,t),this.values=void 0===e?[]:Ote.toComparableSet(e)}return my(t,[{key:"equals",value:function(e){if(e.size()!==this.size())return!1;var t,n=dy(this);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===e.contains(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"toString",value:function(){var e,t="",n=dy(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=null==r?"null, ":r.toString()+", "}}catch(i){n.e(i)}finally{n.f()}return"["+t.slice(0,-2)+"]"}},{key:"add",value:function(e){return!this.contains(e)&&(this.values.push(e),!0)}},{key:"union",value:function(e){var t,n=dy(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"contains",value:function(e){var t,n=dy(this.values);try{for(n.s();!(t=n.n()).done;){if(RB(t.value,e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"size",value:function(){return this.values.length}},{key:"toList",value:function(){var e,t=[],n=dy(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getAnyElement",value:function(){return this.size()>0?NB.of(this.values[0]):NB.empty()}},{key:"isEmpty",value:function(){return 0===this.values.length}},{key:Symbol.iterator,value:function(){return this.values.values()}}]),t}(),Ite=function(){function e(t){gy(this,e),this.turn=t}return my(e,[{key:"getCurrentPlayer",value:function(){return e9.fromTurn(this.turn)}},{key:"getCurrentOpponent",value:function(){return this.turn%2==1?e9.ZERO:e9.ONE}}]),e}(),Ate=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,r)).board=e,i}return my(n,[{key:"getPieceAt",value:function(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}},{key:"tryToGetPieceAt",value:function(e){return this.isOnBoard(e)?NB.of(this.board[e.y][e.x]):NB.empty()}},{key:"isOnBoard",value:function(e){return e.isInRange(this.board[0].length,this.board.length)}},{key:"getPieceAtXY",value:function(e,t){return this.getPieceAt(new pte(e,t))}},{key:"forEachCoord",value:function(e){var t,n=dy(this.getCoordsAndContents());try{for(n.s();!(t=n.n()).done;){var r=Qg(t.value,2);e(r[0],r[1])}}catch(i){n.e(i)}finally{n.f()}}},{key:"getCoordsAndContents",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new pte(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}},{key:"getCopiedBoard",value:function(){return i9.copyBiArray(this.board)}}]),n}(Ite),Mte=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"isInBoard",value:function(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==mte.UNREACHABLE}},{key:"isPiece",value:function(e){return this.getPieceAt(e).isPlayer()}},{key:"getScores",value:function(){for(var e=[14,14],t=0;t<9;t++)for(var n=0;n<9;n++)this.getPieceAtXY(n,t)===mte.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===mte.ONE&&(e[0]=e[0]-1);return e}}],[{key:"getInitialState",value:function(){var e=mte.EMPTY,t=mte.UNREACHABLE,r=mte.ZERO,i=mte.ONE;return new n([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}}]),n}(Ate),xte=my(function e(){gy(this,e)}),Rte=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).coord=new pte(e,r),i}return my(n)}(xte),Nte=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;if(gy(this,n),(a=t.call(this,e.x,e.y)).dir=r,a.lastPiece=i,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!");return sy(a)}return my(n,[{key:"toString",value:function(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}},{key:"isSingleCoord",value:function(){return this.lastPiece.isAbsent()}},{key:"equals",value:function(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}],[{key:"fromSingleCoord",value:function(e,t){try{return DB.success(new n(e,t,NB.empty()))}catch(r){return DB.failure(r.message)}}},{key:"fromDoubleCoord",value:function(e,t,r){var i=[e,t];i9.sortByDescending(i,n.sortCoord);var a=i[1].getDirectionToward(i[0]).get(),o=kte.factory.fromDelta(a.x,a.y);if(o.isFailure())return DB.failure("Invalid direction");var s=o.get();return i[1].getDistance(i[0])>2?DB.failure("Distance between first coord and last coord is too great"):s.equals(r)?n.fromSingleCoord(i[1],r):s.getOpposite().equals(r)?n.fromSingleCoord(i[0],r):DB.success(new n(i[1],r,NB.of(i[0])))}},{key:"sortCoord",value:function(e){return 9*e.y+e.x}}]),n}(Rte);Nte.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 104831}},{key:"encodeNumber",value:function(e){var t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;var n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}},{key:"decodeNumber",value:function(e){var t=e%8;e=(e-t)/8;var n=kte.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;var a=new pte(i,r);if(0===e)return Nte.fromSingleCoord(a,n).get();var o=(e=(e-1)/2)%9,s=(e=(e-o)/9)%9;e=(e-s)/9;var u=new pte(s,o);return Nte.fromDoubleCoord(a,u,n).get()}}]),n}(Q7));var Dte=(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(Dte||(Dte={})),Dte),Lte=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];gy(this,e),this.map=t,this.isImmutable=n}return my(e,[{key:"makeImmutable",value:function(){this.isImmutable=!0}},{key:"get",value:function(e){var t,n=dy(this.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(RB(r.key,e))return NB.of(r.value)}}catch(i){n.e(i)}finally{n.f()}return NB.empty()}},{key:"forEach",value:function(e){for(var t=0;t<this.map.length;t++)e(this.getByIndex(t))}},{key:"getByIndex",value:function(e){return this.map[e]}},{key:"putAll",value:function(e){this.checkImmutability("putAll");var t,n=dy(e.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r.key,r.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"checkImmutability",value:function(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}},{key:"put",value:function(e,t){this.checkImmutability("put");var n,r=dy(this.map);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(RB(i.key,e)){var a=i.value;return i.value=t,NB.of(a)}}}catch(o){r.e(o)}finally{r.f()}return this.map.push({key:e,value:t}),NB.empty()}},{key:"containsKey",value:function(e){return this.map.some(function(t){return RB(t.key,e)})}},{key:"size",value:function(){return this.map.length}},{key:"listKeys",value:function(){return this.map.map(function(e){return e.key})}},{key:"getKeySet",value:function(){return new Tte(this.listKeys())}},{key:"filter",value:function(t){var n,r=new e,i=dy(this.map);try{for(i.s();!(n=i.n()).done;){var a=n.value;t(a.key,a.value)&&r.set(a.key,a.value)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"replace",value:function(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}},{key:"set",value:function(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}},{key:"delete",value:function(e){this.checkImmutability("delete");for(var t=0;t<this.map.length;t++)if(RB(this.map[t].key,e)){var n=this.map[t].value,r=this.map.slice(0,t),i=this.map.slice(t+1);return this.map=r.concat(i),n}throw new Error('No Value to delete for key "'+e.toString()+'"!')}},{key:"getCopy",value:function(){var e,t=new this.constructor,n=dy(this.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.set(r,this.get(r).get())}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"equals",value:function(e){var t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;var r,i=dy(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this.get(a).get(),s=e.get(a);if(F7(s.isPresent(),"value is absent in a map even though its key is present!"),!1===RB(o,s.get()))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}}],[{key:"from",value:function(t){for(var n=Object.keys(t),r=new e,i=0,a=n;i<a.length;i++){var o=a[i];r.set(o,t[o])}return r}}]),e}(),Fte=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"reverse",value:function(){var e,t=new n,r=dy(this.listKeys());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.get(i).get();if(t.containsKey(a))t.get(a).get().add(i);else{var o=new Tte;o.add(i),t.set(a,o)}}}catch(s){r.e(s)}finally{r.f()}return t}}]),n}(Lte),Ute=function(){var e=my(function e(){gy(this,e)});return e.createdNodes=0,e.minimaxTime=0,e}(),Vte=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NB.empty(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NB.empty(),i=arguments.length>3?arguments[3]:void 0;if(gy(this,e),this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=NB.empty(),this.hopedValue=new Lte,this.ownValue=new Lte,this.possibleMoves=new Lte,this.ownValue=new Lte,null!=i){var a=i.getBoardValue(this);this.ownValue.set(i.name,a),this.hopedValue.set(i.name,a.value)}Ute.createdNodes++,AB(e.VERBOSE||!1,"creating "+this.myToString())}return my(e,[{key:"findBestMove",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(new Date).getTime(),a=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);a.gameState.turn>this.gameState.turn+1;)a=a.mother.get(),e--;return Ute.minimaxTime+=(new Date).getTime()-i,a.move.get()}},{key:"alphaBeta",value:function(t,n,r,i,a,o){if(t<1)return AB(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return AB(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;var s=this.getPossibleMoves(i);F7(s.size()>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=NB.of([]));var u=this.getBestChilds(s,t,n,r,i,a,o),c=this.getBestChildAmongst(u,a),l=c.hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),l),c}},{key:"getPossibleMoves",value:function(e){var t=this.possibleMoves.get(e.name);if(t.isAbsent()){var n=e.getListMoves(this);return this.possibleMoves.set(e.name,new Tte(n)),new Tte(n)}return t.get()}},{key:"getBestChilds",value:function(e,t,n,r,i,a,o){var s,u=[],c=this.gameState.getCurrentPlayer(),l=c===e9.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,f=c===e9.ZERO?function(e,t){return e<t}:function(e,t){return e>t},h=dy(e);try{for(h.s();!(s=h.n()).done;){var d=s.value,v=this.getOrCreateChild(d,i).alphaBeta(t-1,n,r,i,a,o),p=v.getHopedValue(i);if(f(p,l)||0===u.length?(l=p,u=[v]):p===l&&u.push(v),o&&f(l,c===e9.ZERO?n:r))break;c===e9.ZERO?r=Math.min(l,r):n=Math.max(l,n)}}catch(g){h.e(g)}finally{h.f()}return u}},{key:"getBestChildAmongst",value:function(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}},{key:"getOrCreateChild",value:function(t,n){var r=this.getSonByMove(t);if(r.isAbsent()){var i=n.ruler.isLegal(t,this.gameState),a=t.toString();F7(i.isSuccess(),'The minimax "'+n.name+'" has proposed an illegal move ('+a+"), this should not happen.");var o=n.ruler.applyLegalMove(t,this.gameState,i.get());r=NB.of(new e(o,NB.of(this),NB.of(t),n)),this.childs.get().push(r.get())}return r.get()}},{key:"getSonByMove",value:function(e){F7(this.childs.isPresent(),"Cannot get son of uncalculated node");var t,n=dy(this.childs.get());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.move.isPresent()&&r.move.equalsValue(e))return NB.of(r)}}catch(i){n.e(i)}finally{n.f()}return NB.empty()}},{key:"getHopedValue",value:function(e){return this.hopedValue.get(e.name).get()}},{key:"getOwnValue",value:function(e){var t=this.ownValue.get(e.name);if(t.isAbsent()){var n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}},{key:"myToString",value:function(){var e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}},{key:"hasMoves",value:function(){return this.childs.isPresent()}},{key:"countDescendants",value:function(){if(this.childs.isAbsent())return 0;var e,t=this.childs.get().length,n=dy(this.childs.get());try{for(n.s();!(e=n.n()).done;){t+=e.value.countDescendants()}}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"getScoreStatus",value:function(t){var n=!1;return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(AB(e.VERBOSE||n,"VICTORY"),Dte.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(AB(e.VERBOSE||n,"PRE_VICTORY_MIN"),Dte.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(AB(e.VERBOSE||n,"PRE_VICTORY_MAX"),Dte.PRE_VICTORY):(AB(e.VERBOSE||n,"DEFAULT"),Dte.DEFAULT)}}]),e}();Vte.VERBOSE=!1,Vte.minimaxes=new Lte;var Bte=function(){function e(t,n){gy(this,e),this.isEndGame=t,this.winner=n}return my(e,[{key:"toBoardValue",value:function(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}],[{key:"getVictory",value:function(t){return t===e9.ZERO?e.ZERO_WON:e.ONE_WON}},{key:"getDefeat",value:function(t){return t===e9.ZERO?e.ONE_WON:e.ZERO_WON}}]),e}();Bte.ZERO_WON=new Bte(!0,e9.ZERO),Bte.ONE_WON=new Bte(!0,e9.ONE),Bte.DRAW=new Bte(!0,J7.NONE),Bte.ONGOING=new Bte(!1,J7.NONE);var zte=function(){function e(t){gy(this,e),this.stateType=t,this.setInitialBoard()}return my(e,[{key:"choose",value:function(e){var t=!1;AB(t,"Rules.choose: "+e.toString()+" was proposed");var n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){AB(t,"Rules.choose: current node has moves");var r=this.node.getSonByMove(e);if(r.isPresent())return F7(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),AB(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(AB(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return AB(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;AB(t,"Rules.choose: Move is legal, let's apply it");var i=this.applyLegalMove(e,this.node.gameState,n.get()),a=new Vte(i,NB.of(this.node),NB.of(e));return this.node=a,!0}},{key:"setInitialBoard",value:function(){var e=this.stateType.getInitialState();Vte.ruler=this,this.node=new Vte(e)}},{key:"applyMoves",value:function(e,t,n){var r,i=0,a=dy(e);try{for(a.s();!(r=a.n()).done;){var o=n(r.value),s=this.isLegal(o,t);F7(s.isSuccess(),"Can't create state from invalid moves ("+i+"): "+s.toString()+"."),t=this.applyLegalMove(o,t,s.get()),i++}}catch(u){a.e(u)}finally{a.f()}return t}}]),e}(),Hte=function(){var e=my(function e(){gy(this,e)});return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=function(){return $localize(V||(V=Wg(["You cannot move more than 3 of your pieces!"])))},e.NOT_ENOUGH_PIECE_TO_PUSH=function(){return $localize(B||(B=Wg(["You don't have enough pieces to push that group!"])))},e.CANNOT_PUSH_YOUR_OWN_PIECES=function(){return $localize(z||(z=Wg(["You cannot push this piece because it is blocked by one of yours!"])))},e.MUST_ONLY_TRANSLATE_YOUR_PIECES=function(){return $localize(H||(H=Wg(["This line contains pieces of your opponent or empty spaces, which is forbidden."])))},e.TRANSLATION_IMPOSSIBLE=function(){return $localize(G||(G=Wg(["This move is impossible, some landing spaces are occupied."])))},e.LINE_AND_COORD_NOT_ALIGNED=function(){return $localize($||($=Wg(["This space is not aligned with the current line."])))},e}(),Gte=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){return new Mte(n,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toFailedFallible():e.isSingleCoord()?n.isLegalPush(e,t):n.isLegalSideStep(e,t)}},{key:"getFirstPieceValidity",value:function(e,t){var n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?UB.failure(bte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===mte.ofPlayer(t.getCurrentOpponent())?UB.failure(bte.CANNOT_CHOOSE_OPPONENT_PIECE()):UB.SUCCESS}},{key:"isLegalPush",value:function(e,t){var r=1,i=e.coord.getNext(e.dir),a=mte.ofPlayer(t.getCurrentPlayer()),o=mte.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=o;r<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===a;)r++,i=i.getNext(e.dir);return r>3?DB.failure(Hte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(i)||(s[i.y][i.x]=a,t.getPieceAt(i)===o)?DB.success(s):n.isLegalRealPush(i,e,t,r,s)}},{key:"isLegalRealPush",value:function(e,t,n,r,i){for(var a=0,o=mte.ofPlayer(n.getCurrentOpponent()),s=mte.ofPlayer(n.getCurrentPlayer());a<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)a++,e=e.getNext(t.dir);return a>=r?DB.failure(Hte.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===mte.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===s)?DB.failure(Hte.CANNOT_PUSH_YOUR_OWN_PIECES()):DB.success(i)}},{key:"isLegalSideStep",value:function(e,t){var n=e.lastPiece.get(),r=e.coord.getDirectionToward(n).get();n=n.getNext(r);for(var i=e.coord,a=mte.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==a)return DB.failure(Hte.MUST_ONLY_TRANSLATE_YOUR_PIECES());var s=i.getNext(e.dir);if(o[i.y][i.x]=mte.EMPTY,s.isInRange(9,9)){if(t.isPiece(s))return DB.failure(Hte.TRANSLATION_IMPOSSIBLE());t.getPieceAt(s)===mte.EMPTY&&(o[s.y][s.x]=a)}i=i.getNext(r)}return DB.success(o)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getScores();return t[0]>5?Bte.ZERO_WON:t[1]>5?Bte.ONE_WON:Bte.ONGOING}}]),n}(zte),$te=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<9;i++)for(var a=0;a<9;a++){var o=new pte(a,i);if(!1!==n.getPieceAt(o).is(r)){var s,u=dy(kte.factory.all);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=Nte.fromSingleCoord(o,c).get();if(this.isAcceptablePush(l,n)){t.push(l);var f,h=dy(kte.factory.all);try{for(h.s();!(f=h.n()).done;)for(var d=f.value,v=1;v<=2&&!d.equals(c);v++){var p=o.getNext(d,v);if(!p.isInRange(9,9))break;var g=Nte.fromDoubleCoord(o,p,c).get();Gte.isLegal(g,n).isSuccess()&&t.push(g)}}catch(y){h.e(y)}finally{h.f()}}}}catch(y){u.e(y)}finally{u.f()}}}return new Tte(t).toList()}},{key:"isAcceptablePush",value:function(e,t){var n=t.getScores(),r=Gte.isLegal(e,t);if(r.isSuccess()){var i=t.getCurrentOpponent().value;return!(new Mte(r.get(),t.turn+1).getScores()[i]>n[i])}return!1}},{key:"getBoardValue",value:function(e){var t=Gte.getGameStatus(e);if(t.isEndGame)return new Ste(t.toBoardValue());var n=e.gameState.getScores();return new Ste(n[1]-n[0])}}]),n}(Pte),Zte=function(){function e(t,n,r){gy(this,e),this.title=t,this.instruction=n,this.state=r,this.previousMove=NB.empty(),this.previousState=NB.empty()}return my(e,[{key:"isMove",value:function(){return!1}},{key:"isAnyMove",value:function(){return!1}},{key:"isClick",value:function(){return!1}},{key:"isPredicate",value:function(){return!1}},{key:"isInformation",value:function(){return!1}},{key:"hasSolution",value:function(){return!1}},{key:"withPreviousMove",value:function(e){return this.previousMove=NB.of(e),this}},{key:"withPreviousState",value:function(e){return this.previousState=NB.of(e),this}}],[{key:"fromMove",value:function(e,t,n,r,i,a){return new Wte(e,t,n,r,i,a)}},{key:"forClick",value:function(e,t,n,r,i,a){return new Yte(e,t,n,r,i,a)}},{key:"anyMove",value:function(e,t,n,r,i){return new jte(e,t,n,r,i)}},{key:"fromPredicate",value:function(e,t,n,r,i,a){return new Kte(e,t,n,r,i,a)}},{key:"informational",value:function(e,t,n){return new Qte(e,t,n)}}]),e}(),qte=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this,e,r,i)).successMessage=a,o}return my(n,[{key:"hasSolution",value:function(){return!0}},{key:"getSuccessMessage",value:function(){return this.successMessage}}]),n}(Zte),Wte=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s){var u;return gy(this,n),(u=t.call(this,e,r,i,o)).acceptedMoves=a,u.failureMessage=s,F7(a.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational"),u}return my(n,[{key:"isMove",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedMoves[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(qte),jte=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o){var s;return gy(this,n),(s=t.call(this,e,r,i,o)).solutionMove=a,s}return my(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isAnyMove",value:function(){return!0}}]),n}(qte),Yte=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s){var u;return gy(this,n),(u=t.call(this,e,r,i,o)).acceptedClicks=a,u.failureMessage=s,u}return my(n,[{key:"isClick",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedClicks[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(qte),Kte=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s){var u;return gy(this,n),(u=t.call(this,e,r,i,s)).solutionMove=a,u.predicate=o,u}return my(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isPredicate",value:function(){return!0}}]),n}(qte),Qte=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"isInformation",value:function(){return!0}}]),n}(Zte),Xte=mte.EMPTY,Jte=mte.UNREACHABLE,ene=mte.ZERO,tne=mte.ONE,nne=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(Z||(Z=Wg(["Initial board and goal of the game"]))),$localize(q||(q=Wg(["At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!"]))),Mte.getInitialState()),Zte.anyMove($localize(W||(W=Wg(["Moving a piece"]))),$localize(j||(j=Wg(["At each turn, move one, two, or three pieces either along their line, or on their side.\n        For your moves you can therefore choose between up to 6 directions.\n        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).\n        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>\n        You're playing Dark, make any move!"]))),Mte.getInitialState(),Nte.fromSingleCoord(new pte(2,6),kte.UP).get(),$localize(Y||(Y=Wg(["Congratulations!"])))),Zte.fromMove($localize(K||(K=Wg(["Pushing"]))),$localize(Q||(Q=Wg(["To push one opponent piece, you must move at least two of your pieces.\n        To push two opponent pieces, you must move three of your pieces.\n        If one of your pieces is in the way, it will be impossible to push.\n        You cannot move more than three pieces.<br/><br/>\n        Only one push towards the right is possible here, find it. (You're playing Dark)."]))),new Mte([[Jte,Jte,Jte,Jte,Xte,ene,ene,tne,tne],[Jte,Jte,Jte,Xte,Xte,Xte,Xte,Xte,Xte],[Jte,Jte,Xte,ene,ene,ene,tne,ene,Xte],[Jte,Xte,Xte,Xte,Xte,Xte,Xte,Xte,Xte],[Xte,Xte,Xte,Xte,ene,ene,ene,tne,tne],[Xte,Xte,Xte,Xte,Xte,Xte,Xte,Xte,Jte],[Xte,Xte,Xte,Xte,ene,tne,Xte,Jte,Jte],[Xte,Xte,Xte,ene,Xte,Xte,Jte,Jte,Jte],[Xte,Xte,ene,Xte,Xte,Jte,Jte,Jte,Jte]],0),[Nte.fromSingleCoord(new pte(4,4),kte.RIGHT).get()],$localize(X||(X=Wg(["Congratulations! You know everything you need to start a game!"]))),$localize(J||(J=Wg(["Failed!"]))))]});function rne(e,t){if(1&e){var n=AP();NC(),PP(0,"circle",6),RP("click",function(){aC(n);var e=LP(2).index,t=LP().index;return LP().onPieceClick(e,t)}),SP()}if(2&e){var r=LP(2).index,i=LP().index,a=LP();VP("id","piece_",r,"_",i,""),EP("ngClass",a.getPieceClasses(r,i)),pP("cx",a.getCenterBy(r,i).x)("cy",a.getCenterBy(r,i).y)("r",.5*a.SPACE_SIZE)}}function ine(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"polygon",4),RP("click",function(){aC(n);var e=LP().index,t=LP().index;return LP().onSpaceClick(e,t)}),SP(),CP(2,rne,1,6,"circle",5),SP()}if(2&e){var r=LP(),i=r.index,a=r.$implicit,o=LP().index,s=LP();BE(1),VP("id","space_",i,"_",o,""),EP("ngClass",s.getSquareClasses(i,o)),pP("points",s.getHexaCoordsBy(i,o)),BE(1),EP("ngIf",s.isPiece(a))}}function ane(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,ine,3,5,"g",3),SP()),2&e){var n=t.$implicit,r=LP(2);BE(1),EP("ngIf",r.isBoard(n))}}function one(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,ane,2,1,"g",1),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function sne(e,t){1&e&&(NC(),PP(0,"marker",7),OP(1,"polygon",8),SP()),2&e&&UP("id","arrowhead_",t.$implicit.dir.toString(),"")}function une(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),OP(1,"line",9),PP(2,"line",10),RP("click",function(){var e=aC(n).$implicit;return LP().chooseDirection(e.dir)}),SP(),PP(3,"polygon",11),RP("click",function(){var e=aC(n).$implicit;return LP().chooseDirection(e.dir)}),SP(),SP()}if(2&e){var r=t.$implicit;BE(1),UP("id","line_start_",r.dir.toString(),""),pP("x1",r.startCenter.x)("y1",r.startCenter.y)("x2",r.middle.x)("y2",r.middle.y),BE(1),UP("id","line_end_",r.dir.toString(),""),pP("x1",r.middle.x)("y1",r.middle.y)("x2",r.landingCenter.x)("y2",r.landingCenter.y),BE(1),UP("id","direction_",r.dir.toString(),""),pP("transform",r.transformation)}}var cne=my(function e(t,n,r,i,a,o){gy(this,e),this.startCenter=t,this.middle=n,this.landingCenter=r,this.landing=i,this.dir=a,this.transformation=o}),lne=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).moveds=[],r.directions=[],r.selecteds=[],r.rules=new Gte(Mte),r.availableMinimaxes=[new $te(r.rules,"Dummy")],r.encoder=Nte.encoder,r.tutorial=(new nne).tutorial,r.scores=NB.of([0,0]),r.SPACE_SIZE=30,r.hexaLayout=new Cte(r.SPACE_SIZE,new pte(-8*r.SPACE_SIZE,2*r.SPACE_SIZE),_te.INSTANCE),r.updateBoard(),r}return my(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=NB.of(this.getState().getScores())}},{key:"hidePreviousMove",value:function(){this.moveds=[]}},{key:"cancelMoveAttempt",value:function(){this.directions=[],this.selecteds=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}},{key:"showPushingMove",value:function(e){var t=this.rules.node.mother.get().gameState,n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}},{key:"showSideStepMove",value:function(e){var t=e.lastPiece.get(),n=e.coord.getDirectionToward(t).get();t=t.getNext(n);for(var r=e.coord;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}},{key:"onPieceClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#piece_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.getState().getCurrentOpponent(),r.abrupt("return",n.hexaBoard[t][e].is(a)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"opponentClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.tryChoosingDirection(e,t);case 2:if(!r.sent.isSuccess()){r.next=6;break}r.t0=UB.SUCCESS,r.next=7;break;case 6:r.t0=n.cancelMove(bte.CANNOT_CHOOSE_OPPONENT_PIECE());case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.selecteds=[new pte(e,t)],n.showPossibleDirections(),UB.SUCCESS));case 1:case"end":return r.stop()}},r)}))()}},{key:"showPossibleDirections",value:function(){this.directions=[],this.showDirection(1===this.selecteds.length)}},{key:"showDirection",value:function(e){var t,n=this.getState(),r=mte.ofPlayer(n.getCurrentPlayer()),i=this.selecteds[0],a=this.selecteds[this.selecteds.length-1],o=dy(kte.factory.all);try{for(o.s();!(t=o.n()).done;){var s,u=t.value,c=i.getNext(u,1);if(n.isOnBoard(c)&&n.getPieceAt(c)===r){if(e)continue;if(c=a.getNext(u,1),n.isOnBoard(c)&&n.getPieceAt(c)===r)continue}if(s=e?Nte.fromSingleCoord(i,u).get():Nte.fromDoubleCoord(i,a,u).get(),this.rules.isLegal(s,n).isSuccess()){var l=this.getCenterAt(i),f=this.getCenterAt(c),h=this.getMiddleOfArrow(u,c,f),d=f.x+" "+f.y,v=kte.getAngle(u)+150,p=new cne(l,h,f,c,u,"rotate("+v+" "+d+") translate("+d+")");this.directions.push(p)}}}catch(g){o.e(g)}finally{o.f()}}},{key:"getMiddleOfArrow",value:function(e,t,n){var r=t.getPrevious(e),i=this.getCenterAt(r);return new pte(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}},{key:"isBoard",value:function(e){return e!==mte.UNREACHABLE}},{key:"isPiece",value:function(e){return e!==mte.EMPTY}},{key:"secondClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.selecteds[0],!(a=new pte(e,t)).equals(i)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),UB.SUCCESS));case 3:if(!1!==a.isHexagonallyAlignedWith(i)){r.next=5;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 5:if(!((o=a.getDistance(i))>2)){r.next=8;break}return r.abrupt("return",n.cancelMove(Hte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 8:for(s=i.getDirectionToward(a).get(),n.selecteds=[i],u=0;u<o;u++)n.selecteds.push(i.getNext(s,u+1));if(3!==n.selecteds.length){r.next=15;break}if(c=n.selecteds[1],l=n.getState().getCurrentPlayer(),!1!==n.hexaBoard[c.y][c.x].is(l)){r.next=15;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 15:return r.abrupt("return",(n.showPossibleDirections(),UB.SUCCESS));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new pte(e,t),a=n.selecteds[0],!i.equals(a)){r.next=3;break}return r.abrupt("return",n.deselectExtremity(!0));case 3:return o=n.selecteds[n.selecteds.length-1],r.abrupt("return",i.equals(o)?n.deselectExtremity(!1):3===n.selecteds.length&&i.equals(n.selecteds[1])?(n.cancelMoveAttempt(),UB.SUCCESS):n.tryExtension(i,a,o));case 5:case"end":return r.stop()}},r)}))()}},{key:"tryExtension",value:function(e,t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=fte.factory.fromMove(t,e)).isSuccess()){i.next=6;break}if(o=fte.factory.fromMove(n,e),!a.equals(o)){i.next=6;break}return s=t.getDistance(e),u=n.getDistance(e),i.abrupt("return",2===Math.max(s,u)?(r.selecteds.push(e),i9.sortByDescending(r.selecteds,Nte.sortCoord),r.showPossibleDirections(),UB.SUCCESS):r.cancelMove(Hte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 6:return c=r.cancelMove(Hte.LINE_AND_COORD_NOT_ALIGNED()),i.next=9,r.firstClick(e.x,e.y);case 9:return i.abrupt("return",c);case 10:case"end":return i.stop()}},i)}))()}},{key:"deselectExtremity",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),UB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"chooseDirection",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#direction_"+e.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t._chooseDirection(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"_chooseDirection",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),a=t.selecteds[0],n.abrupt("return",(i=1===t.selecteds.length?Nte.fromSingleCoord(a,e).get():Nte.fromDoubleCoord(a,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(i,r,t.scores.get())));case 3:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#space_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.tryChoosingDirection(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"tryChoosingDirection",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new pte(e,t),a=dy(n.directions),r.prev=2,a.s();case 4:if((o=a.n()).done){r.next=10;break}if(!(s=o.value).landing.equals(i)){r.next=8;break}return r.abrupt("return",n._chooseDirection(s.dir));case 8:r.next=4;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),a.e(r.t0);case 15:return r.prev=15,a.f(),r.finish(15);case 18:return r.abrupt("return",UB.failure("not a direction"));case 19:case"end":return r.stop()}},r,null,[[2,12,15,18]])}))()}},{key:"getSquareClasses",value:function(e,t){var n=new pte(e,t),r=[];return this.moveds.some(function(e){return e.equals(n)})&&r.push("moved-fill"),r}},{key:"getPieceClasses",value:function(e,t){var n=new pte(e,t),r=e9.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(function(e){return e.equals(n)})&&i.push("selected-stroke"),i}}]),n}(yte);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-abalone"]],features:[nP],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,one,2,1,"g",1),PP(2,"defs"),CP(3,sne,2,1,"marker",2),SP(),CP(4,une,4,12,"g",1),SP()),2&e&&(BE(1),EP("ngForOf",t.hexaBoard),BE(2),EP("ngForOf",t.directions),BE(1),EP("ngForOf",t.directions))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),fne=function(){function e(t){gy(this,e),this.x=t}return my(e,[{key:"equals",value:function(e){return this.x===e.x}}],[{key:"from",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return F7(3===t,"Invalid Apagos Coord "+t),e.THREE}}}]),e}();fne.ZERO=new fne(0),fne.ONE=new fne(1),fne.TWO=new fne(2),fne.THREE=new fne(3);var hne=function(){var e=my(function e(){gy(this,e)});return e.PIECE_SHOULD_MOVE_DOWNWARD=function(){return $localize(ee||(ee=Wg(["Pieces should only move downward!"])))},e.CANNOT_LAND_ON_A_FULL_SQUARE=function(){return $localize(te||(te=Wg(["That square is already full, you cannot put a piece in it!"])))},e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=function(){return $localize(ne||(ne=Wg(["You have no pieces in that square, select one that contains at least one of your pieces!"])))},e.NO_PIECE_REMAINING_TO_DROP=function(){return $localize(re||(re=Wg(["There are no remaining pieces of that color to drop!"])))},e.NO_POSSIBLE_TRANSFER_REMAINS=function(){return $localize(ie||(ie=Wg(["There is no possible transfer from that square!"])))},e}(),dne=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this)).landing=e,a.piece=r,a.starting=i,a}return my(n,[{key:"isDrop",value:function(){return this.piece.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}},{key:"equals",value:function(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}],[{key:"drop",value:function(e,t){return IB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(NB.empty())}))}},{key:"transfer",value:function(e,t){if(e.x<=t.x)return DB.failure(hne.PIECE_SHOULD_MOVE_DOWNWARD());var r=IB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(t)&&n.piece.equals(NB.empty())&&n.starting.equals(NB.of(e))}));return DB.success(r)}}]),n}(xte);dne.ALL_MOVES=[new dne(fne.ZERO,NB.of(e9.ZERO),NB.empty()),new dne(fne.ONE,NB.of(e9.ZERO),NB.empty()),new dne(fne.TWO,NB.of(e9.ZERO),NB.empty()),new dne(fne.THREE,NB.of(e9.ZERO),NB.empty()),new dne(fne.ZERO,NB.of(e9.ONE),NB.empty()),new dne(fne.ONE,NB.of(e9.ONE),NB.empty()),new dne(fne.TWO,NB.of(e9.ONE),NB.empty()),new dne(fne.THREE,NB.of(e9.ONE),NB.empty()),new dne(fne.TWO,NB.empty(),NB.of(fne.THREE)),new dne(fne.ONE,NB.empty(),NB.of(fne.THREE)),new dne(fne.ZERO,NB.empty(),NB.of(fne.THREE)),new dne(fne.ONE,NB.empty(),NB.of(fne.TWO)),new dne(fne.ZERO,NB.empty(),NB.of(fne.TWO)),new dne(fne.ZERO,NB.empty(),NB.of(fne.ONE))],dne.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return dne.ALL_MOVES.length}},{key:"encodeNumber",value:function(e){var t=dne.ALL_MOVES.findIndex(function(t){return t.equals(e)});return F7(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}},{key:"decodeNumber",value:function(e){return F7(e<dne.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),dne.ALL_MOVES[e]}}]),n}(Q7));var vne=function(){function e(t){gy(this,e),this.containing=t}return my(e,[{key:"isFull",value:function(){return this.count(e9.ZERO)+this.count(e9.ONE)>=this.count(J7.NONE)}},{key:"count",value:function(e){return this.containing.get(e).get()}},{key:"addPiece",value:function(t){var n=this.count(e9.ZERO),r=this.count(e9.ONE),i=this.count(J7.NONE);return t===e9.ZERO?n++:r++,e.from(n,r,i).get()}},{key:"substractPiece",value:function(t){var n=this.count(e9.ZERO),r=this.count(e9.ONE),i=this.count(J7.NONE);return t===e9.ZERO?n--:r--,e.from(n,r,i).get()}},{key:"getDominatingPlayer",value:function(){var e=this.count(e9.ZERO),t=this.count(e9.ONE);return e>t?e9.ZERO:t>e?e9.ONE:J7.NONE}},{key:"equals",value:function(e){return this.containing.equals(e.containing)}}],[{key:"from",value:function(t,n,r){if(t+n>r)return DB.failure("invalid starting space");var i=new Lte([{key:e9.ZERO,value:t},{key:e9.ONE,value:n},{key:J7.NONE,value:r}]);i.makeImmutable();var a=new e(i);return DB.success(a)}}]),e}(),pne=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e)).board=r,a.remaining=i,a.remaining.makeImmutable(),a}return my(n,[{key:"getPieceAt",value:function(e){return this.board[e.x]}},{key:"updateAt",value:function(e,t){for(var r=[],i=0;i<4;i++)r.push(e.x===i?t:this.board[i]);var a=this.getRemainingCopy();return new n(this.turn,r,a)}},{key:"getRemainingCopy",value:function(){return this.remaining.getCopy()}},{key:"getRemaining",value:function(e){return this.remaining.get(e).get()}},{key:"equals",value:function(e){return this.turn===e.turn&&i9.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}},{key:"fromRepresentation",value:function(e,t,r,i){for(var a=[],o=0;o<4;o++){var s=vne.from(t[0][o],t[1][o],t[2][o]).get();a.push(s)}var u=new Lte;return u.set(e9.ZERO,r),u.set(e9.ONE,i),new n(e,a,u)}}]),n}(Ite);return e.PIECES_PER_PLAYER=10,e}(),gne=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.call(this,pne)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);var i=new pne(t.turn+1,t.board,n),a=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(a);if(e.landing===fne.THREE)return i.updateAt(e.landing,o);var s=fne.from(e.landing.x+1),u=i.getPieceAt(s);return i.updateAt(e.landing,u).updateAt(s,o)}},{key:"applyLegalTransfer",value:function(e,t){var n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),a=t.getPieceAt(e.landing).addPiece(n),o=t.updateAt(r,i);return o=o.updateAt(e.landing,a),new pne(o.turn+1,o.board,o.remaining)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.landing).isFull()?DB.failure(hne.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}},{key:"isLegalDrop",value:function(e,t){return t.getRemaining(e.piece.get())<=0?DB.failure(hne.NO_PIECE_REMAINING_TO_DROP()):DB.success(void 0)}},{key:"isLegalSlideDown",value:function(e,t){var n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?DB.failure(hne.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):DB.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=0;n<4;n++)if(!1===t.getPieceAt(fne.from(n)).isFull())return Bte.ONGOING;var r=t.getPieceAt(fne.THREE).getDominatingPlayer();return F7(r.isPlayer(),"winner can only be a player if the game is finished"),Bte.getVictory(r)}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=NB.of(new n)),n.singleton.get()}}]),n}(zte);gne.singleton=NB.empty();var yne=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t=e.gameState;return dne.ALL_MOVES.filter(function(e){return gne.get().isLegal(e,t).isSuccess()})}},{key:"getBoardValue",value:function(e){var t=gne.get().getGameStatus(e);if(t.isEndGame)return Ste.fromWinner(t.winner);var n=e.gameState.board[3].getDominatingPlayer();return n.isPlayer()?new Ste(n.getScoreModifier()):new Ste(0)}}]),n}(Pte),mne=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(ae||(ae=Wg(["Initial board and goal of the game"]))),$localize(oe||(oe=Wg(["At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!"]))),pne.getInitialState()),Zte.anyMove($localize(se||(se=Wg(["Drop"]))),$localize(ue||(ue=Wg(["There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You're playing Light.<br/><br/>Drop a piece on one of those three squares."]))),pne.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),dne.drop(fne.ZERO,e9.ZERO),$localize(ce||(ce=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(le||(le=Wg(["Transfer"]))),$localize(fe||(fe=Wg(["The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!"]))),pne.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),dne.transfer(fne.TWO,fne.ZERO).get(),function(e,t,n){return e.isDrop()?UB.failure($localize(he||(he=Wg(["This move is a drop, please do a transfer!"])))):UB.SUCCESS},$localize(de||(de=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(ve||(ve=Wg(["Victory"]))),$localize(pe||(pe=Wg(["When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!"]))),pne.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),dne.drop(fne.TWO,e9.ONE),function(e,t,n){return e.isDrop()?e.piece.equalsValue(e9.ONE)?UB.SUCCESS:UB.failure($localize(ge||(ge=Wg(["You actively made your opponent win!"])))):UB.failure($localize(ye||(ye=Wg(["Wrong choice, your opponent will win in the next turn no matter which piece is dropped!"]))))},$localize(me||(me=Wg(["Congratulations!"]))))]});function kne(e,t){if(1&e&&(NC(),OP(0,"circle",5)),2&e){var n=t.$implicit,r=LP();pP("cx",r.getRemainingPieceCx(n))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Cne(e,t){if(1&e&&(NC(),OP(0,"circle",6)),2&e){var n=t.$implicit,r=LP();pP("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(n))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function wne(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",9),RP("click",function(){aC(n);var e=LP().index,t=LP();return t.onArrowClick(e,t.PlayerOrNone.ZERO)}),SP()}if(2&e){var r=LP().index,i=LP();UP("id","dropArrow_zero_",r,""),EP("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ZERO)),pP("points",i.ARROW_COORD)("transform","translate("+i.SPACE_SIZE/2+" "+-i.SPACE_SIZE/2+")")}}function _ne(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",9),RP("click",function(){aC(n);var e=LP().index,t=LP();return t.onArrowClick(e,t.PlayerOrNone.ONE)}),SP()}if(2&e){var r=LP().index,i=LP();UP("id","dropArrow_one_",r,""),EP("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ONE)),pP("points",i.ARROW_COORD)("transform","translate(0 "+-i.SPACE_SIZE/2+")")}}function Ene(e,t){if(1&e){var n=AP();NC(),TP(0),PP(1,"circle",10),RP("click",function(){aC(n);var e=LP().index;return LP().onSquareClick(e)}),SP(),IP()}if(2&e){var r=t.$implicit,i=LP(),a=i.index,o=i.$implicit,s=LP();BE(1),BP("id","square_",a,"_piece_",r,"_out_of_",o.count(s.PlayerOrNone.NONE),""),EP("ngClass",s.getPieceClasses(a,r,o)),pP("cx",s.getCircleCenter(a,r,o).x)("cy",s.getCircleCenter(a,r,o).y)}}function bne(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),CP(1,wne,1,4,"polygon",7),CP(2,_ne,1,4,"polygon",7),PP(3,"rect",8),RP("click",function(){var e=aC(n).index;return LP().onSquareClick(e)}),SP(),CP(4,Ene,2,6,"ng-container",4),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP();pP("transform",a.getBlockTransform(i)),BE(1),EP("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ZERO)),BE(1),EP("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ONE)),BE(1),UP("id","square_",i,""),EP("ngClass",a.getSquareClasses(i)),pP("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),BE(1),EP("ngForOf",a.range(r.count(a.PlayerOrNone.NONE)))}}var Pne=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).PlayerOrNone=J7,r.BOARD_WIDTH=4*r.SPACE_SIZE,r.BOARD_HEIGHT=4.5*r.SPACE_SIZE,r.ARROW_COORD=n.getArrowCoord(),r.PIECES_PER_PLAYER=pne.PIECES_PER_PLAYER,r.selectedPiece=NB.empty(),r.leftPiece=NB.empty(),r.droppedPiece=NB.empty(),r.displayableArrow=[],r.rules=gne.get(),r.hasAsymetricBoard=!0,r.availableMinimaxes=[new yne(r.rules,"ApagosDummyMinimax")],r.encoder=dne.encoder,r.tutorial=(new mne).tutorial,r.PIECE_RADIUS=2*r.SPACE_SIZE/(r.PIECES_PER_PLAYER+.5),r.updateBoard(),r}return my(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=NB.empty(),this.showPossibleDrops()}},{key:"updateBoard",value:function(){var e=this.getState();this.board=e.board,this.remainingZero=e.remaining.get(e9.ZERO).get(),this.remainingOne=e.remaining.get(e9.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}},{key:"hideLastMove",value:function(){this.movedSquare=[],this.droppedPiece=NB.empty(),this.leftPiece=NB.empty(),this.selectedPiece=NB.empty()}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}},{key:"showLastDrop",value:function(e){var t=e.piece.get(),n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));var r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=NB.of({square:n,piece:r})}},{key:"getLowestPlayerPiece",value:function(e,t){var n=e.count(t);return t===e9.ZERO?n-1:e.count(J7.NONE)-n}},{key:"showLastTransfer",value:function(e){var t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=NB.of({square:r,piece:i});var a=e.landing.x,o=this.getLowestPlayerPiece(this.board[a],n);this.droppedPiece=NB.of({square:a,piece:o})}},{key:"showPossibleDrops",value:function(){this.displayableArrow=[];for(var e=this.getState(),t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(e9.ZERO).get()>0&&this.displayableArrow.push({x:t,player:e9.ZERO}),e.remaining.get(e9.ONE).get()>0&&this.displayableArrow.push({x:t,player:e9.ONE}))}},{key:"getCircleCenter",value:function(e,t,n){var r=this.SPACE_SIZE/2,i=this.SPACE_SIZE/2;if(1===n.count(J7.NONE))return new pte(r,i);var a=n.count(J7.NONE),o=2*t*Math.PI/a-Math.PI/2,s=.3*this.SPACE_SIZE,u=s*Math.cos(o),c=s*Math.sin(o);return new pte(r+u,i+c)}},{key:"canDisplayArrow",value:function(e,t){return this.displayableArrow.some(function(n){return n.x===e&&n.player.equals(t)})}},{key:"getArrowClasses",value:function(e,t){return[this.getPlayerClass(t)]}},{key:"getBlockTransform",value:function(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}},{key:"getSquareClasses",value:function(e){var t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected-stroke"):this.movedSquare.includes(e)&&t.push("last-move-stroke"),t}},{key:"onArrowClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#dropArrow_"+(t===e9.ZERO?"zero":"one")+"_"+e)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=fne.from(e),n.selectedPiece.isPresent()?(s=n.selectedPiece.get().square,o=dne.transfer(fne.from(s),a).get()):o=dne.drop(a,t),u=n.getState(),r.abrupt("return",n.chooseMove(o,u));case 7:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e,t,n){var r={square:e,piece:t},i=[],a=n.count(e9.ZERO),o=n.count(e9.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected-stroke");else if(this.droppedPiece.equalsValue(r))i.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.getState().getCurrentOpponent()===e9.ZERO?a++:o++}var s=n.count(J7.NONE)-(o+a),u=this.getPieceColor(t,a,s);return""!==u&&i.push(u),i}},{key:"getPieceColor",value:function(e,t,n){return e<t?"player0-fill":e>=t+n?"player1-fill":""}},{key:"onSquareClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.selectedPiece.isPresent()||t.selectedPiece.get().square!==e){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),UB.SUCCESS));case 5:return i=t.getState().getCurrentPlayer(),a=t.board[e],n.abrupt("return",a.count(i)<=0?t.cancelMove(hne.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=NB.of({square:e,piece:t.getLowestPlayerPiece(a,i)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(hne.NO_POSSIBLE_TRANSFER_REMAINS()):UB.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"showAndGetPossibleTranfers",value:function(){this.displayableArrow=[];for(var e=this.selectedPiece.get().square-1,t=this.getState().getCurrentPlayer();0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}},{key:"getRemainingPieceCx",value:function(e){return(e+.5)*this.PIECE_RADIUS*1.5}}],[{key:"getArrowCoord",value:function(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}}]),n}(gte);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-apagos"]],features:[nP],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),PP(1,"g"),CP(2,kne,1,3,"circle",1),CP(3,Cne,1,3,"circle",2),SP(),PP(4,"g",3),CP(5,bne,5,8,"g",4),SP(),SP()),2&e&&(pP("viewBox",-t.STROKE_WIDTH/2+" "+-t.STROKE_WIDTH/2+" "+(t.BOARD_WIDTH+t.STROKE_WIDTH)+" "+(t.BOARD_HEIGHT+t.STROKE_WIDTH)),BE(1),pP("transform","rotate("+180*t.role.value+" "+t.BOARD_WIDTH/2+" "+t.BOARD_HEIGHT/2+")"),BE(1),EP("ngForOf",t.range(t.remainingOne)),BE(1),EP("ngForOf",t.range(t.remainingZero)),BE(2),EP("ngForOf",t.board))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Sne=function(){var e,t=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getViewBox",value:function(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}]),n}(gte);return t.\u0275fac=function(n){return(e||(e=pw(t)))(n||t)},t.\u0275cmp=vk({type:t,selectors:[["ng-component"]],features:[nP],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),One=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r)).captured=i,a}return my(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}}],[{key:"getInitialState",value:function(){return new n(i9.createTable(6,2,4),0,[0,0])}}]),n}(Ate),Tne=function(){var e=my(function e(){gy(this,e)});return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=function(){return $localize(ke||(ke=Wg(["You cannot distribute from the opponent's home."])))},e.MUST_CHOOSE_NON_EMPTY_HOUSE=function(){return $localize(Ce||(Ce=Wg(["You should choose a non-empty house to distribute."])))},e.SHOULD_DISTRIBUTE=function(){return $localize(we||(we=Wg(["You should distribute but you do not."])))},e}(),Ine=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,r){AB(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:t});var i=e.x,a=t.getCurrentPlayer(),o=t.getCurrentOpponent().value,s=t.getCopiedBoard(),u=n.distribute(i,o,s),c=u[u.length-1];return c.y===o?new One(s,t.turn+1,t.captured):this.applyPotentialCapture(a,c,s,t)}},{key:"applyPotentialCapture",value:function(e,t,r,i){var a=i.getCurrentOpponent(),o=[i.captured[0],i.captured[1]],s=n.captureIfLegal(t.x,t.y,e,r);o[e.value]+=s.capturedSum;var u=s.resultingBoard;if(n.mustMansoon(e,u)){var c=n.mansoon(a,u);return o[a.value]+=c.capturedSum,new One(c.resultingBoard,i.turn+1,o)}return new One(u,i.turn+1,o)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"mustMansoon",value:function(e,t){return n.isStarving(e,t)&&!1===n.canDistribute(e.getOpponent(),t)}},{key:"mansoon",value:function(e,t){var n=i9.copyBiArray(t),r=0,i=[[0,0,0,0,0,0],[0,0,0,0,0,0]],a=0,o=e.getOpponent().value;do{r+=n[o][a],i[o][a]=n[o][a],n[o][a]=0,a++}while(a<6);return{capturedSum:r,captureMap:i,resultingBoard:n}}},{key:"isLegal",value:function(e,t){var r=t.getCurrentOpponent(),i=r.value,a=e.x;if(0===t.getPieceAtXY(a,i))return DB.failure(Tne.MUST_CHOOSE_NON_EMPTY_HOUSE());var o=n.isStarving(r,t.board),s=!1===n.doesDistribute(a,i,t.board);return o&&s?DB.failure(Tne.SHOULD_DISTRIBUTE()):DB.success(void 0)}},{key:"doesDistribute",value:function(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}},{key:"canDistribute",value:function(e,t){for(var r=0;r<6;r++)if(n.doesDistribute(r++,e.getOpponent().value,t))return!0;return!1}},{key:"isStarving",value:function(e,t){var n=0,r=e.getOpponent().value;do{if(t[r][n++]>0)return!1}while(n<6);return!0}},{key:"distribute",value:function(e,t,n){var r=e,i=t,a=n[t][e],o=[];for(n[t][e]=0;a>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,o.push(new pte(e,t)),a--);return o}},{key:"capture",value:function(e,t,n,r){var i=i9.copyBiArray(r);F7(t!==n.getOpponent().value,"AwaleRules.capture cannot capture the players house");var a=i[t][e],o=0,s=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(a<2||a>3)return{capturedSum:0,captureMap:s,resultingBoard:i};var u=-1,c=-1;n===e9.ONE&&(u=1,c=6);do{s[t][e]=a,o+=a,i[t][e]=0,a=i[t][e+=u]}while(e!==c&&(2===a||3===a));return{capturedSum:o,captureMap:s,resultingBoard:i}}},{key:"captureIfLegal",value:function(e,t,r,i){var a=i9.copyBiArray(i),o=n.capture(e,t,r,i),s=n.isStarving(r.getOpponent(),o.resultingBoard);return o.capturedSum>0&&s?{capturedSum:0,resultingBoard:a,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:o}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captured[0]>24?Bte.ZERO_WON:t.captured[1]>24?Bte.ONE_WON:24===t.captured[0]&&24===t.captured[1]?Bte.DRAW:Bte.ONGOING}}]),n}(zte);return e.VERBOSE=!1,e}(),Ane=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).x=e,r}return my(n,[{key:"equals",value:function(e){return e===this||e.x===this.x}},{key:"toString",value:function(){return"AwaleMove("+this.x+")"}}],[{key:"from",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;default:return F7(5===e,"Invalid x for AwaleMove: "+e),n.FIVE}}}]),n}(xte);Ane.ZERO=new Ane(0),Ane.ONE=new Ane(1),Ane.TWO=new Ane(2),Ane.THREE=new Ane(3),Ane.FOUR=new Ane(4),Ane.FIVE=new Ane(5),Ane.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return Ane.from(e)}}]),n}(Q7));var Mne=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState,i=(r.turn+1)%2,a=0;do{0!==r.getPieceAtXY(a,i)&&(t=Ane.from(a),Ine.isLegal(t,r).isSuccess()&&(t=Ane.from(a),n.push(t))),a++}while(a<6);return this.orderMoves(e,n)}},{key:"orderMoves",value:function(e,t){var n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent().value,i=n.value;return i9.sortByDescending(t,function(t){var a,o=e.gameState.getCopiedBoard(),s=o[r][t.x],u=Ine.distribute(t.x,r,o),c=u[u.length-1],l=0;return c.y===r?(a=0,s<=6&&(l=10)):a=Ine.captureIfLegal(c.x,i,n,o).capturedSum,100*a+l-s}),t}},{key:"getBoardValue",value:function(e){var t=Ine.getGameStatus(e);if(t.isEndGame)return Ste.fromWinner(t.winner);var n=e.gameState.getCapturedCopy();return new Ste(n[1]-n[0])}}]),n}(Pte),xne=my(function e(){gy(this,e),this.tutorial=[Zte.anyMove($localize(_e||(_e=Wg(["Sowing"]))),$localize(Ee||(Ee=Wg(["Awal\xe9 is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.\n         Let's see how seeds are sown. The spaces in Awal\xe9 are called the houses.\n         As you're playing first, the 6 houses on the bottom are yours.<br/><br>\n         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house."]))),One.getInitialState(),Ane.ZERO,$localize(be||(be=Wg(["Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.\n        This is how seeds are sown:\n        one by one from the house next to the one they come from, clockwise."])))),Zte.anyMove($localize(Pe||(Pe=Wg(["Big sowing"]))),$localize(Se||(Se=Wg(["You are still the first player.\n        When there are enough seeds to make a full turn, something else happens.<br/><br/>\n        Sow the house that contains 12 seeds."]))),new One([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),Ane.ONE,$localize(Oe||(Oe=Wg(["See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds)."])))),Zte.fromMove($localize(Te||(Te=Wg(["Simple capture"]))),$localize(Ie||(Ie=Wg(["After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>The houses on the bottom are yours, do a capture!"]))),new One([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[Ane.ZERO],$localize(Ae||(Ae=Wg(["Well done! This was a simple capture, now let us see how to make multiple captures."]))),$localize(Me||(Me=Wg(["Failed. Try again and sow from the leftmost house."])))),Zte.fromMove($localize(xe||(xe=Wg(["Multiple captures"]))),$localize(Re||(Re=Wg(["By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>The houses on the bottom are yours, do a capture!"]))),new One([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[Ane.ZERO],$localize(Ne||(Ne=Wg(["Nice, you win 3 points from the first house, and 2 from the second!"]))),$localize(De||(De=Wg(["Failed. Try again."])))),Zte.fromMove($localize(Le||(Le=Wg(["Interrupted capture"]))),$localize(Fe||(Fe=Wg(["By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>The houses on the bottom are yours, do a capture!"]))),new One([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[Ane.ZERO],$localize(Ue||(Ue=Wg(["Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house."]))),$localize(Ve||(Ve=Wg(["Failed. Try again."])))),Zte.fromMove($localize(Be||(Be=Wg(["Capture on the other side only"]))),$localize(ze||(ze=Wg(["Your houses are the one below. Try to capture the two leftmost houses of the opponent."]))),new One([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[Ane.ONE],$localize(He||(He=Wg(["Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!"]))),$localize(Ge||(Ge=Wg(["You have only captured one house, try again!"])))),Zte.fromMove($localize($e||($e=Wg(["Do not starve"]))),$localize(Ze||(Ze=Wg(["You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>\n        Your houses are the one below. Try it."]))),new One([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[Ane.ZERO],$localize(qe||(qe=Wg(["Sadly, you cannot capture here, otherwise the opponent could not play after you.\n        When this happens, the move can be made, but no capture takes place!"]))),$localize(We||(We=Wg(["Failed. Try again."])))),Zte.anyMove($localize(je||(je=Wg(["Feeding is mandatory"]))),$localize(Ye||(Ye=Wg(["You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>Go ahead!"]))),new One([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),Ane.THREE,$localize(Ke||(Ke=Wg(["Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.\n        It is often a good way to have easy captures!"])))),Zte.anyMove($localize(Qe||(Qe=Wg(["End of the game"]))),$localize(Xe||(Xe=Wg(["A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>Your houses are still the bottom one, sow the leftmost house."]))),new One([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),Ane.ZERO,$localize(Je||(Je=Wg(["Also, as soon as on player cannot play, the other player captures all the seeds in its own side.\n         Here, it was the first player's turn, and the second player has taken all the remaining seeds."]))))]});function Rne(e,t){if(1&e){var n=AP();NC(),PP(0,"text",7),RP("click",function(){aC(n);var e=LP().index,t=LP().index;return LP().onClick(e,t)}),uS(1),SP()}if(2&e){var r=LP().index,i=LP().index,a=LP();VP("id","captured_",r,"_",i,""),pP("x",65+100*r)("y",81+120*i)("transform",a.getPieceRotation(r,i)),BE(1),lS(" ",-a.captured[i][r]," ")}}function Nne(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"circle",4),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),SP(),PP(2,"text",5),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),uS(3),SP(),CP(4,Rne,2,6,"text",6),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP().index,o=LP();BE(1),VP("id","click_",i,"_",a,""),EP("ngClass",o.getSpaceClasses(i,a)),pP("cx",o.getPieceCx(i))("cy",o.getPieceCy(a)),BE(1),VP("id","number_",i,"__",a,""),pP("x",50+100*i)("y",66+120*a)("transform",o.getPieceRotation(i,a)),BE(1),lS(" ",r," "),BE(1),EP("ngIf",o.captured[a][i]>0)}}function Dne(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Nne,5,12,"g",2),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}var Lne=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).last=NB.empty(),r.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],r.filledCoords=[],r.hasAsymetricBoard=!0,r.scores=NB.of([0,0]),r.rules=new Ine(One),r.availableMinimaxes=[new Mne(r.rules,"AwaleMinimax")],r.encoder=Ane.encoder,r.tutorial=(new xne).tutorial,r.updateBoard(),r}return my(n,[{key:"updateBoard",value:function(){var e=this.getState();this.scores=NB.of(e.getCapturedCopy()),this.hidePreviousMove();var t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){var n=e.getCurrentPlayer().value;this.last=NB.of(new pte(t.get().x,n)),this.showPreviousMove()}else this.last=NB.empty()}},{key:"hidePreviousMove",value:function(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=this.rules.node.mother.get().gameState,n=i9.copyBiArray(t.board),r=t.getCurrentOpponent().value;this.filledCoords=Ine.distribute(e.x,r,n);var i=this.filledCoords[this.filledCoords.length-1];if(i.y!==r){var a=Ine.captureIfLegal(i.x,i.y,t.getCurrentPlayer(),n);this.captured=a.captureMap;var o=this.getState().getCurrentPlayer();Ine.mustMansoon(o.getOpponent(),a.resultingBoard)&&(this.captured=Ine.mansoon(o,a.resultingBoard).captureMap)}}},{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(t!==n.getState().getCurrentPlayer().value){r.next=5;break}return r.abrupt("return",n.cancelMove(Tne.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME()));case 5:return n.last=NB.empty(),a=Ane.from(e),r.abrupt("return",n.chooseMove(a,n.getState()));case 8:case"end":return r.stop()}},r)}))()}},{key:"getSpaceClasses",value:function(e,t){var n=new pte(e,t),r="player"+(t+1)%2+"-fill";return this.captured[t][e]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(n)?["moved-stroke","last-move-stroke",r]:this.filledCoords.some(function(e){return e.equals(n)})?["moved-stroke",r]:[r]}},{key:"getPieceCx",value:function(e){return 50+100*e}},{key:"getPieceCy",value:function(e){return 50+120*e}},{key:"getPieceRotation",value:function(e,t){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(t)+")"}}]),n}(Sne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-awale-component"]],features:[nP],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),OP(1,"rect",1),CP(2,Dne,2,1,"g",2),OP(3,"line",3),SP()),2&e&&(pP("transform",t.rotation),BE(2),EP("ngForOf",t.board))},directives:[aM,rM,sM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Fne=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;if(gy(this,n),i=t.call(this,e.x,e.y),e.equals(r))throw new Error(bte.MOVE_CANNOT_BE_STATIC());return i.end=r,sy(i)}return my(n,[{key:"length",value:function(){return this.coord.getDistance(this.end)}},{key:"getDirection",value:function(){return fte.factory.fromMove(this.coord,this.end)}}],[{key:"getEncoder",value:function(e,t,n){return new(function(r){iy(a,r);var i=oy(a);function a(){var n;return gy(this,a),(n=i.apply(this,arguments)).shiftAX=t,n.shiftDY=n.shiftAX*e,n.shiftDX=n.shiftDY*t,n}return my(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new pte((r-=r%1)%e,i);r/=e;var o=(r-=r%1)%t;r/=t;var s=new pte((r-=r%1)%e,o);return n(s,a)}}]),a}(Q7))}}]),n}(Rte),Une=function(){var e=my(function e(){gy(this,e)});return e.LANDING_ON_OCCUPIED_SQUARE=function(){return $localize(et||(et=Wg(["You cannot land on an occupied square."])))},e.THRONE_IS_LEFT_FOR_GOOD=function(){return $localize(tt||(tt=Wg(["Once you left the central throne, you cannot return to it."])))},e.SOLDIERS_CANNOT_SIT_ON_THRONE=function(){return $localize(nt||(nt=Wg(["Soldiers cannot sit on the throne."])))},e.MOVE_MUST_BE_ORTHOGONAL=function(){return $localize(rt||(rt=Wg(["Tafl moves must be orthogonal."])))},e}(),Vne=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;if(gy(this,n),i=t.call(this,e,r),e.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(r.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+r.toString()+".");var a=e.getDirectionToward(r);if(a.isFailure()||a.get().isDiagonal())throw new Error(Une.MOVE_MUST_BE_ORTHOGONAL());return sy(i)}return my(n,[{key:"equals",value:function(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"TaflMove("+this.coord+"->"+this.end+")"}}]),n}(Fne),Bne=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getMaximalDistance",value:function(){return 7}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return DB.success(r)}catch(r){return DB.failure(r.message)}}}]),n}(Vne);Bne.encoder=Fne.getEncoder(7,7,Bne.of);var zne={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:e9.ZERO},Hne=function(){function e(t,n){gy(this,e),this.owner=t,this.king=n}return my(e,[{key:"isKing",value:function(){return this.king}},{key:"getOwner",value:function(){return this.owner}}]),e}();Hne.UNOCCUPIED=new Hne(J7.NONE,!1),Hne.PLAYER_ONE_KING=new Hne(J7.ONE,!0),Hne.INVADERS=new Hne(J7.ZERO,!1),Hne.DEFENDERS=new Hne(J7.ONE,!1);var Gne=my(function e(t){gy(this,e),this.value=t});Gne.NONE=new Gne("NONE"),Gne.OPPONENT=new Gne("OPPONENT"),Gne.PLAYER=new Gne("PLAYER");var $ne=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"isCentralThrone",value:function(e){return e.equals(this.getCentralThrone())}},{key:"getCentralThrone",value:function(){var e=(this.board.length-1)/2;return new pte(e,e)}},{key:"getRelativeOwner",value:function(e,t){var n=this.getAbsoluteOwner(t);return n===J7.NONE?Gne.NONE:e===n?Gne.PLAYER:Gne.OPPONENT}},{key:"getAbsoluteOwner",value:function(e){return this.getPieceAt(e).getOwner()}}]),n}(Ate),Zne=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Hne.UNOCCUPIED,t=Hne.INVADERS,r=Hne.DEFENDERS;return new n([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,Hne.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}]),n}($ne),qne=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e)).config=r,a.generateMove=i,a}return my(n,[{key:"isLegal",value:function(e,t){AB(n.VERBOSE,{tablutRules_isLegal:{move:e,state:t}});var r=t.getCurrentPlayer(),i=this.getMoveValidity(r,e,t);return i.isFailure()?DB.failure(i.getReason()):DB.success(void 0)}},{key:"getMoveValidity",value:function(e,t,n){var r=n.getRelativeOwner(e,t.coord);if(r===Gne.NONE)return UB.failure(bte.MUST_CHOOSE_PLAYER_PIECE());if(r===Gne.OPPONENT)return UB.failure(bte.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==Gne.NONE)return UB.failure(Une.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return UB.failure(Une.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return UB.failure(Une.THRONE_IS_LEFT_FOR_GOOD())}for(var i=t.coord.getDirectionToward(t.end).get(),a=t.coord.getOrthogonalDistance(t.end),o=t.coord.getNext(i),s=1;s<a;s++){if(n.getPieceAt(o)!==Hne.UNOCCUPIED)return UB.failure(bte.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return UB.SUCCESS}},{key:"isThrone",value:function(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}},{key:"isExternalThrone",value:function(e){var t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}},{key:"tryCapture",value:function(e,t,n,r){var i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===Gne.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):NB.empty()}},{key:"captureKing",value:function(e,t,n,r){var i=t.getNext(n),a=this.getSurroundings(i,n,e,r),o=a.backCoord,s=a.back,u=a.backInRange,c=a.left,l=a.leftCoord,f=a.right,h=a.rightCoord;return!1===u?this.captureKingAgainstTheWall(c,f,i):s===Gne.NONE&&this.isThrone(r,o)?this.captureKingAgainstThrone(o,i,c,f):s===Gne.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,f,h):NB.empty()}},{key:"getSurroundings",value:function(e,t,n,r){var i=e.getNext(t),a=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=a?r.getRelativeOwner(n,i):Gne.NONE,s=e.getLeft(t),u=s.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,s):Gne.NONE,c=e.getRight(t),l=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):Gne.NONE;return{backCoord:i,back:o,backInRange:a,leftCoord:s,left:u,rightCoord:c,right:l}}},{key:"captureKingAgainstTheWall",value:function(e,t,r){var i=e===Gne.PLAYER?1:0;return 2===(i+=t===Gne.PLAYER?1:0)&&this.config.BORDER_CAN_SURROUND_KING?(AB(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),NB.of(r)):NB.empty()}},{key:"captureKingAgainstThrone",value:function(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return NB.of(t)}else{var i=r===Gne.PLAYER,a=n===Gne.PLAYER||i;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&a)return NB.of(t)}return NB.empty()}},{key:"capturePawn",value:function(e,t,r,i){var a=!1,o=t.getNext(r),s=o.getNext(r),u=Gne.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(u=i.getRelativeOwner(e,s)),u===Gne.NONE?!1===this.isThrone(i,s)?(AB(n.VERBOSE||a,"cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),NB.empty()):(AB(n.VERBOSE||a,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),NB.of(o)):u===Gne.PLAYER?(AB(n.VERBOSE||a,"pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),NB.of(o)):(AB(n.VERBOSE||a,"no captures; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),NB.empty())}},{key:"captureKingWithAtLeastASandwich",value:function(e,t,r,i,a,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return NB.of(t);var s=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,i),c=r===Gne.PLAYER||u&&s,l=this.isThrone(e,o);return c&&(a===Gne.PLAYER||l&&s)?(AB(n.VERBOSE||!1,"king captured by 4 invaders"),NB.of(t)):NB.empty()}},{key:"kingTouchCentralThrone",value:function(e,t){var n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}},{key:"applyLegalMove",value:function(e,t){AB(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:t}});var r=t.turn,i=t.getCopiedBoard(),a=t.getCurrentPlayer(),o=e.coord,s=e.end;i[s.y][s.x]=i[o.y][o.x],i[o.y][o.x]=Hne.UNOCCUPIED;var u,c=dy(hte.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=this.tryCapture(a,e.end,l,t);f.isPresent()&&(i[f.get().y][f.get().x]=Hne.UNOCCUPIED)}}catch(h){c.e(h)}finally{c.f()}return t.from(i,r+1)}},{key:"getGameStatus",value:function(e){var t=this.getWinner(e.gameState);return t.isPresent()?Bte.getVictory(t.get()):Bte.ONGOING}},{key:"getWinner",value:function(e){var t=!1,n=this.getKingCoord(e);if(n.isAbsent())return AB(t,"The king is dead, victory to invader"),NB.of(this.getInvader());var r=n.get();return this.isExternalThrone(r)?(AB(t,"The king escape, victory to defender"),NB.of(this.getDefender())):this.isPlayerImmobilized(e9.ZERO,e)?(AB(t,"Zero has no move, victory to one"),NB.of(e9.ONE)):this.isPlayerImmobilized(e9.ONE,e)?(AB(t,"One has no move, victory to zero"),NB.of(e9.ZERO)):(AB(t,"no victory"),NB.empty())}},{key:"getKingCoord",value:function(e){AB(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(var t=0;t<this.config.WIDTH;t++)for(var r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return NB.of(new pte(r,t));return NB.empty()}},{key:"getInvader",value:function(){return this.config.INVADER}},{key:"getDefender",value:function(){return this.config.INVADER.getOpponent()}},{key:"isPlayerImmobilized",value:function(e,t){return 0===this.getPlayerListMoves(e,t).length}},{key:"getPlayerListMoves",value:function(e,t){var r=[],i=this.getPlayerListPawns(e,t);AB(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:t}});var a,o=dy(i);try{for(o.s();!(a=o.n()).done;){var s,u=a.value,c=dy(this.getPossibleDestinations(u,t));try{for(c.s();!(s=c.n()).done;){var l=s.value,f=this.generateMove(u,l);r.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return r}},{key:"getPlayerListPawns",value:function(e,t){for(var n=[],r=0;r<this.config.WIDTH;r++)for(var i=0;i<this.config.WIDTH;i++){var a=new pte(i,r);t.getAbsoluteOwner(a)===e&&n.push(a)}return n}},{key:"getPossibleDestinations",value:function(e,t){var n,r,i=[],a=dy(hte.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=e.getNext(o,1);for(var s=!1;n.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(n)===J7.NONE?this.isExternalThrone(n)?t.getPieceAt(e).isKing()&&i.push(n):t.isCentralThrone(n)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&i.push(n):i.push(n):s=!0,n=n.getNext(o,1)}}catch(u){a.e(u)}finally{a.f()}return i}}]),n}(zte);return e.VERBOSE=!1,e}(),Wne=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.call(this,Zne,zne,Bne.of)}return my(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Vte.ruler=this.singleton,n.singleton}}]),n}(qne),jne=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e)).VERBOSE=r,a.generateMove=i,a.viewInfo={pieceClasses:[]},a.EMPTY=Hne.UNOCCUPIED,a.captureds=[],a.chosen=NB.empty(),a.lastMove=NB.empty(),a}return my(n,[{key:"getViewBox",value:function(){var e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}},{key:"updateBoard",value:function(){AB(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.getState().getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}},{key:"showPreviousMove",value:function(){var e,t=this.rules.node.mother.get().gameState,n=this.getState().getCurrentOpponent(),r=dy(hte.ORTHOGONALS);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.lastMove.get().end.getNext(i,1);if(a.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){var o=t.getRelativeOwner(n,a)===Gne.OPPONENT,s=this.getState().getPieceAt(a)===Hne.UNOCCUPIED;o&&s&&this.captureds.push(a)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"updateViewInfo",value:function(){for(var e=[],t=0;t<this.board.length;t++){for(var n=[],r=0;r<this.board[0].length;r++){var i;i=this.board[t][r].getOwner()===J7.NONE?[""]:this.getPieceClasses(r,t),n.push(i)}e.push(n)}this.viewInfo={pieceClasses:e}}},{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(AB(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")"),!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=4;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 4:return a=new pte(e,t),r.abrupt("return",n.chosen.equalsValue(a)?(n.cancelMoveAttempt(),UB.SUCCESS):n.chosen.isAbsent()||n.pieceBelongToCurrentPlayer(a)?n.choosePiece(a):n.chooseDestination(e,t));case 6:case"end":return r.stop()}},r)}))()}},{key:"chooseDestination",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(AB(n.VERBOSE,"TaflComponent.chooseDestination"),i=n.chosen.get(),a=new pte(e,t),!(o=n.generateMove(i,a)).isSuccess()){r.next=8;break}return r.next=5,n.chooseMove(o.get(),n.getState());case 5:r.t0=r.sent,r.next=9;break;case 8:r.t0=n.cancelMove(o.getReason());case 9:return r.abrupt("return",r.t0);case 10:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){return AB(this.VERBOSE,"TaflComponent.choosePiece"),this.board[e.y][e.x]===Hne.UNOCCUPIED?this.cancelMove(bte.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e)?(this.chosen=NB.of(e),this.updateViewInfo(),AB(this.VERBOSE,"selected piece = ("+e.x+", "+e.y+")"),UB.SUCCESS):this.cancelMove(bte.CANNOT_CHOOSE_OPPONENT_PIECE())}},{key:"pieceBelongToCurrentPlayer",value:function(e){var t=this.getState(),n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===Gne.PLAYER}},{key:"cancelMoveAttempt",value:function(){this.chosen=NB.empty(),this.updateViewInfo()}},{key:"isThrone",value:function(e,t){var n=this.getState();return this.rules.isThrone(n,new pte(e,t))}},{key:"isCentralThrone",value:function(e,t){return this.getState().isCentralThrone(new pte(e,t))}},{key:"getPieceClasses",value:function(e,t){var n=[],r=new pte(e,t),i=this.getState().getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equalsValue(r)&&n.push("selected-stroke"),n}},{key:"getRectClasses",value:function(e,t){var n=[],r=new pte(e,t);if(this.captureds.some(function(e){return e.equals(r)}))n.push("captured-fill");else if(this.lastMove.isPresent()){var i=this.lastMove.get().coord,a=this.lastMove.get().end;(r.equals(i)||r.equals(a))&&n.push("moved-fill")}return n}},{key:"getClickables",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new pte(n,t);this.isClickable(r)&&e.push(r)}return e}},{key:"isClickable",value:function(e){return this.pieceBelongToCurrentPlayer(e)}},{key:"isInvader",value:function(e,t){return this.board[t][e]===Hne.INVADERS}},{key:"isKing",value:function(e,t){return this.board[t][e].isKing()}}]),n}(Sne),Yne=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){AB(!1,{TaflMinimax_getListMoves:{node:e}});var t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}},{key:"orderMoves",value:function(e,t){var n=this,r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?i9.sortByDescending(t,function(e){return-e.end.getOrthogonalDistance(r)}):i9.sortByDescending(t,function(e){return e.coord.equals(r)?n.ruler.isExternalThrone(e.end)?2:1:0}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new Ste(n.get().getVictoryValue());var r=this.ruler.getPlayerListPawns(e9.ZERO,t).length,i=this.ruler.getPlayerListPawns(e9.ONE,t).length,a=[1,2][this.ruler.config.INVADER.value];a*=e9.ZERO.getScoreModifier();var o=[2,1][this.ruler.config.INVADER.value];return o*=e9.ONE.getScoreModifier(),new Ste(r*a+i*o)}}]),n}(Pte),Kne=function(){function e(t,n){gy(this,e),this.directThreats=t,this.mover=n}return my(e,[{key:"equals",value:function(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}]),e}(),Qne=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,new Tte([e]),r)).directThreat=e,i.mover=r,i}return my(n)}(Kne),Xne=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"toFields",value:function(e){return[[e.y],e.x]}}]),n}(function(e,t){iy(r,e);var n=oy(r);function r(e){var t;if(gy(this,r),(t=n.call(this)).map=[],t.values=[],void 0!==e){var i,a=dy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.add(o)}}catch(s){a.e(s)}finally{a.f()}}return sy(t)}return my(r,[{key:"add",value:function(e){var t,n=this.toFields(e),r=this.map,i=dy(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;void 0===r[a]&&(r[a]=[]),r=r[a]}}catch(s){i.e(s)}finally{i.f()}var o=n[1];return void 0===r[o]&&(r[o]=!0,this.values.push(e),!0)}},{key:"contains",value:function(e){var t,n=this.toFields(e),r=this.map,i=dy(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0===r[a])return!1;r=r[a]}}catch(o){i.e(o)}finally{i.f()}return void 0!==r[n[1]]}},{key:t,value:function(){return this.values.values()}}]),r}(Tte,Symbol.iterator)),Jne=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e,r)).width=i.ruler.config.WIDTH,i.maxInfluence=16*(2*i.width-2),i.scoreByThreatenedPiece=16*i.maxInfluence+1,i.scoreBySafePiece=16*i.scoreByThreatenedPiece+1,i}return my(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new Ste(t.toBoardValue());var n,r=e.gameState,i=Hne.UNOCCUPIED,a=0,o=this.getPiecesMap(r),s=this.getThreatMap(r,o),u=this.filterThreatMap(s,r),c=dy(e9.PLAYERS);try{for(c.s();!(n=c.n()).done;){var l,f=n.value,h=dy(o.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;if(u.get(d).isPresent())a+=f.getScoreModifier()*this.scoreByThreatenedPiece;else{a+=f.getScoreModifier()*this.scoreBySafePiece;var v,p=0,g=dy(hte.ORTHOGONALS);try{for(g.s();!(v=g.n()).done;)for(var y=v.value,m=d.getNext(y,1);m.isInRange(this.width,this.width)&&r.getPieceAt(m)===i;)p++,m=m.getNext(y,1)}catch(k){g.e(k)}finally{g.f()}a+=p*f.getScoreModifier()}}}catch(k){h.e(k)}finally{h.f()}}}catch(k){c.e(k)}finally{c.f()}return new Ste(a)}},{key:"getPiecesMap",value:function(e){for(var t=Hne.UNOCCUPIED,n=[],r=[],i=0;i<this.width;i++)for(var a=0;a<this.width;a++){var o=new pte(a,i);e.getPieceAt(o)!==t&&(e.getAbsoluteOwner(o)===e9.ZERO?n.push(o):r.push(o))}return new Lte([{key:e9.ZERO,value:new Xne(n)},{key:e9.ONE,value:new Xne(r)}])}},{key:"getThreatMap",value:function(e,t){var n,r=new Lte,i=dy(e9.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=dy(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreats(u,e);this.isThreatReal(u,e,c)&&r.set(u,new Tte(c))}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreats",value:function(e,t){var n=t.getAbsoluteOwner(e);F7(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");var r,i=n.getOpponent(),a=[],o=dy(hte.ORTHOGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=e.getPrevious(s,1);if(this.isAThreat(u,t,i)){var c,l=[],f=dy(hte.ORTHOGONALS);try{for(f.s();!(c=f.n()).done;){var h=c.value;if(h!==s.getOpposite()){for(var d=e.getNext(s,1);d.isInRange(this.width,this.width)&&t.getPieceAt(d)===Hne.UNOCCUPIED;)d=d.getNext(h);d.isInRange(this.width,this.width)&&t.getAbsoluteOwner(d)===i&&!1===e.getNext(s,1).equals(d)&&l.push(d)}}}catch(v){f.e(v)}finally{f.f()}a.push(new Qne(u,new Xne(l)))}}}catch(v){o.e(v)}finally{o.f()}return a}},{key:"isAThreat",value:function(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==e9.ONE&&t.getPieceAt(e)!==Hne.UNOCCUPIED))}},{key:"isThreatReal",value:function(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;var r,i=dy(n);try{for(i.s();!(r=i.n()).done;){if(r.value.mover.size()>0)return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new Lte,i=e.listKeys(),a=i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentPlayer()}),o=new Xne(i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentOpponent()})),s=dy(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=[],h=dy(l);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d.directThreat)){var v,p=[],g=dy(d.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&f.push(new Qne(d.directThreat,new Xne(p)))}}}catch(_){h.e(_)}finally{h.f()}f.length>0&&r.set(c,new Tte(f))}}catch(_){s.e(_)}finally{s.f()}var m,k=dy(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}(Yne),ere=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new Ste(t.toBoardValue());var r,i=e.gameState,a=this.ruler.config.WIDTH,o=Hne.UNOCCUPIED,s=0,u=this.getPiecesMap(i),c=this.getThreatMap(i,u),l=this.filterThreatMap(c,i),f=dy(e9.PLAYERS);try{for(f.s();!(r=f.n()).done;){var h,d=r.value,v=new Xne,p=dy(u.get(d).get());try{for(p.s();!(h=p.n()).done;){var g=h.value;if(l.get(g).isPresent())s+=d.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE;else{s+=d.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;var y,m=dy(hte.ORTHOGONALS);try{for(m.s();!(y=m.n()).done;)for(var k=y.value,C=g.getNext(k,1);C.isInRange(a,a)&&i.getPieceAt(C)===o;)v.add(C),C=C.getNext(k,1)}catch(P){m.e(P)}finally{m.f()}}}}catch(P){p.e(P)}finally{p.f()}var w,_=dy(v);try{for(_.s();!(w=_.n()).done;){var E=w.value,b=this.getControlledPieceValue(E.x,E.y,a);s+=d.getScoreModifier()*b}}catch(P){_.e(P)}finally{_.f()}}}catch(P){f.e(P)}finally{f.f()}return new Ste(s)}},{key:"getControlledPieceValue",value:function(e,t,n){var r=1;return(0===e||e===n-1)&&(r*=n),(0===t||t===n-1)&&(r*=n),r}}]),n}(Jne);ere.SCORE_BY_THREATENED_PIECE=530,ere.SCORE_BY_SAFE_PIECE=16*ere.SCORE_BY_THREATENED_PIECE+1;var tre=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new Ste(t.toBoardValue());var n,r=e.gameState,i=this.ruler.config.WIDTH,a=Hne.UNOCCUPIED,o=0,s=0,u=0,c=this.getPiecesMap(r),l=this.getThreatMap(r,c),f=this.filterThreatMap(l,r),h=dy(e9.PLAYERS);try{for(h.s();!(n=h.n()).done;){var d,v=n.value,p=new Xne,g=dy(c.get(v).get());try{for(g.s();!(d=g.n()).done;){var y=d.value;if(f.get(y).isPresent())s+=v.getScoreModifier();else{o+=v.getScoreModifier();var m,k=dy(hte.ORTHOGONALS);try{for(k.s();!(m=k.n()).done;)for(var C=m.value,w=y.getNext(C,1);w.isInRange(i,i)&&r.getPieceAt(w)===a;)p.add(w),w=w.getNext(C,1)}catch(O){k.e(O)}finally{k.f()}}}}catch(O){g.e(O)}finally{g.f()}var _,E=dy(p);try{for(E.s();!(_=E.n()).done;){var b=_.value,P=this.getControlledPieceValue(b.x,b.y,i);u+=v.getScoreModifier()*P}}catch(O){E.e(O)}finally{E.f()}}}catch(O){h.e(O)}finally{h.f()}var S=this.getStepForEscape(r);return new Ste(531*S*17*17+531*o*17+531*s+u)}},{key:"getStepForEscape",value:function(e){var t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}},{key:"_getStepForEscape",value:function(e,t,n,r){var i=this,a=this.getNextGen(e,n,r);return 0===a.length?NB.empty():a.some(function(e){return i.ruler.isExternalThrone(e)})?NB.of(t):(t++,r.push.apply(r,fy(a)),this._getStepForEscape(e,t,a,r))}},{key:"getNextGen",value:function(e,t,n){var r,i=this,a=[],o=dy(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=dy(hte.ORTHOGONALS);try{var l=function(){for(var t=s.value,r=u.getNext(t,1);r.isInRange(i.ruler.config.WIDTH,i.ruler.config.WIDTH)&&e.getPieceAt(r)===Hne.UNOCCUPIED;)n.every(function(e){return!1===e.equals(r)})&&a.push(r),r=r.getNext(t,1)};for(c.s();!(s=c.n()).done;)l()}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a}}]),n}(ere);tre.SCORE_BY_THREATENED_PIECE=530,tre.SCORE_BY_SAFE_PIECE=16*ere.SCORE_BY_THREATENED_PIECE+1,tre.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var nre=Hne.UNOCCUPIED,rre=Hne.INVADERS,ire=Hne.DEFENDERS,are=Hne.PLAYER_ONE_KING,ore=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(it||(it=Wg(["Goal of the game"]))),$localize(at||(at=Wg(["Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Zne.getInitialState()),Zte.anyMove($localize(ot||(ot=Wg(["Moving"]))),$localize(st||(st=Wg(["All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Zne.getInitialState(),Bne.of(new pte(3,1),new pte(1,1)),$localize(ut||(ut=Wg(["Congratulations!"])))),Zte.fromMove($localize(ct||(ct=Wg(["Capturing a soldier (1/2)"]))),$localize(lt||(lt=Wg(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Zne([[nre,nre,nre,rre,nre,nre,nre],[nre,nre,nre,rre,nre,nre,nre],[rre,nre,nre,ire,nre,nre,nre],[nre,nre,ire,are,ire,rre,rre],[nre,nre,rre,nre,nre,nre,nre],[nre,nre,nre,ire,nre,rre,nre],[nre,nre,nre,rre,nre,nre,nre]],1),[Bne.of(new pte(3,5),new pte(2,5))],$localize(ft||(ft=Wg(["Congratulations, that will teach him a lesson!"]))),$localize(ht||(ht=Wg(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Zte.fromMove($localize(dt||(dt=Wg(["Capturing a soldier (2/2)"]))),$localize(vt||(vt=Wg(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Zne([[nre,nre,nre,rre,nre,nre,nre],[nre,nre,rre,nre,nre,nre,nre],[nre,nre,nre,ire,nre,nre,nre],[rre,ire,nre,nre,ire,rre,rre],[nre,ire,nre,nre,nre,nre,nre],[nre,rre,nre,are,nre,rre,nre],[nre,nre,nre,rre,nre,nre,nre]],12),[Bne.of(new pte(2,1),new pte(3,1)),Bne.of(new pte(3,0),new pte(3,1))],$localize(pt||(pt=Wg(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(gt||(gt=Wg(["Failed, you did not do the expected move."])))),Zte.fromMove($localize(yt||(yt=Wg(["Capturing the king on his throne"]))),$localize(mt||(mt=Wg(["To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king."]))),new Zne([[nre,nre,nre,nre,nre,nre,nre],[nre,nre,nre,ire,nre,nre,nre],[nre,nre,nre,rre,nre,nre,nre],[nre,rre,nre,are,rre,nre,nre],[nre,nre,nre,rre,nre,nre,nre],[nre,ire,nre,nre,nre,nre,nre],[nre,nre,nre,nre,nre,nre,nre]],72),[Bne.of(new pte(1,3),new pte(2,3))],$localize(kt||(kt=Wg(["Congratulations, you won!"]))),$localize(Ct||(Ct=Wg(["Failed, you let the king run away."])))),Zte.fromMove($localize(wt||(wt=Wg(["Capturing the king next to his throne"]))),$localize(_t||(_t=Wg(["Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king."]))),new Zne([[nre,nre,rre,nre,nre,nre,nre],[nre,nre,nre,rre,nre,nre,nre],[nre,nre,nre,are,rre,nre,nre],[nre,rre,ire,nre,ire,nre,nre],[nre,nre,nre,rre,nre,nre,nre],[nre,nre,nre,nre,nre,nre,nre],[nre,nre,nre,nre,nre,nre,nre]],72),[Bne.of(new pte(2,0),new pte(2,2))],$localize(Et||(Et=Wg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(bt||(bt=Wg(["Failed!"])))),Zte.fromMove($localize(Pt||(Pt=Wg(["Capturing the king far from his throne"]))),$localize(St||(St=Wg(["When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king."]))),new Zne([[nre,nre,nre,nre,nre,nre,nre],[nre,nre,nre,nre,nre,nre,nre],[nre,rre,nre,rre,nre,nre,nre],[rre,nre,nre,nre,ire,nre,nre],[nre,nre,nre,ire,nre,nre,nre],[nre,nre,nre,nre,nre,nre,nre],[nre,are,nre,rre,nre,nre,nre]],72),[Bne.of(new pte(3,6),new pte(2,6))],$localize(Ot||(Ot=Wg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Tt||(Tt=Wg(["Failed!"]))))]});function sre(e,t){1&e&&(NC(),OP(0,"polygon",8))}function ure(e,t){1&e&&(NC(),OP(0,"rect",9))}function cre(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,sre,1,0,"polygon",6),CP(2,ure,1,0,"ng-template",null,7,tI),SP()),2&e){var n=wP(3),r=LP().index,i=LP().index,a=LP();BE(1),EP("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function lre(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"line",13),OP(2,"line",13),OP(3,"line",13),OP(4,"line",13),OP(5,"line",13),SP()),2&e){var n=LP(2).index,r=LP().index,i=LP();BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function fre(e,t){if(1&e&&(NC(),OP(0,"polyline",16)),2&e){var n=LP(3).index,r=LP().index;EP("ngClass",LP().viewInfo.pieceClasses[r][n])}}function hre(e,t){if(1&e&&(NC(),OP(0,"line",13),OP(1,"line",13),OP(2,"line",13),OP(3,"line",13)),2&e){var n=LP(3).index,r=LP().index,i=LP();EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function dre(e,t){if(1&e&&(NC(),CP(0,fre,1,1,"polyline",14),CP(1,hre,4,20,"ng-template",null,15,tI)),2&e){var n=wP(2),r=LP(2).index,i=LP().index;EP("ngIf",LP().isKing(r,i))("ngIfElse",n)}}function vre(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"circle",10),CP(2,lre,6,25,"g",11),CP(3,dre,3,2,"ng-template",null,12,tI),SP()),2&e){var n=wP(4),r=LP().index,i=LP().index,a=LP();BE(1),VP("id","piece_",r,"_",i,""),EP("ngClass",a.viewInfo.pieceClasses[i][r]),pP("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),BE(1),EP("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function pre(e,t){if(1&e){var n=AP();NC(),PP(0,"g",3),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),OP(1,"rect",4),CP(2,cre,4,2,"g",5),CP(3,vre,5,8,"g",5),SP()}if(2&e){var r=t.index,i=LP().index,a=LP();VP("id","click_",r,"_",i,""),pP("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),BE(1),EP("ngClass",a.getRectClasses(r,i)),pP("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),BE(1),EP("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),BE(1),EP("ngIf",a.board[i][r]!==a.EMPTY)}}function gre(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,pre,4,8,"g",2),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function yre(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",17),RP("click",function(){var e=aC(n).$implicit;return LP().onClick(e.x,e.y)}),SP(),SP()}if(2&e){var r=t.$implicit,i=LP();BE(1),VP("id","click_",r.x,"_",r.y,""),pP("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var mre=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e,!1,Bne.from)).rules=Wne.get(),r.availableMinimaxes=[new Yne(r.rules,"DummyBot"),new Jne(r.rules,"Piece > Influence"),new ere(r.rules,"Piece > Control"),new tre(r.rules,"Escape > Piece > Control")],r.encoder=Bne.encoder,r.tutorial=(new ore).tutorial,r}return my(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(jne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-brandhub"]],features:[nP],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,gre,2,1,"g",1),CP(2,yre,2,6,"g",1),SP()),2&e&&(pP("viewBox",t.getViewBox()),BE(1),EP("ngForOf",t.board),BE(1),EP("ngForOf",t.getClickables()))},directives:[aM,rM,sM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),kre=function(){var e,t=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).SPACE_SIZE=50,e}return my(n,[{key:"getTriangleCornerCoords",value:function(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}},{key:"getTriangleCoordinate",value:function(e,t){return this.getTriangleCornerCoords(e,t).map(function(e){return e.x+","+e.y}).reduce(function(e,t){return e+","+t})}},{key:"getDownwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new pte(.5*this.SPACE_SIZE*e,i);return[o,new pte(n,a),new pte(r,i),o]}},{key:"getUpwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new pte(.5*this.SPACE_SIZE*e,a);return[o,new pte(n,i),new pte(r,a),o]}},{key:"getPyramidCoordinate",value:function(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}},{key:"getDownwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}},{key:"getUpwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}}]),n}(gte);return t.\u0275fac=function(n){return(e||(e=pw(t)))(n||t)},t.\u0275cmp=vk({type:t,selectors:[["ng-component"]],features:[nP],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),Cre=function(){var e=my(function e(){gy(this,e)});return e.INVALID_DISTANCE=function(){return $localize(It||(It=Wg(["Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is."])))},e.NOT_ENOUGH_TILES_TO_EXCHANGE=function(){return $localize(At||(At=Wg(["You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it."])))},e.FIRST_CLICK_SHOULD_NOT_BE_NULL=function(){return $localize(Mt||(Mt=Wg(["Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles."])))},e.CANNOT_CAPTURE_FROM_EMPTY=function(){return $localize(xt||(xt=Wg(["You cannot capture from an empty space."])))},e.CANNOT_CAPTURE_OWN_PIECES=function(){return $localize(Rt||(Rt=Wg(["You cannot capture your own pieces."])))},e}(),wre=function(){function e(t,n){gy(this,e),this.direction=t,this.str=n}return my(e,[{key:"toInt",value:function(){var t=this;return e.STEPS.findIndex(function(e){return e.direction.equals(t.direction)})}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return this.str}}],[{key:"fromCoords",value:function(t,n){var r=t.getVectorToward(n),i=e.STEPS.findIndex(function(e){return e.direction.equals(r)});if(-1===i)throw new Error(Cre.INVALID_DISTANCE());return e.STEPS[i]}}]),e}();wre.LEFT=new wre(new ute(-2,0),"LEFT"),wre.UP_LEFT=new wre(fte.UP_LEFT,"UP_LEFT"),wre.UP_RIGHT=new wre(fte.UP_RIGHT,"UP_RIGHT"),wre.RIGHT=new wre(new ute(2,0),"RIGHT"),wre.DOWN_LEFT=new wre(fte.DOWN_LEFT,"DOWN_LEFT"),wre.DOWN_RIGHT=new wre(fte.DOWN_RIGHT,"DOWN_RIGHT"),wre.STEPS=[wre.LEFT,wre.UP_LEFT,wre.UP_RIGHT,wre.RIGHT,wre.DOWN_LEFT,wre.DOWN_RIGHT];var _re=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this)).start=e,o.step=r,o.landingCoord=i,o.capture=a,o}return my(n,[{key:"isTileExchange",value:function(){return this.capture.isPresent()}},{key:"toString",value:function(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}},{key:"equals",value:function(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}],[{key:"fromMovement",value:function(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");var r=new pte(e.x+t.direction.x,e.y+t.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new n(NB.of(e),NB.of(t),NB.of(r),NB.empty())}},{key:"fromTilesExchange",value:function(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new n(NB.empty(),NB.empty(),NB.empty(),NB.of(e))}},{key:"fromCoordToCoord",value:function(e,t){var r=wre.fromCoords(e,t);return n.fromMovement(e,r)}}]),n}(xte);_re.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 1035}},{key:"encodeNumber",value:function(e){if(e.isTileExchange()){var t=e.capture.get().y;return 10*e.capture.get().x+t}var n=e.start.get().y,r=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*r+n}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?_re.fromTilesExchange(new pte(n,t)):_re.fromMovement(new pte(n,t),wre.STEPS[e-1])}}]),n}(Q7));var Ere=function(){function e(){gy(this,e)}return my(e,null,[{key:"getNeighbors",value:function(e){var t=new pte(e.x-1,e.y),n=new pte(e.x+1,e.y);return(e.x+e.y)%2==1?[t,n,new pte(e.x,e.y-1)]:[t,n,new pte(e.x,e.y+1)]}},{key:"getFakeNeighbors",value:function(e){return new pte(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}},{key:"getCommonNeighbor",value:function(t,n){for(var r=e.getNeighbors(t),i=e.getNeighbors(n),a=0;a<r.length;){for(var o=r[a],s=0;s<i.length;){if(o.equals(i[s]))return NB.of(o);s++}a++}return NB.empty()}},{key:"isSpaceDark",value:function(e){return(e.x+e.y)%2==0}}]),e}(),bre=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getEmptyNeighbors",value:function(e,t){return n.getEmptyNeighbors(this.board,e,t)}}],[{key:"getEmptyNeighbors",value:function(e,t,n){var r,i=[],a=dy(Ere.getNeighbors(t));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o)}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(Ate),Pre=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this,e,r)).tiles=i,o.captures=a,o}return my(n,[{key:"applyLegalMovement",value:function(e){AB(n.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});var t=e.start.get(),r=e.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=mte.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=mte.EMPTY,new n(i,this.turn,this.tiles,this.captures)}},{key:"doMovementCaptures",value:function(e){AB(n.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});var t,r=this,i=dy(this.getCapturedNeighbors(e.landingCoord.get()));try{for(i.s();!(t=i.n()).done;){var a=t.value;r=r.capture(a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"getCapturedNeighbors",value:function(e){var t=this,n=this.getCurrentOpponent();return Ere.getNeighbors(e).filter(function(e){return!e.isNotInRange(15,10)&&!!t.getPieceAt(e).is(n)&&t.isSurrounded(e)})}},{key:"isSurrounded",value:function(e){return 0===this.getEmptyNeighbors(e,mte.EMPTY).length}},{key:"capture",value:function(e){AB(n.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});var t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return AB(n.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=mte.EMPTY,r[this.getCurrentPlayer().value]+=1,new n(t,this.turn,this.tiles,r)}},{key:"removeTilesIfNeeded",value:function(e,t){AB(n.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:e,countTiles:t}});var r=this,i=n.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,t);var a,o=dy(n.getPresentNeighborEntrances(i));try{for(o.s();!(a=o.n()).done;){var s=a.value,u=r.getPieceAt(s);u===mte.EMPTY?r=r.removeTilesIfNeeded(s,t):u.is(this.getCurrentOpponent())&&r.isSurrounded(s)&&(r=r.capture(s))}}catch(c){o.e(c)}finally{o.f()}}return r}},{key:"isTileEmpty",value:function(e){F7(this.getPieceAt(e)!==mte.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(var t=0;t<2;t++)for(var n=0;n<3;n++){var r=e.getNext(new ute(n,t),1);if(this.getPieceAt(r)!==mte.EMPTY)return!1}return!0}},{key:"isDeconnectable",value:function(e){var t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;for(var n=0,r=1;r<t.length;r++)!1===this.areNeighbor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}},{key:"areNeighbor",value:function(e,t){return e+1===t||0===e&&5===t}},{key:"getPresentNeighborTilesRelativeIndexes",value:function(e){for(var t=[],r=NB.empty(),i=0;i<6;i++){var a=e.getNext(n.NEIGHBORS_TILES_DIRECTIONS[i],1);a.isInRange(15,10)&&this.getPieceAt(a)!==mte.UNREACHABLE&&(r.isAbsent()&&(r=NB.of(i)),t.push(i-r.get()))}return t}},{key:"deconnectTile",value:function(e,t){AB(n.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});for(var r=this.getCopiedBoard(),i=e.x,a=e.y,o=0;o<2;o++)for(var s=0;s<3;s++)r[a+o][i+s]=mte.UNREACHABLE;var u=[this.tiles[0],this.tiles[1]];return t&&(u[this.getCurrentPlayer().value]+=1),new n(r,this.turn,u,this.captures)}},{key:"getLegalLandings",value:function(e){var t,n=[],r=dy(wre.STEPS);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.getNext(i.direction,1);this.isOnBoard(a)&&this.getPieceAt(a)===mte.EMPTY&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPiecesByFreedom",value:function(){for(var e=[[0,0,0,0],[0,0,0,0]],t=0;t<10;t++)for(var n=0;n<15;n++){var r=this.board[t][n];if(r.isPlayer()){var i=this.getEmptyNeighbors(new pte(n,t),mte.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}],[{key:"getTilesUpperLeftCoord",value:function(e){var t=e.x-e.x%3,n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new pte(t,n)}},{key:"getPresentNeighborEntrances",value:function(e){return[new pte(e.x+1,e.y-1),new pte(e.x+3,e.y+0),new pte(e.x+3,e.y+1),new pte(e.x+1,e.y+2),new pte(e.x-1,e.y+1),new pte(e.x-1,e.y+0)].filter(n.isInRange)}},{key:"getInitialState",value:function(){var e=mte.EMPTY,t=mte.UNREACHABLE,r=mte.ZERO,i=mte.ONE;return new n([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,i,e,i,e,e,r,e,r,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,i,e,i,e,e,r,e,r,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}}]),n}(bre);Pre.VERBOSE=!1,Pre.NEIGHBORS_TILES_DIRECTIONS=[new ute(0,-2),new ute(3,-1),new ute(3,1),new ute(0,2),new ute(-3,1),new ute(-3,-1)],Pre.isInRange=function(e){return e.isInRange(15,10)};var Sre=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}},{key:"applyLegalTileExchange",value:function(e,t){var r=t.getCopiedBoard(),i=e.capture.get();r[i.y][i.x]=mte.EMPTY;var a=[t.captures[0],t.captures[1]];a[t.getCurrentPlayer().value]+=1;var o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;var s=new Pre(r,t.turn,o,a),u=s.removeTilesIfNeeded(i,!1),c=new Pre(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return AB(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:t,afterCapture:s,afterTileRemoval:u,resultingState:c}}),c}},{key:"applyLegalMovement",value:function(e,t){var r=t.applyLegalMovement(e),i=r.removeTilesIfNeeded(e.start.get(),!0),a=i.doMovementCaptures(e),o=new Pre(a.board,t.turn+1,a.tiles,a.captures);return AB(n.VERBOSE,{ab_state:t,afterMovement:r,afterTilesRemoved:i,afterCaptures:a,resultingState:o}),o}},{key:"isLegal",value:function(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}},{key:"isLegalTileExchange",value:function(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return DB.failure(Cre.NOT_ENOUGH_TILES_TO_EXCHANGE());var n=t.getPieceAt(e.capture.get());return n===mte.UNREACHABLE||n===mte.EMPTY?DB.failure(Cre.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?DB.failure(Cre.CANNOT_CAPTURE_OWN_PIECES()):DB.success(void 0)}},{key:"isLegalMovement",value:function(e,t){if(t.getPieceAt(e.start.get())===mte.UNREACHABLE){var n="Cannot start with a coord outside the board "+e.start.get().toString()+".";return DB.failure(n)}if(t.getPieceAt(e.landingCoord.get())===mte.UNREACHABLE){var r="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return DB.failure(r)}var i=t.getPieceAt(e.start.get());return i===mte.EMPTY?DB.failure(bte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.is(t.getCurrentOpponent())?DB.failure(bte.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?DB.failure(bte.MUST_LAND_ON_EMPTY_SPACE()):DB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captures[0]>=18?Bte.ZERO_WON:t.captures[1]>=18?Bte.ONE_WON:Bte.ONGOING}}]),n}(zte);return e.VERBOSE=!1,e}(),Ore=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}},{key:"getListExchanges",value:function(e){var t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=mte.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(var a=0;a<10;a++)for(var o=0;o<15;o++){var s=new pte(o,a);if(n.getPieceAt(s)===i){var u=_re.fromTilesExchange(s);t.push(u)}}return t}},{key:"getListMovement",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<10;i++)for(var a=0;a<15;a++){var o=new pte(a,i);if(n.getPieceAt(o).is(r)){var s,u=dy(n.getLegalLandings(o));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=_re.fromCoordToCoord(o,c);t.push(l)}}catch(f){u.e(f)}finally{u.f()}}}return t}},{key:"getBoardValue",value:function(e){var t=Sre.getGameStatus(e);if(t.isEndGame)return Ste.fromWinner(t.winner);var n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new Ste(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}},{key:"getPiecesScore",value:function(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}},{key:"getPlayerPiecesScore",value:function(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}},{key:"putCaptureFirst",value:function(e,t){var n=this;return i9.sortByDescending(t,function(t){return n.moveCapturesList(e,t).length}),t}},{key:"moveCapturesList",value:function(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}]),n}(Pte),Tre=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getBoardValue",value:function(e){var t=Sre.getGameStatus(e);if(t.isEndGame)return Ste.fromWinner(t.winner);var r,i=e.gameState,a=this.getPiecesMap(i),o=this.getThreatMap(i,a),s=this.filterThreatMap(o,i),u=0,c=dy(e9.PLAYERS);try{for(c.s();!(r=c.n()).done;){var l,f=r.value,h=dy(a.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;s.get(d).isPresent()?u+=f.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:u+=f.getScoreModifier()*n.SCORE_BY_SAFE_PIECE}}catch(v){h.e(v)}finally{h.f()}}}catch(v){c.e(v)}finally{c.f()}return u+=i.tiles[1]-i.tiles[0],new Ste(u)}},{key:"getPiecesMap",value:function(e){for(var t=new Lte,n=[],r=[],i=0;i<10;i++)for(var a=0;a<15;a++){var o=new pte(a,i),s=e.getPieceAt(o);s===mte.ZERO?n.push(o):s===mte.ONE&&r.push(o)}return t.set(e9.ZERO,new Xne(n)),t.set(e9.ONE,new Xne(r)),t}},{key:"getThreatMap",value:function(e,t){var n,r=new Lte,i=dy(e9.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=dy(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreat(u,e);c.isPresent()&&r.set(u,c.get())}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreat",value:function(e,t){var n,r=e9.of(t.getPieceAt(e).value).getOpponent(),i=NB.empty(),a=NB.empty(),o=[],s=Ere.getNeighbors(e).filter(function(e){return e.isInRange(15,10)}),u=dy(s);try{for(u.s();!(n=u.n()).done;){var c=n.value,l=t.getPieceAt(c);if(l.is(r))o.push(c),this.tileCouldBeRemovedThisTurn(c,t,r)&&(a=NB.of(c));else if(l===mte.EMPTY){if(i.isPresent())return NB.empty();i=NB.of(c)}}}catch(g){u.e(g)}finally{u.f()}if(i.isPresent()){var f,h=[],d=dy(wre.STEPS);try{var v=function(){var e=f.value,n=i.get().getNext(e.direction,1);n.isInRange(15,10)&&t.getPieceAt(n).is(r)&&!1===o.some(function(e){return e.equals(n)})&&h.push(n)};for(d.s();!(f=d.n()).done;)v()}catch(g){d.e(g)}finally{d.f()}if(h.length>0)return NB.of(new Kne(new Xne(o),new Xne(h)))}if(a.isPresent()){o=o.filter(function(e){return e.equals(a.get())});var p=new Xne(o);return NB.of(new Kne(p,new Xne([a.get()])))}return NB.empty()}},{key:"tileCouldBeRemovedThisTurn",value:function(e,t,n){var r=n.getOpponent();if(!1===t.isDeconnectable(e))return!1;for(var i=NB.empty(),a=Pre.getTilesUpperLeftCoord(e),o=0;o<2;o++)for(var s=0;s<3;s++){var u=a.getNext(new ute(s,o),1);if(t.getPieceAt(u).is(n)){if(!this.pieceCouldLeaveTheTile(u,t))return!1;i=NB.of(u)}else if(t.getPieceAt(u).is(r))return!1}return i.isPresent()}},{key:"pieceCouldLeaveTheTile",value:function(e,t){var n,r=Pre.getTilesUpperLeftCoord(e),i=dy(wre.STEPS);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=e.getNext(a.direction,1),s=Pre.getTilesUpperLeftCoord(o);if(!1===r.equals(s)&&t.getPieceAt(o)===mte.EMPTY)return!0}}catch(u){i.e(u)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new Lte,i=e.listKeys(),a=i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentPlayer())}),o=new Xne(i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentOpponent())})),s=dy(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=NB.empty(),h=dy(l.directThreats);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d)){var v,p=[],g=dy(l.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&(f=NB.of(new Kne(l.directThreats,new Xne(p))))}}}catch(_){h.e(_)}finally{h.f()}f.isPresent()&&r.set(c,f.get())}}catch(_){s.e(_)}finally{s.f()}var m,k=dy(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}(Ore);return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e}(),Ire=mte.EMPTY,Are=mte.UNREACHABLE,Mre=mte.ZERO,xre=mte.ONE,Rre=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(Nt||(Nt=Wg(["Board and goal of the game"]))),$localize(Dt||(Dt=Wg(["Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.\n         The triangles are the spaces on which pieces move during the game.\n         The tiles can be removed from the board (you will see how later).\n         The dark pieces belong to the first player and can only move on the dark spaces,\n         while the light pieces belong to the second player and can only move on the light spaces.\n         The goal of the game is to capture all of the opponent's pieces."]))),Pre.getInitialState()),Zte.anyMove($localize(Lt||(Lt=Wg(["Move"]))),$localize(Ft||(Ft=Wg(["To move a piece, you need to:\n        <ol>\n          <li>Click on one of your pieces.</li>\n          <li>Click on one of the triangular space highlighted in yellow.</li>\n        </ol>\n        You can pass through the opponent's pieces.\n        You're playing first, hence you're playing Dark.<br/><br/>\n        Perform any move."]))),Pre.getInitialState(),_re.fromCoordToCoord(new pte(3,5),new pte(5,5)),$localize(Ut||(Ut=Wg(["Congratulations! Let's see captures now."])))),Zte.fromMove($localize(Vt||(Vt=Wg(["Capture"]))),$localize(Bt||(Bt=Wg(["Every piece has three neighboring triangular spaces (2 on the sides).\n        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!\n        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>\n        You're playing Light, make a capture."]))),new Pre([[Are,Are,Are,Are,Are,Are,Mre,Ire,Mre,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Mre,Ire,Ire,Ire,Ire,Ire,Mre,Ire,Ire,Are,Are,Are],[Ire,xre,Ire,xre,Mre,xre,Ire,Ire,Mre,Ire,Ire,xre,Ire,xre,Ire],[xre,Ire,Ire,Ire,Ire,Ire,Ire,Ire,Ire,Ire,xre,Ire,Ire,Ire,xre],[Ire,xre,Ire,xre,Ire,Ire,Ire,Ire,Ire,Ire,Ire,xre,Ire,xre,Ire],[Ire,Mre,Ire,Mre,Ire,Ire,Ire,Ire,Ire,Ire,Ire,Mre,Ire,Mre,Ire],[Mre,Ire,Ire,Ire,Mre,Ire,Ire,Ire,Ire,Ire,Mre,Ire,Ire,Ire,Mre],[Ire,Mre,Ire,Mre,Ire,Ire,xre,Ire,xre,Ire,Ire,Mre,Ire,Mre,Ire],[Are,Are,Are,Ire,Ire,xre,Ire,Ire,Ire,xre,Ire,Ire,Are,Are,Are],[Are,Are,Are,Are,Are,Are,xre,Ire,xre,Are,Are,Are,Are,Are,Are]],3,[0,0],[0,0]),[_re.fromCoordToCoord(new pte(5,2),new pte(4,1)),_re.fromCoordToCoord(new pte(3,4),new pte(4,3))],$localize(zt||(zt=Wg(["Congratulations!"]))),$localize(Ht||(Ht=Wg(["Failed, you have not captured any piece."])))),Zte.fromMove($localize(Gt||(Gt=Wg(["Gain a tile"]))),$localize($t||($t=Wg(["When a tile is empty, it can become removable from the board.\n        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.\n        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.\n        For example, here, the topmost dark piece will not disconnect its tile when leaving it.\n        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>\n        Perform a move that lets you gain two tiles."]))),new Pre([[Are,Are,Are,Are,Are,Are,Ire,Ire,Ire,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Are,Are,Are,xre,Ire,Ire,Are,Are,Are,Are,Are,Are],[Ire,Ire,Ire,Are,Are,Are,Ire,Ire,Ire,Are,Are,Are,Are,Are,Are],[Ire,Ire,xre,Ire,Ire,Ire,Ire,Mre,Ire,Are,Are,Are,Are,Are,Are],[Ire,Ire,Ire,xre,Ire,Ire,Ire,Ire,Ire,Are,Are,Are,Are,Are,Are],[Ire,Ire,Ire,Ire,Ire,Ire,Ire,Ire,Ire,Ire,Ire,Mre,Are,Are,Are],[Ire,Ire,Mre,Ire,Ire,xre,Ire,Ire,Ire,Ire,Mre,Ire,Ire,Ire,Mre],[Ire,Ire,Ire,Ire,Ire,Ire,xre,Ire,xre,Ire,Ire,Mre,Ire,Mre,Ire],[Are,Are,Are,Ire,Ire,xre,Ire,Ire,Ire,xre,Ire,Ire,Are,Are,Are],[Are,Are,Are,Are,Are,Are,xre,Ire,xre,Are,Are,Are,Are,Are,Are]],2,[0,0],[0,0]),[_re.fromCoordToCoord(new pte(2,6),new pte(4,6)),_re.fromCoordToCoord(new pte(2,6),new pte(3,5)),_re.fromCoordToCoord(new pte(2,6),new pte(3,7))],$localize(Zt||(Zt=Wg(["Congratulations!"]))),$localize(qt||(qt=Wg(["Failed, you have not gained the two tiles that you could, try again!"])))),Zte.fromMove($localize(Wt||(Wt=Wg(["Exchanging a tile"]))),$localize(jt||(jt=Wg(["When you have a tile, you can see it on the left of the board.\n        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.\n        This will cost you two tiles.\n        If any tiles are removed during that turn, nobody will get them.<br/><br/>\n        Gain some time and capture the last piece!"]))),new Pre([[Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Ire,Ire,Mre,Are,Are,Are,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Ire,Ire,Ire,Ire,Ire,Ire,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Ire,Ire,Ire,xre,Ire,xre,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Ire,Ire,xre,Ire,Ire,Ire,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Are,Are,Are,xre,Ire,xre,Are,Are,Are,Are,Are,Are]],1,[0,2],[0,0]),[_re.fromTilesExchange(new pte(5,5))],$localize(Yt||(Yt=Wg(["Congratulations!"]))),$localize(Kt||(Kt=Wg(["It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!"])))),Zte.fromMove($localize(Qt||(Qt=Wg(["Special capture"]))),$localize(Xt||(Xt=Wg(["When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!\n        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>\n        A move that demonstrate both of these things can be done on this board by Light. Try it!"]))),new Pre([[Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Are,Are,Are,Ire,Ire,Mre,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Ire,Ire,Mre,Ire,Ire,Ire,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Ire,Mre,xre,Ire,xre,Ire,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Ire,xre,Mre,Ire,Ire,Ire,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Ire,Ire,xre,Are,Are,Are,Are,Are,Are,Are,Are,Are],[Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are,Are]],1,[0,0],[0,0]),[_re.fromCoordToCoord(new pte(7,6),new pte(6,5)),_re.fromCoordToCoord(new pte(7,6),new pte(8,5))],$localize(Jt||(Jt=Wg(["Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.\n        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space."]))),$localize(en||(en=Wg(["Failed!"]))))]});function Nre(e,t){if(1&e&&(NC(),OP(0,"polygon",13)),2&e){var n=LP().index,r=LP().index,i=LP();EP("ngClass",i.getPyramidClass(n,r)),pP("points",i.getPyramidCoordinate(n,r))}}function Dre(e,t){if(1&e&&(NC(),OP(0,"polygon",15)),2&e){var n=LP(2).index,r=LP().index,i=LP();EP("ngClass",i.getEmptyClass(n,r)),pP("points",i.getTriangleCoordinate(n,r))}}function Lre(e,t){if(1&e&&(NC(),CP(0,Dre,1,2,"polygon",14)),2&e){var n=LP().index,r=LP().index;EP("ngIf",LP().isEmptySpace(n,r))}}function Fre(e,t){if(1&e&&(NC(),OP(0,"polygon",16)),2&e){var n=LP().index,r=LP().index,i=LP();VP("id","dark_line_",n,"_",r,""),pP("points",i.getLineCoordinate(n,r))}}function Ure(e,t){if(1&e&&(NC(),OP(0,"polygon",17)),2&e){var n=LP().index,r=LP().index,i=LP();VP("id","dark_line_",n,"_",r,""),pP("points",i.getLineCoordinate(n,r))}}function Vre(e,t){if(1&e){var n=AP();NC(),PP(0,"g",8),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),CP(1,Nre,1,2,"polygon",9),CP(2,Lre,1,1,"ng-template",null,10,tI),CP(4,Fre,1,3,"polygon",11),CP(5,Ure,1,3,"polygon",12),SP()}if(2&e){var r=t.$implicit,i=t.index,a=wP(3),o=LP().index,s=LP();VP("id","click_",i,"_",o,""),BE(1),EP("ngIf",s.isPyramid(i,o))("ngIfElse",a),BE(3),EP("ngIf",r!==s.NONE),BE(1),EP("ngIf",r!==s.NONE)}}function Bre(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Vre,6,6,"g",7),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function zre(e,t){if(1&e&&(NC(),OP(0,"polygon",18)),2&e){var n=t.$implicit;pP("points",LP().getTriangleCoordinate(n.x,n.y))}}function Hre(e,t){if(1&e&&(NC(),OP(0,"polygon",19)),2&e){var n=LP();pP("points",n.getTriangleCoordinate(n.lastStart.get().x,n.lastStart.get().y))}}function Gre(e,t){if(1&e&&(NC(),OP(0,"polygon",19)),2&e){var n=LP();pP("points",n.getTriangleCoordinate(n.lastEnd.get().x,n.lastEnd.get().y))}}function $re(e,t){if(1&e&&(NC(),OP(0,"polygon",20)),2&e){var n=LP();VP("id","selected_",n.chosenCoord.get().x,"_",n.chosenCoord.get().y,""),pP("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function Zre(e,t){if(1&e&&(NC(),PP(0,"g",21),OP(1,"polygon",22),PP(2,"text",23),uS(3),SP(),SP()),2&e){var n=LP();BE(1),pP("points",n.getTilesCountCoordinate(0,0))("stroke",n.lastTurnWasTilesExchange(0)?"yellow":"black"),BE(1),pP("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+0*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),BE(1),cS(n.tiles[0])}}function qre(e,t){if(1&e&&(NC(),PP(0,"g",24),OP(1,"polygon",25),PP(2,"text",26),uS(3),SP(),SP()),2&e){var n=LP();BE(1),pP("points",n.getTilesCountCoordinate(0,9))("stroke",n.lastTurnWasTilesExchange(1)?"yellow":"black"),BE(1),pP("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+9*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),BE(1),cS(n.tiles[1])}}var Wre=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).tiles=[0,0],r.NONE=mte.UNREACHABLE,r.chosenCoord=NB.empty(),r.lastStart=NB.empty(),r.lastEnd=NB.empty(),r.possibleLandings=[],r.scores=NB.of([0,0]),r.rules=new Sre(Pre),r.availableMinimaxes=[new Ore(r.rules,"Normal"),new Tre(r.rules,"Piece > Threat > Tiles")],r.encoder=_re.encoder,r.tutorial=(new Rre).tutorial,r.SPACE_SIZE=70,r.updateBoard(),r}return my(n,[{key:"updateBoard",value:function(){this.chosenCoord=NB.empty(),this.state=this.getState(),this.scores=NB.of(this.state.captures),this.tiles=this.state.tiles;var e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=NB.empty(),this.lastEnd=NB.empty()),this.board=this.getState().board}},{key:"showHighlight",value:function(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=NB.empty(),this.possibleLandings=[]}},{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new pte(e,t),o=n.state.getCurrentPlayer(),r.abrupt("return",n.chosenCoord.equalsValue(a)?(n.cancelMoveAttempt(),UB.SUCCESS):n.chosenCoord.isAbsent()||n.state.getPieceAt(a).is(o)?n.firstClick(a):n.secondClick(a));case 5:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.state.getPieceAt(e)).is(t.state.getCurrentOpponent())){n.next=4;break}return i=_re.fromTilesExchange(e),n.abrupt("return",t.chooseMove(i,t.state,t.state.captures));case 4:return n.abrupt("return",r.is(t.state.getCurrentPlayer())?(t.chosenCoord=NB.of(e),t.showHighlight(),UB.SUCCESS):t.cancelMove(Cre.FIRST_CLICK_SHOULD_NOT_BE_NULL()));case 5:case"end":return n.stop()}},n)}))()}},{key:"secondClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.possibleLandings.some(function(t){return t.equals(e)})){n.next=3;break}return r=_re.fromCoordToCoord(t.chosenCoord.get(),e),n.abrupt("return",t.chooseMove(r,t.state,t.state.captures));case 3:return n.abrupt("return",t.cancelMove(Cre.INVALID_DISTANCE()));case 4:case"end":return n.stop()}},n)}))()}},{key:"isPyramid",value:function(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}},{key:"wasOpponent",value:function(e,t){var n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}},{key:"getPyramidClass",value:function(e,t){var n=this.board[t][e];return n===mte.ZERO?this.getPlayerClass(e9.ZERO):n===mte.ONE?this.getPlayerClass(e9.ONE):"captured-fill"}},{key:"isEmptySpace",value:function(e,t){return this.board[t][e]===mte.EMPTY||this.wasRemoved(e,t)}},{key:"wasRemoved",value:function(e,t){var n=this.rules.node.mother;if(this.board[t][e]===mte.UNREACHABLE&&n.isPresent()){var r=n.get().gameState.getPieceAtXY(e,t);return r===mte.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}},{key:"getEmptyClass",value:function(e,t){return this.board[t][e]===mte.EMPTY?(e+t)%2==1?"background":"background2":"captured-alternate-fill"}},{key:"getTilesCountCoordinate",value:function(e,t){var n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}},{key:"getLineCoordinate",value:function(e,t){var n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}},{key:"mustShowTilesOf",value:function(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}},{key:"lastTurnWasTilesExchange",value:function(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}]),n}(kre);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-coerceo"]],features:[nP],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke",4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke",4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptySpace",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","selectable-stroke"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0-fill"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1-fill"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,Bre,2,1,"g",1),CP(2,zre,1,1,"polygon",2),CP(3,Hre,1,1,"polygon",3),CP(4,Gre,1,1,"polygon",3),CP(5,$re,1,3,"polygon",4),CP(6,Zre,4,6,"g",5),CP(7,qre,4,6,"g",6),SP()),2&e&&(pP("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),BE(1),EP("ngForOf",t.board),BE(1),EP("ngForOf",t.possibleLandings),BE(1),EP("ngIf",t.lastStart.isPresent()),BE(1),EP("ngIf",t.lastEnd.isPresent()),BE(1),EP("ngIf",t.chosenCoord.isPresent()),BE(1),EP("ngIf",t.mustShowTilesOf(0)),BE(1),EP("ngIf",t.mustShowTilesOf(1)))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),jre=function(){var e=my(function e(){gy(this,e)});return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=function(){return $localize(tn||(tn=Wg(["Your piece should land on a neighboring square."])))},e.CANNOT_DROP_AFTER_TURN_40=function(){return $localize(nn||(nn=Wg(["You cannot drop a piece during the moving phase."])))},e.CANNOT_MOVE_BEFORE_TURN_40=function(){return $localize(rn||(rn=Wg(["You cannot move a piece before both players have dropped all of their pieces."])))},e.MUST_JUMP_OVER_PIECES=function(){return $localize(an||(an=Wg(["A jump must be made over a piece, not over an empty square."])))},e.MUST_DROP_IN_CENTRAL_ZONE=function(){return $localize(on||(on=Wg(["A drop must occur in the central zone of the board."])))},e.INVALID_JUMP=function(){return $localize(sn||(sn=Wg(["A jump must land two squares from its original position, and be done in a straight line in any direction."])))},e.SAME_LOCATION_VISITED_IN_JUMP=function(){return $localize(un||(un=Wg(["You are visiting the same location twice in a move, you are not allowed to do so."])))},e}(),Yre=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"isShelter",value:function(e){return 0===e.x||e.x===n.WIDTH-1?n.SHELTERS_INDICES.some(function(t){return e.y===t}):(0===e.y||e.y===n.HEIGHT-1)&&n.SHELTERS_INDICES.some(function(t){return e.x===t})}},{key:"isCentralZone",value:function(e){return e.x>=n.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=n.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=n.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=n.CENTRAL_ZONE_BOTTOM_RIGHT.y}},{key:"isDropPhase",value:function(){return this.turn<40}},{key:"getSidePieces",value:function(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}],[{key:"getInitialState",value:function(){return new n(i9.createTable(n.WIDTH,n.HEIGHT,J7.NONE),0)}}]),n}(Ate);Yre.WIDTH=17,Yre.HEIGHT=17,Yre.CENTRAL_ZONE_TOP_LEFT=new pte(4,6),Yre.CENTRAL_ZONE_BOTTOM_RIGHT=new pte(12,10),Yre.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],Yre.ALL_SHELTERS=new Tte(Yre.SHELTERS_INDICES.flatMap(function(e){return[new pte(e,0),new pte(e,Yre.HEIGHT-1),new pte(0,e),new pte(Yre.WIDTH-1,e)]})).toList();var Kre=function(e){iy(n,e);var t=oy(n);function n(e){return gy(this,n),t.call(this,e.x,e.y)}return my(n,[{key:"toString",value:function(){return"ConspirateursMoveDrop(".concat(this.coord.toString(),")")}},{key:"equals",value:function(e){return!!e.isDrop()&&this.coord.equals(e.coord)}},{key:"isDrop",value:function(){return!0}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e){return e.isInRange(Yre.WIDTH,Yre.HEIGHT)?DB.success(new n(e)):DB.failure("Move out of board")}}]),n}(Rte);Kre.encoder=function(){function e(){gy(this,e)}return my(e,null,[{key:"getEncoder",value:function(e,t,n){return new(function(r){iy(a,r);var i=oy(a);function a(){var e;return gy(this,a),(e=i.apply(this,arguments)).shiftX=t,e}return my(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftX+e.coord.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new pte((r-=r%1)%e,i);return n(a)}}]),a}(Q7))}}]),e}().getEncoder(Yre.WIDTH,Yre.HEIGHT,function(e){return Kre.of(e).get()});var Qre=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this,e,r)}return my(n,[{key:"toString",value:function(){return"ConspirateursMoveSimple(".concat(this.coord.toString()," -> ").concat(this.end.toString(),")")}},{key:"equals",value:function(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!0}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e,t){return e.isInRange(Yre.WIDTH,Yre.HEIGHT)&&t.isInRange(Yre.WIDTH,Yre.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?DB.success(new n(e,t)):DB.failure(jre.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):DB.failure("Move out of board")}}]),n}(Fne);Qre.encoder=Fne.getEncoder(Yre.WIDTH,Yre.HEIGHT,function(e,t){return Qre.of(e,t).get()});var Xre=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).coords=e,r}return my(n,[{key:"addJump",value:function(e){var t=i9.copyImmutableArray(this.coords);return t.push(e),n.of(t)}},{key:"getStartingCoord",value:function(){return this.coords[0]}},{key:"getEndingCoord",value:function(){return this.coords[this.coords.length-1]}},{key:"getLandingCoords",value:function(){return this.coords.slice(1)}},{key:"getJumpedOverCoords",value:function(){for(var e=[],t=1;t<this.coords.length;t++){var n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}},{key:"toString",value:function(){return"ConspirateursMoveJump(".concat(this.coords.map(function(e){return e.toString()}).reduce(function(e,t){return e+" -> "+t}),")")}},{key:"equals",value:function(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!0}}],[{key:"of",value:function(e){if(e.length<2)return DB.failure("ConspirateursMoveJump requires at least one jump, so two coords");var t,r=dy(e);try{for(r.s();!(t=r.n()).done;){if(t.value.isNotInRange(Yre.WIDTH,Yre.HEIGHT))return DB.failure("Move out of board")}}catch(a){r.e(a)}finally{r.f()}for(var i=1;i<e.length;i++)if(e[i-1].getDirectionToward(e[i]).isFailure()||2!==e[i-1].getDistance(e[i]))return DB.failure(jre.INVALID_JUMP());return new Xne(e).size()===e.length?DB.success(new n(e)):DB.failure(jre.SAME_LOCATION_VISITED_IN_JUMP())}}]),n}(xte);Xre.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).coordEncoder=pte.numberEncoder(Yre.WIDTH,Yre.HEIGHT),e}return my(n,[{key:"encodeMove",value:function(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}},{key:"decodeMove",value:function(e){F7(null!=IB.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");var t=IB.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return Xre.of(t).get()}}]),n}(K7));var Jre=K7.disjunction3(Kre.encoder,Qre.encoder,Xre.encoder,function(e){return e.isDrop()},function(e){return e.isSimple()}),eie=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.call(this,Yre)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=J7.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{var i=e.getStartingCoord(),a=e.getEndingCoord();r[i.y][i.x]=J7.NONE,r[a.y][a.x]=t.getCurrentPlayer()}return new Yre(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}},{key:"dropLegality",value:function(e,t){return t.turn>=40?DB.failure(jre.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?DB.failure(bte.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?DB.failure(jre.MUST_DROP_IN_CENTRAL_ZONE()):DB.success(void 0)}},{key:"simpleMoveLegality",value:function(e,t){return t.turn<40?DB.failure(jre.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?DB.failure(bte.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end).isPlayer()?DB.failure(bte.MUST_LAND_ON_EMPTY_SPACE()):DB.success(void 0)}},{key:"jumpLegality",value:function(e,t){if(t.turn<40)return DB.failure(jre.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return DB.failure(bte.MUST_CHOOSE_PLAYER_PIECE());var n,r=dy(e.getJumpedOverCoords());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.getPieceAt(i)===J7.NONE)return DB.failure(jre.MUST_JUMP_OVER_PIECES())}}catch(u){r.e(u)}finally{r.f()}var a,o=dy(e.getLandingCoords());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t.getPieceAt(s).isPlayer())return DB.failure(bte.MUST_LAND_ON_EMPTY_SPACE())}}catch(u){o.e(u)}finally{o.f()}return DB.success(void 0)}},{key:"jumpTargetsFrom",value:function(e){for(var t=[],n=0,r=[new pte(e.x+2,e.y),new pte(e.x-2,e.y),new pte(e.x,e.y+2),new pte(e.x,e.y-2),new pte(e.x+2,e.y+2),new pte(e.x+2,e.y-2),new pte(e.x-2,e.y+2),new pte(e.x-2,e.y-2)];n<r.length;n++){var i=r[n];Xre.of([e,i]).isSuccess()&&t.push(i)}return t}},{key:"nextJumps",value:function(e,t){var n,r=e.getEndingCoord(),i=[],a=dy(this.jumpTargetsFrom(r));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"jumpHasPossibleNextTargets",value:function(e,t){return this.nextJumps(e,t).length>0}},{key:"getGameStatus",value:function(e){var t,n=e.gameState,r=[0,0],i=dy(Yre.ALL_SHELTERS);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.getPieceAt(a);if(o.isPlayer()&&(r[o.value]+=1,20===r[o.value]))return Bte.getVictory(o)}}catch(s){i.e(s)}finally{i.f()}return Bte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=NB.of(new n)),n.singleton.get()}}]),n}(zte);eie.singleton=NB.empty();var tie=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){return this.sortByNumberOfJump(e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState))}},{key:"sortByNumberOfJump",value:function(e){return e.sort(function(e,t){var n=e.isDrop()?1:e.isSimple()?2:e.coords.length;return(t.isDrop()?1:t.isSimple()?2:t.coords.length)-n})}},{key:"getListMovesDrop",value:function(e){for(var t=[],n=Yre.CENTRAL_ZONE_TOP_LEFT,r=Yre.CENTRAL_ZONE_BOTTOM_RIGHT,i=n.y;i<=r.y;i++)for(var a=n.x;a<=r.x;a++)e.getPieceAtXY(a,i)===J7.NONE&&t.push(Kre.of(new pte(a,i)).get());return t}},{key:"getListMovesAfterDrop",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Yre.HEIGHT;r++)for(var i=0;i<Yre.WIDTH;i++){var a=new pte(i,r);e.getPieceAt(a)===n&&(t=(t=t.concat(this.getListSimpleMoves(e,a))).concat(this.getListJumps(e,a)))}return t}},{key:"getListSimpleMoves",value:function(e,t){for(var n=[],r=0,i=[new pte(t.x+1,t.y),new pte(t.x-1,t.y),new pte(t.x,t.y+1),new pte(t.x,t.y-1),new pte(t.x+1,t.y+1),new pte(t.x+1,t.y-1),new pte(t.x-1,t.y+1),new pte(t.x-1,t.y-1)];r<i.length;r++){var a=i[r],o=Qre.of(t,a);o.isSuccess()&&eie.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}},{key:"getListJumps",value:function(e,t){var n,r=new Tte,i=dy(eie.get().jumpTargetsFrom(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=Xre.of([t,a]).get();eie.get().jumpLegality(o,e).isSuccess()&&(r.add(o),r.union(this.getListJumpStartingFrom(e,o)))}}catch(s){i.e(s)}finally{i.f()}return r.toList()}},{key:"getListJumpStartingFrom",value:function(e,t){var n,r=eie.get().nextJumps(t,e),i=new Tte(r),a=dy(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.union(this.getListJumpStartingFrom(e,o))}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getBoardValue",value:function(e){for(var t=e.gameState,n=0,r=new Lte([{key:e9.ZERO,value:0},{key:e9.ONE,value:0}]),i=0;i<Yre.HEIGHT;i++)for(var a=0;a<Yre.WIDTH;a++){var o=new pte(a,i),s=t.getPieceAt(o);if(s.isPlayer())if(t.isShelter(o)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new Ste(s.getVictoryValue())}else{var u,c=100,l=dy(Yre.ALL_SHELTERS);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(t.getPieceAt(f)===J7.NONE){var h=o.getOrthogonalDistance(f);c=Math.min(c,h)}}}catch(d){l.e(d)}finally{l.f()}n-=s.getScoreModifier()*c}}return new Ste(n)}}]),n}(Pte),nie=J7.NONE,rie=J7.ZERO,iie=J7.ONE,aie=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(cn||(cn=Wg(["Board and aim of the game"]))),$localize(ln||(ln=Wg(["Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially."]))),Yre.getInitialState()),Zte.anyMove($localize(fn||(fn=Wg(["Initial phase"]))),$localize(hn||(hn=Wg(["In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone."]))),Yre.getInitialState(),Kre.of(new pte(7,7)).get(),$localize(dn||(dn=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(vn||(vn=Wg(["Simple move"]))),$localize(pn||(pn=Wg(["Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move."]))),new Yre([[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,rie,rie,iie,iie,rie,rie,iie,rie,iie,nie,nie,nie,nie],[nie,nie,nie,nie,rie,iie,rie,iie,rie,rie,rie,rie,iie,nie,nie,nie,nie],[nie,nie,nie,nie,rie,iie,nie,nie,nie,nie,nie,iie,rie,nie,nie,nie,nie],[nie,nie,nie,nie,iie,rie,rie,iie,iie,iie,rie,rie,rie,nie,nie,nie,nie],[nie,nie,nie,nie,iie,rie,iie,iie,iie,iie,iie,iie,rie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie]],40),Qre.of(new pte(4,6),new pte(3,5)).get(),function(e,t,n){return e.isSimple()?UB.SUCCESS:UB.failure($localize(gn||(gn=Wg(["You have made a jump, not a simple move. Try again!"]))))},$localize(yn||(yn=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(mn||(mn=Wg(["Jumps"]))),$localize(kn||(kn=Wg(["The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful)."]))),new Yre([[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,rie,rie,iie,iie,rie,rie,iie,rie,iie,nie,nie,nie,nie],[nie,nie,nie,nie,rie,iie,rie,iie,rie,rie,rie,rie,iie,nie,nie,nie,nie],[nie,nie,nie,nie,rie,iie,nie,nie,nie,nie,nie,iie,rie,nie,nie,nie,nie],[nie,nie,nie,nie,iie,rie,rie,iie,iie,iie,rie,rie,rie,nie,nie,nie,nie],[nie,nie,nie,nie,iie,rie,iie,iie,iie,iie,iie,iie,rie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie]],40),Xre.of([new pte(6,7),new pte(6,5)]).get(),function(e,t,n){return e.isJump()?UB.SUCCESS:UB.failure($localize(Cn||(Cn=Wg(["You have not performed a jump. Try again!"]))))},$localize(wn||(wn=Wg(["Congratulations!"])))),Zte.fromMove($localize(_n||(_n=Wg(["Chaining jumps in a single move"]))),$localize(En||(En=Wg(["Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it."]))),new Yre([[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,iie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,iie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,iie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,rie,rie,nie,iie,rie,rie,iie,rie,iie,nie,nie,nie,nie],[nie,nie,nie,nie,rie,nie,rie,iie,rie,rie,rie,rie,iie,nie,nie,nie,nie],[nie,nie,nie,nie,rie,iie,nie,nie,nie,nie,nie,iie,rie,nie,nie,nie,nie],[nie,nie,nie,nie,iie,rie,rie,iie,iie,iie,rie,rie,rie,nie,nie,nie,nie],[nie,nie,nie,nie,iie,rie,iie,iie,iie,iie,iie,iie,rie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie],[nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie,nie]],40),[Xre.of([new pte(8,6),new pte(6,4),new pte(6,2),new pte(6,0)]).get()],$localize(bn||(bn=Wg(["Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does."]))),$localize(Pn||(Pn=Wg(["You have not performed a triple jump. Try again!"]))))]});function oie(e,t){if(1&e){var n=AP();NC(),PP(0,"rect",9),RP("click",function(){aC(n);var e=LP().$implicit;return LP(2).onClick(e.coord)}),SP()}if(2&e){var r=LP().$implicit,i=LP(2);pP("x",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.x+i.STROKE_WIDTH)("y",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE-3*i.STROKE_WIDTH)("height",i.SPACE_SIZE-3*i.STROKE_WIDTH)}}function sie(e,t){if(1&e){var n=AP();NC(),PP(0,"circle",6),RP("click",function(){aC(n);var e=LP().$implicit;return LP(2).onClick(e.coord)}),SP()}if(2&e){var r=LP(),i=r.index,a=r.$implicit,o=LP().index,s=LP();VP("id","piece_",i,"_",o,""),EP("ngClass",a.pieceClasses),pP("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function uie(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",6),RP("click",function(){var e=aC(n).$implicit;return LP(2).onClick(e.coord)}),SP(),CP(2,oie,1,4,"rect",7),CP(3,sie,1,6,"circle",8),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP().index,o=LP();BE(1),VP("id","click_",i,"_",a,""),EP("ngClass",r.squareClasses),pP("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),BE(1),EP("ngIf",r.isShelter),BE(1),EP("ngIf",r.hasPiece)}}function cie(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,uie,4,9,"g",1),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function lie(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",10),RP("click",function(){var e=aC(n).$implicit;return LP().onClick(e)}),SP(),SP()}if(2&e){var r=t.$implicit,i=LP();BE(1),EP("ngClass",i.viewInfo.boardInfo[r.y][r.x].shelterClasses),pP("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function fie(e,t){if(1&e&&(NC(),OP(0,"circle",11)),2&e){var n=t.$implicit,r=LP();UP("id","sidePiece_0_",n,""),pP("cx",-r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function hie(e,t){if(1&e&&(NC(),OP(0,"circle",12)),2&e){var n=t.$implicit,r=LP();UP("id","sidePiece_1_",n,""),pP("cx",1715+r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function die(e,t){if(1&e&&(NC(),OP(0,"rect",13)),2&e){var n=LP();pP("x",n.SPACE_SIZE*n.CENTRAL_ZONE_START.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.CENTRAL_ZONE_START.y+n.STROKE_WIDTH)("width",n.CENTRAL_ZONE_SIZE.x*n.SPACE_SIZE)("height",n.CENTRAL_ZONE_SIZE.y*n.SPACE_SIZE)}}var vie=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).ALL_SHELTERS=Yre.ALL_SHELTERS,r.CENTRAL_ZONE_START=Yre.CENTRAL_ZONE_TOP_LEFT,r.CENTRAL_ZONE_SIZE=new ute(Yre.CENTRAL_ZONE_BOTTOM_RIGHT.x-Yre.CENTRAL_ZONE_TOP_LEFT.x+1,Yre.CENTRAL_ZONE_BOTTOM_RIGHT.y-Yre.CENTRAL_ZONE_TOP_LEFT.y+1),r.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},r.selected=NB.empty(),r.jumpInConstruction=NB.empty(),r.PIECE_RADIUS=r.SPACE_SIZE/2-r.STROKE_WIDTH,r.rules=eie.get(),r.availableMinimaxes=[new tie(r.rules,"ConspirateursMinimax")],r.encoder=Jre,r.tutorial=(new aie).tutorial,r}return my(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"updateViewInfo",value:function(){var e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(var t=0;t<Yre.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(var n=0;n<Yre.WIDTH;n++){var r=new pte(n,t),i=e.getPieceAt(r),a={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(a)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}},{key:"updateOccupiedShelters",value:function(){var e,t=dy(Yre.ALL_SHELTERS);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.viewInfo.boardInfo[n.y][n.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("selectable-stroke")}}catch(i){t.e(i)}finally{t.f()}}},{key:"updateSelected",value:function(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){var e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;var r,i=dy(e.coords);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.boardInfo[a.y][a.x].squareClasses.push("moved-fill")}}catch(s){i.e(s)}finally{i.f()}}else{var o=this.selected.get();this.viewInfo.boardInfo[o.y][o.x].pieceClasses.push("selected-stroke")}}},{key:"updateVictory",value:function(){var e=this.getState(),t=eie.get().getGameStatus(this.rules.node);if(!0===t.isEndGame){var n,r=dy(Yre.ALL_SHELTERS);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.getPieceAt(i)===t.winner&&this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("victory-fill")}}catch(a){r.e(a)}finally{r.f()}}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";var t,n=dy(e.coords);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}catch(i){n.e(i)}finally{n.f()}}}},{key:"cancelMoveAttempt",value:function(){this.jumpInConstruction=NB.empty(),this.selected=NB.empty(),this.updateBoard()}},{key:"onClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if((i=t.getState()).getPieceAt(e)!==t.getCurrentPlayer()){n.next=6;break}return n.abrupt("return",(t.selected.equalsValue(e)?t.cancelMoveAttempt():(t.selected=NB.of(e),t.jumpInConstruction=NB.empty()),t.updateViewInfo(),UB.SUCCESS));case 6:if(!t.jumpInConstruction.isPresent()){n.next=8;break}return n.abrupt("return",t.constructJump(e));case 8:if(!t.selected.isPresent()){n.next=10;break}return n.abrupt("return",t.selectNextCoord(e));case 10:if(!i.isDropPhase()){n.next=13;break}return a=Kre.of(e),n.abrupt("return",(F7(a.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(a.get(),i)));case 13:return n.abrupt("return",t.cancelMove(bte.MUST_CHOOSE_PLAYER_PIECE()));case 14:case"end":return n.stop()}},n)}))()}},{key:"constructJump",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.jumpInConstruction.get(),i=t.getState(),!e.equals(r.getEndingCoord())){n.next=3;break}return n.abrupt("return",t.chooseMove(r,i));case 3:if(!(a=r.addJump(e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(a.getReason()));case 6:return o=t.rules.jumpLegality(a.get(),i),n.abrupt("return",o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(a.get()));case 8:case"end":return n.stop()}},n)}))()}},{key:"updateJump",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),n.abrupt("return",t.rules.jumpHasPossibleNextTargets(e,r)?(t.jumpInConstruction=NB.of(e),t.updateViewInfo(),UB.SUCCESS):t.chooseMove(e,r));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectNextCoord",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.selected.get(),!(i=Qre.of(r,e)).isSuccess()){n.next=3;break}return n.abrupt("return",t.chooseMove(i.get(),t.getState()));case 3:return a=Xre.of([r,e]),n.abrupt("return",a.isFailure()?t.cancelMove(a.getReason()):t.updateJump(a.get()));case 5:case"end":return n.stop()}},n)}))()}}]),n}(gte);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-conspirateurs"]],features:[nP],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,cie,2,1,"g",1),CP(2,lie,2,5,"g",1),CP(3,fie,1,4,"circle",2),CP(4,hie,1,4,"circle",3),CP(5,die,1,4,"rect",4),OP(6,"polyline",5),SP()),2&e&&(BE(1),EP("ngForOf",t.viewInfo.boardInfo),BE(1),EP("ngForOf",t.ALL_SHELTERS),BE(1),EP("ngForOf",t.range(t.viewInfo.sidePieces[0])),BE(1),EP("ngForOf",t.range(t.viewInfo.sidePieces[1])),BE(1),EP("ngIf",t.viewInfo.dropPhase),BE(1),pP("points",t.viewInfo.lastMoveArrow))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),pie=function(){function e(t,n){gy(this,e),this.owner=t,this.otherPieceType=n}return my(e,[{key:"toString",value:function(){return"DiamPiece(".concat(this.owner,", ").concat(this.otherPieceType,")")}}],[{key:"of",value:function(t,n){return t===e9.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===e9.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}}]),e}();pie.encoder=Q7.tuple([e9.numberEncoder,Q7.booleanEncoder],function(e){return[e.owner,e.otherPieceType]},function(e){return pie.of(e[0],e[1])}),pie.EMPTY=new pie(J7.NONE,!1),pie.ZERO_FIRST=new pie(e9.ZERO,!1),pie.ZERO_SECOND=new pie(e9.ZERO,!0),pie.ONE_FIRST=new pie(e9.ONE,!1),pie.ONE_SECOND=new pie(e9.ONE,!0),pie.PLAYER_PIECES=[pie.ZERO_FIRST,pie.ZERO_SECOND,pie.ONE_FIRST,pie.ONE_SECOND];var gie=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;if(gy(this,n),(i=t.call(this)).target=e,i.piece=r,r===pie.EMPTY)throw new Error("Cannot drop an empty piece");return sy(i)}return my(n,[{key:"isDrop",value:function(){return!0}},{key:"getTarget",value:function(){return this.target}},{key:"equals",value:function(e){return!(this.target!==e.target||this.piece!==e.piece)}},{key:"toString",value:function(){return"DiamMoveDrop(".concat(this.target,", ").concat(this.piece,")")}}]),n}(xte);gie.encoder=Q7.tuple([Q7.numberEncoder(7),pie.encoder],function(e){return[e.target,e.piece]},function(e){return new gie(e[0],e[1])});var yie=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this)).start=e,i.moveDirection=r,i}return my(n,[{key:"isDrop",value:function(){return!1}},{key:"getTarget",value:function(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}},{key:"equals",value:function(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}},{key:"toString",value:function(){return"DiamMoveShift(".concat(this.start,", ").concat(this.moveDirection,")")}}],[{key:"fromRepresentation",value:function(e,t){return new n(new pte(e.x,3-e.y),t)}}]),n}(xte);yie.encoder=Q7.tuple([pte.numberEncoder(8,4),Q7.booleanEncoder],function(e){return[e.start,"clockwise"===e.moveDirection]},function(e){return new yie(e[0],e[1]?"clockwise":"counterclockwise")});var mie=Q7.disjunction(gie.encoder,yie.encoder,function(e){return e.isDrop()}),kie=function(){var e=my(function e(){gy(this,e)});return e.NO_MORE_PIECES_OF_THIS_TYPE=function(){return $localize(Sn||(Sn=Wg(["You do not have any pieces of this type anymore."])))},e.SPACE_IS_FULL=function(){return $localize(On||(On=Wg(["You cannot play here: this space is already full."])))},e.TARGET_STACK_TOO_HIGH=function(){return $localize(Tn||(Tn=Wg(["You cannot add more pieces to the target stack, as it will contain more than 4 pieces."])))},e.MUST_SHIFT_TO_NEIGHBOR=function(){return $localize(In||(In=Wg(["To perform a shift, you must move the pieces to a neighboring space."])))},e.MUST_SELECT_PIECE_FIRST=function(){return $localize(An||(An=Wg(["You must first select either a piece from the side, or a stack of pieces to shift on the board."])))},e}(),Cie=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,i)).remainingPieces=r,a}return my(n,[{key:"getRemainingPiecesOf",value:function(e){return this.remainingPieces[n.pieceIndex(e)]}},{key:"getStackHeight",value:function(e){for(var t=0,r=0;r<n.HEIGHT&&this.getPieceAtXY(e,r)!==pie.EMPTY;r++)t++;return t}}],[{key:"getInitialState",value:function(){var e=pie.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}},{key:"fromRepresentation",value:function(e,t){for(var r=e.reverse(),i=[4,4,4,4],a=0;a<n.HEIGHT;a++)for(var o=0;o<n.WIDTH;o++){var s=r[a][o];r[a][o]!==pie.EMPTY&&i[n.pieceIndex(s)]--}return F7(i.every(function(e){return e>=0}),"Invalid DiamState representation uses too many pieces"),new n(r,i,t)}},{key:"pieceIndex",value:function(e){switch(e){case pie.ZERO_FIRST:return 0;case pie.ZERO_SECOND:return 1;case pie.ONE_FIRST:return 2;default:return IB.expectToBe(e,pie.ONE_SECOND),3}}}]),n}(Ate);return e.WIDTH=8,e.HEIGHT=4,e}(),wie=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.call(this,Cie)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=i9.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;var r=i9.copyImmutableArray(t.remainingPieces);return r[Cie.pieceIndex(e.piece)]-=1,new Cie(n,r,t.turn+1)}},{key:"applyLegalShift",value:function(e,t){for(var n=i9.copyBiArray(t.board),r=e.getTarget(),i=t.getStackHeight(r),a=e.start.y;a<Cie.HEIGHT&&t.getPieceAtXY(e.start.x,a)!==pie.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,a),n[a][e.start.x]=pie.EMPTY,i++,a++;return new Cie(n,t.remainingPieces,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}},{key:"isDropLegal",value:function(e,t){return e.piece.owner!==t.getCurrentPlayer()?DB.failure(bte.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?DB.failure(kie.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}},{key:"dropHeightValidity",value:function(e,t){return t.getStackHeight(e.target)===Cie.HEIGHT?DB.failure(kie.SPACE_IS_FULL()):DB.success(void 0)}},{key:"isShiftLegal",value:function(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?DB.failure(bte.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}},{key:"shiftHeightValidity",value:function(e,t){var n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>Cie.HEIGHT?DB.failure(kie.TARGET_STACK_TOO_HIGH()):DB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=this.findHighestAlignment(e.gameState);if(t.isPresent()){var n=e.gameState.getPieceAt(t.get());return F7(n.owner.isPlayer(),"highest alignment is owned by a player"),Bte.getVictory(n.owner)}return Bte.ONGOING}},{key:"findHighestAlignment",value:function(e){for(var t=0;t<Cie.WIDTH/2;t++)for(var n=Cie.HEIGHT-1;n>0;n--){var r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+Cie.WIDTH/2,n);if(r!==pie.EMPTY&&r===i)return NB.of(new pte(t,n))}return NB.empty()}},{key:"pieceCanMove",value:function(e,t){return!!this.isShiftLegal(new yie(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new yie(t,"counterclockwise"),e).isSuccess()}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=NB.of(new n)),n.singleton.get()}}]),n}(zte);wie.singleton=NB.empty();var _ie=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}},{key:"getListShifts",value:function(e){var t,n=[],r=dy(this.getShiftSources(e));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0,o=[new yie(i,"clockwise"),new yie(i,"counterclockwise")];a<o.length;a++){var s=o[a];wie.get().shiftHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"getListDrops",value:function(e){for(var t=this.getRemainingPiecesForCurrentPlayer(e),n=[],r=0;r<Cie.WIDTH;r++){var i,a=dy(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=new gie(r,o);wie.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){a.e(u)}finally{a.f()}}return n}},{key:"getRemainingPiecesForCurrentPlayer",value:function(e){var t,n=[],r=dy(pie.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.currentPlayerCanDropPiece(e,i)&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"currentPlayerCanDropPiece",value:function(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}},{key:"getShiftSources",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Cie.HEIGHT;r++)for(var i=0;i<Cie.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new pte(i,r));return t}},{key:"getBoardValue",value:function(e){var t=wie.get().getGameStatus(e);return new Ste(t.isEndGame?t.toBoardValue():0)}}]),n}(Pte),Eie=pie.EMPTY,bie=pie.ZERO_FIRST,Pie=pie.ZERO_SECOND,Sie=pie.ONE_FIRST,Oie=pie.ONE_SECOND,Tie=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(Mn||(Mn=Wg(["Initial board and player pieces"]))),$localize(xn||(xn=Wg(["Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right."]))),Cie.getInitialState()),Zte.fromMove($localize(Rn||(Rn=Wg(["Goal of the game"]))),$localize(Nn||(Nn=Wg(["At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!"]))),Cie.fromRepresentation([[Eie,Eie,Eie,Eie,Eie,Eie,Eie,Eie],[Eie,Eie,Eie,Eie,Eie,Eie,Eie,Eie],[Eie,Eie,Eie,Eie,Sie,Eie,Eie,Eie],[bie,Eie,Eie,Eie,bie,Eie,Eie,Eie]],3),[new gie(0,pie.ONE_FIRST)],$localize(Dn||(Dn=Wg(["Congratulations, you won!"]))),$localize(Ln||(Ln=Wg(["Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board."])))),Zte.fromMove($localize(Fn||(Fn=Wg(["Types of move"]))),$localize(Un||(Un=Wg(["You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board."]))),Cie.fromRepresentation([[Eie,Eie,Eie,Eie,Eie,Eie,Eie,Eie],[Eie,Eie,Eie,Eie,Oie,Eie,Eie,Eie],[Eie,Eie,Eie,Eie,bie,Eie,Eie,Eie],[Sie,Eie,Eie,Eie,Pie,Eie,Eie,Eie]],4),[yie.fromRepresentation(new pte(4,3),"counterclockwise"),yie.fromRepresentation(new pte(4,3),"clockwise"),yie.fromRepresentation(new pte(4,2),"counterclockwise"),yie.fromRepresentation(new pte(4,2),"clockwise")],$localize(Vn||(Vn=Wg(["Congratulations!"]))),$localize(Bn||(Bn=Wg(["Failed, try to move one of your piece that is already on the board."])))),Zte.fromMove($localize(zn||(zn=Wg(["Special case"]))),$localize(Hn||(Hn=Wg(["It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!"]))),Cie.fromRepresentation([[Eie,Eie,Eie,Eie,bie,Eie,Eie,Eie],[Eie,Eie,Eie,Eie,Oie,Eie,Eie,bie],[Eie,Eie,Eie,Eie,bie,Eie,Eie,Oie],[Eie,Sie,Eie,Eie,Pie,Eie,Eie,Sie]],8),[yie.fromRepresentation(new pte(4,2),"counterclockwise")],$localize(Gn||(Gn=Wg(["Congratulations!"]))),$localize($n||($n=Wg(["Failed, try to shift a stack of pieces to the left."]))))]});function Iie(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"path",5),RP("click",function(){var e=aC(n).$implicit;return LP().onSpaceClick(e)}),SP(),PP(2,"path",6),RP("click",function(){var e=aC(n).$implicit;return LP().onSpaceClick(e)}),SP(),SP()}if(2&e){var r=t.$implicit,i=LP();BE(1),UP("id","click_",r,""),EP("ngClass",i.viewInfo.boardInfo[r].spaceClasses),pP("d",i.BOARD_PATHS[r]),BE(1),EP("ngClass",i.viewInfo.boardInfo[r].spaceClasses),pP("d",i.DECORATION_PATHS[r])}}function Aie(e,t){if(1&e){var n=AP();NC(),PP(0,"g",8),RP("click",function(){var e=aC(n).$implicit,t=LP().$implicit;return LP().onPieceInGameClick(t,e.y)}),OP(1,"use",9),OP(2,"use",10),SP()}if(2&e){var r=t.$implicit;VP("id","click_",LP().$implicit,"_",r.y,""),EP("ngClass",r.foregroundClasses),BE(1),EP("ngClass",r.backgroundClasses),pP("x",r.drawPosition.x)("y",r.drawPosition.y),BE(1),pP("x",r.drawPosition.x)("y",r.drawPosition.y)}}function Mie(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Aie,3,8,"g",7),SP()),2&e){var n=t.$implicit,r=LP();BE(1),EP("ngForOf",r.viewInfo.boardInfo[n].pieces)}}function xie(e,t){if(1&e){var n=AP();NC(),PP(0,"g",12),RP("click",function(){var e=aC(n),t=e.$implicit,r=e.index;return LP(2).onRemainingPieceClick(t.actualPiece,r)}),OP(1,"use",9),OP(2,"use",10),SP()}if(2&e){var r=t.$implicit,i=t.index;BP("id","piece_",r.actualPiece.owner.toString(),"_",r.actualPiece.otherPieceType?1:0,"_",i,""),EP("ngClass",r.foregroundClasses),BE(1),EP("ngClass",r.backgroundClasses),pP("x",r.drawPosition.x)("y",r.drawPosition.y),BE(1),pP("x",r.drawPosition.x)("y",r.drawPosition.y)}}function Rie(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,xie,3,9,"g",11),SP()),2&e){var n=t.$implicit,r=LP();BE(1),EP("ngForOf",r.viewInfo.remainingPieces.get(n).get())}}var Nie=function(){return[0,1,2,3,4,5,6,7]},Die=function(){return[2,1,3,0,4,7,5,6]},Lie=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],r.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],r.selected=NB.empty(),r.viewInfo={boardInfo:[],remainingPieces:new Lte([{key:e9.ZERO,value:[]},{key:e9.ONE,value:[]}])},r.rules=wie.get(),r.availableMinimaxes=[new _ie(r.rules,"DiamDummyMinimax")],r.encoder=mie,r.tutorial=(new Tie).tutorial,r}return my(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"onSpaceClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#click_"+e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClickAfterCheck",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selected.isPresent()){n.next=14;break}if("pieceFromReserve"!==(r=t.selected.get()).type){n.next=6;break}i=new gie(e,r.piece),n.next=13;break;case 6:if((r.position.x+1)%Cie.WIDTH!==e){n.next=10;break}i=new yie(r.position,"clockwise"),n.next=13;break;case 10:if((r.position.x+(Cie.WIDTH-1))%Cie.WIDTH===e){n.next=12;break}return n.abrupt("return",t.cancelMove(kie.MUST_SHIFT_TO_NEIGHBOR()));case 12:i=new yie(r.position,"counterclockwise");case 13:return n.abrupt("return",t.chooseMove(i,t.getState()));case 14:return n.abrupt("return",t.cancelMove(kie.MUST_SELECT_PIECE_FIRST()));case 15:case"end":return n.stop()}},n)}))()}},{key:"onPieceInGameClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new pte(e,t),r.abrupt("return",n.getState().getPieceAt(a).owner===n.getCurrentPlayer()?(n.isSelected(null,a)?n.cancelMoveAttempt():n.selected=NB.of({type:"pieceFromBoard",position:a}),n.updateViewInfo(),UB.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(bte.MUST_CHOOSE_PLAYER_PIECE()));case 5:case"end":return r.stop()}},r)}))()}},{key:"onRemainingPieceClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay(n.getPieceId(e,t)),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):e.owner===n.getCurrentPlayer()?(n.selected=n.isSelected(e)?NB.empty():NB.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),UB.SUCCESS):n.cancelMove(bte.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceId",value:function(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}},{key:"isSelected",value:function(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"getLastMovedFromDrop",value:function(e,t){var n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),a=this.getDrawPositionOnBoard(r,i),o=new pte(r,i);return[{start:NB.empty(),end:o,startDrawPosition:n,endDrawPosition:a}]}},{key:"getLastMovedFromShift",value:function(e,t){for(var n=e.start.x,r=e.getTarget(),i=t.getStackHeight(r),a=[],o=e.start.y;o<Cie.HEIGHT&&t.getPieceAtXY(n,o)!==pie.EMPTY;o++,i++)a.push({start:NB.of(new pte(n,o)),end:new pte(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return a}},{key:"updateViewInfo",value:function(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}},{key:"updateBoardInfo",value:function(){for(var e=0;e<Cie.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}},{key:"showLastMove",value:function(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}},{key:"showLastMoveOnSpaces",value:function(){var e=this.rules.node.move;F7(e.isPresent(),"showLastMoveOnSpaces called without a last move");for(var t=e.get(),n=0;n<Cie.WIDTH;n++){var r=[];t.isDrop()?t.getTarget()===n&&r.push("moved-fill"):(t.getTarget()===n||t.start.x===n)&&r.push("moved-fill"),this.viewInfo.boardInfo[n].spaceClasses=r}}},{key:"showLastMoveOnPieces",value:function(){var e=this.rules.node.move;F7(e.isPresent(),"showLastMoveOnPieces called without a last move");var t,n=e.get(),r=this.getPreviousState(),i=dy(n.isDrop()?this.getLastMovedFromDrop(n,r):this.getLastMovedFromShift(n,r));try{for(i.s();!(t=i.n()).done;){var a=t.value;this.viewInfo.boardInfo[a.end.x].pieces[a.end.y].foregroundClasses.push("last-move-stroke")}}catch(o){i.e(o)}finally{i.f()}}},{key:"updateRemainingPiecesInfo",value:function(){var e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new Lte([{key:e9.ZERO,value:[]},{key:e9.ONE,value:[]}]);var t,n=this.isPlayerTurn(),r=dy(pie.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.getState().getRemainingPiecesOf(i),o=0;o<a;o++){var s=[];this.isTopPieceOfReserveAndSelected(o,a,i)&&s.push("selected-stroke"),n&&o===a-1&&i.owner===e&&s.push("clickable-stroke-hover");var u=this.viewInfo.remainingPieces.get(i.owner).get(),c=[];c.push(i.otherPieceType?"player"+i.owner.value+"-alternate-fill":"player"+i.owner.value+"-fill"),u.push({backgroundClasses:c,foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(i,o),actualPiece:i}),this.viewInfo.remainingPieces.put(i.owner,u)}}catch(l){r.e(l)}finally{r.f()}}},{key:"isTopPieceOfReserveAndSelected",value:function(e,t,n){if(this.selected.isPresent()){var r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}},{key:"getDrawPositionRemainingPiece",value:function(e,t){var r,i;return r=e.owner===e9.ZERO?-100:600,i=e.otherPieceType?100:450,new pte(r,i).getNext(new ute(0,-t*n.PIECE_HEIGHT))}},{key:"getPieces",value:function(e){for(var t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[],i=0;i<Cie.HEIGHT;i++){var a=this.getState().getPieceAtXY(e,i),o=new pte(e,i);if(a!==pie.EMPTY){var s=[];this.pieceFromBoardIsSelected(e,i)&&s.push("selected-stroke"),this.isVictory(e,i,t)&&s.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&s.push("clickable-stroke-hover"),r.push({backgroundClasses:["player"+a.owner.value+(a.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:a})}}return r}},{key:"pieceFromBoardIsSelected",value:function(e,t){if(this.selected.isPresent()){var n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}},{key:"isVictory",value:function(e,t,n){if(n.isPresent()){var r=n.get();return r.x%4==e%4&&r.y===t}return!1}},{key:"getDrawPositionOnBoard",value:function(e,t){return n.CENTER[e].getNext(new ute(0,-t*n.PIECE_HEIGHT))}},{key:"cancelMoveAttempt",value:function(){this.selected=NB.empty(),this.updateBoard()}}]),n}(gte);Lie.CENTER=[new pte(40,160),new pte(100,50),new pte(255,2),new pte(400,50),new pte(460,160),new pte(400,270),new pte(255,320),new pte(100,270)],Lie.PIECE_HEIGHT=36,Lie.\u0275fac=function(e){return new(e||Lie)(_P(D7))},Lie.\u0275cmp=vk({type:Lie,selectors:[["app-diam"]],features:[nP],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),PP(1,"defs"),PP(2,"g",1),OP(3,"path",2),OP(4,"ellipse",3),SP(),SP(),CP(5,Iie,3,5,"g",4),CP(6,Mie,2,1,"g",4),CP(7,Rie,2,1,"g",4),SP()),2&e&&(BE(5),EP("ngForOf",AT(3,Nie)),BE(1),EP("ngForOf",AT(4,Die)),BE(1),EP("ngForOf",t.Player.PLAYERS))},directives:[aM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Fie=function(){function e(t,n){gy(this,e),this.offset=t,this.constant=n}return my(e,[{key:"toString",value:function(){return"Line(".concat(this.constant,", ").concat(this.offset,")")}},{key:"equals",value:function(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}},{key:"contains",value:function(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}},{key:"getDirection",value:function(){switch(this.constant){case"q":return kte.DOWN;case"r":return kte.RIGHT;case"s":return kte.DOWN_LEFT}}}],[{key:"fromTwoCoords",value:function(t,n){var r=t.x,i=n.x,a=t.y,o=n.y,s=r+a,u=i+o;return r===i&&a!==o&&s!==u?NB.of(e.constantQ(r)):r!==i&&a===o&&s!==u?NB.of(e.constantR(a)):r!==i&&a!==o&&s===u?NB.of(e.constantS(s)):NB.empty()}},{key:"constantQ",value:function(t){return new e(t,"q")}},{key:"constantR",value:function(t){return new e(t,"r")}},{key:"constantS",value:function(t){return new e(t,"s")}},{key:"areOnSameLine",value:function(t){if(t.length<2)return!0;var n=e.fromTwoCoords(t[0],t[1]);if(n.isAbsent())return!1;var r,i=n.get(),a=dy(t.slice(2));try{for(a.s();!(r=a.n()).done;){var o=r.value;if(!1===i.contains(o))return!1}}catch(s){a.e(s)}finally{a.f()}return!0}}]),e}(),Uie=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s){var u;return gy(this,n),(u=t.call(this,r,e)).board=r,u.width=i,u.height=a,u.excludedSpaces=o,u.empty=s,F7(u.excludedSpaces.length<u.height/2+1,"Invalid excluded spaces specification for HexagonalGameState."),u}return my(n,[{key:"setAt",value:function(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}},{key:"equalsT",value:function(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedSpaces.length!==e.excludedSpaces.length)return!1;for(var n=0;n<this.excludedSpaces.length;n++)if(this.excludedSpaces[n]!==e.excludedSpaces[n])return!1;var r,i=dy(this.allCoords());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!1===t(this.getPieceAt(a),e.getPieceAt(a)))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"allCoords",value:function(){var e=[];return this.forEachCoord(function(t){e.push(t)}),e}},{key:"allLines",value:function(){for(var e=[],t=0;t<this.width;t++)e.push(Fie.constantQ(t));for(var n=0;n<this.height;n++)e.push(Fie.constantR(n));for(var r=this.excludedSpaces.length;r<this.height+this.excludedSpaces.length;r++)e.push(Fie.constantS(r));return e}},{key:"getEntranceOnLine",value:function(e){var t,n;switch(e.constant){case"q":return n=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new pte(e.offset,n));case"r":return t=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new pte(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new pte(e.offset,0):new pte(this.width-1,e.offset-this.width+1))}}},{key:"findEntranceFrom",value:function(e,t){for(var n=e.getDirection(),r=t,i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}var a=L7.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(a.getReason())}}],[{key:"neighbors",value:function(e,t){return[new pte(e.x+t,e.y-t),new pte(e.x+t,e.y),new pte(e.x-t,e.y+t),new pte(e.x-t,e.y),new pte(e.x,e.y+t),new pte(e.x,e.y-t)]}}]),n}(Ate),Vie=function(){function e(t,n,r){gy(this,e),this.owner=t,this.size=n,this.source=r}return my(e,[{key:"getValue",value:function(){return e.encoder.encodeNumber(this)}},{key:"getOwner",value:function(){return this.owner}},{key:"belongsTo",value:function(e){return this.owner===e}},{key:"containsSource",value:function(){return this.source}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"getSize",value:function(){return this.size}},{key:"toString",value:function(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}],[{key:"append",value:function(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}}]),e}();Vie.sizeEncoder=Q7.numberEncoder(49),Vie.encoder=Q7.tuple([Q7.booleanEncoder,e9.numberEncoder,Vie.sizeEncoder],function(e){return[e.source,e.owner,e.size]},function(e){return new Vie(e[1],e[2],e[0])}),Vie.MAX_SIZE=49,Vie.EMPTY=new Vie(J7.NONE,0,!1),Vie.UNREACHABLE=new Vie(J7.NONE,-1,!1),Vie.PLAYER_ZERO=new Vie(e9.ZERO,1,!1),Vie.PLAYER_ONE=new Vie(e9.ONE,1,!1),Vie.SOURCE=new Vie(J7.NONE,1,!0);var Bie=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,Vie.EMPTY)).alreadyPassed=i,a}return my(n,[{key:"getAllPieces",value:function(){for(var e=[],t=0;t<n.HEIGHT;t++)for(var r=0;r<n.WIDTH;r++){var i=new pte(r,t);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}},{key:"numberOfNeighbors",value:function(e){var t=this;return Uie.neighbors(e,1).filter(function(e){return t.isOnBoard(e)&&!1===t.getPieceAt(e).isEmpty()}).length}},{key:"setAtUnsafe",value:function(e,t){var r=i9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.alreadyPassed)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Vie.UNREACHABLE}}],[{key:"balancedBoard",value:function(){var e=Vie.UNREACHABLE,t=Vie.PLAYER_ZERO,n=Vie.PLAYER_ONE,r=Vie.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==Vie.UNREACHABLE}},{key:"getInitialState",value:function(){return new n(n.balancedBoard(),0,!1)}}]),n}(Uie);return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_SPACES=[2,1],e}(),zie=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this,e,r)}return my(n,[{key:"toString",value:function(){return this===n.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}},{key:"length",value:function(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}],[{key:"of",value:function(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return n.PASS;if(!Bie.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!Bie.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new n(e,t);if(e.x===t.x)return new n(e,t);if(e.x+e.y===t.x+t.y)return new n(e,t);throw new Error("Invalid move")}}]),n}(Fne);zie.PASS=new zie(new pte(-1,-1),new pte(-2,-2)),zie.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 42148}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return zie.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new zie(new pte((e=e/16|0)%16,r),new pte(n,t))}}]),n}(Q7));var Hie=function(){var e=my(function e(){gy(this,e)});return e.NOT_PLAYER_PIECE=function(){return $localize(Zn||(Zn=Wg(["You must select a piece or a stack of your color."])))},e.EMPTY_STACK=function(){return $localize(qn||(qn=Wg(["You must select a stack."])))},e.TOO_MANY_NEIGHBORS=function(){return $localize(Wn||(Wn=Wg(["This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors."])))},e.CANT_REACH_TARGET=function(){return $localize(jn||(jn=Wg(["This stack cannot move because it could never land on another piece."])))},e.INVALID_MOVE_LENGTH=function(){return $localize(Yn||(Yn=Wg(["A stack must always be moved by as many spaces as there are pieces in the stack."])))},e.EMPTY_TARGET_STACK=function(){return $localize(Kn||(Kn=Wg(["The stack must land on an occupied space."])))},e}(),Gie=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"isMovablePiece",value:function(e,t){F7(e.isOnBoard(t),"piece is not on the board");var r=e.getPieceAt(t);return r.getSize()<1?UB.failure(Hie.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?UB.failure(Hie.TOO_MANY_NEIGHBORS()):n.pieceHasTarget(e,t)?UB.SUCCESS:UB.failure(Hie.CANT_REACH_TARGET()):UB.failure(Hie.NOT_PLAYER_PIECE())}},{key:"canOnlyPass",value:function(e){return 0===n.getMovablePieces(e).length}},{key:"sourceCoords",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).containsSource()})}},{key:"markPiecesConnectedTo",value:function(e,t,n){var r=this;Uie.neighbors(t,1).forEach(function(t){e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,r.markPiecesConnectedTo(e,t,n))})}},{key:"removeDisconnectedPieces",value:function(e){var t=this,n=i9.createTable(Bie.WIDTH,Bie.HEIGHT,!1);this.sourceCoords(e).forEach(function(r){n[r.y][r.x]=!0,t.markPiecesConnectedTo(e,r,n)});var r=e;return r.getAllPieces().forEach(function(e){n[e.y][e.x]||(r=r.setAt(e,Vie.EMPTY))}),r}},{key:"applyLegalMove",value:function(e,t,n){if(e===zie.PASS)return new Bie(t.board,t.turn+1,!0);var r=t.getPieceAt(e.coord),i=t.getPieceAt(e.end),a=t.setAt(e.coord,Vie.EMPTY).setAt(e.end,Vie.append(r,i));return this.removeDisconnectedPieces(new Bie(a.board,t.turn+1,!1))}},{key:"isLegal",value:function(e,t){if(0===n.getMovablePieces(t).length)return e!==zie.PASS||t.alreadyPassed?DB.failure(bte.MUST_PASS()):DB.success(void 0);if(e===zie.PASS)return DB.failure(bte.CANNOT_PASS());var r=this.isMovablePiece(t,e.coord);if(r.isFailure())return r.toFailedFallible();var i=t.getPieceAt(e.coord);return e.length()!==i.getSize()?DB.failure(Hie.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?DB.failure(Hie.EMPTY_TARGET_STACK()):DB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getScores(t);return 0===n.getMovablePieces(t).length?r[0]>r[1]?Bte.ZERO_WON:r[0]<r[1]?Bte.ONE_WON:Bte.DRAW:Bte.ONGOING}},{key:"getMovablePieces",value:function(e){return n.getFreePieces(e).filter(function(t){return n.pieceHasTarget(e,t)})}},{key:"getFreePieces",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6})}},{key:"pieceHasTarget",value:function(e,t){var n=e.getPieceAt(t).getSize();return void 0!==Uie.neighbors(t,n).find(function(t){return e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty()})}},{key:"pieceTargets",value:function(e,t){var n=e.getPieceAt(t).getSize();return Uie.neighbors(t,n).filter(function(t){return e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty()})}},{key:"getScores",value:function(e){var t=0,n=0;return e.getAllPieces().map(function(r){var i=e.getPieceAt(r);i.belongsTo(e9.ZERO)?t+=i.getSize():i.belongsTo(e9.ONE)&&(n+=i.getSize())}),[t,n]}}]),n}(zte),$ie=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t=e.move,n=e.gameState,r=[];return Gie.getMovablePieces(n).forEach(function(e){return Gie.pieceTargets(n,e).forEach(function(t){var n=zie.of(e,t);r.push(n)})}),0===r.length&&!1===t.equalsValue(zie.PASS)&&r.push(zie.PASS),r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Gie.getScores(t);return 0===Gie.getMovablePieces(t).length?new Ste(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new Ste(n[0]-n[1])}}]),n}(Pte),Zie=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t=e.gameState,r=ny(ly(n.prototype),"getListMoves",this).call(this,e),i=t.getCurrentPlayer().getOpponent();return i9.sortByDescending(r,function(e){F7(e!==zie.PASS,"Cannot sort with DvonnMove.PASS");var n=t.getPieceAt(e.end);return n.belongsTo(i)?n.getSize():0}),r}},{key:"getBoardValue",value:function(e){var t=Gie.getGameStatus(e);if(t.isEndGame)return new Ste(t.toBoardValue());var n=e.gameState,r=Gie.getScores(n),i=n.getAllPieces(),a=i.length,o=i.filter(function(e){return n.getPieceAt(e).belongsTo(e9.ZERO)}).length,s=i.filter(function(e){return n.getPieceAt(e).belongsTo(e9.ONE)}).length;return new Ste((s*r[1]-o*r[0])/a)}}]),n}($ie),qie=Vie.EMPTY,Wie=Vie.UNREACHABLE,jie=Vie.SOURCE,Yie=Vie.PLAYER_ZERO,Kie=Vie.PLAYER_ONE,Qie=new Vie(e9.ZERO,2,!1),Xie=new Vie(e9.ONE,2,!1),Jie=new Vie(e9.ZERO,4,!1),eae=new Vie(e9.ONE,4,!1),tae=my(function e(){gy(this,e),this.tutorial=[Zte.anyMove($localize(Qn||(Qn=Wg(["Moving"]))),$localize(Xn||(Xn=Wg(["At Dvonn, each hexagonal space contains a stack of pieces.\n        If no number is indicated on a stack, it means that it only contains one piece.\n        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.\n        The owner of a stack is the one that has a piece at the top of the stack.\n        Only the owner of a stack can move it.\n        A stack cannot be moved if it is surrounded by 6 other stacks.\n        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.\n        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.\n        Therefore, there are six possible directions.\n        The player with dark pieces starts.<br/><br/>\n        You're playing Dark, click on a stack and move it by one space."]))),Bie.getInitialState(),zie.of(new pte(2,0),new pte(3,0)),$localize(Jn||(Jn=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(er||(er=Wg(["Disconnection"]))),$localize(tr||(tr=Wg(['Pieces with a lightning strike are called "sources".\n        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>\n        You\'re playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!']))),new Bie([[Wie,Wie,Kie,jie,qie,qie,qie,qie,qie,qie,qie],[Wie,qie,Yie,qie,qie,qie,qie,qie,qie,qie,qie],[qie,qie,eae,qie,qie,qie,qie,Kie,jie,qie,qie],[qie,qie,qie,qie,qie,qie,qie,qie,qie,qie,Wie],[qie,qie,qie,qie,qie,qie,qie,qie,qie,Wie,Wie]],0,!1),zie.of(new pte(2,1),new pte(2,0)),function(e,t,n){return e.end.equals(new pte(3,0))?UB.failure($localize(nr||(nr=Wg(["You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it."])))):(F7(e.end.equals(new pte(2,0)),"player made an impossible move"),UB.SUCCESS)},$localize(rr||(rr=Wg(["Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!\n        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.\n        Disconnected stacks will not be visible at the next turn."])))),Zte.fromPredicate($localize(ir||(ir=Wg(["Moving on a source"]))),$localize(ar||(ar=Wg(["You are allowed to move your stacks on any other stack.\n        This means that you can take control of a source by moving one of your stack on top of it.\n        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>\n        You're playing Dark and you can take control of a source, do it!"]))),new Bie([[Wie,Wie,jie,Kie,qie,qie,qie,qie,qie,qie,qie],[Wie,Yie,Yie,qie,qie,qie,qie,qie,qie,qie,qie],[qie,Kie,Yie,Kie,qie,qie,Yie,Xie,jie,qie,qie],[qie,qie,Kie,qie,qie,qie,qie,qie,qie,qie,Wie],[qie,qie,qie,qie,qie,qie,qie,qie,qie,Wie,Wie]],0,!1),zie.of(new pte(2,1),new pte(2,0)),function(e,t,n){return e.end.equals(new pte(2,0))?UB.SUCCESS:UB.failure($localize(or||(or=Wg(["You have not taken possession of a source, try again."]))))},$localize(sr||(sr=Wg(["Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!"])))),Zte.informational($localize(ur||(ur=Wg(["Passing"]))),$localize(cr||(cr=Wg(["It can happen that you have no possible move to make.\n        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>\n        This is a situation that occurs here for Dark."]))),new Bie([[Wie,Wie,jie,qie,qie,qie,qie,qie,qie,qie,qie],[Wie,qie,Qie,qie,qie,qie,qie,qie,qie,qie,qie],[qie,qie,Xie,qie,qie,qie,qie,Xie,jie,Jie,qie],[qie,qie,qie,qie,qie,qie,qie,qie,qie,qie,Wie],[qie,qie,qie,qie,qie,qie,qie,qie,qie,Wie,Wie]],0,!1)),Zte.fromMove($localize(lr||(lr=Wg(["End of the game"]))),$localize(fr||(fr=Wg(["When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>\n        Make your last move."]))),new Bie([[Wie,Wie,jie,qie,qie,qie,qie,qie,qie,qie,qie],[Wie,qie,Yie,qie,qie,qie,qie,qie,qie,qie,qie],[qie,qie,qie,qie,qie,qie,qie,qie,jie,Jie,qie],[qie,qie,qie,qie,qie,qie,qie,qie,qie,qie,Wie],[qie,qie,qie,qie,qie,qie,qie,qie,qie,Wie,Wie]],0,!1),[zie.of(new pte(2,1),new pte(2,0))],$localize(hr||(hr=Wg(["Congratulations, you won 6 - 0!"]))),$localize(dr||(dr=Wg(["Bad idea, by moving on the source you would have won a point."]))))]});function nae(e,t){if(1&e&&(NC(),OP(0,"circle",10)),2&e){var n=LP().$implicit,r=LP().$implicit,i=LP();EP("ngClass",i.getPieceClasses(n)),pP("cx",i.getCenterAt(r).x)("cy",i.getCenterAt(r).y)("r",i.SPACE_SIZE)}}function rae(e,t){if(1&e&&(NC(),OP(0,"polygon",11)),2&e){var n=LP().$implicit,r=LP().$implicit,i=LP();pP("transform",1===n.getSize()?"translate("+(i.getCenterAt(r).x-18)+" "+(i.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(r).x-3)+" "+(i.getCenterAt(r).y-12)+") scale(0.07)")}}function iae(e,t){if(1&e){var n=AP();NC(),PP(0,"text",12),RP("click",function(){aC(n);var e=LP(2).$implicit;return LP().onClick(e.x,e.y)}),uS(1),SP()}if(2&e){var r=LP().$implicit,i=LP().$implicit,a=LP();pP("x",r.containsSource()?a.getCenterAt(i).x-7:a.getCenterAt(i).x)("y",a.getCenterAt(i).y),BE(1),cS(r.getSize())}}function aae(e,t){if(1&e){var n=AP();NC(),PP(0,"g",5),RP("click",function(){aC(n);var e=LP().$implicit;return LP().onClick(e.x,e.y)}),OP(1,"polygon",6),CP(2,nae,1,4,"circle",7),CP(3,rae,1,1,"polygon",8),CP(4,iae,2,3,"text",9),SP()}if(2&e){var r=t.$implicit,i=LP().$implicit,a=LP();VP("id","click_",i.x,"_",i.y,""),BE(1),pP("points",a.getHexaCoordsAt(i)),BE(1),EP("ngIf",r.getSize()>0),BE(1),EP("ngIf",r.containsSource()),BE(1),EP("ngIf",r.getSize()>1)}}var oae=function(e){return[e]};function sae(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,aae,5,6,"g",4),SP()),2&e){var n=t.$implicit,r=LP();BE(1),EP("ngForOf",MT(1,oae,r.state.getPieceAt(n)))}}function uae(e,t){if(1&e&&(NC(),PP(0,"text",16),uS(1),SP()),2&e){var n=LP().$implicit,r=LP();pP("x",r.getCenterAt(n.coord).x)("y",r.getCenterAt(n.coord).y),BE(1),cS(n.spaceContent.getSize())}}function cae(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"polygon",13),OP(2,"circle",14),CP(3,uae,2,3,"text",15),SP()),2&e){var n=t.$implicit,r=LP();BE(1),pP("points",r.getHexaCoordsAt(n.coord)),BE(1),VP("id","captured_",n.coord.x,"_",n.coord.y,""),EP("ngClass",r.getPieceClasses(n.spaceContent)),pP("cx",r.getCenterAt(n.coord).x)("cy",r.getCenterAt(n.coord).y)("r",r.SPACE_SIZE),BE(1),EP("ngIf",n.spaceContent.getSize()>1)}}function lae(e,t){if(1&e&&(NC(),TP(0),OP(1,"polygon",17),OP(2,"polygon",17),IP()),2&e){var n=LP();BE(1),pP("points",n.getHexaCoordsAt(n.lastMove.get().coord)),BE(1),pP("points",n.getHexaCoordsAt(n.lastMove.get().end))}}function fae(e,t){if(1&e&&(NC(),OP(0,"polygon",18)),2&e){var n=LP();pP("points",n.getHexaCoordsAt(n.chosen.get()))}}var hae=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).lastMove=NB.empty(),r.chosen=NB.empty(),r.disconnecteds=[],r.rules=new Gie(Bie),r.availableMinimaxes=[new $ie(r.rules,"DvonnMinimax"),new Zie(r.rules,"DvonnMinimaxMaximizeStacks")],r.encoder=zie.encoder,r.tutorial=(new tae).tutorial,r.SPACE_SIZE=30,r.canPass=!1,r.scores=NB.of(Gie.getScores(r.getState())),r.hexaLayout=new Cte(1.5*r.SPACE_SIZE,new pte(-r.SPACE_SIZE,2*r.SPACE_SIZE),_te.INSTANCE),r.state=r.getState(),r.hexaBoard=r.getState().board,r}return my(n,[{key:"hideLastMove",value:function(){this.lastMove=NB.empty()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.state=this.getState(),this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=NB.of(Gie.getScores(this.state))}},{key:"calculateDisconnecteds",value:function(){for(var e=this.rules.node.mother.get().gameState,t=this.getState(),n=0;n<t.board.length;n++)for(var r=0;r<t.board[n].length;r++){var i=new pte(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){var a=t.getPieceAt(i),o=e.getPieceAt(i);if(a.isEmpty()&&!o.isEmpty()){var s={coord:new pte(r,n),spaceContent:o};this.disconnecteds.push(s)}}}}},{key:"cancelMoveAttempt",value:function(){this.chosen=NB.empty()}},{key:"pass",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return F7(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),t.next=3,e.chooseMove(zie.PASS,e.getState());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=5;break}r.t0=n.cancelMove(i.getReason()),r.next=18;break;case 5:if(!n.chosen.isAbsent()){r.next=9;break}r.t1=n.choosePiece(e,t),r.next=17;break;case 9:if(!n.chosen.equalsValue(new pte(e,t))){r.next=13;break}r.t2=(n.cancelMoveAttempt(),UB.SUCCESS),r.next=16;break;case 13:return r.next=15,n.chooseDestination(e,t);case 15:r.t2=r.sent;case 16:r.t1=r.t2;case 17:r.t0=r.t1;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=new pte(e,t),r=this.rules.isMovablePiece(this.getState(),n);return r.isSuccess()?(this.chosen=NB.of(n),UB.SUCCESS):this.cancelMove(r.getReason())}},{key:"chooseDestination",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new pte(e,t),o=zie.of(i,a),r.abrupt("return",n.chooseMove(o,n.getState()));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e){if(e.containsSource()&&1===e.getSize())return["nonplayer-fill","dashed-stroke"];var t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"nonplayer-stroke","dashed-stroke"]:[t]}}]),n}(yte);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-dvonn"]],features:[nP],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,sae,2,3,"g",1),CP(2,cae,4,8,"g",1),CP(3,lae,3,2,"ng-container",2),CP(4,fae,1,1,"polygon",3),SP()),2&e&&(BE(1),EP("ngForOf",t.state.allCoords()),BE(1),EP("ngForOf",t.disconnecteds),BE(1),EP("ngIf",t.lastMove.isPresent()),BE(1),EP("ngIf",t.chosen.isPresent()))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),dae=(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}(dae||(dae={})),dae),vae=function(){function e(t){gy(this,e),this.value=t}return my(e,[{key:"getPlayer",value:function(){switch(this){case e.SMALL_DARK:case e.MEDIUM_DARK:case e.BIG_DARK:return e9.ZERO;case e.SMALL_LIGHT:case e.MEDIUM_LIGHT:case e.BIG_LIGHT:return e9.ONE;default:return J7.NONE}}},{key:"getSize",value:function(){switch(this){case e.BIG_DARK:case e.BIG_LIGHT:return dae.BIG;case e.MEDIUM_DARK:case e.MEDIUM_LIGHT:return dae.MEDIUM;case e.SMALL_DARK:case e.SMALL_LIGHT:return dae.SMALL;default:return IB.expectToBe(this,e.NONE),dae.NONE}}},{key:"belongsTo",value:function(e){return this.getPlayer()===e}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){switch(this){case e.BIG_DARK:return"BIG_DARK";case e.BIG_LIGHT:return"BIG_LIGHT";case e.MEDIUM_DARK:return"MEDIUM_DARK";case e.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case e.SMALL_DARK:return"SMALL_DARK";case e.SMALL_LIGHT:return"SMALL_LIGHT";default:return IB.expectToBe(this,e.NONE),"EMPTY"}}}],[{key:"of",value:function(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}},{key:"ofSizeAndPlayer",value:function(t,n){return n===e9.ZERO&&t===dae.BIG?e.BIG_DARK:n===e9.ZERO&&t===dae.MEDIUM?e.MEDIUM_DARK:n===e9.ZERO&&t===dae.SMALL?e.SMALL_DARK:n===e9.ONE&&t===dae.BIG?e.BIG_LIGHT:n===e9.ONE&&t===dae.MEDIUM?e.MEDIUM_LIGHT:n===e9.ONE&&t===dae.SMALL?e.SMALL_LIGHT:e.NONE}}]),e}();vae.SMALL_DARK=new vae(0),vae.SMALL_LIGHT=new vae(1),vae.MEDIUM_DARK=new vae(2),vae.MEDIUM_LIGHT=new vae(3),vae.BIG_DARK=new vae(4),vae.BIG_LIGHT=new vae(5),vae.NONE=new vae(6);var pae=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r)).remainingPieces=i,a}return my(n,[{key:"getRemainingPieces",value:function(){return i9.copyImmutableArray(this.remainingPieces)}},{key:"getRemainingPiecesOfPlayer",value:function(e){return this.getRemainingPieces().filter(function(t){return t.getPlayer()===e})}},{key:"pieceBelongsToCurrentPlayer",value:function(e){return e.belongsTo(this.getCurrentPlayer())}},{key:"isDroppable",value:function(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}},{key:"isInRemainingPieces",value:function(e){return this.remainingPieces.some(function(t){return t===e})}},{key:"getPlayerRemainingPieces",value:function(){var e=this;return this.remainingPieces.filter(function(t){return e.pieceBelongsToCurrentPlayer(t)})}}],[{key:"getInitialState",value:function(){var e=new gae(J7.NONE,J7.NONE,J7.NONE).encode(),t=i9.createTable(3,3,e);return new n(i9.mapBiArray(t,function(e){return gae.decode(e)}),0,[vae.BIG_DARK,vae.BIG_DARK,vae.BIG_LIGHT,vae.BIG_LIGHT,vae.MEDIUM_DARK,vae.MEDIUM_DARK,vae.MEDIUM_LIGHT,vae.MEDIUM_LIGHT,vae.SMALL_DARK,vae.SMALL_DARK,vae.SMALL_LIGHT,vae.SMALL_LIGHT])}}]),n}(Ate),gae=function(){function e(t,n,r){gy(this,e),this.small=t,this.medium=n,this.big=r}return my(e,[{key:"isEmpty",value:function(){return this.small===J7.NONE&&this.medium===J7.NONE&&this.big===J7.NONE}},{key:"toList",value:function(){var e=[];return this.small.isPlayer()&&e.push(vae.ofSizeAndPlayer(dae.SMALL,this.small)),this.medium.isPlayer()&&e.push(vae.ofSizeAndPlayer(dae.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(vae.ofSizeAndPlayer(dae.BIG,this.big)),e}},{key:"toOrderedPieceNames",value:function(){var e=vae.ofSizeAndPlayer(dae.SMALL,this.small),t=vae.ofSizeAndPlayer(dae.MEDIUM,this.medium),n=vae.ofSizeAndPlayer(dae.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}},{key:"getBiggest",value:function(){return this.big===e9.ZERO?vae.BIG_DARK:this.big===e9.ONE?vae.BIG_LIGHT:this.medium===e9.ZERO?vae.MEDIUM_DARK:this.medium===e9.ONE?vae.MEDIUM_LIGHT:this.small===e9.ZERO?vae.SMALL_DARK:this.small===e9.ONE?vae.SMALL_LIGHT:vae.NONE}},{key:"tryToSuperposePiece",value:function(e){var t=this.getBiggest().getSize();if(e===vae.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?NB.of(this.put(e)):NB.empty()}},{key:"removeBiggest",value:function(){var t,n=this.getBiggest();if(n===vae.NONE)throw new Error("Cannot removed piece from empty space");var r=n.getSize();switch(r){case dae.BIG:t=new e(this.small,this.medium,J7.NONE);break;case dae.MEDIUM:t=new e(this.small,J7.NONE,J7.NONE);break;default:IB.expectToBe(r,dae.SMALL),t=new e(J7.NONE,J7.NONE,J7.NONE)}return{removedSpace:t,removedPiece:n}}},{key:"put",value:function(t){if(t===vae.NONE)throw new Error("Cannot put NONE on space");var n=t.getPlayer(),r=t.getSize();switch(r){case dae.BIG:return new e(this.small,this.medium,n);case dae.MEDIUM:return F7(this.big===J7.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return IB.expectToBe(r,dae.SMALL),F7(this.big===J7.NONE,"Cannot put a piece on top of a bigger one"),F7(this.medium===J7.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}},{key:"encode",value:function(){return this.small.value+3*this.medium.value+9*this.big.value}},{key:"belongsTo",value:function(e){return this.getBiggest().getPlayer()===e}},{key:"toString",value:function(){var e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}],[{key:"decode",value:function(t){F7(t%1==0,"EncapsuleSpace must be encoded as integer: "+t),F7(t>=0,"To small representation for EncapsuleSpace: "+t),F7(t<=26,"To big representation for EncapsuleSpace: "+t);var n=e9.numberEncoder.decodeNumber(t%3);t-=n.value;var r=e9.numberEncoder.decodeNumber((t/=3)%3);return t-=r.value,new e(n,r,e9.numberEncoder.decodeNumber(t/=3))}}]),e}();gae.EMPTY=new gae(J7.NONE,J7.NONE,J7.NONE);var yae=function(){var e=my(function e(){gy(this,e)});return e.PIECE_OUT_OF_STOCK=function(){return $localize(vr||(vr=Wg(["You do not have pieces of this type anymore."])))},e.INVALID_PLACEMENT=function(){return $localize(pr||(pr=Wg(["You must put your piece on an empty square or on a smaller piece."])))},e.NOT_DROPPABLE=function(){return $localize(gr||(gr=Wg(["You must pick your piece among the remaining ones."])))},e.INVALID_PIECE_SELECTED=function(){return $localize(yr||(yr=Wg(["You must pick one of your remaining pieces or one piece on the board that is the biggest of its square."])))},e.END_YOUR_MOVE=function(){return $localize(mr||(mr=Wg(["You are performing a move, you must select a landing square."])))},e}(),mae=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){var r,i=t.getCopiedBoard(),a=t.getRemainingPieces(),o=t.turn+1;if(i[e.landingCoord.y][e.landingCoord.x]=gae.decode(n.encode()),e.isDropping()){r=e.piece.get();var s=a.indexOf(r);a=a.slice(0,s).concat(a.slice(s+1))}else{var u=e.startingCoord.get(),c=i[u.y][u.x].encode(),l=gae.decode(c).removeBiggest();i[u.y][u.x]=gae.decode(l.removedSpace.encode()),r=l.removedPiece}return new pae(i,o,a)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isVictory",value:function(e){var t,r=e.getCopiedBoard(),i=dy(n.LINES);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.isVictoriousLine([r[a[0].y][a[0].x],r[a[1].y][a[1].x],r[a[2].y][a[2].x]]);if(o.isPresent())return o}}catch(s){i.e(s)}finally{i.f()}return NB.empty()}},{key:"isVictoriousLine",value:function(e){var t=e.map(function(e){return e.getBiggest()}).map(function(e){return e.getPlayer()});return t[0]===J7.NONE?NB.empty():t[0]===t[1]&&t[1]===t[2]?NB.of(t[0]):NB.empty()}},{key:"isLegal",value:function(e,t){var n;if(AB(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return DB.failure(bte.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return DB.failure(yae.PIECE_OUT_OF_STOCK())}else{var r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return DB.failure(bte.MUST_CHOOSE_PLAYER_PIECE())}var i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return i.isPresent()?DB.success(i.get()):DB.failure(yae.INVALID_PLACEMENT())}},{key:"getGameStatus",value:function(e){var t=n.isVictory(e.gameState);return t.isPresent()?Bte.getVictory(t.get()):Bte.ONGOING}}]),n}(zte);mae.LINES=[[new pte(0,0),new pte(0,1),new pte(0,2)],[new pte(1,0),new pte(1,1),new pte(1,2)],[new pte(2,0),new pte(2,1),new pte(2,2)],[new pte(0,0),new pte(1,0),new pte(2,0)],[new pte(0,1),new pte(1,1),new pte(2,1)],[new pte(0,2),new pte(1,2),new pte(2,2)],[new pte(0,0),new pte(1,1),new pte(2,2)],[new pte(0,2),new pte(1,1),new pte(2,0)]];var kae=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this)).startingCoord=e,a.landingCoord=r,a.piece=i,a}return my(n,[{key:"isDropping",value:function(){return this.startingCoord.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}},{key:"toString",value:function(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}],[{key:"fromMove",value:function(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new n(NB.of(e),t,NB.empty())}},{key:"fromDrop",value:function(e,t){return new n(NB.empty(),t,NB.of(e))}}]),n}(xte);kae.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 161}},{key:"encodeNumber",value:function(e){var t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){return 18*e.piece.get().value+6*t+2*n+0}var r=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*r+6*t+2*n+1}},{key:"decodeNumber",value:function(e){var t=e%2;e-=t;var n=(e/=2)%3;e-=n;var r=(e/=3)%3;e-=r,e/=3;var i=new pte(r,n);if(0===t){var a=vae.of(e);return kae.fromDrop(a,i)}var o=e%3;e-=o;var s=new pte((e/=3)%3,o);return kae.fromMove(s,i)}}]),n}(Q7));var Cae=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getBoardValue",value:function(e){var t=mae.getGameStatus(e);return new Ste(t.toBoardValue())}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),a=Ote.toComparableObjectSet(n.getPlayerRemainingPieces()),o=0;o<3;o++)for(var s=0;s<3;s++){var u,c=new pte(s,o),l=dy(a);try{for(l.s();!(u=l.n()).done;){var f=u.value,h=kae.fromDrop(f,c);mae.isLegal(h,n).isSuccess()&&t.push(h)}}catch(y){l.e(y)}finally{l.f()}if(r[o][s].belongsTo(i))for(var d=0;d<3;d++)for(var v=0;v<3;v++){var p=new pte(v,d);if(!p.equals(c)){var g=kae.fromMove(c,p);mae.isLegal(g,n).isSuccess()&&t.push(g)}}}return t}}]),n}(Pte),wae=new gae(J7.NONE,J7.NONE,J7.NONE),_ae=new gae(e9.ZERO,J7.NONE,J7.NONE),Eae=new gae(J7.NONE,e9.ZERO,J7.NONE),bae=new gae(J7.NONE,J7.NONE,e9.ZERO),Pae=new gae(e9.ONE,J7.NONE,J7.NONE),Sae=new gae(J7.NONE,J7.NONE,e9.ONE),Oae=new gae(e9.ONE,e9.ZERO,J7.NONE),Tae=new gae(e9.ZERO,e9.ZERO,J7.NONE),Iae=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(kr||(kr=Wg(["Goal of the game"]))),$localize(Cr||(Cr=Wg(["The goal of Encapsule is to align three of your pieces.\n        Here, we have a victory of the dark player."]))),new pae([[_ae,Pae,Sae],[wae,Eae,wae],[wae,wae,bae]],0,[vae.SMALL_DARK,vae.MEDIUM_DARK,vae.BIG_DARK,vae.SMALL_LIGHT,vae.MEDIUM_LIGHT,vae.MEDIUM_LIGHT,vae.BIG_LIGHT])),Zte.anyMove($localize(wr||(wr=Wg(["Putting a piece"]))),$localize(_r||(_r=Wg(["This is the initial board. You're playing Dark.<br/><br/>\n        Pick one of your piece on the side of the board and put it on the board."]))),pae.getInitialState(),kae.fromDrop(vae.SMALL_DARK,new pte(1,1)),$localize(Er||(Er=Wg(["Congratulations!"])))),Zte.fromMove($localize(br||(br=Wg(["Moving"]))),$localize(Pr||(Pr=Wg(["Another possible action is to move one of your pieces that is already on the board.<br/><br/>\n        Click on your dark piece and then on any empty square of the board."]))),new pae([[_ae,Sae,wae],[wae,wae,wae],[wae,wae,wae]],0,[]),[kae.fromMove(new pte(0,0),new pte(2,0)),kae.fromMove(new pte(0,0),new pte(0,1)),kae.fromMove(new pte(0,0),new pte(1,1)),kae.fromMove(new pte(0,0),new pte(2,1)),kae.fromMove(new pte(0,0),new pte(0,2)),kae.fromMove(new pte(0,0),new pte(1,2)),kae.fromMove(new pte(0,0),new pte(2,2))],$localize(Sr||(Sr=Wg(["Congratulations!"]))),$localize(Or||(Or=Wg(["Failed. Try again."])))),Zte.fromPredicate($localize(Tr||(Tr=Wg(["Particularity"]))),$localize(Ir||(Ir=Wg(['At Encapsule, pieces encapsulate each other.\n        It is therefore possible to have up to three pieces per square!\n        However, only the biggest piece of each square counts:\n        you cannot win with a piece that is "hidden" by a bigger piece.\n        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.\n        Finally, you cannot encapsulate a piece with a smaller piece.\n        You\'re playing Dark and you can win now in various ways.<br/><br/>\n        Try to win by making a move, and not by putting a new piece on the board.']))),new pae([[Oae,wae,Pae],[Tae,Sae,Sae],[wae,wae,wae]],0,[vae.MEDIUM_DARK,vae.BIG_DARK,vae.MEDIUM_LIGHT,vae.MEDIUM_LIGHT]),kae.fromMove(new pte(0,1),new pte(0,2)),function(e,t,n){if(e.landingCoord.equals(new pte(0,2))){if(e.isDropping())return UB.failure($localize(Ar||(Ar=Wg(["You won, but the exercise is to win while moving a piece!"]))));if(e.startingCoord.equalsValue(new pte(0,1)))return UB.SUCCESS}return UB.failure($localize(Mr||(Mr=Wg(["Failed. Try again."]))))},$localize(xr||(xr=Wg(["Congratulations!"]))))]});function Aae(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"circle",6),RP("click",function(){var e=aC(n),t=e.$implicit,r=e.index;return LP().onPieceClick(0,t,r)}),SP(),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP();BE(1),VP("id","piece_0_",r.toString(),"_",i,""),EP("ngClass",a.getSidePieceClasses(r,i)),pP("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(0,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}function Mae(e,t){if(1&e){var n=AP();NC(),PP(0,"circle",9),RP("click",function(){aC(n);var e=LP().index,t=LP().index;return LP().onBoardClick(e,t)}),SP()}if(2&e){var r=t.$implicit,i=LP().index,a=LP().index,o=LP();EP("ngClass",o.getPieceClasses(r)),pP("r",o.getPieceRadius(r))("cx",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function xae(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",7),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onBoardClick(e,t)}),SP(),CP(2,Mae,1,4,"circle",8),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP().index,o=LP();BE(1),VP("id","click_",i,"_",a,""),EP("ngClass",o.getRectClasses(i,a)),pP("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),BE(1),EP("ngForOf",o.getListPieces(r))}}function Rae(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,xae,3,8,"g",2),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function Nae(e,t){if(1&e){var n=AP();NC(),PP(0,"rect",10),RP("click",function(){aC(n);var e=LP();return e.onBoardClick(e.chosenCoord.get().x,e.chosenCoord.get().y)}),SP()}if(2&e){var r=LP();VP("id","chosenCoord_",r.chosenCoord.get().x,"_",r.chosenCoord.get().y,""),pP("x",r.SPACE_SIZE*r.chosenCoord.get().x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*r.chosenCoord.get().y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function Dae(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"circle",6),RP("click",function(){var e=aC(n),t=e.$implicit,r=e.index;return LP().onPieceClick(1,t,r)}),SP(),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP();BE(1),VP("id","piece_1_",r.toString(),"_",i,""),EP("ngClass",a.getSidePieceClasses(r,i)),pP("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(1,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}var Lae=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).INTER_PIECE_SPACE=20,r.lastLandingCoord=NB.empty(),r.lastStartingCoord=NB.empty(),r.chosenCoord=NB.empty(),r.chosenPiece=NB.empty(),r.remainingPieceLeftX=[],r.rules=new mae(pae),r.availableMinimaxes=[new Cae(r.rules,"EncapsuleMinimax")],r.encoder=kae.encoder,r.tutorial=(new Iae).tutorial,r.updateBoard(),r}return my(n,[{key:"updateBoard",value:function(){var e=this.getState();this.board=e.getCopiedBoard();var t=this.rules.node.move;this.calculateLeftX(),t.isPresent()?(this.lastLandingCoord=NB.of(t.get().landingCoord),this.lastStartingCoord=t.get().startingCoord):(this.lastLandingCoord=NB.empty(),this.lastStartingCoord=NB.empty())}},{key:"getListPieces",value:function(e){return e.toList()}},{key:"getRemainingPieces",value:function(e){return this.getState().getRemainingPiecesOfPlayer(e9.of(e))}},{key:"onBoardClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new pte(e,t),o=n.getState(),!n.chosenCoord.isAbsent()){r.next=9;break}if(n.chosenCoord=NB.of(a),!n.chosenPiece.isPresent()){r.next=8;break}return s=kae.fromDrop(n.chosenPiece.get(),a),r.abrupt("return",n.chooseMove(s,n.getState()));case 8:return r.abrupt("return",!1===o.getPieceAt(a).belongsTo(o.getCurrentPlayer())?n.cancelMove(yae.INVALID_PIECE_SELECTED()):UB.SUCCESS);case 9:if(!n.chosenCoord.equalsValue(a)){r.next=11;break}return r.abrupt("return",(n.cancelMoveAttempt(),UB.SUCCESS));case 11:return u=kae.fromMove(n.chosenCoord.get(),a),r.abrupt("return",n.chooseMove(u,n.getState()));case 13:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=NB.empty(),this.chosenPiece=NB.empty(),this.chosenPieceIndex=NB.empty()}},{key:"onPieceClick",value:function(e,t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a="#piece_"+e+"_"+t.toString()+"_"+n,o=r.canUserPlay(a),i.abrupt("return",o.isFailure()?r.cancelMove(o.getReason()):!1===r.getState().isDroppable(t)?r.cancelMove(yae.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece.equalsValue(t)&&r.chosenPieceIndex.equalsValue(n)?(r.chosenPiece=NB.empty(),r.chosenPieceIndex=NB.empty()):(r.chosenPiece=NB.of(t),r.chosenPieceIndex=NB.of(n)),UB.SUCCESS):r.cancelMove(yae.END_YOUR_MOVE()));case 2:case"end":return i.stop()}},i)}))()}},{key:"getRectClasses",value:function(e,t){return this.isSelected(e,t)?"moved-fill":""}},{key:"isSelected",value:function(e,t){var n=new pte(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}},{key:"getPieceClasses",value:function(e){return[this.getPieceStrokeClass(e)]}},{key:"getPieceStrokeClass",value:function(e){var t=e.getPlayer();return F7(t.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+t.value+"-stroke"}},{key:"getPieceRadius",value:function(e){switch(e.getSize()){case dae.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case dae.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return IB.expectToBe(e.getSize(),dae.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}},{key:"getSidePieceClasses",value:function(e,t){var n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(t)&&n.push("selected-stroke"),n}},{key:"isSelectedPiece",value:function(e){return this.chosenPiece.equalsValue(e)}},{key:"calculateLeftX",value:function(){this.remainingPieceLeftX=[];for(var e=0;e<=1;e++){this.remainingPieceLeftX.push([]);for(var t=this.getRemainingPieces(e),n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{var r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}},{key:"getPieceLeftX",value:function(e,t){return this.remainingPieceLeftX[e][t]}}]),n}(Sne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-encapsule"]],features:[nP],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingPiecePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPiecePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),PP(1,"g",null,1),CP(3,Aae,2,6,"g",2),SP(),PP(4,"g",null,3),CP(6,Rae,2,1,"g",2),CP(7,Nae,1,6,"rect",4),SP(),PP(8,"g",null,5),CP(10,Dae,2,6,"g",2),SP(),SP()),2&e&&(BE(1),pP("transform","translate("+t.STROKE_WIDTH+", 0)"),BE(2),EP("ngForOf",t.getRemainingPieces(0)),BE(1),pP("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),BE(2),EP("ngForOf",t.board),BE(1),EP("ngIf",t.chosenCoord.isPresent()),BE(1),pP("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),BE(2),EP("ngForOf",t.getRemainingPieces(1)))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Fae=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o){var s;if(gy(this,n),(s=t.call(this,e,r)).movedPieces=i,s.stepSize=a,s.direction=o,s.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+s.coord.toString()+".");if(i<1)throw new Error("Must select minimum one piece (got "+i+").");if(a<1)throw new Error("Step size must be minimum one (got "+a+").");if(a>i)throw new Error("Cannot move a phalanx further than its size (got step size "+a+" for "+i+" pieces).");return sy(s)}return my(n,[{key:"toString",value:function(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}]),n}(Rte);Fae.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 122303}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%8;e-=t;var n=(e/=8)%7;e-=n;var r=(e/=7)%13;e-=r;var i=(e/=13)%12;e-=i;var a=e/=12,o=fte.factory.fromInt(t);return new Fae(a,i,r+1,n+1,o.get())}}]),n}(Q7));var Uae=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"count",value:function(e,t){for(var n=0,r=0;r<14;r++)this.board[t][r]===e&&n++;return n}},{key:"doesOwnPiece",value:function(e){for(var t=0;t<12;t++)for(var n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}],[{key:"getInitialState",value:function(){var e=J7.NONE,t=J7.ZERO,r=J7.ONE;return new n([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t]],0)}}]),n}(Ate),Vae=function(){var e=my(function e(){gy(this,e)});return e.PHALANX_IS_LEAVING_BOARD=function(){return $localize(Rr||(Rr=Wg(["The move distance of your phalanx puts it out of the board."])))},e.SOMETHING_IN_PHALANX_WAY=function(){return $localize(Nr||(Nr=Wg(["There is something in the way of your phalanx."])))},e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=function(){return $localize(Dr||(Dr=Wg(["Your phalanx must be bigger than the one you are capturing."])))},e.SQUARE_NOT_ALIGNED_WITH_SELECTED=function(){return $localize(Lr||(Lr=Wg(["This square is not aligned with the selected piece."])))},e.SINGLE_PIECE_MUST_MOVE_BY_ONE=function(){return $localize(Fr||(Fr=Wg(["A single piece can only move by one square."])))},e.SINGLE_PIECE_CANNOT_CAPTURE=function(){return $localize(Ur||(Ur=Wg(["A single piece cannot make a capture."])))},e.SQUARE_NOT_ALIGNED_WITH_PHALANX=function(){return $localize(Vr||(Vr=Wg(["This square is not aligned with the direction of the phalanx."])))},e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=function(){return $localize(Br||(Br=Wg(["A phalanx can't contain pieces outside of the board."])))},e.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=function(){return $localize(zr||(zr=Wg(["A phalanx cannot contain an empty square."])))},e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=function(){return $localize(Hr||(Hr=Wg(["A phalanx cannot contain a piece of the opponent."])))},e}(),Bae=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){return new Uae(n,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.count(e9.ZERO,0),r=t.count(e9.ONE,11);if(t.turn%2==0){if(n>r)return Bte.ZERO_WON}else if(r>n)return Bte.ONE_WON;return!1===t.doesOwnPiece(e9.ZERO)?Bte.ONE_WON:!1===t.doesOwnPiece(e9.ONE)?Bte.ZERO_WON:Bte.ONGOING}}],[{key:"isLegal",value:function(e,t){var r=this.getPhalanxValidity(t,e);if(r.isFailure())return DB.failure(r.getReason());var i=this.getLandingStatus(t,e);if(i.isFailure())return i;var a=i9.copyBiArray(i.get()),o=t.getCurrentOpponent(),s=n.getCaptureValidity(t,a,e,o);return s.isFailure()?s:DB.success(s.get())}},{key:"getPhalanxValidity",value:function(e,t){for(var n=t.coord,r=0,i=e.getCurrentOpponent();r<t.movedPieces;){if(n.isNotInRange(14,12))return UB.failure(Vae.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());var a=e.getPieceAt(n);if(a===J7.NONE)return UB.failure(Vae.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(a===i)return UB.failure(Vae.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),r++}return UB.SUCCESS}},{key:"getLandingStatus",value:function(e,t){for(var n=e.getCopiedBoard(),r=e.getCurrentPlayer(),i=t.coord,a=t.coord.getNext(t.direction,t.movedPieces),o=0;o+1<t.stepSize;){if(n[i.y][i.x]=J7.NONE,n[a.y][a.x]=r,a.isNotInRange(14,12))return DB.failure(Vae.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(a).isPlayer())return DB.failure(Vae.SOMETHING_IN_PHALANX_WAY());o++,a=a.getNext(t.direction,1),i=i.getNext(t.direction,1)}return a.isNotInRange(14,12)?DB.failure(Vae.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(a)===r?DB.failure(bte.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=J7.NONE,n[a.y][a.x]=r,DB.success(n))}},{key:"getCaptureValidity",value:function(e,t,n,r){for(var i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),a=0;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(a>0&&(t[i.y][i.x]=J7.NONE),++a>=n.movedPieces)return DB.failure(Vae.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return DB.success(t)}}]),n}(zte),zae=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t=n.getListMoves(e);return i9.sortByDescending(t,function(e){return e.stepSize}),t}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new Ste(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}},{key:"getPieceCountPlusRowDomination",value:function(e){for(var t=0,n=0;n<12;n++){for(var r=0,i=[0,0],a=0;a<14;a++){var o=new pte(a,n),s=e.getPieceAt(o);if(s.isPlayer()){var u=s.getScoreModifier();t+=2002*u,i[s.value]=u,r+=u;for(var c=0,l=[fte.UP_LEFT,fte.UP,fte.UP_RIGHT];c<l.length;c++)for(var f=l[c],h=o.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)t+=1*u,h=h.getNext(f,1)}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce(function(e,t){return e+t})}return t}}],[{key:"getListMoves",value:function(e){for(var t,n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),i=J7.NONE,a=[],o=e.gameState,s=0;s<12;s++)for(var u=0;u<14;u++){var c=new pte(u,s);if(o.getPieceAt(c)===n){var l,f=dy(fte.DIRECTIONS);try{for(f.s();!(l=f.n()).done;){for(var h=l.value,d=1,v=c.getNext(h,1);v.isInRange(14,12)&&o.getPieceAt(v)===n;)d+=1,v=v.getNext(h,1);for(var p=1;v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===i;)t=new Fae(u,s,d,p,h),a=this.addMove(a,t,o),p++,v=v.getNext(h,1);v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===r&&(t=new Fae(u,s,d,p,h),a=this.addMove(a,t,o))}}catch(g){f.e(g)}finally{f.f()}}}return a}},{key:"addMove",value:function(e,t,n){return Bae.isLegal(t,n).isSuccess()&&e.push(t),e}}]),n}(Pte),Hae=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t=zae.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}},{key:"orderMovesByPhalanxSizeAndFilter",value:function(e,t){var n=this;return i9.sortByDescending(e,function(e){return e.movedPieces}),e.length>40?e.filter(function(e){return!!n.moveIsCapture(e,t)||e.movedPieces*Math.random()>1}):e}},{key:"moveIsCapture",value:function(e,t){var n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new Ste(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}},{key:"getPieceCountThenSupportThenAdvancement",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=new pte(r,n),a=e.getPieceAt(i);if(a.isPlayer()){var o=void 0,s=void 0;a===e9.ZERO?(o=12-n,s=[fte.UP_LEFT,fte.UP,fte.UP_RIGHT]):(o=n+1,s=[fte.DOWN_LEFT,fte.DOWN,fte.DOWN_RIGHT]);var u=a.getScoreModifier();t+=o*u,t+=149629*u;var c,l=dy(s);try{for(l.s();!(c=l.n()).done;)for(var f=c.value,h=i.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===a;)t+=337*u,h=h.getNext(f,1)}catch(d){l.e(d)}finally{l.f()}}}return t}}]),n}(Pte),Gae=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).DOMINANCE_FACTOR=20,e.DEFENSE_FACTOR=5,e.TERRITORY_FACTOR=2,e.OFFENSE_FACTOR=10,e.CENTER_FACTOR=5,e.MOBILITY_FACTOR=.12,e}return my(n,[{key:"getDominance",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new pte(r,n));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}},{key:"getDefense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new pte(n,11))===e9.ZERO&&(t+=e9.ZERO.getScoreModifier()),e.getPieceAt(new pte(n,0))===e9.ONE&&(t+=e9.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}},{key:"getTerritory",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new pte(r,n));if(i.isPlayer()){for(var a=-1;a<=1;a++)for(var o=-1;o<=1;o++){var s=new pte(r+a,n+o);if(s.isInRange(14,12)){var u=e.getPieceAt(s);(u===i||u===J7.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}},{key:"getOffense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new pte(n,0))===e9.ZERO&&(t+=e9.ZERO.getScoreModifier()),e.getPieceAt(new pte(n,11))===e9.ONE&&(t+=e9.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}},{key:"getCenter",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new pte(r,n));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}},{key:"getMobility",value:function(e){for(var t=0,n=0,r=0,i=0;i<12;i++)for(var a=0;a<14;a++){var o=new pte(a,i),s=e.getPieceAt(o);if(s.isPlayer()){var u,c=dy(fte.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){for(var l=u.value,f=1,h=o.getNext(l,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)f+=1,h=h.getNext(l,1);for(var d=1;h.isInRange(14,12)&&d<=f&&e.getPieceAt(h)===J7.NONE;)d++,h=h.getNext(l,1);t+=d*d*s.getScoreModifier(),s===e9.ZERO?n=Math.max(n,d):s===e9.ONE&&(r=Math.max(r,d))}}catch(v){c.e(v)}finally{c.f()}}}return(t+n*e9.ZERO.getScoreModifier()+r*e9.ONE.getScoreModifier())*this.MOBILITY_FACTOR}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new Ste(n.toBoardValue());var r=this.getDominance(t),i=this.getDefense(t),a=this.getTerritory(t),o=this.getCenter(t),s=this.getOffense(t),u=this.getMobility(t);return new Ste(r+i+a+o+s+u)}}]),n}(zae),$ae=J7.NONE,Zae=J7.ZERO,qae=J7.ONE,Wae=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(Gr||(Gr=Wg(["Initial board"]))),$localize($r||($r=Wg(["This is the initial board of Epaminondas.\n        The top line is the starting line of Light.\n        The bottom line is the starting line of Dark."]))),Uae.getInitialState()),Zte.informational($localize(Zr||(Zr=Wg(["Goal of the game (1/2)"]))),$localize(qr||(qr=Wg(["After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line\n        than the number of pieces the opponent has on the player's starting line, the player wins.\n        Here, it's Dark's turn to play: Dark has therefore won."]))),new Uae([[$ae,$ae,$ae,$ae,$ae,Zae,$ae,$ae,qae,qae,qae,qae,qae,qae],[$ae,$ae,$ae,$ae,$ae,Zae,$ae,$ae,$ae,$ae,$ae,$ae,qae,qae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,qae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,Zae,Zae,Zae,Zae,$ae,$ae,$ae]],0)),Zte.informational($localize(Wr||(Wr=Wg(["Goal of the game (2/2)"]))),$localize(jr||(jr=Wg(["Here, it is Light's turn.\n        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line."]))),new Uae([[$ae,$ae,$ae,$ae,$ae,Zae,$ae,$ae,$ae,$ae,qae,qae,qae,qae],[$ae,$ae,$ae,$ae,$ae,Zae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,qae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,qae,qae,$ae,$ae,$ae,Zae,Zae,$ae,Zae,Zae,Zae,Zae]],1)),Zte.fromPredicate($localize(Yr||(Yr=Wg(["Moving a piece"]))),$localize(Kr||(Kr=Wg(["Here is the starting board. Dark plays first.\n        Let's start with moving a single piece:\n        <ol>\n            <li>Click on a piece.</li>\n            <li>Click on a empty neighboring square.</li>\n        </ol>"]))),Uae.getInitialState(),new Fae(0,10,1,1,fte.UP),function(e,t,n){return 1===e.movedPieces?UB.SUCCESS:UB.failure($localize(Qr||(Qr=Wg(["Congratulations, you are in advance. But this is not the exercise here, try again."]))))},$localize(Xr||(Xr=Wg(["This is how you move a single piece."])))),Zte.fromPredicate($localize(Jr||(Jr=Wg(["Moving a phalanx"]))),$localize(ei||(ei=Wg(["Let us now see how to move multiple pieces along a line, which is called a phalanx:\n        <ol>\n            <li>Click on the first piece of the phalanx.</li>\n            <li>Click on the last piece of the phalanx.</li>\n            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>\n        </ol><br/>\n        Move a phalanx!"]))),Uae.getInitialState(),new Fae(0,11,2,1,fte.UP),function(e,t,n){return e.movedPieces>1?UB.SUCCESS:UB.failure($localize(ti||(ti=Wg(["Failed! You moved only one piece."]))))},$localize(ni||(ni=Wg(["Congratulations!\n        The moved pieces can be horizontally, vertically, or diagonally aligned.\n        The move should be made along this axis, forward or backwards.\n        There can be no opponent nor holes in the phalanx."])))),Zte.fromMove($localize(ri||(ri=Wg(["Capture"]))),$localize(ii||(ii=Wg(["In order to capture pieces of the opponent:\n        <ol>\n            <li>It must be aligned with the phalanx you are moving.</li>\n            <li>It must be strictly shorter than your phalanx.</li>\n            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>\n        </ol><br/>\n        Capture a phalanx."]))),new Uae([[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,qae,qae,qae,qae,qae,qae],[$ae,$ae,$ae,$ae,$ae,$ae,qae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,qae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,qae,$ae,qae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,qae,qae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,qae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,Zae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,Zae,$ae,$ae,$ae,$ae,qae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,Zae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,Zae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae,$ae],[$ae,$ae,$ae,$ae,$ae,$ae,$ae,Zae,Zae,Zae,Zae,Zae,Zae,Zae]],0),[new Fae(2,10,4,2,fte.UP)],$localize(ai||(ai=Wg(["Congratulations, you made it!\n        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment."]))),$localize(oi||(oi=Wg(["Failed, you have not captured the phalanx."]))))]});function jae(e,t){if(1&e){var n=AP();NC(),PP(0,"circle",4),RP("click",function(){aC(n);var e=LP().index,t=LP().index;return LP().onClick(e,t)}),SP()}if(2&e){var r=LP().index,i=LP().index,a=LP();EP("ngClass",a.getPieceClasses(r,i)),pP("cx",a.SPACE_SIZE*r+a.STROKE_WIDTH+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i+a.STROKE_WIDTH+a.SPACE_SIZE/2)("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)}}function Yae(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",2),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),SP(),CP(2,jae,1,4,"circle",3),SP()}if(2&e){var r=t.index,i=LP().index,a=LP();BE(1),VP("id","click_",r,"_",i,""),EP("ngClass",a.getRectClasses(r,i)),pP("x",a.SPACE_SIZE*r+a.STROKE_WIDTH)("y",a.SPACE_SIZE*i+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),BE(1),EP("ngIf",a.board[i][r]!==a.NONE)}}function Kae(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Yae,3,8,"g",1),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function Qae(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",5),RP("click",function(){var e=aC(n).$implicit;return LP().onClick(e.x,e.y)}),SP(),SP()}if(2&e){var r=t.$implicit,i=LP();BE(1),pP("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Xae=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).NONE=J7.NONE,r.firstPiece=NB.empty(),r.validExtensions=[],r.phalanxValidLandings=[],r.lastPiece=NB.empty(),r.phalanxDirection=NB.empty(),r.phalanxMiddles=[],r.moveds=[],r.captureds=[],r.hasAsymetricBoard=!0,r.rules=new Bae(Uae),r.availableMinimaxes=[new zae(r.rules,"Normal"),new Hae(r.rules,"Positional"),new Gae(r.rules,"Attack")],r.encoder=Fae.encoder,r.tutorial=(new Wae).tutorial,r.updateBoard(),r}return my(n,[{key:"updateBoard",value:function(){this.firstPiece=NB.empty(),this.lastPiece=NB.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.getState().getCopiedBoard()}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=e.coord;this.moveds=[t];for(var n=1;n<e.stepSize+e.movedPieces;n++)t=t.getNext(e.direction,1),this.moveds.push(t);for(var r=this.rules.node.mother.get(),i=r.gameState.getCurrentOpponent();t.isInRange(14,12)&&r.gameState.getPieceAt(t)===i;)this.captureds.push(t),t=t.getNext(e.direction,1)}},{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=n.getState().getCurrentOpponent(),a=n.getState().getCurrentPlayer(),r.t0=n.board[t][e],r.next=r.t0===a?4:r.t0===i?5:6;break;case 4:return r.abrupt("return",(n.firstPiece=NB.of(new pte(e,t)),n.validExtensions=n.getValidExtensions(a),n.phalanxValidLandings=n.getPhalanxValidLandings(),UB.SUCCESS));case 5:return r.abrupt("return",n.cancelMove(bte.CANNOT_CHOOSE_OPPONENT_PIECE()));case 6:return r.abrupt("return",(IB.expectToBe(n.board[t][e],J7.NONE),n.cancelMove(bte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())));case 7:case"end":return r.stop()}},r)}))()}},{key:"hidePreviousMove",value:function(){this.captureds=[],this.moveds=[]}},{key:"getValidExtensions",value:function(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}},{key:"getFirstPieceExtensions",value:function(e){var t,n=[],r=dy(fte.DIRECTIONS);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.firstPiece.get().getNext(i,1);a.isInRange(14,12)&&this.board[a.y][a.x]===e;)n.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPhalanxValidExtensions",value:function(e){var t=fte.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get(),n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();var i=this.firstPiece.get().getNext(t,1),a=this.getExtensionsToward(i,t,e);return r.concat(a)}},{key:"getExtensionsToward",value:function(e,t,n){for(var r=[];e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}},{key:"getPhalanxValidLandings",value:function(){if(this.lastPiece.isPresent()){var e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1,a=fte.factory.fromMove(e,t).get(),o=t.getNext(a,1),s=this.getLandingsToward(o,a,i);a=a.getOpposite();var u=e.getNext(a,1);return this.getLandingsToward(u,a,i).concat(s)}return this.getNeighboringEmptySpaces()}},{key:"getNeighboringEmptySpaces",value:function(){var e,t=[],n=dy(fte.DIRECTIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.firstPiece.get().getNext(r,1);i.isInRange(14,12)&&this.board[i.y][i.x]===J7.NONE&&t.push(i)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getLandingsToward",value:function(e,t,n){for(var r=this.getState().getCurrentPlayer(),i=this.getState().getCurrentOpponent(),a=[];e.isInRange(14,12)&&a.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&a.push(e),a;a.push(e),e=e.getNext(t,1)}return a}},{key:"getPhalanxLength",value:function(e,t,n){for(var r=0;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}},{key:"cancelMoveAttempt",value:function(){this.firstPiece=NB.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=NB.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}},{key:"secondClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new pte(e,t),a=n.firstPiece.get(),!i.equals(a)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),UB.SUCCESS));case 3:if(o=n.getState().getCurrentOpponent(),s=n.getState().getCurrentPlayer(),i.isAlignedWith(a)){r.next=6;break}return r.abrupt("return",n.cancelMove(Vae.SQUARE_NOT_ALIGNED_WITH_SELECTED()));case 6:u=i.getDistance(a),c=a.getDirectionToward(i).get(),r.t0=n.board[t][e],r.next=r.t0===J7.NONE?10:r.t0===o?11:12;break;case 10:return r.abrupt("return",1===u?n.tryMove(new Fae(a.x,a.y,1,1,c)):n.cancelMove(Vae.SINGLE_PIECE_MUST_MOVE_BY_ONE()));case 11:return r.abrupt("return",n.cancelMove(Vae.SINGLE_PIECE_CANNOT_CAPTURE()));case 12:return IB.expectToBe(n.board[t][e],s),l=new Fae(a.x,a.y,u,1,c),f=n.getState(),h=Bae.getPhalanxValidity(f,l),r.abrupt("return",h.isFailure()?n.cancelMove(h.getReason()):(n.lastPiece=NB.of(i),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=a.getCoordsToward(i),n.phalanxDirection=NB.of(c),UB.SUCCESS));case 15:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.getState().getCurrentPlayer(),a=new pte(e,t),!n.firstPiece.equalsValue(a)){r.next=3;break}return r.abrupt("return",n.moveFirstPiece(i));case 3:if(!n.lastPiece.equalsValue(a)){r.next=5;break}return r.abrupt("return",n.moveLastPiece(i));case 5:if(o=n.firstPiece.get(),s=n.lastPiece.get(),a.isAlignedWith(o)){r.next=8;break}return r.abrupt("return",n.cancelMove(Vae.SQUARE_NOT_ALIGNED_WITH_PHALANX()));case 8:if(u=fte.factory.fromMove(o,s).get(),c=fte.factory.fromMove(o,a).get(),u===c.getOpposite()&&(n.firstPiece=NB.of(s),n.lastPiece=NB.of(o),u=c),u===c){r.next=12;break}return r.abrupt("return",n.cancelMove(Vae.SQUARE_NOT_ALIGNED_WITH_PHALANX()));case 12:if(n.board[t][e]!==i){r.next=14;break}return r.abrupt("return",n.thirdClickOnPlayerPiece(a,u,i));case 14:return l=n.firstPiece.get().getDistance(n.lastPiece.get())+1,f=n.lastPiece.get().getDistance(a),h=new Fae(n.firstPiece.get().x,n.firstPiece.get().y,l,f,u),r.abrupt("return",n.tryMove(h));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClickOnPlayerPiece",value:function(e,t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r.lastPiece=NB.of(e),a=r.firstPiece.get().getDistance(e)+1,o=new Fae(r.firstPiece.get().x,r.firstPiece.get().y,a,1,t),s=Bae.getPhalanxValidity(r.rules.node.gameState,o),i.abrupt("return",s.isFailure()?r.cancelMove(s.getReason()):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getValidExtensions(n),r.phalanxValidLandings=r.getPhalanxValidLandings(),UB.SUCCESS));case 3:case"end":return i.stop()}},i)}))()}},{key:"moveFirstPiece",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.firstPiece=NB.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),!t.firstPiece.equals(t.lastPiece)){n.next=6;break}return n.next=4,t.moveOnlyPiece(e);case 4:n.next=7;break;case 6:t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e);case 7:return t.phalanxValidLandings=t.getPhalanxValidLandings(),n.abrupt("return",UB.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveLastPiece",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=NB.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),UB.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"moveOnlyPiece",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=NB.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=NB.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),UB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e){var t=this.getState();return this.cancelMove(),this.chooseMove(e,t)}},{key:"getPieceClasses",value:function(e,t){var n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}},{key:"getPieceStrokeClasses",value:function(e,t){var n=new pte(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(function(e){return e.equals(n)})?["selected-stroke"]:[]}},{key:"getRectClasses",value:function(e,t){var n=new pte(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured-fill"]:this.moveds.some(function(e){return e.equals(n)})?["moved-fill"]:[]}},{key:"getHighlightedCoords",value:function(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}},{key:"getCurrentPlayerPieces",value:function(){for(var e=[],t=this.getState().getCurrentPlayer(),n=0;n<this.board.length;n++)for(var r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new pte(r,n));return e}}]),n}(Sne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-epaminondas"]],features:[nP],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,Kae,2,1,"g",1),CP(2,Qae,2,4,"g",1),SP()),2&e&&(pP("transform",t.rotation),BE(1),EP("ngForOf",t.board),BE(1),EP("ngForOf",t.getHighlightedCoords()))},directives:[aM,rM,sM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}();function Jae(e){return new(function(t){iy(r,t);var n=oy(r);function r(){return gy(this,r),n.apply(this,arguments)}return my(r,[{key:"encode",value:function(t){return t.isPresent()?e.encode(t.get()):null}},{key:"decode",value:function(t){return null===t?NB.empty():NB.of(e.decode(t))}}]),r}(Y7))}var eoe=function(){function e(t){if(gy(this,e),t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===Fie.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=i9.copyImmutableArray(t).sort(function(e,t){if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate coords");return e.y>t.y?1:-1}return e.x>t.x?1:-1});var n,r=NB.empty(),i=dy(this.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(r.isPresent()&&1!==r.get().getDistance(a))throw new Error("Cannot create a GipfCapture with non-consecutive coords");r=NB.of(a)}}catch(o){i.e(o)}finally{i.f()}}return my(e,[{key:"toString",value:function(){var e,t="",n=dy(this.capturedSpaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;""!==t&&(t+=","),t+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"size",value:function(){return this.capturedSpaces.length}},{key:"forEach",value:function(e){this.capturedSpaces.forEach(e)}},{key:"contains",value:function(e){for(var t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}},{key:"intersectsWith",value:function(e){return this.capturedSpaces.some(function(t){return e.contains(t)})}},{key:"getLine",value:function(){return Fie.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}},{key:"equals",value:function(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(var t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}]),e}();eoe.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"encode",value:function(e){return e.capturedSpaces.map(function(e){return pte.encoder.encode(e)})}},{key:"decode",value:function(e){return new eoe(e.map(function(e){return pte.encoder.decode(e)}))}}]),n}(Y7));var toe=function(){function e(t,n){gy(this,e),this.coord=t,this.direction=n}return my(e,[{key:"toString",value:function(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}},{key:"equals",value:function(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}]),e}();toe.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).optionalDirectionEncoder=Jae(kte.encoder),e}return my(n,[{key:"encode",value:function(e){return{coord:pte.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}},{key:"decode",value:function(e){var t=e;return F7(null!=t.coord,"Invalid encoded GipfPlacement"),new toe(pte.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}}]),n}(Y7));var noe=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this)).placement=e,a.initialCaptures=r,a.finalCaptures=i,a}return my(n,[{key:"toString",value:function(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=dy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"equals",value:function(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===i9.compareArray(this.initialCaptures,e.initialCaptures)||!1===i9.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}]),n}(xte);noe.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"encodeMove",value:function(e){var t={placement:toe.encoder.encode(e.placement)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=eoe.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=eoe.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return F7(null!=t.placement,"Invalid encoded GipfMove"),new noe(toe.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",eoe.encoder.decode),this.decodeArray(t,"finalCapture",eoe.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(K7));var roe=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this,r,e,7,7,[3,2,1],mte.EMPTY)).sidePieces=i,o.capturedPieces=a,o}return my(n,[{key:"equals",value:function(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&i9.compareTable(this.board,e.board)}},{key:"getNumberOfPiecesToPlace",value:function(e){return this.sidePieces[e.value]}},{key:"getNumberOfPiecesCaptured",value:function(e){return this.capturedPieces[e.value]}},{key:"setAtUnsafe",value:function(e,t){var r=i9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.sidePieces,this.capturedPieces)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==mte.UNREACHABLE}}],[{key:"getInitialState",value:function(){var e=mte.EMPTY,t=mte.UNREACHABLE,r=mte.ZERO,i=mte.ONE;return new n([[t,t,t,i,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,r,t,t,t]],0,[12,12],[0,0])}}]),n}(Uie),ioe=function(){var e=my(function e(){gy(this,e)});return e.CAPTURE_MUST_BE_ALIGNED=function(){return $localize(si||(si=Wg(["You can only capture when 4 or more of your pieces are aligned, and it is not the case."])))},e.INVALID_CAPTURED_PIECES=function(){return $localize(ui||(ui=Wg(["You must select a valid capture that contains 4 pieces or more."])))},e.MISSING_CAPTURES=function(){return $localize(ci||(ci=Wg(["There are still possible captures to be done."])))},e.PLACEMENT_NOT_ON_BORDER=function(){return $localize(li||(li=Wg(["Pieces must be inserted in spaces on the edge of the board."])))},e.INVALID_PLACEMENT_DIRECTION=function(){return $localize(fi||(fi=Wg(["You must select a valid placement direction."])))},e.PLACEMENT_WITHOUT_DIRECTION=function(){return $localize(hi||(hi=Wg(["You must select a placement with a direction alongside the insertion space."])))},e.PLACEMENT_ON_COMPLETE_LINE=function(){return $localize(di||(di=Wg(["You cannot place a piece on a complete line."])))},e.AMBIGUOUS_CAPTURE_COORD=function(){return $localize(vi||(vi=Wg(["This piece belongs to two captures. Please select another piece in the capture you'd like to make."])))},e.NO_DIRECTIONS_AVAILABLE=function(){return $localize(pi||(pi=Wg(["You cannot insert a piece here, as all lines are full. Select another space."])))},e}(),aoe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){return new roe(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}},{key:"getPiecesMoved",value:function(e,t,r){var i=n.applyCaptures(t,e);if(r.direction.isAbsent())return[r.coord];var a=r.direction.get(),o=[];o.push(r.coord);for(var s=r.coord.getNext(a);i.isOnBoard(s)&&i.getPieceAt(s)!==mte.EMPTY;)o.push(s),s=s.getNext(a);return F7(i.isOnBoard(s)&&i.getPieceAt(s)===mte.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(s),o}},{key:"isLegal",value:function(e,t){var r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toFailedFallible();var i=n.applyCaptures(e.initialCaptures,t),a=this.noMoreCapturesValidity(i);if(a.isFailure())return a.toFailedFallible();var o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toFailedFallible();var s=n.applyPlacement(e.placement,i),u=this.capturesValidity(s,e.finalCaptures);if(u.isFailure())return u.toFailedFallible();var c=n.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():DB.success(c)}},{key:"capturesValidity",value:function(e,t){var r,i=e,a=dy(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=this.captureValidity(i,o);if(s.isFailure())return s;i=n.applyCapture(o,i)}}catch(u){a.e(u)}finally{a.f()}return UB.SUCCESS}},{key:"captureValidity",value:function(e,t){var r=e.getCurrentPlayer(),i=n.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(i.isAbsent())return UB.failure(ioe.CAPTURE_MUST_BE_ALIGNED());var a=i.get();return n.getCapturable(e,a).equals(t)?UB.SUCCESS:UB.failure(ioe.INVALID_CAPTURED_PIECES())}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===n.getLinePortionsWithFourPiecesOfPlayer(e,t).length?UB.SUCCESS:UB.failure(ioe.MISSING_CAPTURES())}},{key:"placementValidity",value:function(e,t){var r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==mte.EMPTY){if(t.direction.isAbsent())return UB.failure(ioe.PLACEMENT_WITHOUT_DIRECTION());if(n.isLineComplete(e,t.coord,t.direction.get()))return UB.failure(ioe.PLACEMENT_ON_COMPLETE_LINE());var i,a=dy(n.getAllDirectionsForEntrance(e,t.coord));try{for(a.s();!(i=a.n()).done;){if(i.value===t.direction.get())return UB.SUCCESS}}catch(o){a.e(o)}finally{a.f()}return UB.failure(ioe.INVALID_PLACEMENT_DIRECTION())}return UB.SUCCESS}},{key:"placementCoordValidity",value:function(e,t){return Ete.INSTANCE.isOnBorder(e,t)?UB.SUCCESS:UB.failure(ioe.PLACEMENT_NOT_ON_BORDER())}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getPlayerScore(t,e9.ZERO),i=n.getPlayerScore(t,e9.ONE);return r.isAbsent()?Bte.ONE_WON:i.isAbsent()?Bte.ZERO_WON:Bte.ONGOING}}],[{key:"applyCaptures",value:function(e,t){var r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=[t.sidePieces[0],t.sidePieces[1]],a=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(function(e){var o=t.getPieceAt(e);r=r.setAt(e,mte.EMPTY),o.is(n)?i[n.value]+=1:a[n.value]+=1}),new roe(r.board,t.turn,i,a)}},{key:"getPlacements",value:function(e){var t=[];return Ete.INSTANCE.getAllBorders(e).forEach(function(r){e.getPieceAt(r)===mte.EMPTY?t.push(new toe(r,NB.empty())):n.getAllDirectionsForEntrance(e,r).forEach(function(i){!1===n.isLineComplete(e,r,i)&&t.push(new toe(r,NB.of(i)))})}),t}},{key:"isLineComplete",value:function(e,t,r){return n.nextGapInLine(e,t,r).isAbsent()}},{key:"nextGapInLine",value:function(e,t,n){for(var r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===mte.EMPTY)return NB.of(r);return NB.empty()}},{key:"applyPlacement",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=mte.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){var a=e.coord;if(t.getPieceAt(a)!==mte.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(a,i)}else for(var o=e.coord;r.isOnBoard(o)&&i!==mte.EMPTY;o=o.getNext(e.direction.get())){var s=t.getPieceAt(o);r=r.setAt(o,i),i=s}var u=[t.sidePieces[0],t.sidePieces[1]];return u[n.value]-=1,new roe(r.board,t.turn,u,t.capturedPieces)}},{key:"getAllDirectionsForEntrance",value:function(e,t){if(Ete.INSTANCE.isTopLeftCorner(e,t))return[kte.RIGHT,kte.DOWN,kte.UP_RIGHT];if(Ete.INSTANCE.isTopCorner(e,t))return[kte.DOWN,kte.DOWN_LEFT,kte.RIGHT];if(Ete.INSTANCE.isTopRightCorner(e,t))return[kte.DOWN_LEFT,kte.DOWN,kte.LEFT];if(Ete.INSTANCE.isBottomLeftCorner(e,t))return[kte.UP_RIGHT,kte.UP,kte.RIGHT];if(Ete.INSTANCE.isBottomCorner(e,t))return[kte.UP,kte.LEFT,kte.UP_RIGHT];if(Ete.INSTANCE.isBottomRightCorner(e,t))return[kte.LEFT,kte.UP,kte.DOWN_LEFT];if(Ete.INSTANCE.isOnTopLeftBorder(e,t))return[kte.RIGHT,kte.DOWN];if(Ete.INSTANCE.isOnLeftBorder(e,t))return[kte.UP_RIGHT,kte.RIGHT];if(Ete.INSTANCE.isOnBottomLeftBorder(e,t))return[kte.UP,kte.UP_RIGHT];if(Ete.INSTANCE.isOnBottomRightBorder(e,t))return[kte.LEFT,kte.UP];if(Ete.INSTANCE.isOnRightBorder(e,t))return[kte.LEFT,kte.DOWN_LEFT];if(Ete.INSTANCE.isOnTopRightBorder(e,t))return[kte.DOWN_LEFT,kte.DOWN];throw new Error("not a border")}},{key:"getLinePortionsWithFourPiecesOfPlayer",value:function(e,t){var r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithFourPiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithFourPiecesOfPlayer",value:function(e,t,n){for(var r=0,i=e.getEntranceOnLine(n),a=n.getDirection(),o=i,s=i;e.isOnBoard(s);s=s.getNext(a))if(e.getPieceAt(s).is(t)?(0===r&&(o=s),r+=1):r=0,4===r)return NB.of({0:o,1:s,2:a});return NB.empty()}},{key:"getCapturable",value:function(e,t){for(var n=[],r=t[0],i=t[1],a=t[2],o=a.getOpposite(),s=r.getNext(o);e.isOnBoard(s)&&e.getPieceAt(s)!==mte.EMPTY;)n.push(s),s=s.getNext(o);for(var u=r;!u.equals(i);u=u.getNext(a))n.push(u);for(var c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==mte.EMPTY;c=c.getNext(a))n.push(c);return new eoe(n)}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),r=[];return n.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(function(t){r.push(n.getCapturable(e,t))}),r}},{key:"getPlayerScore",value:function(e,t){var r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===n.getPossibleCaptures(e).length)return NB.empty();var i=e.getNumberOfPiecesCaptured(t);return NB.of(r+3*i)}},{key:"isGameOver",value:function(e){var t=n.getPlayerScore(e,e9.ZERO),r=n.getPlayerScore(e,e9.ONE);return t.isAbsent()||r.isAbsent()}}]),n}(zte),ooe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getBoardValue",value:function(e){var t=e.gameState,n=aoe.getPlayerScore(t,e9.ZERO),r=aoe.getPlayerScore(t,e9.ONE);return n.isAbsent()?new Ste(e9.ONE.getVictoryValue()):r.isAbsent()?new Ste(e9.ZERO.getVictoryValue()):new Ste(n.get()-r.get())}},{key:"getListMoves",value:function(e){return this.getListMoveFromState(e.gameState)}},{key:"getListMoveFromState",value:function(e){var t=this,n=[];return aoe.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(function(r){var i=aoe.applyCaptures(r,e);aoe.getPlacements(i).forEach(function(e){var a=aoe.applyPlacement(e,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new noe(e,r,t);n.push(i)})})}),n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=aoe.getPossibleCaptures(e);return n.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}],[{key:"getPossibleCaptureCombinationsFromPossibleCaptures",value:function(e){var t=n.computeIntersections(e),r=[[]];return e.forEach(function(e,n){if(0===t[n].length)r.forEach(function(e){e.push(n)});else{var i,a=[],o=t[n].some(function(e){return e>n}),s=dy(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;!0===u.some(function(e){return t[n].some(function(t){return e===t})})?a.push(i9.copyImmutableArray(u)):o?(a.push(i9.copyImmutableArray(u)),u.push(n),a.push(i9.copyImmutableArray(u))):(u.push(n),a.push(i9.copyImmutableArray(u)))}}catch(c){s.e(c)}finally{s.f()}r=a}}),r.map(function(t){return t.map(function(t){return e[t]})})}},{key:"computeIntersections",value:function(e){var t=[];return e.forEach(function(n,r){t.push([]),e.forEach(function(e,i){r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}}]),n}(Pte),soe=my(function e(t,n,r,i,a,o){gy(this,e),this.source=t,this.destination=n,this.x1=r,this.y1=i,this.x2=a,this.y2=o}),uoe=mte.UNREACHABLE,coe=mte.EMPTY,loe=mte.ZERO,foe=mte.ONE,hoe=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(gi||(gi=Wg(["Goal of the game"]))),$localize(yi||(yi=Wg(["The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.\n        This is the initial board.\n        Each player has 12 pieces on the side and 3 pieces on the board.\n        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.\n        The first player plays with the dark pieces, the second player plays with the light pieces."]))),roe.getInitialState()),Zte.anyMove($localize(mi||(mi=Wg(["Pushing"]))),$localize(ki||(ki=Wg(["Pieces can only enter the board through the edges. To insert a new piece:\n        <ol>\n            <li>Click on a space on the edge of the board.</li>\n            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>\n        </ol>\n        You cannot push when a line is full.<br/><br/>\n        You're playing Dark, insert a piece."]))),roe.getInitialState(),new noe(new toe(new pte(3,0),NB.of(kte.DOWN)),[],[]),$localize(Ci||(Ci=Wg(["Congratulations!"])))),Zte.fromMove($localize(wi||(wi=Wg(["Capture (1/3)"]))),$localize(_i||(_i=Wg(["To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.\n        There are multiple important aspects of a capture:\n        <ol>\n            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>\n            <li>As soon as there is an empty space on the line, the capture stops.</li>\n            <li>Your own pieces that are captured go back to your stock.\n                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>\n            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.\n                This means that a turn happens in three phases:\n                <ol type=\"A\">\n                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>\n                    <li>Make your insertion.</li>\n                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>\n                </ol>\n            </li>\n        </ol><br/>\n        You're playing Dark, you can make a capture, do it."]))),new roe([[uoe,uoe,uoe,loe,foe,coe,coe],[uoe,uoe,coe,coe,coe,coe,coe],[uoe,coe,coe,coe,coe,coe,coe],[loe,loe,loe,coe,coe,coe,coe],[foe,coe,coe,coe,coe,coe,uoe],[coe,coe,coe,foe,coe,uoe,uoe],[coe,coe,coe,foe,uoe,uoe,uoe]],42,[8,8],[0,0]),[new noe(new toe(new pte(0,3),NB.of(kte.RIGHT)),[],[new eoe([new pte(0,3),new pte(1,3),new pte(2,3),new pte(3,3)])])],$localize(Ei||(Ei=Wg(["Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.\n        Let's now see how captures can really be useful."]))),$localize(bi||(bi=Wg(["Failed!"])))),Zte.fromMove($localize(Pi||(Pi=Wg(["Capture (2/3)"]))),$localize(Si||(Si=Wg(["Here, there are three different ways of capturing.\n        <ol>\n          <li>One way does not capture any of your opponent's pieces.</li>\n          <li>Another way captures one of your opponent's pieces.</li>\n          <li>The last way captures two of your opponent's pieces.</li>\n        </ol>\n        <br/><br/>\n        Pick the last one."]))),new roe([[uoe,uoe,uoe,coe,coe,coe,coe],[uoe,uoe,coe,foe,coe,coe,coe],[uoe,coe,coe,loe,coe,coe,coe],[loe,loe,loe,foe,coe,coe,coe],[coe,coe,coe,loe,coe,coe,uoe],[coe,coe,coe,loe,coe,uoe,uoe],[coe,coe,coe,foe,uoe,uoe,uoe]],42,[8,4],[2,3]),[new noe(new toe(new pte(0,3),NB.of(kte.RIGHT)),[],[new eoe([new pte(3,1),new pte(3,2),new pte(3,3),new pte(3,4),new pte(3,5),new pte(3,6)])])],$localize(Oi||(Oi=Wg(["Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.\n        The most you can get is 3 per capture."]))),$localize(Ti||(Ti=Wg(["Failed, the best capture was taking 2 of your opponent's pieces"])))),Zte.fromMove($localize(Ii||(Ii=Wg(["Capture (3/3)"]))),$localize(Ai||(Ai=Wg(["Here, you must capture at the beginning of your turn.\n        This is due to a move of your opponent at the previous turn\n        (even though this is a fictitious board for pedagogical purpose).\n        After your capture, by performing the right move you can even capture two more of your opponent's pieces!\n        Keep it mind that the most useful in a capture is to take your opponent's pieces."]))),new roe([[uoe,uoe,uoe,loe,coe,coe,loe],[uoe,uoe,coe,loe,coe,coe,loe],[uoe,loe,loe,coe,loe,foe,loe],[coe,coe,coe,loe,coe,coe,loe],[coe,coe,coe,loe,coe,coe,uoe],[loe,loe,loe,foe,foe,uoe,uoe],[coe,coe,coe,loe,uoe,uoe,uoe]],42,[8,4],[2,3]),[new noe(new toe(new pte(3,6),NB.of(kte.UP)),[new eoe([new pte(6,0),new pte(6,1),new pte(6,2),new pte(6,3)])],[new eoe([new pte(0,5),new pte(1,5),new pte(2,5),new pte(3,5),new pte(4,5)]),new eoe([new pte(1,2),new pte(2,2),new pte(3,2),new pte(4,2),new pte(5,2)])]),new noe(new toe(new pte(4,6),NB.of(kte.UP)),[new eoe([new pte(6,0),new pte(6,1),new pte(6,2),new pte(6,3)])],[new eoe([new pte(0,5),new pte(1,5),new pte(2,5),new pte(3,5),new pte(4,5)]),new eoe([new pte(3,0),new pte(3,1),new pte(3,2),new pte(3,3),new pte(3,4)])]),new noe(new toe(new pte(3,6),NB.of(kte.UP)),[new eoe([new pte(6,0),new pte(6,1),new pte(6,2),new pte(6,3)])],[new eoe([new pte(1,2),new pte(2,2),new pte(3,2),new pte(4,2),new pte(5,2)]),new eoe([new pte(0,5),new pte(1,5),new pte(2,5),new pte(3,5),new pte(4,5)])])],$localize(Mi||(Mi=Wg(["Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces."]))),$localize(xi||(xi=Wg(["Failed, the best capture takes 2 of your opponent's pieces."]))))]});function doe(e,t){if(1&e&&(NC(),OP(0,"circle",13)),2&e){var n=LP().$implicit,r=LP();EP("ngClass",r.getPieceClass(n)),pP("cx",r.getCenterAt(n).x)("cy",r.getCenterAt(n).y)("r",r.SPACE_SIZE)}}function voe(e,t){if(1&e){var n=AP();NC(),PP(0,"g",10),RP("click",function(){var e=aC(n).$implicit;return LP().onClick(e)}),OP(1,"polygon",11),CP(2,doe,1,4,"circle",12),SP()}if(2&e){var r=t.$implicit,i=LP();VP("id","click_",r.x,"_",r.y,""),BE(1),VP("id","space_",r.x,"_",r.y,""),EP("ngClass",i.getSpaceClass(r)),pP("points",i.getHexaCoordsAt(r)),BE(1),EP("ngIf",i.isPiece(r))}}function poe(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",16),RP("click",function(){var e=aC(n).$implicit;return LP(2).onClick(e)}),SP()}if(2&e){var r=t.$implicit;pP("points",LP(2).getHexaCoordsAt(r))}}function goe(e,t){if(1&e&&(NC(),PP(0,"g",14),CP(1,poe,1,1,"polygon",15),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n.capturedSpaces)}}function yoe(e,t){if(1&e){var n=AP();NC(),PP(0,"line",17),RP("click",function(){var e=aC(n).$implicit;return LP().onClick(e.destination)}),SP()}if(2&e){var r=t.$implicit;pP("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)}}function moe(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"circle",18),SP()),2&e){var n=t.$implicit,r=LP().$implicit,i=LP();BE(1),VP("id","piece_",r.value,"_",n,""),EP("ngClass",i.getPlayerClass(r)),pP("cx",i.getRemainingPieceCx(r,n))("cy",i.getRemainingPieceCy(r))("r",.5*i.SPACE_SIZE)}}function koe(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,moe,2,6,"g",8),SP()),2&e){var n=t.$implicit,r=LP();BE(1),EP("ngForOf",r.getPlayerSidePieces(n))}}function Coe(e,t){if(1&e&&(NC(),OP(0,"line",19)),2&e){var n=LP();pP("x1",n.inserted.get().x1)("y1",n.inserted.get().y1)("x2",n.inserted.get().x2)("y2",n.inserted.get().y2)}}var woe=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).inserted=NB.empty(),r.arrows=[],r.captured=[],r.moved=[],r.HEXAGON_WIDTH=r.SPACE_SIZE,r.SHARED_HEXAGON_X=Math.cos(30)*r.HEXAGON_WIDTH*.5,r.BOARD_WIDTH=r.HEXAGON_WIDTH+6*(r.HEXAGON_WIDTH-r.SHARED_HEXAGON_X)+3*r.STROKE_WIDTH/2,r.BOARD_HEIGHT=7*r.HEXAGON_WIDTH+4.5*r.STROKE_WIDTH,r.movePhase=n.PHASE_PLACEMENT_COORD,r.possibleCaptures=[],r.initialCaptures=[],r.placement=NB.empty(),r.placementEntrance=NB.empty(),r.finalCaptures=[],r.hasAsymetricBoard=!0,r.scores=NB.of([0,0]),r.rules=new aoe(roe),r.availableMinimaxes=[new ooe(r.rules,"GipfMinimax")],r.encoder=noe.encoder,r.tutorial=(new hoe).tutorial,r.SPACE_SIZE=40,r.constructedState=r.getState(),r.hexaLayout=new Cte(1.5*r.SPACE_SIZE,new pte(r.HEXAGON_WIDTH/2+3*r.STROKE_WIDTH/4,-r.HEXAGON_WIDTH),Ete.INSTANCE),r}return my(n,[{key:"updateBoard",value:function(){this.showLastMove(),this.cancelMoveAttempt()}},{key:"showLastMove",value:function(){this.inserted=NB.empty();var e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){var t=e.get().placement;this.inserted=NB.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}},{key:"arrowTowards",value:function(e,t){var n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new soe(n,e,i.x,i.y,r.x,r.y)}},{key:"markCapture",value:function(e){var t=this;e.forEach(function(e){t.captured.push(e)})}},{key:"getAllCoords",value:function(){return this.constructedState.allCoords()}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.constructedState.getNumberOfPiecesToPlace(e),n=[],r=0;r<t;r+=1)n.push(r);return n}},{key:"isPiece",value:function(e){return this.getPiece(e)!==mte.EMPTY}},{key:"getPiece",value:function(e){return this.constructedState.getPieceAt(e)}},{key:"onClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){r.next=3;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 3:r.t0=t.movePhase,r.next=r.t0===n.PHASE_INITIAL_CAPTURE||r.t0===n.PHASE_FINAL_CAPTURE?6:r.t0===n.PHASE_PLACEMENT_COORD?7:8;break;case 6:return r.abrupt("return",t.selectCapture(e));case 7:return r.abrupt("return",t.selectPlacementCoord(e));case 8:return r.abrupt("return",(IB.expectToBe(t.movePhase,n.PHASE_PLACEMENT_DIRECTION),t.selectPlacementDirectionOrPlacementCoord(e)));case 9:case"end":return r.stop()}},r)}))()}},{key:"selectCapture",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&i.push(t)}),!(i.length>1)){r.next=3;break}return r.abrupt("return",t.cancelMove(ioe.AMBIGUOUS_CAPTURE_COORD()));case 3:if(0!==i.length){r.next=5;break}return r.abrupt("return",t.cancelMove(ioe.MISSING_CAPTURES()));case 5:return a=i[0],r.abrupt("return",(t.constructedState=aoe.applyCapture(a,t.constructedState),t.markCapture(a),t.possibleCaptures=aoe.getPossibleCaptures(t.constructedState),t.movePhase===n.PHASE_INITIAL_CAPTURE?(t.initialCaptures.push(a),0===t.possibleCaptures.length?t.moveToPlacementPhase():UB.SUCCESS):(IB.expectToBe(t.movePhase,n.PHASE_FINAL_CAPTURE),t.finalCaptures.push(a),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):UB.SUCCESS)));case 7:case"end":return r.stop()}},r)}))()}},{key:"moveToPlacementPhase",value:function(){return this.movePhase=n.PHASE_PLACEMENT_COORD,UB.SUCCESS}},{key:"moveToInitialCaptureOrPlacementPhase",value:function(){return this.possibleCaptures=aoe.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,UB.SUCCESS}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=aoe.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,UB.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}},{key:"computeArrows",value:function(e){this.arrows=[];var t,n=dy(aoe.getAllDirectionsForEntrance(this.constructedState,e));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===aoe.isLineComplete(this.constructedState,e,r)){var i=e.getNext(r),a=this.getCenterAt(e),o=this.getCenterAt(i);this.arrows.push(new soe(e,i,a.x,a.y,o.x,o.y))}}}catch(s){n.e(s)}finally{n.f()}}},{key:"selectPlacementCoord",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.rules.placementCoordValidity(t.constructedState,e),r.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):t.placementEntrance.equalsValue(e)?(t.cancelMoveAttempt(),UB.SUCCESS):(t.placementEntrance=NB.of(e),t.constructedState.getPieceAt(e)===mte.EMPTY?t.selectPlacementDirection(NB.empty()):(t.movePhase=n.PHASE_PLACEMENT_DIRECTION,t.computeArrows(e),0===t.arrows.length&&t.cancelMove(ioe.NO_DIRECTIONS_AVAILABLE()),UB.SUCCESS)));case 2:case"end":return r.stop()}},r)}))()}},{key:"selectPlacementDirection",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.placement=NB.of(new toe(t.placementEntrance.get(),e)),r=t.rules.placementValidity(t.constructedState,t.placement.get()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.arrows=[],t.constructedState=aoe.applyPlacement(t.placement.get(),t.constructedState),t.moveToFinalCapturePhaseOrTryMove()));case 3:case"end":return n.stop()}},n)}))()}},{key:"selectPlacementDirectionOrPlacementCoord",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!1!==(r=t.placementEntrance.get()).isAlignedWith(e)&&1===r.getDistance(e)){n.next=3;break}return n.abrupt("return",t.selectPlacementCoord(e));case 3:return i=kte.factory.fromMove(r,e),n.abrupt("return",t.selectPlacementDirection(i.toOptional()));case 5:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=new noe(t,e,n),i.next=3,r.chooseMove(a,r.getState(),r.scores.get());case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"cancelMoveAttempt",value:function(){var e=this;this.constructedState=this.getState(),this.captured=[],this.moved=[];var t=this.rules.node.move;if(t.isPresent()){var n=t.get(),r=this.rules.node.mother.get().gameState;n.initialCaptures.forEach(function(t){return e.markCapture(t)}),n.finalCaptures.forEach(function(t){return e.markCapture(t)}),this.moved=this.rules.getPiecesMoved(r,n.initialCaptures,n.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=NB.empty(),this.placement=NB.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}},{key:"getSpaceClass",value:function(e){return this.captured.some(function(t){return t.equals(e)})?"captured-fill":this.moved.some(function(t){return t.equals(e)})?"moved-fill":""}},{key:"getPieceClass",value:function(e){var t=this.getPiece(e);return this.getPlayerClass(e9.of(t.value))}},{key:"getRemainingPieceCy",value:function(e){return e===e9.ONE?25:this.BOARD_HEIGHT-25}},{key:"getRemainingPieceCx",value:function(e,t){var n=20+t*this.SPACE_SIZE*.5;return e===e9.ONE?n:this.BOARD_WIDTH-(15+n)}}]),n}(yte);return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-gipf"]],features:[nP],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),PP(1,"defs"),PP(2,"marker",1),OP(3,"polygon",2),SP(),PP(4,"marker",3),OP(5,"polygon",4),SP(),SP(),CP(6,voe,3,7,"g",5),CP(7,goe,2,1,"g",6),CP(8,yoe,1,4,"line",7),CP(9,koe,2,1,"g",8),CP(10,Coe,1,4,"line",9),SP()),2&e&&(pP("viewBox",-t.STROKE_WIDTH+" 0 "+t.BOARD_WIDTH+" "+t.BOARD_HEIGHT)("transform",t.rotation),BE(6),EP("ngForOf",t.getAllCoords()),BE(1),EP("ngForOf",t.possibleCaptures),BE(1),EP("ngForOf",t.arrows),BE(1),EP("ngForOf",t.Player.PLAYERS),BE(1),EP("ngIf",t.inserted.isPresent()))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),_oe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"equals",value:function(e){return this===e||this.coord.equals(e.coord)}},{key:"toString",value:function(){return this===n.PASS?"GoMove.PASS":this===n.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Rte);_oe.PASS=new _oe(-1,0),_oe.ACCEPT=new _oe(-2,0),_oe.PASS_NUMBER=-1,_oe.ACCEPT_NUMBER=-2,_oe.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 360}},{key:"encodeNumber",value:function(e){return 19*e.coord.y+e.coord.x}},{key:"decodeNumber",value:function(e){if(e===_oe.PASS_NUMBER)return _oe.PASS;var t=e%19;return new _oe(t,(e-t)/19)}}]),n}(Q7));var Eoe=function(){function e(t,n){gy(this,e),this.player=t,this.type=n}return my(e,[{key:"equals",value:function(e){return e===this}},{key:"toString",value:function(){switch(this){case e.DARK:return"GoPiece.DARK";case e.LIGHT:return"GoPiece.LIGHT";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_DARK:return"GoPiece.DEAD_DARK";case e.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case e.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return F7(this===e.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}},{key:"isOccupied",value:function(){return[e.DARK,e.LIGHT,e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isEmpty",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY,e.EMPTY].includes(this)}},{key:"isDead",value:function(){return[e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isTerritory",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY].includes(this)}},{key:"getOwner",value:function(){return this.player}},{key:"nonTerritory",value:function(){return F7(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}],[{key:"pieceBelongTo",value:function(e,t){return t===e.player&&"territory"!==e.type}},{key:"ofPlayer",value:function(t){return t===e9.ZERO?e.DARK:e.LIGHT}}]),e}();Eoe.DARK=new Eoe(e9.ZERO,"alive"),Eoe.LIGHT=new Eoe(e9.ONE,"alive"),Eoe.EMPTY=new Eoe(J7.NONE,"empty"),Eoe.DEAD_DARK=new Eoe(e9.ZERO,"dead"),Eoe.DEAD_LIGHT=new Eoe(e9.ONE,"dead"),Eoe.DARK_TERRITORY=new Eoe(J7.NONE,"territory"),Eoe.LIGHT_TERRITORY=new Eoe(J7.NONE,"territory");var boe=(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(boe||(boe={})),boe),Poe=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o){var s;return gy(this,n),(s=t.call(this,e,i)).captured=r,s.koCoord=a,s.phase=o,s}return my(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}},{key:"copy",value:function(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}},{key:"isDead",value:function(e){return this.getPieceAt(e).isDead()}},{key:"isTerritory",value:function(e){return this.getPieceAt(e).isTerritory()}}],[{key:"getInitialState",value:function(){var e=n.getStartingBoard();return new n(e,[0,0],0,NB.empty(),boe.PLAYING)}},{key:"getStartingBoard",value:function(){return i9.createTable(n.WIDTH,n.HEIGHT,Eoe.EMPTY)}}]),n}(Ate);return e.WIDTH=13,e.HEIGHT=13,e}(),Soe=function(){var e=function(){function e(t){gy(this,e),this.color=t}return my(e,[{key:"selfContains",value:function(e){return this.getCoords().some(function(t){return t.equals(e)})}}],[{key:"insertAsEntryPoint",value:function(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}]),e}();return e.VERBOSE=!1,e}(),Ooe=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s){var u;return gy(this,n),(u=t.call(this,e)).emptyCoords=r,u.darkCoords=i,u.lightCoords=a,u.deadDarkCoords=o,u.deadLightCoords=s,u}return my(n,[{key:"getCoords",value:function(){return this.color===Eoe.DARK?this.darkCoords:this.color===Eoe.LIGHT?this.lightCoords:this.color===Eoe.DEAD_DARK?this.deadDarkCoords:this.color===Eoe.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}},{key:"contains",value:function(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(function(t){return t.equals(e)})}},{key:"addPawn",value:function(e,t){switch(F7(!1===this.contains(e),"This group already contains "+e.toString()),t){case Eoe.DARK:this.darkCoords=Soe.insertAsEntryPoint(this.darkCoords,e);break;case Eoe.LIGHT:this.lightCoords=Soe.insertAsEntryPoint(this.lightCoords,e);break;case Eoe.DEAD_DARK:this.deadDarkCoords=Soe.insertAsEntryPoint(this.deadDarkCoords,e);break;case Eoe.DEAD_LIGHT:this.deadLightCoords=Soe.insertAsEntryPoint(this.deadLightCoords,e);break;default:IB.expectToBeMultiple(t,[Eoe.EMPTY,Eoe.DARK_TERRITORY,Eoe.LIGHT_TERRITORY]),this.emptyCoords=Soe.insertAsEntryPoint(this.emptyCoords,e)}}},{key:"isMonoWrapped",value:function(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}},{key:"getWrapper",value:function(){var e=new Lte;e.set(Eoe.EMPTY,this.emptyCoords.length),e.set(Eoe.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(Eoe.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);var t=e.filter(function(e,t){return t>0});if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}},{key:"getNeighborsEntryPoints",value:function(){var e=[];return this.color!==Eoe.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==Eoe.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==Eoe.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==Eoe.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==Eoe.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}]),n}(Soe),Toe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getNewInstance",value:function(e){return new Ooe(e,[],[],[],[],[])}},{key:"getDirections",value:function(){return hte.ORTHOGONALS}}]),n}(function(){function e(){gy(this,e)}return my(e,[{key:"getGroupDatas",value:function(e,t){AB(Soe.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");var n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}},{key:"_getGroupDatas",value:function(e,t,n){AB(Soe.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});var r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color){var i,a=dy(this.getDirections());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getNext(o);s.isInRange(t[0].length,t.length)&&(n.contains(s)||(n=this._getGroupDatas(s,t,n)))}}catch(u){a.e(u)}finally{a.f()}}return n}}]),e}()),Ioe=function(){var e=my(function e(){gy(this,e)});return e.ILLEGAL_KO=function(){return $localize(Ri||(Ri=Wg(["This move is a ko, you must play somewhere else before you can play in this intersection again."])))},e.CANNOT_PASS_AFTER_PASSED_PHASE=function(){return $localize(Ni||(Ni=Wg(["We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn."])))},e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=function(){return $localize(Di||(Di=Wg(["You cannot accept before the counting phase."])))},e.OCCUPIED_INTERSECTION=function(){return $localize(Li||(Li=Wg(["This intersection is already occupied."])))},e.CANNOT_COMMIT_SUICIDE=function(){return $localize(Fi||(Fi=Wg(["You cannot commit suicide."])))},e}(),Aoe=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,r){return AB(n.VERBOSE,{applyLegalMove:{legalMove:e,state:t,status:r}}),n.isPass(e)?(AB(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(t)):n.isAccept(e)?(AB(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(t)):n.isLegalDeadMarking(e,t)?(AB(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,t)):(AB(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,t,r))}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=!1;if(AB(n.VERBOSE||r,{isLegal:{move:e,state:t}}),n.isPass(e)){var i=t.phase===boe.PLAYING,a=t.phase===boe.PASSED;return AB(n.VERBOSE||r,"GoRules.isLegal at "+t.phase+(i||a?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),i||a?DB.success([]):DB.failure(Ioe.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){var o=t.phase===boe.ACCEPT;return t.phase===boe.COUNTING||o?DB.success([]):DB.failure(Ioe.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,t.getCopiedBoard())?(AB(n.VERBOSE||r,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,t)?DB.success([]):DB.failure(Ioe.OCCUPIED_INTERSECTION())):(AB(n.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,t))}},{key:"getNewKo",value:function(e,t,n){if(1===n.length){var r=n[0],i=e.coord,a=t[i.y][i.x],o=(new Toe).getGroupDatas(i,t),s=o.emptyCoords,u=Eoe.pieceBelongTo(a,e9.ZERO)?o.darkCoords:o.lightCoords;if(1===s.length&&s[0].equals(r)&&1===u.length)return NB.of(r)}return NB.empty()}},{key:"markTerritoryAndCount",value:function(e){AB(n.VERBOSE,{markTerritoryAndCount:{state:e}});var t,r=e.getCopiedBoard(),i=n.getTerritoryLikeGroup(e),a=e.getCapturedCopy(),o=dy(i);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.getWrapper();if(u===Eoe.LIGHT){a[1]+=s.emptyCoords.length;var c,l=dy(s.getCoords());try{for(l.s();!(c=l.n()).done;){var f=c.value;r[f.y][f.x]=Eoe.LIGHT_TERRITORY}}catch(p){l.e(p)}finally{l.f()}}else{F7(u===Eoe.DARK,"territory should be wrapped by dark or light, not by "+u.toString()),a[0]+=s.emptyCoords.length;var h,d=dy(s.getCoords());try{for(d.s();!(h=d.n()).done;){var v=h.value;r[v.y][v.x]=Eoe.DARK_TERRITORY}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){o.e(p)}finally{o.f()}return new Poe(r,a,e.turn,e.koCoord,e.phase)}},{key:"removeAndSubstractTerritory",value:function(e){for(var t,n=e.getCopiedBoard(),r=e.getCapturedCopy(),i=0;i<e.board.length;i++)for(var a=0;a<e.board[0].length;a++)(t=n[i][a])===Eoe.DARK_TERRITORY?(n[i][a]=Eoe.EMPTY,r[0]=r[0]-1):t===Eoe.LIGHT_TERRITORY&&(n[i][a]=Eoe.EMPTY,r[1]=r[1]-1);return new Poe(n,r,e.turn,e.koCoord,e.phase)}},{key:"getEmptyZones",value:function(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),function(e){return e.isEmpty()})}},{key:"getGroupsDatasWhere",value:function(e,t){for(var n,r,i=[],a=new Toe,o=0;o<e.length;o++)for(var s=0;s<e[0].length;s++)n=new pte(s,o),t(e[o][s])&&(i.some(function(e){return e.selfContains(n)})||(r=a.getGroupDatas(n,e),i.push(r)));return i}},{key:"addDeadToScore",value:function(e){for(var t,n=e.getCapturedCopy(),r=n[1],i=n[0],a=0;a<e.board.length;a++)for(var o=0;o<e.board[0].length;o++)(t=e.getPieceAtXY(o,a))===Eoe.DEAD_DARK?r++:t===Eoe.DEAD_LIGHT&&i++;return[i,r]}},{key:"switchAliveness",value:function(e,t){var n=t.getCopiedBoard();F7(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");var r=(new Toe).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case Eoe.DEAD_DARK:i[1]-=2*r.deadDarkCoords.length;var a,o=dy(r.deadDarkCoords);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s.y][s.x]=Eoe.DARK}}catch(y){o.e(y)}finally{o.f()}break;case Eoe.DEAD_LIGHT:i[0]-=2*r.deadLightCoords.length;var u,c=dy(r.deadLightCoords);try{for(c.s();!(u=c.n()).done;){var l=u.value;n[l.y][l.x]=Eoe.LIGHT}}catch(y){c.e(y)}finally{c.f()}break;case Eoe.LIGHT:i[0]+=2*r.lightCoords.length;var f,h=dy(r.lightCoords);try{for(h.s();!(f=h.n()).done;){var d=f.value;n[d.y][d.x]=Eoe.DEAD_LIGHT}}catch(y){h.e(y)}finally{h.f()}break;default:IB.expectToBe(r.color,Eoe.DARK),i[1]+=2*r.darkCoords.length;var v,p=dy(r.darkCoords);try{for(p.s();!(v=p.n()).done;){var g=v.value;n[g.y][g.x]=Eoe.DEAD_DARK}}catch(y){p.e(y)}finally{p.f()}}return new Poe(n,i,t.turn,t.koCoord,t.phase)}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.phase===boe.FINISHED?t.captured[0]>t.captured[1]?Bte.ZERO_WON:t.captured[1]>t.captured[0]?Bte.ONE_WON:Bte.DRAW:Bte.ONGOING}},{key:"isPass",value:function(e){return e.equals(_oe.PASS)}},{key:"isAccept",value:function(e){return e.equals(_oe.ACCEPT)}},{key:"isLegalDeadMarking",value:function(e,t){return n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===boe.COUNTING||t.phase===boe.ACCEPT)}},{key:"isLegalNormalMove",value:function(e,t){var r=t.getCopiedBoard();if(n.isKo(e,t))return DB.failure(Ioe.ILLEGAL_KO());[boe.COUNTING,boe.ACCEPT].includes(t.phase)&&(t=n.resurrectStones(t));var i=n.getCaptureState(e,t);if(Moe.isCapturing(i))return DB.success(i.capturedCoords);r[e.coord.y][e.coord.x]=t.turn%2==0?Eoe.DARK:Eoe.LIGHT;var a=0===(new Toe).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=Eoe.EMPTY,a?DB.failure(Ioe.CANNOT_COMMIT_SUICIDE()):DB.success([])}},{key:"isOccupied",value:function(e,t){return t[e.y][e.x].isOccupied()}},{key:"isKo",value:function(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}},{key:"getCaptureState",value:function(e,t){AB(n.VERBOSE||!1,{getCaptureState:{move:e,state:t}});var r,i,a=new Moe,o=dy(hte.ORTHOGONALS);try{for(o.s();!(i=o.n()).done;){var s=i.value;(r=n.getCapturedInDirection(e.coord,s,t)).length>0&&a.capturedCoords.every(function(e){return!r[0].equals(e)})&&(a.capturedCoords=a.capturedCoords.concat(r))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getCapturedInDirection",value:function(e,t,r){var i=r.getCopiedBoard(),a=e.getNext(t);if(a.isInRange(r.board[0].length,r.board.length)&&i[a.y][a.x]===(r.turn%2==0?Eoe.LIGHT:Eoe.DARK)){AB(n.VERBOSE||!1,"a group could be captured");var o=(new Toe).getGroupDatas(a,i);if(n.isCapturableGroup(o,r.koCoord))return AB(n.VERBOSE||!1,{neightbooringGroupCoord:o.getCoords(),message:"is capturable"}),o.getCoords()}return[]}},{key:"isCapturableGroup",value:function(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}},{key:"getTerritoryLikeGroup",value:function(e){return n.getEmptyZones(e).filter(function(e){return e.isMonoWrapped()})}},{key:"applyPass",value:function(e){var t,r,i=e.getCopiedBoard(),a=e.getCapturedCopy(),o=e.turn;return e.phase===boe.PASSED?(t=boe.COUNTING,r=new Poe(i,a,o+1,NB.empty(),t),r=n.markTerritoryAndCount(r)):(F7(e.phase===boe.PLAYING,"Cannot pass in counting phase!"),t=boe.PASSED,r=new Poe(i,a,o+1,NB.empty(),t)),r}},{key:"applyLegalAccept",value:function(e){var t,n=e.getCopiedBoard();return t=e.phase===boe.COUNTING?boe.ACCEPT:boe.FINISHED,new Poe(n,e.getCapturedCopy(),e.turn+1,NB.empty(),t)}},{key:"applyNormalLegalMove",value:function(e,t,r){var i;AB(n.VERBOSE,{applyNormalLegal:{currentState:t,legalMove:e,status:status}}),i=[boe.COUNTING,boe.ACCEPT].includes(t.phase)?n.resurrectStones(t):t.copy();var a=e.coord.x,o=e.coord.y,s=i.getCopiedBoard(),u=i.turn,c=Eoe.ofPlayer(i.getCurrentPlayer()),l=u+1;s[o][a]=c;var f,h=dy(r);try{for(h.s();!(f=h.n()).done;){var d=f.value;s[d.y][d.x]=Eoe.EMPTY}}catch(g){h.e(g)}finally{h.f()}var v=n.getNewKo(e,s,r),p=i.getCapturedCopy();return p[c.player.value]+=r.length,new Poe(s,p,l,v,boe.PLAYING)}},{key:"resurrectStones",value:function(e){for(var t=0;t<e.board.length;t++)for(var r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=n.switchAliveness(new pte(r,t),e));return n.removeAndSubstractTerritory(e)}},{key:"applyDeadMarkingMove",value:function(e,t){AB(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:t}});var r=n.removeAndSubstractTerritory(t),i=n.switchAliveness(e.coord,r),a=new Poe(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,NB.empty(),boe.COUNTING);return n.markTerritoryAndCount(a)}}]),n}(zte);return e.VERBOSE=!1,e}(),Moe=function(){function e(){gy(this,e),this.capturedCoords=[]}return my(e,null,[{key:"isCapturing",value:function(e){return e.capturedCoords.length>0}}]),e}(),xoe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){AB(Aoe.VERBOSE||!1,"GoRules.getListMoves");var t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===boe.PLAYING||t.phase===boe.PASSED)return n.push(_oe.PASS),n;AB(Aoe.VERBOSE||!1,"GoRules.getListMoves in counting phase");var r=this.getCountingMovesList(t);return 0===r.length?[_oe.ACCEPT]:r}},{key:"getPlayingMovesList",value:function(e){for(var t,n=[],r=0;r<e.board.length;r++)for(var i=0;i<e.board[0].length;i++)t=new _oe(i,r),e.getPieceAt(t.coord)===Eoe.EMPTY&&Aoe.isLegal(t,e).isSuccess()&&n.push(t);return n}},{key:"getCountingMovesList",value:function(e){var t,n=[],r=this.getCorrectBoard(e).getCopiedBoard(),i=dy(Aoe.getGroupsDatasWhere(r,function(e){return e!==Eoe.EMPTY}));try{for(i.s();!(t=i.n()).done;){var a=t.value.getCoords()[0],o=r[a.y][a.x];if(e.getPieceAt(a)!==o){var s=new _oe(a.x,a.y);return n.push(s),n}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getCorrectBoard",value:function(e){var t=this.mapBoard(e.getCopiedBoard(),function(e){return e===Eoe.DARK?Eoe.DEAD_DARK:e===Eoe.LIGHT?Eoe.DEAD_LIGHT:e.isTerritory()?Eoe.EMPTY:e}),n=new Poe(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=Aoe.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}},{key:"mapBoard",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}},{key:"setAliveUniqueWrapper",value:function(e,t){var n,r=e.copy(),i=dy(t);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=dy(o.deadDarkCoords.concat(o.deadLightCoords));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.isDead(u)&&(r=Aoe.switchAliveness(u,r))}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Aoe.getGameStatus(e);if(n.isEndGame)return new Ste(n.toBoardValue());AB(Aoe.VERBOSE||!1,"GoRules.getBoardValue");var r=Aoe.markTerritoryAndCount(t),i=r.getCapturedCopy(),a=this.getDeadStones(r);return new Ste(i[1]+2*a[0]-(i[0]+2*a[1]))}},{key:"getDeadStones",value:function(e){for(var t=[0,0],n=0;n<e.board.length;n++)for(var r=0;r<e.board[0].length;r++){var i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}]),n}(Pte),Roe=Eoe.LIGHT,Noe=Eoe.DARK,Doe=Eoe.DEAD_LIGHT,Loe=Eoe.LIGHT_TERRITORY,Foe=Eoe.DARK_TERRITORY,Uoe=Eoe.EMPTY,Voe=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(Ui||(Ui=Wg(["Preliminary information"]))),$localize(Vi||(Vi=Wg(["The game of Go is played on a board called a Goban, and the stones are placed on the intersections.\n        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.\n        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).\n        For this tutorial, we will use a smaller board for pedagogical purposes."]))),Poe.getInitialState()),Zte.informational($localize(Bi||(Bi=Wg(["Goal of the game"]))),$localize(zi||(zi=Wg(["The goal of the game is to have the most points at the end of the game.\n        We call \"territories\" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.\n        Here, Dark has 9 territories on the left, and Light has 8 on the right.\n        The top part belongs to no one.\n        Each player's score at the end of the game is the sum of that player's territories and captures."]))),new Poe([[Uoe,Noe,Uoe,Uoe,Roe,Roe],[Uoe,Noe,Uoe,Uoe,Roe,Uoe],[Uoe,Noe,Noe,Roe,Roe,Uoe],[Uoe,Uoe,Noe,Roe,Uoe,Uoe],[Uoe,Uoe,Noe,Roe,Uoe,Uoe],[Uoe,Uoe,Noe,Roe,Uoe,Uoe]],[0,0],0,NB.empty(),boe.PLAYING)),Zte.fromMove($localize(Hi||(Hi=Wg(["Simple capture"]))),$localize(Gi||(Gi=Wg(["An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).\n        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.\n        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>\n        The light piece only has one liberty left, play there."]))),new Poe([[Uoe,Uoe,Uoe,Uoe,Uoe],[Uoe,Uoe,Noe,Uoe,Uoe],[Uoe,Noe,Roe,Uoe,Uoe],[Uoe,Uoe,Noe,Uoe,Uoe],[Uoe,Uoe,Uoe,Uoe,Uoe]],[0,0],0,NB.empty(),boe.PLAYING),[new _oe(3,2)],$localize($i||($i=Wg(["Congratulations, you have earned one point."]))),$localize(Zi||(Zi=Wg(["Failed, try again by playing on one of the intersections directly next to the light stone."])))),Zte.fromMove($localize(qi||(qi=Wg(["Capturing multiple stones"]))),$localize(Wi||(Wi=Wg(["Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>\n        The light group here only has one liberty left, capture it."]))),new Poe([[Uoe,Noe,Uoe,Uoe,Uoe],[Noe,Roe,Uoe,Uoe,Uoe],[Noe,Roe,Roe,Noe,Uoe],[Uoe,Noe,Noe,Uoe,Uoe],[Uoe,Uoe,Uoe,Uoe,Uoe]],[0,0],0,NB.empty(),boe.PLAYING),[new _oe(2,1)],$localize(ji||(ji=Wg(["Congratulations, you have earned three points and formed a territory."]))),$localize(Yi||(Yi=Wg(["Failed, you have not captured the group. Play on the last liberty of that group."])))),Zte.informational($localize(Ki||(Ki=Wg(["Suicide"]))),$localize(Qi||(Qi=Wg(["In Go, suicide is forbidden.\n        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.\n        Here, the top left intersection is a suicide for Light.\n        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player."]))),new Poe([[Uoe,Noe,Uoe,Uoe,Uoe],[Noe,Uoe,Uoe,Uoe,Uoe],[Noe,Uoe,Uoe,Uoe,Roe],[Roe,Noe,Uoe,Roe,Uoe],[Uoe,Roe,Uoe,Roe,Noe]],[0,0],0,NB.empty(),boe.PLAYING)),Zte.informational($localize(Xi||(Xi=Wg(["Life and death (death)"]))),$localize(Ji||(Ji=Wg(["From the capture rule follows the life and death notion:\n        dead stones are stones that are definitely capturable (without losing anything else).\n        Alive stones are stones that can never be captured.\n        From the capture rule, Dark can play inside Light's territory and make a capture.\n        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).\n        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories."]))),new Poe([[Uoe,Uoe,Uoe,Uoe,Uoe],[Noe,Noe,Noe,Uoe,Uoe],[Roe,Roe,Noe,Uoe,Uoe],[Uoe,Roe,Noe,Uoe,Uoe],[Roe,Roe,Noe,Uoe,Uoe]],[0,0],0,NB.empty(),boe.PLAYING)),Zte.informational($localize(ea||(ea=Wg(["Life and death (eyes)"]))),$localize(ta||(ta=Wg(["Here, Light cannot play on the top left, nor on the bottom left.\n        Light will never be able to capture Dark.\n        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive."]))),new Poe([[Uoe,Noe,Roe,Uoe,Uoe],[Roe,Noe,Roe,Uoe,Uoe],[Noe,Noe,Roe,Uoe,Uoe],[Roe,Noe,Roe,Uoe,Uoe],[Uoe,Noe,Roe,Uoe,Uoe]],[0,0],0,NB.empty(),boe.PLAYING)),Zte.informational($localize(na||(na=Wg(["Seki"]))),$localize(ra||(ra=Wg(["If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.\n        Similarly, if Light plays on the middle line, Dark will capture Light.\n        In other words, there is no point in playing on the middle line.\n        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral."]))),new Poe([[Uoe,Roe,Noe,Uoe,Roe,Noe,Uoe],[Uoe,Roe,Noe,Noe,Roe,Noe,Uoe],[Uoe,Roe,Noe,Noe,Roe,Noe,Uoe],[Uoe,Roe,Noe,Noe,Roe,Noe,Uoe],[Uoe,Roe,Noe,Roe,Roe,Noe,Uoe],[Uoe,Roe,Noe,Roe,Roe,Noe,Uoe],[Uoe,Roe,Noe,Uoe,Roe,Noe,Uoe]],[0,0],0,NB.empty(),boe.PLAYING)),Zte.fromMove($localize(ia||(ia=Wg(["Ko"]))),$localize(aa||(aa=Wg(["A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>\n        Capture the light stone."]))),new Poe([[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe],[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe],[Uoe,Uoe,Uoe,Noe,Roe,Uoe,Uoe],[Uoe,Uoe,Noe,Roe,Uoe,Roe,Uoe],[Uoe,Uoe,Uoe,Noe,Roe,Uoe,Uoe],[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe],[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe]],[0,0],0,NB.empty(),boe.PLAYING),[new _oe(4,3)],$localize(oa||(oa=Wg(["Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.\n        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.\n        This rule is called the Ko.\n        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after."]))),$localize(sa||(sa=Wg(["Failed!"])))),Zte.fromMove($localize(ua||(ua=Wg(["End of the game"]))),$localize(ca||(ca=Wg(["When a player feels that there is no advantage to putting a new stone, that player can pass a turn.\n        The game phase stops when both players pass consecutively, and we move on to the counting phase.\n        The dead groups are then marked by clicking on them.\n        Every intersection in a player's territory earns that player a point.\n        The winner is the one with most points.<br/><br/>\n        A last stone is dead, mark it."]))),new Poe([[Roe,Noe,Noe,Noe,Noe,Noe,Foe,Foe,Foe],[Roe,Roe,Roe,Roe,Noe,Noe,Noe,Foe,Foe],[Roe,Loe,Roe,Roe,Noe,Doe,Doe,Noe,Foe],[Noe,Roe,Roe,Roe,Roe,Noe,Foe,Foe,Foe],[Uoe,Roe,Loe,Roe,Noe,Noe,Doe,Noe,Foe],[Roe,Loe,Roe,Roe,Noe,Noe,Noe,Noe,Noe],[Roe,Roe,Noe,Noe,Noe,Roe,Roe,Noe,Roe],[Noe,Noe,Noe,Roe,Roe,Roe,Loe,Roe,Roe],[Foe,Foe,Noe,Noe,Noe,Roe,Roe,Loe,Loe]],[0,0],0,NB.empty(),boe.COUNTING),[new _oe(0,3)],$localize(la||(la=Wg(["Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.\n        The intersections where the prisoners are count as Dark's territory\n        Light has 8 territories and 1 prisoner.\n        The end result is therefore 18 - 9 for Dark."]))),$localize(fa||(fa=Wg(["Failed, try again."]))))]});function Boe(e,t){if(1&e&&(NC(),OP(0,"circle",10)),2&e){var n=LP(2).index,r=LP().index;pP("cx",25+50*n)("cy",25+50*r)("r",22)}}function zoe(e,t){if(1&e){var n=AP();NC(),PP(0,"line",11),RP("click",function(){aC(n);var e=LP(2).index,t=LP().index;return LP().onClick(e,t)}),SP()}if(2&e){var r=LP(2).index,i=LP().index;pP("x1",50*r)("y1",50*i)("x2",50+50*r)("y2",50+50*i)}}function Hoe(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"circle",7),RP("click",function(){aC(n);var e=LP().index,t=LP().index;return LP().onClick(e,t)}),SP(),CP(2,Boe,1,3,"circle",8),CP(3,zoe,1,4,"line",9),SP()}if(2&e){var r=LP().index,i=LP().index,a=LP();BE(1),EP("ngClass",a.getSpaceClass(r,i)),pP("cx",25+50*r)("cy",25+50*i)("r",22),BE(1),EP("ngIf",a.isLastSpace(r,i)),BE(1),EP("ngIf",a.isDead(r,i))}}function Goe(e,t){if(1&e){var n=AP();NC(),PP(0,"circle",15),RP("click",function(){aC(n);var e=LP(2).index,t=LP().index;return LP().onClick(e,t)}),SP()}if(2&e){var r=LP(2),i=r.index,a=r.$implicit,o=LP().index,s=LP();pP("cx",25+50*i)("cy",25+50*o)("r",10)("class",a===s.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function $oe(e,t){if(1&e){var n=AP();NC(),PP(0,"rect",12),RP("click",function(){aC(n);var e=LP().index,t=LP().index;return LP().onClick(e,t)}),SP(),PP(1,"line",13),RP("click",function(){aC(n);var e=LP().index,t=LP().index;return LP().onClick(e,t)}),SP(),PP(2,"line",13),RP("click",function(){aC(n);var e=LP().index,t=LP().index;return LP().onClick(e,t)}),SP(),CP(3,Goe,1,4,"circle",14)}if(2&e){var r=LP().index,i=LP().index,a=LP();VP("id","click_",r,"_",i,""),pP("x",50*r)("y",50*i),BE(1),pP("x1",50*r)("y1",25+50*i)("x2",50+50*r)("y2",25+50*i),BE(1),pP("x1",25+50*r)("y1",50*i)("x2",25+50*r)("y2",50+50*i),BE(1),EP("ngIf",a.isTerritory(r,i))}}function Zoe(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Hoe,4,6,"g",5),CP(2,$oe,4,13,"ng-template",null,6,tI),SP()),2&e){var n=t.index,r=wP(3),i=LP().index,a=LP();BE(1),EP("ngIf",a.spaceIsFull(n,i))("ngIfElse",r)}}function qoe(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Zoe,4,2,"g",2),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function Woe(e,t){if(1&e&&(NC(),OP(0,"rect",16)),2&e){var n=LP();pP("x",12.5+50*n.ko.get().x)("y",12.5+50*n.ko.get().y)}}function joe(e,t){if(1&e){var n=AP();NC(),PP(0,"circle",17),RP("click",function(){var e=aC(n).$implicit;return LP().onClick(e.x,e.y)}),SP()}if(2&e){var r=t.$implicit;pP("cx",25+50*r.x)("cy",25+50*r.y)("r",7)}}var Yoe=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).ko=NB.empty(),r.last=NB.empty(),r.captures=[],r.GoPiece=Eoe,r.scores=NB.of([0,0]),r.rules=new Aoe(Poe),r.availableMinimaxes=[new xoe(r.rules,"GoMinimax")],r.encoder=_oe.encoder,r.tutorial=(new Voe).tutorial,r.canPass=!0,r.updateBoard(),r}return my(n,[{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.last=NB.empty(),a=new _oe(e,t),r.abrupt("return",n.chooseMove(a,n.getState(),n.scores.get()));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){AB(n.VERBOSE,"updateBoard");var e=this.getState(),t=this.rules.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=NB.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(function(e){return e.coord}),this.canPass=r!==boe.FINISHED}},{key:"showCaptures",value:function(){var e=this.rules.node.mother.get().gameState;this.captures=[];for(var t=0;t<this.board.length;t++)for(var n=0;n<this.board[0].length;n++){var r=new pte(n,t),i=!1===e.getPieceAt(r).isEmpty(),a=this.board[t][n]===Eoe.EMPTY,o=!1===this.ko.equalsValue(r);i&&a&&o&&this.captures.push(r)}}},{key:"pass",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getState().phase,t.abrupt("return",n===boe.PLAYING||n===boe.PASSED?e.onClick(_oe.PASS.coord.x,_oe.PASS.coord.y):(F7(n===boe.COUNTING||n===boe.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(_oe.ACCEPT.coord.x,_oe.ACCEPT.coord.y)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getSpaceClass",value:function(e,t){var n=this.getState().getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}},{key:"spaceIsFull",value:function(e,t){return this.getState().getPieceAtXY(e,t)!==Eoe.EMPTY&&!this.isTerritory(e,t)}},{key:"isLastSpace",value:function(e,t){if(this.last.isPresent()){var n=this.last.get();return e===n.x&&t===n.y}return!1}},{key:"isDead",value:function(e,t){return this.getState().isDead(new pte(e,t))}},{key:"isTerritory",value:function(e,t){return this.getState().isTerritory(new pte(e,t))}}]),n}(Sne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-go"]],features:[nP],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),OP(1,"rect",1),CP(2,qoe,2,1,"g",2),CP(3,Woe,1,2,"rect",3),CP(4,joe,1,3,"circle",4),SP()),2&e&&(pP("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),BE(1),pP("width",50*t.board.length)("height",50*t.board.length),BE(1),EP("ngForOf",t.board),BE(1),EP("ngIf",t.ko.isPresent()),BE(1),EP("ngForOf",t.captures))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Koe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getMaximalDistance",value:function(){return 11}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return DB.success(r)}catch(r){return DB.failure(r.message)}}}]),n}(Vne);Koe.encoder=Fne.getEncoder(11,11,Koe.of);var Qoe={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:e9.ZERO},Xoe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Hne.UNOCCUPIED,t=Hne.INVADERS,r=Hne.DEFENDERS;return new n([[e,e,e,t,t,t,t,t,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,r,e,e,e,e,t],[t,e,e,e,r,r,r,e,e,e,t],[t,t,e,r,r,Hne.PLAYER_ONE_KING,r,r,e,t,t],[t,e,e,e,r,r,r,e,e,e,t],[t,e,e,e,e,r,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,t,t,t,t,t,e,e,e]],0)}}]),n}($ne),Joe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.call(this,Xoe,Qoe,Koe.of)}return my(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Vte.ruler=this.singleton,n.singleton}}]),n}(qne),ese=Hne.UNOCCUPIED,tse=Hne.INVADERS,nse=Hne.DEFENDERS,rse=Hne.PLAYER_ONE_KING,ise=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(ha||(ha=Wg(["Goal of the game"]))),$localize(da||(da=Wg(["Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Xoe.getInitialState()),Zte.anyMove($localize(va||(va=Wg(["Moving"]))),$localize(pa||(pa=Wg(["All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Xoe.getInitialState(),Koe.of(new pte(5,1),new pte(1,1)),$localize(ga||(ga=Wg(["Congratulations!"])))),Zte.fromMove($localize(ya||(ya=Wg(["Capturing a soldier (1/2)"]))),$localize(ma||(ma=Wg(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Xoe([[ese,ese,ese,ese,tse,tse,tse,tse,ese,ese,ese],[ese,ese,ese,ese,ese,tse,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[tse,ese,ese,ese,ese,nse,ese,ese,ese,ese,tse],[tse,ese,ese,tse,nse,nse,nse,ese,ese,ese,tse],[tse,tse,ese,nse,nse,rse,nse,nse,ese,tse,tse],[tse,ese,ese,ese,nse,nse,nse,ese,ese,ese,tse],[tse,ese,ese,ese,ese,nse,ese,ese,ese,ese,tse],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,tse,ese,ese,ese,ese,ese],[ese,ese,ese,tse,tse,tse,tse,tse,ese,ese,ese]],1),[Koe.of(new pte(5,3),new pte(3,3))],$localize(ka||(ka=Wg(["Congratulations, that will teach him a lesson!"]))),$localize(Ca||(Ca=Wg(["Failed, you missed an opportunity to capture a piece of the opponent."])))).withPreviousMove(Koe.of(new pte(3,0),new pte(3,4))).withPreviousState(Xoe.getInitialState()),Zte.fromMove($localize(wa||(wa=Wg(["Capturing a soldier (2/2)"]))),$localize(_a||(_a=Wg(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Xoe([[ese,ese,ese,tse,tse,tse,tse,tse,ese,ese,ese],[ese,nse,ese,ese,ese,tse,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,nse,ese,ese,ese,ese,tse],[tse,ese,ese,ese,ese,nse,nse,ese,ese,ese,tse],[tse,tse,rse,ese,nse,ese,nse,nse,ese,ese,tse],[ese,ese,tse,ese,ese,nse,nse,ese,ese,ese,tse],[tse,ese,ese,ese,ese,nse,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,tse,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,tse,tse,tse,tse,ese,tse,ese,ese]],12),[Koe.of(new pte(3,0),new pte(3,5)),Koe.of(new pte(3,10),new pte(3,5))],$localize(Ea||(Ea=Wg(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(ba||(ba=Wg(["Failed, you did not do the expected move."])))),Zte.fromMove($localize(Pa||(Pa=Wg(["Capturing the king (1/2)"]))),$localize(Sa||(Sa=Wg(["To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king."]))),new Xoe([[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,tse,ese,ese,ese,ese,ese,ese,ese,ese,ese],[tse,rse,ese,tse,ese,ese,ese,ese,ese,ese,ese],[ese,tse,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese]],72),[Koe.of(new pte(3,4),new pte(2,4))],$localize(Oa||(Oa=Wg(["Congratulations, you won!"]))),$localize(Ta||(Ta=Wg(["Failed, you let the king run away."])))),Zte.fromMove($localize(Ia||(Ia=Wg(["Capturing the king (2/2)"]))),$localize(Aa||(Aa=Wg(["Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king."]))),new Xoe([[ese,ese,tse,rse,tse,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,nse,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,tse,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese],[ese,ese,ese,ese,ese,ese,ese,ese,ese,ese,ese]],72),[Koe.of(new pte(3,3),new pte(3,1))],$localize(Ma||(Ma=Wg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(xa||(xa=Wg(["Failed!"]))))]});function ase(e,t){1&e&&(NC(),OP(0,"polygon",8))}function ose(e,t){1&e&&(NC(),OP(0,"rect",9))}function sse(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,ase,1,0,"polygon",6),CP(2,ose,1,0,"ng-template",null,7,tI),SP()),2&e){var n=wP(3),r=LP().index,i=LP().index,a=LP();BE(1),EP("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function use(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"line",13),OP(2,"line",13),OP(3,"line",13),OP(4,"line",13),OP(5,"line",13),SP()),2&e){var n=LP(2).index,r=LP().index,i=LP();BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function cse(e,t){if(1&e&&(NC(),OP(0,"polyline",16)),2&e){var n=LP(3).index,r=LP().index;EP("ngClass",LP().viewInfo.pieceClasses[r][n])}}function lse(e,t){if(1&e&&(NC(),OP(0,"line",13),OP(1,"line",13),OP(2,"line",13),OP(3,"line",13)),2&e){var n=LP(3).index,r=LP().index,i=LP();EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function fse(e,t){if(1&e&&(NC(),CP(0,cse,1,1,"polyline",14),CP(1,lse,4,20,"ng-template",null,15,tI)),2&e){var n=wP(2),r=LP(2).index,i=LP().index;EP("ngIf",LP().isKing(r,i))("ngIfElse",n)}}function hse(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"circle",10),CP(2,use,6,25,"g",11),CP(3,fse,3,2,"ng-template",null,12,tI),SP()),2&e){var n=wP(4),r=LP().index,i=LP().index,a=LP();BE(1),VP("id","piece_",r,"_",i,""),EP("ngClass",a.viewInfo.pieceClasses[i][r]),pP("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),BE(1),EP("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function dse(e,t){if(1&e){var n=AP();NC(),PP(0,"g",3),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),OP(1,"rect",4),CP(2,sse,4,2,"g",5),CP(3,hse,5,8,"g",5),SP()}if(2&e){var r=t.index,i=LP().index,a=LP();VP("id","click_",r,"_",i,""),pP("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),BE(1),EP("ngClass",a.getRectClasses(r,i)),pP("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),BE(1),EP("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),BE(1),EP("ngIf",a.board[i][r]!==a.EMPTY)}}function vse(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,dse,4,8,"g",2),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function pse(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",17),RP("click",function(){var e=aC(n).$implicit;return LP().onClick(e.x,e.y)}),SP(),SP()}if(2&e){var r=t.$implicit,i=LP();BE(1),VP("id","click_",r.x,"_",r.y,""),pP("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var gse=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e,!1,Koe.from)).rules=Joe.get(),r.availableMinimaxes=[new Yne(r.rules,"DummyBot"),new Jne(r.rules,"Piece > Influence"),new ere(r.rules,"Piece > Control"),new tre(r.rules,"Escape > Piece > Control")],r.encoder=Koe.encoder,r.tutorial=(new ise).tutorial,r}return my(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(jne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-hnefatafl"]],features:[nP],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,vse,2,1,"g",1),CP(2,pse,2,6,"g",1),SP()),2&e&&(pP("viewBox",t.getViewBox()),BE(1),EP("ngForOf",t.board),BE(1),EP("ngForOf",t.getClickables()))},directives:[aM,rM,sM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),yse=function(){function e(t,n,r){gy(this,e),this.value=t,this.name=n,this.rgb=r}return my(e,null,[{key:"of",value:function(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return IB.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}]),e}();yse.ANY=new yse(0,"any","#000"),yse.ORANGE=new yse(1,"orange","#d67421"),yse.BLUE=new yse(2,"blue","#006bac"),yse.PURPLE=new yse(3,"purple","#6f3787"),yse.PINK=new yse(4,"pink","#d2719e"),yse.YELLOW=new yse(5,"yellow","#e2c200"),yse.RED=new yse(6,"red","#d23339"),yse.GREEN=new yse(7,"green","#009157"),yse.BROWN=new yse(8,"brown","#562500");var mse=function(){function e(t,n){gy(this,e),this.player=t,this.color=n}return my(e,[{key:"equals",value:function(e){return e.player===this.player&&e.color===this.color}},{key:"isEmpty",value:function(){return this.player.equals(J7.NONE)}},{key:"belongsTo",value:function(e){return this.player===e}}],[{key:"of",value:function(t,n){return new e(t,yse.of(n))}},{key:"createPlayerColors",value:function(t){return{ORANGE:new e(t,yse.ORANGE),BLUE:new e(t,yse.BLUE),PURPLE:new e(t,yse.PURPLE),PINK:new e(t,yse.PINK),YELLOW:new e(t,yse.YELLOW),RED:new e(t,yse.RED),GREEN:new e(t,yse.GREEN),BROWN:new e(t,yse.BROWN)}}}]),e}();mse.EMPTY=new mse(J7.NONE,yse.ANY),mse.ZERO=mse.createPlayerColors(e9.ZERO),mse.ONE=mse.createPlayerColors(e9.ONE);var kse=function(){function e(){gy(this,e)}return my(e,null,[{key:"getColorAt",value:function(t,n){return e.COLORS[n][t]}},{key:"getInitialBoard",value:function(){var e=mse.EMPTY;return[[1,2,3,4,5,6,7,8].map(function(e){return mse.of(e9.ONE,e)}),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(function(e){return mse.of(e9.ZERO,e)})]}},{key:"isEmptyAt",value:function(e,t){return e[t.y][t.x].equals(mse.EMPTY)}},{key:"allPieceCoords",value:function(t){for(var n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){var a=new pte(i,r);e.isEmptyAt(t,a)||n.push(a)}return n}}]),e}();kse.INITIAL=kse.getInitialBoard(),kse.SIZE=8,kse.COLORS=i9.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],yse.of);var Cse=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.call(this)}return my(n,[{key:"isPieceMove",value:function(){return!1}},{key:"length",value:function(){return 0}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"KamisadoMove(PASS)"}}]),n}(xte);Cse.PASS=new Cse;var wse,_se=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this,e,r)}return my(n,[{key:"isPieceMove",value:function(){return!0}},{key:"equals",value:function(e){return e===this||!!e.isPieceMove()&&!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"KamisadoMove("+this.coord+"->"+this.end+")"}}],[{key:"of",value:function(e,t){if(e.isNotInRange(kse.SIZE,kse.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(kse.SIZE,kse.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new n(e,t)}}]),n}(Fne);!function(e){e.PASS=Cse.PASS,e.of=function(e,t){return _se.of(e,t)},e.encoder=new(function(t){iy(r,t);var n=oy(r);function r(){return gy(this,r),n.apply(this,arguments)}return my(r,[{key:"maxValue",value:function(){return 34952}},{key:"encodeNumber",value:function(e){return e.isPieceMove()?4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y:0}},{key:"decodeNumber",value:function(t){if(0===t)return e.PASS;var n=t%16,r=(t=t/16|0)%16,i=(t=t/16|0)%16;return e.of(new pte((t=t/16|0)%16,i),new pte(r,n))}}]),r}(Q7))}(wse||(wse={}));var Ese=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o){var s;return gy(this,n),(s=t.call(this,i9.copyBiArray(o),e)).colorToPlay=r,s.coordToPlay=i,s.alreadyPassed=a,s}return my(n,null,[{key:"getInitialState",value:function(){return new n(0,yse.ANY,NB.empty(),!1,kse.INITIAL)}}]),n}(Ate),bse=function(){var e=my(function e(){gy(this,e)});return e.NOT_RIGHT_COLOR=function(){return $localize(Ra||(Ra=Wg(["This piece is not of the color you have to play."])))},e.DIRECTION_NOT_ALLOWED=function(){return $localize(Na||(Na=Wg(["You can only move forward, orthogonally or diagonally."])))},e.MOVE_BLOCKED=function(){return $localize(Da||(Da=Wg(["This move is blocked by another piece."])))},e.PLAY_WITH_SELECTED_PIECE=function(){return $localize(La||(La=Wg(["You must play with the selected piece."])))},e}(),Pse=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"nextCoordToPlay",value:function(e,t){return NB.ofNullable(kse.allPieceCoords(e.board).find(function(n){var r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}},{key:"applyLegalMove",value:function(e,t,n){if(e.isPieceMove()){var r=e.coord,i=e.end,a=t.getCopiedBoard();a[i.y][i.x]=a[r.y][r.x],a[r.y][r.x]=mse.EMPTY;var o=kse.getColorAt(i.x,i.y),s=this.nextCoordToPlay(t,o);return new Ese(t.turn+1,o,s,!1,a)}var u=this.nextCoordToPlay(t,t.colorToPlay);return new Ese(t.turn+1,t.colorToPlay,u,!0,t.board)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=t.getCurrentPlayer();if(n.mustPass(t)&&t.alreadyPassed)return Bte.getDefeat(r);var i=Qg(n.getFurthestPiecePositions(t),2),a=i[0];return 7===i[1]?Bte.ONE_WON:0===a?Bte.ZERO_WON:Bte.ONGOING}}],[{key:"getColorMatchingPiece",value:function(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new pte(0,7),new pte(1,7),new pte(2,7),new pte(3,7),new pte(4,7),new pte(5,7),new pte(6,7),new pte(7,7)]}},{key:"getMovablePieces",value:function(e){var t=this;return n.getColorMatchingPiece(e).filter(function(n){var r,i=dy(t.playerDirections(e.getCurrentPlayer()));try{for(i.s();!(r=i.n()).done;){var a=r.value,o=n.getNext(a);if(e.isOnBoard(o)&&kse.isEmptyAt(e.board,o))return!0}}catch(s){i.e(s)}finally{i.f()}return!1})}},{key:"playerDirections",value:function(e){return e===e9.ONE?[fte.DOWN,fte.DOWN_LEFT,fte.DOWN_RIGHT]:[fte.UP,fte.UP_LEFT,fte.UP_RIGHT]}},{key:"directionAllowedForPlayer",value:function(e,t){return t===e9.ZERO?e.y<0:e.y>0}},{key:"getListMovesFromState",value:function(e){var t=n.getMovablePieces(e);return 0===t.length?(F7(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[wse.PASS]):n.getListMovesFromNonBlockedState(e,t)}},{key:"getListMovesFromNonBlockedState",value:function(e,t){var r,i=[],a=e.getCurrentPlayer(),o=dy(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=dy(n.playerDirections(a));try{for(c.s();!(s=c.n()).done;)for(var l=s.value,f=1;f<kse.SIZE;f++){var h=u.getNext(l,f);if(!e.isOnBoard(h)||!kse.isEmptyAt(e.board,h))break;var d=wse.of(u,h);i.push(d)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){o.e(v)}finally{o.f()}return i}},{key:"mustPass",value:function(e){return 0===this.getMovablePieces(e).length}},{key:"getFurthestPiecePositions",value:function(e){var t=7,n=0;return kse.allPieceCoords(e.board).forEach(function(r){var i=e.getPieceAt(r);F7(i!==mse.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===e9.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}},{key:"isLegal",value:function(e,t){if(e.isPieceMove()){var r=e.coord,i=e.end,a=t.colorToPlay,o=t.getPieceAt(r);if(!o.belongsTo(t.getCurrentPlayer()))return DB.failure(bte.MUST_CHOOSE_PLAYER_PIECE());if(a!==yse.ANY&&o.color!==a)return DB.failure(bse.NOT_RIGHT_COLOR());if(!t.getPieceAt(i).isEmpty())return DB.failure(bte.MUST_CLICK_ON_EMPTY_SPACE());var s=fte.factory.fromMove(r,i);if(s.isFailure())return DB.failure(bse.DIRECTION_NOT_ALLOWED());var u=s.get();if(!n.directionAllowedForPlayer(u,t.getCurrentPlayer()))return DB.failure(bse.DIRECTION_NOT_ALLOWED());for(var c=r;!c.equals(i);)if(c=c.getNext(u),!t.getPieceAt(c).isEmpty())return DB.failure(bse.MOVE_BLOCKED());return DB.success(void 0)}return this.isLegalPass(t)}},{key:"isLegalPass",value:function(e){return this.mustPass(e)&&!e.alreadyPassed?DB.success(void 0):DB.failure(bte.CANNOT_PASS())}}]),n}(zte),Sse=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t=Pse.getListMovesFromState(e.gameState);return i9.sortByDescending(t,function(e){return e.length()}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=t.getCurrentPlayer();if(Pse.mustPass(t)&&t.alreadyPassed)return new Ste(n.getDefeatValue());var r=Qg(Pse.getFurthestPiecePositions(t),2),i=r[0],a=r[1];return new Ste(7===a?e9.ONE.getVictoryValue():0===i?e9.ZERO.getVictoryValue():a-(7-i))}}]),n}(Pte),Ose=mse.EMPTY,Tse=mse.ZERO.ORANGE,Ise=mse.ONE.ORANGE,Ase=mse.ZERO.BLUE,Mse=mse.ONE.BLUE,xse=mse.ZERO.PURPLE,Rse=mse.ONE.PURPLE,Nse=mse.ZERO.PINK,Dse=mse.ONE.PINK,Lse=mse.ZERO.YELLOW,Fse=mse.ONE.YELLOW,Use=mse.ZERO.RED,Vse=mse.ONE.RED,Bse=mse.ZERO.GREEN,zse=mse.ONE.GREEN,Hse=mse.ZERO.BROWN,Gse=mse.ONE.BROWN,$se=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(Fa||(Fa=Wg(["Goal of the game"]))),$localize(Ua||(Ua=Wg(["At Kamisado, there are two ways to win the game:\n        either by moving one of your pieces on the opponent's starting line,\n        or by forcing the opponent to make a move that blocks the entire game.\n        Here, Dark wins because its brown piece is on Light's starting line, on the top left."]))),new Ese(5,yse.ORANGE,NB.empty(),!1,[[Hse,Mse,Rse,Dse,Fse,Vse,zse,Gse],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ise,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Bse,Use,Lse,Nse,xse,Ase,Tse]])).withPreviousMove(wse.of(new pte(0,7),new pte(0,0))),Zte.anyMove($localize(Va||(Va=Wg(["Initial board and initial move"]))),$localize(Ba||(Ba=Wg(["Here is the initial board.\n        At Kamisado, pieces can only move forward, vertically or diagonally.\n        You're playing first, with dark pieces, you can make your first move.<br/><br/>\n        Click on the piece of your choice and click on the landing square."]))),Ese.getInitialState(),wse.of(new pte(7,7),new pte(3,3)),$localize(za||(za=Wg(["Perfect! Note that each of your piece has a different color."])))),Zte.fromMove($localize(Ha||(Ha=Wg(["Moving"]))),$localize(Ga||(Ga=Wg(["Let us now consider the move of Light, after the blue piece has been moved by Dark.\n        All moves after the initial move must be made from the piece that corresponds to the color\n        of the square upon which the last move ended.\n        Here, the last move ended on the pink square, hence the pink piece must move.\n        It is already selected, you do not have to click on it.<br/><br/>\n        Move it on a blue square."]))),new Ese(1,yse.PINK,NB.of(new pte(3,0)),!1,[[Ise,Mse,Rse,Dse,Fse,Vse,zse,Gse],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ase,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Hse,Bse,Use,Lse,Nse,xse,Ose,Tse]]),[wse.of(new pte(3,0),new pte(3,6)),wse.of(new pte(3,0),new pte(4,1))],$localize($a||($a=Wg(["Congratulations!"]))),$localize(Za||(Za=Wg(["You have not moved your pink piece on a blue square!"])))).withPreviousMove(wse.of(new pte(6,7),new pte(6,5))),Zte.informational($localize(qa||(qa=Wg(["Stuck situation"]))),$localize(Wa||(Wa=Wg(["Dark moved to another pink square, hence you have to move your pink piece again.\n        However, your pink piece is stuck! In this case, you must pass your turn.\n        Dark will now have to play by moving its pink piece."]))),new Ese(1,yse.PINK,NB.of(new pte(3,6)),!1,[[Ise,Mse,Rse,Ose,Fse,Vse,zse,Gse],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ase],[Ose,Ose,Ose,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Dse,Ose,Ose,Ose,Ose],[Hse,Bse,Use,Lse,Nse,xse,Ose,Tse]])).withPreviousMove(wse.of(new pte(6,5),new pte(7,4))),Zte.fromMove($localize(ja||(ja=Wg(["Victory by blocking"]))),$localize(Ya||(Ya=Wg(["At any time, if a player blocks the entire game, that player loses.\n        In other words, if a player forces its opponent to move a piece that the opponent cannot move,\n        and the player cannot move its own piece of the same color, then that player loses.\n        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>\n        Try to make this move."]))),new Ese(2,yse.RED,NB.of(new pte(2,4)),!1,[[Ose,Mse,Rse,Ose,Ose,Vse,Ose,Ose],[Ose,Ose,Ose,Fse,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Dse,Ose,Rse,Ose,Ose],[Ose,Ose,Ose,Lse,Ose,Ose,Ose,Ose],[Ose,Ose,Use,Ose,Ose,Ose,Ose,Ose],[Ose,Ose,Ose,Ose,Ose,Ose,zse,Ose],[Ise,Ose,Ose,Ose,Ose,Nse,Ose,Gse],[Hse,Bse,Ose,Ose,Ose,Ose,Ase,Tse]]),[wse.of(new pte(2,4),new pte(0,2))],$localize(Ka||(Ka=Wg(["Perfect!\n         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.\n         Your orange piece will be stuck and you will have to pass your turn.\n         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.\n         In this case, the last player to have moved a piece loses.\n         Here, your opponent will have moved its green piece last, you therefore win!"]))),$localize(Qa||(Qa=Wg(["Failed!"])))).withPreviousMove(wse.of(new pte(4,0),new pte(3,1)))]});function Zse(e,t){if(1&e&&(NC(),OP(0,"circle",8)),2&e){var n=LP(),r=n.$implicit,i=n.index,a=LP().index,o=LP();EP("ngClass",o.piecePlayerClass(r)),pP("cx",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+a*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function qse(e,t){if(1&e&&(NC(),OP(0,"rect",9)),2&e){var n=LP(),r=n.index,i=n.$implicit,a=LP().index,o=LP();pP("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+a*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(i)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(i)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(i))}}function Wse(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"g",4),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),OP(2,"rect",5),CP(3,Zse,1,4,"circle",6),CP(4,qse,1,7,"rect",7),SP(),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP().index,o=LP();BE(1),VP("id","click_",i,"_",a,""),BE(1),pP("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(i,a)),BE(1),EP("ngIf",r!==o.UNOCCUPIED),BE(1),EP("ngIf",r!==o.UNOCCUPIED)}}function jse(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Wse,5,9,"g",1),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function Yse(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"rect",10),OP(2,"rect",10),SP()),2&e){var n=LP();BE(1),pP("x",n.lastPieceMove.get().coord.x*n.SPACE_SIZE)("y",n.lastPieceMove.get().coord.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),BE(1),pP("x",n.lastPieceMove.get().end.x*n.SPACE_SIZE)("y",n.lastPieceMove.get().end.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Kse(e,t){if(1&e&&(NC(),OP(0,"circle",11)),2&e){var n=LP();pP("cx",n.SPACE_SIZE/2+n.chosen.get().x*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+n.chosen.get().y*n.SPACE_SIZE)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}var Qse=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).UNOCCUPIED=mse.EMPTY,r.lastMove=NB.empty(),r.lastPieceMove=NB.empty(),r.chosen=NB.empty(),r.chosenAutomatically=!1,r.hasAsymetricBoard=!0,r.rules=new Pse(Ese),r.availableMinimaxes=[new Sse(r.rules,"KamisadoMinimax")],r.encoder=wse.encoder,r.tutorial=(new $se).tutorial,r.canPass=!1,r.updateBoard(),r}return my(n,[{key:"backgroundColor",value:function(e,t){return kse.getColorAt(e,t).rgb}},{key:"isPlayerZero",value:function(e){return e.player===e9.ZERO}},{key:"pieceColor",value:function(e){return e.color.rgb}},{key:"piecePlayerClass",value:function(e){return this.getPlayerClass(e.player)}},{key:"updateBoard",value:function(){var e=this.getState();if(this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.lastPieceMove=NB.empty(),this.lastMove.isPresent()){var t=this.lastMove.get();t.isPieceMove()&&(this.lastPieceMove=NB.of(t))}this.canPass=Pse.mustPass(e);var n=this.rules.getGameStatus(this.rules.node)!==Bte.ONGOING;this.canPass||e.coordToPlay.isAbsent()||n?(this.chosenAutomatically=!1,this.chosen=NB.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}},{key:"pass",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(F7(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(wse.PASS,e.getState())));case 1:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new pte(e,t),!n.canPass){r.next=6;break}return r.abrupt("return",n.cancelMove(bte.MUST_PASS()));case 6:if(!n.chosen.isAbsent()){r.next=8;break}return r.abrupt("return",n.choosePiece(e,t));case 8:if(!1!==n.chosenAutomatically||!n.chosen.equalsValue(a)){r.next=10;break}return r.abrupt("return",(n.cancelMoveAttempt(),UB.SUCCESS));case 10:if(o=n.getState().getPieceAtXY(e,t),s=n.getState().getCurrentPlayer(),!o.belongsTo(s)){r.next=15;break}r.t0=n.chosenAutomatically?n.cancelMove(bse.PLAY_WITH_SELECTED_PIECE()):(n.chosen=NB.of(a),UB.SUCCESS),r.next=18;break;case 15:return r.next=17,n.chooseDestination(e,t);case 17:r.t0=r.sent;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=this.getState().getPieceAtXY(e,t),r=this.getState().getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(bte.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=NB.of(new pte(e,t)),UB.SUCCESS)}},{key:"chooseDestination",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new pte(e,t),o=wse.of(i,a),r.abrupt("return",n.chooseMove(o,n.getState()));case 2:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenAutomatically||(this.chosen=NB.empty())}}]),n}(Sne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-kamisado"]],features:[nP],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,jse,2,1,"g",1),CP(2,Yse,3,8,"g",2),CP(3,Kse,1,3,"circle",3),SP()),2&e&&(pP("viewBox",t.getViewBox())("transform",t.rotation),BE(1),EP("ngForOf",t.board),BE(1),EP("ngIf",t.lastPieceMove.isPresent()),BE(1),EP("ngIf",t.chosen.isPresent()))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Xse=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,null,[{key:"getInitialState",value:function(){var e=J7.NONE,t=J7.ZERO,r=J7.ONE;return new n([[e,t,t,t,t,t,t,e],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[e,t,t,t,t,t,t,e]],0)}},{key:"isOnBoard",value:function(e){return e.isInRange(n.SIZE,n.SIZE)}}]),n}(Ate);return e.SIZE=8,e}(),Jse=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r)).direction=i,a.direction=fte.factory.fromMove(e,r).get(),a}return my(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}],[{key:"of",value:function(e,t){var r=fte.factory.fromMove(e,t);return r.isFailure()?DB.failure(r.getReason()):e.isNotInRange(Xse.SIZE,Xse.SIZE)?DB.failure("start coord is not in range"):t.isNotInRange(Xse.SIZE,Xse.SIZE)?DB.failure("end coord is not in range"):DB.success(new n(e,t,r.get()))}}]),n}(Fne);Jse.encoder=Fne.getEncoder(Xse.SIZE,Xse.SIZE,function(e,t){return Jse.of(e,t).get()});var eue=function(){var e=my(function e(){gy(this,e)});return e.INVALID_MOVE_LENGTH=function(){return $localize(Xa||(Xa=Wg(["Your move should have a length equal to the number of pieces that exist on the same line."])))},e.CANNOT_JUMP_OVER_OPPONENT=function(){return $localize(Ja||(Ja=Wg(["You cannot jump over the opponent's pieces."])))},e.PIECE_CANNOT_MOVE=function(){return $localize(eo||(eo=Wg(["This piece has no possible move, select another one."])))},e}(),tue=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=J7.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new Xse(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=Qg(n.getNumberOfGroups(t),2),i=r[0],a=r[1];return 1===i&&a>1?Bte.ZERO_WON:i>1&&1===a?Bte.ONE_WON:Bte.ONGOING}}],[{key:"getListMovesFromState",value:function(e){var t=[];if(n.getVictory(e).isPresent())return t;for(var r=0;r<Xse.SIZE;r++)for(var i=0;i<Xse.SIZE;i++){var a=new pte(i,r);if(e.getPieceAt(a).isPlayer()){var o,s=dy(n.possibleTargets(e,a));try{for(s.s();!(o=s.n()).done;){var u=o.value,c=Jse.of(a,u).get();t.push(c)}}catch(l){s.e(l)}finally{s.f()}}}return t}},{key:"getNumberOfGroups",value:function(e){for(var t=i9.createTable(Xse.SIZE,Xse.SIZE,-1),r=[0,0],i=0,a=0;a<Xse.SIZE;a++)for(var o=0;o<Xse.SIZE;o++)if(-1===t[a][o]){var s=e.getPieceAt(new pte(o,a));s.isPlayer()&&(i+=1,n.markGroupStartingAt(e,t,new pte(o,a),i),r[s.value]+=1)}return r}},{key:"markGroupStartingAt",value:function(e,t,n,r){for(var i=[n],a=e.getPieceAt(n);i.length>0;){var o=IB.getNonNullable(i.pop());if(-1===t[o.y][o.x]){var s=e.getPieceAt(o);if(s===a){t[o.y][o.x]=r;var u,c=dy(fte.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=o.getNext(l);e.isOnBoard(f)&&i.push(f)}}catch(h){c.e(h)}finally{c.f()}}else s===J7.NONE&&(t[o.y][o.x]=0)}}}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?DB.failure(bte.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?DB.failure(eue.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(function(e){return t.getPieceAt(e)===t.getCurrentOpponent()})?DB.failure(eue.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?DB.failure(bte.CANNOT_SELF_CAPTURE()):DB.success(void 0)}},{key:"numberOfPiecesOnLine",value:function(e,t,r){var i,a=0,o=dy(n.getLineCoords(t,r));try{for(o.s();!(i=o.n()).done;){var s=i.value;e.getPieceAt(s).isPlayer()&&(a+=1)}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getLineCoords",value:function(e,t){for(var r=n.getEntranceAndForwardDirection(e,t),i=r[0],a=r[1],o=[];Xse.isOnBoard(i);)o.push(i),i=i.getNext(a);return o}},{key:"getEntranceAndForwardDirection",value:function(e,t){switch(t){case fte.UP:case fte.DOWN:return[new pte(e.x,0),fte.DOWN];case fte.LEFT:case fte.RIGHT:return[new pte(0,e.y),fte.RIGHT];case fte.UP_RIGHT:case fte.DOWN_LEFT:return[new pte(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),fte.UP_RIGHT];default:return IB.expectToBeMultiple(t,[fte.UP_LEFT,fte.DOWN_RIGHT]),[new pte(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),fte.DOWN_RIGHT]}}},{key:"getVictory",value:function(e){var t=Qg(n.getNumberOfGroups(e),2),r=t[0],i=t[1];return 1===r&&1===i?NB.of(J7.NONE):1===r?NB.of(e9.ZERO):1===i?NB.of(e9.ONE):NB.empty()}},{key:"possibleTargets",value:function(e,t){var r,i=[],a=dy(fte.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.numberOfPiecesOnLine(e,t,o),u=t.getNext(o,s);if(e.isOnBoard(u)){var c=Jse.of(t,u).get();n.isLegal(c,e).isSuccess()&&i.push(u)}}}catch(l){a.e(l)}finally{a.f()}return i}}]),n}(zte),nue=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){return tue.getListMovesFromState(e.gameState)}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Qg(tue.getNumberOfGroups(t),2),r=n[0],i=n[1];return new Ste(1===r&&i>1?e9.ZERO.getVictoryValue():r>1&&1===i?e9.ONE.getVictoryValue():100/r*e9.ZERO.getScoreModifier()+100/i*e9.ONE.getScoreModifier())}}]),n}(Pte),rue=J7.NONE,iue=J7.ZERO,aue=J7.ONE,oue=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(to||(to=Wg(["Goal of the game"]))),$localize(no||(no=Wg(["At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.\n        Here, Dark wins the game:\n        Dark's pieces are forming a single group, while Light's pieces form three groups."]))),new Xse([[rue,rue,rue,rue,rue,rue,rue,rue],[aue,rue,rue,rue,iue,rue,rue,aue],[rue,rue,iue,iue,aue,rue,rue,rue],[rue,rue,rue,iue,rue,rue,rue,rue],[rue,rue,rue,rue,rue,rue,rue,rue],[rue,rue,rue,rue,rue,rue,rue,rue],[rue,rue,rue,rue,rue,rue,rue,rue],[rue,rue,rue,rue,rue,rue,rue,rue]],0)),Zte.anyMove($localize(ro||(ro=Wg(["Initial board and initial move"]))),$localize(io||(io=Wg(["Here is the initial board.\n         Moves can be made orthogonally or diagonally.\n         The length of a move is equal to the number of pieces that are on the line of the move.\n         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>\n         You're playing Dark, make the first move!"]))),Xse.getInitialState(),Jse.of(new pte(1,7),new pte(1,5)).get(),$localize(ao||(ao=Wg(["Congratulations!"])))),Zte.fromMove($localize(oo||(oo=Wg(["Jumping"]))),$localize(so||(so=Wg(["During a move, it is possible to jump above your own pieces.\n        But it is forbidden to jump over the opponent's pieces.<br/><br/>\n        You're playing Dark, make a jump over one of your pieces on the following board."]))),new Xse([[rue,rue,rue,rue,rue,rue,rue,rue],[rue,rue,aue,iue,iue,rue,rue,rue],[rue,rue,rue,rue,rue,rue,rue,rue],[rue,rue,rue,rue,rue,rue,rue,rue],[rue,rue,rue,rue,rue,rue,rue,rue],[rue,rue,rue,rue,rue,rue,rue,rue],[rue,rue,rue,rue,rue,rue,rue,aue],[rue,rue,rue,rue,rue,rue,rue,iue]],0),[Jse.of(new pte(3,1),new pte(6,1)).get()],$localize(uo||(uo=Wg(["Congratulations!"]))),$localize(co||(co=Wg(["Failed. You did not jump over one of your pieces."])))),Zte.fromMove($localize(lo||(lo=Wg(["Moving"]))),$localize(fo||(fo=Wg(["Here is a different board. Pick the dark piece in the middle (line 4, column 4)\n        and observe its possible moves.\n        Horizontally, this piece can move only of one square because it is the only piece on this line.\n        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.\n        But it can only go up, as below it the landing square is occupied by one of your pieces.\n        Diagonally, only one move is possible: on the diagonal that contains three pieces,\n        only in the direction where it does not jump over one of the opponent's pieces.\n        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>\n        Make one of these moves."]))),new Xse([[rue,rue,rue,rue,rue,rue,aue,rue],[rue,rue,rue,rue,rue,iue,rue,rue],[rue,rue,rue,rue,aue,rue,rue,rue],[rue,rue,rue,iue,rue,rue,rue,rue],[rue,rue,rue,rue,rue,rue,rue,aue],[rue,rue,rue,rue,rue,aue,rue,aue],[rue,rue,rue,iue,rue,rue,aue,aue],[rue,rue,rue,iue,rue,rue,rue,rue]],0),[Jse.of(new pte(3,3),new pte(3,0)).get(),Jse.of(new pte(3,3),new pte(0,0)).get(),Jse.of(new pte(3,3),new pte(2,3)).get(),Jse.of(new pte(3,3),new pte(4,3)).get()],$localize(ho||(ho=Wg(["Congratulations!"]))),$localize(vo||(vo=Wg(["Failed. This was not one of the expected moves."])))),Zte.fromPredicate($localize(po||(po=Wg(["Capturing"]))),$localize(go||(go=Wg(["If a move ends on an opponent's piece, it is captured and removed from the board.\n        However, a move cannot end on one of the player's pieces.\n        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!\n        If a player has only one piece, that player wins the game.<br/><br/>\n        On the following board, try to capture one piece with Dark."]))),new Xse([[rue,iue,rue,iue,iue,iue,iue,rue],[aue,rue,rue,rue,rue,rue,rue,aue],[rue,rue,iue,rue,aue,rue,rue,rue],[aue,rue,rue,rue,rue,rue,rue,aue],[aue,rue,rue,rue,rue,rue,rue,aue],[aue,rue,rue,rue,rue,rue,rue,aue],[aue,rue,rue,rue,rue,rue,rue,aue],[rue,iue,iue,iue,iue,iue,iue,rue]],0),Jse.of(new pte(2,2),new pte(4,2)).get(),function(e,t,n){return t.getPieceAt(e.end)===J7.ONE?UB.SUCCESS:UB.failure($localize(yo||(yo=Wg(["Failed!"]))))},$localize(mo||(mo=Wg(["Congratulations!"])))),Zte.fromMove($localize(ko||(ko=Wg(["Tie"]))),$localize(Co||(Co=Wg(["In the special case where a move ends up connecting all pieces of both player, simultaneously,\n        then the game ends up with a tie.<br/><br/>\n        You're playing Dark, force the tie in one move."]))),new Xse([[rue,rue,rue,rue,rue,rue,rue,rue],[rue,rue,rue,rue,rue,rue,rue,rue],[iue,rue,rue,iue,aue,iue,rue,rue],[rue,rue,rue,iue,rue,rue,rue,aue],[rue,rue,rue,rue,rue,rue,rue,aue],[rue,rue,rue,rue,rue,rue,rue,aue],[rue,rue,rue,rue,rue,rue,rue,aue],[rue,rue,rue,rue,rue,rue,rue,rue]],0),[Jse.of(new pte(0,2),new pte(4,2)).get()],$localize(wo||(wo=Wg(["Congratulations!"]))),$localize(_o||(_o=Wg(["Failed!"]))))]});function sue(e,t){if(1&e&&(NC(),OP(0,"circle",6)),2&e){var n=LP().index,r=LP().index,i=LP();VP("id","piece_",n,"_",r,""),EP("ngClass",i.getPieceClasses(n,r)),pP("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function uue(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"g",3),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),OP(2,"rect",4),CP(3,sue,1,6,"circle",5),SP(),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP().index,o=LP();BE(1),VP("id","click_",i,"_",a,""),BE(1),EP("ngClass",o.getSquareClasses(i,a)),pP("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),BE(1),EP("ngIf",r!==o.EMPTY)}}function cue(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,uue,4,8,"g",1),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function lue(e,t){if(1&e){var n=AP();NC(),PP(0,"rect",7),RP("click",function(){var e=aC(n).$implicit;return LP().onClick(e.x,e.y)}),SP()}if(2&e){var r=t.$implicit,i=LP();pP("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}var fue=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.EMPTY=J7.NONE,r.targets=[],r.selected=NB.empty(),r.lastMove=NB.empty(),r.captured=NB.empty(),r.rules=new tue(Xse),r.availableMinimaxes=[new nue(r.rules,"LinesOfActionMinimax")],r.encoder=Jse.encoder,r.tutorial=(new oue).tutorial,r.updateBoard(),r}return my(n,[{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new pte(e,t),!n.selected.equalsValue(a)){r.next=6;break}return r.abrupt("return",(n.cancelMoveAttempt(),UB.SUCCESS));case 6:return o=n.getState().getCurrentPlayer(),r.abrupt("return",n.selected.isAbsent()||n.getState().getPieceAt(a)===o?n.select(a):n.concludeMove(a));case 8:case"end":return r.stop()}},r)}))()}},{key:"concludeMove",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=Jse.of(t.selected.get(),e),n.abrupt("return",r.isSuccess()?t.chooseMove(r.get(),t.rules.node.gameState):t.cancelMove(r.getReason()));case 2:case"end":return n.stop()}},n)}))()}},{key:"select",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(bte.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=NB.of(e),t.targets=tue.possibleTargets(t.getState(),t.selected.get()),0===t.targets.length?t.cancelMove(eue.PIECE_CANNOT_MOVE()):UB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?NB.of(e.end):NB.empty()}}},{key:"cancelMoveAttempt",value:function(){this.selected=NB.empty(),this.targets=[]}},{key:"getSquareClasses",value:function(e,t){var n=new pte(e,t);if(this.lastMove.isPresent()){var r=this.lastMove.get().coord,i=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured-fill"];if(n.equals(r)||n.equals(i))return["moved-fill"]}return[]}},{key:"getPieceClasses",value:function(e,t){var n=this.board[t][e],r=new pte(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected-stroke"),i}}]),n}(Sne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-linesofaction"]],features:[nP],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,cue,2,1,"g",1),CP(2,lue,1,4,"rect",2),SP()),2&e&&(BE(1),EP("ngForOf",t.board),BE(1),EP("ngForOf",t.targets))},directives:[aM,rM,sM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),hue=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{top:0,bottom:0,left:0,right:0};return gy(this,n),(a=t.call(this,e.x,e.y)).direction=r,a.orientation=i,a.captures=o,a}return my(n,[{key:"toString",value:function(){return"LodestoneMove(".concat(this.coord.toString(),", ").concat(this.direction,", ").concat(this.orientation,", { top: ").concat(this.captures.top,", bottom: ").concat(this.captures.bottom,", left: ").concat(this.captures.left,", right: ").concat(this.captures.right," })")}},{key:"equals",value:function(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}]),n}(Rte);hue.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"encodeMove",value:function(e){return{coord:pte.encoder.encode(e.coord),direction:e.direction,orientation:e.orientation,captures:e.captures}}},{key:"decodeMove",value:function(e){var t=e;return F7(null!=t.coord,"Invalid encoded LodestoneMove"),F7(null!=t.direction,"Invalid encoded LodestoneMove"),F7(null!=t.orientation,"Invalid encoded LodestoneMove"),F7(null!=t.captures,"Invalid encoded LodestoneMove"),new hue(pte.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}}]),n}(K7));var due=function(){var e=my(function e(){gy(this,e)});return e.MUST_FLIP_LODESTONE=function(){return $localize(Eo||(Eo=Wg(["You must flip your lodestone before putting it back on the board."])))},e.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=function(){return $localize(bo||(bo=Wg(["As long as there are pressure plates, you must place all the pieces that you have captured on them."])))},e.TARGET_IS_CRUMBLED=function(){return $localize(Po||(Po=Wg(["You must place your lodestone on a non-crumbled square!"])))},e.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=function(){return $localize(So||(So=Wg(["You placed too many captures on the same pressure plate, which has not enough space left."])))},e.MUST_PLACE_CAPTURES=function(){return $localize(Oo||(Oo=Wg(["You must place your captures on the pressure plates, on the side of the board."])))},e.NO_CAPTURES_TO_PLACE_YET=function(){return $localize(To||(To=Wg(["You cannot place any capture now, you must first place your lodestone on the board!"])))},e}(),vue=function(){function e(t){gy(this,e),this.unreachable=t}return my(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!0}},{key:"isUnreachable",value:function(){return this.unreachable}},{key:"equals",value:function(e){return this===e}}]),e}();vue.UNREACHABLE=new vue(!0),vue.EMPTY=new vue(!1);var pue=function(){function e(t){gy(this,e),this.owner=t}return my(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!0}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t){return t===e9.ZERO?e.ZERO:e.ONE}}]),e}();pue.ZERO=new pue(e9.ZERO),pue.ONE=new pue(e9.ONE);var gue=function(){function e(t,n,r){gy(this,e),this.owner=t,this.direction=n,this.orientation=r}return my(e,[{key:"isLodestone",value:function(){return!0}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t,n){return e.LODESTONES[t.value][n.direction][n.orientation]}}]),e}();gue.LODESTONES={0:{push:{diagonal:new gue(e9.ZERO,"push","diagonal"),orthogonal:new gue(e9.ZERO,"push","orthogonal")},pull:{diagonal:new gue(e9.ZERO,"pull","diagonal"),orthogonal:new gue(e9.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new gue(e9.ONE,"push","diagonal"),orthogonal:new gue(e9.ONE,"push","orthogonal")},pull:{diagonal:new gue(e9.ONE,"pull","diagonal"),orthogonal:new gue(e9.ONE,"pull","orthogonal")}}};var yue=function(){function e(t,n){gy(this,e),this.width=t,this.pieces=n}return my(e,[{key:"remainingSpaces",value:function(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}},{key:"addCaptured",value:function(t,n){if(this.pieces.length+n>=this.width)return 5===this.width?e.EMPTY_3.addCaptured(t,n+this.pieces.length-5):(F7(this.pieces.length+n===3,"should never put more pieces than the plate can support"),NB.empty());for(var r=i9.copyImmutableArray(this.pieces),i=0;i<n;i++)r.push(pue.of(t));return NB.of(new e(this.width,r))}},{key:"getPieceAt",value:function(e){return e<this.pieces.length?this.pieces[e]:vue.EMPTY}}]),e}();yue.POSITIONS=["top","bottom","left","right"],yue.EMPTY_5=new yue(5,[]),yue.EMPTY_3=new yue(3,[]);var mue=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this,e,r)).lodestones=i,o.pressurePlates=a,o}return my(n,[{key:"withBoard",value:function(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}},{key:"remainingSpaces",value:function(){var e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}},{key:"remainingSpacesDetails",value:function(){var e,t={top:0,bottom:0,left:0,right:0},n=dy(yue.POSITIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.pressurePlates[r];i.isPresent()&&(t[r]=i.get().remainingSpaces())}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"numberOfPieces",value:function(){for(var e=[0,0],t=0;t<n.SIZE;t++)for(var r=0;r<n.SIZE;r++){var i=this.getPieceAtXY(r,t);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}},{key:"getScores",value:function(){var e=this.numberOfPieces();return[24-e[1],24-e[0]]}},{key:"nextLodestoneDirection",value:function(){var e=this.getCurrentPlayer(),t=this.lodestones.get(e);if(!t.isPresent())return NB.empty();var n=this.getPieceAt(t.get());switch(F7(n.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+t.get()),n.direction){case"push":return NB.of("pull");case"pull":return NB.of("push")}}}],[{key:"getInitialState",value:function(){var e=vue.EMPTY,t=pue.ZERO,r=pue.ONE;return new n([[e,e,t,r,t,r,e,e],[e,t,r,t,r,t,r,e],[t,r,t,r,t,r,t,r],[r,t,r,e,e,t,r,t],[t,r,t,e,e,r,t,r],[r,t,r,t,r,t,r,t],[e,r,t,r,t,r,t,e],[e,e,r,t,r,t,e,e]],0,new Lte,{top:NB.of(yue.EMPTY_5),bottom:NB.of(yue.EMPTY_5),left:NB.of(yue.EMPTY_5),right:NB.of(yue.EMPTY_5)})}}]),n}(Ate);return e.SIZE=8,e}(),kue=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.call(this,mue)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCurrentPlayer(),i=r.getOpponent(),a=i9.copyBiArray(n.board),o=t.lodestones.getCopy();o.put(r,e.coord);var s=Yg({},t.pressurePlates);return this.updatePressurePlates(a,s,o,i,e.captures),new mue(a,t.turn+1,o,s)}},{key:"updatePressurePlates",value:function(e,t,n,r,i){var a,o=dy(yue.POSITIONS);try{for(o.s();!(a=o.n()).done;){var s=a.value;t[s]=this.updatePressurePlate(e,s,t[s],n,r,i[s])}}catch(u){o.e(u)}finally{o.f()}}},{key:"updatePressurePlate",value:function(e,t,r,i,a,o){if(r.isPresent()){var s=r.get().addCaptured(a,o),u=n.THREATENED_COORD_RANGE.get(t).get();return s.isAbsent()?(this.removePressurePlate(e,u.startForBigPlate,u.direction,i),this.removePressurePlate(e,u.startForSmallPlate,u.direction,i)):s.get().width<r.get().width&&this.removePressurePlate(e,u.startForBigPlate,u.direction,i),s}return r}},{key:"removePressurePlate",value:function(e,t,n,r){for(var i=t;i.isInRange(mue.SIZE,mue.SIZE);i=i.getNext(n)){var a,o=dy(e9.PLAYERS);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.get(s).equalsValue(i)&&r.delete(s)}}catch(u){o.e(u)}finally{o.f()}e[i.y][i.x]=vue.UNREACHABLE}}},{key:"isLegal",value:function(e,t){var n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return DB.failure(n.getReason());var r=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(r.captures.length,t.remainingSpaces()))return DB.failure(due.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());var i,a=dy(yue.POSITIONS);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.pressurePlates[o];if(s.isPresent()&&s.get().remainingSpaces()<e.captures[o])return DB.failure(due.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}}catch(u){a.e(u)}finally{a.f()}return DB.success(r)}},{key:"applyMoveWithoutPlacingCaptures",value:function(e,t,n){var r,i=i9.copyBiArray(e.board),a=e.lodestones.get(e.getCurrentPlayer());if(a.isPresent()){var o=a.get();i[o.y][o.x]=vue.EMPTY}return(r="pull"===n.direction?this.applyPull(e,i,t,n.orientation):this.applyPush(e,i,t,n.orientation)).board[t.y][t.x]=gue.of(e.getCurrentPlayer(),n),r.moved.push(t),r}},{key:"applyPull",value:function(e,t,n,r){var i,a=e.getCurrentPlayer(),o=a.getOpponent(),s=[],u=[],c=dy("diagonal"===r?fte.DIAGONALS:fte.ORTHOGONALS);try{for(c.s();!(i=c.n()).done;)for(var l=i.value,f=n.getNext(l);e.isOnBoard(f);f=f.getNext(l)){var h=t[f.y][f.x],d=f.getNext(l);if(e.isOnBoard(d)){var v=t[d.y][d.x];v.isPlayerPiece()&&v.owner===a&&(h.isEmpty()?(u.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=vue.EMPTY):h.isPlayerPiece()&&h.owner===o&&(s.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=vue.EMPTY))}}}catch(p){c.e(p)}finally{c.f()}return{board:t,captures:s,moved:u}}},{key:"applyPush",value:function(e,t,n,r){var i,a=e.getCurrentPlayer().getOpponent(),o=[],s=[],u=dy("diagonal"===r?fte.DIAGONALS:fte.ORTHOGONALS);try{for(u.s();!(i=u.n()).done;)for(var c=i.value,l=n.getNext(c,mue.SIZE);!1===l.equals(n);l=l.getPrevious(c))if(e.isOnBoard(l)){var f=t[l.y][l.x];if(f.isPlayerPiece()&&f.owner===a){var h=l.getNext(c);if(e.isOnBoard(h)){var d=t[h.y][h.x];d.isUnreachable()?(o.push(l),t[l.y][l.x]=vue.EMPTY):d.isEmpty()&&(s.push(h),t[h.y][h.x]=f,s.push(l),t[l.y][l.x]=vue.EMPTY)}else o.push(l),t[l.y][l.x]=vue.EMPTY}}}catch(v){u.e(v)}finally{u.f()}return{board:t,captures:o,moved:s}}},{key:"isLegalWithoutCaptures",value:function(e,t,n){var r=this.isTargetLegal(e,t);if(r.isFailure())return r;var i=e.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(n))?UB.failure(due.MUST_FLIP_LODESTONE()):UB.SUCCESS}},{key:"isTargetLegal",value:function(e,t){var n=e.getPieceAt(t);if(n.isUnreachable())return UB.failure(due.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return UB.failure(bte.MUST_CLICK_ON_EMPTY_SQUARE());var r=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==r?UB.failure(bte.MUST_CLICK_ON_EMPTY_SQUARE()):UB.SUCCESS}},{key:"getGameStatus",value:function(e){var t=e.gameState.numberOfPieces();return 0===t[0]&&0===t[1]?Bte.DRAW:0===t[0]?Bte.ONE_WON:0===t[1]?Bte.ZERO_WON:Bte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=NB.of(new n)),n.singleton.get()}}]),n}(zte);kue.THREATENED_COORD_RANGE=Lte.from({top:{startForBigPlate:new pte(0,0),startForSmallPlate:new pte(0,1),direction:fte.RIGHT},bottom:{startForBigPlate:new pte(0,mue.SIZE-1),startForSmallPlate:new pte(0,mue.SIZE-2),direction:fte.RIGHT},left:{startForBigPlate:new pte(0,0),startForSmallPlate:new pte(1,0),direction:fte.DOWN},right:{startForBigPlate:new pte(mue.SIZE-1,0),startForSmallPlate:new pte(mue.SIZE-2,0),direction:fte.DOWN}}),kue.singleton=NB.empty();var Cue=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t=this,n=e.gameState;return this.flatMapEmptyCoords(n,function(e){var r,i=[],a=dy(t.nextDirection(n));try{for(a.s();!(r=a.n()).done;)for(var o=r.value,s=0,u=["diagonal","orthogonal"];s<u.length;s++){var c,l=u[s],f=kue.get().applyMoveWithoutPlacingCaptures(n,e,{direction:o,orientation:l}).captures.length,h=dy(t.captureCombinations(n,f));try{for(h.s();!(c=h.n()).done;){var d=c.value;i.push(new hue(e,o,l,d))}}catch(v){h.e(v)}finally{h.f()}}}catch(v){a.e(v)}finally{a.f()}return i})}},{key:"captureCombinations",value:function(e,t){if(0===t)return new Tte([{top:0,bottom:0,left:0,right:0}]);var n,r=new Tte,i=e.remainingSpacesDetails(),a=this.captureCombinations(e,t-1),o=dy(a);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.top+1<=i.top&&r.add(Yg(Yg({},s),{},{top:s.top+1})),s.bottom+1<=i.bottom&&r.add(Yg(Yg({},s),{},{bottom:s.bottom+1})),s.left+1<=i.left&&r.add(Yg(Yg({},s),{},{left:s.left+1})),s.right+1<=i.right&&r.add(Yg(Yg({},s),{},{right:s.right+1}))}}catch(u){o.e(u)}finally{o.f()}return 0===r.size()?a:r}},{key:"flatMapEmptyCoords",value:function(e,t){for(var n=[],r=0;r<mue.SIZE;r++)for(var i=0;i<mue.SIZE;i++){var a=new pte(i,r),o=e.getPieceAt(a);(o.isEmpty()&&!1===o.isUnreachable()||o.isLodestone()&&o.owner===e.getCurrentPlayer())&&(n=n.concat(t(a)))}return n}},{key:"nextDirection",value:function(e){var t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}},{key:"getBoardValue",value:function(e){var t,n=e.gameState.getScores();return t=24===n[0]&&24!==n[1]?e9.ZERO.getVictoryValue():24!==n[0]&&24===n[1]?e9.ONE.getVictoryValue():n[0]*e9.ZERO.getScoreModifier()+n[1]*e9.ONE.getScoreModifier(),new Ste(t)}}]),n}(Pte),wue=vue.UNREACHABLE,_ue=vue.EMPTY,Eue=pue.ZERO,bue=pue.ONE,Pue=gue.of(e9.ONE,{direction:"push",orientation:"orthogonal"}),Sue={top:NB.of(yue.EMPTY_5),bottom:NB.of(yue.EMPTY_5),left:NB.of(yue.EMPTY_5),right:NB.of(yue.EMPTY_5)},Oue=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(Io||(Io=Wg(["Board and aim of the game"]))),$localize(Ao||(Ao=Wg(["Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone."]))),mue.getInitialState()),Zte.forClick($localize(Mo||(Mo=Wg(["Selecting a lodestone"]))),$localize(xo||(xo=Wg(["To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally."]))),mue.getInitialState(),["#lodestone_push_diagonal"],$localize(Ro||(Ro=Wg(["Congratulations!"]))),$localize(No||(No=Wg(["This is not the right lodestone, try again."])))),Zte.informational($localize(Do||(Do=Wg(["The repelling lodestone"]))),$localize(Lo||(Lo=Wg(["Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured."]))),mue.getInitialState()),Zte.informational($localize(Fo||(Fo=Wg(["The attracting lodestone"]))),$localize(Uo||(Uo=Wg(["When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it."]))),mue.getInitialState()),Zte.informational($localize(Vo||(Vo=Wg(["Flipping the lodestone"]))),$localize(Bo||(Bo=Wg(["Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn."]))),mue.getInitialState()),Zte.fromPredicate($localize(zo||(zo=Wg(["Capturing"]))),$localize(Ho||(Ho=Wg(["To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates."]))),mue.getInitialState(),new hue(new pte(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),function(e,t,n){return 32===n.remainingSpaces()?UB.failure($localize(Go||(Go=Wg(["You have not captured any of the opponent's pieces, try again!"])))):UB.SUCCESS},"Congratulations!"),Zte.fromPredicate($localize($o||($o=Wg(["Crumbling a first pressure plate"]))),$localize(Zo||(Zo=Wg(["When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble."]))),new mue([[_ue,_ue,_ue,_ue,bue,_ue,_ue,_ue],[_ue,_ue,Eue,_ue,_ue,bue,_ue,_ue],[_ue,_ue,Pue,_ue,_ue,_ue,_ue,Eue],[_ue,_ue,_ue,_ue,bue,_ue,_ue,Eue],[_ue,_ue,_ue,_ue,_ue,Eue,_ue,_ue],[_ue,_ue,_ue,_ue,_ue,_ue,_ue,_ue],[_ue,_ue,_ue,_ue,_ue,_ue,_ue,_ue],[_ue,_ue,_ue,_ue,_ue,_ue,_ue,_ue]],0,new Lte([{key:e9.ONE,value:new pte(2,2)}]),Yg(Yg({},Sue),{},{top:yue.EMPTY_5.addCaptured(e9.ONE,4)})),new hue(new pte(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t,n){return 5===n.pressurePlates.top.get().width?UB.failure($localize(qo||(qo=Wg(["You must capture and place your capture on the top pressure plate to make it crumble!"])))):UB.SUCCESS},"Congratulations!"),Zte.fromPredicate($localize(Wo||(Wo=Wg(["Crumbling a second pressure plate"]))),$localize(jo||(jo=Wg(["Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble."]))),new mue([[wue,wue,wue,wue,wue,wue,wue,wue],[_ue,_ue,_ue,_ue,_ue,_ue,_ue,_ue],[_ue,_ue,_ue,_ue,_ue,_ue,_ue,Eue],[_ue,_ue,_ue,_ue,_ue,Eue,_ue,Eue],[_ue,Pue,_ue,_ue,bue,_ue,_ue,_ue],[_ue,_ue,_ue,_ue,_ue,_ue,_ue,_ue],[_ue,_ue,_ue,_ue,bue,_ue,_ue,_ue],[_ue,_ue,_ue,_ue,_ue,_ue,_ue,_ue]],0,new Lte([{key:e9.ONE,value:new pte(1,4)}]),Yg(Yg({},Sue),{},{top:yue.EMPTY_3.addCaptured(e9.ONE,2)})),new hue(new pte(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t,n){return n.pressurePlates.top.isPresent()?UB.failure($localize(Yo||(Yo=Wg(["You must capture and place your capture on the top pressure plate to make it crumble a second time!"])))):UB.SUCCESS},"Congratulations!"),Zte.informational($localize(Ko||(Ko=Wg(["Minimal board"]))),$localize(Qo||(Qo=Wg(["After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board."]))),new mue([[wue,wue,wue,wue,wue,wue,wue,wue],[wue,wue,wue,wue,wue,wue,wue,wue],[wue,wue,Eue,bue,_ue,_ue,wue,wue],[wue,wue,Pue,bue,_ue,_ue,wue,wue],[wue,wue,_ue,Eue,Eue,_ue,wue,wue],[wue,wue,Eue,_ue,_ue,_ue,wue,wue],[wue,wue,wue,wue,wue,wue,wue,wue],[wue,wue,wue,wue,wue,wue,wue,wue]],0,new Lte([{key:e9.ONE,value:new pte(2,3)}]),{top:NB.empty(),bottom:NB.empty(),left:NB.empty(),right:NB.empty()})),Zte.fromMove($localize(Xo||(Xo=Wg(["Making the lodestone fall"]))),$localize(Jo||(Jo=Wg(["If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!"]))),new mue([[_ue,_ue,_ue,_ue,_ue,_ue,_ue,_ue],[_ue,_ue,_ue,_ue,_ue,bue,_ue,_ue],[_ue,_ue,_ue,Pue,_ue,_ue,Eue,_ue],[_ue,_ue,Eue,Eue,bue,_ue,_ue,Eue],[_ue,_ue,_ue,_ue,_ue,Eue,_ue,_ue],[_ue,_ue,Eue,_ue,_ue,_ue,_ue,_ue],[_ue,_ue,bue,_ue,_ue,_ue,_ue,_ue],[_ue,_ue,_ue,_ue,_ue,_ue,_ue,_ue]],0,new Lte([{key:e9.ONE,value:new pte(3,2)}]),Yg(Yg({},Sue),{},{top:yue.EMPTY_5.addCaptured(e9.ONE,4)})),[new hue(new pte(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize(es||(es=Wg(["Congratulations! At your next turn, you will be allowed to place your lodestone on any side."]))),$localize(ts||(ts=Wg(["Failed, try again."])))),Zte.fromMove($localize(ns||(ns=Wg(["End of the game"]))),$localize(rs||(rs=Wg(["In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!"]))),new mue([[wue,wue,wue,wue,wue,wue,wue,wue],[wue,wue,wue,wue,wue,wue,wue,wue],[wue,bue,Eue,bue,_ue,_ue,wue,wue],[wue,bue,Pue,_ue,bue,_ue,wue,wue],[wue,_ue,_ue,Eue,Eue,_ue,wue,wue],[wue,bue,Eue,_ue,bue,_ue,wue,wue],[wue,_ue,_ue,_ue,Eue,_ue,wue,wue],[wue,wue,wue,wue,wue,wue,wue,wue]],0,new Lte([{key:e9.ONE,value:new pte(2,3)}]),{top:NB.empty(),bottom:yue.EMPTY_3.addCaptured(e9.ZERO,2),left:NB.of(yue.EMPTY_3),right:NB.empty()}),[new hue(new pte(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize(is||(is=Wg(["Congratulations, you won!"]))),$localize(as||(as=Wg(["This is not the winning move. Try again."]))))]});function Tue(e,t){if(1&e&&(NC(),OP(0,"circle",10)),2&e){var n=LP(2),r=n.index,i=n.$implicit,a=LP().index,o=LP();VP("id","piece_",r,"_",a,""),EP("ngClass",i.pieceClasses),pP("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Iue(e,t){if(1&e&&(NC(),OP(0,"polygon",15)),2&e){var n=LP().$implicit,r=LP(3).$implicit,i=LP(2);kP("transform","rotate(",90*n,")"),EP("ngClass",r.lodestone.movingClass),pP("points",i.TRIANGLE_OUT)}}function Aue(e,t){if(1&e&&(NC(),OP(0,"polygon",15)),2&e){var n=LP().$implicit,r=LP(3).$implicit,i=LP(2);kP("transform","rotate(",90*n,")"),EP("ngClass",r.lodestone.movingClass),pP("points",i.TRIANGLE_IN)}}function Mue(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Iue,1,3,"polygon",14),CP(2,Aue,1,3,"polygon",14),SP()),2&e){var n=LP(3).$implicit;BE(1),EP("ngIf","push"===n.lodestone.direction),BE(1),EP("ngIf","pull"===n.lodestone.direction)}}var xue=function(){return[0,1,2,3]};function Rue(e,t){if(1&e&&(NC(),PP(0,"g",11),OP(1,"circle",12),OP(2,"circle",13),PP(3,"g"),CP(4,Mue,3,2,"g",1),SP(),SP()),2&e){var n=LP(2),r=n.index,i=n.$implicit,a=LP().index,o=LP();pP("transform",o.getSquareTransform(r,a)),BE(1),EP("ngClass",i.lodestone.selectedClass),pP("r",o.PIECE_RADIUS),BE(1),EP("ngClass",i.lodestone.pieceClasses),pP("r",o.PIECE_RADIUS/4),BE(1),kP("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),BE(1),EP("ngForOf",AT(7,xue))}}function Nue(e,t){if(1&e){var n=AP();NC(),PP(0,"g",6),RP("click",function(){aC(n);var e=LP().$implicit;return LP(2).selectCoord(e.coord)}),OP(1,"rect",7),CP(2,Tue,1,6,"circle",8),CP(3,Rue,5,8,"g",9),SP()}if(2&e){var r=LP(),i=r.index,a=r.$implicit,o=LP().index,s=LP();VP("id","square_",i,"_",o,""),BE(1),EP("ngClass",a.squareClasses),pP("x",s.SPACE_SIZE*i+s.STROKE_WIDTH)("y",s.SPACE_SIZE*o+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),BE(1),EP("ngIf",a.hasPiece),BE(1),EP("ngIf",a.lodestone)}}function Due(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Nue,4,9,"g",5),SP()),2&e){var n=t.$implicit;BE(1),EP("ngIf",!1===n.crumbled)}}function Lue(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Due,2,1,"g",1),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function Fue(e,t){if(1&e&&(NC(),PP(0,"g",16),OP(1,"circle",17),SP()),2&e){var n=t.$implicit,r=t.index,i=LP();UP("id","capture_",r,""),pP("transform",i.getCaptureTransform(r)),BE(1),EP("ngClass",n.pieceClasses),pP("r",i.PIECE_RADIUS)}}function Uue(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"polygon",15),SP()),2&e){var n=t.$implicit,r=LP().$implicit,i=LP();BE(1),kP("transform","rotate(",90*n,")"),EP("ngClass",r.movingClass),pP("points","push"===r.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function Vue(e,t){if(1&e){var n=AP();NC(),PP(0,"g",6),RP("click",function(){var e=aC(n).$implicit;return LP().selectLodestone(e)}),OP(1,"circle",12),OP(2,"circle",13),PP(3,"g"),CP(4,Uue,2,3,"g",1),SP(),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP();VP("id","lodestone_",r.direction,"_",r.orientation,""),pP("transform",a.getAvailableLodestoneTransform(i)),BE(1),EP("ngClass",r.selectedClass),pP("r",a.PIECE_RADIUS),BE(1),EP("ngClass",r.pieceClasses),pP("r",a.PIECE_RADIUS/4),BE(1),kP("transform","rotate(","diagonal"===r.orientation?45:0,")"),BE(1),EP("ngForOf",AT(9,xue))}}function Bue(e,t){if(1&e&&(NC(),OP(0,"circle",10)),2&e){var n=LP(),r=n.index,i=n.$implicit,a=LP().$implicit,o=LP();VP("id","platePiece_",a.position,"_",r,""),EP("ngClass",i.pieceClasses),pP("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*i.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function zue(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"g",6),RP("click",function(){var e=aC(n),t=e.$implicit,r=e.index,i=LP().$implicit;return LP().onPressurePlateClick(t.temporary,i.position,r)}),OP(2,"rect",18),CP(3,Bue,1,6,"circle",8),SP(),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP().$implicit,o=LP();pP("transform",o.getPressurePlateTransform(a.position)),BE(1),VP("id","plate_",a.position,"_",i,""),BE(1),VP("id","plateSquare_",a.position,"_",i,""),EP("ngClass",r.squareClasses),pP("x",o.SPACE_SIZE*r.coord.x+o.STROKE_WIDTH)("y",o.SPACE_SIZE*r.coord.y+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),BE(1),EP("ngIf",r.hasPiece)}}function Hue(e,t){if(1&e&&(NC(),PP(0,"g",16),CP(1,zue,4,11,"g",1),SP()),2&e){var n=t.$implicit;UP("id","pressurePlate_",n.position,""),BE(1),EP("ngForOf",n.coords)}}function Gue(e,t){if(1&e&&(NC(),OP(0,"rect",19)),2&e){var n=LP();VP("id","selection_",n.viewInfo.selected.get().x,"_",n.viewInfo.selected.get().y,""),pP("x",n.SPACE_SIZE*n.viewInfo.selected.get().x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.viewInfo.selected.get().y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}var $ue=function(e){iy(n,e);var t=oy(n);function n(e){var r;gy(this,n),(r=t.call(this,e)).viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:NB.empty(),pressurePlateShift:{top:new ute(0,0),left:new ute(0,0),right:new ute(0,0),bottom:new ute(0,0)}},r.stateAfterPlacingLodestone=NB.empty(),r.lastInfos=NB.empty(),r.capturesToPlace=0,r.selectedCoord=NB.empty(),r.selectedLodestone=NB.empty(),r.captures={top:0,bottom:0,left:0,right:0},r.rules=kue.get(),r.tutorial=(new Oue).tutorial,r.availableMinimaxes=[new Cue(r.rules,"LodestoneDummyMinimax")],r.encoder=hue.encoder,r.PIECE_RADIUS=.5*(r.SPACE_SIZE-2*r.STROKE_WIDTH);var i=.8*r.PIECE_RADIUS,a=.3*r.PIECE_RADIUS,o=.2*r.PIECE_RADIUS;return r.TRIANGLE_OUT="".concat(i,",0 ").concat(a,",").concat(o," ").concat(a,",-").concat(o),r.TRIANGLE_IN="".concat(a,",0 ").concat(i,",").concat(a," ").concat(i,",-").concat(a),r.displayedState=r.getState(),r.scores=NB.of([0,0]),r}return my(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"selectCoord",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.capturesToPlace>0)){n.next=5;break}return n.abrupt("return",t.cancelMove(due.MUST_PLACE_CAPTURES()));case 5:return i=kue.get().isTargetLegal(t.getState(),e),n.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):t.selectedCoord.equalsValue(e)?(t.cancelMoveAttempt(),UB.SUCCESS):(t.selectedCoord=NB.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),UB.SUCCESS)));case 7:case"end":return n.stop()}},n)}))()}},{key:"selectLodestone",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return F7(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed"),i=t.getCurrentPlayer(),a=gue.of(i,e),n.abrupt("return",t.selectedLodestone.equalsValue(a)?(t.cancelMoveAttempt(),UB.SUCCESS):(t.selectedLodestone=NB.of(a),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),UB.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"putLodestone",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return F7(e.selectedCoord.isPresent(),"coord should have been selected"),F7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=e.getState(),F7(kue.get().isLegalWithoutCaptures(i,n,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves"),a=kue.get().applyMoveWithoutPlacingCaptures(i,n,r),t.abrupt("return",(e.lastInfos=NB.of(a),e.capturesToPlace=Math.min(a.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(a.board),e.stateAfterPlacingLodestone=NB.of(e.displayedState),e.updateViewInfo(),UB.SUCCESS)));case 5:case"end":return t.stop()}},t)}))()}},{key:"applyMove",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return F7(e.selectedCoord.isPresent(),"coord should have been selected"),F7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=new hue(n,r.direction,r.orientation,e.captures),t.abrupt("return",e.chooseMove(i,e.getState()));case 3:case"end":return t.stop()}},t)}))()}},{key:"onPressurePlateClick",value:function(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}},{key:"selectPressurePlate",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(0!==n.capturesToPlace){r.next=5;break}return r.abrupt("return",n.cancelMove(due.NO_CAPTURES_TO_PLACE_YET()));case 5:return n.capturesToPlace--,n.captures[e]++,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=i9.copyBiArray(a.board),u=Yg({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(kue.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new mue(s,a.turn,c,u),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),UB.SUCCESS)));case 8:case"end":return r.stop()}},r)}))()}},{key:"deselectPressurePlate",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.capturesToPlace++,n.captures[e]--,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=i9.copyBiArray(a.board),u=Yg({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(kue.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new mue(s,a.turn,c,u),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),UB.SUCCESS));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=NB.of(this.getState().getScores())}},{key:"cancelMoveAttempt",value:function(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=NB.empty(),this.lastInfos=NB.empty();var e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){var t=i9.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=vue.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=NB.empty(),this.selectedLodestone=NB.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}},{key:"updateViewInfo",value:function(){var e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}},{key:"showBoard",value:function(){this.viewInfo.boardInfo=[];for(var e=0;e<mue.SIZE;e++){this.viewInfo.boardInfo.push([]);for(var t=0;t<mue.SIZE;t++){var n=new pte(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:NB.empty()}},{key:"getSquareInfo",value:function(e){var t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}},{key:"showAvailableLodestones",value:function(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{var e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){var n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}},{key:"showCapturesToPlace",value:function(){var e=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(var t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}},{key:"nextLodestone",value:function(e,t){var n=gue.of(e,t),r={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return r.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(r.selectedClass="selected-stroke"),r}},{key:"showPressurePlates",value:function(){this.viewInfo.pressurePlates=[];var e,t=dy(yue.POSITIONS);try{for(t.s();!(e=t.n()).done;){var r=e.value,i=[],a=this.displayedState.pressurePlates[r];if(a.isPresent())for(var o=n.PRESSURE_PLATES_POSITIONS.get(r).get(),s=a.get().width,u=5===s?o.startForBigPlate:o.startForSmallPlate,c=0;c<s;c++){u=u.getNext(o.direction);var l=a.get().getPieceAt(c),f="";l.isPlayerPiece()&&(f=this.getPlayerClass(l.owner)),i.push({coord:u,hasPiece:l.isPlayerPiece(),pieceClasses:[f],squareClasses:[],temporary:!1})}this.viewInfo.pressurePlates.push({position:r,coords:i})}}catch(h){t.e(h)}finally{t.f()}}},{key:"showLastMove",value:function(){var e=this.rules.node.mother.get().gameState,t=this.rules.node.move.get();this.lastInfos=NB.of(kue.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();var n=this.getState();this.showPressurePlateDifferences(e,n,!1)}},{key:"showPressurePlateDifferences",value:function(e,t,n){var r,i=dy(yue.POSITIONS);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.showPressurePlateDifference(e.pressurePlates[a],t.pressurePlates[a],a,n)}}catch(o){i.e(o)}finally{i.f()}}},{key:"showPressurePlateDifference",value:function(e,t,n,r){if(e.isPresent()&&t.isPresent()){var i=e.get(),a=t.get(),o=IB.getNonNullable(this.viewInfo.pressurePlates.find(function(e){return e.position===n}));if(i.width===a.width)for(var s=0;s<a.width;s++){var u=i.getPieceAt(s),c=a.getPieceAt(s);!1===u.equals(c)&&(o.coords[s].squareClasses.push("moved-fill"),o.coords[s].temporary=r,r&&o.coords[s].pieceClasses.push("semi-transparent"))}else{var l,f=dy(o.coords);try{for(f.s();!(l=f.n()).done;){l.value.squareClasses.push("moved-fill")}}catch(h){f.e(h)}finally{f.f()}}}}},{key:"showMovedAndCaptured",value:function(e){var t,n=dy(e.moved);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill")}}catch(s){n.e(s)}finally{n.f()}var i,a=dy(e.captures);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("captured-fill")}}catch(s){a.e(s)}finally{a.f()}}},{key:"computePressurePlateShift",value:function(){var e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),r=this.getPressurePlateShift(e.pressurePlates.top),i=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new pte(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new pte(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new pte(0,.5*(r-i)),this.viewInfo.pressurePlateShift.right=new pte(0,.5*(r-i))}},{key:"getPressurePlateShift",value:function(e){return e.isAbsent()?2:3===e.get().width?1:0}},{key:"getSquareTransform",value:function(e,t){return"translate(".concat(e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,", ").concat(t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getCaptureTransform",value:function(e){return"translate(".concat((e+(mue.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getAvailableLodestoneTransform",value:function(e){return"translate(".concat((e+(mue.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getPressurePlateTransform",value:function(e){return"translate(".concat(this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE,", ").concat(this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE,")")}}]),n}(gte);$ue.PRESSURE_PLATE_EXTRA_SHIFT=.2,$ue.PRESSURE_PLATES_POSITIONS=Lte.from({top:{startForBigPlate:new pte(.5,-1-$ue.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new pte(1.5,0-$ue.PRESSURE_PLATE_EXTRA_SHIFT),direction:fte.RIGHT},bottom:{startForBigPlate:new pte(.5,8+$ue.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new pte(1.5,7+$ue.PRESSURE_PLATE_EXTRA_SHIFT),direction:fte.RIGHT},left:{startForBigPlate:new pte(-1-$ue.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new pte(0-$ue.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:fte.DOWN},right:{startForBigPlate:new pte(8+$ue.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new pte(7+$ue.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:fte.DOWN}}),$ue.\u0275fac=function(e){return new(e||$ue)(_P(D7))},$ue.\u0275cmp=vk({type:$ue,selectors:[["app-lodestone"]],features:[nP],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,Lue,2,1,"g",1),CP(2,Fue,2,4,"g",2),CP(3,Vue,5,10,"g",3),CP(4,Hue,2,2,"g",2),CP(5,Gue,1,6,"rect",4),SP()),2&e&&(BE(1),EP("ngForOf",t.viewInfo.boardInfo),BE(1),EP("ngForOf",t.viewInfo.capturesToPlace),BE(1),EP("ngForOf",t.viewInfo.availableLodestones),BE(1),EP("ngForOf",t.viewInfo.pressurePlates),BE(1),EP("ngIf",t.viewInfo.selected.isPresent()))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Zue=function(){var e=my(function e(){gy(this,e)});return e.START_COORD_OUT_OF_RANGE=function(){return $localize(os||(os=Wg(["Start coord cannot be out of range"])))},e.END_COORD_OUT_OF_RANGE=function(){return $localize(ss||(ss=Wg(["End coord cannot be out of range"])))},e.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=function(){return $localize(us||(us=Wg(["Pawns must move one step diagonally."])))},e.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=function(){return $localize(cs||(cs=Wg(["Drones must move one or two steps in any direction."])))},e}(),que=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r)).calledTheClock=i,a}return my(n,[{key:"toString",value:function(){return"MartianChessMove(("+this.coord.x+", "+this.coord.y+") -> ("+this.end.x+", "+this.end.y+")"+(this.calledTheClock?", CALL_THE_CLOCK":"")+")"}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.end.equals(e.end)&&this.calledTheClock===e.calledTheClock}},{key:"isValidForPawn",value:function(){var e=Math.abs(this.coord.x-this.end.x),t=Math.abs(this.coord.y-this.end.y);return 1===e&&1===t}},{key:"isValidForDrone",value:function(){return this.coord.getDistance(this.end)<=2}},{key:"isUndoneBy",value:function(e){if(e.isAbsent())return!1;var t=e.get();return t.end.equals(this.coord)&&t.coord.equals(this.end)}}],[{key:"from",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.isNotInRange(4,8))return DB.failure(Zue.START_COORD_OUT_OF_RANGE());if(t.isNotInRange(4,8))return DB.failure(Zue.END_COORD_OUT_OF_RANGE());if(t.equals(e))return DB.failure(bte.MOVE_CANNOT_BE_STATIC());var i=fte.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?DB.failure(i.getReason()):DB.success(new n(e,t,r))}}]),n}(Fne);que.encoder=Q7.tuple([pte.numberEncoder(4,8),pte.numberEncoder(4,8),Q7.booleanEncoder],function(e){return[e.coord,e.end,e.calledTheClock]},function(e){return que.from(e[0],e[1],e[2]).get()});var Wue=function(){function e(t){gy(this,e),this.value=t}return my(e,[{key:"getValue",value:function(){return this.value}},{key:"equals",value:function(e){return this.getValue()===e.getValue()}}],[{key:"tryMerge",value:function(t,n){F7(t!==e.EMPTY&&n!==e.EMPTY,"tryMerge cannot be called with empty pieces");var r=t.value+n.value;return 2===r||3===r?NB.of(e.from(r)):NB.empty()}},{key:"from",value:function(t){return t===e.DRONE.value?e.DRONE:(IB.expectToBe(t,e.QUEEN.value),e.QUEEN)}}]),e}();Wue.EMPTY=new Wue(0),Wue.PAWN=new Wue(1),Wue.DRONE=new Wue(2),Wue.QUEEN=new Wue(3);var jue=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e,r)).ruler=e,i}return my(n,[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=n.getCurrentPlayer(),i=[],a=dy(n.getPlayerTerritory(r));try{for(a.s();!(t=a.n()).done;)for(var o=t.value,s=0;s<4;s++)switch(n.getPieceAtXY(s,o)){case Wue.PAWN:i=i.concat(this.getMovesForPawnAt(n,s,o));break;case Wue.DRONE:i=i.concat(this.getMovesForDroneAt(n,s,o));break;case Wue.QUEEN:i=i.concat(this.getMovesForQueenAt(n,s,o))}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"getMovesForPawnAt",value:function(e,t,n){var r,i=new pte(t,n),a=[],o=dy(fte.DIAGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=i.getNext(s);u.isInRange(4,8)&&a.push(u)}}catch(c){o.e(c)}finally{o.f()}return this.addLegalMoves(e,i,a)}},{key:"addLegalMoves",value:function(e,t,n){var r,i=[],a=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(Wue.DRONE),s=!1===e.isTherePieceOnPlayerSide(Wue.QUEEN),u=e.lastMove,c=dy(n);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=e.getPieceAt(l);if(f===Wue.EMPTY)this.add(i,que.from(t,l).get(),u);else if(e.isInPlayerTerritory(l)){var h=Wue.tryMerge(f,a);if(h.isPresent()){var d=h.get(),v=que.from(t,l).get();(d===Wue.DRONE&&o||d===Wue.QUEEN&&s)&&this.add(i,v,u)}}else this.add(i,que.from(t,l).get(),u)}}catch(p){c.e(p)}finally{c.f()}return i}},{key:"add",value:function(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}},{key:"getMovesForDroneAt",value:function(e,t,n){var r=new pte(t,n),i=this.getLandingCoordsForLinearMove(r,e,2);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForLinearMove",value:function(e,t,n){var r,i=[],a=dy(fte.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){for(var o=r.value,s=1,u=e.getNext(o,s),c=t.tryToGetPieceAt(u),l=c.equalsValue(Wue.EMPTY);l;)i.push(u),s++,u=e.getNext(o,s),l=(c=t.tryToGetPieceAt(u)).equalsValue(Wue.EMPTY)&&s<n;c.isPresent()&&i.push(u)}}catch(f){a.e(f)}finally{a.f()}return i}},{key:"getMovesForQueenAt",value:function(e,t,n){var r=new pte(t,n),i=this.getLandingCoordsForQueen(r,e);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForQueen",value:function(e,t){return this.getLandingCoordsForLinearMove(e,t,8)}},{key:"getBoardValue",value:function(e){var t,n=this.ruler.getGameStatus(e);if(n.isEndGame)t=n.toBoardValue();else{var r=e.gameState.getScoreOf(e9.ZERO);t=e.gameState.getScoreOf(e9.ONE)-r}return new Ste(t)}}]),n}(Pte),Yue=function(){function e(t){gy(this,e),this.captures=t,t.makeImmutable()}return my(e,[{key:"toValue",value:function(){var e=0;return this.captures.forEach(function(t){e+=t.key.getValue()*t.value}),e}},{key:"add",value:function(t){var n=this.captures.getCopy();return e.addToMap(n,t),new e(n)}}],[{key:"from",value:function(t){var n,r=new Lte,i=dy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e.addToMap(r,a)}}catch(o){i.e(o)}finally{i.f()}return new e(r)}},{key:"addToMap",value:function(e,t){var n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}}]),e}(),Kue=function(e){iy(n,e);var t=oy(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NB.empty(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NB.empty(),s=arguments.length>4?arguments[4]:void 0;return gy(this,n),(i=t.call(this,e,r)).lastMove=a,i.countDown=o,null==s&&(s=new Lte([{key:e9.ZERO,value:Yue.from([])},{key:e9.ONE,value:Yue.from([])}])),s.makeImmutable(),i.captured=s,i}return my(n,[{key:"getPlayerTerritory",value:function(e){return e===e9.ZERO?n.PLAYER_ZERO_TERRITORY:n.PLAYER_ONE_TERRITORY}},{key:"isTherePieceOnPlayerSide",value:function(e){var t,n=this.getCurrentPlayer(),r=dy(this.getPlayerTerritory(n));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0;a<4;a++)if(this.getPieceAtXY(a,i)===e)return!0}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"getScoreOf",value:function(e){return this.captured.get(e).get().toValue()}},{key:"getEmptyTerritory",value:function(){return this.isTerritoryEmpty(e9.ZERO)?NB.of(e9.ZERO):this.isTerritoryEmpty(e9.ONE)?NB.of(e9.ONE):NB.empty()}},{key:"isTerritoryEmpty",value:function(e){var t,n=dy(this.getPlayerTerritory(e));try{for(n.s();!(t=n.n()).done;)for(var r=t.value,i=0;i<4;i++)if(this.getPieceAtXY(i,r)!==Wue.EMPTY)return!1}catch(a){n.e(a)}finally{n.f()}return!0}},{key:"isInOpponentTerritory",value:function(e){var t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}},{key:"isInPlayerTerritory",value:function(e){var t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}},{key:"getCapturesOf",value:function(e){var t=this.captured.get(e).get();return[t.captures.get(Wue.PAWN).getOrElse(0),t.captures.get(Wue.DRONE).getOrElse(0),t.captures.get(Wue.QUEEN).getOrElse(0)]}}],[{key:"getInitialState",value:function(){var e=Wue.EMPTY,t=Wue.PAWN,r=Wue.DRONE,i=Wue.QUEEN;return new n([[i,i,r,e],[i,r,t,e],[r,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,r],[e,t,r,i],[e,r,i,i]],0,NB.empty())}}]),n}(Ate);Kue.PLAYER_ZERO_TERRITORY=new Tte([4,5,6,7]),Kue.PLAYER_ONE_TERRITORY=new Tte([0,1,2,3]);var Que=function(){var e=my(function e(){gy(this,e)});return e.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=function(){return $localize(ls||(ls=Wg(["You must pick a piece from your side of the board in order to move it."])))},e.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=function(){return $localize(fs||(fs=Wg(["This is not a valid promotion nor a valid capture."])))},e.CANNOT_UNDO_LAST_MOVE=function(){return $localize(hs||(hs=Wg(["You cannot perform a move that is the reverse of the previous one."])))},e}(),Xue=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,r){var i=t.getCopiedBoard();i[e.coord.y][e.coord.x]=Wue.EMPTY,i[e.end.y][e.end.x]=r.finalPiece;var a=r.score,o=t.countDown;if(o.isPresent())if(this.isCapture(e,t))o=n.STARTING_COUNT_DOWN;else{var s=t.countDown.get();o=NB.of(s-1)}return e.calledTheClock&&(o=n.STARTING_COUNT_DOWN),new Kue(i,t.turn+1,NB.of(e),o,a)}},{key:"isLegal",value:function(e,t){this.assertNonDoubleClockCall(e,t);var n=this.isLegalMove(e,t);if(n.isFailure())return DB.failure(n.getReason());if(e.isUndoneBy(t.lastMove))return DB.failure(Que.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);var r=t.getPieceAt(e.coord),i=t.captured.getCopy();if(this.isCapture(e,t)){var a=t.getCurrentPlayer(),o=i.get(a).get(),s=t.getPieceAt(e.end);o=o.add(s),i.replace(a,o),i.makeImmutable()}return DB.success({finalPiece:r,score:i})}},{key:"assertNonDoubleClockCall",value:function(e,t){F7(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}},{key:"isCapture",value:function(e,t){var n=t.isInOpponentTerritory(e.end),r=t.getPieceAt(e.end)!==Wue.EMPTY;return n&&r}},{key:"isFieldPromotion",value:function(e,t){var n=t.isInPlayerTerritory(e.end),r=t.getPieceAt(e.end)!==Wue.EMPTY;return n&&r}},{key:"isLegalFieldPromotion",value:function(e,t){var n=this.getPromotedPiece(e,t);if(n.isAbsent())return DB.failure(Que.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var r=n.get();if(t.isTherePieceOnPlayerSide(r))return DB.failure(Que.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var i={finalPiece:r,score:t.captured.getCopy()};return DB.success(i)}},{key:"isLegalMove",value:function(e,t){if(!1===t.isInPlayerTerritory(e.coord))return DB.failure(Que.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());var n=t.getPieceAt(e.coord);if(n===Wue.EMPTY)return DB.failure(bte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===Wue.PAWN)return e.isValidForPawn()?DB.success(void 0):DB.failure(Zue.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(n===Wue.DRONE&&!1===e.isValidForDrone())return DB.failure(Zue.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());var r,i=dy(e.coord.getUntil(e.end));try{for(i.s();!(r=i.n()).done;){var a=r.value;if(t.getPieceAt(a)!==Wue.EMPTY)return DB.failure(bte.SOMETHING_IN_THE_WAY())}}catch(o){i.e(o)}finally{i.f()}return DB.success(void 0)}},{key:"getPromotedPiece",value:function(e,t){var n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end);return Wue.tryMerge(n,r)}},{key:"getGameStatus",value:function(e){var t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,Bte.DRAW);if(t.getEmptyTerritory().isPresent()){var n=t.getCurrentOpponent(),r=Bte.getVictory(n);return this.getGameStatusScoreVictoryOr(t,r)}return Bte.ONGOING}},{key:"getGameStatusScoreVictoryOr",value:function(e,t){var n=e.getScoreOf(e9.ZERO),r=e.getScoreOf(e9.ONE);return n>r?Bte.ZERO_WON:r>n?Bte.ONE_WON:t}}]),n}(zte);Xue.STARTING_COUNT_DOWN=NB.of(7);var Jue=function(){var e=my(function e(){gy(this,e)});return e.YOU_DID_NOT_CAPTURE_ANY_PIECE=function(){return $localize(ds||(ds=Wg(["Failed, you did not capture any piece."])))},e}(),ece=Wue.EMPTY,tce=Wue.PAWN,nce=Wue.DRONE,rce=Wue.QUEEN,ice=function(){return $localize(vs||(vs=Wg(["This is not a field promotion!"])))},ace=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(ps||(ps=Wg(["Goal of the game"]))),$localize(gs||(gs=Wg(["At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal."]))),Kue.getInitialState()),Zte.informational($localize(ys||(ys=Wg(["The pieces"]))),$localize(ms||(ms=Wg(["The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>"]))),Kue.getInitialState()),Zte.fromPredicate($localize(ks||(ks=Wg(["Moving pawns"]))),$localize(Cs||(Cs=Wg(["Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn."]))),Kue.getInitialState(),que.from(new pte(2,5),new pte(1,4)).get(),function(e,t,n){return n.getPieceAt(e.end)===Wue.PAWN?UB.SUCCESS:UB.failure($localize(ws||(ws=Wg(["This is not a pawn!"]))))},$localize(_s||(_s=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(Es||(Es=Wg(["Moving drones"]))),$localize(bs||(bs=Wg(["Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone."]))),Kue.getInitialState(),que.from(new pte(1,7),new pte(0,7)).get(),function(e,t,n){return n.getPieceAt(e.end)===Wue.DRONE?UB.SUCCESS:UB.failure($localize(Ps||(Ps=Wg(["This is not a drone!"]))))},$localize(Ss||(Ss=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(Os||(Os=Wg(["Moving queens"]))),$localize(Ts||(Ts=Wg(["Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen."]))),new Kue([[nce,tce,ece,ece],[rce,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,rce,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[rce,nce,tce,ece]],1),que.from(new pte(2,3),new pte(2,7)).get(),function(e,t,n){return n.getPieceAt(e.end)===Wue.QUEEN?UB.SUCCESS:UB.failure($localize(Is||(Is=Wg(["This is not a queen!"]))))},$localize(As||(As=Wg(["Congratulations!"])))),Zte.fromMove($localize(Ms||(Ms=Wg(["Capture"]))),$localize(xs||(xs=Wg(["When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it."]))),new Kue([[nce,tce,tce,ece],[ece,ece,ece,ece],[rce,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,tce,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,nce,tce,ece]],1),[que.from(new pte(0,2),new pte(2,4)).get()],$localize(Rs||(Rs=Wg(["Congratulations! By capturing that pawn, you won one point."]))),Jue.YOU_DID_NOT_CAPTURE_ANY_PIECE()),Zte.fromMove($localize(Ns||(Ns=Wg(["Field Promotion (1/2)"]))),$localize(Ds||(Ds=Wg(["It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it."]))),new Kue([[ece,ece,ece,rce],[ece,tce,ece,ece],[ece,ece,tce,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,rce],[ece,ece,nce,ece],[ece,tce,ece,ece]],1),[que.from(new pte(1,1),new pte(2,2)).get(),que.from(new pte(2,2),new pte(1,1)).get()],$localize(Ls||(Ls=Wg(["Congratulations!"]))),ice()),Zte.fromPredicate($localize(Fs||(Fs=Wg(["Field Promotion (2/2)"]))),$localize(Us||(Us=Wg(["The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it."]))),new Kue([[tce,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,nce,ece],[ece,tce,ece,ece]],0),que.from(new pte(1,7),new pte(2,6)).get(),function(e,t,n){return n.getPieceAt(e.end)===Wue.QUEEN?UB.SUCCESS:UB.failure(ice())},$localize(Vs||(Vs=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(Bs||(Bs=Wg(["Call the clock"]))),$localize(zs||(zs=Wg(['When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You\'re playing Dark. Call the clock and perform a move.']))),Kue.getInitialState(),que.from(new pte(1,5),new pte(0,4),!0).get(),function(e,t,n){return e.calledTheClock?UB.SUCCESS:UB.failure($localize(Hs||(Hs=Wg(["You did not call the clock!"]))))},$localize(Gs||(Gs=Wg(["Congratulations!"])))),Zte.fromMove($localize($s||($s=Wg(["Restarting the clock"]))),$localize(Zs||(Zs=Wg(["If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You are playing Dark, do a capture to restart the countdown."]))),new Kue([[ece,ece,ece,ece],[ece,tce,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,tce],[ece,ece,nce,ece],[ece,tce,ece,ece]],15,NB.empty(),NB.of(1)),[que.from(new pte(1,1),new pte(2,2)).get()],$localize(qs||(qs=Wg(["Congratulations!"]))),$localize(Ws||(Ws=Wg(["This is not a capture, the game is now over, please retry!"])))),Zte.anyMove($localize(js||(js=Wg(["End game (by clock)"]))),$localize(Ys||(Ys=Wg(["When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You are playing Dark, do the last move."]))),new Kue([[ece,ece,ece,rce],[ece,tce,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[nce,ece,ece,ece],[ece,ece,ece,ece],[ece,nce,ece,ece]],15,NB.empty(),NB.of(1)),que.from(new pte(1,1),new pte(2,2)).get(),$localize(Ks||(Ks=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(Qs||(Qs=Wg(["End by emptyness"]))),$localize(Xs||(Xs=Wg(["When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!"]))),new Kue([[ece,ece,ece,rce],[ece,tce,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,tce,ece],[ece,ece,ece,ece],[ece,ece,ece,ece],[ece,ece,ece,ece]],0),que.from(new pte(2,4),new pte(1,3)).get(),function(e,t,n){return 3===e.end.y?UB.SUCCESS:UB.failure($localize(Js||(Js=Wg(["Your piece is still in you territory!"]))))},$localize(eu||(eu=Wg(["Congratulations!"]))))]});function oce(e,t){if(1&e&&(NC(),OP(0,"g",19)),2&e){var n=LP(2).index,r=LP().index,i=LP();QP(i.style),VP("mainShapeId","pawn_",n,"_",r,""),EP("pieceClasses",i.getPieceClasses(n,r))}}function sce(e,t){if(1&e&&(NC(),OP(0,"g",20)),2&e){var n=LP(2).index,r=LP().index,i=LP();QP(i.style),VP("mainShapeId","drone_",n,"_",r,""),EP("pieceClasses",i.getPieceClasses(n,r))}}function uce(e,t){if(1&e&&(NC(),OP(0,"g",21)),2&e){var n=LP(2).index,r=LP().index,i=LP();QP(i.style),VP("mainShapeId","queen_",n,"_",r,""),EP("pieceClasses",i.getPieceClasses(n,r))}}function cce(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,oce,1,5,"g",16),CP(2,sce,1,5,"g",17),CP(3,uce,1,5,"g",18),SP()),2&e){var n=LP(),r=n.index,i=n.$implicit,a=LP().index,o=LP();pP("transform",o.getPieceLocation(r,a)),BE(1),EP("ngIf",i===o.pieces.PAWN),BE(1),EP("ngIf",i===o.pieces.DRONE),BE(1),EP("ngIf",i===o.pieces.QUEEN)}}function lce(e,t){if(1&e){var n=AP();NC(),PP(0,"g",14),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),OP(1,"rect",15),CP(2,cce,4,4,"g",13),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP().index,o=LP();VP("id","click_",i,"_",a,""),pP("transform","translate(0,  "+(a<=3?0:2*o.STROKE_WIDTH)+")"),BE(1),VP("id","square_",i,"_",a,""),EP("ngClass",o.getSquareClasses(i,a)),pP("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),BE(1),EP("ngIf",r!==o.pieces.EMPTY)}}function fce(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",22),RP("click",function(){var e=aC(n).$implicit;return LP(3).onClick(e.x,e.y)}),SP(),SP()}if(2&e){var r=t.$implicit,i=LP(3);BE(1),VP("id","indicator_",r.x,"_",r.y,""),pP("transform","translate(0,  "+(r.y<=3?0:2*i.STROKE_WIDTH)+")")("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}function hce(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,fce,2,7,"g",1),SP()),2&e){var n=LP(2);BE(1),EP("ngForOf",n.selectedPieceInfo.get().legalLandings)}}function dce(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,lce,3,11,"g",12),CP(2,hce,2,1,"g",13),SP()),2&e){var n=t.$implicit,r=LP();pP("transform","translate("+r.SPACE_SIZE+", 0)"),BE(1),EP("ngForOf",n),BE(1),EP("ngIf",r.selectedPieceInfo.isPresent())}}function vce(e,t){if(1&e&&(NC(),PP(0,"text",23),uS(1),SP()),2&e){var n=LP();EP("ngClass","player"+n.getCurrentPlayer().value)("ngClass",n.getClockCircleClasses()),pP("x",.5*n.SPACE_SIZE)("y",.5*n.SPACE_SIZE),BE(1),cS(n.countDown.get())}}function pce(e,t){if(1&e&&(NC(),OP(0,"polyline",24)),2&e){var n=LP();EP("ngClass",n.getClockCircleClasses()),pP("points",n.clockNeedlesPoints)}}var gce=function(e){return[e]};function yce(e,t){if(1&e){var n=AP();NC(),TP(0),PP(1,"g",27),RP("click",function(){var e=aC(n).index;return LP(2).chooseStyle(e)}),SP(),IP()}if(2&e){var r=t.$implicit,i=t.index,a=LP(2);BE(1),QP(r.style),EP("id",r.name)("pieceClasses",MT(5,gce,"player"+a.getCurrentPlayer().value+"-fill")),pP("transform","translate(0, "+-(i+1)*a.SPACE_SIZE+")")}}function mce(e,t){if(1&e&&(NC(),PP(0,"g",25),OP(1,"rect",26),CP(2,yce,2,7,"ng-container",1),SP()),2&e){var n=LP();BE(1),pP("x",0)("y",-n.listOfStyles.length*n.SPACE_SIZE)("width",1*n.SPACE_SIZE)("height",n.listOfStyles.length*n.SPACE_SIZE),BE(1),EP("ngForOf",n.listOfStyles)}}function kce(e,t){if(1&e&&(NC(),PP(0,"text",33),uS(1),SP()),2&e){var n=LP(2).$implicit,r=LP().$implicit,i=LP();EP("ngClass","player"+(0===r.value?1:0)+"-fill"),pP("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),BE(1),cS(n+" x ")}}function Cce(e,t){if(1&e&&(NC(),OP(0,"g",34)),2&e){var n=LP(3).$implicit;QP(LP().style),EP("pieceClasses",MT(3,gce,"player"+(0===n.value?1:0)+"-fill"))}}function wce(e,t){if(1&e&&(NC(),OP(0,"g",35)),2&e){var n=LP(3).$implicit;QP(LP().style),EP("pieceClasses",MT(3,gce,"player"+(0===n.value?1:0)+"-fill"))}}function _ce(e,t){if(1&e&&(NC(),OP(0,"g",36)),2&e){var n=LP(3).$implicit;QP(LP().style),EP("pieceClasses",MT(3,gce,"player"+(0===n.value?1:0)+"-fill"))}}function Ece(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,kce,2,4,"text",29),PP(2,"g",28),CP(3,Cce,1,5,"g",30),CP(4,wce,1,5,"g",31),CP(5,_ce,1,5,"g",32),SP(),SP()),2&e){var n=LP(),r=n.index,i=n.$implicit,a=LP().$implicit,o=LP();pP("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),BE(1),EP("ngIf",i>1),BE(1),VP("id","piece_",r,"_player_",a.value,""),pP("transform","translate("+o.SPACE_SIZE+", 0)"),BE(1),EP("ngIf",0===r),BE(1),EP("ngIf",1===r),BE(1),EP("ngIf",2===r)}}function bce(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Ece,6,8,"g",13),SP()),2&e){var n=t.$implicit;BE(1),EP("ngIf",n>0)}}function Pce(e,t){if(1&e&&(NC(),PP(0,"g"),PP(1,"g",28),CP(2,bce,2,1,"g",1),SP(),SP()),2&e){var n=t.$implicit,r=LP();BE(1),UP("id","capture_of_player_",n.value,""),pP("transform","scale(0.5, 0.5) translate("+-r.SPACE_SIZE/2+", "+(r.SPACE_SIZE/2+n.value*(10*r.SPACE_SIZE+4*r.STROKE_WIDTH))+")"),BE(1),EP("ngForOf",r.state.getCapturesOf(n))}}var Sce=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,r.UP=-n.STROKE_WIDTH/2,r.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,r.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,r.MartianChessComponent=n,r.style={shape:"Circle",points:"Horizontal Points"},r.pieces=Wue,r.selectedPieceInfo=NB.empty(),r.countDown=NB.empty(),r.callTheClock=!1,r.displayModePanel=!1,r.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],r.hasAsymetricBoard=!0,r.rules=new Xue(Kue),r.availableMinimaxes=[new jue(r.rules,"Martian Chess Dummy Minimax")],r.SPACE_SIZE=n.SPACE_SIZE,r.configCogTransformation=r.getConfigCogTransformation(),r.configViewTranslation=r.getConfigViewTranslation(),r.clockNeedlesPoints=r.getClockNeedlesPoints(),r.encoder=que.encoder,r.tutorial=(new ace).tutorial,r.scores=NB.of([0,0]),r.updateBoard(),r}return my(n,[{key:"getConfigViewTranslation",value:function(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}},{key:"getConfigCogTransformation",value:function(){var e=this.STROKE_WIDTH,t=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+t+" "+t+")"}},{key:"getClockNeedlesPoints",value:function(){var e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}},{key:"updateBoard",value:function(){this.state=this.getState(),this.board=this.state.board;var e=this.state.getScoreOf(e9.ZERO),t=this.state.getScoreOf(e9.ONE);this.countDown=this.state.countDown,this.scores=NB.of([e,t])}},{key:"getPieceLocation",value:function(e,t){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*t+")"}},{key:"getPieceClasses",value:function(e,t){var n=new pte(e,t),r=[];return r.push(t>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(n)&&r.push("selected-stroke"),this.rules.node.move.isPresent()&&this.rules.node.move.get().end.equals(n)&&this.rules.node.mother.get().gameState.getPieceAt(n)!==Wue.EMPTY&&this.getState().isInOpponentTerritory(new pte(0,t))&&r.push("last-move-stroke"),r}},{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n.displayModePanel=!1,!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=4;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 4:return a=new pte(e,t),r.abrupt("return",n.selectedPieceInfo.isPresent()?n.secondClick(a):n.firstClick(a));case 6:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.isOneOfUsersPieces(e)?t.selectAsFirstPiece(e):(t.cancelMoveAttempt(),UB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"selectAsFirstPiece",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getLegalLandings(e),n.abrupt("return",(t.selectedPieceInfo=NB.of({selectedPiece:e,legalLandings:r}),UB.SUCCESS));case 2:case"end":return n.stop()}},n)}))()}},{key:"getLegalLandings",value:function(e){var t=this,n=this.state.getPieceAt(e);return(n===Wue.PAWN?fte.DIAGONALS.map(function(t){return e.getNext(t)}):this.getValidLinearLandingSquareUntil(e,n===Wue.DRONE?2:8)).filter(function(n){var r=que.from(e,n);return!!r.isSuccess()&&t.rules.isLegal(r.get(),t.getState()).isSuccess()})}},{key:"getValidLinearLandingSquareUntil",value:function(e,t){var n=this;return fte.DIRECTIONS.flatMap(function(r){for(var i=[],a=e.getNext(r),o=1;a.isInRange(4,8)&&o<=t&&(i.push(a),n.getState().getPieceAt(a)===Wue.EMPTY);)a=a.getNext(r),o++;return i})}},{key:"secondClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.selectedPieceInfo.get()).selectedPiece.equals(e)){n.next=3;break}return n.abrupt("return",(t.cancelMoveAttempt(),UB.SUCCESS));case 3:if(!r.legalLandings.some(function(t){return t.equals(e)})){n.next=8;break}return F7((i=que.from(r.selectedPiece,e,t.callTheClock)).isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),a=t.getState(),n.abrupt("return",t.chooseMove(i.get(),a));case 8:if(!t.isOneOfUsersPieces(e)){n.next=10;break}return n.abrupt("return",t.selectAsFirstPiece(e));case 10:return o=que.from(r.selectedPiece,e,t.callTheClock),n.abrupt("return",o.isSuccess()?t.chooseMove(o.get(),t.getState()):t.cancelMove(o.getReason()));case 12:case"end":return n.stop()}},n)}))()}},{key:"isOneOfUsersPieces",value:function(e){return this.state.getPieceAt(e)!==Wue.EMPTY&&this.state.isInPlayerTerritory(e)}},{key:"cancelMoveAttempt",value:function(){this.selectedPieceInfo=NB.empty(),this.callTheClock=!1}},{key:"onClockClick",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#clockOrCountDownView"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),UB.SUCCESS));case 2:case"end":return t.stop()}},t)}))()}},{key:"getClockCircleClasses",value:function(){var e=["base"];return this.callTheClock&&e.push("selected-stroke"),this.getCurrentPlayer()===e9.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}},{key:"getSquareClasses",value:function(e,t){var n=new pte(e,t),r=["base"];if(this.rules.node.move.isPresent()){var i=this.rules.node,a=i.move.get();a.coord.equals(n)?r.push("moved-fill"):a.end.equals(n)&&(i.mother.get().gameState.getPieceAt(n)===Wue.EMPTY||i.gameState.isInOpponentTerritory(new pte(0,t))?r.push("moved-fill"):r.push("captured-fill"))}return r}},{key:"onModeCogClick",value:function(){this.displayModePanel=!this.displayModePanel}},{key:"chooseStyle",value:function(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}}],[{key:"getRegularPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=n.getRegularPolygonCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStar",value:function(e,t){var r=this.getNPointedStarCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStarCoords",value:function(e,t){var r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE;e*=2;for(var o=0;o<e;o++){var s=(o*(360/e)+t)/180*Math.PI,u=o%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s);r.push(new pte(c,l))}return r}},{key:"getRegularPolygonCoords",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE,o=0;o<e;o++){var s=(o*(360/e)-90)/180*Math.PI,u=.5*n.SPACE_SIZE,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s)+t;r.push(new pte(c,l))}return r}},{key:"mapCoordsToString",value:function(e){var t,n="",r=dy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=i.x+", "+i.y+" "}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getRadius",value:function(e){return this.SPACE_SIZE*e/10}}]),n}(Sne);return e.SPACE_SIZE=100,e.STROKE_WIDTH=8,e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-martian-chess"]],features:[nP],decls:14,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,dce,3,3,"g",1),PP(2,"g",2),RP("click",function(){return t.onClockClick()}),OP(3,"rect",3),OP(4,"circle",4),CP(5,vce,2,5,"text",5),CP(6,pce,1,2,"polyline",6),SP(),PP(7,"g",7),PP(8,"g",8),RP("click",function(){return t.onModeCogClick()}),OP(9,"rect",3),OP(10,"path",9),SP(),CP(11,mce,3,5,"g",10),SP(),PP(12,"g",11),CP(13,Pce,3,3,"g",1),SP(),SP()),2&e&&(pP("viewBox",t.LEFT+" "+t.UP+" "+t.WIDTH+" "+t.HEIGHT)("transform",t.rotation),BE(1),EP("ngForOf",t.board),BE(1),pP("transform","translate("+5.25*t.SPACE_SIZE+", 0)"),BE(1),pP("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),BE(1),EP("ngClass",t.getClockCircleClasses()),pP("cx",.5*t.SPACE_SIZE)("cy",.5*t.SPACE_SIZE)("r",.4*t.SPACE_SIZE),BE(1),EP("ngIf",t.countDown.isPresent()),BE(1),EP("ngIf",t.countDown.isAbsent()),BE(1),pP("transform",t.configViewTranslation),BE(2),pP("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),BE(1),EP("ngClass",t.getPlayerClass(t.getCurrentPlayer())),pP("transform",t.configCogTransformation),BE(1),EP("ngIf",t.displayModePanel),BE(2),EP("ngForOf",t.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Oce=Number.MAX_SAFE_INTEGER,Tce=Number.MIN_SAFE_INTEGER,Ice=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,i9.copyBiArray(n.initialBoard),e)).turn=e,i.location=r,i}return my(n,null,[{key:"getInitialState",value:function(){return new n(0,new pte(0,0))}}]),n}(Ate);Ice.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],Ice.BOARD_1=[[0,+Oce,-1,-1],[1,2,+Oce,-1],[+Tce,3,4,-1],[-1,+Tce,+Tce,-1]],Ice.BOARD_2=[[0,+Oce,-1,-1],[+Oce,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],Ice.BOARD_3=[[0,1,+Tce,-1],[1,+Tce,-1,-1],[+Tce,-1,-1,-1],[-1,-1,-1,-1]],Ice.BOARD_4=[[0,1,+Tce,-1],[1,+Tce,-1,-1],[+Tce,-1,-1,-1],[-1,-1,-1,1]],Ice.initialBoard=Ice.BOARD_0;var Ace=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){var r=new pte(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new Ice(t.turn+1,r)}},{key:"isLegal",value:function(e,t){var n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?DB.failure("incorrect move"):DB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getPieceAt(t.location);return n===e9.ZERO.getVictoryValue()?Bte.ZERO_WON:n===e9.ONE.getVictoryValue()?Bte.ONE_WON:t.location.equals(new pte(3,3))?0===n?Bte.DRAW:n>0?Bte.ONE_WON:Bte.ZERO_WON:Bte.ONGOING}}]),n}(zte),Mce=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).right=e,r}return my(n,[{key:"equals",value:function(e){return this===e||this.right===e.right}},{key:"toString",value:function(){return this.right?"Move RIGHT":"Move DOWN"}}]),n}(xte);Mce.RIGHT=new Mce(!0),Mce.DOWN=new Mce(!1),Mce.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 1}},{key:"decodeNumber",value:function(e){return 0===e?Mce.RIGHT:Mce.DOWN}},{key:"encodeNumber",value:function(e){return e.right?0:1}}]),n}(Q7));var xce=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getBoardValue",value:function(e){var t=Ace.getGameStatus(e);if(t.isEndGame)return new Ste(t.toBoardValue());var n=e.gameState;return new Ste(n.getPieceAt(n.location))}},{key:"getListMoves",value:function(e){var t=[],n=e.gameState;return n.location.x<3&&t.push(Mce.RIGHT),n.location.y<3&&t.push(Mce.DOWN),t}}]),n}(Pte);function Rce(e,t){1&e&&(TP(0),uS(1,"("),IP())}function Nce(e,t){1&e&&(TP(0),uS(1,")"),IP())}function Dce(e,t){if(1&e&&(PP(0,"td"),CP(1,Rce,2,0,"ng-container",3),uS(2),CP(3,Nce,2,0,"ng-container",3),SP()),2&e){var n=t.$implicit,r=t.index,i=LP().index,a=LP();BE(1),EP("ngIf",a.coord.x===r&&a.coord.y===i),BE(1),lS(" ",n," "),BE(1),EP("ngIf",a.coord.x===r&&a.coord.y===i)}}function Lce(e,t){if(1&e&&(PP(0,"tr"),CP(1,Dce,4,3,"td",0),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}var Fce=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).coord=new pte(-1,-1),r.rules=new Ace(Ice),r.availableMinimaxes=[new xce(r.rules,"MinimaxTestingMinimax")],r.encoder=Mce.encoder,r}return my(n,[{key:"chooseRight",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_right"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Mce.RIGHT,e.getState()));case 2:case"end":return t.stop()}},t)}))()}},{key:"chooseDown",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_down"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Mce.DOWN,e.getState()));case 2:case"end":return t.stop()}},t)}))()}},{key:"updateBoard",value:function(){var e=this.getState();this.board=e.getCopiedBoard(),this.coord=e.location}}]),n}(Sne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-minimax-testing"]],features:[nP],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(PP(0,"table"),CP(1,Lce,2,1,"tr",0),PP(2,"div",1),RP("click",function(){return t.chooseRight()}),uS(3," goRight "),SP(),PP(4,"div",2),RP("click",function(){return t.chooseDown()}),uS(5," goDown "),SP(),PP(6,"div"),uS(7),SP(),SP()),2&e&&(BE(1),EP("ngForOf",t.board),BE(6),lS(" ",t.coord," "))},directives:[aM,sM],encapsulation:2}),e}(),Uce=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,null,[{key:"getInitialState",value:function(){return new n(i9.createTable(7,6,J7.NONE),0)}}]),n}(Ate),Vce=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this)).x=e,r}return my(n,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"P4Move("+this.x+")"}}],[{key:"of",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;case 5:return n.FIVE;case 6:return n.SIX;default:throw new Error("Invalid P4Move")}}}]),n}(xte);Vce.ZERO=new Vce(0),Vce.ONE=new Vce(1),Vce.TWO=new Vce(2),Vce.THREE=new Vce(3),Vce.FOUR=new Vce(4),Vce.FIVE=new Vce(5),Vce.SIX=new Vce(6),Vce.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 6}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return Vce.of(e)}}]),n}(Q7));var Bce=function(){var e=my(function e(){gy(this,e)});return e.COLUMN_IS_FULL=function(){return $localize(tu||(tu=Wg(["Please put your piece in an incomplete column."])))},e}(),zce=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,r){var i=e.x,a=t.getCopiedBoard(),o=n.getLowestUnoccupiedSpace(a,i),s=t.turn;return a[o][i]=t.getCurrentPlayer(),new Uce(a,s+1)}},{key:"isLegal",value:function(e,t){return AB(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:t}),t.getPieceAtXY(e.x,0).isPlayer()?DB.failure(Bce.COLUMN_IS_FULL()):DB.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,r=0;r<7;r++)for(var i=5;i>=0&&t.board[i][r].isPlayer();i--){var a=n.getSquareScore(t.board,new pte(r,i));if(Vte.getScoreStatus(a)===Dte.VICTORY)return Bte.getVictory(t.getCurrentOpponent())}return 42===t.turn?Bte.DRAW:Bte.ONGOING}}],[{key:"getVictoriousCoords",value:function(e){for(var t=[],r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new pte(r,i));(a===e9.ZERO.getVictoryValue()||a===e9.ONE.getVictoryValue())&&t.push(new pte(r,i))}return t}},{key:"getBoardValueFromScratch",value:function(e){AB(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});for(var t=0,r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new pte(r,i));if(Vte.getScoreStatus(a)!==Dte.DEFAULT)return AB(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:a,coord:{x:r,y:i}}}),new Ste(a);t+=a}return new Ste(t)}},{key:"getLowestUnoccupiedSpace",value:function(e,t){for(var n=0;n<6&&e[n][t]===J7.NONE;)n++;return n-1}},{key:"getNumberOfFreeSpacesAndAllies",value:function(e,t,n,r,i){for(var a=0,o=0,s=!0,u=new pte(t.x+n.x,t.y+n.y);u.isInRange(7,6)&&3!==a;){var c=e[u.y][u.x];if(c===r)return[a,o];c===i&&s?o++:s=!1,c!==r&&c!==i&&a++,u=u.getNext(n)}return[a,o]}},{key:"getOpponent",value:function(e,t){var n=e[t.y][t.x];return F7(n.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),n===e9.ONE?e9.ZERO:e9.ONE}},{key:"getSquareScore",value:function(e,t){AB(n.VERBOSE,"getSquareScore(board, "+t.x+", "+t.y+") called"),AB(n.VERBOSE,e);var r,i=0,a=n.getOpponent(e,t),o=a.getOpponent(),s=new Lte,u=new Lte,c=dy(fte.DIRECTIONS);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=n.getNumberOfFreeSpacesAndAllies(e,t,l,a,o);s.set(l,f[0]),u.set(l,f[1])}}catch(y){c.e(y)}finally{c.f()}for(var h=0,d=[fte.UP,fte.UP_RIGHT,fte.RIGHT,fte.DOWN_RIGHT];h<d.length;h++){var v=d[h],p=u.get(v).get()+u.get(v.getOpposite()).get();if(p>2)return AB(n.VERBOSE,{text:"there is some kind of victory here ("+t.x+", "+t.y+")\nline allies : "+p+"\n",board:e}),o.getVictoryValue();var g=s.get(v).get()+s.get(v.getOpposite()).get();3===g?i+=2:g>3&&(i+=g-2)}return i*o.getScoreModifier()}},{key:"getListMoves",value:function(e){AB(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});for(var t=e.gameState,r=[],i=0;i<7;i++)if(t.getPieceAtXY(i,0)===J7.NONE){var a=Vce.of(i);r.push(a)}return r}},{key:"getBoardValue",value:function(e){return AB(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}}]),n}(zte);return e.VERBOSE=!1,e}(),Hce=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){return zce.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=e.gameState;return AB(zce.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),zce.getBoardValue(t)}}]),n}(Pte),Gce=J7.NONE,$ce=J7.ZERO,Zce=J7.ONE,qce=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(nu||(nu=Wg(["Goal of the game"]))),$localize(ru||(ru=Wg(["The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.\n        The first player plays Dark, the second plays Light.\n        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally)."]))),Uce.getInitialState()),Zte.anyMove($localize(iu||(iu=Wg(["Dropping a piece"]))),$localize(au||(au=Wg(["Click on any space in any column."]))),Uce.getInitialState(),Vce.THREE,$localize(ou||(ou=Wg(["As you can see, the piece falls at the bottom of the column."])))),Zte.fromMove($localize(su||(su=Wg(["Victory"]))),$localize(uu||(uu=Wg(["You're playing Dark.\n        Place your piece so that you create a horizontal alignment of 4 of your pieces."]))),new Uce([[Gce,Gce,Gce,Gce,Gce,Gce,Gce],[Gce,Gce,Gce,Gce,Gce,Gce,Gce],[Gce,Gce,Gce,Gce,Gce,Gce,Gce],[Gce,Gce,Gce,Zce,Gce,Gce,Gce],[Gce,Gce,Gce,Zce,Gce,Gce,Gce],[Gce,Gce,$ce,$ce,$ce,Zce,Gce]],0),[Vce.of(1)],$localize(cu||(cu=Wg(["You won!"]))),$localize(lu||(lu=Wg(["Failed, you have not aligned 4 pieces and missed an opportunity to win."])))),Zte.fromMove($localize(fu||(fu=Wg(["Other victory"]))),$localize(hu||(hu=Wg(["You can also align 4 pieces diagonally or vertically."]))),new Uce([[Gce,Gce,Gce,Gce,Gce,Gce,Gce],[Gce,Gce,Gce,Gce,Gce,Gce,Gce],[Gce,Gce,Gce,Gce,Gce,Gce,Gce],[Gce,Gce,Gce,$ce,Zce,Gce,Gce],[Gce,Gce,$ce,$ce,Zce,Gce,Gce],[Gce,$ce,Zce,$ce,$ce,Gce,Gce]],0),[Vce.of(3),Vce.of(4)],$localize(du||(du=Wg(["You won!"]))),$localize(vu||(vu=Wg(["Failed, you have not aligned 4 pieces and missed an opportunity to win."]))))]});function Wce(e,t){if(1&e&&(NC(),OP(0,"circle",8)),2&e){var n=LP().index,r=LP().index,i=LP();EP("ngClass",i.getSquareFillClass(n,r)),pP("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function jce(e,t){if(1&e){var n=AP();NC(),PP(0,"g",5),RP("click",function(){var e=aC(n).index;return LP(2).onClick(e)}),OP(1,"rect",6),CP(2,Wce,1,4,"circle",7),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP().index,o=LP();UP("id","click_",i,""),BE(1),pP("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),BE(1),EP("ngIf",r!==o.EMPTY)}}function Yce(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,jce,3,6,"g",4),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function Kce(e,t){if(1&e&&(NC(),OP(0,"rect",9)),2&e){var n=LP();pP("x",n.SPACE_SIZE*n.last.get().x)("y",n.SPACE_SIZE*n.last.get().y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Qce(e,t){if(1&e&&(NC(),OP(0,"rect",10)),2&e){var n=t.$implicit,r=LP();VP("id","victory_coord_",n.x,"_",n.y,""),pP("x",r.SPACE_SIZE*n.x)("y",r.SPACE_SIZE*n.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}var Xce=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).EMPTY=J7.NONE,r.victoryCoords=[],r.rules=new zce(Uce),r.availableMinimaxes=[new Hce(r.rules,"P4Minimax")],r.encoder=Vce.encoder,r.tutorial=(new qce).tutorial,r.updateBoard(),r}return my(n,[{key:"onClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=Vce.of(e),n.next=6,t.chooseMove(i,t.getState());case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){var e=this.getState(),t=this.rules.node.move;this.victoryCoords=zce.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.getState(),t=this.rules.node.move,n=zce.getLowestUnoccupiedSpace(e.board,t.get().x)+1;this.last=NB.of(new pte(t.get().x,n))}},{key:"hideLastMove",value:function(){this.last=NB.empty()}},{key:"getSquareFillClass",value:function(e,t){return[this.getPlayerClass(this.board[t][e])]}}]),n}(Sne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-p4"]],features:[nP],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,Yce,2,1,"g",1),CP(2,Kce,1,4,"rect",2),CP(3,Qce,1,6,"rect",3),SP()),2&e&&(BE(1),EP("ngForOf",t.board),BE(1),EP("ngIf",t.last.isPresent()),BE(1),EP("ngForOf",t.victoryCoords))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Jce=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(gy(this,n),(a=t.call(this,e,r)).blockTurned=i,a.turnedClockwise=o,a.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+a.coord.toString());return sy(a)}return my(n,[{key:"toString",value:function(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}],[{key:"withRotation",value:function(e,t,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new n(e,t,NB.of(r),i)}},{key:"rotationless",value:function(e,t){return new n(e,t,NB.empty())}}]),n}(Rte);Jce.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"encodeMove",value:function(e){var t={coord:pte.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}},{key:"decodeMove",value:function(e){var t=e,n=pte.encoder.decode(t.coord),r=NB.ofNullable(t.blockTurned);if(r.isPresent()){var i=t.turnedClockwise;return Jce.withRotation(n.x,n.y,r.get(),i)}return Jce.rotationless(n.x,n.y)}}]),n}(K7));var ele=function(){var e=my(function e(){gy(this,e)});return e.CANNOT_ROTATE_NEUTRAL_BLOCK=function(){return $localize(pu||(pu=Wg(["If the quadrant to turn is neutral, please just use move without rotation."])))},e.MUST_CHOOSE_BLOCK_TO_ROTATE=function(){return $localize(gu||(gu=Wg(["No quadrant is neutral, you must pick a quadrant to rotate."])))},e}(),tle=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e,r)).neutralBlocks=i.getBlocksNeutralities(),i}return my(n,[{key:"getBlocksNeutralities",value:function(){for(var e=[],t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}},{key:"getBlockNeutrality",value:function(e){var t=n.getBlockCenter(e),r=this.getPieceAt(t.getNext(fte.UP,1)),i=this.getPieceAt(t.getNext(fte.UP_LEFT,1));return this.getPieceAt(t.getNext(fte.RIGHT,1))===r&&this.getPieceAt(t.getNext(fte.DOWN,1))===r&&this.getPieceAt(t.getNext(fte.LEFT,1))===r&&this.getPieceAt(t.getNext(fte.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(fte.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(fte.DOWN_LEFT,1))===i}},{key:"applyLegalDrop",value:function(e){var t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new n(t,this.turn)}},{key:"applyLegalMove",value:function(e){var t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){var i=n.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise){var a,o=dy(n.ROTATION_MAP);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s[0].getNext(i),c=s[1].getNext(i),l=t.getPieceAt(u);r[c.y][c.x]=l}}catch(y){o.e(y)}finally{o.f()}}else{var f,h=dy(n.ROTATION_MAP);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=d[1].getNext(i),p=d[0].getNext(i),g=t.getPieceAt(v);r[p.y][p.x]=g}}catch(y){h.e(y)}finally{h.f()}}}return new n(r,this.turn+1)}},{key:"blockIsNeutral",value:function(e){return this.neutralBlocks.includes(e)}}],[{key:"getInitialState",value:function(){return new n(i9.createTable(6,6,J7.NONE),0)}},{key:"getBlockCenter",value:function(e){return new pte(1+(e%2==0?0:3),1+(e<2?0:3))}}]),n}(Ate);tle.ROTATION_MAP=[[new pte(-1,-1),new pte(1,-1)],[new pte(0,-1),new pte(1,0)],[new pte(1,-1),new pte(1,1)],[new pte(1,0),new pte(0,1)],[new pte(1,1),new pte(-1,1)],[new pte(0,1),new pte(-1,0)],[new pte(-1,1),new pte(-1,-1)],[new pte(-1,0),new pte(0,-1)]];var nle=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).isPlayer())return DB.failure(bte.MUST_LAND_ON_EMPTY_SPACE());var n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return DB.failure(ele.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){var r=e.blockTurned.get();if(n.neutralBlocks.includes(r))return DB.failure(ele.CANNOT_ROTATE_NEUTRAL_BLOCK())}return DB.success(void 0)}},{key:"getVictoryCoords",value:function(e){var t,r=[],i=dy(n.VICTORY_SOURCE);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=e.getPieceAt(a[0]),s=[a[0]];if(o.isPlayer()){for(var u=a[0].getNext(a[1]),c=!0,l=0;l<3&&c;l++)e.getPieceAt(u)!==o?c=!1:(s.push(u),u=u.getNext(a[1]));if(c&&(e.getPieceAt(u)===o&&(s.push(u),r=r.concat(s)),a[2])){var f=a[0].getPrevious(a[1],1);e.getPieceAt(f)===o&&(s.push(f),r=r.concat(s))}}}}catch(h){i.e(h)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1],i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?Bte.DRAW:Bte.ZERO_WON:!0===r[1]?Bte.ONE_WON:36===t.turn?Bte.DRAW:Bte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=NB.of(new n(tle))),n.singleton.get()}}]),n}(zte);nle.singleton=NB.empty(),nle.VICTORY_SOURCE=[[new pte(1,0),new ute(1,1),!1],[new pte(0,1),new ute(1,1),!1],[new pte(4,0),new ute(-1,1),!1],[new pte(5,1),new ute(-1,1),!1],[new pte(1,1),new ute(1,1),!0],[new pte(4,1),new ute(-1,1),!0],[new pte(0,1),new ute(0,1),!0],[new pte(1,1),new ute(0,1),!0],[new pte(2,1),new ute(0,1),!0],[new pte(3,1),new ute(0,1),!0],[new pte(4,1),new ute(0,1),!0],[new pte(5,1),new ute(0,1),!0],[new pte(1,0),new ute(1,0),!0],[new pte(1,1),new ute(1,0),!0],[new pte(1,2),new ute(1,0),!0],[new pte(1,3),new ute(1,0),!0],[new pte(1,4),new ute(1,0),!0],[new pte(1,5),new ute(1,0),!0]];var rle=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return n.FIRST_TURN_MOVES;var i,a=dy(this.getLegalDrops(e.gameState));try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=Jce.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(u),l=dy(this.getLegalRotations(c,r));try{for(l.s();!(o=l.n()).done;){var f=o.value;t.push(Jce.withRotation(s.x,s.y,f[0],f[1]))}}catch(h){l.e(h)}finally{l.f()}0===c.neutralBlocks.length==0&&t.push(u)}}catch(h){a.e(h)}finally{a.f()}return t}},{key:"getLegalDrops",value:function(e){for(var t=[],n=0;n<6;n++)for(var r=0;r<6;r++){var i=new pte(r,n);e.getPieceAt(i)===J7.NONE&&t.push(i)}return t}},{key:"getLegalRotations",value:function(e,t){for(var n=0===e.neutralBlocks.length,r=[],i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}},{key:"getBoardValue",value:function(e){return new Ste(nle.get().getGameStatus(e).toBoardValue())}}]),n}(Pte);rle.FIRST_TURN_MOVES=[Jce.rotationless(0,0),Jce.rotationless(1,0),Jce.rotationless(2,0),Jce.rotationless(0,1),Jce.rotationless(1,1),Jce.rotationless(0,2)];var ile=J7.NONE,ale=J7.ZERO,ole=J7.ONE,sle=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(yu||(yu=Wg(["Initial board"]))),$localize(mu||(mu=Wg(["The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate."]))),tle.getInitialState()),Zte.informational($localize(ku||(ku=Wg(["Goal of the game"]))),$localize(Cu||(Cu=Wg(["The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins."]))),new tle([[ale,ile,ile,ale,ole,ile],[ale,ole,ile,ile,ile,ile],[ale,ile,ole,ile,ile,ile],[ale,ile,ile,ile,ile,ole],[ale,ile,ile,ile,ole,ile],[ile,ile,ile,ile,ile,ile]],10)).withPreviousMove(Jce.withRotation(0,0,0,!1)),Zte.fromPredicate($localize(wu||(wu=Wg(["Simple move"]))),$localize(_u||(_u=Wg(["At their turn, players put a piece on the board and possibly rotate one quadrant.\n        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.\n        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>\n        Do it."]))),new tle([[ile,ile,ile,ile,ile,ile],[ile,ale,ile,ile,ole,ile],[ile,ile,ile,ile,ile,ile],[ile,ile,ile,ile,ile,ile],[ile,ole,ile,ile,ale,ile],[ile,ile,ile,ile,ile,ile]],10),Jce.rotationless(2,2),function(e,t,n){return e.blockTurned.isPresent()?UB.failure($localize(Eu||(Eu=Wg(["You have made a move with a rotation. This tutorial step is about moves without rotations!"])))):UB.SUCCESS},$localize(bu||(bu=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(Pu||(Pu=Wg(["Move with rotation"]))),$localize(Su||(Su=Wg(["After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>\n        Click on one of them and see the rotation!"]))),new tle([[ile,ile,ile,ile,ile,ile],[ile,ale,ile,ile,ole,ile],[ile,ile,ile,ile,ile,ile],[ile,ile,ile,ile,ile,ile],[ile,ole,ile,ile,ale,ile],[ile,ile,ile,ile,ile,ile]],10),Jce.withRotation(0,0,0,!0),function(e,t,n){return e.blockTurned.isPresent()?UB.SUCCESS:UB.failure($localize(Ou||(Ou=Wg(["You made a move without rotation, try again!"]))))},$localize(Tu||(Tu=Wg(["Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation."]))))]});function ule(e,t){if(1&e){var n=AP();NC(),TP(0),PP(1,"circle",9),RP("click",function(){var e=aC(n).$implicit,t=LP().$implicit,r=LP().index,i=LP().index;return LP().onClick(3*r+e,3*i+t)}),SP(),IP()}if(2&e){var r=t.$implicit,i=LP().$implicit,a=LP(),o=a.index,s=a.$implicit,u=LP(),c=u.index,l=u.$implicit,f=LP();BE(1),VP("id","click_",3*o+r,"_",3*c+i,""),EP("ngClass",f.getSquareClasses(3*o+r,3*c+i)),pP("cx",s+2*f.STROKE_WIDTH+(r+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(i+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}var cle=function(){return[0,1,2]};function lle(e,t){1&e&&(NC(),TP(0),CP(1,ule,2,6,"ng-container",3),IP()),2&e&&(BE(1),EP("ngForOf",AT(1,cle)))}function fle(e,t){if(1&e&&(NC(),TP(0),OP(1,"rect",8),CP(2,lle,2,2,"ng-container",3),IP()),2&e){var n=t.$implicit,r=t.index,i=LP(),a=i.index,o=i.$implicit,s=LP();BE(1),EP("ngClass",s.getBlockClasses(r,a)),pP("x",s.STROKE_WIDTH+n)("y",s.STROKE_WIDTH+o)("rx",3*s.STROKE_WIDTH)("ry",3*s.STROKE_WIDTH)("width",s.BLOCK_WIDTH)("height",s.BLOCK_WIDTH),BE(1),EP("ngForOf",AT(8,cle))}}var hle=function(e){return[0,e]};function dle(e,t){if(1&e&&(NC(),TP(0),CP(1,fle,3,9,"ng-container",3),IP()),2&e){var n=LP();BE(1),EP("ngForOf",MT(1,hle,n.BLOCK_SEPARATION))}}function vle(e,t){if(1&e&&(NC(),OP(0,"circle",10)),2&e){var n=LP();VP("id","currentDrop_",n.currentDrop.get().x,"_",n.currentDrop.get().y,""),EP("ngClass",n.getPlayerClass(n.getCurrentPlayer())),pP("cx",n.getCenter(n.currentDrop.get().x))("cy",n.getCenter(n.currentDrop.get().y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)}}function ple(e,t){if(1&e){var n=AP();NC(),PP(0,"path",11),RP("click",function(){var e=aC(n).$implicit;return LP().rotate(e)}),SP()}if(2&e){var r=t.$implicit,i=LP();VP("id","rotate_",r[1],"_",r[2]?"clockwise":"counterclockwise",""),pP("d",r[0])("stroke-width",2*i.STROKE_WIDTH)}}function gle(e,t){if(1&e&&(NC(),OP(0,"circle",12)),2&e){var n=t.$implicit,r=LP();VP("id","victoryCoord_",n.x,"_",n.y,""),EP("ngClass",r.getSquareClasses(n.x,n.y)),pP("cx",r.getCenter(n.x))("cy",r.getCenter(n.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function yle(e,t){if(1&e){var n=AP();NC(),PP(0,"g",13),RP("click",function(){return aC(n),LP().skipRotation()}),OP(1,"circle",14),OP(2,"line",15),SP()}if(2&e){var r=LP();BE(1),pP("cx",r.BLOCK_SEPARATION)("cy",r.BLOCK_SEPARATION)("r",.75*r.SPACE_SIZE)("stroke-width",2*r.STROKE_WIDTH),BE(1),pP("x1",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("y1",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("x2",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("y2",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("stroke-width",2*r.STROKE_WIDTH)}}var mle=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).arrows=[],r.victoryCoords=[],r.rules=new nle(tle),r.availableMinimaxes=[new rle(r.rules,"PentagoMinimax")],r.encoder=Jce.encoder,r.tutorial=(new sle).tutorial,r.BLOCK_WIDTH=3*r.SPACE_SIZE+2*r.STROKE_WIDTH,r.BLOCK_SEPARATION=r.BLOCK_WIDTH+2*r.STROKE_WIDTH,r.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*r.SPACE_SIZE,r.ARROWS=r.generateArrowsCoord(),r.updateBoard(),r}return my(n,[{key:"updateBoard",value:function(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.showLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{var t=e.get();this.movedBlock=t.blockTurned;var n=new pte(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new pte(0,0))&&this.coordBelongToBlock(t)){var r;r=t.turnedClockwise?IB.getNonNullable(tle.ROTATION_MAP.find(function(e){return e[0].equals(n)}))[1]:IB.getNonNullable(tle.ROTATION_MAP.find(function(e){return e[1].equals(n)}))[0];var i=t.blockTurned.get();r=r.getNext(new ute(i%2==0?1:4,i<2?1:4),1),this.lastDrop=NB.of(r)}else this.lastDrop=NB.of(t.coord)}}},{key:"coordBelongToBlock",value:function(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}},{key:"hidePreviousMove",value:function(){this.lastDrop=NB.empty(),this.movedBlock=NB.empty(),this.victoryCoords=[]}},{key:"generateArrowsCoord",value:function(){var e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}},{key:"cancelMoveAttempt",value:function(){this.arrows=[],this.currentDrop=NB.empty(),this.canSkipRotation=!1}},{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(!n.board[t][e].isPlayer()){r.next=5;break}return r.abrupt("return",n.cancelMove(bte.MUST_LAND_ON_EMPTY_SPACE()));case 5:if(a=Jce.rotationless(e,t),o=n.getState(),4!==(s=o.applyLegalDrop(a)).neutralBlocks.length){r.next=8;break}return r.abrupt("return",n.chooseMove(a,o));case 8:return u=n.rules.getGameStatus(n.rules.node),r.abrupt("return",(n.canSkipRotation=s.neutralBlocks.length>0&&!1===u.isEndGame,n.currentDrop=NB.of(new pte(e,t)),n.displayArrows(s.neutralBlocks),UB.SUCCESS));case 10:case"end":return r.stop()}},r)}))()}},{key:"getCenter",value:function(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}},{key:"displayArrows",value:function(e){var t=this;this.arrows=[];for(var n=function(n){if(!1===e.includes(n)){var r=t.ARROWS.filter(function(e){return e[1]===n});t.arrows=t.arrows.concat(r)}},r=0;r<4;r++)n(r)}},{key:"getBlockClasses",value:function(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved-fill"]:[]}},{key:"getSquareClasses",value:function(e,t){var n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new pte(e,t))&&n.push("last-move-stroke"),n}},{key:"rotate",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"))).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=t.currentDrop.get(),a=Jce.withRotation(i.x,i.y,e[1],e[2]),n.abrupt("return",t.chooseMove(a,t.getState()));case 5:case"end":return n.stop()}},n)}))()}},{key:"skipRotation",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.canUserPlay("#skipRotation")).isFailure()){t.next=3;break}return t.abrupt("return",e.cancelMove(n.getReason()));case 3:return r=e.currentDrop.get(),i=Jce.rotationless(r.x,r.y),t.abrupt("return",e.chooseMove(i,e.getState()));case 5:case"end":return t.stop()}},t)}))()}}]),n}(Sne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-pentago"]],features:[nP],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),PP(1,"defs"),PP(2,"marker",1),OP(3,"polygon",2),SP(),SP(),CP(4,dle,2,3,"ng-container",3),CP(5,vle,1,6,"circle",4),CP(6,ple,1,4,"path",5),CP(7,gle,1,7,"circle",6),CP(8,yle,3,9,"g",7),SP()),2&e&&(BE(4),EP("ngForOf",MT(5,hle,t.BLOCK_SEPARATION)),BE(1),EP("ngIf",t.currentDrop.isPresent()),BE(1),EP("ngForOf",t.arrows),BE(1),EP("ngForOf",t.victoryCoords),BE(1),EP("ngIf",t.canSkipRotation))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),kle=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;if(gy(this,n),(a=t.call(this,e,r)).z=i,e<0||e>3)throw new Error("PylosCoord: Invalid X: ".concat(e,"."));if(r<0||r>3)throw new Error("PylosCoord: Invalid Y: ".concat(r,"."));if(i<0||i>3)throw new Error("PylosCoord: Invalid Z: ".concat(i,"."));var o=4-i;if(a.isNotInRange(o,o))throw new Error(a.toString()+" is not in range.");return sy(a)}return my(n,[{key:"toString",value:function(){return"PylosCoord"+this.toShortString()}},{key:"toShortString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"isUpperThan",value:function(e){return this.z>e.z}},{key:"getLowerPieces",value:function(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");var e=this.z-1;return[new n(this.x,this.y,e),new n(this.x+1,this.y,e),new n(this.x,this.y+1,e),new n(this.x+1,this.y+1,e)]}},{key:"getHigherCoords",value:function(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");var e=this.z+1,t=new pte(this.x-1,this.y-1),r=new pte(this.x,this.y-1),i=new pte(this.x-1,this.y),a=new pte(this.x,this.y),o=4-e;return[t,r,i,a].filter(function(e){return e.isInRange(o,o)}).map(function(t){return new n(t.x,t.y,e)})}},{key:"getNextValid",value:function(e){var t=new pte(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?NB.empty():NB.of(new n(t.x,t.y,this.z))}}],[{key:"encodeOptional",value:function(e){return e.isPresent()?n.encode(e.get())+1:0}},{key:"encode",value:function(e){return 16*e.x+4*e.y+e.z}},{key:"decodeToOptional",value:function(e){return 0===e?NB.empty():NB.of(n.decode(e-1))}},{key:"decode",value:function(e){var t=e%4;e-=t;var r=(e/=4)%4;return e-=r,new n(e/=4,r,t)}}]),n}(pte),Cle=function(){var e=my(function e(){gy(this,e)});return e.MUST_CAPTURE_MAXIMUM_TWO_PIECES=function(){return $localize(Iu||(Iu=Wg(["You must capture one or two pieces, not more."])))},e}(),wle=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this)).startingCoord=e,o.landingCoord=r,o.firstCapture=i,o.secondCapture=a,o}return my(n,[{key:"isClimb",value:function(){return this.startingCoord.isPresent()}},{key:"toString",value:function(){var e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}},{key:"equals",value:function(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}],[{key:"fromClimb",value:function(e,t,r){var i=NB.of(e),a=n.checkCaptures(r),o=new n(i,t,a.firstCapture,a.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return o}},{key:"checkCaptures",value:function(e){var t=NB.empty(),n=NB.empty();if(e.length>0&&(t=NB.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=NB.of(e[1]),e[1].isUpperThan(e[0])&&(t=NB.of(e[1]),n=NB.of(e[0])),e.length>2)throw new Error(Cle.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:n}}},{key:"fromDrop",value:function(e,t){var r=NB.empty(),i=n.checkCaptures(t);return new n(r,e,i.firstCapture,i.secondCapture)}},{key:"changeCapture",value:function(e,t){var r=n.checkCaptures(t);return new n(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}}]),n}(xte);wle.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 17575999}},{key:"encodeNumber",value:function(e){var t=kle.encode(e.landingCoord),n=kle.encodeOptional(e.startingCoord),r=kle.encodeOptional(e.firstCapture);return 270400*kle.encodeOptional(e.secondCapture)+4160*r+64*n+t}},{key:"decodeNumber",value:function(e){var t=kle.decode(e%64);e-=e%64;var n=kle.decodeToOptional((e/=64)%65);e-=e%65;var r=kle.decodeToOptional((e/=65)%65);e-=e%65;var i=kle.decodeToOptional(e/=65);return new wle(n,t,r,i)}}]),n}(Q7));var _le=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,r)).boards=e,i}return my(n,[{key:"getPieceAt",value:function(e){return this.boards[e.z][e.y][e.x]}},{key:"applyLegalMove",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=[];return r.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&r.push({coord:e.startingCoord.get(),value:J7.NONE}),e.firstCapture.isPresent()&&r.push({coord:e.firstCapture.get(),value:J7.NONE}),e.secondCapture.isPresent()&&r.push({coord:e.secondCapture.get(),value:J7.NONE}),t=n?this.turn+1:this.turn,this.setBoardAtCoords(r,t)}},{key:"setBoardAtCoords",value:function(e,t){var r,i=[i9.copyBiArray(this.boards[0]),i9.copyBiArray(this.boards[1]),i9.copyBiArray(this.boards[2]),i9.copyBiArray(this.boards[3])],a=dy(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.coord;i[s.z][s.y][s.x]=o.value}}catch(u){a.e(u)}finally{a.f()}return new n(i,t)}},{key:"isLandable",value:function(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;var t,n=dy(e.getLowerPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)===J7.NONE)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"isSupporting",value:function(e){if(3===e.z)return!1;var t,n=dy(e.getHigherCoords());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r).isPlayer())return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getPiecesRepartition",value:function(){var e={};e[J7.NONE.value]=0,e[e9.ZERO.value]=0,e[e9.ONE.value]=0;for(var t=0;t<3;t++)for(var n=0;n<4-t;n++)for(var r=0;r<4-t;r++){var i=new kle(r,n,t),a=this.getPieceAt(i);e[a.value]=1+e[a.value]}return e}},{key:"removePieceAt",value:function(e){return this.setBoardAtCoords([{coord:e,value:J7.NONE}],this.turn)}},{key:"dropCurrentPlayersPieceAt",value:function(e){var t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}},{key:"getFreeToMoves",value:function(){for(var e=[],t=this.getCurrentPlayer(),r=0;r<=2;r++){var i,a=n.getLevelRange(r),o=dy(a);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=dy(a);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=new kle(l,u,r);this.getPieceAt(f).equals(t)&&!1===this.isSupporting(f)&&e.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}}return e}}],[{key:"getInitialState",value:function(){return new n([i9.createTable(4,4,J7.NONE),i9.createTable(3,3,J7.NONE),i9.createTable(2,2,J7.NONE),[[J7.NONE]]],0)}},{key:"getLevelRange",value:function(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return IB.expectToBe(e,2),[0,1]}}}]),n}(Ite),Ele=function(){var e=my(function e(){gy(this,e)});return e.MUST_MOVE_UPWARD=function(){return $localize(Au||(Au=Wg(["You must move your pieces upward."])))},e.SHOULD_HAVE_SUPPORTING_PIECES=function(){return $localize(Mu||(Mu=Wg(["Your piece must land on the board or on 4 other pieces."])))},e.CANNOT_MOVE_SUPPORTING_PIECE=function(){return $localize(xu||(xu=Wg(["You cannot move a supporting piece."])))},e.CANNOT_CAPTURE=function(){return $localize(Ru||(Ru=Wg(["You cannot capture."])))},e.INVALID_FIRST_CAPTURE=function(){return $localize(Nu||(Nu=Wg(["Your first capture is invalid."])))},e.INVALID_SECOND_CAPTURE=function(){return $localize(Du||(Du=Wg(["Your second capture is invalid."])))},e}(),ble=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){var n=this.isLegalStartingCoord(e,t);if(n.isFailure())return DB.failure(n.getReason());var r=n.get(),i=this.isLegalLandingCoord(e,r);if(i.isFailure())return DB.failure(i.getReason());var a=i.get(),o=this.isLegalCaptures(e,a);return o.isFailure()?o:DB.success(void 0)}},{key:"isLegalStartingCoord",value:function(e,t){var n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){var r=e.startingCoord.get(),i=t.getPieceAt(r);if(i===n)return DB.failure(bte.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===J7.NONE)return DB.failure(bte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===r.getHigherCoords().filter(function(e){return t.getPieceAt(e).isPlayer()}).length){var a=t.removePieceAt(e.startingCoord.get());return DB.success(a)}return DB.failure(Ele.CANNOT_MOVE_SUPPORTING_PIECE())}return DB.success(t)}},{key:"isLegalLandingCoord",value:function(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?DB.failure(bte.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?DB.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):DB.failure(Ele.SHOULD_HAVE_SUPPORTING_PIECES())}},{key:"isLegalCaptures",value:function(e,t){if(e.firstCapture.isAbsent())return DB.success(void 0);if(!1===n.canCapture(t,e.landingCoord))return DB.failure(Ele.CANNOT_CAPTURE());if(n.isValidCapture(t,e,e.firstCapture.get())){var r=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||n.isValidCapture(r,e,e.secondCapture.get())?DB.success(void 0):DB.failure(Ele.INVALID_SECOND_CAPTURE())}return DB.failure(Ele.INVALID_FIRST_CAPTURE())}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getStateInfo",value:function(e){for(var t=[],n=[],r=0;r<3;r++)for(var i=0;i<4-r;i++)for(var a=0;a<4-r;a++){var o=new kle(a,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}},{key:"getClimbingMoves",value:function(e){var t,n=[],r=dy(e.freeToMove);try{var i=function(){var r,i=t.value,a=dy(e.landable);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.isUpperThan(i)&&!1===o.getLowerPieces().some(function(e){return i.equals(e)})){var s=wle.fromClimb(i,o,[]);n.push(s)}}}catch(u){a.e(u)}finally{a.f()}};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getDropMoves",value:function(e){var t,n=[],r=dy(e.landable);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=wle.fromDrop(i,[]);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"canCapture",value:function(e,t){for(var n=e.getCurrentPlayer(),r=0,i=[hte.UP,hte.DOWN];r<i.length;r++){var a=i[r],o=t.getNextValid(a);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(var s=0,u=[hte.LEFT,hte.RIGHT];s<u.length;s++){var c=u[s],l=o.get().getNextValid(c);if(l.isPresent()&&e.getPieceAt(l.get())===n){var f=a.getOpposite(),h=l.get().getNextValid(f).get();if(e.getPieceAt(h)===n)return!0}}}return!1}},{key:"getPossibleCaptures",value:function(e){var t,n=new Tte,r=dy(e.getFreeToMoves());try{for(r.s();!(t=r.n()).done;){var i=t.value;n.add(new Tte([i]));var a,o=dy(e.removePieceAt(i).getFreeToMoves());try{for(o.s();!(a=o.n()).done;){var s=a.value,u=new Tte([i,s]);n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isValidCapture",value:function(e,t,n){var r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r)&&0===n.getHigherCoords().filter(function(n){return e.getPieceAt(n).isPlayer()&&!1===n.equals(t.firstCapture.get())}).length}},{key:"getGameStatus",value:function(e){var t=e.gameState.getPiecesRepartition();return 15===t[e9.ZERO.value]?Bte.ONE_WON:15===t[e9.ONE.value]?Bte.ZERO_WON:Bte.ONGOING}}]),n}(zte),Ple=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){return n.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=ble.getGameStatus(e);if(t.isEndGame)return new Ste(t.toBoardValue());var n=e.gameState.getPiecesRepartition();return new Ste(n[e9.ZERO.value]-n[e9.ONE.value])}}],[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=[],i=ble.getStateInfo(n),a=ble.getClimbingMoves(i),o=ble.getDropMoves(i),s=dy(a.concat(o));try{for(s.s();!(t=s.n()).done;){var u=t.value,c=n.applyLegalMove(u,!1),l=new Tte;ble.canCapture(c,u.landingCoord)?l=ble.getPossibleCaptures(c):r.push(u);var f,h=dy(l);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=wle.changeCapture(u,d.toList());r.push(v)}}catch(p){h.e(p)}finally{h.f()}}}catch(p){s.e(p)}finally{s.f()}return r}}]),n}(Pte),Sle=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t=Ple.getListMoves(e);return this.orderMoves(t)}},{key:"orderMoves",value:function(e){return e.sort(function(e,t){var r=12*n.countStoneUsed(e),i=12*n.countStoneUsed(t);return r+n.sumMoveEmplacementByValue(e)-(i+n.sumMoveEmplacementByValue(t))})}}],[{key:"countStoneUsed",value:function(e){var t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}},{key:"sumMoveEmplacementByValue",value:function(e){var t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}]),n}(Ple),Ole=J7.NONE,Tle=J7.ZERO,Ile=J7.ONE,Ale=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(Lu||(Lu=Wg(["Goal of the game"]))),$localize(Fu||(Fu=Wg(["At Pylos, the goal is to be the last to play.\n        To do this, you have to save up your pieces.\n        As soon as a player puts its last piece, that player loses the game immediately.\n        Here is what the initial board looks like, it is a board of 4 x 4 squares.\n        This board will become a pyramid, little by little.\n        It will be filled by the pieces of your stock. Each player has 15 pieces."]))),_le.getInitialState()),Zte.anyMove($localize(Uu||(Uu=Wg(["Dropping a piece"]))),$localize(Vu||(Vu=Wg(["When it is your turn, you can always drop one of your piece on an empty square.\n        The gray squares are where you can drop your pieces.<br/><br/>\n        Click on one of the squares to drop a piece there."]))),_le.getInitialState(),wle.fromDrop(new kle(1,1,0),[]),$localize(Bu||(Bu=Wg(["There you go, as simple as that."])))),Zte.fromMove($localize(zu||(zu=Wg(["Climbing"]))),$localize(Hu||(Hu=Wg(["When 4 pieces form a square, it is possible to put a fifth piece on top.\n        However, when that happens, you can save a piece by climbing instead of dropping a piece.\n        To climb:\n        <ol>\n            <li>Click on one of your free pieces, which should be lower than the landing square.</li>\n            <li>Click on an empty landing square, higher than your selected piece.</li>\n        </ol><br/>\n        Go ahead, climb!"]))),new _le([[[Tle,Ile,Ole,Ole],[Ile,Tle,Ole,Ole],[Ole,Ole,Ole,Ole],[Ole,Ole,Ole,Tle]],[[Ole,Ole,Ole],[Ole,Ole,Ole],[Ole,Ole,Ole]],[[Ole,Ole],[Ole,Ole]],[[Ole]]],0),[wle.fromClimb(new kle(3,3,0),new kle(0,0,1),[])],$localize(Gu||(Gu=Wg(["Congratulations!<br/>\n        Some important notes:\n        <ol>\n            <li>You cannot move a piece that is directly below another one.</li>\n            <li>Of course, you cannot move the opponent's pieces.</li>\n            <li>You can only climb when the landing square is higher than the starting square.</li>\n        </ol>"]))),$localize($u||($u=Wg(["Failed!"])))),Zte.fromMove($localize(Zu||(Zu=Wg(["Square (1/2)"]))),$localize(qu||(qu=Wg(["When the piece you just moved or dropped is the fourth one of a square of your color,\n        you can choose anywhere on the board one or two of your pieces.\n        These pieces will be removed from the board, allowing you to save up one or two pieces.\n        A chosen piece must not be directly below another piece.\n        A chosen piece can be the piece you just placed.\n        You're playing Dark.<br/><br/>\n        Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move."]))),new _le([[[Tle,Tle,Ole,Ole],[Ole,Tle,Ole,Ole],[Ole,Ole,Ole,Ole],[Ole,Ole,Ole,Ole]],[[Ole,Ole,Ole],[Ole,Ole,Ole],[Ole,Ole,Ole]],[[Ole,Ole],[Ole,Ole]],[[Ole]]],0),[wle.fromDrop(new kle(0,1,0),[new kle(0,0,0)]),wle.fromDrop(new kle(0,1,0),[new kle(0,1,0)]),wle.fromDrop(new kle(0,1,0),[new kle(1,0,0)]),wle.fromDrop(new kle(0,1,0),[new kle(1,1,0)])],$localize(Wu||(Wu=Wg(["Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece."]))),$localize(ju||(ju=Wg(["Failed!"])))),Zte.fromPredicate($localize(Yu||(Yu=Wg(["Square (2/2)"]))),$localize(Ku||(Ku=Wg(["You're playing Dark.<br/><br/>\n        Do like in the previous step, but this time click on two different pieces before validating."]))),new _le([[[Tle,Tle,Ole,Ole],[Ole,Tle,Ole,Ole],[Ole,Ole,Ole,Ole],[Ole,Ole,Ole,Ole]],[[Ole,Ole,Ole],[Ole,Ole,Ole],[Ole,Ole,Ole]],[[Ole,Ole],[Ole,Ole]],[[Ole]]],0),wle.fromDrop(new kle(0,1,0),[new kle(0,0,0),new kle(1,0,0)]),function(e,t,n){return e.secondCapture.isPresent()?UB.SUCCESS:e.firstCapture.isPresent()?UB.failure($localize(Qu||(Qu=Wg(["Failed, you only captured one piece."])))):UB.failure(Jue.YOU_DID_NOT_CAPTURE_ANY_PIECE())},$localize(Xu||(Xu=Wg(["Congratulations, you have saved up two pieces."]))))]});function Mle(e,t){if(1&e&&(NC(),OP(0,"circle",8)),2&e){var n=t.$implicit,r=LP().$implicit,i=LP();VP("id","piece_",r.value,"_",n,""),EP("ngClass",i.getPlayerClass(r)),pP("cx",i.SPACE_SIZE/4+n/15*(i.BOARD_WIDTH-i.SPACE_SIZE/4))("cy",i.getPiecesCyForPlayer(r))("r",i.SPACE_SIZE/4-i.STROKE_WIDTH)}}function xle(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Mle,1,6,"circle",7),SP()),2&e){var n=t.$implicit,r=LP();BE(1),EP("ngForOf",r.getPlayerSidePieces(n))}}function Rle(e,t){if(1&e){var n=AP();NC(),PP(0,"circle",12),RP("click",function(){aC(n);var e=LP(2).$implicit,t=LP().$implicit,r=LP().$implicit;return LP().onPieceClick(e,t,r)}),SP()}if(2&e){var r=LP(2).$implicit,i=LP().$implicit,a=LP().$implicit,o=LP();BP("id","piece_",r,"_",i,"_",a,""),EP("ngClass",o.getPieceClasses(r,i,a)),pP("r",o.getPieceRadius(a)-o.STROKE_WIDTH)("cx",o.getPieceCx(r,i,a))("cy",o.getPieceCy(r,i,a))}}function Nle(e,t){if(1&e){var n=AP();NC(),PP(0,"rect",12),RP("click",function(){aC(n);var e=LP(2).$implicit,t=LP().$implicit,r=LP().$implicit;return LP().onDrop(e,t,r)}),SP()}if(2&e){var r=LP(2).$implicit,i=LP().$implicit,a=LP().$implicit,o=LP();BP("id","drop_",r,"_",i,"_",a,""),EP("ngClass",o.getSquareClasses(r,i,a)),pP("width",2*o.getPieceRadius(a))("height",2*o.getPieceRadius(a))("x",o.getPieceCx(r,i,a)-o.getPieceRadius(a))("y",o.getPieceCy(r,i,a)-o.getPieceRadius(a))}}function Dle(e,t){if(1&e&&(NC(),TP(0),CP(1,Rle,1,7,"circle",10),CP(2,Nle,1,8,"ng-template",null,11,tI),IP()),2&e){var n=wP(3),r=LP().$implicit,i=LP().$implicit,a=LP().$implicit,o=LP();BE(1),EP("ngIf",o.isOccupied(r,i,a))("ngIfElse",n)}}function Lle(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Dle,4,2,"ng-container",9),SP()),2&e){var n=t.$implicit,r=LP().$implicit,i=LP().$implicit,a=LP();BE(1),EP("ngIf",a.mustDraw(n,r,i))}}function Fle(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Lle,2,1,"g",1),SP()),2&e){var n=LP().$implicit,r=LP();BE(1),EP("ngForOf",r.getLevelRange(n))}}function Ule(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Fle,2,1,"g",1),SP()),2&e){var n=t.$implicit,r=LP();BE(1),EP("ngForOf",r.getLevelRange(n))}}function Vle(e,t){if(1&e&&(NC(),OP(0,"rect",13)),2&e){var n=LP();BP("id","highCapture_",n.highCapture.get().x,"_",n.highCapture.get().y,"_",n.highCapture.get().z,""),pP("width",2*n.getPieceRadius(n.highCapture.get().z))("height",2*n.getPieceRadius(n.highCapture.get().z))("x",n.getPieceCxByCoord(n.highCapture.get())-n.getPieceRadius(n.highCapture.get().z))("y",n.getPieceCyByCoord(n.highCapture.get())-n.getPieceRadius(n.highCapture.get().z))}}function Ble(e,t){if(1&e){var n=AP();NC(),PP(0,"g",14),RP("click",function(){return aC(n),LP().validateCapture()}),OP(1,"circle",15),OP(2,"polygon",16),SP()}if(2&e){var r=LP();pP("transform","translate("+4*r.SPACE_SIZE+" "+4*r.SPACE_SIZE+")"),BE(1),EP("ngClass",r.getCaptureValidationButtonClasses()),pP("cx",r.STROKE_WIDTH/2)("cy",r.STROKE_WIDTH/2)("r",r.SPACE_SIZE/2)}}function zle(e,t){if(1&e){var n=AP();NC(),PP(0,"g",17),RP("click",function(){var e=aC(n).$implicit;return LP().onPieceClick(e.x,e.y,e.z)}),OP(1,"line",18),OP(2,"line",18),SP()}if(2&e){var r=t.$implicit,i=LP();BP("id","capturable_",r.x,"_",r.y,"_",r.z,""),pP("transform","translate("+i.getPieceCxByCoord(r)+" "+i.getPieceCyByCoord(r)+")"),BE(1),pP("x1",-.25*i.getPieceRadius(r.z))("y1",-.25*i.getPieceRadius(r.z))("x2",.25*i.getPieceRadius(r.z))("y2",.25*i.getPieceRadius(r.z)),BE(1),pP("x1",.25*i.getPieceRadius(r.z))("y1",-.25*i.getPieceRadius(r.z))("x2",-.25*i.getPieceRadius(r.z))("y2",.25*i.getPieceRadius(r.z))}}var Hle=function(){return[0,1,2]},Gle=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).BOARD_WIDTH=4*r.SPACE_SIZE+r.STROKE_WIDTH,r.PIECE_ROW_HEIGHT=r.SPACE_SIZE/2,r.BOARD_HEIGHT=r.BOARD_WIDTH+2*r.PIECE_ROW_HEIGHT,r.lastLandingCoord=NB.empty(),r.lastStartingCoord=NB.empty(),r.lastFirstCapture=NB.empty(),r.lastSecondCapture=NB.empty(),r.highCapture=NB.empty(),r.capturables=[],r.chosenStartingCoord=NB.empty(),r.chosenLandingCoord=NB.empty(),r.chosenFirstCapture=NB.empty(),r.chosenSecondCapture=NB.empty(),r.lastMove=NB.empty(),r.remainingPieces={0:15,1:15},r.hasAsymetricBoard=!0,r.rules=new ble(_le),r.availableMinimaxes=[new Ple(r.rules,"PylosMinimax"),new Sle(r.rules,"PylosOrderedMinimax")],r.encoder=wle.encoder,r.tutorial=(new Ale).tutorial,r.updateBoard(),r}return my(n,[{key:"getPiecesCyForPlayer",value:function(e){return e===e9.ONE?this.PIECE_ROW_HEIGHT/2:this.BOARD_WIDTH+1.5*this.PIECE_ROW_HEIGHT}},{key:"getLevelRange",value:function(e){return _le.getLevelRange(e)}},{key:"mustDraw",value:function(e,t,n){var r=new kle(e,t,n);return!!(this.constructedState.getPieceAt(r).isPlayer()||this.justClimbed(r)||this.isCaptured(r))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(r)}},{key:"isCaptured",value:function(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}},{key:"onPieceClick",value:function(e,t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#piece_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new kle(e,t,n),i.abrupt("return",r.state.getPieceAt(o)===r.state.getCurrentOpponent()?r.cancelMove(bte.CANNOT_CHOOSE_OPPONENT_PIECE()):r.isSupporting(o)?r.cancelMove(Ele.CANNOT_MOVE_SUPPORTING_PIECE()):r.chosenStartingCoord.equalsValue(o)?(r.cancelMoveAttempt(),UB.SUCCESS):r.chosenLandingCoord.isAbsent()?r.onClimbClick(o):r.onCaptureClick(o));case 5:case"end":return i.stop()}},i)}))()}},{key:"isSupporting",value:function(e){return this.constructedState.isSupporting(e)}},{key:"onClimbClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.chosenStartingCoord=NB.of(e),t.constructedState=t.constructedState.removePieceAt(e),UB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"onCaptureClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chosenFirstCapture.equalsValue(e)?(t.chosenFirstCapture=NB.empty(),t.constructedState=t.constructedState.dropCurrentPlayersPieceAt(e),t.updateCapturableList(),UB.SUCCESS):t.chosenSecondCapture.equalsValue(e)?(t.chosenSecondCapture=NB.empty(),t.constructedState=t.constructedState.dropCurrentPlayersPieceAt(e),t.updateCapturableList(),UB.SUCCESS):t.chosenFirstCapture.isAbsent()?(t.chosenFirstCapture=NB.of(e),t.constructedState=t.constructedState.removePieceAt(e),t.updateCapturableList(),UB.SUCCESS):t.chosenSecondCapture.isAbsent()?(t.chosenSecondCapture=NB.of(e),t.constructedState=t.constructedState.removePieceAt(e),t.updateCapturableList(),UB.SUCCESS):t.cancelMove(Cle.MUST_CAPTURE_MAXIMUM_TWO_PIECES()));case 1:case"end":return n.stop()}},n)}))()}},{key:"updateCapturableList",value:function(){this.capturables=this.constructedState.getFreeToMoves()}},{key:"getCaptureValidationButtonClasses",value:function(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}},{key:"validateCapture",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#capture_validation"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?UB.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()]));case 2:case"end":return t.stop()}},t)}))()}},{key:"concludeMoveWithCapture",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(r=t.chosenStartingCoord.isAbsent()?wle.fromDrop(t.chosenLandingCoord.get(),e):wle.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(r,t.state)));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.cancelMove(),n.chooseMove(e,t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.state,this.chosenStartingCoord=NB.empty(),this.chosenLandingCoord=NB.empty(),this.chosenFirstCapture=NB.empty(),this.chosenSecondCapture=NB.empty(),this.capturables=[]}},{key:"onDrop",value:function(e,t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#drop_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new kle(e,t,n),i.abrupt("return",ble.canCapture(r.constructedState,o)?(r.chosenLandingCoord=NB.of(o),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(o),r.updateCapturableList(),UB.SUCCESS):r.isCapturelessMoveFinished(o)?(r.chosenLandingCoord=NB.of(o),r.concludeMoveWithCapture([])):r.cancelMove(Ele.MUST_MOVE_UPWARD()));case 5:case"end":return i.stop()}},i)}))()}},{key:"isCapturelessMoveFinished",value:function(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}},{key:"getSquareClasses",value:function(e,t,n){var r=new kle(e,t,n);if(this.lastMove.isPresent()){var i=this.lastMove.get();if(i.firstCapture.equalsValue(r)||i.secondCapture.equalsValue(r))return["captured-fill"];if(r.equals(i.landingCoord)||i.startingCoord.equalsValue(r))return["moved-fill"]}else if(this.justClimbed(r))return["moved-fill"];return[]}},{key:"justClimbed",value:function(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}},{key:"getPieceRadius",value:function(e){return this.SPACE_SIZE*(.45+.025*e)}},{key:"getPieceCx",value:function(e,t,n){return this.SPACE_SIZE/2+.5*n*this.SPACE_SIZE+e*this.SPACE_SIZE}},{key:"getPieceCy",value:function(e,t,n){return this.SPACE_SIZE/2+.5*n*this.SPACE_SIZE+t*this.SPACE_SIZE}},{key:"getPieceCxByCoord",value:function(e){return this.getPieceCx(e.x,e.y,e.z)}},{key:"getPieceCyByCoord",value:function(e){return this.getPieceCy(e.x,e.y,e.z)}},{key:"isOccupied",value:function(e,t,n){var r=new kle(e,t,n);if(this.justClimbed(r))return!1;var i=this.getState().getPieceAt(r).isPlayer(),a=this.chosenLandingCoord.equalsValue(r);return i||a}},{key:"getPieceClasses",value:function(e,t,n){var r=new kle(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected-stroke"),this.isCaptured(r)&&i.push("pre-captured-fill"),i}},{key:"getPieceFillClass",value:function(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.remainingPieces[e.value],n=[],r=0;r<t;r++)n.push(r);return n}},{key:"updateBoard",value:function(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.rules.node.move;var e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=NB.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.lastMove.get();this.lastLandingCoord=NB.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}},{key:"hideLastMove",value:function(){this.lastStartingCoord=NB.empty(),this.lastLandingCoord=NB.empty(),this.lastFirstCapture=NB.empty(),this.lastSecondCapture=NB.empty()}},{key:"mustDrawCoord",value:function(e){return this.mustDraw(e.x,e.y,e.z)}}]),n}(gte);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-pylos"]],features:[nP],decls:9,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],[1,"base","captured","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,xle,2,1,"g",1),PP(2,"g",null,2),OP(4,"rect",3),CP(5,Ule,2,1,"g",1),CP(6,Vle,1,7,"rect",4),CP(7,Ble,3,5,"g",5),CP(8,zle,3,12,"g",6),SP(),SP()),2&e&&(pP("viewBox","0 0 "+t.BOARD_WIDTH+" "+t.BOARD_HEIGHT)("transform",t.rotation),BE(1),EP("ngForOf",t.Player.PLAYERS),BE(1),pP("transform","translate("+t.STROKE_WIDTH/2+" "+(t.STROKE_WIDTH/2+t.PIECE_ROW_HEIGHT)+")"),BE(2),pP("width",4*t.SPACE_SIZE)("height",4*t.SPACE_SIZE),BE(1),EP("ngForOf",AT(10,Hle)),BE(1),EP("ngIf",t.highCapture.isPresent()),BE(1),EP("ngIf",t.chosenLandingCoord.isPresent()),BE(1),EP("ngForOf",t.capturables))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),$le=function(){function e(t){gy(this,e),this.value=t}return my(e,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"QuartoPiece("+this.value+")"}},{key:"isRectangle",value:function(){return this.value%4<2}}],[{key:"fromInt",value:function(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.EMPTY;throw new Error("Invalid piece ("+t+")")}}]),e}();$le.AAAA=new $le(0),$le.AAAB=new $le(1),$le.AABA=new $le(2),$le.AABB=new $le(3),$le.ABAA=new $le(4),$le.ABAB=new $le(5),$le.ABBA=new $le(6),$le.ABBB=new $le(7),$le.BAAA=new $le(8),$le.BAAB=new $le(9),$le.BABA=new $le(10),$le.BABB=new $le(11),$le.BBAA=new $le(12),$le.BBAB=new $le(13),$le.BBBA=new $le(14),$le.BBBB=new $le(15),$le.EMPTY=new $le(16),$le.pieces=[$le.AAAA,$le.AAAB,$le.AABA,$le.AABB,$le.ABAA,$le.ABAB,$le.ABBA,$le.ABBB,$le.BAAA,$le.BAAB,$le.BABA,$le.BABB,$le.BBAA,$le.BBAB,$le.BBBA,$le.BBBB];var Zle=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r)).piece=i,a}return my(n,[{key:"toString",value:function(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}},{key:"equals",value:function(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}]),n}(Rte);Zle.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 496}},{key:"encodeNumber",value:function(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}},{key:"decodeNumber",value:function(e){var t=e%32;e-=t;var n=(e/=32)%4;return e-=n,new Zle(e/=4,n,$le.fromInt(t))}}]),n}(Q7));var qle=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,e,r)).pieceInHand=i,a}return my(n,[{key:"getRemainingPieces",value:function(){var e,t=[],r=dy($le.pieces);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.isGivable(i,this.board,this.pieceInHand)&&t.push(i)}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"getInitialState",value:function(){return new n(i9.createTable(4,4,$le.EMPTY),0,$le.AAAA)}},{key:"isGivable",value:function(e,t,r){return e!==r&&!1===n.isAlreadyOnBoard(e,t)}},{key:"isAlreadyOnBoard",value:function(e,t){for(var n=0;n<4;n++)for(var r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}}]),n}(Ate),Wle=function(){var e=my(function e(){gy(this,e)});return e.MUST_GIVE_A_PIECE=function(){return $localize(Ju||(Ju=Wg(["You must give a piece."])))},e.PIECE_ALREADY_ON_BOARD=function(){return $localize(ec||(ec=Wg(["That piece is already on the board."])))},e.CANNOT_GIVE_PIECE_IN_HAND=function(){return $localize(tc||(tc=Wg(["You cannot give the piece that was in your hands."])))},e}(),jle=function(){function e(t){gy(this,e),this.subCriterion=[NB.empty(),NB.empty(),NB.empty(),NB.empty()],this.subCriterion[0]=NB.of(8==(8&t.value)),this.subCriterion[1]=NB.of(4==(4&t.value)),this.subCriterion[2]=NB.of(2==(2&t.value)),this.subCriterion[3]=NB.of(1==(1&t.value))}return my(e,[{key:"mergeWith",value:function(e){for(var t=4,n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=NB.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}},{key:"mergeWithQuartoPiece",value:function(t){var n=new e(t);return this.mergeWith(n)}},{key:"areAllAbsent",value:function(){for(var e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}},{key:"match",value:function(e){for(var t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}},{key:"matchPiece",value:function(t){return this.match(new e(t))}},{key:"toString",value:function(){return"Criterion{"+this.subCriterion.map(function(e){return e.isPresent()?e.get()?"1":"0":"x"}).join(" ")+"}"}}]),e}(),Yle=function(){function e(t,n){gy(this,e),this.initialCoord=t,this.direction=n}return my(e,[{key:"allCoords",value:function(){for(var e=[],t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}]),e}(),Kle=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t).toFallible(void 0)}},{key:"applyLegalMove",value:function(e,t){var n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new qle(n,t.turn+1,e.piece)}},{key:"getGameStatus",value:function(e){var t,r=e.gameState,i={score:Dte.DEFAULT,sensitiveSquares:new Xne},a=dy(n.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=n.updateBoardStatus(o,r,i)).score===Dte.VICTORY)return n.scoreToGameStatus(i.score,r.turn)}}catch(s){a.e(s)}finally{a.f()}return n.scoreToGameStatus(i.score,r.turn)}},{key:"getVictoriousCoords",value:function(e){var t,r=dy(n.lines);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.isThereAVictoriousLine(i,e))return i.allCoords()}}catch(a){r.e(a)}finally{r.f()}return[]}}],[{key:"isOccupied",value:function(e){return e!==$le.EMPTY}},{key:"isLegal",value:function(e,t){var r=e.coord.x,i=e.coord.y,a=e.piece,o=t.getCopiedBoard(),s=t.pieceInHand;return n.isOccupied(o[i][r])?UB.failure(bte.MUST_LAND_ON_EMPTY_SPACE()):a===$le.EMPTY?15===t.turn?UB.SUCCESS:UB.failure(Wle.MUST_GIVE_A_PIECE()):qle.isAlreadyOnBoard(a,o)?UB.failure(Wle.PIECE_ALREADY_ON_BOARD()):s===a?UB.failure(Wle.CANNOT_GIVE_PIECE_IN_HAND()):UB.SUCCESS}},{key:"updateBoardStatus",value:function(e,t,n){return n.score===Dte.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:Dte.VICTORY,sensitiveSquares:new Xne}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}},{key:"isThereAVictoriousLine",value:function(e,t){for(var r=e.initialCoord,i=t.getPieceAt(r),a=new jle(i),o=0;o<3&&!1!==n.isOccupied(i)&&!a.areAllAbsent();o++)r=r.getNext(e.direction,1),i=t.getPieceAt(r),a.mergeWithQuartoPiece(i);return!(!n.isOccupied(i)||a.areAllAbsent())}},{key:"searchForVictoryOrPreVictoryInLine",value:function(e,t,r){var i=n.getLineInfos(e,t,r);if(i.boardStatus.isPresent())return i.boardStatus.get();var a=i.commonCriterion,o=i.sensitiveCoord;if(a.isPresent()&&!1===a.get().areAllAbsent()){if(o.isAbsent())return{score:Dte.VICTORY,sensitiveSquares:new Xne};a.get().matchPiece(t.pieceInHand)&&(r.score=Dte.PRE_VICTORY);var s=o.get();r.sensitiveSquares.add(s)}return r}},{key:"getLineInfos",value:function(e,t,r){for(var i=NB.empty(),a=NB.empty(),o=e.initialCoord,s=0;s<4;s++){var u=t.getPieceAt(o);if(u===$le.EMPTY){if(!i.isAbsent())return{sensitiveCoord:NB.of(o),commonCriterion:a,boardStatus:NB.of(r)};i=NB.of(o)}else a.isAbsent()?(a=NB.of(new jle(u)),AB(n.VERBOSE,"set commonCrit to "+a.toString())):(a.get().mergeWithQuartoPiece(u),AB(n.VERBOSE,"update commonCrit: "+a.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:a,sensitiveCoord:i,boardStatus:NB.empty()}}},{key:"scoreToGameStatus",value:function(e,t){var n=e9.of(t%2);return e===Dte.VICTORY?Bte.getDefeat(n):16===t?Bte.DRAW:Bte.ONGOING}}]),n}(zte);Kle.VERBOSE=!1,Kle.lines=[new Yle(new pte(0,0),fte.DOWN),new Yle(new pte(1,0),fte.DOWN),new Yle(new pte(2,0),fte.DOWN),new Yle(new pte(3,0),fte.DOWN),new Yle(new pte(0,0),fte.RIGHT),new Yle(new pte(0,1),fte.RIGHT),new Yle(new pte(0,2),fte.RIGHT),new Yle(new pte(0,3),fte.RIGHT),new Yle(new pte(0,0),fte.DOWN_RIGHT),new Yle(new pte(0,3),fte.UP_RIGHT)];var Qle=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),a=n.pieceInHand,o=0;o<4;o++)for(var s=0;s<4;s++)if(r[o][s]===$le.EMPTY){if(n.getCopiedBoard()[o][s]=a,15===n.turn){var u=new Zle(s,o,$le.EMPTY);return t.push(u),t}var c,l=dy(i);try{for(l.s();!(c=l.n()).done;){var f=c.value,h=new Zle(s,o,f);t.push(h)}}catch(d){l.e(d)}finally{l.f()}}return t}},{key:"getBoardValue",value:function(e){var t,r=e.gameState,i={score:Dte.DEFAULT,sensitiveSquares:new Xne},a=dy(Kle.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=Kle.updateBoardStatus(o,r,i)).score===Dte.VICTORY)break}}catch(s){a.e(s)}finally{a.f()}return n.scoreToBoardValue(i.score,r.turn)}}],[{key:"scoreToBoardValue",value:function(e,t){if(e===Dte.DEFAULT)return new Ste(0);var n=e9.of(t%2);return new Ste(e===Dte.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}]),n}(Pte),Xle=$le.AABA,Jle=$le.AABB,efe=$le.ABAA,tfe=$le.ABAB,nfe=$le.ABBA,rfe=$le.BAAA,ife=$le.BAAB,afe=$le.BABB,ofe=$le.BBAA,sfe=$le.BBAB,ufe=$le.BBBA,cfe=$le.BBBB,lfe=$le.EMPTY,ffe=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(nc||(nc=Wg(["Goal of the game"]))),$localize(rc||(rc=Wg(["Quarto is an alignment game.\n        The goal is to align four pieces that have at least one common aspect:\n        <ul>\n          <li>their color (light or dark),</li>\n          <li>their size (big or small),</li>\n          <li>their pattern (empty or dotted),</li>\n          <li>their shape (round or square).</li>\n        </ul>\n        Here, we have a board with a victory by an alignment of dark pieces."]))),new qle([[ufe,ofe,efe,Xle],[lfe,lfe,lfe,lfe],[lfe,lfe,lfe,lfe],[lfe,lfe,lfe,lfe]],7,$le.ABAB)),Zte.anyMove($localize(ic||(ic=Wg(["Placement"]))),$localize(ac||(ac=Wg(["Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,\n        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.\n        If you prefer, the order of these two steps can be reversed.\n        Keep in mind that the second click confirms the move.<br/><br/>\n        Make a move."]))),new qle([[ufe,Jle,nfe,lfe],[lfe,lfe,lfe,lfe],[lfe,rfe,lfe,lfe],[lfe,lfe,lfe,lfe]],7,$le.ABAA),new Zle(2,2,$le.BAAB),$localize(oc||(oc=Wg(["Perfect!"])))),Zte.fromMove($localize(sc||(sc=Wg(["Situation"]))),$localize(uc||(uc=Wg(["We have here a tricky situation.<br/><br/>\n        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move."]))),new qle([[cfe,ufe,sfe,lfe],[efe,afe,ofe,lfe],[tfe,rfe,ife,lfe],[lfe,lfe,lfe,lfe]],7,$le.AABA),[new Zle(3,3,$le.AABB)],$localize(cc||(cc=Wg(["Well done!"]))),$localize(lc||(lc=Wg(["Failed!"]))))]});function hfe(e,t){if(1&e&&(NC(),OP(0,"rect",12)),2&e){var n=LP(2),r=n.$implicit,i=n.index,a=LP().index,o=LP();EP("ngClass",o.getPieceClasses(r.value)),pP("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*a+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function dfe(e,t){if(1&e&&(NC(),OP(0,"circle",12)),2&e){var n=LP(2),r=n.$implicit,i=n.index,a=LP().index,o=LP();EP("ngClass",o.getPieceClasses(r.value)),pP("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function vfe(e,t){if(1&e&&(NC(),OP(0,"circle")),2&e){var n=LP(2).index,r=LP().index,i=LP();pP("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function pfe(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,hfe,1,5,"rect",10),CP(2,dfe,1,4,"ng-template",null,11,tI),CP(4,vfe,1,3,"circle",7),SP()),2&e){var n=wP(3),r=LP().$implicit,i=LP(2);BE(1),EP("ngIf",r.isRectangle())("ngIfElse",n),BE(3),EP("ngIf",i.pieceHasDot(r.value))}}function gfe(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",9),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().chooseCoord(e,t)}),SP(),CP(2,pfe,5,3,"g",7),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP().index,o=LP();BE(1),VP("id","chooseCoord_",i,"_",a,""),EP("ngClass",o.getSquareClasses(i,a)),pP("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),BE(1),EP("ngIf",r!==o.EMPTY)}}function yfe(e,t){if(1&e&&(NC(),PP(0,"g",null,8),CP(2,gfe,3,8,"g",2),SP()),2&e){var n=t.$implicit;BE(2),EP("ngForOf",n)}}function mfe(e,t){if(1&e&&(NC(),OP(0,"rect",17)),2&e){var n=LP(2);EP("ngClass",n.getPieceClasses(n.pieceInHand.value)),pP("x",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("y",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function kfe(e,t){if(1&e&&(NC(),OP(0,"circle",12)),2&e){var n=LP(2);EP("ngClass",n.getPieceClasses(n.pieceInHand.value)),pP("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",n.getPieceSize(n.pieceInHand.value))}}function Cfe(e,t){if(1&e&&(NC(),OP(0,"circle")),2&e){var n=LP(2);pP("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",10)}}function wfe(e,t){if(1&e){var n=AP();NC(),PP(0,"g",13,14),RP("click",function(){return aC(n),LP().deselectDroppedPiece()}),OP(2,"rect",15),CP(3,mfe,1,5,"rect",16),CP(4,kfe,1,4,"ng-template",null,11,tI),CP(6,Cfe,1,3,"circle",7),SP()}if(2&e){var r=wP(5),i=LP();VP("id","droppedPiece_",i.chosen.get().x,"_",i.chosen.get().y,""),pP("transform","translate("+i.chosen.get().x*i.SPACE_SIZE+" "+i.chosen.get().y*i.SPACE_SIZE+")"),BE(2),pP("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),BE(1),EP("ngIf",i.pieceInHand.isRectangle())("ngIfElse",r),BE(3),EP("ngIf",i.pieceHasDot(i.pieceInHand.value))}}function _fe(e,t){if(1&e&&(NC(),PP(0,"g",null,18),OP(2,"rect",19),SP()),2&e){var n=t.$implicit,r=LP();BE(2),pP("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+n.x*r.SPACE_SIZE+" "+n.y*r.SPACE_SIZE+")")}}function Efe(e,t){if(1&e&&(NC(),OP(0,"rect",12)),2&e){var n=LP(2);EP("ngClass",n.getPieceClasses(n.pieceInHand.value)),pP("x",0)("y",.75*n.SPACE_SIZE)("transform","translate("+-n.getPieceSize(n.pieceInHand.value)+", "+-n.getPieceSize(n.pieceInHand.value)+")")("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function bfe(e,t){if(1&e&&(NC(),OP(0,"circle",21)),2&e){var n=LP(2);EP("ngClass",n.getPieceClasses(n.pieceInHand.value)),pP("cy",.75*n.SPACE_SIZE)("r",n.getPieceSize(n.pieceInHand.value))}}function Pfe(e,t){1&e&&(NC(),OP(0,"circle",22)),2&e&&pP("cy",.75*LP(2).SPACE_SIZE)("r",10)}function Sfe(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Efe,1,6,"rect",10),CP(2,bfe,1,3,"ng-template",null,11,tI),CP(4,Pfe,1,2,"circle",20),SP()),2&e){var n=wP(3),r=LP();BE(1),EP("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),BE(3),EP("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Ofe(e,t){if(1&e&&(NC(),OP(0,"rect",27)),2&e){var n=LP(2).index,r=LP().index,i=LP();UP("id","chosenPiece_",4*r+n,""),pP("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Tfe(e,t){if(1&e&&(NC(),OP(0,"rect",12)),2&e){var n=LP(2).index,r=LP().index,i=LP();EP("ngClass",i.getPieceClasses(4*r+n)),pP("x",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("y",i.SPACE_SIZE*r+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("width",2*i.getPieceSize(4*r+n))("height",2*i.getPieceSize(4*r+n))}}function Ife(e,t){if(1&e&&(NC(),OP(0,"circle",12)),2&e){var n=LP(2).index,r=LP().index,i=LP();EP("ngClass",i.getPieceClasses(4*r+n)),pP("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(4*r+n))}}function Afe(e,t){if(1&e&&(NC(),OP(0,"circle")),2&e){var n=LP(2).index,r=LP().index,i=LP();pP("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function Mfe(e,t){if(1&e){var n=AP();NC(),PP(0,"g",13),RP("click",function(){aC(n);var e=LP().index,t=LP().index;return LP().choosePiece(4*t+e)}),CP(1,Ofe,1,5,"rect",26),CP(2,Tfe,1,5,"rect",10),CP(3,Ife,1,4,"ng-template",null,11,tI),CP(5,Afe,1,3,"circle",7),SP()}if(2&e){var r=wP(4),i=LP().index,a=LP().index,o=LP();UP("id","choosePiece_",4*a+i,""),BE(1),EP("ngIf",o.pieceToGive.equalsValue(o.QuartoPiece.fromInt(4*a+i))),BE(1),EP("ngIf",(4*a+i)%4<2)("ngIfElse",r),BE(3),EP("ngIf",o.pieceHasDot(4*a+i))}}function xfe(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Mfe,6,5,"g",3),SP()),2&e){var n=t.index,r=LP().index,i=LP();BE(1),EP("ngIf",i.isRemaining(4*r+n))}}function Rfe(e,t){if(1&e&&(NC(),PP(0,"g",null,23),OP(2,"rect",24,25),CP(4,xfe,2,1,"g",2),SP()),2&e){var n=t.$implicit,r=LP();pP("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),BE(2),pP("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),BE(2),EP("ngForOf",n)}}var Nfe=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).EMPTY=$le.EMPTY,r.QuartoPiece=$le,r.chosen=NB.empty(),r.lastMove=NB.empty(),r.pieceInHand=$le.EMPTY,r.pieceToGive=NB.empty(),r.victoriousCoords=[],r.rules=new Kle(qle),r.availableMinimaxes=[new Qle(r.rules,"QuartoMinimax")],r.encoder=Zle.encoder,r.tutorial=(new ffe).tutorial,r.pieceInHand=r.getState().pieceInHand,r.updateBoard(),r}return my(n,[{key:"updateBoard",value:function(){var e=this.getState(),t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=NB.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(function(e){return e.coord})}},{key:"chooseCoord",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#chooseCoord_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.hideLastMove(),n.board[t][e]!==$le.EMPTY){r.next=11;break}if(n.showPieceInHandOnBoard(e,t),15!==n.getState().turn){r.next=7;break}return a=new Zle(e,t,$le.EMPTY),r.abrupt("return",n.chooseMove(a,n.getState()));case 7:if(!n.pieceToGive.isAbsent()){r.next=9;break}return r.abrupt("return",UB.SUCCESS);case 9:return o=new Zle(e,t,n.pieceToGive.get()),r.abrupt("return",n.chooseMove(o,n.getState()));case 11:return r.abrupt("return",n.cancelMove(bte.MUST_CLICK_ON_EMPTY_SPACE()));case 12:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#choosePiece_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(t.hideLastMove(),!t.pieceToGive.equalsValue($le.fromInt(e))){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),UB.SUCCESS));case 5:if(t.pieceToGive=NB.of($le.fromInt(e)),!t.chosen.isAbsent()){n.next=7;break}return n.abrupt("return",UB.SUCCESS);case 7:return i=t.chosen.get(),a=new Zle(i.x,i.y,t.pieceToGive.get()),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 9:case"end":return n.stop()}},n)}))()}},{key:"hideLastMove",value:function(){this.lastMove=NB.empty()}},{key:"cancelMoveAttempt",value:function(){this.hideLastMove(),this.pieceToGive=NB.empty(),this.chosen=NB.empty()}},{key:"deselectDroppedPiece",value:function(){var e=this.chosen.getOrElse(new pte(404,404)),t=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return t.isFailure()?this.cancelMove(t.getReason()):(this.cancelMoveAttempt(),UB.SUCCESS)}},{key:"showPieceInHandOnBoard",value:function(e,t){this.chosen=NB.of(new pte(e,t))}},{key:"isRemaining",value:function(e){return qle.isGivable($le.fromInt(e),this.board,this.pieceInHand)}},{key:"getSquareClasses",value:function(e,t){var n=new pte(e,t);return this.lastMove.equalsValue(n)?["moved-fill"]:[]}},{key:"getPieceClasses",value:function(e){var t=[];return t.push(e%2==0?"player0-fill":"player1-fill"),t}},{key:"getPieceSize",value:function(e){return e<8?40:25}},{key:"pieceHasDot",value:function(e){return e!==$le.EMPTY.value&&e%8<4}}]),n}(Sne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-quarto"]],features:[nP],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),PP(1,"g",1),CP(2,yfe,3,1,"g",2),CP(3,wfe,7,8,"g",3),CP(4,_fe,3,3,"g",2),PP(5,"g",null,4),OP(7,"rect",5,6),CP(9,Sfe,5,3,"g",7),SP(),CP(10,Rfe,5,6,"g",2),SP(),SP()),2&e&&(pP("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),BE(2),EP("ngForOf",t.board),BE(1),EP("ngIf",t.chosen.isPresent()),BE(1),EP("ngForOf",t.victoriousCoords),BE(1),pP("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),BE(2),pP("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),BE(2),EP("ngIf",t.chosen.isAbsent()),BE(1),EP("ngForOf",t.board))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Dfe=function(){var e=my(function e(){gy(this,e)});return e.NO_INSIDE_CLICK=function(){return $localize(fc||(fc=Wg(["You must pick a space from the edge of the board."])))},e}(),Lfe=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;gy(this,n),(a=t.call(this,e,r)).direction=i;var o=n.isValidCoord(a.coord);if(o.isFailure())throw new Error(o.getReason());if(0===e&&i===hte.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&i===hte.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===r&&i===hte.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===r&&i===hte.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.");return a}return my(n,[{key:"toString",value:function(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}],[{key:"isValidCoord",value:function(e){return e.isNotInRange(5,5)?UB.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?UB.failure(Dfe.NO_INSIDE_CLICK()):UB.SUCCESS}}]),n}(Rte);Lfe.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 128}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}},{key:"decodeNumber",value:function(e){var t=hte.factory.fromInt(e%4).get();e-=e%4;var n=(e/=4)%5;return e-=e%5,new Lfe(e/=5,n,t)}}]),n}(Q7));var Ffe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e){for(var t=this.getCopiedBoard(),r=this.turn+1,i=e.coord,a=e.coord.getNext(e.direction);a.isInRange(5,5);)t[i.y][i.x]=t[a.y][a.x],i=i.getNext(e.direction),a=a.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new n(t,r)}}],[{key:"getInitialState",value:function(){return new n(i9.createTable(5,5,J7.NONE),0)}}]),n}(Ate),Ufe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?DB.failure(bte.CANNOT_CHOOSE_OPPONENT_PIECE()):DB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getLinesSums(t),i=n.getFullestLine(r[e9.ZERO.value]),a=n.getFullestLine(r[e9.ONE.value]),o=t.getCurrentPlayer();return 5===i&&(o===e9.ZERO||a<5)?Bte.ZERO_WON:5===a?Bte.ONE_WON:Bte.ONGOING}}],[{key:"getVerticalCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new pte(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new pte(4,r));return n}},{key:"getHorizontalCenterCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new pte(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new pte(r,4));return n}},{key:"getPossibleDirections",value:function(e){var t=[];return 0!==e.x&&t.push(hte.LEFT),0!==e.y&&t.push(hte.UP),4!==e.x&&t.push(hte.RIGHT),4!==e.y&&t.push(hte.DOWN),t}},{key:"getLinesSums",value:function(e){var t={};t[e9.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[e9.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(var n=0;n<5;n++)for(var r=0;r<5;r++){var i=e.getPieceAtXY(r,n);if(i.isPlayer()){var a=i.value;t[a].columns[r]=t[a].columns[r]+1,t[a].rows[n]=t[a].rows[n]+1,r===n&&(t[a].diagonals[0]=t[a].diagonals[0]+1),r+n===4&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}},{key:"getVictoriousCoords",value:function(e){for(var t=n.getLinesSums(e),r=[],i=0;i<2;i++){for(var a=0;a<5;a++){if(5===t[i].columns[a])for(var o=0;o<5;o++)r.push(new pte(a,o));if(5===t[i].rows[a])for(var s=0;s<5;s++)r.push(new pte(s,a))}if(5===t[i].diagonals[0])for(var u=0;u<5;u++)r.push(new pte(u,u));if(5===t[i].diagonals[1])for(var c=0;c<5;c++)r.push(new pte(c,4-c))}return r}},{key:"getFullestLine",value:function(e){var t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max.apply(Math,fy(t))}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}}]),n}(zte),Vfe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t,n=[],r=Ufe.getVerticalCoords(e),i=dy(Ufe.getHorizontalCenterCoords(e).concat(r));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=dy(Ufe.getPossibleDirections(o));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=new Lfe(o.x,o.y,u);n.push(c)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Ufe.getLinesSums(t),r=Ufe.getFullestLine(n[e9.ZERO.value]),i=Ufe.getFullestLine(n[e9.ONE.value]),a=t.getCurrentPlayer();return new Ste(5===r&&(a===e9.ZERO||i<5)?e9.ZERO.getVictoryValue():5===i?e9.ONE.getVictoryValue():i-r)}}]),n}(Pte),Bfe=J7.NONE,zfe=J7.ZERO,Hfe=J7.ONE,Gfe=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(hc||(hc=Wg(["Goal of the game."]))),$localize(dc||(dc=Wg(["At Quixo, the goal is to align 5 of your pieces.\n        The first player plays with dark pieces, the second with light pieces.\n        The board is made of 25 spaces spread over a 5x5 square.\n        Every piece has a neutral side, a light side, and a dark side."]))),Ffe.getInitialState()),Zte.fromMove($localize(vc||(vc=Wg(["What a move looks like (without animation)"]))),$localize(pc||(pc=Wg(["When it is your turn:\n        <ol>\n            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.\n                You can only choose a piece from the edge of the board.</li>\n            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>\n        </ol>\n        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.\n        Once on the other side, all pieces will move by one space in the opposing direction.\n        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>\n        For example, take the bottom right neutral piece, and move it to the left (you're playing Light)."]))),new Ffe([[Bfe,Bfe,Bfe,Bfe,Bfe],[Bfe,Bfe,Bfe,Bfe,Bfe],[Bfe,Bfe,Bfe,Bfe,Bfe],[Bfe,Bfe,Bfe,Bfe,Bfe],[zfe,zfe,zfe,zfe,Bfe]],1),[new Lfe(4,4,hte.LEFT)],$localize(gc||(gc=Wg(["See how the four dark pieces have been moved one space to the right.\n        The neutral piece has been move 4 pieces to the left and has become light."]))),$localize(yc||(yc=Wg(["Failed!"])))),Zte.fromMove($localize(mc||(mc=Wg(["Victory"]))),$localize(kc||(kc=Wg(["You already know everything you need in order to play, but there is one last particularity.\n        If you create a line of 5 of your pieces, you win.\n        If you create a line of 5 of your opponent's pieces, you lose.\n        If you create both, you lose too!<br/><br/>\n        You can win with this board, try it.\n        You're playing Light."]))),new Ffe([[Bfe,Hfe,Bfe,Hfe,Hfe],[Bfe,zfe,zfe,Bfe,zfe],[Hfe,Hfe,Hfe,zfe,Hfe],[zfe,Bfe,zfe,Hfe,Hfe],[Hfe,zfe,Bfe,Hfe,zfe]],31),[new Lfe(3,0,hte.DOWN)],$localize(Cc||(Cc=Wg(["Congratulations, you won!"]))),$localize(wc||(wc=Wg(["Failed!"]))))]});function $fe(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"circle",4),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onBoardClick(e,t)}),SP(),SP()}if(2&e){var r=t.index,i=LP().index,a=LP();BE(1),VP("id","click_",r,"_",i,""),EP("ngClass",a.getPieceClasses(r,i)),pP("r",.45*a.SPACE_SIZE)("cx",(r+.5)*a.SPACE_SIZE)("cy",(i+.5)*a.SPACE_SIZE)}}function Zfe(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,$fe,2,6,"g",2),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function qfe(e,t){if(1&e){var n=AP();NC(),PP(0,"use",6),RP("click",function(){var e=aC(n).$implicit;return LP(2).chooseDirection(e)}),SP()}if(2&e){var r=t.$implicit,i=LP(2);UP("id","chooseDirection_",r,""),pP("transform",i.getArrowTransform(r))}}function Wfe(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,qfe,1,2,"use",5),SP()),2&e){var n=LP();BE(1),EP("ngForOf",n.getPossiblesDirections())}}var jfe=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).lastMoveCoord=NB.empty(),r.chosenCoord=NB.empty(),r.victoriousCoords=[],r.rules=new Ufe(Ffe),r.availableMinimaxes=[new Vfe(r.rules,"QuixoMinimax")],r.encoder=Lfe.encoder,r.tutorial=(new Gfe).tutorial,r.updateBoard(),r}return my(n,[{key:"updateBoard",value:function(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(function(e){return e.coord}),this.victoriousCoords=Ufe.getVictoriousCoords(this.state)}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=NB.empty()}},{key:"getPieceClasses",value:function(e,t){var n=new pte(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected-stroke"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move-stroke"),this.victoriousCoords.some(function(e){return e.equals(n)})&&r.push("victory-stroke"),r}},{key:"onBoardClick",value:function(e,t){var n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=new pte(e,t),i=Lfe.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(bte.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(r)?this.cancelMoveAttempt():this.chosenCoord=NB.of(r),UB.SUCCESS)}},{key:"getPossiblesDirections",value:function(){var e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push(hte.RIGHT),0!==t.x&&e.push(hte.LEFT),4!==t.y&&e.push(hte.DOWN),0!==t.y&&e.push(hte.UP),e}},{key:"chooseDirection",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#chooseDirection_"+e.toString())).isFailure()){n.next=5;break}n.t0=t.cancelMove(r.getReason()),n.next=9;break;case 5:return t.chosenDirection=e,n.next=8,t.tryMove();case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Lfe(n.x,n.y,e.chosenDirection),t.abrupt("return",(e.cancelMove(),e.chooseMove(r,e.getState())));case 2:case"end":return t.stop()}},t)}))()}},{key:"getArrowTransform",value:function(e){return function(){function e(){gy(this,e)}return my(e,null,[{key:"getArrowTransform",value:function(e,t,n){var r,i,a;switch(n){case hte.UP:r=1,i=0,a=-90;break;case hte.DOWN:r=1,i=2,a=90;break;case hte.LEFT:r=0,i=1,a=180;break;default:IB.expectToBe(n,hte.RIGHT),r=2,i=1,a=0}return["scale("+e/300+")","translate(".concat(100*r," ").concat(100*i,")"),"rotate("+a+" 50 50)"].join(" ")}}]),e}().getArrowTransform(5*this.SPACE_SIZE,new pte(0,0),e)}}]),n}(Sne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-quixo"]],features:[nP],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),PP(1,"defs"),OP(2,"polygon",1),SP(),CP(3,Zfe,2,1,"g",2),CP(4,Wfe,2,1,"g",3),SP()),2&e&&(pP("viewBox","0 0 "+5*t.SPACE_SIZE+" "+5*t.SPACE_SIZE),BE(3),EP("ngForOf",t.board),BE(1),EP("ngIf",t.chosenCoord.isPresent()))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Yfe=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"countScore",value:function(){for(var e=[0,0],t=0;t<n.BOARD_HEIGHT;t++)for(var r=0;r<n.BOARD_WIDTH;r++){var i=this.board[t][r];i.isPlayer()&&(e[i.value]+=1)}return e}}],[{key:"getInitialState",value:function(){var e=i9.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,J7.NONE);return e[3][3]=e9.ZERO,e[4][4]=e9.ZERO,e[3][4]=e9.ONE,e[4][3]=e9.ONE,new n(e,0)}},{key:"getNeighboringPawnLike",value:function(e,t,n,r){for(var i,a=[],o=-1;o<2;o++)for(var s=-1;s<2;s++)(i=new pte(n+s,r+o)).isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&a.push(i);return a}}]),n}(Ate);return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e}(),Kfe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"equals",value:function(e){return e===this||e.coord.equals(this.coord)}},{key:"toString",value:function(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Rte);Kfe.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return(Yfe.BOARD_HEIGHT-1)*Yfe.BOARD_WIDTH+(Yfe.BOARD_WIDTH-1)}},{key:"encodeNumber",value:function(e){return e.coord.y*Yfe.BOARD_WIDTH+e.coord.x}},{key:"decodeNumber",value:function(e){var t=e%Yfe.BOARD_WIDTH;return new Kfe(t,(e-t)/Yfe.BOARD_WIDTH)}}]),n}(Q7)),Kfe.PASS=new Kfe(-1,-1),Kfe.PASS_NUMBER=Kfe.encoder.encodeNumber(Kfe.PASS);var Qfe=function(){var e=my(function e(){gy(this,e)});return e.NO_ELEMENT_SWITCHED=function(){return $localize(_c||(_c=Wg(["Your move should switch at least one piece."])))},e}(),Xfe=my(function e(t,n){gy(this,e),this.move=t,this.switched=n}),Jfe=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.turn,i=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(Kfe.PASS))return new Yfe(a,r+1);var o,s=dy(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.y][u.x]=i}}catch(c){s.e(c)}finally{s.f()}return a[e.coord.y][e.coord.x]=i,new Yfe(a,r+1)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}},{key:"isLegal",value:function(e,t){if(e.equals(Kfe.PASS))return n.playerCanOnlyPass(t)?DB.success([]):DB.failure(bte.MUST_PASS());if(t.getPieceAt(e.coord).isPlayer())return AB(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),DB.failure(bte.MUST_CLICK_ON_EMPTY_SPACE());var r=t.getCopiedBoard(),i=n.getAllSwitcheds(e,t.getCurrentPlayer(),r);return AB(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?DB.failure(Qfe.NO_ELEMENT_SWITCHED()):DB.success(i)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;if(!1===n.isGameEnded(t))return Bte.ONGOING;var r=t.countScore(),i=r[1]-r[0];return i<0?Bte.ZERO_WON:i>0?Bte.ONE_WON:Bte.DRAW}},{key:"getAllSwitcheds",value:function(e,t,r){var i,a=[],o=t.getOpponent(),s=dy(fte.DIRECTIONS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=e.coord.getNext(u);if(c.isInRange(Yfe.BOARD_WIDTH,Yfe.BOARD_HEIGHT)&&r[c.y][c.x]===o){var l,f=dy(n.getSandwicheds(t,u,c,r));try{for(f.s();!(l=f.n()).done;){var h=l.value;a.push(h)}}catch(d){f.e(d)}finally{f.f()}}}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"getSandwicheds",value:function(e,t,n,r){for(var i=[n],a=n.getNext(t);a.isInRange(Yfe.BOARD_WIDTH,Yfe.BOARD_HEIGHT);){var o=r[a.y][a.x];if(o===e)return i;if(o===J7.NONE)return[];i.push(a),a=a.getNext(t)}return[]}},{key:"isGameEnded",value:function(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}},{key:"playerCanOnlyPass",value:function(e){var t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(Kfe.PASS)}},{key:"nextPlayerCantOnlyPass",value:function(e){var t=e.getCopiedBoard(),n=new Yfe(t,e.turn+1);return this.playerCanOnlyPass(n)}},{key:"getListMoves",value:function(e){for(var t,r=[],i=e.getCurrentPlayer(),a=e.getCurrentOpponent(),o=0;o<8;o++)for(var s=0;s<8;s++)if(e.getPieceAtXY(s,o)===J7.NONE&&(t=e.getCopiedBoard(),Yfe.getNeighboringPawnLike(t,a,s,o).length>0)){var u=new Kfe(s,o),c=n.getAllSwitcheds(u,i,t);if(c.length>0){var l,f=dy(c);try{for(f.s();!(l=f.n()).done;){var h=l.value;F7(i!==e.getPieceAt(h),h+"was already switched!"),t[h.y][h.x]=i}}catch(d){f.e(d)}finally{f.f()}t[o][s]=i,r.push(new Xfe(u,c.length))}}return 0===r.length&&r.push(new Xfe(Kfe.PASS,0)),r}}]),n}(zte);return e.VERBOSE=!1,e}(),ehe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getBoardValue",value:function(e){var t=Jfe.getGameStatus(e);if(t.isEndGame)return Ste.fromWinner(t.winner);for(var n=e.gameState.getCopiedBoard(),r=0,i=0,a=0;a<Yfe.BOARD_HEIGHT;a++)for(var o=0;o<Yfe.BOARD_WIDTH;o++){var s=(0===o||o===Yfe.BOARD_WIDTH-1?4:1)*(0===a||a===Yfe.BOARD_HEIGHT-1?4:1);n[a][o]===e9.ZERO&&(r+=s),n[a][o]===e9.ONE&&(i+=s)}return r*=e9.ZERO.getScoreModifier(),i*=e9.ONE.getScoreModifier(),new Ste(i+r)}},{key:"getListMoves",value:function(e){var t=Jfe.getListMoves(e.gameState);return i9.sortByDescending(t,function(e){return n.bestCoords.some(function(t){return e.move.coord.equals(t)})?100:e.switched}),t.map(function(e){return e.move})}}]),n}(Pte);ehe.bestCoords=[new pte(0,0),new pte(0,Yfe.BOARD_HEIGHT-1),new pte(Yfe.BOARD_WIDTH-1,0),new pte(Yfe.BOARD_WIDTH-1,Yfe.BOARD_HEIGHT-1)];var the=J7.NONE,nhe=J7.ZERO,rhe=J7.ONE,ihe=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(Ec||(Ec=Wg(["Goal of the game"]))),$localize(bc||(bc=Wg(["At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.\n        When one piece is flipped, its owner changes.\n        The player owning the most pieces at the end of the game wins.\n        Here, Dark has 28 points and Light has 36, hence Light wins."]))),new Yfe([[nhe,nhe,nhe,nhe,nhe,nhe,nhe,nhe],[nhe,rhe,rhe,rhe,rhe,rhe,rhe,nhe],[nhe,rhe,rhe,rhe,rhe,rhe,rhe,nhe],[nhe,rhe,rhe,rhe,rhe,rhe,rhe,nhe],[nhe,rhe,rhe,rhe,rhe,rhe,rhe,nhe],[nhe,rhe,rhe,rhe,rhe,rhe,rhe,nhe],[nhe,rhe,rhe,rhe,rhe,rhe,rhe,nhe],[nhe,nhe,nhe,nhe,nhe,nhe,nhe,nhe]],60)),Zte.anyMove($localize(Pc||(Pc=Wg(["Capture (1/2)"]))),$localize(Sc||(Sc=Wg(["At the beginning of the game, pieces are placed as shown here.\n        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>\n        Do any move by clicking to put your piece\n        Dark plays first."]))),Yfe.getInitialState(),new Kfe(2,4),$localize(Oc||(Oc=Wg(["Congratulations!"])))),Zte.fromMove($localize(Tc||(Tc=Wg(["Capture (2/2)"]))),$localize(Ic||(Ic=Wg(["A move can also capture a bigger line, and more than one lines at a time\n        You're playing light here.<br/><br/>\n        Play on the bottom left to see an example."]))),new Yfe([[the,the,the,the,the,the,the,the],[the,the,the,the,the,the,the,the],[the,the,the,the,the,the,the,the],[the,the,the,the,rhe,the,the,the],[the,the,the,nhe,the,the,the,the],[the,the,nhe,the,the,the,the,the],[nhe,nhe,the,the,the,the,the,the],[the,nhe,rhe,nhe,rhe,nhe,the,the]],1),[new Kfe(0,7)],$localize(Ac||(Ac=Wg(["Congratulations!"]))),$localize(Mc||(Mc=Wg(["Lower and more to the left, please."])))),Zte.informational($localize(xc||(xc=Wg(["Passing a turn"]))),$localize(Rc||(Rc=Wg(["If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass\n        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way."]))),new Yfe([[rhe,nhe,nhe,nhe,nhe,nhe,rhe,nhe],[nhe,rhe,rhe,rhe,rhe,rhe,rhe,nhe],[nhe,rhe,rhe,rhe,rhe,rhe,rhe,nhe],[nhe,rhe,rhe,rhe,rhe,rhe,rhe,nhe],[nhe,rhe,rhe,rhe,rhe,rhe,rhe,nhe],[nhe,rhe,rhe,rhe,rhe,rhe,rhe,nhe],[rhe,rhe,rhe,rhe,rhe,rhe,the,the],[nhe,nhe,nhe,nhe,nhe,nhe,the,the]],60))]});function ahe(e,t){if(1&e&&(NC(),OP(0,"circle",4)),2&e){var n=LP().index,r=LP().index,i=LP();EP("ngClass",i.getPieceClass(n,r)),pP("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)}}function ohe(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",2),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),SP(),CP(2,ahe,1,4,"circle",3),SP()}if(2&e){var r=t.index,i=LP().index,a=LP();BE(1),VP("id","click_",r,"_",i,""),EP("ngClass",a.getRectClasses(r,i)),pP("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),BE(1),EP("ngIf",a.board[i][r]!==a.EMPTY)}}function she(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,ohe,3,8,"g",1),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}var uhe=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).EMPTY=J7.NONE,r.lastMove=new pte(-2,-2),r.captureds=[],r.scores=NB.of([2,2]),r.rules=new Jfe(Yfe),r.availableMinimaxes=[new ehe(r.rules,"ReversiMinimax")],r.encoder=Kfe.encoder,r.tutorial=(new ihe).tutorial,r.canPass=!1,r.updateBoard(),r}return my(n,[{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new Kfe(e,t),r.next=6,n.chooseMove(a,n.getState(),n.scores.get());case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.getState();this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new pte(-2,-2),this.scores=NB.of(e.countScore()),this.canPass=Jfe.playerCanOnlyPass(e)}},{key:"showPreviousMove",value:function(){this.lastMove=this.rules.node.move.get().coord;var e,t=this.getState().getCurrentPlayer(),n=this.getState().getCurrentOpponent(),r=dy(fte.DIRECTIONS);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=this.lastMove.getNext(i,1);a.isInRange(Yfe.BOARD_WIDTH,Yfe.BOARD_HEIGHT)&&this.getState().getPieceAt(a)===n&&this.rules.node.mother.get().gameState.getPieceAt(a)===t;)this.captureds.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}}},{key:"getRectClasses",value:function(e,t){var n=new pte(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured-fill"]:n.equals(this.lastMove)?["moved-fill"]:[]}},{key:"getPieceClass",value:function(e,t){return this.getPlayerClass(this.board[t][e])}},{key:"pass",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(F7(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(Kfe.PASS.coord.x,Kfe.PASS.coord.y)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(Sne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-reversi"]],features:[nP],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,she,2,1,"g",1),SP()),2&e&&(pP("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),BE(1),EP("ngForOf",t.board))},directives:[aM,rM,sM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),che=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,null,[{key:"getInitialState",value:function(){var e=mte.UNREACHABLE,t=mte.ZERO,r=mte.ONE,i=mte.EMPTY;return new n([[e,e,t,r,i,i,i,t,r,e,e],[e,i,i,i,i,i,i,i,i,i,e],[r,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,r],[e,i,i,i,i,i,i,i,i,i,e],[e,e,r,t,i,i,i,r,t,e,e]],0)}}]),n}(bre);return e.HEIGHT=6,e.WIDTH=11,e}(),lhe=function(){var e=my(function e(){gy(this,e)});return e.CAN_ONLY_REBOUND_ON_BLACK=function(){return $localize(Nc||(Nc=Wg(["You can only rebound on dark spaces."])))},e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=function(){return $localize(Dc||(Dc=Wg(["You can only rebound on empty spaces."])))},e.MUST_CHOOSE_PYRAMID_FIRST=function(){return $localize(Lc||(Lc=Wg(["You must pick one of your pyramids first."])))},e.MUST_CHOOSE_OWN_PYRAMID=function(){return $localize(Fc||(Fc=Wg(["You must pick one of your pyramids."])))},e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=function(){return $localize(Uc||(Uc=Wg(["Those two spaces are not neighbors."])))},e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=function(){return $localize(Vc||(Vc=Wg(["Those two spaces have no intermediary neighbor."])))},e}(),fhe=function(e){iy(n,e);var t=oy(n);function n(e,r){return gy(this,n),t.call(this,e,r)}return my(n,[{key:"isSimpleStep",value:function(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"SaharaMove("+this.coord+"->"+this.end+")"}}],[{key:"checkDistanceAndLocation",value:function(e,t){var n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return UB.failure(bte.MOVE_CANNOT_BE_STATIC());if(1===n){var r=Ere.getFakeNeighbors(e);if(t.equals(r))return UB.failure(lhe.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return UB.failure($localize(Bc||(Bc=Wg(["You can move one or two spaces, not ","."])),n));if(Ere.isSpaceDark(e))return UB.failure(lhe.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return UB.failure(lhe.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return UB.SUCCESS}},{key:"from",value:function(e,t){if(!e.isInRange(che.WIDTH,che.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(che.WIDTH,che.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");var r=n.checkDistanceAndLocation(e,t);return r.isFailure()?r.toFailedFallible():DB.success(new n(e,t))}}]),n}(Fne);fhe.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"maxValue",value:function(){return 396*che.WIDTH+66*che.HEIGHT+6*che.WIDTH+che.HEIGHT}},{key:"encodeNumber",value:function(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){var t=e%6;e-=t;var n=(e/=6)%11;e-=n;var r=(e/=11)%6;return e-=r,fhe.from(new pte(e/=6,r),new pte(n,t)).get()}}]),n}(Q7));var hhe=function(){var e=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,r){AB(n.VERBOSE,"Legal move "+e.toString()+" applied");var i=t.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=mte.EMPTY,new che(i,t.turn+1)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return DB.failure(bte.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==mte.EMPTY)return DB.failure(bte.MUST_LAND_ON_EMPTY_SPACE());var n=Ere.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===mte.EMPTY?DB.success(void 0):DB.failure(lhe.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):DB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getCopiedBoard(),r=n.getBoardValuesFor(t,e9.ZERO),i=n.getBoardValuesFor(t,e9.ONE);return n.getGameStatusFromFreedoms(r,i)}},{key:"getLandingCoords",value:function(e,t){var n=function(t){return t.isInRange(che.WIDTH,che.HEIGHT)&&e[t.y][t.x]===mte.EMPTY},r=new Tte(Ere.getNeighbors(t).filter(n));if(!0===Ere.isSpaceDark(t))return r.toList();var i,a=new Tte(r.toList()),o=dy(r);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=dy(Ere.getNeighbors(u).filter(n));try{for(c.s();!(s=c.n()).done;){var l=s.value;a.add(l)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a.toList()}}],[{key:"getStartingCoords",value:function(e,t){for(var n=[],r=0;r<che.HEIGHT;r++)for(var i=0;i<che.WIDTH;i++)e[r][i].is(t)&&n.push(new pte(i,r));return n}},{key:"getBoardValuesFor",value:function(e,t){var r,i=[],a=dy(n.getStartingCoords(e,t));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=bre.getEmptyNeighbors(e,o,mte.EMPTY).length;if(0===s)return[0];i.push(s)}}catch(u){a.e(u)}finally{a.f()}return i.sort(function(e,t){return e-t})}},{key:"getGameStatusFromFreedoms",value:function(e,t){return 0===e[0]?Bte.ONE_WON:0===t[0]?Bte.ZERO_WON:Bte.ONGOING}}]),n}(zte);return e.VERBOSE=!1,e}(),dhe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),a=dy(hhe.getStartingCoords(r,i));try{for(a.s();!(t=a.n()).done;){var o,s=t.value,u=dy(bre.getEmptyNeighbors(r,s,mte.EMPTY));try{for(u.s();!(o=u.n()).done;){var c=o.value,l=fhe.from(s,c).get();if(r[c.y][c.x]=r[s.y][s.x],r[s.y][s.x]=mte.EMPTY,n.push(l),(c.y+c.x)%2==0){var f,h=dy(bre.getEmptyNeighbors(r,c,mte.EMPTY));try{for(h.s();!(f=h.n()).done;){var d=f.value;if(!d.equals(s)){var v=fhe.from(s,d).get();r[d.y][d.x]=r[c.y][c.x],r[c.y][c.x]=mte.EMPTY,n.push(v),r[c.y][c.x]=r[d.y][d.x],r[d.y][d.x]=mte.EMPTY}}}catch(p){h.e(p)}finally{h.f()}}r[s.y][s.x]=r[c.y][c.x],r[c.y][c.x]=mte.EMPTY}}catch(p){u.e(p)}finally{u.f()}}}catch(p){a.e(p)}finally{a.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState.getCopiedBoard(),n=hhe.getBoardValuesFor(t,e9.ZERO),r=hhe.getBoardValuesFor(t,e9.ONE),i=hhe.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return Ste.fromWinner(i.winner);for(var a=0;a<6&&n[a]===r[a];)a++;return new Ste(r[a%6]-n[a%6])}}]),n}(Pte),vhe=mte.UNREACHABLE,phe=mte.ZERO,ghe=mte.ONE,yhe=mte.EMPTY,mhe=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(zc||(zc=Wg(["Initial board"]))),$localize(Hc||(Hc=Wg(["S\xe2h\xe2r\xe2 is played on a board where each space is a triangle.\n        Each player has six pyramids."]))),che.getInitialState()),Zte.informational($localize(Gc||(Gc=Wg(["Goal of the game"]))),$localize($c||($c=Wg(["At S\xe2h\xe2r\xe2, the goal of the game is to immobilize one of the opponent's pyramids.\n        To do so, you have to occupy all neighboring space of that pyramid.\n        Here, Light has lost because its leftmost pyramid is immobilized."]))),new che([[vhe,vhe,yhe,yhe,ghe,yhe,yhe,phe,ghe,vhe,vhe],[vhe,yhe,yhe,yhe,yhe,yhe,yhe,yhe,yhe,yhe,vhe],[ghe,phe,yhe,yhe,yhe,yhe,yhe,yhe,yhe,yhe,phe],[phe,yhe,yhe,yhe,yhe,yhe,yhe,yhe,yhe,yhe,ghe],[vhe,yhe,yhe,yhe,yhe,yhe,yhe,yhe,yhe,yhe,vhe],[vhe,vhe,ghe,phe,yhe,yhe,yhe,ghe,phe,vhe,vhe]],3)),Zte.fromPredicate($localize(Zc||(Zc=Wg(["Simple step"]))),$localize(qc||(qc=Wg(["To immobilize your opponent, you have to move your pyramids.\n        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).\n        You're the first player, playing with the dark pyramids.\n        <ol>\n            <li>Click on one of your pyramids.</li>\n            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>\n        </ol><br/>\n        Do any simple step."]))),che.getInitialState(),fhe.from(new pte(2,0),new pte(2,1)).get(),function(e,t,n){return e.isSimpleStep()?UB.SUCCESS:UB.failure($localize(Wc||(Wc=Wg(["You have made a double step, which is good but it is the next exercise!"]))))},$localize(jc||(jc=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(Yc||(Yc=Wg(["Double step"]))),$localize(Kc||(Kc=Wg(["When a pyramid shares its vertices with dark spaces, it can move one or two steps.\n        To do so:\n        <ol>\n            <li>Click on the pyramid to move.</li>\n            <li>Click on one of the 6 destinations that you can reach in two steps:\n                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.\n        </ol>"]))),che.getInitialState(),fhe.from(new pte(7,0),new pte(5,0)).get(),function(e,t,n){return e.isSimpleStep()?UB.failure($localize(Qc||(Qc=Wg(["Failed! You have made a single step."])))):UB.SUCCESS},$localize(Xc||(Xc=Wg(["Congratulations!"]))))]});function khe(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"polygon",7),SP()),2&e){var n=LP().index,r=LP().index,i=LP();BE(1),EP("ngClass",i.getPlayerClassFor(n,r)),pP("points",i.getPyramidCoordinate(n,r))}}function Che(e,t){if(1&e&&(NC(),OP(0,"polygon",10)),2&e){var n=LP(2).index,r=LP().index;pP("points",LP().getTriangleCoordinate(n,r))}}function whe(e,t){if(1&e&&(NC(),OP(0,"polygon",11)),2&e){var n=LP(2).index,r=LP().index;pP("points",LP().getTriangleCoordinate(n,r))}}function _he(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Che,1,1,"polygon",8),CP(2,whe,1,1,"polygon",9),SP()),2&e){var n=LP().index,r=LP().index;BE(1),EP("ngIf",(n+r)%2==1),BE(1),EP("ngIf",(n+r)%2==0)}}function Ehe(e,t){if(1&e){var n=AP();NC(),PP(0,"g",5),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),CP(1,khe,2,2,"g",6),CP(2,_he,3,2,"g",6),SP()}if(2&e){var r=t.$implicit;VP("id","click_",t.index,"_",LP().index,""),BE(1),EP("ngIf",r.isPlayer()),BE(1),EP("ngIf",2===r.value)}}function bhe(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Ehe,3,4,"g",4),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function Phe(e,t){if(1&e&&(NC(),OP(0,"polygon",14)),2&e){var n=t.$implicit,r=LP(2);VP("id","possible_landing_",n.x,"_",n.y,""),pP("points",r.getTriangleCoordinate(n.x,n.y))}}function She(e,t){if(1&e&&(NC(),OP(0,"polygon",14)),2&e){var n=LP(2);VP("id","chosen_coord_",n.chosenCoord.get().x,"_",n.chosenCoord.get().y,""),pP("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function Ohe(e,t){if(1&e&&(NC(),TP(0),CP(1,Phe,1,3,"polygon",12),CP(2,She,1,3,"polygon",13),IP()),2&e){var n=LP();BE(1),EP("ngForOf",n.possibleLandings),BE(1),EP("ngIf",n.chosenCoord.isPresent())}}function The(e,t){if(1&e&&(NC(),TP(0),OP(1,"polygon",15),OP(2,"polygon",15),IP()),2&e){var n=LP(2);BE(1),pP("points",n.getTriangleCoordinate(n.lastCoord.get().x,n.lastCoord.get().y)),BE(1),pP("points",n.getTriangleCoordinate(n.lastMoved.get().x,n.lastMoved.get().y))}}function Ihe(e,t){1&e&&(NC(),CP(0,The,3,2,"ng-container",6)),2&e&&EP("ngIf",LP().lastMoved.isPresent())}var Ahe=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).lastCoord=NB.empty(),r.lastMoved=NB.empty(),r.chosenCoord=NB.empty(),r.possibleLandings=[],r.rules=new hhe(che),r.availableMinimaxes=[new dhe(r.rules,"SaharaMinimax")],r.encoder=fhe.encoder,r.tutorial=(new mhe).tutorial,r.updateBoard(),r}return my(n,[{key:"cancelMoveAttempt",value:function(){this.possibleLandings=[],this.chosenCoord=NB.empty()}},{key:"onClick",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.getState().getCurrentPlayer(),o=mte.ofPlayer(a),r.abrupt("return",n.chosenCoord.equalsValue(new pte(e,t))?(n.cancelMoveAttempt(),UB.SUCCESS):n.chosenCoord.isAbsent()||n.board[t][e]===o?n.choosePiece(e,t):n.chooseLandingCoord(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){if(this.board[t][e]===mte.EMPTY)return this.cancelMove(lhe.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[t][e].is(e9.fromTurn(this.getTurn()))){var n=new pte(e,t);return this.selectPiece(n),UB.SUCCESS}return this.cancelMove(lhe.MUST_CHOOSE_OWN_PYRAMID())}},{key:"selectPiece",value:function(e){this.chosenCoord=NB.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}},{key:"chooseLandingCoord",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new pte(e,t),!(a=fhe.from(n.chosenCoord.get(),i)).isFailure()){r.next=5;break}r.t0=n.cancelMove(a.getReason()),r.next=8;break;case 5:return r.next=7,n.chooseMove(a.get(),n.getState());case 7:r.t0=r.sent;case 8:return r.abrupt("return",r.t0);case 9:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.move;this.lastCoord=e.map(function(e){return e.coord}),this.lastMoved=e.map(function(e){return e.end}),this.board=this.getState().board}},{key:"getPlayerClassFor",value:function(e,t){return this.getPlayerClass(e9.of(this.board[t][e].value))}}]),n}(kre);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-sahara"]],features:[nP],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","selected-stroke",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,t){if(1&e&&(NC(),PP(0,"svg",0),CP(1,bhe,2,1,"g",1),CP(2,Ohe,3,2,"ng-container",2),CP(3,Ihe,1,1,"ng-template",null,3,tI),SP()),2&e){var n=wP(4);BE(1),EP("ngForOf",t.board),BE(1),EP("ngIf",t.chosenCoord.isPresent())("ngIfElse",n)}},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Mhe=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this,e,r)).x=e,o.y=r,o.direction=i,o.landingOrientation=a,o}return my(n,[{key:"isRotation",value:function(){return this.direction.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.direction.equals(e.direction))&&this.landingOrientation===e.landingOrientation}},{key:"toString",value:function(){var e=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}},{key:"isInsertion",value:function(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}],[{key:"of",value:function(e,t,r,i){var a=new n(e,t,r,i),o=a.coord.isNotInRange(5,5);if(a.isRotation()){if(o)return DB.failure("Cannot rotate piece outside the board: "+a.toString())}else if(a.coord.getNext(a.direction.get()).isNotInRange(5,5)){if(o)return DB.failure("SiamMove should end or start on the board: "+a.toString());if(a.direction.get()!==a.landingOrientation)return DB.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+a.toString())}return DB.success(a)}}]),n}(Rte);Mhe.encoder=Q7.tuple([Q7.numberEncoder(6),Q7.numberEncoder(6),function(e){return new(function(t){iy(r,t);var n=oy(r);function r(){return gy(this,r),n.apply(this,arguments)}return my(r,[{key:"maxValue",value:function(){return e.maxValue()+1}},{key:"encodeNumber",value:function(t){return t.isPresent()?e.encodeNumber(t.get()):e.maxValue()+1}},{key:"decodeNumber",value:function(t){return t===this.maxValue()?NB.empty():NB.of(e.decodeNumber(t))}}]),r}(Q7))}(new dte),new dte],function(e){return[e.x+1,e.y+1,e.direction,e.landingOrientation]},function(e){return Mhe.of(e[0]-1,e[1]-1,e[2],e[3]).get()});var xhe=function(){function e(t){gy(this,e),this.value=t}return my(e,[{key:"belongTo",value:function(e){return e===e9.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}},{key:"isEmptyOrMountain",value:function(){return 0===this.value||9===this.value}},{key:"isPiece",value:function(){return!this.isEmptyOrMountain()}},{key:"getOwner",value:function(){return 1<=this.value&&this.value<=4?e9.ZERO:5<=this.value&&this.value<=8?e9.ONE:J7.NONE}},{key:"getOptionalDirection",value:function(){switch(this.value){case 0:return NB.empty();case 1:case 5:return NB.of(hte.UP);case 2:case 6:return NB.of(hte.RIGHT);case 3:case 7:return NB.of(hte.DOWN);case 4:case 8:return NB.of(hte.LEFT);default:return IB.expectToBe(this.value,9),NB.empty()}}},{key:"getDirection",value:function(){return this.getOptionalDirection().get()}},{key:"toString",value:function(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return IB.expectToBe(this.value,9),"MOUNTAIN"}}}],[{key:"decode",value:function(t){switch(t){case 0:return e.EMPTY;case 1:return e.LIGHT_UP;case 2:return e.LIGHT_RIGHT;case 3:return e.LIGHT_DOWN;case 4:return e.LIGHT_LEFT;case 5:return e.DARK_UP;case 6:return e.DARK_RIGHT;case 7:return e.DARK_DOWN;case 8:return e.DARK_LEFT;case 9:return e.MOUNTAIN}}},{key:"of",value:function(t,n){return n===e9.ZERO?t===hte.UP?e.LIGHT_UP:t===hte.RIGHT?e.LIGHT_RIGHT:t===hte.DOWN?e.LIGHT_DOWN:e.LIGHT_LEFT:t===hte.UP?e.DARK_UP:t===hte.RIGHT?e.DARK_RIGHT:t===hte.DOWN?e.DARK_DOWN:e.DARK_LEFT}}]),e}();xhe.EMPTY=new xhe(0),xhe.LIGHT_UP=new xhe(1),xhe.LIGHT_RIGHT=new xhe(2),xhe.LIGHT_DOWN=new xhe(3),xhe.LIGHT_LEFT=new xhe(4),xhe.DARK_UP=new xhe(5),xhe.DARK_RIGHT=new xhe(6),xhe.DARK_DOWN=new xhe(7),xhe.DARK_LEFT=new xhe(8),xhe.MOUNTAIN=new xhe(9);var Rhe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"countCurrentPlayerPawn",value:function(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}},{key:"countPlayersPawn",value:function(){for(var e=[0,0],t=0;t<5;t++)for(var n=0;n<5;n++)this.board[t][n]!==xhe.EMPTY&&e[this.getPieceAtXY(n,t).getOwner().value]++;return e}}],[{key:"getInitialState",value:function(){var e=i9.createTable(5,5,xhe.EMPTY);return e[2][1]=xhe.MOUNTAIN,e[2][2]=xhe.MOUNTAIN,e[2][3]=xhe.MOUNTAIN,new n(e,0)}}]),n}(Ate),Nhe=function(){var e=my(function e(){gy(this,e)});return e.NO_REMAINING_PIECE_TO_INSERT=function(){return $localize(Jc||(Jc=Wg(["You cannot insert a piece, all your pieces are already on the board."])))},e.NOT_ENOUGH_FORCE_TO_PUSH=function(){return $localize(el||(el=Wg(["You do not have enough strength to push."])))},e.MUST_MOVE_OR_ROTATE=function(){return $localize(tl||(tl=Wg(["You must move or rotate your piece."])))},e.ILLEGAL_PUSH=function(){return $localize(nl||(nl=Wg(["Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board."])))},e.MUST_SELECT_VALID_DESTINATION=function(){return $localize(rl||(rl=Wg(["You must select a valid destination (highlighted on the board) for your piece"])))},e.MUST_SELECT_ORIENTATION=function(){return $localize(il||(il=Wg(["You should select the orientation of your piece by clicking on one of the arrows."])))},e}(),Dhe=my(function e(t,n){gy(this,e),this.resultingBoard=t,this.moved=n}),Lhe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.call(this,Rhe)}return my(n,[{key:"isLegal",value:function(e,t){if(AB(n.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return DB.failure(bte.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return AB(n.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);var r;if(e.isInsertion()){AB(n.VERBOSE,"Move is insertion");var i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return DB.failure(i.legal.getReason());r=i.insertedPiece}else AB(n.VERBOSE,"Move is forward"),r=t.getPieceAt(e.coord);return this.isLegalForwarding(e,t,r)}},{key:"isLegalInsertion",value:function(e,t){var n=t.countCurrentPlayerPawn(),r=t.getCurrentPlayer(),i=n<5?UB.SUCCESS:UB.failure(Nhe.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(e,r),legal:i}}},{key:"getInsertedPiece",value:function(e,t){return xhe.of(-1===e.x?hte.RIGHT:-1===e.y?hte.DOWN:5===e.x?hte.LEFT:hte.UP,t)}},{key:"isLegalForwarding",value:function(e,t,r){AB(n.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:r}}),F7(r!==xhe.MOUNTAIN&&r!==xhe.EMPTY,"forwarding must be done with player piece");var i=[],a=xhe.of(e.landingOrientation,t.getCurrentPlayer()),o=e.direction.get(),s=e.coord.getNext(o);if(s.isInRange(5,5)&&t.getPieceAt(s)!==xhe.EMPTY&&!1===this.isStraight(r,e))return AB(n.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),DB.failure(Nhe.ILLEGAL_PUSH());var u=NB.of(o),c=o.getOpposite(),l=0,f=t.getCopiedBoard();e.coord.isInRange(5,5)&&(f[e.coord.y][e.coord.x]=xhe.EMPTY,i.push(e.coord));for(var h=s.isInRange(5,5)&&a!==xhe.EMPTY;h;){u.equalsValue(o)?l++:u.equalsValue(c)&&l--,AB(n.VERBOSE,{totalForce:l,movingPiece:a,landingCoord:s});var d=f[s.y][s.x];d===xhe.MOUNTAIN&&(l-=.9),f[s.y][s.x]=a,i.push(s),a=d,s=s.getNext(o),u=a.getOptionalDirection(),h=s.isInRange(5,5)&&a!==xhe.EMPTY&&l>0}return s.isNotInRange(5,5)&&(AB(n.VERBOSE,"This movement would push "+a+" outside the board"),u.equalsValue(o)?l++:u.equalsValue(c)&&l--),l<=0?(AB(n.VERBOSE,"This move is an illegal push: "+f),DB.failure(Nhe.NOT_ENOUGH_FORCE_TO_PUSH())):(AB(n.VERBOSE,"This move is a legal push: "+f),DB.success(new Dhe(f,i)))}},{key:"isStraight",value:function(e,t){var n=e.getDirection();return t.direction.equalsValue(n)&&n===t.landingOrientation}},{key:"isLegalRotation",value:function(e,t){AB(n.VERBOSE,{isLegalRotation:{rotation:e,state:t}});var r=e.coord,i=t.getPieceAt(r),a=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return DB.failure(Nhe.MUST_MOVE_OR_ROTATE());var o=t.getCopiedBoard();return o[r.y][r.x]=xhe.of(e.landingOrientation,a),DB.success(new Dhe(o,[r]))}},{key:"applyLegalMove",value:function(e,t,n){var r=i9.copyBiArray(n.resultingBoard);return new Rhe(r,t.turn+1)}},{key:"getBoardValueInfo",value:function(e,t){var n=this.getMountainsRowsAndColumns(t),r=n.rows,i=n.columns,a=this.getWinner(t,e,n.nbMountain);if(a.isPlayer())return a===e9.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};var o,s=this.getPushers(t,i,r),u=Number.MAX_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,l=t.getCurrentPlayer(),f=dy(s);try{for(f.s();!(o=f.n()).done;){var h=o.value;h.coord.isInRange(5,5)?t.getPieceAt(h.coord).belongTo(e9.ZERO)?u=Math.min(u,h.distance):c=Math.min(c,h.distance):l===e9.ZERO?u=Math.min(u,h.distance):c=Math.min(c,h.distance)}}catch(d){f.e(d)}finally{f.f()}return{shortestZero:u,shortestOne:c,boardValue:this.getScoreFromShortestDistances(u,c,l)}}},{key:"getScoreFromShortestDistances",value:function(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);var r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}},{key:"getMountainsRowsAndColumns",value:function(e){for(var t=[],n=[],r=0,i=0;i<5;i++)for(var a=0;a<5;a++)e.getPieceAtXY(a,i)===xhe.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(a)||n.push(a),r++);return{rows:t,columns:n,nbMountain:r}}},{key:"getWinner",value:function(e,t,n){return 2===n?this.getPusher(e,t.get()):J7.NONE}},{key:"getPusher",value:function(e,t){var r=t.coord,i=(r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):this.getInsertedPiece(r,e.getCurrentOpponent())).getDirection(),a=this.getPusherCoord(e,i,r),o=e.getPieceAt(a).getOwner();return AB(n.VERBOSE,r.toString()+" belong to "+e.getCurrentOpponent().value+", "+a.toString()+" belong to "+o.value+", "+o.value+" win"),o}},{key:"getPusherCoord",value:function(e,t,n){for(var r=n.getNext(t),i=n;r.isInRange(5,5);){n=r,r=r.getNext(t);var a=e.getPieceAt(n);a!==xhe.MOUNTAIN&&a.getDirection()===t&&(i=n)}return i}},{key:"getPushers",value:function(e,t,r){AB(n.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:r}});var i,a=[],o=[],s=dy(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=hte.DOWN,l=new pte(u,4);o.push({direction:c,fallingCoord:l}),c=hte.UP,l=new pte(u,0),o.push({direction:c,fallingCoord:l})}}catch(k){s.e(k)}finally{s.f()}var f,h=dy(r);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=hte.LEFT,p=new pte(0,d);o.push({direction:v,fallingCoord:p}),v=hte.RIGHT,p=new pte(4,d),o.push({direction:v,fallingCoord:p})}}catch(k){h.e(k)}finally{h.f()}for(var g=0,y=o;g<y.length;g++){var m=y[g];a=this.addPotentialDirectionPusher(e,m.fallingCoord,m.direction,a)}return a}},{key:"addPotentialDirectionPusher",value:function(e,t,r,i){var a=this.getLineClosestPusher(e,t,r);if(a.isAbsent())return i;var o=a.get(),s=o.distance;return AB(n.VERBOSE,"new closest challenger"),i.push({coord:o.coord,distance:s}),i}},{key:"getLineClosestPusher",value:function(e,t,r){AB(n.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:r.toString()}});for(var i=r.getOpposite(),a=1,o=e.getPieceAt(t),s=t,u=NB.empty(),c=!1,l=!1,f=0;s.isInRange(5,5)&&!1===c;){var h=e.getPieceAt(s);if(h.isEmptyOrMountain())h===xhe.MOUNTAIN?(f+=.9,l=!0):a++;else{var d=h.getDirection();d===r?l&&((f-=1)<=0&&(c=!0,s=s.getNext(r))):d===i?(f+=1,l||a++):l?(u=NB.of(s),o!==xhe.EMPTY&&a++):a++}o=h,s=s.getPrevious(r)}if(!1===c&&u.isPresent())for(a++,f-=1;!1===s.equals(u.get());)s=s.getNext(r),a--;return s.isNotInRange(5,5)&&(f-=1,5===e.countCurrentPlayerPawn())||f>0?NB.empty():NB.of({distance:a,coord:s})}},{key:"getInsertions",value:function(e){for(var t=[],n=1;n<4;n++)t=(t=(t=(t=t.concat(this.getInsertionsAt(e,0,n))).concat(this.getInsertionsAt(e,4,n))).concat(this.getInsertionsAt(e,n,0))).concat(this.getInsertionsAt(e,n,4));return t=(t=(t=(t=t.concat(this.getInsertionsAt(e,0,0))).concat(this.getInsertionsAt(e,0,4))).concat(this.getInsertionsAt(e,4,0))).concat(this.getInsertionsAt(e,4,4))}},{key:"getInsertionsAt",value:function(e,t,n){var r,i=[],a=dy(hte.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=new pte(t,n).getPrevious(o);if(s.isNotInRange(5,5)){var u,c=dy(hte.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=Mhe.of(s.x,s.y,NB.of(o),l);F7(f.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(f.get(),e).isSuccess()&&i.push(f.get())}}catch(h){c.e(h)}finally{c.f()}}}}catch(h){a.e(h)}finally{a.f()}return i}},{key:"getMovesFrom",value:function(e,t,n,r){var i,a=new pte(n,r),o=this.getRotationMovesAt(a,t),s=dy(hte.ORTHOGONALS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=a.getNext(u);o=o.concat(this.getForwardMovesBetween(e,a,c))}}catch(l){s.e(l)}finally{s.f()}return o}},{key:"getMovesBetween",value:function(e,t,n,r){return n.equals(r)?this.getRotationMovesAt(n,t):hte.factory.fromMove(n,r).isSuccess()&&1===n.getDistance(r)?this.getForwardMovesBetween(e,n,r):[]}},{key:"getRotationMovesAt",value:function(e,t){var n,r=[],i=t.getDirection(),a=dy(hte.ORTHOGONALS);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o!==i){var s=Mhe.of(e.x,e.y,NB.empty(),o).get();r.push(s)}}}catch(u){a.e(u)}finally{a.f()}return r}},{key:"getForwardMovesBetween",value:function(e,t,n){var r,i=[],a=hte.factory.fromMove(t,n).get(),o=e.getPieceAt(t),s=dy(n.isInRange(5,5)?hte.ORTHOGONALS:[a]);try{for(s.s();!(r=s.n()).done;){var u=r.value,c=Mhe.of(t.x,t.y,NB.of(a),u).get();this.isLegalForwarding(c,e,o).isSuccess()&&i.push(c)}}catch(l){s.e(l)}finally{s.f()}return i}},{key:"getGameStatus",value:function(e){var t=this.getMountainsRowsAndColumns(e.gameState),n=this.getWinner(e.gameState,e.move,t.nbMountain);return n.isPlayer()?Bte.getVictory(n):Bte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=NB.of(new n)),n.singleton.get()}}]),n}(zte);Lhe.singleton=NB.empty(),Lhe.VERBOSE=!1;var Fhe=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getBoardValue",value:function(e){return new Ste(Lhe.get().getBoardValueInfo(e.move,e.gameState).boardValue)}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState.getCurrentPlayer(),r=0;r<5;r++)for(var i=0;i<5;i++){var a=e.gameState.getPieceAtXY(i,r);a.belongTo(n)&&(t=t.concat(Lhe.get().getMovesFrom(e.gameState,a,i,r)))}if(e.gameState.countCurrentPlayerPawn()<5){var o,s=dy(Lhe.get().getInsertions(e.gameState));try{for(s.s();!(o=s.n()).done;){var u=o.value;if(u.direction.get().getOpposite()!==u.landingOrientation){if(this.isOnBorder(u)&&u.direction.get()!==u.landingOrientation)continue;t.push(u)}}}catch(c){s.e(c)}finally{s.f()}}return AB(Lhe.VERBOSE,{getListMovesResult:t}),t}},{key:"isOnBorder",value:function(e){return 0===e.coord.x||4===e.coord.x||0===e.coord.y||4===e.coord.y}}]),n}(Pte),Uhe=xhe.EMPTY,Vhe=xhe.MOUNTAIN,Bhe=xhe.LIGHT_UP,zhe=xhe.LIGHT_LEFT,Hhe=xhe.LIGHT_RIGHT,Ghe=xhe.LIGHT_DOWN,$he=xhe.DARK_UP,Zhe=xhe.DARK_LEFT,qhe=xhe.DARK_RIGHT,Whe=xhe.DARK_DOWN,jhe=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(al||(al=Wg(["Goal of the game"]))),$localize(ol||(ol=Wg(["The goal at Siam is to be the first to push a mountain out of the board.\n        The initial board contains three mountains, and no pieces are initially on the board.\n        During its turn, a player can do one of the following actions:\n        <ol>\n            <li>Put a new piece on the board.</li>\n            <li>Change the orientation of one of its piece</li>\n            <li>Move one of its piece and optionally reorient it.</li>\n            <li>Take one of its pieces out of the board.</li>\n        </ol>"]))),Rhe.getInitialState()),Zte.anyMove($localize(sl||(sl=Wg(["Inserting a piece"]))),$localize(ul||(ul=Wg(["Each player has 5 pieces in total.\n        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:\n        <ol>\n            <li>Click on one of your pieces from your reserve, next to board.</li>\n            <li>Click on one of the highlighted squares to select a landing for your piece.</li>\n            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>\n        </ol><br/>\n        You're playing Light, insert a piece on the board."]))),Rhe.getInitialState(),Mhe.of(2,-1,NB.of(hte.DOWN),hte.DOWN).get(),$localize(cl||(cl=Wg(["Congratulations!"])))),Zte.fromMove($localize(ll||(ll=Wg(["Moving a piece"]))),$localize(fl||(fl=Wg(['We will distinguish here "moving" and "pushing".\n        A move is made from a piece\'s square to an empty neighboring square, horizontally or vertically.\n        You can also move a piece out of the board.\n        To move a piece:\n        <ol>\n            <li>Click on it.</li>\n            <li>Click on the square on which you want the piece to move.\n                You can also click a second time on your piece to change its orientation without moving it.</li>\n            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>\n        </ol><br/>\n        Try to move your piece that is already on the board one square upwards and to orient it to the left.']))),new Rhe([[Uhe,Uhe,Uhe,Uhe,Uhe],[Uhe,Uhe,Uhe,Uhe,Uhe],[Uhe,Vhe,Vhe,Vhe,Uhe],[Uhe,Uhe,Uhe,Uhe,Uhe],[Uhe,Uhe,Bhe,Uhe,Uhe]],0),[Mhe.of(2,4,NB.of(hte.UP),hte.LEFT).get()],$localize(hl||(hl=Wg(["Congratulations, you made a side-slip!"]))),$localize(dl||(dl=Wg(["Failed!"])))),Zte.fromMove($localize(vl||(vl=Wg(["Moving a piece out of the board"]))),$localize(pl||(pl=Wg(["To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>\n        Get that piece out of the board!"]))),new Rhe([[Uhe,Uhe,Uhe,Uhe,Uhe],[Uhe,Uhe,Uhe,Uhe,Uhe],[Uhe,Vhe,Vhe,Vhe,Uhe],[Uhe,Uhe,Uhe,Uhe,Uhe],[Uhe,Uhe,Bhe,Uhe,Uhe]],0),[Mhe.of(2,4,NB.of(hte.DOWN),hte.DOWN).get()],$localize(gl||(gl=Wg(["Congratulations, even if in this context it was not a useful move."]))),$localize(yl||(yl=Wg(["Failed, the piece is still on the board."])))),Zte.fromMove($localize(ml||(ml=Wg(["Pushing (1/2)"]))),$localize(kl||(kl=Wg(['When the landing square of your move is occupied, we use the term "push".\n        In order to push player pieces, the following conditions must hold:\n        <ol>\n            <li>Your piece must already be oriented in the direction of the push.</li>\n            <li>Along the line that you are pushing, the number of pieces (yours or your opponent\'s) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>\n        </ol>\n        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.\n        On the second row, you can push because there are two pieces against one.<br/><br/>\n        Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.']))),new Rhe([[Uhe,Hhe,Zhe,Uhe,Uhe],[Hhe,qhe,zhe,Uhe,Uhe],[Uhe,Uhe,Bhe,Uhe,Uhe],[Uhe,Uhe,Uhe,Uhe,Uhe],[Uhe,Uhe,Uhe,Uhe,Uhe]],0),[Mhe.of(2,2,NB.of(hte.UP),hte.UP).get()],$localize(Cl||(Cl=Wg(["Congratulations!"]))),$localize(wl||(wl=Wg(["Failed!"])))),Zte.fromMove($localize(_l||(_l=Wg(["Pushing (2/2)"]))),$localize(El||(El=Wg(["To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.\n        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.\n        On the following board, you can push the mountain on the first row.\n        On the second and third row, because of the resisting forces, you cannot push.<br/><br/>\n        On the fourth row, you can push as there is one more pusher than resistant pieces. Do it."]))),new Rhe([[Uhe,Uhe,Hhe,Vhe,Uhe],[Uhe,Uhe,Hhe,Vhe,zhe],[Uhe,Hhe,Vhe,Vhe,Uhe],[Uhe,Hhe,qhe,Zhe,Vhe],[Uhe,Uhe,Uhe,Uhe,Uhe]],0),[Mhe.of(1,3,NB.of(hte.RIGHT),hte.RIGHT).get()],$localize(bl||(bl=Wg(["Congratulations! Note that this move made you lose the game, you will see why in the next step."]))),$localize(Pl||(Pl=Wg(["Failed!"])))),Zte.fromMove($localize(Sl||(Sl=Wg(["Victory"]))),$localize(Ol||(Ol=Wg(["The game ends when a mountain is pushed out of the board.\n        If you pushed it and nobody is in front of you, you're the winner.\n        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.\n        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>\n        Here, you can push a mountain off the board and either win, or lose. Choose correctly!"]))),new Rhe([[Uhe,Uhe,Uhe,Uhe,Uhe],[Uhe,Uhe,Uhe,Uhe,Uhe],[Vhe,$he,zhe,Uhe,Ghe],[Uhe,Uhe,Uhe,Uhe,Whe],[Uhe,Uhe,Uhe,Uhe,Vhe]],0),[Mhe.of(2,2,NB.of(hte.LEFT),hte.LEFT).get()],$localize(Tl||(Tl=Wg(["Congratulations, you won!"]))),$localize(Il||(Il=Wg(["Failed, you lost."]))))]});function Yhe(e,t){if(1&e){var n=AP();NC(),PP(0,"use",11),RP("click",function(){aC(n);var e=LP().index,t=LP().index;return LP().clickSquare(e,t)}),SP()}if(2&e){var r=LP(),i=r.index,a=r.$implicit,o=LP().index,s=LP();VP("id","piece_",i,"_",o,""),EP("ngClass",s.getPieceClasses(i,o,a)),pP("transform",s.getPieceTransform(i,o))}}function Khe(e,t){if(1&e){var n=AP();NC(),PP(0,"use",12),RP("click",function(){aC(n);var e=LP().index,t=LP().index;return LP().clickSquare(e,t)}),SP()}if(2&e){var r=LP().index,i=LP().index,a=LP();pP("transform","translate("+(r+1)*a.SPACE_SIZE+" "+(i+1)*a.SPACE_SIZE+")")}}function Qhe(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",8),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().clickSquare(e,t)}),SP(),CP(2,Yhe,1,4,"use",9),CP(3,Khe,1,1,"use",10),SP()}if(2&e){var r=t.$implicit,i=t.index,a=LP().index,o=LP();BE(1),VP("id","square_",i,"_",a,""),EP("ngClass",o.getSquareClasses(i,a)),pP("x",o.SPACE_SIZE*(i+1))("y",o.SPACE_SIZE*(a+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),BE(1),EP("ngIf",r.isPiece()),BE(1),EP("ngIf",o.isMountain(r))}}function Xhe(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Qhe,4,9,"g",4),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function Jhe(e,t){if(1&e){var n=AP();NC(),PP(0,"rect",15),RP("click",function(){aC(n);var e=LP().$implicit;return LP().clickSquare(e.x,e.y)}),SP()}if(2&e){var r=LP().$implicit,i=LP();VP("id","square_",r.x,"_",r.y,""),EP("ngClass",i.getSquareClasses(r.x,r.y)),pP("x",i.SPACE_SIZE*(r.x+1))("y",i.SPACE_SIZE*(r.y+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function ede(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),CP(1,Jhe,1,7,"rect",13),PP(2,"rect",14),RP("click",function(){var e=aC(n).$implicit;return LP().clickSquare(e.x,e.y)}),SP(),SP()}if(2&e){var r=t.$implicit,i=LP();BE(1),EP("ngIf",!1===r.isInRange(5,5)),BE(1),pP("x",i.SPACE_SIZE*(r.x+1))("y",i.SPACE_SIZE*(r.y+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function tde(e,t){if(1&e){var n=AP();NC(),PP(0,"rect",16),RP("click",function(){aC(n);var e=LP();return e.clickSquare(e.selectedLanding.get().x,e.selectedLanding.get().y)}),SP()}if(2&e){var r=LP();pP("x",r.SPACE_SIZE*(r.selectedLanding.get().x+1))("y",r.SPACE_SIZE*(r.selectedLanding.get().y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function nde(e,t){if(1&e){var n=AP();NC(),PP(0,"rect",16),RP("click",function(){aC(n);var e=LP();return e.clickSquare(e.selectedPiece.get().x,e.selectedPiece.get().y)}),SP()}if(2&e){var r=LP();pP("x",r.SPACE_SIZE*(r.selectedPiece.get().x+1))("y",r.SPACE_SIZE*(r.selectedPiece.get().y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function rde(e,t){if(1&e&&(NC(),OP(0,"use",19)),2&e){var n=t.$implicit,r=LP().$implicit,i=LP();VP("id","remainingPieces_",r.value,"_",n,""),EP("ngClass",i.getRemainingPieceClasses(r,n)),pP("transform",i.getRemainingPieceTransform(n,r))}}function ide(e,t){if(1&e){var n=AP();NC(),PP(0,"g",17),RP("click",function(){var e=aC(n).$implicit;return LP().selectPieceForInsertion(e)}),CP(1,rde,1,4,"use",18),SP()}if(2&e){var r=t.$implicit,i=LP();UP("id","remainingPieces_",r.value,""),BE(1),EP("ngForOf",i.range(i.playerPieces(r)))}}function ade(e,t){if(1&e){var n=AP();NC(),PP(0,"use",22),RP("click",function(){aC(n);var e=LP().$implicit;return LP().clickSquare(e.source.get().coord.x,e.source.get().coord.y)}),SP()}if(2&e){var r=LP().$implicit,i=LP();EP("ngClass",i.getPieceClasses(r.source.get().coord.x,r.source.get().coord.y,r.source.get().piece)),pP("transform",i.getPieceTransform(r.source.get().coord.x,r.source.get().coord.y))}}function ode(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"use",20),RP("click",function(){var e=aC(n).$implicit;return LP().clickArrow(e)}),SP(),CP(2,ade,1,2,"use",21),SP()}if(2&e){var r=t.$implicit,i=LP();BE(1),BP("id","indicator_",r.target.x,"_",r.target.y,"_",r.direction.toString(),""),pP("transform",i.getIndicatorTransform(r)),BE(1),EP("ngIf",r.source.isPresent())}}function sde(e,t){if(1&e){var n=AP();NC(),PP(0,"use",23),RP("click",function(){var e=aC(n).$implicit;return LP().selectOrientation(e)}),SP()}if(2&e){var r=t.$implicit,i=LP();UP("id","orientation_",r.landingOrientation,""),EP("ngClass",i.getCurrentPlayerClass()),pP("transform",i.getOrientationTransform(r.landingOrientation))}}var ude=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).lastMove=NB.empty(),r.movedPieces=[],r.selectedPiece=NB.empty(),r.selectedLanding=NB.empty(),r.orientations=[],r.clickableCoords=new Tte,r.indicatorArrows=[],r.insertingPiece=!1,r.rules=Lhe.get(),r.availableMinimaxes=[new Fhe(r.rules,"SiamMinimax")],r.encoder=Mhe.encoder,r.tutorial=(new jhe).tutorial,r.updateBoard(),r}return my(n,[{key:"updateBoard",value:function(){AB(n.VERBOSE,"updateBoard");var e=this.getState();if(this.board=e.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var t=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),t).get().moved}else this.movedPieces=[]}},{key:"cancelMoveAttempt",value:function(){this.insertingPiece=!1,this.selectedPiece=NB.empty(),this.selectedLanding=NB.empty(),this.orientations=[],this.clickableCoords=new Tte,this.indicatorArrows=[]}},{key:"selectPieceForInsertion",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#remainingPieces_"+e.value)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(e===t.getCurrentPlayer()){n.next=5;break}return n.abrupt("return",t.cancelMove(bte.MUST_CHOOSE_PLAYER_PIECE()));case 5:if(!t.insertingPiece){n.next=7;break}return n.abrupt("return",(t.cancelMoveAttempt(),UB.SUCCESS));case 7:t.cancelMoveAttempt(),i=dy(Lhe.get().getInsertions(t.getState()));try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.coord.getNext(o.direction.get()),t.board[s.y][s.x]!==xhe.EMPTY&&(u={source:NB.empty(),target:s,direction:o.direction.get(),move:o},t.indicatorArrows.push(u)),t.clickableCoords.add(s)}catch(c){i.e(c)}finally{i.f()}return n.abrupt("return",(t.insertingPiece=!0,UB.SUCCESS));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectOrientation",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#orientation_"+e.landingOrientation.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.chooseMove(e,t.getState()));case 2:case"end":return n.stop()}},n)}))()}},{key:"clickSquare",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this;return TB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(AB(n.VERBOSE,"SiamComponent.clickSquare("+e+", "+t+")"),!1!==r){a.next=4;break}if(!(o=i.canUserPlay("#square_"+e+"_"+t)).isFailure()){a.next=4;break}return a.abrupt("return",i.cancelMove(o.getReason()));case 4:if(s=new pte(e,t),!i.insertingPiece){a.next=7;break}return a.abrupt("return",i.insertPiece(s));case 7:if(!i.selectedLanding.isPresent()){a.next=9;break}return a.abrupt("return",(i.cancelMoveAttempt(),UB.SUCCESS));case 9:if(!i.selectedPiece.isPresent()){a.next=13;break}return i.selectedLanding=NB.of(s),u=Lhe.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),s),a.abrupt("return",0===u.length?i.changeMoveDestinationClick(s):i.performMoveOrShowOrientationArrows(u));case 13:return F7(i.getState().isOnBoard(s),"SiamComponent: user clicked outside of board when it should not be possible"),c=i.board[t][e],a.abrupt("return",c.getOwner()!==i.getCurrentPlayer()?i.cancelMove(bte.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(s,c));case 16:case"end":return a.stop()}},a)}))()}},{key:"insertPiece",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selectedLanding.isPresent()){n.next=2;break}return n.abrupt("return",(t.cancelMove(Nhe.MUST_SELECT_ORIENTATION()),UB.SUCCESS));case 2:return t.selectedLanding=NB.of(e),r=Lhe.get().getInsertionsAt(t.getState(),e.x,e.y),n.abrupt("return",0===r.length?t.changeMoveDestinationClick(e):t.performMoveOrShowOrientationArrows(r));case 5:case"end":return n.stop()}},n)}))()}},{key:"changeMoveDestinationClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.cancelMoveAttempt(),t.getState().getPieceAt(e).getOwner()===t.getCurrentPlayer()?t.clickSquare(e.x,e.y,!0):t.cancelMove(Nhe.MUST_SELECT_VALID_DESTINATION())));case 1:case"end":return n.stop()}},n)}))()}},{key:"performMoveOrShowOrientationArrows",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(F7(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(t.cancelMove(),t.chooseMove(e[0],t.getState())):(t.clickableCoords=new Tte,t.indicatorArrows=[],t.orientations=e,UB.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"selectPiece",value:function(e,t){this.cancelMoveAttempt();var n=this.getState();this.selectedPiece=NB.of(e);var r,i=dy(Lhe.get().getMovesFrom(n,t,e.x,e.y));try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.direction.isPresent()){var o=a.coord.getNext(a.direction.get());if(this.clickableCoords.add(o),n.isOnBoard(o)&&n.getPieceAt(o)!==xhe.EMPTY){var s={source:NB.of({coord:e,piece:t}),target:o,direction:a.direction.get(),move:a};this.indicatorArrows.push(s)}}else this.clickableCoords.add(a.coord)}}catch(u){i.e(u)}finally{i.f()}return UB.SUCCESS}},{key:"clickArrow",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.chooseMove(e.move,t.getState()));case 2:case"end":return n.stop()}},n)}))()}},{key:"isMountain",value:function(e){return e===xhe.MOUNTAIN}},{key:"getArrowTransform",value:function(e,t,n){var r="rotate(".concat(90*(n.toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}},{key:"getPieceTransform",value:function(e,t){return this.getArrowTransform(e+1,t+1,this.board[t][e].getDirection())}},{key:"getIndicatorTransform",value:function(e){var t=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(t.x+1,t.y+1,e.direction)}},{key:"getRemainingPieceTransform",value:function(e,t){var n,r,i=this.playerPieces(t),a=2;return t===e9.ONE?(a+=(i-e+(5-i)/2)/3,n=-1,r=hte.RIGHT):(a+=(e+1+(5-i)/2)/3,n=7,r=hte.LEFT),this.getArrowTransform(a,n,r)}},{key:"getOrientationTransform",value:function(e){var t="translate(0, ".concat(this.SPACE_SIZE/1.6,")"),n="rotate(".concat(90*(e.toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate(".concat(2.27*this.SPACE_SIZE,", ").concat(2.27*this.SPACE_SIZE,")"),"scale(2.43)",n,t].join(" ")}},{key:"getPieceClasses",value:function(e,t,n){var r=new pte(e,t),i=[this.getPlayerClass(n.getOwner())];return this.selectedPiece.equalsValue(r)&&i.push("selected-stroke"),i}},{key:"getSquareClasses",value:function(e,t){var n=new pte(e,t);return this.movedPieces.some(function(e){return e.equals(n)})?["moved-fill"]:[]}},{key:"getRemainingPieceClasses",value:function(e,t){var n=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&t===this.playerPieces(e)-1&&n.push("selected-stroke"),n}},{key:"getCurrentPlayerClass",value:function(){return this.getPlayerClass(this.getCurrentPlayer())}},{key:"playerPieces",value:function(e){return 5-this.getState().countPlayersPawn()[e.value]}}]),n}(Sne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-siam"]],features:[nP],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),PP(1,"defs"),OP(2,"polygon",1),OP(3,"polygon",2),OP(4,"polygon",3),SP(),CP(5,Xhe,2,1,"g",4),CP(6,ede,3,5,"g",4),CP(7,tde,1,4,"rect",5),CP(8,nde,1,4,"rect",5),CP(9,ide,2,2,"g",6),CP(10,ode,3,5,"g",4),CP(11,sde,1,3,"use",7),SP()),2&e&&(BE(5),EP("ngForOf",t.board),BE(1),EP("ngForOf",t.clickableCoords),BE(1),EP("ngIf",t.selectedLanding.isPresent()),BE(1),EP("ngIf",t.selectedPiece.isPresent()),BE(1),EP("ngForOf",t.Player.PLAYERS),BE(1),EP("ngForOf",t.indicatorArrows),BE(1),EP("ngForOf",t.orientations))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),cde=function(){var e=my(function e(){gy(this,e)});return e.NO_MOVEMENT_BEFORE_TURN_40=function(){return $localize(Al||(Al=Wg(["You cannot move yet. Pick a space where you will put a new piece."])))},e.MUST_CUT=function(){return $localize(Ml||(Ml=Wg(["Several groups are of the same size, you must pick the one to keep."])))},e.CANNOT_CHOOSE_TO_KEEP=function(){return $localize(xl||(xl=Wg(["You cannot choose which part to keep when one is smaller than the other."])))},e.CAN_NO_LONGER_DROP=function(){return $localize(Rl||(Rl=Wg(["You cannot put new pieces anymore. Pick a piece to move."])))},e.MUST_CAPTURE_BIGGEST_GROUPS=function(){return $localize(Nl||(Nl=Wg(["You must choose one of the biggest groups to keep it."])))},e.CANNOT_KEEP_EMPTY_COORD=function(){return $localize(Dl||(Dl=Wg(["You cannot pick an empty space. Pick one of the biggest groups."])))},e.MUST_DROP_NEXT_TO_OTHER_PIECE=function(){return $localize(Ll||(Ll=Wg(["You must put this piece next to another piece."])))},e}(),lde=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;gy(this,n),(a=t.call(this,r)).pieces=e;var o=a.getCalculatedScale();return a.pieces=o.pieces,a.width=o.width,a.height=o.height,a.offset=null!=i?i:o.offset,a.pieces.makeImmutable(),a}return my(n,[{key:"getCalculatedScale",value:function(){var e,t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=dy(this.pieces.listKeys());try{for(a.s();!(e=a.n()).done;){var o=e.value;t=Math.min(o.x,t),n=Math.max(o.x,n),r=Math.min(o.y,r),i=Math.max(o.y,i)}}catch(v){a.e(v)}finally{a.f()}var s=new Fte,u=new ute(-t,-r);if(0!==t||0!==r){var c,l=dy(this.pieces.listKeys());try{for(l.s();!(c=l.n()).done;){var f=c.value,h=this.pieces.delete(f),d=f.getNext(u);s.set(d,h)}}catch(v){l.e(v)}finally{l.f()}}else s=this.pieces;return{width:n+1-t,height:i+1-r,pieces:s,offset:u}}},{key:"toRepresentation",value:function(){var e,t=i9.createTable(this.width,this.height,J7.NONE.value),n=dy(this.pieces.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.getPieceAt(r).value;t[r.y][r.x]=i}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"isIllegalLandingZone",value:function(e,t){return this.pieces.containsKey(e)?UB.failure(bte.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?UB.SUCCESS:UB.failure(cde.MUST_DROP_NEXT_TO_OTHER_PIECE())}},{key:"isCoordConnected",value:function(e,t){var n,r=dy(kte.factory.all);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e.getNext(i,1);if(this.pieces.containsKey(a)&&!1===t.equalsValue(a))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"isOnBoard",value:function(e){return this.pieces.containsKey(e)}},{key:"getPieceAt",value:function(e){return this.isOnBoard(e)?this.pieces.get(e).get():J7.NONE}},{key:"applyLegalDrop",value:function(e){var t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new n(t,this.turn+1)}},{key:"applyLegalDeplacement",value:function(e,t){var r=n.deplacePiece(this,e),i=new Fte;if(t.size()>0){i=new Fte;var a,o=dy(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.set(s,r.get(s).get())}}catch(u){o.e(u)}finally{o.f()}}else i=r.getCopy();return new n(i,this.turn+1)}},{key:"countPieces",value:function(){var e=this.pieces.reverse(),t=e.get(e9.ZERO).getOrElse(new Xne),n=e.get(e9.ONE).getOrElse(new Xne);return[t.size(),n.size()]}},{key:"switchPiece",value:function(e){var t=this.pieces.getCopy(),r=this.getPieceAt(e);if(r.isPlayer())return t.replace(e,r.getOpponent()),new n(t,this.turn,this.offset);L7.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}},{key:"equals",value:function(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation([[e9.ZERO.value],[e9.ONE.value]],0)}},{key:"fromRepresentation",value:function(e,t,r){for(var i=new Fte,a=0;a<e.length;a++)for(var o=0;o<e[0].length;o++)e[a][o]!==J7.NONE.value&&i.set(new pte(o,a),e9.of(e[a][o]));return new n(i,t,r)}},{key:"deplacePiece",value:function(e,t){var n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}},{key:"getGroups",value:function(e,t){var r,i=new Fte,a=0,o=dy(kte.factory.all);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=t.getNext(s,1);i=n.putCoordInGroup(e,u,i,""+a),a++}}catch(h){o.e(h)}finally{o.f()}for(var c=i.reverse(),l=new Tte,f=0;f<c.size();f++)l.add(c.getByIndex(f).value);return l}},{key:"putCoordInGroup",value:function(e,t,r,i){if(e.get(t).isPresent()&&r.get(t).isAbsent()){r.set(t,i);var a,o=dy(kte.factory.all);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=t.getNext(s,1);r=n.putCoordInGroup(e,u,r,i)}}catch(c){o.e(c)}finally{o.f()}}return r}}]),n}(Ite),fde=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;if(gy(this,n),(a=t.call(this)).start=e,a.landing=r,a.keep=i,e.equalsValue(r))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(i))throw new Error("Cannot keep starting coord, since it will always be empty after move!");return sy(a)}return my(n,[{key:"isDrop",value:function(){return this.start.isAbsent()}},{key:"isCut",value:function(){return this.keep.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}},{key:"equals",value:function(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}],[{key:"fromDrop",value:function(e){return new n(NB.empty(),e,NB.empty())}},{key:"fromMovement",value:function(e,t){return new n(NB.of(e),t,NB.empty())}},{key:"fromCut",value:function(e,t,r){return new n(NB.of(e),t,NB.of(r))}}]),n}(xte);fde.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"encodeMove",value:function(e){return{start:e.start.isPresent()?pte.encoder.encode(e.start.get()):null,landing:pte.encoder.encode(e.landing),keep:e.keep.isPresent()?pte.encoder.encode(e.keep.get()):null}}},{key:"decodeMove",value:function(e){var t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");var n=pte.encoder.decode(t.landing);if(null==t.start)return fde.fromDrop(n);var r=pte.encoder.decode(t.start);if(null==t.keep)return fde.fromMovement(r,n);var i=pte.encoder.decode(t.keep);return fde.fromCut(r,n,i)}}]),n}(K7));var hde=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return my(n,[{key:"applyLegalMove",value:function(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}},{key:"isLegal",value:function(e,t){AB(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});var r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):n.isLegalPhaseTwoMove(e,t)}},{key:"isLegalDrop",value:function(e,t){return!1===e.isDrop()?DB.failure(cde.NO_MOVEMENT_BEFORE_TURN_40()):DB.success(t.pieces.getKeySet())}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getCurrentOpponent(),r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return Bte.getVictory(n);if(t.turn>39){var i=t.countPieces(),a=i[0],o=i[1];return a<6&&o<6?a<o?Bte.ONE_WON:o<a?Bte.ZERO_WON:Bte.DRAW:a<6?Bte.getDefeat(e9.ZERO):o<6?Bte.getDefeat(e9.ONE):Bte.ONGOING}return Bte.ONGOING}},{key:"startSearchingVictorySources",value:function(){AB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"getShapeVictory",value:function(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();var n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(AB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){AB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(kte.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return[];var o=(e+i.length)%6;i.push(a),a=a.getNext(kte.factory.all[o],1)}return i}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=kte.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return[];s=!0,i=i.getOpposite(),a=a.getNext(i,o.length)}a=a.getNext(i,1)}return o}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){AB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=kte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.length%2==0&&(i=kte.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return a}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){AB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=kte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.push(o),a.length%2==0&&(i=kte.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return a}}],[{key:"getLegalLandings",value:function(e){var t,n=new Xne,r=dy(e.pieces.listKeys());try{for(r.s();!(t=r.n()).done;){var i,a=t.value,o=dy(kte.factory.all);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=a.getNext(s,1);e.getPieceAt(u)===J7.NONE&&n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n.toList()}},{key:"isLegalPhaseTwoMove",value:function(e,t){if(e.isDrop())return DB.failure(cde.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case J7.NONE:return DB.failure(bte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return DB.failure(bte.CANNOT_CHOOSE_OPPONENT_PIECE())}var r=lde.deplacePiece(t,e),i=lde.getGroups(r,e.start.get());if(n.isSplit(i)){var a=this.getBiggerGroups(i);return 1===a.size()?e.keep.isPresent()?DB.failure(cde.CANNOT_CHOOSE_TO_KEEP()):DB.success(a.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,a,r)}return DB.success(new Xne)}},{key:"isSplit",value:function(e){return e.size()>1}},{key:"getBiggerGroups",value:function(e){var t,n=0,r=new Tte,i=dy(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.size();o>n?(n=o,r=new Tte([a])):o===n&&r.add(a)}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"moveKeepBiggerGroup",value:function(e,t,n){if(e.isAbsent())return DB.failure(cde.MUST_CUT());if(n.get(e.get()).isAbsent())return DB.failure(cde.CANNOT_KEEP_EMPTY_COORD());var r,i=e.get(),a=dy(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.contains(i))return DB.success(o)}}catch(s){a.e(s)}finally{a.f()}return DB.failure(cde.MUST_CAPTURE_BIGGEST_GROUPS())}}]),n}(zte),dde=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"calculateBoardValue",value:function(e,t){this.startSearchingVictorySources();for(var n={status:Dte.DEFAULT,victory:NB.empty(),preVictory:NB.empty(),sum:0};this.hasNextVictorySource();){var r,i=this.getNextVictorySource();if((r=n.status===Dte.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n)).status===Dte.VICTORY)return r;n={status:r.status,victory:NB.empty(),preVictory:r.preVictory,sum:n.sum+r.sum}}return n}}]),n}(Pte),vde=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e)).value=e,i.preVictory=r,i}return my(n)}(Ste),pde=function(e){iy(n,e);var t=oy(n);function n(){var e;return gy(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return my(n,[{key:"getListMoves",value:function(e){var t=n.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(e,r);var i=hde.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getListDeplacement(e.gameState,i)}},{key:"createForcedDrop",value:function(e){AB(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});var t=[],n=fde.fromDrop(e.preVictory.get());return t.push(n),t}},{key:"createForcedDeplacement",value:function(e,t){AB(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});var n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}},{key:"getDeplacementFrom",value:function(e,t,n){var r,i=[],a=dy(t);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,u=dy(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=fde.fromMovement(s,c);if(e.isCoordConnected(c,NB.of(s))){var f=lde.deplacePiece(e,l),h=lde.getGroups(f,l.start.get());if(hde.isSplit(h)){var d,v=dy(h);try{for(v.s();!(d=v.n()).done;){var p=d.value.getAnyElement().get(),g=fde.fromCut(s,c,p);i.push(g)}}catch(y){v.e(y)}finally{v.f()}}else i.push(l)}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}return i}},{key:"getSafelyMovablePieceOrFirstOne",value:function(e){var t,n=e.gameState,r=n.pieces.reverse(),i=n.getCurrentPlayer(),a=r.get(i).get(),o=a.getAnyElement().get(),s=[],u=dy(a);try{for(u.s();!(t=u.n()).done;){var c=t.value;!1===this.isPieceBlockingAVictory(n,c)&&s.push(c)}}catch(l){u.e(l)}finally{u.f()}return new Xne(0===s.length?[o]:s)}},{key:"isPieceBlockingAVictory",value:function(e,t){var n=e.switchPiece(t),r=fde.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===Dte.VICTORY)return!0;return!1}},{key:"getListDrop",value:function(e){var t,n=[],r=dy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=fde.fromDrop(i);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getListDeplacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}},{key:"getBoardValue",value:function(e){var t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue(),a={status:Dte.DEFAULT,victory:NB.empty(),preVictory:NB.empty(),sum:0};t.isPresent()&&(a=this.calculateBoardValue(t.get(),n));var o=NB.empty();if(a.status===Dte.DEFAULT&&a.preVictory.isPresent()&&(o=NB.of(a.preVictory.get())),a.status===Dte.VICTORY)return new vde(i,NB.empty());if(n.turn>39){var s=n.countPieces(),u=s[0],c=s[1];return u<6&&c<6?new vde(u<c?e9.ONE.getVictoryValue():c<u?e9.ZERO.getVictoryValue():0,NB.empty()):u<6?new vde(e9.ZERO.getDefeatValue(),NB.empty()):c<6?new vde(e9.ONE.getDefeatValue(),NB.empty()):new vde(u-c,o)}return new vde(a.status===Dte.PRE_VICTORY?r.getPreVictory():a.sum*r.getScoreModifier(),o)}},{key:"startSearchingVictorySources",value:function(){AB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(AB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){AB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(kte.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return{status:Dte.PRE_VICTORY,victory:NB.empty(),preVictory:NB.empty(),sum:0};var o=(e+i.length)%6;i.push(a),a=a.getNext(kte.factory.all[o],1)}return{status:Dte.VICTORY,victory:NB.of(i),preVictory:NB.empty(),sum:0}}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=kte.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return{status:Dte.PRE_VICTORY,victory:NB.empty(),preVictory:NB.empty(),sum:0};s=!0,i=i.getOpposite(),a=a.getNext(i,o.length-1)}a=a.getNext(i,1)}return{status:Dte.VICTORY,victory:NB.of(o),preVictory:NB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){AB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=kte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:Dte.PRE_VICTORY,victory:NB.empty(),preVictory:NB.empty(),sum:0};a.length%2==0&&(i=kte.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return{status:Dte.VICTORY,victory:NB.of(a),preVictory:NB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){AB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=kte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:Dte.PRE_VICTORY,victory:NB.empty(),preVictory:NB.empty(),sum:0};a.push(o),a.length%2==0&&(i=kte.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return{status:Dte.VICTORY,victory:NB.of(a),preVictory:NB.empty(),sum:0}}},{key:"getBoardInfo",value:function(e,t,n,r){AB(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});var i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}},{key:"getBoardInfoForCircle",value:function(e,t,n,r){AB(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=[t],o=t.getNext(kte.factory.all[e],1),s=0,u=NB.empty();a.length<6;){var c=n.getPieceAt(o);if(c===i)return r;var l=(e+a.length)%6;a.push(o);var f=kte.factory.all[l];c===J7.NONE?(s+=.16,u=NB.of(o)):s++,o=o.getNext(f,1)}return this.getBoardInfoResult(s,u,a,r)}},{key:"getBoardInfoResult",value:function(e,t,n,r){var i=r.preVictory;if(4.16===e){if(AB(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:Dte.PRE_VICTORY,victory:NB.empty(),preVictory:NB.empty(),sum:0};i=t}else if(5===e)return{status:Dte.VICTORY,victory:NB.of(n),preVictory:NB.empty(),sum:0};return{status:r.status,victory:NB.empty(),preVictory:i,sum:r.sum+e}}},{key:"getBoardInfoForLine",value:function(e,t,n,r){AB(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=kte.factory.all[e],a=t.getPrevious(i,5),o=[],s=[],u=NB.empty(),c=0;c<6;c++){var l=this.updateEncounterAndReturnLastEmpty(n,a,s);l.isPresent()&&(u=l),o.push(a),a=a.getNext(i,1)}for(var f=r.status,h=r.preVictory,d=0,v=0;d<6;){var p=s.reduce(function(e,t){return e+t});if(6===p)return{status:Dte.VICTORY,victory:NB.of(o),preVictory:NB.empty(),sum:0};5.16===p&&f===Dte.DEFAULT&&(h.isPresent()?(F7(!1===h.equals(u),"Impossible to have point aligned with differents line to a same point"),f=Dte.PRE_VICTORY):h=u),v=Math.max(v,p),(o=o.slice(1,6)).push(a),s=s.slice(1,6);var g=this.updateEncounterAndReturnLastEmpty(n,a,s);g.isPresent()&&(u=g),d++,a=a.getNext(i,1)}var y={status:f,victory:NB.of(o),preVictory:h,sum:v};return this.getBoardInfoResult(v,u,o,y)}},{key:"updateEncounterAndReturnLastEmpty",value:function(e,t,n){var r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),NB.empty();case J7.NONE:return n.push(.16),NB.of(t);default:return n.push(1),NB.empty()}}},{key:"getBoardInfoForTriangleCorner",value:function(e,t,n,r){AB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=kte.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=NB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===J7.NONE?(u+=.16,c=NB.of(s)):u++,o.length%2==0&&(a=kte.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}},{key:"getBoardInfoForTriangleEdge",value:function(e,t,n,r){AB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=kte.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=NB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===J7.NONE?(u+=.16,c=NB.of(s)):u++,o.push(s),o.length%2==0&&(a=kte.factory.all[(e+o.length)%6]),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}}],[{key:"get",value:function(){if(n.singleton.isAbsent()){var e=new hde(lde);n.singleton=NB.of(new n(e,"SixMinimax"))}return n.singleton.get()}}]),n}(dde);pde.singleton=NB.empty();var gde=J7.NONE.value,yde=e9.ZERO.value,mde=e9.ONE.value,kde=function(){var e=my(function e(){gy(this,e)});return e.MOVEMENT_NOT_DISCONNECTING=function(){return $localize(Fl||(Fl=Wg(["This move does not disconnect your opponent's pieces. Try again with another piece."])))},e.MOVEMENT_SELF_DISCONNECTING=function(){return $localize(Ul||(Ul=Wg(["You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!"])))},e}(),Cde=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(Vl||(Vl=Wg(["Six"]))),$localize(Bl||(Bl=Wg(["Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.\n        Each player has 21 pieces, with one for each player already on the board.\n        The goal of the game is to form one of the three winning shapes with your pieces."]))),lde.getInitialState()),Zte.fromMove($localize(zl||(zl=Wg(["Victory (line)"]))),$localize(Hl||(Hl=Wg(["On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>\n        Find the victory. You're playing Dark."]))),lde.fromRepresentation([[yde,mde,mde,mde,mde,yde],[gde,yde,mde,gde,yde,gde],[mde,mde,yde,gde,gde,gde],[gde,gde,yde,gde,gde,gde],[gde,yde,gde,gde,gde,gde],[yde,gde,gde,gde,gde,gde]],0),[fde.fromDrop(new pte(3,2))],$localize(Gl||(Gl=Wg(["Congratulations!"]))),$localize($l||($l=Wg(["Failed!"])))),Zte.fromMove($localize(Zl||(Zl=Wg(["Victory (circle)"]))),$localize(ql||(ql=Wg(["On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),lde.fromRepresentation([[gde,gde,gde,mde,gde,gde],[gde,gde,mde,mde,yde,yde],[gde,mde,gde,yde,mde,gde],[mde,yde,yde,yde,yde,mde]],0),[fde.fromDrop(new pte(5,2))],$localize(Wl||(Wl=Wg(["Congratulations! Note that if a piece is inside the circle, it does not change anything."]))),$localize(jl||(jl=Wg(["Failed!"])))),Zte.fromMove($localize(Yl||(Yl=Wg(["Victory (triangle)"]))),$localize(Kl||(Kl=Wg(["On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),lde.fromRepresentation([[gde,gde,gde,mde,gde,gde],[gde,yde,mde,yde,yde,yde],[gde,yde,gde,yde,yde,gde],[mde,mde,mde,gde,mde,gde]],0),[fde.fromDrop(new pte(3,3))],$localize(Ql||(Ql=Wg(["Congratulations!"]))),$localize(Xl||(Xl=Wg(["Failed!"])))),Zte.fromPredicate($localize(Jl||(Jl=Wg(["Second phase"]))),$localize(ef||(ef=Wg(["After 40 turns, your pieces have all been placed and we move on to the second phase of the game.\n        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.\n        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>\n        You're playing Dark. Make a move that disconnects one of your opponent's pieces."]))),lde.fromRepresentation([[gde,gde,gde,gde,gde,gde,gde,mde,gde],[gde,gde,gde,gde,gde,gde,yde,gde,gde],[gde,gde,gde,gde,yde,yde,yde,gde,gde],[gde,gde,gde,gde,mde,mde,gde,mde,yde],[gde,yde,mde,mde,yde,yde,mde,gde,gde],[yde,yde,yde,yde,mde,mde,mde,yde,gde],[mde,mde,yde,gde,mde,mde,yde,gde,gde],[gde,yde,gde,yde,yde,gde,gde,gde,gde],[mde,mde,mde,mde,gde,gde,gde,gde,gde],[gde,yde,gde,mde,gde,gde,gde,gde,gde]],40),fde.fromMovement(new pte(6,1),new pte(5,1)),function(e,t,n){var r=n.countPieces();return 19===r[0]?18===r[1]?UB.SUCCESS:UB.failure(kde.MOVEMENT_NOT_DISCONNECTING()):UB.failure(kde.MOVEMENT_SELF_DISCONNECTING())},$localize(tf||(tf=Wg(["Congratulations, your opponent now has one piece less and you're closer to victory!"])))),Zte.fromPredicate($localize(nf||(nf=Wg(["Victory by disconnection"]))),$localize(rf||(rf=Wg(["During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.\n        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.\n        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>\n        Here, you're playing Dark and you can win. Do it!"]))),lde.fromRepresentation([[gde,gde,gde,gde,gde,mde],[gde,gde,gde,gde,yde,mde],[gde,gde,gde,mde,yde,yde],[gde,gde,yde,gde,mde,yde],[mde,mde,gde,gde,gde,yde],[yde,mde,gde,gde,gde,gde],[yde,gde,gde,gde,gde,gde]],40),fde.fromMovement(new pte(2,3),new pte(3,3)),function(e,t,n){return e.start.equalsValue(new pte(2,3))?UB.SUCCESS:UB.failure(kde.MOVEMENT_NOT_DISCONNECTING())},$localize(af||(af=Wg(["Congratulations, you won!"])))),Zte.fromPredicate($localize(of||(of=Wg(["Special disconnection"]))),$localize(sf||(sf=Wg(["During a disconnection, two or more groups could have the same size,\n        in which case you will have to click on the group you wish to keep.<br/><br/>\n        You're playing Dark, play such a move!"]))),lde.fromRepresentation([[gde,gde,gde,gde,gde,mde],[gde,gde,gde,gde,yde,mde],[gde,gde,gde,mde,yde,yde],[yde,gde,yde,gde,gde,mde],[mde,mde,gde,gde,gde,gde],[yde,yde,gde,gde,gde,gde],[yde,gde,gde,gde,gde,gde]],40),fde.fromCut(new pte(2,3),new pte(2,5),new pte(2,5)),function(e,t,n){return e.keep.isAbsent()?UB.failure($localize(uf||(uf=Wg(["This move has not cut the board in two equal halves."])))):n.getPieceAt(e.landing.getNext(n.offset))===J7.NONE?UB.failure($localize(cf||(cf=Wg(["Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again."])))):UB.SUCCESS},$localize(lf||(lf=Wg(["Congratulations, you won!"]))))]});function wde(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",10),RP("click",function(){var e=aC(n).$implicit;return LP().onPieceClick(e)}),SP()}if(2&e){var r=t.$implicit,i=LP();VP("id","piece_",r.x,"_",r.y,""),EP("ngClass",i.getPieceClass(r)),pP("points",i.getHexaCoordsAt(r))}}function _de(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",11),RP("click",function(){var e=aC(n).$implicit;return LP().onNeighborClick(e)}),SP()}if(2&e){var r=t.$implicit,i=LP();VP("id","neighbor_",r.x,"_",r.y,""),pP("points",i.getHexaCoordsAt(r))}}function Ede(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",10),RP("click",function(){aC(n);var e=LP();return e.onPieceClick(e.chosenLanding.get())}),SP()}if(2&e){var r=LP();VP("id","chosenLanding_",r.chosenLanding.get().x,"_",r.chosenLanding.get().y,""),EP("ngClass",r.getPlayerClass(r.state.getCurrentPlayer())),pP("points",r.getHexaCoordsAt(r.chosenLanding.get()))}}function bde(e,t){if(1&e&&(NC(),OP(0,"polygon",12)),2&e){var n=t.$implicit,r=LP();VP("id","disconnected_",n.x,"_",n.y,""),pP("points",r.getHexaCoordsAt(n))}}function Pde(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",13),RP("click",function(){aC(n);var e=LP();return e.onNeighborClick(e.leftCoord.get())}),SP()}if(2&e){var r=LP();VP("id","leftCoord_",r.leftCoord.get().x,"_",r.leftCoord.get().y,""),pP("points",r.getHexaCoordsAt(r.leftCoord.get()))}}function Sde(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",14),RP("click",function(){aC(n);var e=LP();return e.onPieceClick(e.lastDrop.get())}),SP()}if(2&e){var r=LP();VP("id","lastDrop_",r.lastDrop.get().x,"_",r.lastDrop.get().y,""),pP("points",r.getHexaCoordsAt(r.lastDrop.get()))}}function Ode(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",15),RP("click",function(){aC(n);var e=LP();return e.onPieceClick(e.selectedPiece.get())}),SP()}if(2&e){var r=LP();VP("id","selectedPiece_",r.selectedPiece.get().x,"_",r.selectedPiece.get().y,""),EP("ngClass",r.getSelectedPieceClass()),pP("points",r.getHexaCoordsAt(r.selectedPiece.get()))}}function Tde(e,t){if(1&e&&(NC(),OP(0,"polygon",16)),2&e){var n=t.$implicit,r=LP();VP("id","victoryCoord_",n.x,"_",n.y,""),pP("points",r.getHexaCoordsAt(n))}}function Ide(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",19),RP("click",function(){var e=aC(n).$implicit;return LP(2).onPieceClick(e)}),SP()}if(2&e){var r=t.$implicit,i=LP(2);VP("id","cuttable_",r.x,"_",r.y,""),pP("points",i.getHexaCoordsAt(r))}}function Ade(e,t){if(1&e&&(NC(),PP(0,"g",17),CP(1,Ide,1,3,"polygon",18),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}var Mde=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).disconnecteds=[],r.cuttableGroups=[],r.leftCoord=NB.empty(),r.lastDrop=NB.empty(),r.selectedPiece=NB.empty(),r.chosenLanding=NB.empty(),r.nextClickShouldSelectGroup=!1,r.rules=new hde(lde),r.availableMinimaxes=[new pde(r.rules,"SixMinimax")],r.encoder=fde.encoder,r.tutorial=(new Cde).tutorial,r.SPACE_SIZE=30,r.hexaLayout=new Cte(1.5*r.SPACE_SIZE,new pte(2*r.SPACE_SIZE,0),Ete.INSTANCE),r.updateBoard(),r}return my(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=NB.empty(),this.chosenLanding=NB.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=NB.empty(),this.lastDrop=NB.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}},{key:"getViewBox",value:function(){var e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}},{key:"mapAbstractCoordToCornerCoords",value:function(){var e,t=this,n=[],r=dy(this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(function(e){return t.hexaLayout.getHexaCoordsAt(e)}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getLimits",value:function(e){var t,n=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=dy(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.x<i&&(i=s.x),s.y<a&&(a=s.y),n=Math.max(n,s.x),r=Math.max(r,s.y)}}catch(u){o.e(u)}finally{o.f()}return{minX:i,minY:a,maxX:n,maxY:r}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();this.lastDrop=NB.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?NB.of(e.start.get().getNext(this.state.offset,1)):NB.empty();var t=this.getState();this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}},{key:"getDisconnected",value:function(){var e,t=this,n=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.getState().pieces.listKeys(),i=[],a=dy(n);try{var o=function(){var n=e.value;!1===t.rules.node.move.get().start.equalsValue(n)&&!1===r.some(function(e){return e.equals(n.getNext(t.state.offset,1))})&&i.push(n.getNext(t.state.offset,1))};for(a.s();!(e=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}var s=this.lastDrop.get();return!1===this.pieces.some(function(e){return e.equals(s)})&&!1===r.some(function(e){return e.equals(s)})&&i.push(s),i}},{key:"getEmptyNeighbors",value:function(){var e=hde.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){var t=this.chosenLanding.get();e=e.filter(function(e){return!1===e.equals(t)})}return e}},{key:"getPieceClass",value:function(e){var t=this.getState().getPieceAt(e);return this.getPlayerClass(t)}},{key:"onPieceClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#piece_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.state.turn<40)){n.next=5;break}return n.abrupt("return",t.cancelMove(cde.NO_MOVEMENT_BEFORE_TURN_40()));case 5:if(!t.chosenLanding.isAbsent()){n.next=7;break}return n.abrupt("return",t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(bte.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=t.selectedPiece.equalsValue(e)?NB.empty():NB.of(e),UB.SUCCESS));case 7:return i=fde.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e),n.abrupt("return",t.chooseMove(i,t.state));case 9:case"end":return n.stop()}},n)}))()}},{key:"onNeighborClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#neighbor_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.nextClickShouldSelectGroup){n.next=5;break}return n.abrupt("return",t.cancelMove(cde.MUST_CUT()));case 5:if(!(t.state.turn<40)){n.next=7;break}return n.abrupt("return",t.chooseMove(fde.fromDrop(e),t.state));case 7:if(!t.selectedPiece.isAbsent()){n.next=9;break}return n.abrupt("return",t.cancelMove(cde.CAN_NO_LONGER_DROP()));case 9:return i=fde.fromMovement(t.selectedPiece.get(),e),a=hde.isLegalPhaseTwoMove(i,t.state),n.abrupt("return",t.neededCutting(a)?(t.chosenLanding=NB.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,UB.SUCCESS):t.chooseMove(i,t.state));case 11:case"end":return n.stop()}},n)}))()}},{key:"neededCutting",value:function(e){return e.isFailure()&&e.getReason()===cde.MUST_CUT()}},{key:"moveVirtuallyPiece",value:function(){var e=this.selectedPiece.get();this.pieces=this.pieces.filter(function(t){return!1===t.equals(e)}),this.neighbors=this.getEmptyNeighbors()}},{key:"showCuttable",value:function(){var e=fde.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=lde.deplacePiece(this.state,e),n=lde.getGroups(t,e.start.get()),r=hde.getBiggerGroups(n);this.cuttableGroups=[];var i,a=dy(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.cuttableGroups.push(o.toList())}}catch(s){a.e(s)}finally{a.f()}}},{key:"getSelectedPieceClass",value:function(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}]),n}(yte);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-six"]],features:[nP],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-fill mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-fill","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,wde,1,4,"polygon",1),CP(2,_de,1,3,"polygon",2),CP(3,Ede,1,4,"polygon",3),CP(4,bde,1,3,"polygon",4),CP(5,Pde,1,3,"polygon",5),CP(6,Sde,1,3,"polygon",6),CP(7,Ode,1,4,"polygon",7),CP(8,Tde,1,3,"polygon",8),CP(9,Ade,2,1,"g",9),SP()),2&e&&(pP("viewBox",t.viewBox),BE(1),EP("ngForOf",t.pieces),BE(1),EP("ngForOf",t.neighbors),BE(1),EP("ngIf",t.chosenLanding.isPresent()),BE(1),EP("ngForOf",t.disconnecteds),BE(1),EP("ngIf",t.leftCoord.isPresent()),BE(1),EP("ngIf",t.lastDrop.isPresent()),BE(1),EP("ngIf",t.selectedPiece.isPresent()),BE(1),EP("ngForOf",t.victoryCoords),BE(1),EP("ngForOf",t.cuttableGroups))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),xde=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getMaximalDistance",value:function(){return 9}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return DB.success(r)}catch(r){return DB.failure(r.message)}}}]),n}(Vne);xde.encoder=Fne.getEncoder(9,9,xde.of);var Rde={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:e9.ZERO},Nde=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Hne.UNOCCUPIED,t=Hne.INVADERS,r=Hne.DEFENDERS;return new n([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,Hne.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}]),n}($ne),Dde=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.call(this,Nde,Rde,xde.of)}return my(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Vte.ruler=this.singleton,n.singleton}}]),n}(qne),Lde=Hne.UNOCCUPIED,Fde=Hne.INVADERS,Ude=Hne.DEFENDERS,Vde=Hne.PLAYER_ONE_KING,Bde=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(ff||(ff=Wg(["Goal of the game"]))),$localize(hf||(hf=Wg(["Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Nde.getInitialState()),Zte.anyMove($localize(df||(df=Wg(["Moving"]))),$localize(vf||(vf=Wg(["All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Nde.getInitialState(),xde.of(new pte(4,1),new pte(1,1)),$localize(pf||(pf=Wg(["Congratulations!"])))),Zte.fromMove($localize(gf||(gf=Wg(["Capturing a soldier (1/2)"]))),$localize(yf||(yf=Wg(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Nde([[Lde,Lde,Lde,Fde,Fde,Fde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Fde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Ude,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Fde,Ude,Lde,Lde,Lde,Fde],[Fde,Fde,Ude,Ude,Vde,Ude,Ude,Fde,Fde],[Lde,Lde,Lde,Lde,Ude,Lde,Lde,Lde,Fde],[Lde,Lde,Lde,Lde,Ude,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Fde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Fde,Fde,Fde,Lde,Lde,Lde]],1),[xde.of(new pte(2,4),new pte(2,3)),xde.of(new pte(4,2),new pte(3,2))],$localize(mf||(mf=Wg(["Congratulations, that will teach him a lesson!"]))),$localize(kf||(kf=Wg(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Zte.fromMove($localize(Cf||(Cf=Wg(["Capturing a soldier (2/2)"]))),$localize(wf||(wf=Wg(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Nde([[Lde,Lde,Lde,Fde,Fde,Fde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Fde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Ude,Lde,Lde,Lde,Lde],[Lde,Lde,Ude,Lde,Vde,Lde,Ude,Lde,Fde],[Fde,Fde,Lde,Ude,Lde,Ude,Ude,Fde,Fde],[Lde,Lde,Lde,Lde,Ude,Lde,Lde,Lde,Fde],[Lde,Lde,Lde,Lde,Ude,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Fde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Fde,Fde,Fde,Lde,Lde,Lde]],12),[xde.of(new pte(1,4),new pte(2,4))],$localize(_f||(_f=Wg(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(Ef||(Ef=Wg(["Failed, you did not do the expected move."])))),Zte.fromMove($localize(bf||(bf=Wg(["Capturing the king (1/2)"]))),$localize(Pf||(Pf=Wg(["To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king."]))),new Nde([[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Fde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Fde,Vde,Lde,Fde,Lde,Lde,Lde,Lde,Lde],[Lde,Fde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde]],72),[xde.of(new pte(3,4),new pte(2,4))],$localize(Sf||(Sf=Wg(["Congratulations, you won!"]))),$localize(Of||(Of=Wg(["Failed, you let the king run away."])))),Zte.fromMove($localize(Tf||(Tf=Wg(["Capturing the king (2/2)"]))),$localize(If||(If=Wg(["Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king."]))),new Nde([[Lde,Lde,Fde,Vde,Fde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Fde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde]],72),[xde.of(new pte(3,3),new pte(3,1))],$localize(Af||(Af=Wg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Mf||(Mf=Wg(["Failed!"]))))]});function zde(e,t){1&e&&(NC(),OP(0,"polygon",8))}function Hde(e,t){1&e&&(NC(),OP(0,"rect",9))}function Gde(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,zde,1,0,"polygon",6),CP(2,Hde,1,0,"ng-template",null,7,tI),SP()),2&e){var n=wP(3),r=LP().index,i=LP().index,a=LP();BE(1),EP("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function $de(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"line",13),OP(2,"line",13),OP(3,"line",13),OP(4,"line",13),OP(5,"line",13),SP()),2&e){var n=LP(2).index,r=LP().index,i=LP();BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Zde(e,t){if(1&e&&(NC(),OP(0,"polyline",16)),2&e){var n=LP(3).index,r=LP().index;EP("ngClass",LP().viewInfo.pieceClasses[r][n])}}function qde(e,t){if(1&e&&(NC(),OP(0,"line",13),OP(1,"line",13),OP(2,"line",13),OP(3,"line",13)),2&e){var n=LP(3).index,r=LP().index,i=LP();EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),BE(1),EP("ngClass",i.viewInfo.pieceClasses[r][n]),pP("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function Wde(e,t){if(1&e&&(NC(),CP(0,Zde,1,1,"polyline",14),CP(1,qde,4,20,"ng-template",null,15,tI)),2&e){var n=wP(2),r=LP(2).index,i=LP().index;EP("ngIf",LP().isKing(r,i))("ngIfElse",n)}}function jde(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"circle",10),CP(2,$de,6,25,"g",11),CP(3,Wde,3,2,"ng-template",null,12,tI),SP()),2&e){var n=wP(4),r=LP().index,i=LP().index,a=LP();BE(1),VP("id","piece_",r,"_",i,""),EP("ngClass",a.viewInfo.pieceClasses[i][r]),pP("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),BE(1),EP("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function Yde(e,t){if(1&e){var n=AP();NC(),PP(0,"g",3),RP("click",function(){var e=aC(n).index,t=LP().index;return LP().onClick(e,t)}),OP(1,"rect",4),CP(2,Gde,4,2,"g",5),CP(3,jde,5,8,"g",5),SP()}if(2&e){var r=t.index,i=LP().index,a=LP();VP("id","click_",r,"_",i,""),pP("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),BE(1),EP("ngClass",a.getRectClasses(r,i)),pP("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),BE(1),EP("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),BE(1),EP("ngIf",a.board[i][r]!==a.EMPTY)}}function Kde(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Yde,4,8,"g",2),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function Qde(e,t){if(1&e){var n=AP();NC(),PP(0,"g"),PP(1,"rect",17),RP("click",function(){var e=aC(n).$implicit;return LP().onClick(e.x,e.y)}),SP(),SP()}if(2&e){var r=t.$implicit,i=LP();BE(1),VP("id","click_",r.x,"_",r.y,""),pP("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Xde=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e,!1,xde.from)).rules=Dde.get(),r.availableMinimaxes=[new Yne(r.rules,"DummyBot"),new Jne(r.rules,"Piece > Influence"),new ere(r.rules,"Piece > Control"),new tre(r.rules,"Escape > Piece > Control")],r.encoder=xde.encoder,r.tutorial=(new Bde).tutorial,r.updateBoard(),r}return my(n)}(jne);return e.\u0275fac=function(t){return new(t||e)(_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["app-tablut"]],features:[nP],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,Kde,2,1,"g",1),CP(2,Qde,2,6,"g",1),SP()),2&e&&(pP("viewBox",t.getViewBox()),BE(1),EP("ngForOf",t.board),BE(1),EP("ngForOf",t.getClickables()))},directives:[aM,rM,sM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Jde=my(function e(){gy(this,e)});Jde.PLACEMENT_AFTER_INITIAL_PHASE=function(){return $localize(xf||(xf=Wg(["You cannot put a new ring after the tenth turn."])))},Jde.NO_MARKERS_IN_INITIAL_PHASE=function(){return $localize(Rf||(Rf=Wg(["You cannot put a marker in a ring before placing all of your rings."])))},Jde.MISSING_CAPTURES=ioe.MISSING_CAPTURES,Jde.MOVE_DIRECTION_INVALID=function(){return $localize(Nf||(Nf=Wg(["The direction of your move is invalid: a move is made along a straight line."])))},Jde.CAN_ONLY_CAPTURE_YOUR_MARKERS=function(){return $localize(Df||(Df=Wg(["You can only capture your own markers."])))},Jde.SHOULD_SELECT_PLAYER_RING=function(){return $localize(Lf||(Lf=Wg(["You must pick one of your own rings to move."])))},Jde.SHOULD_END_MOVE_ON_EMPTY_SPACE=function(){return $localize(Ff||(Ff=Wg(["Your ring must land on an empty space."])))},Jde.MOVE_SHOULD_NOT_PASS_ABOVE_RING=function(){return $localize(Uf||(Uf=Wg(["A ring can only jump over markers or empty spaces, not over another ring."])))},Jde.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=function(){return $localize(Vf||(Vf=Wg(["Your ring must land on the first empty space after a group of markers."])))},Jde.AMBIGUOUS_CAPTURE_COORD=ioe.AMBIGUOUS_CAPTURE_COORD,Jde.CAPTURE_SHOULD_TAKE_RING=function(){return $localize(Bf||(Bf=Wg(["When you capture markers, you must take one of your ring as well by clicking on it."])))};var eve=function(){function e(t,n){gy(this,e),this.player=t,this.isRing=n}return my(e,[{key:"equals",value:function(e){return this===e}},{key:"flip",value:function(){return F7(!1===this.isRing,"cannot flip a ring (it should never happen)"),F7(this.player.isPlayer(),"cannot flip a non-player piece"),e.of(this.player.getOpponent(),this.isRing)}},{key:"toString",value:function(){switch(this){case e.UNREACHABLE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return IB.expectToBe(this,e.RING_ONE),"RING_ONE"}}}],[{key:"of",value:function(t,n){return t===J7.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}}]),e}();eve.encoder=Q7.tuple([e9.numberEncoder,Q7.booleanEncoder],function(e){return[e.player,e.isRing]},function(e){return eve.of(e[0],e[1])}),eve.UNREACHABLE=new eve(J7.NONE,!1),eve.EMPTY=new eve(J7.NONE,!1),eve.MARKER_ZERO=new eve(e9.ZERO,!1),eve.MARKER_ONE=new eve(e9.ONE,!1),eve.MARKERS=[eve.MARKER_ZERO,eve.MARKER_ONE],eve.RING_ZERO=new eve(e9.ZERO,!0),eve.RING_ONE=new eve(e9.ONE,!0),eve.RINGS=[eve.RING_ZERO,eve.RING_ONE];var tve=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i){var a;return gy(this,n),(a=t.call(this,i,e,n.SIZE,n.SIZE,[6,4,3,2,1],eve.EMPTY)).sideRings=r,a}return my(n,[{key:"isInitialPlacementPhase",value:function(){return this.turn<10}},{key:"countScores",value:function(){return this.turn<10?[0,0]:this.sideRings}},{key:"equals",value:function(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&i9.compareTable(this.board,e.board)}},{key:"getRingCoords",value:function(e){var t=[];return this.forEachCoord(function(n,r){r.isRing&&r.player===e&&t.push(n)}),t}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==eve.UNREACHABLE}},{key:"setAtUnsafe",value:function(e,t){var r=i9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.sideRings,this.turn)}}],[{key:"getInitialState",value:function(){var e=eve.EMPTY,t=eve.UNREACHABLE;return new n([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}}]),n}(Uie);return e.SIZE=11,e}(),nve=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;if(gy(this,n),i=t.call(this,e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");return i.ringTaken=NB.ofNullable(r),sy(i)}return my(n,[{key:"setRingTaken",value:function(e){return new n(this.capturedSpaces,e)}},{key:"equals",value:function(e){return!(!1===ny(ly(n.prototype),"equals",this).call(this,e)||!1===this.ringTaken.equals(e.ringTaken))}}],[{key:"of",value:function(e,t,r){for(var i=[],a=kte.factory.fromMove(e,t).get(),o=e;!1===o.equals(t);o=o.getNext(a))i.push(o);return i.push(t),new n(i,r)}}]),n}(eoe);nve.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"encode",value:function(e){return{captured:e.capturedSpaces.map(function(e){return pte.encoder.encode(e)}),ringTaken:pte.encoder.encode(e.ringTaken.get())}}},{key:"decode",value:function(e){var t=e;return F7(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new nve(t.captured.map(function(e){return pte.encoder.decode(e)}),pte.encoder.decode(t.ringTaken))}}]),n}(Y7));var rve=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a){var o;return gy(this,n),(o=t.call(this)).initialCaptures=e,o.start=r,o.end=i,o.finalCaptures=a,o}return my(n,[{key:"isInitialPlacement",value:function(){return this.end.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===i9.compareArray(this.initialCaptures,e.initialCaptures)||!1===i9.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"toString",value:function(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=dy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}}]),n}(xte);rve.coordOptionalEncoder=Jae(pte.encoder),rve.encoder=new(function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"encodeMove",value:function(e){var t={moveStart:pte.encoder.encode(e.start),moveEnd:rve.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=nve.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=nve.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return F7(null!=t.moveStart,"Invalid encoded YinshMove"),new rve(this.decodeArray(t,"initialCapture",nve.encoder.decode),pte.encoder.decode(t.moveStart),rve.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",nve.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(K7));var ive=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return t.isEndGame?Ste.fromWinner(t.winner):new Ste(e.gameState.sideRings[0]*e9.ZERO.getScoreModifier()+e.gameState.sideRings[1]*e9.ONE.getScoreModifier())}},{key:"getListMoves",value:function(e){var t=this,n=[],r=e.gameState;if(r.isInitialPlacementPhase()){var i,a=dy(r.getCoordsAndContents());try{for(a.s();!(i=a.n()).done;){var o=Qg(i.value,2),s=o[0];o[1]===eve.EMPTY&&n.push(new rve([],s,NB.empty(),[]))}}catch(c){a.e(c)}finally{a.f()}}else{var u=this.ruler;this.getPossibleCaptureCombinations(r).forEach(function(e){var i=u.applyCaptures(e,r);t.getRingMoves(i).forEach(function(r){var a=u.applyRingMoveAndFlip(r.start,r.end,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new rve(e,r.start,NB.of(r.end),t);n.push(i)})})})}return n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return ooe.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(function(e){return function(){function e(){gy(this,e)}return my(e,null,[{key:"getCombinations",value:function(e,t){var n=this;return F7(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(function(e){return n.getPermutations(e)}).reduce(function(e,t){return e.concat(t)})}},{key:"getPermutations",value:function(e){for(var t=e.length,n=[e.slice()],r=new Array(t).fill(0),i=1;i<t;)if(r[i]<i){var a=i%2&&r[i],o=e[i];e[i]=e[a],e[a]=o,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}},{key:"getSubsetsOfSize",value:function(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];for(var i=[];r<=e.length-n;){var a,o=e[r],s=dy(t(n-1,r+1));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.push(o),i.push(u)}}catch(c){s.e(c)}finally{s.f()}++r}return i}(t,0)}}]),e}().getCombinations(n,e.length).map(function(t){return e.map(function(e,n){return new nve(e.capturedSpaces,t[n])})})}).reduce(function(e,t){return e.concat(t)},[])}},{key:"getRingMoves",value:function(e){var t,n=this.ruler,r=[],i=dy(this.getRingCoords(e));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=dy(n.getRingTargets(e,o));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.push({start:o,end:u})}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getRingCoords",value:function(e){var t=e.getCurrentPlayer().value,n=[];return e.forEachCoord(function(e,r){r===eve.RINGS[t]&&n.push(e)}),n}}]),n}(Pte),ave=function(e){iy(n,e);var t=oy(n);function n(){return gy(this,n),t.apply(this,arguments)}return my(n,[{key:"applyLegalMove",value:function(e,t,n){return new tve(n.board,n.sideRings,n.turn+1)}},{key:"applyCaptures",value:function(e,t){var n=this,r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new tve(n,t.sideRings,t.turn),e.ringTaken.get())}},{key:"takeRing",value:function(e,t){var n=e.getCurrentPlayer().value,r=e.setAt(t,eve.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new tve(r,i,e.turn)}},{key:"applyCaptureWithoutTakingRing",value:function(e,t){return t.forEach(function(t){e=e.setAt(t,eve.EMPTY)}),e.board}},{key:"ringSelectionValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)===eve.RINGS[n]?UB.SUCCESS:UB.failure(Jde.CAPTURE_SHOULD_TAKE_RING())}},{key:"applyRingMoveAndFlip",value:function(e,t,n){var r=n.getCurrentPlayer().value,i=n.setAt(e,eve.MARKERS[r]);i=i.setAt(t,eve.RINGS[r]);for(var a=kte.factory.fromMove(e,t).get(),o=e.getNext(a);!1===o.equals(t);o=o.getNext(a)){var s=i.getPieceAt(o);s!==eve.EMPTY&&(i=i.setAt(o,s.flip()))}return i}},{key:"isLegal",value:function(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return DB.failure(Jde.NO_MARKERS_IN_INITIAL_PHASE());var n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();var r=this.applyCaptures(e.initialCaptures,t),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();var a=this.applyRingMoveAndFlip(e.start,e.end.get(),r),o=this.capturesValidity(a,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();var s=this.applyCaptures(e.finalCaptures,a),u=this.noMoreCapturesValidity(s);return u.isFailure()?u.toFailedFallible():DB.success(s)}},{key:"initialPlacementValidity",value:function(e,t){if(!0!==e.isInitialPlacementPhase())return DB.failure(Jde.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==eve.EMPTY)return DB.failure(bte.MUST_CLICK_ON_EMPTY_SPACE());var n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;var i=e.setAt(t,eve.of(n,!0)).board,a=new tve(i,r,e.turn);return DB.success(a)}},{key:"moveStartValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==eve.RINGS[n]?UB.failure(Jde.SHOULD_SELECT_PLAYER_RING()):UB.SUCCESS}},{key:"moveValidity",value:function(e,t,n){var r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==eve.EMPTY)return UB.failure(Jde.SHOULD_END_MOVE_ON_EMPTY_SPACE());var i=kte.factory.fromMove(t,n);if(i.isFailure())return UB.failure(Jde.MOVE_DIRECTION_INVALID());for(var a=i.get(),o=!1,s=t.getNext(a);!1===s.equals(n);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===eve.EMPTY){if(o)return UB.failure(Jde.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(u.isRing)return UB.failure(Jde.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return UB.SUCCESS}},{key:"capturesValidity",value:function(e,t){var n,r=e,i=dy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.captureValidity(r,a);if(o.isFailure())return o;r=this.applyCapture(a,r)}}catch(s){i.e(s)}finally{i.f()}return UB.SUCCESS}},{key:"captureValidity",value:function(e,t){var n,r=e.getCurrentPlayer().value,i=dy(t.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(e.getPieceAt(a)!==eve.MARKERS[r])return UB.failure(Jde.CAN_ONLY_CAPTURE_YOUR_MARKERS())}}catch(o){i.e(o)}finally{i.f()}return e.getPieceAt(t.ringTaken.get())!==eve.RINGS[r]?UB.failure(Jde.CAPTURE_SHOULD_TAKE_RING()):UB.SUCCESS}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?UB.SUCCESS:UB.failure(Jde.MISSING_CAPTURES())}},{key:"getLinePortionsWithAtLeastFivePiecesOfPlayer",value:function(e,t){var n=this,r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithAtLeastFivePiecesOfPlayer",value:function(e,t,n){var r,i=0,a=e.getEntranceOnLine(n),o=n.getDirection(),s=a;for(r=a;e.isOnBoard(r);r=r.getNext(o)){var u=e.getPieceAt(r);if(u.player===t&&!1===u.isRing)0===i&&(s=r),i+=1;else{if(i>=5)break;i=0}}return i>=5?NB.of({start:s,end:r,dir:o}):NB.empty()}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(function(e){for(var t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(nve.of(t,t.getNext(e.dir,4)))}),n}},{key:"getRingTargets",value:function(e,t){var n,r=[],i=dy(kte.factory.all);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,o=!1,s=t.getNext(a);e.isOnBoard(s);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===eve.EMPTY){if(r.push(s),o)break}else{if(u.isRing)break;o=!0}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){return e.gameState.isInitialPlacementPhase()?Bte.ONGOING:e.gameState.sideRings[0]>=3?Bte.ZERO_WON:e.gameState.sideRings[1]>=3?Bte.ONE_WON:Bte.ONGOING}}]),n}(zte),ove=eve.EMPTY,sve=eve.UNREACHABLE,uve=eve.MARKER_ZERO,cve=eve.RING_ZERO,lve=eve.MARKER_ONE,fve=eve.RING_ONE,hve=function(){var e=my(function e(){gy(this,e)});return e.MUST_ALIGN_FIVE=function(){return $localize(zf||(zf=Wg(["Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time."])))},e.MUST_CAPTURE_TWO=function(){return $localize(Hf||(Hf=Wg(["Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again."])))},e}(),dve=my(function e(){gy(this,e),this.tutorial=[Zte.informational($localize(Gf||(Gf=Wg(["Goal of the game"]))),$localize($f||($f=Wg(["The goal at Yinsh is to capture three rings in total.\n        The rings taken are shown on the top left for the dark player,\n        and on the bottom right for the light player. Here, Dark won the game.\n        Note that on the board you have two types of pieces for each player:\n        rings (empty circles) and markers (full circles)."]))),new tve([[sve,sve,sve,sve,sve,sve,ove,ove,ove,ove,sve],[sve,sve,sve,sve,ove,ove,ove,ove,ove,ove,ove],[sve,sve,sve,uve,fve,ove,ove,ove,ove,ove,ove],[sve,sve,ove,uve,ove,fve,ove,lve,ove,ove,ove],[sve,ove,cve,lve,ove,ove,fve,uve,ove,ove,ove],[sve,ove,ove,uve,lve,ove,ove,ove,ove,ove,sve],[ove,ove,ove,uve,ove,ove,ove,fve,ove,ove,sve],[ove,ove,ove,lve,uve,cve,ove,ove,ove,sve,sve],[ove,ove,ove,ove,ove,ove,ove,ove,sve,sve,sve],[ove,ove,ove,ove,ove,ove,ove,sve,sve,sve,sve],[sve,ove,ove,ove,ove,sve,sve,sve,sve,sve,sve]],[3,1],20)),Zte.anyMove($localize(Zf||(Zf=Wg(["Initial board and placement phase"]))),$localize(qf||(qf=Wg(["The initial board is empty.\n        At the beginning of the game, each player puts one of its ring on the board at their turn.\n        This phase stops when all rings have been placed on the board.\n        Put one of your ring on the board by clicking the space where you want to place it."]))),new tve(tve.getInitialState().board,[5,5],0),new rve([],new pte(5,5),NB.empty(),[]),$localize(Wf||(Wf=Wg(["Congratulations!"])))),Zte.anyMove($localize(jf||(jf=Wg(["Putting a marker"]))),$localize(Yf||(Yf=Wg(["Once the initial phase is done and all rings are on the board, you need to place markers on the board.\n        To do so, put a marker in a ring by clicking on that ring.\n        Then, the ring must be moved in a straight line, in any direction.\n        A ring cannot pass through other rings during its move.\n        If it goes over a group of markers, your move must stop at the first empty space after that group.\n        All markers in the group are then flipped and their color change.<br/><br/>\n        You're playing Dark, do a move."]))),new tve([[sve,sve,sve,sve,sve,sve,ove,ove,ove,ove,sve],[sve,sve,sve,sve,ove,ove,ove,ove,ove,ove,ove],[sve,sve,sve,fve,ove,ove,ove,ove,ove,ove,ove],[sve,sve,fve,ove,ove,fve,ove,ove,ove,ove,ove],[sve,ove,cve,lve,ove,ove,fve,ove,ove,ove,ove],[sve,ove,ove,lve,ove,ove,ove,ove,ove,ove,sve],[ove,ove,ove,ove,cve,ove,ove,fve,ove,ove,sve],[ove,ove,ove,ove,ove,cve,ove,ove,ove,sve,sve],[ove,ove,ove,cve,ove,ove,ove,sve,sve,sve,sve],[ove,ove,ove,ove,ove,ove,ove,sve,sve,sve,sve],[sve,ove,ove,ove,ove,sve,sve,sve,sve,sve,sve]],[0,0],20),new rve([],new pte(2,4),NB.of(new pte(4,4)),[]),$localize(Kf||(Kf=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(Qf||(Qf=Wg(["Getting a ring by aligning 5 markers"]))),$localize(Xf||(Xf=Wg(["Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.\n        To do so, you need to align 5 markers of your color.\n        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.\n        You will then have one more point.\n        You must capture when you can.<br/><br/>\n        You're playing Dark, perform a capture!"]))),new tve([[sve,sve,sve,sve,sve,sve,ove,ove,ove,ove,sve],[sve,sve,sve,sve,ove,ove,ove,ove,ove,ove,ove],[sve,sve,sve,fve,ove,ove,ove,ove,ove,ove,ove],[sve,sve,fve,ove,ove,fve,ove,ove,ove,ove,ove],[sve,ove,uve,uve,cve,lve,lve,ove,ove,ove,ove],[sve,ove,ove,fve,ove,ove,ove,ove,ove,ove,sve],[ove,ove,ove,ove,cve,ove,ove,fve,ove,ove,sve],[ove,ove,ove,ove,ove,cve,ove,ove,ove,sve,sve],[ove,ove,ove,cve,ove,ove,ove,cve,sve,sve,sve],[ove,ove,ove,ove,ove,ove,ove,sve,sve,sve,sve],[sve,ove,ove,ove,ove,sve,sve,sve,sve,sve,sve]],[0,0],20),new rve([],new pte(4,4),NB.of(new pte(7,4)),[nve.of(new pte(2,4),new pte(6,4),new pte(7,4))]),function(e,t,n){return 1===n.sideRings[e9.ZERO.value]?UB.SUCCESS:UB.failure(hve.MUST_ALIGN_FIVE())},$localize(Jf||(Jf=Wg(["Congratulations!"])))),Zte.fromPredicate($localize(eh||(eh=Wg(["Compound captures"]))),$localize(th||(th=Wg(["During a turn, you could have to choose between multiple captures,\n        or you could even capture multiple times!\n        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>\n        Here, you can capture two rings, do it!"]))),new tve([[sve,sve,sve,sve,sve,sve,ove,ove,ove,ove,sve],[sve,sve,sve,sve,cve,ove,ove,fve,fve,cve,ove],[sve,sve,sve,cve,ove,ove,lve,fve,ove,cve,ove],[sve,sve,ove,cve,ove,ove,ove,ove,ove,fve,ove],[sve,ove,ove,ove,ove,uve,ove,ove,fve,ove,ove],[sve,ove,ove,ove,uve,uve,ove,lve,ove,ove,sve],[ove,ove,ove,uve,ove,uve,ove,ove,ove,ove,sve],[ove,ove,uve,ove,ove,uve,ove,ove,ove,sve,sve],[ove,uve,ove,ove,ove,uve,ove,ove,sve,sve,sve],[ove,ove,ove,ove,ove,uve,ove,sve,sve,sve,sve],[sve,ove,ove,ove,ove,sve,sve,sve,sve,sve,sve]],[0,0],10),new rve([nve.of(new pte(5,4),new pte(1,8),new pte(3,2)),nve.of(new pte(5,9),new pte(5,5),new pte(3,3))],new pte(4,1),NB.of(new pte(4,2)),[]),function(e,t,n){return 2===n.sideRings[e9.ZERO.value]?UB.SUCCESS:UB.failure(hve.MUST_CAPTURE_TWO())},$localize(nh||(nh=Wg(["Congratulations!"]))))]});function vve(e,t){if(1&e&&(NC(),OP(0,"circle",12)),2&e){var n=LP(2).$implicit,r=LP(2);pP("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringOuterSize)}}function pve(e,t){if(1&e&&(NC(),OP(0,"circle",13)),2&e){var n=LP(2),r=n.index,i=n.$implicit,a=LP().index,o=LP();VP("id","ring_",r,"_",a,""),EP("ngClass",i.ringClasses),pP("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function gve(e,t){if(1&e&&(NC(),OP(0,"circle",12)),2&e){var n=LP(2).$implicit,r=LP(2);pP("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringInnerSize)}}function yve(e,t){if(1&e&&(NC(),OP(0,"circle",14)),2&e){var n=LP(2),r=n.index,i=n.$implicit,a=LP().index,o=LP();VP("id","marker_",r,"_",a,""),EP("ngClass",i.markerClasses),pP("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function mve(e,t){if(1&e){var n=AP();NC(),PP(0,"g",6),RP("click",function(){aC(n);var e=LP().$implicit;return LP(2).onClick(e.coord)}),OP(1,"polygon",7),PP(2,"g",8),CP(3,vve,1,3,"circle",9),CP(4,pve,1,6,"circle",10),CP(5,gve,1,3,"circle",9),CP(6,yve,1,6,"circle",11),SP(),SP()}if(2&e){var r=LP(),i=r.index,a=r.$implicit,o=LP().index;VP("id","click_",i,"_",o,""),BE(1),VP("id","space_",i,"_",o,""),EP("ngClass",a.spaceClasses),pP("points",a.coordinates),BE(1),VP("id","pieceGroup_",i,"_",o,""),EP("ngClass",a.removedClass),BE(1),EP("ngIf",a.isRing),BE(1),EP("ngIf",a.isRing),BE(1),EP("ngIf",a.isRing),BE(1),EP("ngIf",a.isMarker)}}function kve(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,mve,7,13,"g",5),SP()),2&e){var n=t.$implicit;BE(1),EP("ngIf",null!=n)}}function Cve(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,kve,2,1,"g",1),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}function wve(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",15),RP("click",function(){var e=aC(n).$implicit;return LP().onClick(e)}),SP()}if(2&e){var r=t.$implicit,i=LP();VP("id","selected_",r.x,"_",r.y,""),pP("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function _ve(e,t){if(1&e){var n=AP();NC(),PP(0,"polygon",17),RP("click",function(){var e=aC(n).$implicit;return LP(2).onClick(e)}),SP()}if(2&e){var r=t.$implicit,i=LP(2);VP("id","selectable_",r.x,"_",r.y,""),pP("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Eve(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,_ve,1,3,"polygon",16),SP()),2&e){var n=LP();BE(1),EP("ngForOf",n.viewInfo.selectableCoords)}}function bve(e,t){if(1&e){var n=AP();NC(),PP(0,"rect",18),RP("click",function(){var e=aC(n).$implicit;return LP().onClick(e)}),SP()}if(2&e){var r=t.$implicit,i=LP();VP("id","indicator_",r.x,"_",r.y,""),pP("x",i.viewInfo.spaceInfo[r.y][r.x].center.x-i.viewInfo.indicatorSize/2)("y",i.viewInfo.spaceInfo[r.y][r.x].center.y-i.viewInfo.indicatorSize/2)("width",i.viewInfo.indicatorSize)("height",i.viewInfo.indicatorSize)}}function Pve(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"circle",19),OP(2,"circle",12),OP(3,"circle",20),SP()),2&e){var n=t.index,r=LP().$implicit,i=LP();BE(1),VP("id","player_",r.value,"_sideRing_",n+1,""),pP("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringOuterSize),BE(1),pP("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringInnerSize),BE(1),EP("ngClass",i.viewInfo.sideRingClass[r.value]),pP("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringMidSize)}}var Sve=function(){return[]};function Ove(e,t){if(1&e&&(NC(),PP(0,"g"),CP(1,Pve,4,12,"g",1),SP()),2&e){var n=t.$implicit,r=LP();pP("transform","rotate("+180*r.role.value+" 532.5 780)"),BE(1),EP("ngForOf",AT(2,Sve).constructor(r.viewInfo.sideRings[n.value]))}}var Tve=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,e)).movePhase="MOVE_START",r.moveStart=NB.empty(),r.moveEnd=NB.empty(),r.currentlyMoved=[],r.currentCapture=NB.empty(),r.initialCaptures=[],r.finalCaptures=[],r.possibleCaptures=[],r.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:n.MARKER_SIZE,ringOuterSize:n.RING_OUTER_SIZE,ringMidSize:n.RING_MID_SIZE,ringInnerSize:n.RING_INNER_SIZE,indicatorSize:n.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},r.scores=NB.of([0,0]),r.rules=new ave(tve),r.availableMinimaxes=[new ive(r.rules,"YinshMinimax")],r.encoder=rve.encoder,r.tutorial=(new dve).tutorial,r.hexaLayout=new Cte(1.5*n.RING_OUTER_SIZE,new pte(2*n.RING_OUTER_SIZE,0),Ete.INSTANCE),r.constructedState=r.getState(),r.constructedState.allCoords().forEach(function(e){null==r.viewInfo.spaceInfo[e.y]&&(r.viewInfo.spaceInfo[e.y]=[]),r.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:r.getHexaCoordsAt(e),center:r.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}}),r}return my(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt();var e=this.getState();this.scores=NB.of(e.countScores())}},{key:"updateViewInfo",value:function(){var e=this;this.constructedState.allCoords().forEach(function(t){e.viewInfo.spaceInfo[t.y][t.x].spaceClasses=e.getSpaceClasses(t);var n=e.constructedState.getPieceAt(t);e.viewInfo.spaceInfo[t.y][t.x].removedClass="",e.setRingInfo(t,n),e.setMarkerInfo(t,n)});var t,n=dy(e9.PLAYERS);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.sideRings[r.value]=this.constructedState.sideRings[r.value]}}catch(c){n.e(c)}finally{n.f()}switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];var i,a=dy(this.possibleCaptures);try{for(a.s();!(i=a.n()).done;){var o,s=dy(i.value.capturedSpaces);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.viewInfo.selectableCoords.push(u)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){a.e(c)}finally{a.f()}break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}},{key:"showCurrentMoveCaptures",value:function(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());var e,t=dy(this.initialCaptures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.markCurrentCapture(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=dy(this.finalCaptures);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.markCurrentCapture(a)}}catch(o){i.e(o)}finally{i.f()}}},{key:"getSpaceClasses",value:function(e){return this.currentlyMoved.some(function(t){return t.equals(e)})?["moved-fill"]:[]}},{key:"setRingInfo",value:function(e,t){t.isRing?(this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=["player"+t.player.value+"-stroke"]):(this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[])}},{key:"setMarkerInfo",value:function(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==eve.EMPTY&&(!t.isRing||this.moveStart.equalsValue(e))){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=NB.empty(),this.moveStart=NB.empty(),this.moveEnd=NB.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}},{key:"showLastMove",value:function(){var e=this,t=this.rules.node.move;if(t.isPresent()){var n=t.get();if(n.isInitialPlacement())this.viewInfo.spaceInfo[n.start.y][n.start.x].spaceClasses=["moved-fill"];else{var r,i=dy(this.coordsBetween(n.start,n.end.get()));try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.spaceInfo[a.y][a.x].spaceClasses=["moved-fill"]}}catch(s){i.e(s)}finally{i.f()}var o=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();n.initialCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)}),n.finalCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)})}}}},{key:"coordsBetween",value:function(e,t){for(var n=[],r=kte.factory.fromMove(e,t).get(),i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==eve.EMPTY&&n.push(i),n.push(t);return n}},{key:"showLastMoveCapture",value:function(e,t){var n,r=dy(e.capturedSpaces);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["captured-fill"],t&&this.markRemovedMarker(i,this.getState().getCurrentPlayer().getOpponent())}}catch(a){r.e(a)}finally{r.f()}this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured-fill"],t&&this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}},{key:"moveToInitialCaptureOrMovePhase",value:function(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),UB.SUCCESS}},{key:"onClick",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:n.t0=t.movePhase,n.next="INITIAL_CAPTURE_SELECT_FIRST"===n.t0||"FINAL_CAPTURE_SELECT_FIRST"===n.t0?6:"INITIAL_CAPTURE_SELECT_LAST"===n.t0||"FINAL_CAPTURE_SELECT_LAST"===n.t0?7:"INITIAL_CAPTURE_SELECT_RING"===n.t0||"FINAL_CAPTURE_SELECT_RING"===n.t0?8:"MOVE_START"===n.t0?9:"MOVE_END"===n.t0?10:11;break;case 6:return n.abrupt("return",t.selectCaptureFirstCoord(e));case 7:return n.abrupt("return",t.selectCaptureLastCoord(e));case 8:return n.abrupt("return",t.selectRing(e));case 9:return n.abrupt("return",t.selectMoveStart(e));case 10:return n.abrupt("return",t.selectMoveEnd(e));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectCaptureFirstCoord",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),!(r.length>1)){n.next=5;break}t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r),n.next=8;break;case 5:if(0!==r.length){n.next=7;break}return n.abrupt("return",t.cancelMove(Jde.MISSING_CAPTURES()));case 7:t.selectCapture(r[0]);case 8:return n.abrupt("return",UB.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveToCaptureSelectLast",value:function(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;var t,n=dy(e);try{for(n.s();!(t=n.n()).done;){var r,i=dy(t.value.capturedSpaces);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.selectableCoords.push(a)}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(IB.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}},{key:"selectCaptureLastCoord",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.abrupt("return",(t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),r.length>1?t.cancelMove(Jde.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(Jde.MISSING_CAPTURES()):t.selectCapture(r[0])));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectCapture",value:function(e){return this.currentCapture=NB.of(e),this.constructedState=new tve(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(F7("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),UB.SUCCESS}},{key:"markCurrentCapture",value:function(e){var t,n=dy(e.capturedSpaces);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.selectedCoords.push(r),this.markRemovedMarker(r,this.getState().getCurrentPlayer())}}catch(i){n.e(i)}finally{n.f()}e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer()))}},{key:"markRemovedMarker",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,eve.MARKERS[t.value])}},{key:"markRemovedRing",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,eve.RINGS[t.value])}},{key:"selectRing",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.rules.ringSelectionValidity(t.constructedState,e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return t.constructedState=t.rules.takeRing(t.constructedState,e),i=t.currentCapture.get().setRingTaken(e),n.abrupt("return","INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=NB.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),UB.SUCCESS)):(IB.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),UB.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"moveToMovePhase",value:function(){return this.movePhase="MOVE_START",this.updateViewInfo(),UB.SUCCESS}},{key:"tryMove",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new rve(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures),t.next=3,e.chooseMove(n,e.getState(),e.scores.get());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"selectMoveStart",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.constructedState.isInitialPlacementPhase()){n.next=3;break}return r=t.rules.initialPlacementValidity(t.constructedState,e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=NB.of(e),t.tryMove()));case 3:if(!(i=t.rules.moveStartValidity(t.constructedState,e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(i.getReason()));case 6:return t.moveStart=NB.of(e),t.movePhase="MOVE_END",t.updateViewInfo(),n.abrupt("return",UB.SUCCESS);case 8:case"end":return n.stop()}},n)}))()}},{key:"selectMoveEnd",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.moveStart.equalsValue(e)){n.next=2;break}return n.abrupt("return",(t.cancelMoveAttempt(),UB.SUCCESS));case 2:if(r=eve.RINGS[t.getState().getCurrentPlayer().value],t.constructedState.getPieceAt(e)!==r){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),t.selectMoveStart(e)));case 5:return i=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e),n.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):(t.moveEnd=NB.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove()));case 7:case"end":return n.stop()}},n)}))()}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),UB.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(yte);function Ive(e,t){if(1&e&&(PP(0,"option",5),uS(1),SP()),2&e){var n=t.$implicit;EP("value",n.urlName),BE(1),cS(n.name)}}Tve.RING_OUTER_SIZE=40,Tve.RING_MID_SIZE=34,Tve.RING_INNER_SIZE=28,Tve.MARKER_SIZE=Tve.RING_INNER_SIZE,Tve.INDICATOR_SIZE=10,Tve.\u0275fac=function(e){return new(e||Tve)(_P(D7))},Tve.\u0275cmp=vk({type:Tve,selectors:[["app-yinsh"]],features:[nP],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(NC(),PP(0,"svg",0),CP(1,Cve,2,1,"g",1),CP(2,wve,1,3,"polygon",2),CP(3,Eve,2,1,"g",3),CP(4,bve,1,6,"rect",4),CP(5,Ove,2,3,"g",1),SP()),2&e&&(BE(1),EP("ngForOf",t.viewInfo.spaceInfo),BE(1),EP("ngForOf",t.viewInfo.selectedCoords),BE(1),EP("ngIf",t.isPlayerTurn()),BE(1),EP("ngForOf",t.viewInfo.targets),BE(1),EP("ngForOf",t.Player.PLAYERS))},directives:[aM,sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Ave=function(){var e=my(function e(){gy(this,e)});return e.ABALONE=function(){return $localize(rh||(rh=Wg(["Use simple mechanics to push 6 of the opponent's pieces out of the board!"])))},e.APAGOS=function(){return $localize(ih||(ih=Wg(["Very simple game, but, will you be able to win everytime?"])))},e.AWALE=function(){return $localize(ah||(ah=Wg(["The international version of the famous African strategy game!"])))},e.BRANDHUB=function(){return $localize(oh||(oh=Wg(["The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!"])))},e.COERCEO=function(){return $localize(sh||(sh=Wg(["Get rid of all of your opponent's pieces on a board that shrinks little by little!"])))},e.CONSPIRATEURS=function(){return $localize(uh||(uh=Wg(["Hide all of your pieces before your opponent does, or risk to be discovered!"])))},e.DIAM=function(){return $localize(ch||(ch=Wg(["Drop your pieces and move them around to align two pieces of the same color across the board to win!"])))},e.DVONN=function(){return $localize(lh||(lh=Wg(["Stack your pieces and control as many stacks as you can to win!"])))},e.ENCAPSULE=function(){return $localize(fh||(fh=Wg(["An enhanced tic-tac-toe where piece can encapsule other and prevent them to win."])))},e.EPAMINONDAS=function(){return $localize(hh||(hh=Wg(["An antiquity-war inspired game. Be the first to pierce your opponent's lines!"])))},e.GIPF=function(){return $localize(dh||(dh=Wg(["A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!"])))},e.GO=function(){return $localize(vh||(vh=Wg(["The oldest strategy game still practiced widely. A territory control game."])))},e.HNEFATAFL=function(){return $localize(ph||(ph=Wg(["The Viking board game! Invaders must capture the king, defender must make him escape!"])))},e.KAMISADO=function(){return $localize(gh||(gh=Wg(["Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!"])))},e.LINES_OF_ACTION=function(){return $localize(yh||(yh=Wg(["Regroup your pieces to win. But your possible moves will often change!"])))},e.LODESTONE=function(){return $localize(mh||(mh=Wg(["Push and crush your opponent's pieces using magnetic forces!"])))},e.MARTIAN_CHESS=function(){return $localize(kh||(kh=Wg(["Win points by capturing pieces, but you only control pieces on your side of the board!"])))},e.P4=function(){return $localize(Ch||(Ch=Wg(["The classical 4 in a row game!"])))},e.PENTAGO=function(){return $localize(wh||(wh=Wg(["Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!"])))},e.PYLOS=function(){return $localize(_h||(_h=Wg(["Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!"])))},e.QUARTO=function(){return $localize(Eh||(Eh=Wg(["Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!"])))},e.QUIXO=function(){return $localize(bh||(bh=Wg(["Align 5 of your pieces on a board where pieces slide!"])))},e.REVERSI=function(){return $localize(Ph||(Ph=Wg(["Sandwich your opponent's pieces to dominate the board!"])))},e.SAHARA=function(){return $localize(Sh||(Sh=Wg(["Immobilize one of your opponent's pyramids before your opponent does!"])))},e.SIAM=function(){return $localize(Oh||(Oh=Wg(["Be the first to push a mountain out of the board!"])))},e.SIX=function(){return $localize(Th||(Th=Wg(["Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!"])))},e.TABLUT=function(){return $localize(Ih||(Ih=Wg(["Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!"])))},e.YINSH=function(){return $localize(Ah||(Ah=Wg(["Align your pieces to score points, but beware, pieces can flip!"])))},e}(),Mve=function(){var e=my(function e(t,n,r,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];gy(this,e),this.name=t,this.urlName=n,this.component=r,this.creationDate=i,this.description=a,this.display=o});return e.ALL_GAMES=function(){return[new e("MinimaxTesting","MinimaxTesting",Fce,new Date("1970-01-01"),"",!1),new e($localize(Mh||(Mh=Wg(["Four in a Row"]))),"P4",Xce,new Date("2018-08-28"),Ave.P4()),new e($localize(xh||(xh=Wg(["Awal\xe9"]))),"Awale",Lne,new Date("2018-11-29"),Ave.AWALE()),new e($localize(Rh||(Rh=Wg(["Quarto"]))),"Quarto",Nfe,new Date("2018-12-09"),Ave.QUARTO()),new e($localize(Nh||(Nh=Wg(["Tablut"]))),"Tablut",Xde,new Date("2018-12-27"),Ave.TABLUT()),new e($localize(Dh||(Dh=Wg(["Reversi"]))),"Reversi",uhe,new Date("2019-01-16"),Ave.REVERSI()),new e($localize(Lh||(Lh=Wg(["Go"]))),"Go",Yoe,new Date("2019-12-21"),Ave.GO()),new e($localize(Fh||(Fh=Wg(["Encapsule"]))),"Encapsule",Lae,new Date("2019-12-30"),Ave.ENCAPSULE()),new e($localize(Uh||(Uh=Wg(["Siam"]))),"Siam",ude,new Date("2020-01-11"),Ave.SIAM()),new e($localize(Vh||(Vh=Wg(["Sahara"]))),"Sahara",Ahe,new Date("2020-02-29"),Ave.SAHARA()),new e($localize(Bh||(Bh=Wg(["Pylos"]))),"Pylos",Gle,new Date("2020-10-02"),Ave.PYLOS()),new e($localize(zh||(zh=Wg(["Kamisado"]))),"Kamisado",Qse,new Date("2020-10-03"),Ave.KAMISADO()),new e($localize(Hh||(Hh=Wg(["Quixo"]))),"Quixo",jfe,new Date("2020-10-15"),Ave.QUIXO()),new e($localize(Gh||(Gh=Wg(["Dvonn"]))),"Dvonn",hae,new Date("2020-10-21"),Ave.DVONN()),new e($localize($h||($h=Wg(["Epaminondas"]))),"Epaminondas",Xae,new Date("2021-01-16"),Ave.EPAMINONDAS()),new e($localize(Zh||(Zh=Wg(["Gipf"]))),"Gipf",woe,new Date("2021-02-22"),Ave.GIPF()),new e($localize(qh||(qh=Wg(["Coerceo"]))),"Coerceo",Wre,new Date("2021-03-21"),Ave.COERCEO()),new e($localize(Wh||(Wh=Wg(["Six"]))),"Six",Mde,new Date("2021-04-08"),Ave.SIX()),new e($localize(jh||(jh=Wg(["Lines of Action"]))),"LinesOfAction",fue,new Date("2021-04-28"),Ave.LINES_OF_ACTION()),new e($localize(Yh||(Yh=Wg(["Pentago"]))),"Pentago",mle,new Date("2021-05-23"),Ave.PENTAGO()),new e($localize(Kh||(Kh=Wg(["Abalone"]))),"Abalone",lne,new Date("2021-07-13"),Ave.ABALONE()),new e($localize(Qh||(Qh=Wg(["Yinsh"]))),"Yinsh",Tve,new Date("2021-07-31"),Ave.YINSH()),new e($localize(Xh||(Xh=Wg(["Apagos"]))),"Apagos",Pne,new Date("2021-11-04"),Ave.APAGOS()),new e($localize(Jh||(Jh=Wg(["Diam"]))),"Diam",Lie,new Date("2021-11-30"),Ave.DIAM()),new e($localize(ed||(ed=Wg(["Brandhub"]))),"Brandhub",mre,new Date("2021-12-07"),Ave.BRANDHUB()),new e($localize(td||(td=Wg(["Conspirateurs"]))),"Conspirateurs",vie,new Date("2021-12-30"),Ave.CONSPIRATEURS()),new e($localize(nd||(nd=Wg(["Lodestone"]))),"Lodestone",$ue,new Date("2022-06-24"),Ave.LODESTONE()),new e($localize(rd||(rd=Wg(["Martian Chess"]))),"MartianChess",Sce,new Date("2022-07-01"),Ave.MARTIAN_CHESS()),new e($localize(id||(id=Wg(["Hnefatafl"]))),"Hnefatafl",gse,new Date("2022-09-21"),Ave.HNEFATAFL())].sort(function(e,t){return e.name.localeCompare(t.name)})},e}(),xve=function(){var e=function(){function e(){gy(this,e),this.games=Mve.ALL_GAMES().filter(function(e){return!0===e.display}),this.pickGame=new VT}return my(e,[{key:"onChange",value:function(e){this.pickGame.emit(e.target.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=vk({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){return[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],$localize(ad||(ad=Wg(["Pick a game"]))),[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(PP(0,"div",0),PP(1,"select",1),RP("change",function(e){return t.onChange(e)}),PP(2,"option",2),gO(3,3),SP(),CP(4,Ive,2,2,"option",4),SP(),SP()),2&e&&(BE(4),EP("ngForOf",t.games))},directives:[IR,RR,aM],encapsulation:2}),e}();function Rve(e,t){if(1&e){var n=AP();PP(0,"div",26),PP(1,"div",27),RP("click",function(){return aC(n),LP().closeInfo()}),SP(),PP(2,"div",28),PP(3,"header",29),PP(4,"p",30),uS(5),SP(),PP(6,"button",31),RP("click",function(){return aC(n),LP().closeInfo()}),SP(),SP(),PP(7,"section",32),PP(8,"div",6),PP(9,"div",33),PP(10,"p",34),OP(11,"img",35),SP(),SP(),PP(12,"div",7),PP(13,"div",13),uS(14),SP(),SP(),SP(),PP(15,"div",6),PP(16,"div",33),PP(17,"a",36),RP("click",function(){aC(n);var e=LP();return e.createGame(e.gameInfoDetails.get().urlName)}),OP(18,"fa-icon",37),uS(19,"\xa0"),PP(20,"span"),gO(21,38),SP(),SP(),SP(),PP(22,"div",33),PP(23,"a",36),RP("click",function(){aC(n);var e=LP();return e.createLocalGame(e.gameInfoDetails.get().urlName)}),OP(24,"fa-icon",37),uS(25,"\xa0"),PP(26,"span"),gO(27,39),SP(),SP(),SP(),PP(28,"div",33),PP(29,"a",36),RP("click",function(){aC(n);var e=LP();return e.createTutorial(e.gameInfoDetails.get().urlName)}),OP(30,"fa-icon",37),uS(31,"\xa0"),PP(32,"span"),gO(33,40),SP(),SP(),SP(),SP(),SP(),SP(),SP()}if(2&e){var r=LP();BE(5),cS(r.gameInfoDetails.get().name),BE(6),VP("src","assets/images/",r.theme,"/",r.gameInfoDetails.get().urlName,".png",R_),BE(3),lS(" ",r.gameInfoDetails.get().description," "),BE(4),EP("icon",r.iconOnlineGame),BE(6),EP("icon",r.iconLocalGame),BE(6),EP("icon",r.iconTutorial)}}function Nve(e,t){if(1&e){var n=AP();PP(0,"div",8),PP(1,"div",9),PP(2,"p",10),uS(3),SP(),SP(),PP(4,"div",42),PP(5,"figure",34),PP(6,"img",43),RP("click",function(){var e=aC(n).$implicit;return LP(2).openInfo(e)}),SP(),PP(7,"figcaption",44),RP("click",function(){var e=aC(n).$implicit;return LP(2).openInfo(e)}),PP(8,"div",45),uS(9,"?"),SP(),SP(),PP(10,"figcaption",46),PP(11,"a",47),RP("click",function(){var e=aC(n).$implicit;return LP(2).createGame(e.urlName)}),OP(12,"fa-icon",37),SP(),PP(13,"a",48),RP("click",function(){var e=aC(n).$implicit;return LP(2).createLocalGame(e.urlName)}),OP(14,"fa-icon",37),SP(),PP(15,"a",49),RP("click",function(){var e=aC(n).$implicit;return LP(2).createTutorial(e.urlName)}),OP(16,"fa-icon",37),SP(),SP(),SP(),SP(),PP(17,"div",50),uS(18),SP(),SP()}if(2&e){var r=t.$implicit,i=LP(2);BE(3),cS(r.name),BE(3),UP("id","image_",r.urlName,""),VP("src","assets/images/",i.theme,"/",r.urlName,".png",R_),BE(5),UP("id","playOnline_",r.urlName,""),BE(1),EP("icon",i.iconOnlineGame),BE(1),UP("id","playLocally_",r.urlName,""),BE(1),EP("icon",i.iconLocalGame),BE(1),UP("id","startTutorial_",r.urlName,""),BE(1),EP("icon",i.iconTutorial),BE(2),lS(" ",r.description," ")}}function Dve(e,t){if(1&e&&(PP(0,"div",7),CP(1,Nve,19,11,"div",41),SP()),2&e){var n=t.$implicit;BE(1),EP("ngForOf",n)}}var Lve=function(){var e=function(){function e(t,n){gy(this,e),this.router=t,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=C9,this.iconLocalGame=m9,this.iconTutorial=g9,this.gameInfoDetails=NB.empty(),this.theme=n.getTheme();for(var r=Mve.ALL_GAMES().filter(function(e){return!0===e.display}),i=0,a=0;a<r.length;a++)a<this.numberOfColumns&&this.games.push([]),this.games[i].push(r[a]),i=(i+1)%this.numberOfColumns}return my(e,[{key:"createGame",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/play",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createLocalGame",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/local",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createTutorial",value:function(e){return this.router.navigate(["/tutorial",e])}},{key:"openInfo",value:function(e){this.gameInfoDetails=NB.of(e)}},{key:"closeInfo",value:function(){this.gameInfoDetails=NB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(yF),_P(p9))},e.\u0275cmp=vk({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){return[[1,"hero"],[1,"hero-body"],[1,"title"],$localize(od||(od=Wg(["EveryBoard"]))),[1,"subtitle"],$localize(sd||(sd=Wg(["EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.",":LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn."])),"\ufffd#6\ufffd\ufffd/#6\ufffd"),[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],$localize(ud||(ud=Wg(["Play online"]))),[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(cd||(cd=Wg(["Create an online game"]))),["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],$localize(ld||(ld=Wg(["See the game list"]))),$localize(fd||(fd=Wg(["Play offline"]))),[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(hd||(hd=Wg(["Play"]))),["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],$localize(dd||(dd=Wg(["Learn"]))),["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],$localize(vd||(vd=Wg(["Play online"]))),$localize(pd||(pd=Wg(["Play offline"]))),$localize(gd||(gd=Wg(["Learn the rules"]))),["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",$localize(yd||(yd=Wg(["Play online"]))),1,"button",3,"id","click"],["data-tooltip",$localize(md||(md=Wg(["Play offline"]))),1,"button",3,"id","click"],["data-tooltip",$localize(kd||(kd=Wg(["Learn the rules"]))),1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(PP(0,"section",0),PP(1,"div",1),PP(2,"p",2),gO(3,3),SP(),PP(4,"p",4),vO(5,5),OP(6,"br"),pO(),SP(),SP(),PP(7,"div",6),PP(8,"div",7),PP(9,"div",8),PP(10,"header",9),PP(11,"p",10),gO(12,11),SP(),SP(),PP(13,"div",12),PP(14,"div",13),PP(15,"button",14),gO(16,15),SP(),PP(17,"button",16),gO(18,17),SP(),SP(),SP(),SP(),SP(),PP(19,"div",7),PP(20,"div",8),PP(21,"header",9),PP(22,"p",10),gO(23,18),SP(),SP(),PP(24,"div",12),PP(25,"div",19),PP(26,"button",20),gO(27,21),SP(),PP(28,"button",22),gO(29,23),SP(),SP(),SP(),SP(),SP(),SP(),CP(30,Rve,34,7,"div",24),PP(31,"div",6),CP(32,Dve,2,1,"div",25),SP(),SP()),2&e&&(BE(30),EP("ngIf",t.gameInfoDetails.isPresent()),BE(2),EP("ngForOf",t.games))},directives:[kF,sM,aM,qee],encapsulation:2}),e}(),Fve=function(){var e=function(){function e(t){gy(this,e),this.element=t}return my(e,[{key:"ngAfterViewInit",value:function(){this.element.nativeElement.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(RO))},e.\u0275dir=Ck({type:e,selectors:[["","autofocus",""]]}),e}(),Uve=function(){var e=function(){function e(t){var n=this;gy(this,e),this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",function(e){n.toggle()})}return my(e,[{key:"toggle",value:function(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(RO))},e.\u0275dir=Ck({type:e,selectors:[["","toggleVisibility",""]]}),e}();function Vve(e,t){if(1&e&&(PP(0,"div",29),PP(1,"div",30),gO(2,31),SP(),PP(3,"div",32),uS(4),SP(),SP()),2&e){var n=LP();BE(4),cS(n.errorMessage)}}var Bve=function(){return["/register"]},zve=function(){return["/reset-password"]},Hve=function(){var e=function(){function e(t,n){gy(this,e),this.router=t,this.connectedUserService=n,this.faEye=k9,this.loginForm=new cR({email:new uR,password:new uR})}return my(e,[{key:"ngOnInit",value:function(){var e,t=this;this.userSubscription=this.connectedUserService.subscribeToUser((e=TB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n!==H7.NOT_CONNECTED,!e.t0){e.next=4;break}return e.next=4,t.redirect();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"loginWithEmail",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.doEmailLogin(e.email,e.password);case 2:(r=n.sent).isFailure()&&(t.errorMessage=r.getReason());case 4:case"end":return n.stop()}},n)}))()}},{key:"loginWithGoogle",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.doGoogleLogin();case 2:(n=t.sent).isFailure()&&(e.errorMessage=n.getReason());case 4:case"end":return t.stop()}},t)}))()}},{key:"redirect",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/lobby"]));case 1:case"end":return t.stop()}},t)}))()}},{key:"canLogin",value:function(){var e,t;return!(""===(null!==(e=this.loginForm.value.email)&&void 0!==e?e:"")||""===(null!==(t=this.loginForm.value.password)&&void 0!==t?t:""))}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(yF),_P(G7))},e.\u0275cmp=vk({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){return[[1,"box"],[1,"title"],$localize(Cd||(Cd=Wg(["Log in"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(wd||(wd=Wg(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",$localize(_d||(_d=Wg(["Email"]))),"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],$localize(Ed||(Ed=Wg(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",$localize(bd||(bd=Wg(["Password"]))),"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Pd||(Pd=Wg(["Log in"]))),["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(Sd||(Sd=Wg(["Log in with Google"]))),["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],$localize(Od||(Od=Wg(["No account?"]))),[3,"routerLink"],$localize(Td||(Td=Wg(["Register"]))),$localize(Id||(Id=Wg(["Forgot your password?"]))),$localize(Ad||(Ad=Wg(["Reset your password"]))),["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(Md||(Md=Wg(["Connection error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(PP(0,"div",0),PP(1,"p",1),gO(2,2),SP(),PP(3,"form",3),PP(4,"div",4),PP(5,"div",5),PP(6,"label",6),gO(7,7),SP(),SP(),PP(8,"div",8),PP(9,"div",9),PP(10,"div",10),OP(11,"input",11),SP(),SP(),SP(),SP(),PP(12,"div",4),PP(13,"div",5),PP(14,"label",12),gO(15,13),SP(),SP(),PP(16,"div",8),PP(17,"div",9),PP(18,"div",14),OP(19,"input",15),PP(20,"span",16),OP(21,"fa-icon",17),SP(),SP(),SP(),SP(),SP(),PP(22,"div",4),OP(23,"div",5),PP(24,"div",8),PP(25,"div",9),PP(26,"div",10),PP(27,"button",18),RP("click",function(){return t.loginWithEmail(t.loginForm.value)}),gO(28,19),SP(),SP(),SP(),SP(),SP(),PP(29,"div",4),OP(30,"div",5),PP(31,"div",8),PP(32,"div",9),PP(33,"div",10),PP(34,"button",20),RP("click",function(){return t.loginWithGoogle()}),gO(35,21),SP(),SP(),SP(),SP(),SP(),CP(36,Vve,5,1,"div",22),PP(37,"p",23),TP(38),gO(39,24),IP(),uS(40,"\xa0 "),PP(41,"a",25),gO(42,26),SP(),SP(),PP(43,"p",23),TP(44),gO(45,27),IP(),uS(46,"\xa0 "),PP(47,"a",25),gO(48,28),SP(),SP(),SP(),SP()),2&e&&(BE(3),EP("formGroup",t.loginForm),BE(18),EP("icon",t.faEye),BE(6),EP("disabled",!t.canLogin()),BE(9),EP("ngIf",t.errorMessage),BE(5),EP("routerLink",AT(6,Bve)),BE(6),EP("routerLink",AT(7,zve)))},directives:[yR,Vx,ER,ux,Ux,PR,Fve,DR,qee,Uve,sM,CF],encapsulation:2}),e}(),Gve=function(){var e=function(){function e(t){gy(this,e),this.userDAO=t}return my(e,[{key:"subscribeToActiveUsers",value:function(t){var n=this;AB(e.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");var r=[],i=new o9(function(i){var a;AB(e.VERBOSE,"our DAO gave us "+i.length+" new user(s)"),r=n.sort((a=r).concat.apply(a,fy(i))),t(r)},function(i){var a=r;AB(e.VERBOSE,"our DAO updated "+i.length+" user(s)");var o,s=dy(i);try{var u=function(){var e=o.value;a.forEach(function(t){t.id===e.id&&(t.data=e.data)}),a=n.sort(a)};for(s.s();!(o=s.n()).done;)u()}catch(c){s.e(c)}finally{s.f()}t(r=a)},function(e){r=r.filter(function(t){return!e.some(function(e){return e.id===t.id})}),t(r)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],i)}},{key:"sort",value:function(e){return e.sort(function(e,t){var n=IB.getNonNullable(e.data).lastUpdateTime,r=IB.getNonNullable(n).seconds,i=IB.getNonNullable(t.data).lastUpdateTime;return r-IB.getNonNullable(i).seconds})}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Bw(U7))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),$ve=function(){var e=function(){function e(t){gy(this,e),this.partDAO=t}return my(e,[{key:"subscribeToActiveParts",value:function(e){var t=[],n=new o9(function(n){var r;t=(r=t).concat.apply(r,fy(n)),e(t)},function(n){var r,i=t,a=dy(n);try{var o=function(){var e=r.value;i.forEach(function(t){t.id===e.id&&(t.data=e.data)})};for(a.s();!(r=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}e(t=i)},function(n){var r,i=[],a=dy(t);try{var o=function(){var e=r.value;n.some(function(t){return t.id===e.id})||i.push(e)};for(a.s();!(r=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}e(t=i)});return this.partDAO.observingWhere([["result","==",$7.UNACHIEVED.value]],n)}},{key:"userHasActivePart",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.partDAO.findWhere([["playerZero","==",e],["result","==",$7.UNACHIEVED.value]]);case 2:return r=n.sent,n.next=5,t.partDAO.findWhere([["playerOne","==",e],["result","==",$7.UNACHIEVED.value]]);case 5:return i=n.sent,n.abrupt("return",r.length>0||i.length>0);case 7:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(a9))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),Zve=function(){var e=function(){function e(t){gy(this,e),this.router=t}return my(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"navigateToOnlineGameCreation",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/play",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(yF))},e.\u0275cmp=vk({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(xd||(xd=Wg(["Create an online game"])))]},template:function(e,t){1&e&&(PP(0,"app-pick-game",0),RP("pickGame",function(e){return t.pickGame(e)}),SP(),PP(1,"button",1),RP("click",function(){return t.navigateToOnlineGameCreation()}),gO(2,2),SP()),2&e&&(BE(1),EP("disabled",!t.selectedGame))},directives:[xve],encapsulation:2}),e}(),qve=function(){var e=function(){function e(){gy(this,e)}return my(e,[{key:"transform",value:function(e){return UA(1e3*e.seconds,"HH:mm:ss","en-US")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=wk({name:"firebaseDate",type:e,pure:!0}),e}(),Wve=["chatDiv"];function jve(e,t){1&e&&(TP(0),gO(1,5),IP())}function Yve(e,t){1&e&&gO(0,6),2&e&&(yO(LP().unreadMessagesText),mO(0))}function Kve(e,t){if(1&e){var n=AP();PP(0,"button",11),RP("click",function(){return aC(n),LP(2).scrollToBottom()}),uS(1),SP()}if(2&e){var r=LP(2);BE(1),lS("",r.unreadMessagesText," \u2193")}}function Qve(e,t){if(1&e&&(PP(0,"p"),uS(1),NT(2,"firebaseDate"),PP(3,"b",12),uS(4),SP(),PP(5,"span",13),uS(6),SP(),SP()),2&e){var n=t.$implicit;BE(1),lS(" [",DT(2,3,n.postedTime),"] "),BE(3),lS("",n.sender.name," : "),BE(2),cS(n.content)}}function Xve(e,t){if(1&e){var n=AP();PP(0,"div"),CP(1,Kve,2,1,"button",7),PP(2,"div",8,9),RP("scroll",function(){return aC(n),LP().updateCurrentScrollPosition()}),CP(4,Qve,7,5,"p",10),SP(),SP()}if(2&e){var r=LP();BE(1),EP("ngIf",r.showUnreadMessagesButton),BE(3),EP("ngForOf",r.chat)}}var Jve=function(){return{standalone:!0}};function epe(e,t){if(1&e){var n=AP();PP(0,"form",14),RP("onSubmit",function(){return aC(n),LP().sendMessage()}),PP(1,"div",15),PP(2,"div",16),PP(3,"input",17,18),RP("ngModelChange",function(e){return aC(n),LP().userMessage=e}),SP(),PP(5,"p",19),uS(6),SP(),SP(),PP(7,"div",20),PP(8,"button",21),RP("click",function(){return aC(n),LP().sendMessage()}),OP(9,"fa-icon",22),SP(),SP(),SP(),PP(10,"div",23),PP(11,"p"),PP(12,"strong"),gO(13,24),SP(),SP(),SP(),SP()}if(2&e){var r=wP(4),i=LP();BE(3),EP("ngModel",i.userMessage)("ngModelOptions",AT(4,Jve)),BE(3),lS("",r.value.length,"/128"),BE(3),EP("icon",i.faReply)}}var tpe=function(){var e=function(){function e(t,n){gy(this,e),this.chatService=t,this.connectedUserService=n,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=w9,this.isNearBottom=!0,this.notYetScrolled=!0,AB(e.VERBOSE,"ChatComponent constructor")}return my(e,[{key:"ngOnInit",value:function(){AB(e.VERBOSE,"ChatComponent.ngOnInit for chat ".concat(this.chatId)),F7(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}},{key:"ngAfterViewChecked",value:function(){this.scrollToBottomIfNeeded()}},{key:"loadChatContent",value:function(){var e=this,t=function(t){e.updateMessages(t.flatMap(function(e){return null==e.data.postedTime?[]:[e.data]}))},n=new o9(t,t,function(){});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,n)}},{key:"updateMessages",value:function(e){this.chat=this.chat.concat(e);var t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}},{key:"updateUnreadMessagesText",value:function(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize(Rd||(Rd=Wg(["no new message"]))),this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize(Nd||(Nd=Wg(["1 new message"]))):$localize(Dd||(Dd=Wg([""," new messages"])),e)}},{key:"scrollToBottomIfNeeded",value:function(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}},{key:"updateCurrentScrollPosition",value:function(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}},{key:"scrollToBottom",value:function(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}},{key:"scrollTo",value:function(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}},{key:"sendMessage",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.userMessage,e.userMessage="",r=e.connectedUserService.user.get().toMinimalUser(),t.next=5,e.chatService.sendMessage(e.chatId,r,n,e.turn);case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.chatSubscription.unsubscribe()}},{key:"switchChatVisibility",value:function(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(x7),_P(G7))},e.\u0275cmp=vk({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){var n;(1&e&&XT(Wve,5),2&e)&&(QT(n=JT())&&(t.chatDiv=n.first))},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){return[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],$localize(Ld||(Ld=Wg(["Hide chat"]))),$localize(Fd||(Fd=Wg(["Show chat (",":INTERPOLATION:)"])),"\ufffd0\ufffd"),["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",$localize(Ud||(Ud=Wg(["Type your message here"]))),"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],$localize(Vd||(Vd=Wg(["Be polite"])))]},template:function(e,t){if(1&e&&(PP(0,"div"),PP(1,"button",0),RP("click",function(){return t.switchChatVisibility()}),CP(2,jve,2,0,"ng-container",1),CP(3,Yve,1,1,"ng-template",null,2,tI),SP(),CP(5,Xve,5,2,"div",3),CP(6,epe,14,5,"form",4),SP()),2&e){var n=wP(4);BE(2),EP("ngIf",t.visible)("ngIfElse",n),BE(3),EP("ngIf",t.visible),BE(1),EP("ngIf",t.visible)}},directives:[sM,aM,yR,Vx,dR,ux,FR,Ux,gR,qee],pipes:[qve],encapsulation:2}),e}();function npe(e,t){if(1&e&&(TP(0),uS(1),IP()),2&e){var n=LP().$implicit;BE(1),cS(n.data.playerOne.name)}}function rpe(e,t){1&e&&(TP(0),gO(1,26),IP())}function ipe(e,t){if(1&e){var n=AP();PP(0,"tr",22),RP("click",function(){var e=aC(n).$implicit;return LP(2).joinGame(e.id,e.data.typeGame)}),PP(1,"td",23),uS(2),SP(),PP(3,"td",23),uS(4),SP(),PP(5,"td",23),CP(6,npe,2,1,"ng-container",24),CP(7,rpe,2,0,"ng-template",null,25,tI),SP(),PP(9,"td",23),uS(10),SP(),SP()}if(2&e){var r=t.$implicit,i=t.index,a=wP(8);UP("id","part_",i,""),BE(2),cS(r.data.typeGame),BE(2),cS(r.data.playerZero.name),BE(2),EP("ngIf",r.data.playerOne)("ngIfElse",a),BE(4),cS(r.data.turn)}}function ape(e,t){if(1&e&&(PP(0,"div",13),PP(1,"div",14),PP(2,"table",15),PP(3,"thead"),PP(4,"tr"),PP(5,"th",16),gO(6,17),SP(),PP(7,"th",16),gO(8,18),SP(),PP(9,"th",16),gO(10,19),SP(),PP(11,"th",16),gO(12,20),SP(),SP(),SP(),PP(13,"tbody"),CP(14,ipe,11,6,"tr",21),SP(),SP(),SP(),SP()),2&e){var n=LP();BE(14),EP("ngForOf",n.activeParts)}}function ope(e,t){1&e&&(PP(0,"div",27),OP(1,"app-online-game-selection",28),SP())}function spe(e,t){if(1&e&&(PP(0,"li",39),uS(1),NT(2,"firebaseDate"),SP()),2&e){var n=LP().$implicit;FP("id",n.data.username),BE(1),fS("",n.data.username,": ",DT(2,3,n.data.lastUpdateTime),"")}}function upe(e,t){if(1&e&&(TP(0),CP(1,spe,3,5,"li",38),IP()),2&e){var n=t.$implicit;BE(1),EP("ngIf",n.data.lastUpdateTime)}}function cpe(e,t){if(1&e&&(PP(0,"div",29),PP(1,"div",30),PP(2,"div",31),OP(3,"app-chat",32),SP(),SP(),PP(4,"div",33),PP(5,"div",34),PP(6,"p"),gO(7,35),SP(),PP(8,"ul",36),CP(9,upe,2,1,"ng-container",37),SP(),SP(),SP(),SP()),2&e){var n=LP();BE(3),EP("turn",-1),BE(6),EP("ngForOf",n.activeUsers)}}var lpe=function(){var e=function(){function e(t,n,r){gy(this,e),this.router=t,this.activeUsersService=n,this.activePartsService=r,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}return my(e,[{key:"ngOnInit",value:function(){var t=this;AB(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(function(e){t.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(function(e){t.activeParts=e})}},{key:"ngOnDestroy",value:function(){AB(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}},{key:"joinGame",value:function(e,t){var n=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.router.navigate(["/play",t,e]);case 2:case"end":return r.stop()}},r)}))()}},{key:"selectTab",value:function(e){this.currentTab=e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(yF),_P(Gve),_P($ve))},e.\u0275cmp=vk({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){return[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],$localize(Bd||(Bd=Wg(["Games"]))),["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],$localize(zd||(zd=Wg(["Create"]))),["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],$localize(Hd||(Hd=Wg(["Chat"]))),["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Gd||(Gd=Wg(["Game"]))),$localize($d||($d=Wg(["First player"]))),$localize(Zd||(Zd=Wg(["Second player"]))),$localize(qd||(qd=Wg(["Turn"]))),[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],$localize(Wd||(Wd=Wg(["Waiting for opponent"]))),["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],$localize(jd||(jd=Wg(["Connected users:"]))),["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,t){1&e&&(PP(0,"div",0),PP(1,"ul"),PP(2,"li",1),PP(3,"a",2),RP("click",function(){return t.selectTab("games")}),gO(4,3),SP(),SP(),PP(5,"li",4),PP(6,"a",5),RP("click",function(){return t.selectTab("create")}),gO(7,6),SP(),SP(),PP(8,"li",7),PP(9,"a",8),RP("click",function(){return t.selectTab("chat")}),gO(10,9),SP(),SP(),SP(),SP(),CP(11,ape,15,1,"div",10),CP(12,ope,2,0,"div",11),CP(13,cpe,10,2,"div",12)),2&e&&(BE(11),EP("ngIf","games"===t.currentTab),BE(1),EP("ngIf","create"===t.currentTab),BE(1),EP("ngIf","chat"===t.currentTab))},directives:[rM,sM,aM,Zve,tpe],pipes:[qve],encapsulation:2}),e}(),fpe=function(){var e=my(function e(t){var n;gy(this,e),this.route=t,this.message=null!==(n=t.snapshot.paramMap.get("message"))&&void 0!==n?n:$localize(Yd||(Yd=Wg(["This page does not exist."])))});return e.\u0275fac=function(t){return new(t||e)(_P(KD))},e.\u0275cmp=vk({type:e,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){return[[1,"message","is-danger"],[1,"message-header"],$localize(Kd||(Kd=Wg(["Not found"]))),[1,"message-body"]]},template:function(e,t){1&e&&(PP(0,"div",0),PP(1,"div",1),gO(2,2),SP(),PP(3,"div",3),uS(4),SP(),SP()),2&e&&(BE(4),cS(t.message))},encapsulation:2}),e}();function hpe(e,t){}var dpe=function(){var e=my(function e(t){gy(this,e),this.viewContainerRef=t,AB(e.VERBOSE,"GameIncluderComponent constructor")});return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(gT))},e.\u0275cmp=vk({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&CP(0,hpe,0,0,"ng-template")},encapsulation:2}),e}(),vpe=function(){var e=function(){function e(){gy(this,e)}return my(e,null,[{key:"NO_MATCHING_GAME",value:function(e){return $localize(Qd||(Qd=Wg(["This game (",") does not exist."])),e)}}]),e}();return e.NOT_YOUR_TURN=function(){return $localize(Xd||(Xd=Wg(["It is not your turn!"])))},e.NO_CLONING_FEATURE=function(){return $localize(Jd||(Jd=Wg(["You cannot clone a game. This feature might be implemented later."])))},e}(),ppe=function(){var e=function(){function e(t,n,r,i,a){gy(this,e),this.componentFactoryResolver=t,this.actRoute=n,this.connectedUserService=r,this.router=i,this.messageDisplayer=a,this.players=[NB.empty(),NB.empty()],this.role=J7.NONE,this.endGame=!1,this.Player=e9,AB(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}return my(e,[{key:"getMatchingComponent",value:function(t){return AB(e.VERBOSE,"GameWrapper.getMatchingComponent"),NB.ofNullable(Mve.ALL_GAMES().find(function(e){return e.urlName===t})).map(function(e){return e.component})}},{key:"afterGameIncluderViewInit",value:function(){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return AB(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),n.next=3,t.createGameComponent();case 3:return r=n.sent,n.abrupt("return",(r&&(t.gameComponent.rules.setInitialBoard(),t.gameComponent.updateBoard()),r));case 5:case"end":return n.stop()}},n)}))()}},{key:"createGameComponent",value:function(){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(AB(e.VERBOSE,"GameWrapper.createGameComponent"),r=IB.getNonNullable(t.actRoute.snapshot.paramMap.get("compo")),!(i=t.getMatchingComponent(r)).isAbsent()){n.next=6;break}return n.next=5,t.router.navigate(["/notFound",vpe.NO_MATCHING_GAME(r)],{skipLocationChange:!0});case 5:return n.abrupt("return",!1);case 6:return F7(null!=t.gameIncluder,"GameIncluder should be present"),a=t.componentFactoryResolver.resolveComponentFactory(i.get()),o=t.gameIncluder.viewContainerRef.createComponent(a),n.abrupt("return",(t.gameComponent=o.instance,t.gameComponent.chooseMove=function(e,n,r){return t.receiveValidMove(e,n,r)},t.gameComponent.canUserPlay=function(e){return t.onUserClick(e)},t.gameComponent.isPlayerTurn=function(){return t.isPlayerTurn()},t.gameComponent.cancelMoveOnWrapper=function(e){t.onCancelMove(e)},t.setRole(t.role),t.canPass=t.gameComponent.canPass,!0));case 9:case"end":return n.stop()}},n)}))()}},{key:"setRole",value:function(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")")}},{key:"receiveValidMove",value:function(t,n,r){var i=this;return TB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(AB(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),i.isPlayerTurn()){a.next=2;break}return a.abrupt("return",UB.failure(vpe.NOT_YOUR_TURN()));case 2:if(!i.endGame){a.next=4;break}return a.abrupt("return",UB.failure($localize(ev||(ev=Wg(["The game has ended."])))));case 4:if(!(o=i.gameComponent.rules.isLegal(t,n)).isFailure()){a.next=9;break}a.t0=(i.gameComponent.cancelMove(o.getReason()),UB.ofFallible(o)),a.next=14;break;case 9:return i.gameComponent.cancelMoveAttempt(),a.next=12,i.onLegalUserMove(t,r);case 12:AB(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),a.t0=UB.SUCCESS;case 14:return a.abrupt("return",a.t0);case 15:case"end":return a.stop()}},a)}))()}},{key:"onUserClick",value:function(e){if(this.role===J7.NONE){var t=vpe.NO_CLONING_FEATURE();return UB.failure(t)}return this.isPlayerTurn()?UB.SUCCESS:UB.failure(vpe.NOT_YOUR_TURN())}},{key:"onCancelMove",value:function(e){}},{key:"isPlayerTurn",value:function(){if(this.role===J7.NONE||null==this.gameComponent)return!1;var t=this.gameComponent.getTurn(),n=t%2,r=this.getPlayer();return AB(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,player:r,observer:this.role,areYouPlayer:this.players[n].isPresent()&&RB(this.players[n].get(),r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}},{key:"getBoardHighlight",value:function(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(IO),_P(KD),_P(G7),_P(yF),_P(D7))},e.\u0275cmp=vk({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;(1&e&&XT(dpe,5),2&e)&&(QT(n=JT())&&(t.gameIncluder=n.first))},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),gpe=function(){function e(t,n,r){gy(this,e),this.added=t,this.modified=n,this.removed=r}return my(e,[{key:"addNewKeys",value:function(e,t){var n,r=dy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!=t[i]&&(this.added[i]=t[i])}}catch(a){r.e(a)}finally{r.f()}}},{key:"addCommonKeys",value:function(e,t,n){var r,i=dy(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.addCommonKey(a,n[a],t[a])}}catch(o){i.e(o)}finally{i.f()}}},{key:"addCommonKey",value:function(t,n,r){if(null==r)null!=n&&(this.removed[t]=n);else if(null==n)this.added[t]=r;else if(["string","boolean","number"].includes(typeof n))n!==r&&(this.modified[t]=r);else if(Array.isArray(n)){if(!Array.isArray(r))throw new Error("Thing should not change type");n.length===r.length?this.addCommonKeyList(t,n,r):this.modified[t]=r}else{F7("object"==typeof n,"ObjectDifference: expected JSON, but got a ".concat(typeof n," in ").concat(t)),F7("object"==typeof r,"ObjectDifference: expected JSON, but got a ".concat(typeof r," in ").concat(t));var i=e.from(n,r);i.countChanges()>0&&(this.modified[t]=i)}}},{key:"addCommonKeyList",value:function(t,n,r){for(var i=!0,a=0;i&&a<n.length;a++)typeof n[a]==typeof r[a]&&"object"==typeof n[a]?e.differs(n[a],r[a])&&(i=!1,this.modified[t]=r):n[a]!==r[a]&&(i=!1,this.modified[t]=r)}},{key:"addRemovedKeys",value:function(e,t){var n,r=dy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.removed[i]=t[i]}}catch(a){r.e(a)}finally{r.f()}}},{key:"countChanges",value:function(){var e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}},{key:"isPresent",value:function(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}],[{key:"from",value:function(t,n){var r=new e({},{},{});if(null==t)return r.added=Yg({},n),r;if(null==n)return r.removed=Yg({},t),r;var i=Object.keys(t),a=Object.keys(n),o=i.filter(function(e){return!1===a.includes(e)}),s=i.filter(function(e){return a.includes(e)}),u=a.filter(function(e){return!1===i.includes(e)});return r.addNewKeys(u,n),r.addCommonKeys(s,n,t),r.addRemovedKeys(o,t),r}},{key:"differs",value:function(t,n){return e.from(t,n).countChanges()>0}}]),e}();function ype(e){return 1e3*e.seconds+e.nanoseconds/1e6}function mpe(e,t){return ype(t)-ype(e)}function kpe(e){return jy(function(t,n){lm(e).subscribe(new Yy(n,function(){return n.complete()},Iy)),!n.closed&&t.subscribe(n)})}var Cpe=function(){var e=function(){function e(){gy(this,e)}return my(e,[{key:"transform",value:function(e){var t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize(tv||(tv=Wg([""," hours"])),r)):1===r&&i.push($localize(nv||(nv=Wg(["1 hour"])))),n>1?i.push($localize(rv||(rv=Wg([""," minutes"])),n)):1===n&&i.push($localize(iv||(iv=Wg(["1 minute"])))),t>1?i.push($localize(av||(av=Wg([""," seconds"])),t)):1===t&&i.push($localize(ov||(ov=Wg(["1 second"])))),0===i.length)return $localize(sv||(sv=Wg(["0 seconds"])));if(1===i.length)return i[0];var a=i.slice(0,-1).join(", "),o=i.slice(-1)[0];return $localize(uv||(uv=Wg([""," and ",""])),a,o)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=wk({name:"humanDuration",type:e,pure:!0}),e}();function wpe(e,t){if(1&e&&(TP(0),uS(1),IP()),2&e){var n=LP(3);BE(1),cS(n.viewInfo.chosenOpponent)}}function _pe(e,t){1&e&&gO(0,44)}function Epe(e,t){if(1&e&&(PP(0,"div",45),PP(1,"div",8),PP(2,"label",46),TP(3),gO(4,47),IP(),PP(5,"output"),uS(6),NT(7,"humanDuration"),SP(),SP(),PP(8,"div",37),OP(9,"input",48),SP(),SP(),PP(10,"div",8),PP(11,"label",49),vO(12,50),OP(13,"output"),NT(14,"humanDuration"),pO(),SP(),PP(15,"div",37),OP(16,"input",51),SP(),SP(),SP()),2&e){var n=LP(3);BE(6),cS(DT(7,2,n.viewInfo.maximalMoveDuration||0)),BE(8),yO(DT(14,4,n.viewInfo.totalPartDuration||0)),mO(12)}}function bpe(e,t){1&e&&(PP(0,"div"),vO(1,52),OP(2,"br"),pO(),SP())}function Ppe(e,t){1&e&&(PP(0,"button",64),gO(1,65),SP())}function Spe(e,t){if(1&e){var n=AP();PP(0,"tr",60),RP("click",function(){var e=aC(n).$implicit;return LP(4).selectOpponent(e)}),PP(1,"td",61),uS(2),SP(),PP(3,"td",62),CP(4,Ppe,2,0,"button",63),SP(),SP()}if(2&e){var r=t.$implicit,i=LP(4);UP("id","presenceOf_",r,""),EP("ngClass",i.viewInfo.candidateClasses[r]),BE(1),EP("id",i.viewInfo.chosenOpponent===r?"selected_"+r:"candidate_"+r),BE(1),cS(r),BE(2),EP("ngIf",i.viewInfo.chosenOpponent!==r)}}function Ope(e,t){if(1&e&&(TP(0),gO(1,53),IP(),PP(2,"div",54),PP(3,"table",55),PP(4,"thead"),PP(5,"tr"),PP(6,"th",56),gO(7,57),SP(),PP(8,"th",56),gO(9,58),SP(),SP(),SP(),PP(10,"tbody"),CP(11,Spe,5,5,"tr",59),SP(),SP(),SP()),2&e){var n=LP(3);BE(11),EP("ngForOf",n.viewInfo.candidates)}}function Tpe(e,t){if(1&e){var n=AP();PP(0,"button",66),RP("click",function(){return aC(n),LP(3).changeConfig()}),gO(1,67),SP()}}function Ipe(e,t){if(1&e){var n=AP();PP(0,"div"),PP(1,"h1",4),gO(2,5),SP(),PP(3,"form",6),PP(4,"fieldset",7),PP(5,"div",8),PP(6,"label",9),gO(7,10),SP(),PP(8,"div",11),PP(9,"button",12),RP("click",function(){return aC(n),LP(2).selectFirstPlayer("RANDOM")}),gO(10,13),SP(),PP(11,"button",14),RP("click",function(){return aC(n),LP(2).selectFirstPlayer("CREATOR")}),gO(12,15),SP(),PP(13,"button",16),RP("click",function(){return aC(n),LP(2).selectFirstPlayer("CHOSEN_PLAYER")}),CP(14,wpe,2,1,"ng-container",17),CP(15,_pe,1,0,"ng-template",null,18,tI),SP(),SP(),SP(),PP(17,"div",8),PP(18,"label",9),gO(19,19),SP(),PP(20,"div",11),PP(21,"div",20),RP("click",function(){return aC(n),LP(2).selectPartType("STANDARD")}),PP(22,"div",21),PP(23,"span"),gO(24,22),SP(),SP(),PP(25,"div",23),PP(26,"div",24),PP(27,"div",25),PP(28,"p"),TP(29),gO(30,26),IP(),PP(31,"strong"),uS(32),NT(33,"humanDuration"),SP(),OP(34,"br"),TP(35),vO(36,27),OP(37,"strong"),NT(38,"humanDuration"),pO(),IP(),SP(),SP(),SP(),SP(),SP(),PP(39,"div",28),RP("click",function(){return aC(n),LP(2).selectPartType("BLITZ")}),PP(40,"div",21),PP(41,"span"),gO(42,29),SP(),SP(),PP(43,"div",23),PP(44,"div",24),PP(45,"div",25),PP(46,"p"),TP(47),gO(48,30),IP(),PP(49,"strong"),uS(50),NT(51,"humanDuration"),SP(),OP(52,"br"),TP(53),vO(54,31),OP(55,"strong"),NT(56,"humanDuration"),pO(),IP(),SP(),SP(),SP(),SP(),SP(),PP(57,"button",32),RP("click",function(){return aC(n),LP(2).selectPartType("CUSTOM")}),gO(58,33),SP(),SP(),SP(),CP(59,Epe,17,6,"div",34),PP(60,"div",8),PP(61,"label",35),gO(62,36),SP(),PP(63,"div",37),CP(64,bpe,3,0,"div",17),CP(65,Ope,12,1,"ng-template",null,38,tI),SP(),SP(),SP(),PP(67,"div",8),PP(68,"div",11),PP(69,"button",39),RP("click",function(){return aC(n),LP(2).proposeConfig()}),gO(70,40),SP(),CP(71,Tpe,2,0,"button",41),PP(72,"button",42),RP("click",function(){return aC(n),LP(2).cancelGameCreation()}),gO(73,43),SP(),SP(),SP(),SP(),SP()}if(2&e){var r=wP(16),i=wP(66),a=LP(2);BE(3),EP("formGroup",a.configFormGroup),BE(1),EP("disabled",!a.viewInfo.canEditConfig),BE(5),EP("ngClass",a.viewInfo.firstPlayerClasses.RANDOM),BE(2),EP("ngClass",a.viewInfo.firstPlayerClasses.CREATOR),BE(2),EP("ngClass",a.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),BE(1),EP("ngIf",a.viewInfo.chosenOpponent)("ngIfElse",r),BE(7),EP("ngClass",a.viewInfo.partTypeClasses.STANDARD),BE(11),cS(DT(33,19,a.partType.NORMAL_MOVE_DURATION)),BE(6),yO(DT(38,21,a.partType.NORMAL_PART_DURATION)),mO(36),BE(1),EP("ngClass",a.viewInfo.partTypeClasses.BLITZ),BE(11),cS(DT(51,23,a.partType.BLITZ_MOVE_DURATION)),BE(6),yO(DT(56,25,a.partType.BLITZ_PART_DURATION)),mO(54),BE(1),EP("ngClass",a.viewInfo.partTypeClasses.CUSTOM),BE(2),EP("ngIf",a.viewInfo.showCustomTime),BE(5),EP("ngIf",0===a.viewInfo.candidates.length)("ngIfElse",i),BE(5),EP("disabled",!a.viewInfo.canProposeConfig),BE(2),EP("ngIf",a.viewInfo.canReviewConfig)}}function Ape(e,t){if(1&e&&(PP(0,"div",74),PP(1,"p"),vO(2,75),OP(3,"br"),pO(),SP(),SP()),2&e){var n=LP(3);BE(3),yO(n.viewInfo.creator),mO(2)}}function Mpe(e,t){if(1&e&&(PP(0,"span"),gO(1,81),SP()),2&e){var n=LP(4);BE(1),yO(n.viewInfo.creator),mO(1)}}function xpe(e,t){1&e&&(PP(0,"span"),gO(1,82),SP())}function Rpe(e,t){1&e&&(PP(0,"span"),gO(1,83),SP())}function Npe(e,t){if(1&e){var n=AP();PP(0,"div",74),PP(1,"p"),gO(2,76),SP(),PP(3,"ul"),PP(4,"li"),CP(5,Mpe,2,1,"span",2),CP(6,xpe,2,0,"span",2),CP(7,Rpe,2,0,"span",2),SP(),PP(8,"li"),vO(9,77),OP(10,"strong"),NT(11,"humanDuration"),pO(),SP(),PP(12,"li"),vO(13,78),OP(14,"strong"),NT(15,"humanDuration"),pO(),SP(),SP(),PP(16,"button",79),RP("click",function(){return aC(n),LP(3).acceptConfig()}),gO(17,80),SP(),SP()}if(2&e){var r=LP(3);BE(2),yO(r.viewInfo.creator)(r.viewInfo.partTypeName),mO(2),BE(3),EP("ngIf","CREATOR"===r.viewInfo.firstPlayer),BE(1),EP("ngIf","CHOSEN_PLAYER"===r.viewInfo.firstPlayer),BE(1),EP("ngIf","RANDOM"===r.viewInfo.firstPlayer),BE(4),yO(DT(11,7,r.viewInfo.maximalMoveDuration||0)),mO(9),BE(4),yO(DT(15,9,r.viewInfo.totalPartDuration||0)),mO(13)}}function Dpe(e,t){if(1&e&&(PP(0,"div"),PP(1,"div",68),PP(2,"div",69),PP(3,"p"),gO(4,70),SP(),SP(),PP(5,"div",71),CP(6,Ape,4,1,"div",72),CP(7,Npe,18,11,"ng-template",null,73,tI),SP(),SP(),SP()),2&e){var n=wP(8),r=LP(2);BE(6),EP("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Lpe(e,t){if(1&e&&(TP(0),gO(1,86),IP()),2&e){var n=LP(3);BE(1),yO(n.viewInfo.creator),mO(1)}}function Fpe(e,t){if(1&e&&gO(0,87),2&e){var n=LP(3);yO(n.viewInfo.creator)(n.viewInfo.chosenOpponent),mO(0)}}function Upe(e,t){if(1&e&&(PP(0,"div",68),PP(1,"div",69),PP(2,"p"),gO(3,84),SP(),SP(),PP(4,"div",71),PP(5,"p"),CP(6,Lpe,2,1,"ng-container",17),CP(7,Fpe,1,2,"ng-template",null,85,tI),SP(),SP(),SP()),2&e){var n=wP(8),r=LP(2);BE(6),EP("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Vpe(e,t){if(1&e&&(PP(0,"div",1),CP(1,Ipe,74,27,"div",2),CP(2,Dpe,9,2,"div",2),CP(3,Upe,9,2,"div",3),SP()),2&e){var n=LP();BE(1),EP("ngIf",n.viewInfo.userIsCreator),BE(1),EP("ngIf",n.viewInfo.userIsChosenOpponent),BE(1),EP("ngIf",n.viewInfo.userIsObserver)}}var Bpe=function(){function e(t,n,r,i,a,o,s,u){gy(this,e),this.router=t,this.connectedUserService=n,this.gameService=r,this.configRoomService=i,this.chatService=a,this.userService=o,this.formBuilder=s,this.messageDisplayer=u,this.partType=W7,this.gameStartNotification=new VT,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new Zy,this.allUserInterval=NB.empty(),this.ownTokenInterval=NB.empty(),this.selfSubscription=new yy,this.configRoomSubscription=new yy,this.candidatesSubscription=new yy,this.allDocDeleted=!1,AB(e.VERBOSE,"PartCreationComponent constructed")}return my(e,[{key:"ngOnInit",value:function(){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return AB(e.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms(),n.next=3,t.configRoomService.joinGame(t.partId);case 3:if(!(r=n.sent).isFailure()){n.next=9;break}i=r.getReason(),t.messageDisplayer.criticalMessage(i),n.next=16;break;case 9:return n.next=11,t.updateUserDocWithObservedPart();case 11:return n.next=13,t.startSendingPresenceTokens();case 13:t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),AB(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds");case 16:case"end":return n.stop()}},n)}))()}},{key:"checkInputs",value:function(){var e=this.connectedUserService.user;F7(e.isPresent()&&e.get()!==H7.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),F7(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}},{key:"createForms",value:function(){this.configFormGroup=this.formBuilder.group({firstPlayer:[q7.RANDOM.value,vx.required],maximalMoveDuration:[W7.NORMAL_MOVE_DURATION,vx.required],partType:["STANDARD",vx.required],totalPartDuration:[W7.NORMAL_PART_DURATION,vx.required],chosenOpponent:["",vx.required]})}},{key:"updateUserDocWithObservedPart",value:function(){return AB(e.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'"),this.connectedUserService.updateObservedPart(this.partId)}},{key:"subscribeToConfigRoomDoc",value:function(){var e,t=this,n=(e=TB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCurrentConfigRoomUpdate(n);case 2:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}),r=function(){var e=TB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCandidatesUpdate(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,n),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}},{key:"getForm",value:function(e){return IB.getNonNullable(this.configFormGroup.get(e))}},{key:"subscribeToFormElements",value:function(){var e=this;this.getForm("chosenOpponent").valueChanges.pipe(kpe(this.ngUnsubscribe)).subscribe(function(t){void 0!==e.viewInfo.chosenOpponent&&(e.viewInfo.candidateClasses[e.viewInfo.chosenOpponent]=[]),e.viewInfo.candidateClasses[t]=["is-selected"],e.viewInfo.chosenOpponent=t;var n=IB.getNonNullable(e.currentConfigRoom).partStatus;e.viewInfo.canProposeConfig=n!==j7.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(kpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.partTypeClasses[e.viewInfo.partType]=[],e.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],e.viewInfo.partType=t,e.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(kpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(kpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(kpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.firstPlayerClasses[e.viewInfo.firstPlayer]=[],e.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],e.viewInfo.firstPlayer=t})}},{key:"updateViewInfo",value:function(){var e,t,n=IB.getNonNullable(this.currentConfigRoom),r=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=n.partStatus===j7.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=n.partStatus!==j7.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=r.id===n.creator.id,this.viewInfo.userIsChosenOpponent=r.id===(null===(e=n.chosenOpponent)||void 0===e?void 0:e.id),this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=n.partStatus!==j7.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=n.creator.name,this.viewInfo.candidates=this.candidates.map(function(e){return e.name}),r.id===n.creator.id?this.setDataForCreator(n):(this.viewInfo.maximalMoveDuration=n.maximalMoveDuration,this.viewInfo.totalPartDuration=n.totalPartDuration,this.viewInfo.partType=n.partType,this.viewInfo.chosenOpponent=null===(t=n.chosenOpponent)||void 0===t?void 0:t.name,this.viewInfo.firstPlayer=n.firstPlayer),n.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize(cv||(cv=Wg(["custom"])));break;case"BLITZ":this.viewInfo.partTypeName=$localize(lv||(lv=Wg(["blitz"])));break;case"STANDARD":this.viewInfo.partTypeName=$localize(fv||(fv=Wg(["standard"])))}}},{key:"setDataForCreator",value:function(e){var t,n,r,i;this.viewInfo.maximalMoveDuration=null!==(t=this.viewInfo.maximalMoveDuration)&&void 0!==t?t:e.maximalMoveDuration,this.viewInfo.totalPartDuration=null!==(n=this.viewInfo.totalPartDuration)&&void 0!==n?n:e.totalPartDuration;var a=this.viewInfo.chosenOpponent;null==a||""===a?a=null!==(r=null===(i=e.chosenOpponent)||void 0===i?void 0:i.name)&&void 0!==r?r:"":!1===this.candidates.some(function(e){return e.name===a})&&(a=""),this.getForm("chosenOpponent").setValue(a)}},{key:"selectFirstPlayer",value:function(e){this.getForm("firstPlayer").setValue(e)}},{key:"selectPartType",value:function(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(W7.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(W7.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(W7.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(W7.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}},{key:"selectOpponent",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return AB(e.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")"),i=n.getUserFromName(t),r.abrupt("return",n.configRoomService.setChosenOpponent(n.partId,i));case 3:case"end":return r.stop()}},r)}))()}},{key:"getUserFromName",value:function(e){var t=this.candidates.find(function(t){return t.name===e});return IB.getNonNullable(t)}},{key:"changeConfig",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.configRoomService.reviewConfig(e.partId));case 1:case"end":return t.stop()}},t)}))()}},{key:"proposeConfig",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,a=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,s=e.getUserFromName(n),t.abrupt("return",e.configRoomService.proposeConfig(e.partId,s,W7.of(r),i,q7.of(a),o));case 2:case"end":return t.stop()}},t)}))()}},{key:"cancelGameCreation",value:function(){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.allDocDeleted=!0,n.next=3,t.connectedUserService.removeObservedPart();case 3:return AB(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),n.next=6,t.chatService.deleteChat(t.partId);case 6:return AB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),n.next=9,t.gameService.deletePart(t.partId);case 9:return AB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),n.next=12,t.configRoomService.deleteConfigRoom(t.partId,t.candidates);case 12:AB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted");case 13:case"end":return n.stop()}},n)}))()}},{key:"onCurrentConfigRoomUpdate",value:function(t){var n=this;return TB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(AB(e.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(n.currentConfigRoom),then:JSON.stringify(t)}}),!t.isAbsent()){r.next=2;break}return r.abrupt("return",(AB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),n.onGameCancelled()));case 2:if(n.chosenOpponentJustLeft(t.get())&&(i=IB.getNonNullable(n.currentConfigRoom),a=IB.getNonNullable(i.chosenOpponent).name,n.messageDisplayer.infoMessage($localize(hv||(hv=Wg([""," left the game, please pick another opponent."])),a))),n.currentConfigRoom=t.get(),r.t0=n.allUserInterval.isAbsent(),!r.t0){r.next=8;break}return r.next=8,n.observePlayers();case 8:n.updateViewInfo(),n.isGameStarted()&&(AB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),n.onGameStarted());case 10:case"end":return r.stop()}},r)}))()}},{key:"onCandidatesUpdate",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.candidates=e,t.updateViewInfo();case 1:case"end":return n.stop()}},n)}))()}},{key:"chosenOpponentJustLeft",value:function(e){return null!=this.currentConfigRoom&&null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent}},{key:"onGameCancelled",value:function(){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return AB(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize(dv||(dv=Wg(["The game has been canceled!"])))),n.next=4,t.router.navigate(["/lobby"]);case 4:case"end":return n.stop()}},n)}))()}},{key:"isGameStarted",value:function(){return IB.getNonNullable(this.currentConfigRoom).partStatus===j7.PART_STARTED.value}},{key:"onGameStarted",value:function(){var t=IB.getNonNullable(this.currentConfigRoom);AB(e.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,AB(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}},{key:"observePlayers",value:function(){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:F7(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),r=t.connectedUserService.user.get().id,t.allUserInterval=NB.of(window.setInterval(TB(regeneratorRuntime.mark(function e(){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=IB.getNonNullable(t.currentConfigRoom),i=t.lastToken,r!==n.creator.id){e.next=6;break}return e.next=4,t.checkCandidatesTokensFreshness(i);case 4:e.next=8;break;case 6:return e.next=8,t.checkCreatorTokenFreshness(i);case 8:case"end":return e.stop()}},e)})),e.TOKEN_INTERVAL));case 3:case"end":return n.stop()}},n)}))()}},{key:"checkCreatorTokenFreshness",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=IB.getNonNullable(t.currentConfigRoom),n.next=3,t.didUserTimeout(r.creator.id,e);case 3:if(n.t0=n.sent,!n.t0){n.next=7;break}return n.next=7,t.destroyDocIfPartDidNotStart();case 7:case"end":return n.stop()}},n)}))()}},{key:"destroyDocIfPartDidNotStart",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return F7(0==(IB.getNonNullable(e.currentConfigRoom).partStatus===j7.PART_STARTED.value),"Should not try to cancelGameCreation when part started!"),F7(!1===e.allDocDeleted,"Should not delete doc twice"),t.next=4,e.cancelGameCreation();case 4:case"end":return t.stop()}},t)}))()}},{key:"checkCandidatesTokensFreshness",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=dy(t.candidates),n.prev=1,r.s();case 3:if((i=r.n()).done){n.next=13;break}return a=i.value,n.next=7,t.didUserTimeout(a.id,e);case 7:if(n.t0=n.sent,!n.t0){n.next=11;break}return n.next=11,t.removeCandidateFromLobby(a);case 11:n.next=3;break;case 13:n.next=18;break;case 15:n.prev=15,n.t1=n.catch(1),r.e(n.t1);case 18:return n.prev=18,r.f(),n.finish(18);case 21:case"end":return n.stop()}},n,null,[[1,15,18,21]])}))()}},{key:"didUserTimeout",value:function(t,n){var r=this;return TB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.userService.getUserLastUpdateTime(t);case 2:return a=i.sent,i.abrupt("return",a.isAbsent()?(L7.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):mpe(a.get(),n)>e.TOKEN_TIMEOUT);case 4:case"end":return i.stop()}},i)}))()}},{key:"removeCandidateFromLobby",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=IB.getNonNullable(t.currentConfigRoom),n.t0=e.id===(null===(r=i.chosenOpponent)||void 0===r?void 0:r.id),!n.t0){n.next=5;break}return n.next=5,t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId);case 5:return n.abrupt("return",t.configRoomService.removeCandidate(t.partId,e));case 6:case"end":return n.stop()}},n)}))()}},{key:"startSendingPresenceTokens",value:function(){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.sendPresenceToken();case 2:F7(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=NB.of(window.setInterval(function(){t.connectedUserService.sendPresenceToken()},e.TOKEN_INTERVAL)),r=t.connectedUserService.user.get().id,t.selfSubscription=t.userService.observeUser(r,function(e){F7(e.isPresent(),"connected user should exist");var n=e.get();null!=n.lastUpdateTime&&(t.lastToken=n.lastUpdateTime)});case 6:case"end":return n.stop()}},n)}))()}},{key:"stopSendingPresenceTokensAndObservingUsersIfNeeded",value:function(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=NB.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}},{key:"acceptConfig",value:function(){return AB(e.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,IB.getNonNullable(this.currentConfigRoom))}},{key:"ngOnDestroy",value:function(){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(AB(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded(),r=t.connectedUserService.user.get(),n.t0=!0!==t.gameStarted,!n.t0){n.next=23;break}if(null!==t.currentConfigRoom){n.next=8;break}AB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"),n.next=23;break;case 8:if(!0!==t.allDocDeleted){n.next=12;break}AB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"),n.next=23;break;case 12:if(r.id!==t.currentConfigRoom.creator.id){n.next=18;break}return AB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),n.next=16,t.cancelGameCreation();case 16:n.next=23;break;case 18:return AB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),n.next=21,t.connectedUserService.removeObservedPart();case 21:return n.next=23,t.configRoomService.cancelJoining(t.partId);case 23:case"end":return n.stop()}},n)}))()}}]),e}();function zpe(e,t){if(1&e){var n=AP();PP(0,"button",3),RP("click",function(){return aC(n),LP().addTime()}),gO(1,4),SP()}if(2&e){var r=LP();BE(1),yO(r.timeToAdd),mO(1)}}Bpe.VERBOSE=!1,Bpe.TOKEN_INTERVAL=5e3,Bpe.TOKEN_TIMEOUT=2*Bpe.TOKEN_INTERVAL,Bpe.\u0275fac=function(e){return new(e||Bpe)(_P(yF),_P(G7),_P(c9),_P(u9),_P(x7),_P(V7),_P(zR),_P(D7))},Bpe.\u0275cmp=vk({type:Bpe,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){return[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],$localize(vv||(vv=Wg(["Game creation"]))),[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],$localize(pv||(pv=Wg(["First player"]))),[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],$localize(gv||(gv=Wg(["Random"]))),["id","firstPlayerCreator",1,"button",3,"ngClass","click"],$localize(yv||(yv=Wg(["You"]))),["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],$localize(mv||(mv=Wg(["Game type"]))),["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],$localize(kv||(kv=Wg(["Standard"]))),["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],$localize(Cv||(Cv=Wg(["Maximal turn duration: "]))),$localize(wv||(wv=Wg(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#37\ufffd","\ufffd0\ufffd","\ufffd/#37\ufffd"),["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],$localize(_v||(_v=Wg(["Blitz"]))),$localize(Ev||(Ev=Wg(["Maximal turn duration: "]))),$localize(bv||(bv=Wg(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#55\ufffd","\ufffd0\ufffd","\ufffd/#55\ufffd"),["id","partTypeCustom",1,"button",3,"ngClass","click"],$localize(Pv||(Pv=Wg(["Custom"]))),["id","customTime",4,"ngIf"],[1,"label"],$localize(Sv||(Sv=Wg(["Opponents"]))),[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],$localize(Ov||(Ov=Wg(["Propose configuration"]))),["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],$localize(Tv||(Tv=Wg(["Cancel game"]))),$localize(Iv||(Iv=Wg(["The opponent"]))),["id","customTime"],["for","maximalMoveDuration",1,"label"],$localize(Av||(Av=Wg(["Maximal turn duration: "]))),["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$localize(Mv||(Mv=Wg(["Maximal game duration: ",":START_TAG_OUTPUT:",":INTERPOLATION: per player",":CLOSE_TAG_OUTPUT:"])),"\ufffd#13\ufffd","\ufffd0\ufffd","\ufffd/#13\ufffd"),["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],$localize(xv||(xv=Wg(["Potential opponents that join the game will appear here.",":LINE_BREAK:Wait for an opponent to join, so that you can pick one."])),"\ufffd#2\ufffd\ufffd/#2\ufffd"),$localize(Rv||(Rv=Wg(["Click on the opponent against which you would like to play."]))),["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Nv||(Nv=Wg(["Name"]))),$localize(Dv||(Dv=Wg(["Actions"]))),[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],$localize(Lv||(Lv=Wg(["Pick"]))),["id","reviewConfig",1,"button",3,"click"],$localize(Fv||(Fv=Wg(["Change configuration"]))),[1,"message","is-primary"],[1,"message-header"],$localize(Uv||(Uv=Wg(["Configuration proposal"]))),[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],$localize(Vv||(Vv=Wg(["You have been selected as the opponent.",":LINE_BREAK: ",":INTERPOLATION: is modifying the configuration."])),"\ufffd#3\ufffd\ufffd/#3\ufffd","\ufffd0\ufffd"),$localize(Bv||(Bv=Wg(["",":INTERPOLATION: proposes to play a ",":INTERPOLATION_1: game"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(zv||(zv=Wg(["a turn lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: ",":CLOSE_TAG_STRONG:"])),"\ufffd#10\ufffd","\ufffd0\ufffd","\ufffd/#10\ufffd"),$localize(Hv||(Hv=Wg(["the game lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#14\ufffd","\ufffd0\ufffd","\ufffd/#14\ufffd"),["id","acceptConfig",1,"button","is-primary",3,"click"],$localize(Gv||(Gv=Wg(["Accept and start"]))),$localize($v||($v=Wg(["",":INTERPOLATION: plays first"])),"\ufffd0\ufffd"),$localize(Zv||(Zv=Wg(["you play first"]))),$localize(qv||(qv=Wg(["the first player is selected randomly"]))),$localize(Wv||(Wv=Wg(["One moment..."]))),["proposalSent",""],$localize(jv||(jv=Wg(["",":INTERPOLATION: is configuring the game."])),"\ufffd0\ufffd"),$localize(Yv||(Yv=Wg(["",":INTERPOLATION: has proposed a configuration to ",":INTERPOLATION_1:."])),"\ufffd0\ufffd","\ufffd1\ufffd")]},template:function(e,t){1&e&&CP(0,Vpe,4,3,"div",0),2&e&&EP("ngIf",t.viewInfo)},directives:[sM,yR,Vx,ER,rM,ux,CR,Ux,PR,aM],pipes:[Cpe],encapsulation:2});var Hpe=function(){var e=function(){function e(){gy(this,e),this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new VT,this.addTimeToOpponent=new VT,this.cssClasses=e.SAFE_TIME}return my(e,[{key:"ngOnInit",value:function(){AB(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}},{key:"setDuration",value:function(t){if(AB(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}},{key:"changeDuration",value:function(e){var t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}},{key:"displayDuration",value:function(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}},{key:"start",value:function(){if(AB(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}},{key:"resume",value:function(){var t=this;if(AB(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();var n=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(function(){t.onEndReached()},n),this.countSeconds()}},{key:"onEndReached",value:function(){AB(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}},{key:"countSeconds",value:function(){var e=this;this.timeoutHandleSec=window.setTimeout(function(){e.updateShownTime()},1e3)}},{key:"isIdle",value:function(){return!1===this.started||this.isPaused}},{key:"pause",value:function(){if(AB(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}},{key:"stop",value:function(){if(AB(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}},{key:"isStarted",value:function(){return this.started}},{key:"getTimeClass",value:function(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}},{key:"updateShownTime",value:function(){var e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}},{key:"clearTimeouts",value:function(){AB(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}},{key:"addTime",value:function(){this.addTimeToOpponent.emit()}},{key:"ngOnDestroy",value:function(){this.clearTimeouts()}}]),e}();return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=vk({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){return[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],$localize(Kv||(Kv=Wg(["Add ",":INTERPOLATION:"])),"\ufffd0\ufffd")]},template:function(e,t){1&e&&(PP(0,"div",0),PP(1,"p",1),uS(2),NT(3,"number"),SP(),CP(4,zpe,2,1,"button",2),SP()),2&e&&(EP("ngClass",t.getTimeClass()),BE(2),fS("",t.displayedMinute,":",function(e,t,n,r){var i=e+20,a=rC(),o=jk(a,i);return FT(a,LT(a,i)?function(e,t,n,r,i,a,o){var s=t+n;return vP(e,s,i,a)?hP(e,s+2,o?r.call(o,i,a):r(i,a)):xT(e,s+2)}(a,vC(),t,o.transform,n,r,o):o.transform(n,r))}(3,4,t.displayedSec,"2.0-0"),""),BE(2),EP("ngIf",t.canAddTime))},directives:[rM,sM],pipes:[lM],encapsulation:2}),e}(),Gpe=["partCreation"],$pe=["chatComponent"],Zpe=["chronoZeroGlobal"],qpe=["chronoOneGlobal"],Wpe=["chronoZeroTurn"],jpe=["chronoOneTurn"];function Ype(e,t){if(1&e){var n=AP();PP(0,"app-part-creation",5,6),RP("gameStartNotification",function(e){return aC(n),LP().startGame(e)}),SP()}2&e&&EP("partId",LP().currentPartId)}function Kpe(e,t){1&e&&(TP(0),gO(1,40),IP())}function Qpe(e,t){if(1&e&&(TP(0),gO(1,41),IP()),2&e){var n=LP(4);BE(1),yO(null==n.currentPlayer?null:n.currentPlayer.name),mO(1)}}function Xpe(e,t){if(1&e&&(PP(0,"p",37),CP(1,Kpe,2,0,"ng-container",38),CP(2,Qpe,2,1,"ng-template",null,39,tI),SP()),2&e){var n=wP(3),r=LP(3);BE(1),EP("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",n)}}function Jpe(e,t){if(1&e&&(PP(0,"div",33),PP(1,"p",34),gO(2,35),SP(),CP(3,Xpe,4,2,"p",36),SP()),2&e){var n=LP(2);BE(2),yO(n.currentPart.getTurn()+1),mO(2),BE(1),EP("ngIf",!1===n.endGame)}}function ege(e,t){if(1&e&&(PP(0,"p",42),uS(1),SP()),2&e){var n=LP(2);EP("ngClass",n.getPlayerNameClass(n.Player.ZERO)),BE(1),cS(n.players[0].get().name)}}function tge(e,t){if(1&e&&(PP(0,"p",43),gO(1,44),SP()),2&e){var n=LP(2);BE(1),yO(n.gameComponent.scores.get()[0]),mO(1)}}function nge(e,t){if(1&e&&(PP(0,"p",45),uS(1),SP()),2&e){var n=LP(2);EP("ngClass",n.getPlayerNameClass(n.Player.ONE)),BE(1),cS(n.players[1].get().name)}}function rge(e,t){if(1&e&&(PP(0,"p",46),gO(1,47),SP()),2&e){var n=LP(2);BE(1),yO(n.gameComponent.scores.get()[1]),mO(1)}}function ige(e,t){if(1&e){var n=AP();PP(0,"button",56),RP("click",function(){return aC(n),LP(3).resign()}),gO(1,57),SP()}}function age(e,t){if(1&e){var n=AP();PP(0,"button",58),RP("click",function(){return aC(n),LP(3).proposeDraw()}),gO(1,59),SP()}}function oge(e,t){if(1&e){var n=AP();PP(0,"button",60),RP("click",function(){return aC(n),LP(3).acceptDraw()}),gO(1,61),SP()}}function sge(e,t){if(1&e){var n=AP();PP(0,"button",62),RP("click",function(){return aC(n),LP(3).refuseDraw()}),gO(1,63),SP()}}function uge(e,t){if(1&e){var n=AP();PP(0,"button",64),RP("click",function(){return aC(n),LP(3).gameComponent.pass()}),gO(1,65),SP()}}function cge(e,t){if(1&e){var n=AP();PP(0,"button",66),RP("click",function(){return aC(n),LP(3).acceptTakeBack()}),gO(1,67),SP()}}function lge(e,t){if(1&e){var n=AP();PP(0,"button",68),RP("click",function(){return aC(n),LP(3).refuseTakeBack()}),gO(1,69),SP()}}function fge(e,t){if(1&e){var n=AP();PP(0,"button",70),RP("click",function(){return aC(n),LP(3).askTakeBack()}),gO(1,71),SP()}}function hge(e,t){if(1&e&&(TP(0),CP(1,ige,2,0,"button",48),CP(2,age,2,0,"button",49),CP(3,oge,2,0,"button",50),CP(4,sge,2,0,"button",51),CP(5,uge,2,0,"button",52),CP(6,cge,2,0,"button",53),CP(7,lge,2,0,"button",54),CP(8,fge,2,0,"button",55),IP()),2&e){var n=LP(2);BE(1),EP("ngIf",n.canResign()),BE(1),EP("ngIf",n.canProposeDraw()),BE(1),EP("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),BE(1),EP("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),BE(1),EP("ngIf",!1===n.endGame&&n.isPlaying()&&n.gameComponent.canPass&&(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name),BE(1),EP("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),BE(1),EP("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),BE(1),EP("ngIf",!1===n.endGame&&!1===n.isOpponentWaitingForTakeBackResponse()&&n.canAskTakeBack())}}function dge(e,t){1&e&&(PP(0,"div"),PP(1,"p",73),gO(2,74),SP(),SP())}function vge(e,t){1&e&&(PP(0,"p",78),gO(1,79),SP())}function pge(e,t){1&e&&(PP(0,"p",80),gO(1,81),SP())}function gge(e,t){1&e&&(PP(0,"p",82),gO(1,83),SP())}function yge(e,t){if(1&e&&(PP(0,"div"),CP(1,vge,2,0,"p",75),CP(2,pge,2,0,"p",76),CP(3,gge,2,0,"p",77),SP()),2&e){var n=LP(3);BE(1),EP("ngIf",n.currentPart.getDrawAccepter().name===n.getPlayer().name),BE(1),EP("ngIf",n.currentPart.getDrawAccepter().name!==n.getPlayer().name&&n.isPlaying()),BE(1),EP("ngIf",!1===n.isPlaying())}}function mge(e,t){1&e&&(PP(0,"p",86),gO(1,87),SP())}function kge(e,t){1&e&&(PP(0,"p",88),gO(1,89),SP())}function Cge(e,t){if(1&e&&(PP(0,"p",88),gO(1,90),SP()),2&e){var n=LP(4);BE(1),yO(n.currentPart.getWinner().get().name),mO(1)}}function wge(e,t){if(1&e&&(PP(0,"div"),CP(1,mge,2,0,"p",84),CP(2,kge,2,0,"p",85),CP(3,Cge,2,1,"p",85),SP()),2&e){var n=LP(3);BE(1),EP("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),BE(1),EP("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),BE(1),EP("ngIf",!1===n.isPlaying())}}function _ge(e,t){if(1&e&&(PP(0,"p",86),gO(1,91),SP()),2&e){var n=LP(4);BE(1),yO(n.currentPart.getLoser().get().name),mO(1)}}function Ege(e,t){1&e&&(PP(0,"p",88),gO(1,92),SP())}function bge(e,t){if(1&e&&(PP(0,"p",88),gO(1,93),SP()),2&e){var n=LP(4);BE(1),yO(n.currentPart.getLoser().get().name),mO(1)}}function Pge(e,t){if(1&e&&(PP(0,"div"),CP(1,_ge,2,1,"p",84),CP(2,Ege,2,0,"p",85),CP(3,bge,2,1,"p",85),SP()),2&e){var n=LP(3);BE(1),EP("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),BE(1),EP("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),BE(1),EP("ngIf",!1===n.isPlaying())}}function Sge(e,t){1&e&&(PP(0,"p",95),gO(1,96),SP())}function Oge(e,t){if(1&e&&(PP(0,"p",95),gO(1,97),SP()),2&e){var n=LP(4);BE(1),yO(n.currentPart.getLoser().get().name),mO(1)}}function Tge(e,t){if(1&e&&(PP(0,"div"),CP(1,Sge,2,0,"p",94),CP(2,Oge,2,1,"p",94),SP()),2&e){var n=LP(3);BE(1),EP("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),BE(1),EP("ngIf",!1===n.isPlaying()||n.currentPart.getWinner().get().name===n.getPlayer().name)}}function Ige(e,t){if(1&e&&(PP(0,"div",72),OP(1,"hr"),CP(2,dge,3,0,"div",26),CP(3,yge,4,3,"div",26),CP(4,wge,4,3,"div",26),CP(5,Pge,4,3,"div",26),CP(6,Tge,3,2,"div",26),SP()),2&e){var n=LP(2);BE(2),EP("ngIf",n.currentPart.isHardDraw()),BE(1),EP("ngIf",n.currentPart.isAgreedDraw()),BE(1),EP("ngIf",n.currentPart.isWin()),BE(1),EP("ngIf",n.currentPart.isTimeout()),BE(1),EP("ngIf",n.currentPart.isResign())}}function Age(e,t){1&e&&(PP(0,"button",98),gO(1,99),SP())}function Mge(e,t){if(1&e){var n=AP();PP(0,"button",100),RP("click",function(){return aC(n),LP(2).proposeRematch()}),gO(1,101),SP()}}function xge(e,t){if(1&e){var n=AP();PP(0,"button",102),RP("click",function(){return aC(n),LP(2).acceptRematch()}),gO(1,103),SP()}}function Rge(e,t){if(1&e){var n=AP();PP(0,"div",7),PP(1,"div",8),PP(2,"div",9),CP(3,Jpe,4,2,"div",10),PP(4,"div",11),CP(5,ege,2,2,"p",12),CP(6,tge,2,1,"p",13),PP(7,"app-count-down",14,15),RP("outOfTimeAction",function(){aC(n);var e=LP();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return aC(n),LP().addGlobalTime()}),SP(),PP(9,"app-count-down",16,17),RP("outOfTimeAction",function(){aC(n);var e=LP();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return aC(n),LP().addTurnTime()}),SP(),SP(),PP(11,"p",18),gO(12,19),SP(),PP(13,"div",11),CP(14,nge,2,2,"p",20),CP(15,rge,2,1,"p",21),PP(16,"app-count-down",22,23),RP("outOfTimeAction",function(){aC(n);var e=LP();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return aC(n),LP().addGlobalTime()}),SP(),PP(18,"app-count-down",24,25),RP("outOfTimeAction",function(){aC(n);var e=LP();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return aC(n),LP().addTurnTime()}),SP(),SP(),OP(20,"hr"),CP(21,hge,9,8,"ng-container",26),CP(22,Ige,7,5,"div",27),CP(23,Age,2,0,"button",28),CP(24,Mge,2,0,"button",29),CP(25,xge,2,0,"button",30),SP(),SP(),PP(26,"div",31),PP(27,"div",32),OP(28,"app-game-includer"),SP(),SP(),SP()}if(2&e){var r=LP();BE(3),EP("ngIf",r.currentPart),BE(2),EP("ngIf",r.players[0].isPresent()),BE(1),EP("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),BE(1),EP("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.role===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),BE(2),EP("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.role===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),BE(5),EP("ngIf",r.players[1].isPresent()),BE(1),EP("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),BE(1),EP("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.role===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),BE(2),EP("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.role===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),BE(3),EP("ngIf",r.isPlaying()),BE(1),EP("ngIf",r.endGame),BE(1),EP("ngIf",r.endGame),BE(1),EP("ngIf",r.endGame&&r.isPlaying()&&!1===r.rematchProposed),BE(1),EP("ngIf",r.endGame&&r.isPlaying()&&r.rematchProposed&&r.opponentProposedRematch),BE(1),EP("ngClass",r.getBoardHighlight())}}var Nge=function(){var e=my(function e(){gy(this,e)});return e.NO_MATCHING_PART=function(){return $localize(Qv||(Qv=Wg(["The game you tried to join does not exist."])))},e}(),Dge=my(function e(t){gy(this,e),this.value=t});Dge.PRE_START_DOC=new Dge("PRE_START_DOC"),Dge.STARTING_DOC=new Dge("STARTING_DOC"),Dge.DUPLICATE=new Dge("DUPLICATE"),Dge.MOVE_WITHOUT_TIME=new Dge("MOVE_WITHOUT_TIME"),Dge.MOVE=new Dge("MOVE"),Dge.REQUEST=new Dge("REQUEST"),Dge.END_GAME=new Dge("END_GAME"),Dge.END_GAME_WITHOUT_TIME=new Dge("END_GAME_WITHOUT_TIME"),Dge.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Dge("ACCEPT_TAKE_BACK_WITHOUT_TIME");var Lge=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s,u){var c;return gy(this,n),(c=t.call(this,e,r,o,i,a)).userService=s,c.gameService=u,c.gameStarted=!1,c.opponent=null,c.rematchProposed=!1,c.opponentProposedRematch=!1,c.hasUserPlayed=[!1,!1],c.msToSubstract=[0,0],c.opponentSubscription=new yy,c.partSubscription=new yy,c.OFFLINE_FONT_COLOR={color:"lightgrey"},c.globalTimeMessage=$localize(Xv||(Xv=Wg(["5 minutes"]))),c.turnTimeMessage=$localize(Jv||(Jv=Wg(["30 seconds"]))),AB(n.VERBOSE,"OnlineGameWrapperComponent constructed"),c}return my(n,[{key:"extractPartIdFromURL",value:function(){return IB.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}},{key:"extractGameNameFromURL",value:function(){return IB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}},{key:"isPlaying",value:function(){return this.role.isPlayer()}},{key:"getPlayer",value:function(){return this.authUser.toMinimalUser()}},{key:"isPlayer",value:function(e){return this.role===e}},{key:"isOpponent",value:function(e){return this.role!==e}},{key:"redirectIfPartOrGameIsInvalid",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.extractGameNameFromURL(),!Mve.ALL_GAMES().some(function(e){return e.urlName===n})){t.next=11;break}return t.next=4,e.gameService.getPartValidity(e.currentPartId,n);case 4:if(!t.sent.isFailure()){t.next=9;break}return e.routerEventsSub.unsubscribe(),r=Nge.NO_MATCHING_PART(),t.next=9,e.router.navigate(["/notFound",r],{skipLocationChange:!0});case 9:t.next=15;break;case 11:return e.routerEventsSub.unsubscribe(),i=vpe.NO_MATCHING_GAME(n),t.next=15,e.router.navigate(["/notFound",i],{skipLocationChange:!0});case 15:case"end":return t.stop()}},t)}))()}},{key:"setCurrentPartIdOrRedirect",value:function(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}},{key:"ngOnInit",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return AB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSub=e.router.events.subscribe(function(){var t=TB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n instanceof $N,!t.t0){t.next=4;break}return t.next=4,e.setCurrentPartIdOrRedirect();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.userSub=e.connectedUserService.subscribeToUser(function(t){e.authUser=t}),t.next=5,e.setCurrentPartIdOrRedirect();case 5:AB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done");case 6:case"end":return t.stop()}},t)}))()}},{key:"startGame",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:AB(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),F7(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(TB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=F7,e.next=3,t.afterGameIncluderViewInit();case 3:e.t1=e.sent,(0,e.t0)(e.t1,"Game should be created successfully, otherwise part-creation would have redirected"),t.startPart();case 6:case"end":return e.stop()}},e)})),1);case 1:case"end":return r.stop()}},r)}))()}},{key:"startPart",value:function(){var e,t=this;AB(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,(e=TB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return F7(n.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.next=3,t.onCurrentPartUpdate(n.get());case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"onCurrentPartUpdate",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new Z7(t.currentPartId,e),AB(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:t.currentPart,then:e.data,before_part_turn:i.data.turn,before_state_turn:t.gameComponent.getTurn(),nbPlayedMoves:i.data.listMoves.length}}),a=t.getUpdateType(i),o=e.turn,AB(n.VERBOSE,a===Dge.REQUEST?"UpdateType: Request("+IB.getNonNullable(i.data.request).code+") ("+o+")":"UpdateType: "+a.value+"("+o+")"),s=t.currentPart,r.t0=(t.currentPart=i,a),r.next=r.t0===Dge.REQUEST?8:r.t0===Dge.ACCEPT_TAKE_BACK_WITHOUT_TIME?11:r.t0===Dge.DUPLICATE?12:r.t0===Dge.END_GAME_WITHOUT_TIME?13:r.t0===Dge.END_GAME?14:r.t0===Dge.MOVE_WITHOUT_TIME?15:r.t0===Dge.MOVE?16:r.t0===Dge.PRE_START_DOC?17:19;break;case 8:return r.next=10,t.onRequest(IB.getNonNullable(i.data.request),s);case 10:return r.abrupt("return",r.sent);case 11:case 13:case 15:return r.abrupt("return",void(t.currentPart=s));case 12:return r.abrupt("return");case 14:return r.abrupt("return",t.applyEndGame());case 16:return r.abrupt("return",(t.msToSubstract=t.getLastUpdateTime(s,i,a),t.doNewMoves(i)));case 17:return u=null==t.currentPart||null!=t.currentPart.data.beginning,r.abrupt("return",void F7(null==s||null==s.data.beginning||u,"old part had no beginning time or new part has, we did not expect this!"));case 19:return r.abrupt("return",(F7(a===Dge.STARTING_DOC,"Unexpected update type "+a),t.setChronos(),t.setPlayersDatas(i),t.startCountDownFor(e9.ZERO)));case 20:case"end":return r.stop()}},r)}))()}},{key:"getUpdateType",value:function(e){var t=gpe.from(null!=this.currentPart?this.currentPart.data:null,e.data);AB(n.VERBOSE,{diff:t});var r=t.countChanges();if(0===r)return Dge.DUPLICATE;if(e.data.request){var i=null!=t.removed.lastUpdateTime;return"TakeBackAccepted"===e.data.request.code&&i?Dge.ACCEPT_TAKE_BACK_WITHOUT_TIME:Dge.REQUEST}if(this.isMove(t,r))return 1===e.data.turn?null==e.data.lastUpdateTime?Dge.MOVE_WITHOUT_TIME:Dge.MOVE:null==t.modified.lastUpdateTime?Dge.MOVE_WITHOUT_TIME:Dge.MOVE;if(null==e.data.beginning)return Dge.PRE_START_DOC;if(e.data.result!==$7.UNACHIEVED.value){var a=null==t.modified.lastUpdateTime;return null!=t.modified.turn&&a?Dge.END_GAME_WITHOUT_TIME:Dge.END_GAME}return F7(null!=e.data.beginning&&0===e.data.listMoves.length,"Unexpected update: "+JSON.stringify(t)),Dge.STARTING_DOC}},{key:"isMove",value:function(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+3}return!1}},{key:"getLastUpdateTime",value:function(e,t,n){var r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);F7(null!=r,"oldTime should not be null"),F7(null!=i,"updateTime should not be null");var a=e9.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(IB.getNonNullable(r),IB.getNonNullable(i),n,a)}},{key:"getMoreRecentTime",value:function(e){var t;return null!==(t=e.data.lastUpdateTime)&&void 0!==t?t:e.data.beginning}},{key:"getTimeUsedForLastTurn",value:function(e,t,n,r){var i=mpe(e,t),a=[0,0];return a[r.value]=i,a}},{key:"setChronos",value:function(){AB(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}},{key:"didUserPlay",value:function(e){return this.hasUserPlayed[e.value]}},{key:"doNewMoves",value:function(e){AB(n.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"),this.switchPlayer();for(var t=i9.copyImmutableArray(e.data.listMoves),r=this.gameComponent.rules;this.gameComponent.getTurn()<t.length;){var i=this.gameComponent.getTurn(),a=this.gameComponent.encoder.decode(t[i]),o=r.isLegal(a,this.gameComponent.getState()),s="We received an incorrect db move: "+a.toString()+" in "+t+" at turn "+i+'because "'+o.getReasonOr("")+'"';F7(o.isSuccess(),s),r.choose(a)}this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.updateBoard()}},{key:"switchPlayer",value:function(){AB(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");var e=e9.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get();var t=e.getOpponent();this.didUserPlay(t)&&this.pauseCountDownsFor(t),this.didUserPlay(e)?(AB(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(e)):this.startCountDownFor(e)}},{key:"resetChronoFor",value:function(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}},{key:"applyEndGame",value:function(){var e=this.currentPart,t=e9.fromTurn(e.data.turn);this.endGame=!0,[$7.VICTORY,$7.HARD_DRAW].some(function(t){return t.value===e.data.result})?this.doNewMoves(this.currentPart):(F7(!0===[$7.RESIGN,$7.TIMEOUT,$7.HARD_DRAW,$7.AGREED_DRAW_BY_ZERO,$7.AGREED_DRAW_BY_ONE].some(function(t){return t.value===e.data.result}),"Unknown type of end game ("+e.data.result+")"),AB(n.VERBOSE,"endGame est true et winner est "+e.getWinner())),this.stopCountdownsFor(t)}},{key:"notifyDraw",value:function(e,t){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],t,!0)}},{key:"notifyTimeoutVictory",value:function(e,t,n,r){var i=this;return TB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.endGame=!0,o=i.currentPart.setWinnerAndLoser(e,r),i.currentPart=o,a.next=5,i.gameService.notifyTimeout(i.currentPartId,t,n,e,r);case 5:case"end":return a.stop()}},a)}))()}},{key:"notifyVictory",value:function(e,t){AB(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");var r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);return r===Bte.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(F7(r===Bte.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],t,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}},{key:"canAskTakeBack",value:function(){return F7(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.role.value||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.role.isPlayer()&&this.currentPart.data.request.data.player===this.role.getOpponent().value)&&this.getTakeBackRequester()===J7.NONE}},{key:"isOpponentWaitingForTakeBackResponse",value:function(){var e=this.getTakeBackRequester();return!!e.isPlayer()&&this.isOpponent(e)}},{key:"getTakeBackRequester",value:function(){if(null==this.currentPart)return J7.NONE;var e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?t9.getPlayer(e):J7.NONE}},{key:"canProposeDraw",value:function(){return F7(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&this.role.isPlayer()&&t9.getPlayer(this.currentPart.data.request)===this.role.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===J7.NONE}},{key:"isOpponentWaitingForDrawResponse",value:function(){var e=this.getDrawRequester();return e!==J7.NONE&&this.isOpponent(e)}},{key:"getDrawRequester",value:function(){if(null==this.currentPart)return J7.NONE;var e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?t9.getPlayer(e):J7.NONE}},{key:"onRequest",value:function(e,t){var r=this;return TB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=(AB(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:t}),e.code),i.next="TakeBackAsked"===i.t0||"TakeBackRefused"===i.t0||"DrawProposed"===i.t0||"DrawRefused"===i.t0?3:"TakeBackAccepted"===i.t0?4:"RematchProposed"===i.t0?6:"RematchAccepted"===i.t0?10:"AddTurnTime"===i.t0?15:"AddGlobalTime"===i.t0?18:21;break;case 3:case 14:return i.abrupt("break",24);case 4:return r.takeBackTo(r.currentPart.data.turn),i.abrupt("break",24);case 6:return r.rematchProposed=!0,a=t9.getPlayer(e).getOpponent(),r.isPlayer(a)&&(AB(n.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0),i.abrupt("break",24);case 10:return i.next=12,r.router.navigate(["/nextGameLoading"]);case 12:return i.next=14,r.router.navigate(["/play",t9.getTypeGame(e),t9.getPartId(e)]);case 15:return 3e4,o=e9.of(e.data.player),r.addTurnTimeTo(o,3e4),i.abrupt("break",24);case 18:return 3e5,s=e9.of(e.data.player),r.addGlobalTimeTo(s,3e5),i.abrupt("break",24);case 21:return IB.expectToBe(e.code,"DrawAccepted","Unknown RequestType : "+e.code+" for "+JSON.stringify(e)),i.next=24,r.acceptDraw();case 24:case"end":return i.stop()}},i)}))()}},{key:"takeBackTo",value:function(e){if(AB(n.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.getTurn()===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();var t=e9.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}},{key:"setPlayersDatas",value:function(e){var t=this;AB(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),this.players=[NB.of(e.data.playerZero),NB.ofNullable(e.data.playerOne)],F7(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[e.data.turn%2].get();var r=NB.empty();if(this.players[0].get().id===this.authUser.id?(this.setRole(e9.ZERO),r=this.players[1]):this.players[1].get().id===this.authUser.id?(this.setRole(e9.ONE),r=this.players[0]):this.setRole(J7.NONE),r.isPresent()){this.opponentSubscription=this.userService.observeUser(r.get().id,function(e){F7(e.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent={id:r.get().id,name:IB.getNonNullable(e.get().username)}})}}},{key:"onLegalUserMove",value:function(e,t){var r=this;return TB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(AB(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),r.isOpponentWaitingForTakeBackResponse()){i.next=2;break}return i.abrupt("return",r.updateDBBoard(e,r.msToSubstract,t));case 2:r.gameComponent.message("You must answer to take back request");case 3:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(e,t,r){var i=this;return TB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=i.gameComponent.encoder.encodeMove(e),AB(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+r+")"),i.gameComponent.rules.choose(e),s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node),a.abrupt("return",s.isEndGame?s===Bte.DRAW?i.notifyDraw(o,r):i.notifyVictory(o,r):i.gameService.updateDBBoard(i.currentPartId,i.role,o,t,r));case 4:case"end":return a.stop()}},a)}))()}},{key:"resign",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return AB(n.VERBOSE,"OnlineGameWrapperComponent.resign"),r=e.getLastIndex(),i=e.role,a=e.getPlayer(),o=e.players[(e.role.value+1)%2].get(),t.next=4,e.gameService.resign(e.currentPartId,r,i,o,a);case 4:case"end":return t.stop()}},t)}))()}},{key:"getLastIndex",value:function(){return this.currentPart.data.lastUpdate.index}},{key:"reachedOutOfTime",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(AB(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),i=t.getLastIndex(),a=t.role,t.stopCountdownsFor(e),e!==t.role){r.next=8;break}return o=IB.getNonNullable(t.opponent),r.next=6,t.notifyTimeoutVictory(o,a,i,t.authUser.toMinimalUser());case 6:r.next=13;break;case 8:if(F7(!1===t.endGame,"time might be better handled in the future"),!t.opponentIsOffline()){r.next=13;break}return s=IB.getNonNullable(t.opponent),r.next=12,t.notifyTimeoutVictory(t.authUser.toMinimalUser(),a,e.value,s);case 12:t.endGame=!0;case 13:case"end":return r.stop()}},r)}))()}},{key:"acceptRematch",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return F7(e.isPlaying(),"Non playing should not call acceptRematch"),n=new Z7(e.currentPartId,e.currentPart.data),t.next=4,e.gameService.acceptRematch(n,e.getLastIndex(),e.role);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}},t)}))()}},{key:"proposeRematch",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return F7(e.isPlaying(),"Non playing should not call proposeRematch"),t.next=3,e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.role);case 3:return t.abrupt("return",!0);case 4:case"end":return t.stop()}},t)}))()}},{key:"proposeDraw",value:function(){return F7(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"acceptDraw",value:function(){return F7(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"refuseDraw",value:function(){return F7(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"askTakeBack",value:function(){return F7(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.role)}},{key:"acceptTakeBack",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return F7(e.isPlaying(),"Non playing should not call acceptTakeBack"),n=e.role,t.next=4,e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,n,e.msToSubstract);case 4:e.msToSubstract=[0,0];case 5:case"end":return t.stop()}},t)}))()}},{key:"refuseTakeBack",value:function(){return F7(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.role)}},{key:"startCountDownFor",value:function(e){AB(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[e.value]=!0,e===e9.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}},{key:"resumeCountDownFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];AB(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===e9.ZERO?(this.chronoZeroGlobal.changeDuration(IB.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),t=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(IB.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),t=this.chronoOneTurn),r?(t.setDuration(1e3*this.configRoom.maximalMoveDuration),t.start()):t.resume()}},{key:"pauseCountDownsFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];AB(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart.data.turn+")"),e===e9.ZERO?(this.chronoZeroGlobal.pause(),t=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),t=this.chronoOneTurn),r?t.stop():t.pause()}},{key:"stopCountdownsFor",value:function(e){AB(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===e9.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}},{key:"getPlayerNameClass",value:function(e){return this.opponentIsOffline()?"has-text-grey-light":e===e9.ZERO?"has-text-white":"has-text-black"}},{key:"opponentIsOffline",value:function(){return!1}},{key:"canResign",value:function(){return F7(this.isPlaying(),"Non playing should not call canResign"),!(!0===this.endGame||null==this.opponent)}},{key:"addGlobalTime",value:function(){var e=this.role,t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}},{key:"addTurnTime",value:function(){return this.gameService.addTurnTime(this.role,this.getLastIndex(),this.currentPartId)}},{key:"addTurnTimeTo",value:function(e,t){var n=e9.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===e9.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}},{key:"addGlobalTimeTo",value:function(e,t){e===e9.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}},{key:"ngOnDestroy",value:function(){AB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),this.routerEventsSub.unsubscribe(),this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.unsubscribe(),this.partSubscription.unsubscribe()),AB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")}}]),n}(ppe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(IO),_P(KD),_P(yF),_P(D7),_P(G7),_P(V7),_P(c9))},e.\u0275cmp=vk({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){var n;(1&e&&(XT(Gpe,5),XT($pe,5),XT(Zpe,5),XT(qpe,5),XT(Wpe,5),XT(jpe,5)),2&e)&&(QT(n=JT())&&(t.partCreation=n.first),QT(n=JT())&&(t.chatComponent=n.first),QT(n=JT())&&(t.chronoZeroGlobal=n.first),QT(n=JT())&&(t.chronoOneGlobal=n.first),QT(n=JT())&&(t.chronoZeroTurn=n.first),QT(n=JT())&&(t.chronoOneTurn=n.first))},features:[nP],decls:5,vars:4,consts:function(){return[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],$localize(ep||(ep=Wg(["vs."]))),["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(tp||(tp=Wg(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],$localize(np||(np=Wg(["It is your turn."]))),$localize(rp||(rp=Wg(["It is ",":INTERPOLATION:'s turn."])),"\ufffd0\ufffd"),["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],$localize(ip||(ip=Wg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],$localize(ap||(ap=Wg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(op||(op=Wg(["Resign"]))),["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(sp||(sp=Wg(["Propose a draw"]))),["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(up||(up=Wg(["Accept draw"]))),["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(cp||(cp=Wg(["Reject draw"]))),["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(lp||(lp=Wg(["Pass a turn"]))),["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(fp||(fp=Wg(["Accept take back"]))),["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(hp||(hp=Wg(["Reject take back"]))),["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],$localize(dp||(dp=Wg(["Ask to take back one move"]))),["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$localize(vp||(vp=Wg(["Draw"]))),["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],$localize(pp||(pp=Wg(["You agreed to draw."]))),["id","yourOpponentAgreedToDrawIndicator",1,"title"],$localize(gp||(gp=Wg(["Your draw proposal has been accepted."]))),["id","playersAgreedToDraw",1,"title"],$localize(yp||(yp=Wg(["Players agreed to draw."]))),["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],$localize(mp||(mp=Wg(["You won."]))),[1,"title"],$localize(kp||(kp=Wg(["You lost."]))),$localize(Cp||(Cp=Wg(["",":INTERPOLATION: won."])),"\ufffd0\ufffd"),$localize(wp||(wp=Wg(["",":INTERPOLATION: has reached their time limit. You won."])),"\ufffd0\ufffd"),$localize(_p||(_p=Wg(["You reached your time limit."]))),$localize(Ep||(Ep=Wg(["",":INTERPOLATION: has reached their time limit."])),"\ufffd0\ufffd"),["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],$localize(bp||(bp=Wg(["You resigned."]))),$localize(Pp||(Pp=Wg(["",":INTERPOLATION: has resigned."])),"\ufffd0\ufffd"),["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],$localize(Sp||(Sp=Wg(["Go back to the game list"]))),["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Op||(Op=Wg(["Propose to play again"]))),["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],$localize(Tp||(Tp=Wg(["Accept to play again"])))]},template:function(e,t){1&e&&(CP(0,Ype,2,1,"app-part-creation",0),CP(1,Rge,29,27,"div",1),PP(2,"div",2),PP(3,"div",3),OP(4,"app-chat",4),SP(),SP()),2&e&&(EP("ngIf",!1===t.gameStarted),BE(1),EP("ngIf",t.gameStarted),BE(3),EP("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[sM,tpe,Bpe,Hpe,rM,dpe,kF],encapsulation:2}),e}();function Fge(e,t){if(1&e&&(PP(0,"option",25),uS(1),SP()),2&e){var n=t.$implicit;EP("value",n.name),BE(1),cS(n.name)}}function Uge(e,t){if(1&e&&(PP(0,"option",25),gO(1,29),SP()),2&e){var n=t.$implicit;EP("value",n),BE(1),yO(n),mO(1)}}var Vge=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function Bge(e,t){if(1&e){var n=AP();PP(0,"select",26),RP("ngModelChange",function(e){return aC(n),LP(2).aiDepths[0]=e})("change",function(){aC(n);var e=LP(2);return e.updatePlayer(e.Player.ZERO)}),PP(1,"option",27),gO(2,28),SP(),CP(3,Uge,2,2,"option",16),SP()}2&e&&(EP("ngModel",LP(2).aiDepths[0]),BE(3),EP("ngForOf",AT(2,Vge)))}function zge(e,t){if(1&e&&(PP(0,"p",30),gO(1,31),SP()),2&e){var n=LP(2);BE(1),yO(n.gameComponent.scores.get()[0]),mO(1)}}function Hge(e,t){if(1&e&&(PP(0,"option",25),uS(1),SP()),2&e){var n=t.$implicit;EP("value",n.name),BE(1),cS(n.name)}}function Gge(e,t){if(1&e&&(PP(0,"option",25),gO(1,34),SP()),2&e){var n=t.$implicit;EP("value",n),BE(1),yO(n),mO(1)}}function $ge(e,t){if(1&e){var n=AP();PP(0,"select",32),RP("ngModelChange",function(e){return aC(n),LP(2).aiDepths[1]=e})("change",function(){aC(n);var e=LP(2);return e.updatePlayer(e.Player.ONE)}),PP(1,"option",27),gO(2,33),SP(),CP(3,Gge,2,2,"option",16),SP()}2&e&&(EP("ngModel",LP(2).aiDepths[1]),BE(3),EP("ngForOf",AT(2,Vge)))}function Zge(e,t){if(1&e&&(PP(0,"p",35),gO(1,36),SP()),2&e){var n=LP(2);BE(1),yO(n.gameComponent.scores.get()[1]),mO(1)}}function qge(e,t){if(1&e&&(PP(0,"h4"),gO(1,40),SP()),2&e){var n=LP(3);BE(1),yO(n.winner.get()),mO(1)}}function Wge(e,t){1&e&&(PP(0,"h4",41),gO(1,42),SP())}function jge(e,t){if(1&e&&(PP(0,"div",37),CP(1,qge,2,1,"h4",38),CP(2,Wge,2,0,"h4",39),SP()),2&e){var n=LP(2);BE(1),EP("ngIf",n.winner.isPresent()),BE(1),EP("ngIf",n.winner.isAbsent())}}function Yge(e,t){if(1&e){var n=AP();PP(0,"div",6),PP(1,"div",7),PP(2,"p",8),gO(3,9),SP(),SP(),PP(4,"div",10),PP(5,"div",11),PP(6,"div",12),PP(7,"select",13),RP("change",function(){aC(n);var e=LP();return e.updatePlayer(e.Player.ZERO)})("ngModelChange",function(e){return aC(n),LP().playerSelection[0]=e}),PP(8,"option",14),gO(9,15),SP(),CP(10,Fge,2,2,"option",16),SP(),SP(),PP(11,"div",12),CP(12,Bge,4,3,"select",17),SP(),CP(13,zge,2,1,"p",18),SP(),PP(14,"div",19),PP(15,"div",12),PP(16,"select",20),RP("change",function(){aC(n);var e=LP();return e.updatePlayer(e.Player.ONE)})("ngModelChange",function(e){return aC(n),LP().playerSelection[1]=e}),PP(17,"option",14),gO(18,21),SP(),CP(19,Hge,2,2,"option",16),SP(),SP(),PP(20,"div",12),CP(21,$ge,4,3,"select",22),SP(),CP(22,Zge,2,1,"p",23),SP(),SP(),CP(23,jge,3,2,"div",24),SP()}if(2&e){var r=LP();BE(3),yO(r.gameComponent.getTurn()+1),mO(3),BE(4),EP("ngModel",r.playerSelection[0]),BE(3),EP("ngForOf",r.gameComponent.availableMinimaxes),BE(2),EP("ngIf",!1===r.players[0].equalsValue("human")),BE(1),EP("ngIf",r.gameComponent.scores.isPresent()),BE(3),EP("ngModel",r.playerSelection[1]),BE(3),EP("ngForOf",r.gameComponent.availableMinimaxes),BE(2),EP("ngIf",!1===r.players[1].equalsValue("human")),BE(1),EP("ngIf",r.gameComponent.scores.isPresent()),BE(1),EP("ngIf",r.endGame)}}function Kge(e,t){if(1&e&&(TP(0),uS(1),OP(2,"br"),IP()),2&e){var n=t.$implicit,r=LP(3);BE(1),lS(" ",n.name+": "+n.getBoardValue(r.gameComponent.rules.node)," ")}}function Qge(e,t){if(1&e&&(TP(0),CP(1,Kge,3,1,"ng-container",48),uS(2),OP(3,"br"),uS(4),OP(5,"br"),IP()),2&e){var n=LP(2);BE(1),EP("ngForOf",n.gameComponent.availableMinimaxes),BE(1),lS(" Created ",n.getCreatedNodes()," nodes."),BE(2),lS(" Minimax time: ",n.getMinimaxTime(),"ms.")}}function Xge(e,t){if(1&e){var n=AP();PP(0,"button",49),RP("click",function(){return aC(n),LP(2).gameComponent.pass()}),gO(1,50),SP()}}function Jge(e,t){if(1&e){var n=AP();PP(0,"button",51),RP("click",function(){return aC(n),LP(2).takeBack()}),gO(1,52),SP()}}function eye(e,t){if(1&e){var n=AP();PP(0,"div",43),CP(1,Qge,6,3,"ng-container",38),CP(2,Xge,2,0,"button",44),CP(3,Jge,2,0,"button",45),PP(4,"button",46),RP("click",function(){return aC(n),LP().restartGame()}),gO(5,47),SP(),SP()}if(2&e){var r=LP();BE(1),EP("ngIf",r.gameComponent.rules.node.move),BE(1),EP("ngIf",!1===r.endGame&&r.gameComponent.canPass),BE(1),EP("ngIf",r.canTakeBack())}}var tye=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s){var u;return gy(this,n),(u=t.call(this,e,r,i,a,o)).cdr=s,u.aiDepths=["0","0"],u.playerSelection=["human","human"],u.winner=NB.empty(),u.botTimeOut=1e3,u.players=[NB.of(u.playerSelection[0]),NB.of(u.playerSelection[1])],u.role=e9.ZERO,AB(n.VERBOSE,"LocalGameWrapper.constructor"),u}return my(n,[{key:"getCreatedNodes",value:function(){return Ute.createdNodes}},{key:"getMinimaxTime",value:function(){return Ute.minimaxTime}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.afterGameIncluderViewInit();case 2:if(t.t0=t.sent,!t.t0){t.next=5;break}e.restartGame(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)})),1)}},{key:"updatePlayer",value:function(e){this.players[e.value]=NB.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?e9.ONE:e9.ZERO),this.proposeAIToPlay()}},{key:"onLegalUserMove",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:AB(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),t.gameComponent.rules.choose(e),t.updateBoard(),t.proposeAIToPlay();case 1:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.gameComponent.updateBoard();var e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer()&&(this.winner=NB.of($localize(Ip||(Ip=Wg(["Player ",""])),e.winner.value+1))))}},{key:"proposeAIToPlay",value:function(){var e=this,t=this.getPlayingAI();t.isPresent()&&window.setTimeout(TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.doAIMove(t.get());case 2:case"end":return n.stop()}},n)})),this.botTimeOut)}},{key:"getPlayingAI",value:function(){var e=this;if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return NB.empty();var t=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[t]?NB.empty():NB.ofNullable(this.gameComponent.availableMinimaxes.find(function(n){return e.players[t].isPresent()&&e.players[t].get()===n.name}))}},{key:"doAIMove",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return F7((r=t.gameComponent.rules).getGameStatus(r.node)===Bte.ONGOING,"AI should not try to play when game is over!"),i=Number.parseInt(t.aiDepths[r.node.gameState.turn%2%2]),a=r.node.findBestMove(i,e,!0),n.abrupt("return",r.choose(a)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),UB.SUCCESS):(t.messageDisplayer.criticalMessage($localize(Ap||(Ap=Wg(["The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!"])))),L7.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()})));case 4:case"end":return n.stop()}},n)}))()}},{key:"canTakeBack",value:function(){return this.gameComponent.getTurn()>0}},{key:"takeBack",value:function(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}},{key:"isAITurn",value:function(){return this.getPlayingAI().isPresent()}},{key:"restartGame",value:function(){this.gameComponent.rules.setInitialBoard(),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=NB.empty(),this.proposeAIToPlay()}},{key:"getPlayer",value:function(){return"human"}}]),n}(ppe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(IO),_P(KD),_P(G7),_P(yF),_P(D7),_P(aT))},e.\u0275cmp=vk({type:e,selectors:[["app-local-game-wrapper"]],features:[nP],decls:7,vars:3,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Mp||(Mp=Wg(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],$localize(xp||(xp=Wg(["Human"]))),[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],$localize(Rp||(Rp=Wg(["Human"]))),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],$localize(Np||(Np=Wg(["Pick the level"]))),$localize(Dp||(Dp=Wg(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreOne",1,"block"],$localize(Lp||(Lp=Wg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],$localize(Fp||(Fp=Wg(["Pick the level"]))),$localize(Up||(Up=Wg(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreZero",1,"block"],$localize(Vp||(Vp=Wg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],$localize(Bp||(Bp=Wg(["",":INTERPOLATION: won"])),"\ufffd0\ufffd"),["id","draw"],$localize(zp||(zp=Wg(["Draw"]))),[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],$localize(Hp||(Hp=Wg(["Start a new game"]))),[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],$localize(Gp||(Gp=Wg(["Pass a turn"]))),["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],$localize($p||($p=Wg(["Take back move"])))]},template:function(e,t){1&e&&(PP(0,"div",0),PP(1,"div",1),CP(2,Yge,24,10,"div",2),CP(3,eye,6,3,"div",3),SP(),PP(4,"div",4),PP(5,"div",5),OP(6,"app-game-includer"),SP(),SP(),SP()),2&e&&(BE(2),EP("ngIf",t.gameComponent),BE(1),EP("ngIf",t.gameComponent),BE(1),EP("ngClass",t.getBoardHighlight()))},directives:[sM,rM,dpe,TR,Ux,gR,IR,RR,aM],encapsulation:2,changeDetection:0}),e}(),nye=function(){var e=my(function e(){gy(this,e)});return e.STEP_FINISHED=function(){return $localize(Zp||(Zp=Wg(["Step finished!"])))},e.INFORMATIONAL_STEP=function(){return $localize(qp||(qp=Wg(["This step is not expecting any move from your part."])))},e}();function rye(e,t){if(1&e&&(PP(0,"div",20),PP(1,"div",21),gO(2,22),SP(),PP(3,"div",23),uS(4),SP(),SP()),2&e){var n=LP();BE(4),cS(n.currentReason.get())}}function iye(e,t){if(1&e){var n=AP();PP(0,"button",24),RP("click",function(){return aC(n),LP().retry()}),gO(1,25),SP()}}function aye(e,t){1&e&&(TP(0),gO(1,30),IP())}function oye(e,t){1&e&&(TP(0),gO(1,31),IP())}function sye(e,t){if(1&e&&CP(0,oye,2,0,"ng-container",27),2&e){LP();var n=wP(5),r=LP();EP("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",n)}}function uye(e,t){1&e&&(TP(0),gO(1,32),IP())}function cye(e,t){if(1&e){var n=AP();PP(0,"button",26),RP("click",function(){return aC(n),LP().next()}),CP(1,aye,2,0,"ng-container",27),CP(2,sye,1,2,"ng-template",null,28,tI),CP(4,uye,2,0,"ng-template",null,29,tI),SP()}if(2&e){var r=wP(3),i=LP();BE(1),EP("ngIf",i.steps[i.stepIndex]&&i.steps[i.stepIndex].isInformation())("ngIfElse",r)}}function lye(e,t){if(1&e){var n=AP();PP(0,"button",33),RP("click",function(){return aC(n),LP().start()}),gO(1,34),SP()}}function fye(e,t){if(1&e){var n=AP();PP(0,"button",35),RP("click",function(){return aC(n),LP().playLocally()}),gO(1,36),SP()}}function hye(e,t){if(1&e){var n=AP();PP(0,"button",37),RP("click",function(){return aC(n),LP().createGame()}),gO(1,38),SP()}}function dye(e,t){if(1&e){var n=AP();PP(0,"button",39),RP("click",function(){return aC(n),LP().showSolution()}),gO(1,40),SP()}}function vye(e,t){if(1&e&&(TP(0),PP(1,"option",42),uS(2),SP(),IP()),2&e){var n=LP(),r=n.index,i=n.$implicit;BE(1),UP("id","step_",r,""),EP("value",r),BE(1),cS(i.title)}}function pye(e,t){1&e&&(TP(0),uS(1,"v "),IP())}function gye(e,t){1&e&&uS(0,"x ")}function yye(e,t){if(1&e&&(PP(0,"option",43),CP(1,pye,2,0,"ng-container",27),CP(2,gye,1,0,"ng-template",null,44,tI),PP(4,"span",45),uS(5),SP(),SP()),2&e){var n=wP(3),r=LP(),i=r.index,a=r.$implicit,o=LP();EP("value",i),BE(1),EP("ngIf",o.stepFinished[i])("ngIfElse",n),BE(3),UP("id","step_",i,""),BE(1),cS(a.title)}}function mye(e,t){if(1&e&&(TP(0),CP(1,vye,3,3,"ng-container",27),CP(2,yye,6,5,"ng-template",null,41,tI),IP()),2&e){var n=t.index,r=wP(3),i=LP();BE(1),EP("ngIf",n===i.stepIndex)("ngIfElse",r)}}var kye=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r,i,a,o,s){var u;return gy(this,n),(u=t.call(this,e,r,s,i,a)).cdr=o,u.connectedUserService=s,u.COMPLETED_TUTORIAL_MESSAGE=$localize(Wp||(Wp=Wg(["Congratulations, you completed the tutorial."]))),u.steps=[],u.successfulSteps=0,u.stepIndex=-1,u.currentMessage="",u.currentReason=NB.empty(),u.moveAttemptMade=!1,u.stepFinished=[],u.tutorialOver=!1,AB(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),u.role=e9.ZERO,u}return my(n,[{key:"getNumberOfSteps",value:function(){return this.steps.length}},{key:"getCurrentStepTitle",value:function(){return this.steps.length>0?this.steps[this.stepIndex].title:""}},{key:"ngAfterViewInit",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return AB(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),t.next=3,e.afterGameIncluderViewInit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}e.start();case 6:case"end":return t.stop()}},t)}))()}},{key:"start",value:function(){this.startTutorial(this.gameComponent.tutorial)}},{key:"startTutorial",value:function(e){AB(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}},{key:"getCompletionArray",value:function(){return this.steps.map(function(){return!1})}},{key:"changeStep",value:function(e){this.showStep(Number.parseInt(e.target.value,10))}},{key:"showStep",value:function(e){AB(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;var t,r=this.steps[this.stepIndex];if(this.currentMessage=r.instruction,this.currentReason=NB.empty(),r.previousState.isPresent()){var i=new Vte(r.previousState.get());t=NB.of(i)}else t=NB.empty();this.gameComponent.rules.node=new Vte(r.state,t,r.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}},{key:"onLegalUserMove",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:AB(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}}),i=t.steps[t.stepIndex],F7(t.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),AB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,i.isPredicate()?(a=t.gameComponent.getPreviousState(),o=t.gameComponent.getState(),(s=IB.getNonNullable(i.predicate)(e,a,o)).isSuccess()?t.showStepSuccess(i.getSuccessMessage()):t.currentReason=NB.of(s.getReason())):i.isAnyMove()?(AB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(i.getSuccessMessage())):(F7(i.isMove(),"cannot reach here with a click step"),(u=i).acceptedMoves.some(function(t){return t.equals(e)})?(AB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(u.getSuccessMessage())):(AB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),t.currentReason=NB.of(u.getFailureMessage()))),t.cdr.detectChanges();case 4:case"end":return r.stop()}},r)}))()}},{key:"retry",value:function(){AB(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}},{key:"onUserClick",value:function(e){var t=this;if(AB(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=NB.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return UB.failure(nye.STEP_FINISHED());var r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,IB.getNonNullable(r.acceptedClicks).some(function(t){return t===e})?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),UB.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(function(){t.cdr.detectChanges()},10),UB.SUCCESS):UB.failure(nye.INFORMATIONAL_STEP())}},{key:"onCancelMove",value:function(e){AB(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=NB.of(e)),this.cdr.detectChanges()}},{key:"showStepSuccess",value:function(e){AB(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}},{key:"updateSuccessCount",value:function(){var e,t=0,n=dy(this.stepFinished);try{for(n.s();!(e=n.n()).done;){e.value&&t++}}catch(r){n.e(r)}finally{n.f()}this.successfulSteps=t}},{key:"next",value:function(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{for(var e=(this.stepIndex+1)%this.steps.length;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}},{key:"showSolution",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:AB(n.VERBOSE,"tutorialGameWrapper.showSolution()"),F7((r=e.steps[e.stepIndex]).hasSolution(),"step must have solution"),(a=(i=r).getSolution())instanceof xte?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(a),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(a).dispatchEvent(new Event("click"))),e.currentMessage=i.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)}))()}},{key:"playLocally",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=IB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/local",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"createGame",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=IB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/play",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"getPlayer",value:function(){return"tutorial-player"}}]),n}(ppe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(_P(IO),_P(KD),_P(yF),_P(D7),_P(aT),_P(G7))},e.\u0275cmp=vk({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[nP],decls:22,vars:15,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(jp||(jp=Wg(["Failure"]))),["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],$localize(Yp||(Yp=Wg(["Try again"]))),["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],$localize(Kp||(Kp=Wg(["Ok"]))),$localize(Qp||(Qp=Wg(["Continue"]))),$localize(Xp||(Xp=Wg(["Skip"]))),["id","restartButton",1,"button",3,"click"],$localize(Jp||(Jp=Wg(["Try again"]))),["id","playLocallyButton",1,"button",3,"click"],$localize(eg||(eg=Wg(["Play locally"]))),["id","playOnlineButton",1,"button",3,"click"],$localize(tg||(tg=Wg(["Create an online game"]))),["id","showSolutionButton",1,"button",3,"click"],$localize(ng||(ng=Wg(["See solution"]))),["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(PP(0,"div",0),PP(1,"div",1),PP(2,"div",2),OP(3,"progress",3),PP(4,"div",4),PP(5,"p",5),uS(6),SP(),OP(7,"p",6),SP(),CP(8,rye,5,1,"div",7),PP(9,"div",8),CP(10,iye,2,0,"button",9),CP(11,cye,6,2,"button",10),CP(12,lye,2,0,"button",11),CP(13,fye,2,0,"button",12),CP(14,hye,2,0,"button",13),CP(15,dye,2,0,"button",14),PP(16,"div",15),PP(17,"select",16),RP("change",function(e){return t.changeStep(e)}),CP(18,mye,4,2,"ng-container",17),SP(),SP(),SP(),SP(),SP(),PP(19,"div",18),PP(20,"div",19),OP(21,"app-game-includer"),SP(),SP(),SP()),2&e&&(BE(3),pP("value",t.successfulSteps)("max",t.getNumberOfSteps()),BE(3),hS("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),BE(1),EP("innerHTML",t.currentMessage,x_),BE(1),EP("ngIf",t.currentReason.isPresent()),BE(2),EP("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),BE(1),EP("ngIf",!1===t.tutorialOver),BE(1),EP("ngIf",t.tutorialOver),BE(1),EP("ngIf",t.tutorialOver),BE(1),EP("ngIf",t.tutorialOver),BE(1),EP("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),BE(3),EP("ngForOf",t.steps),BE(1),EP("ngClass",t.getBoardHighlight()))},directives:[sM,aM,rM,dpe,IR,RR],encapsulation:2,changeDetection:0}),e}();function Cye(e,t){if(1&e&&(PP(0,"div",35),PP(1,"div",36),gO(2,37),SP(),PP(3,"div",38),uS(4),SP(),SP()),2&e){var n=LP();BE(4),cS(n.errorMessage)}}var wye=function(){return["/login"]},_ye=function(){var e=function(){function e(t,n){gy(this,e),this.authService=t,this.router=n,this.faEye=k9,this.registrationForm=new cR({email:new uR,username:new uR,password:new uR})}return my(e,[{key:"registerWithEmail",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.registrationForm.value.username,r=e.registrationForm.value.email,i=e.registrationForm.value.password,null!=n&&null!=r&&null!=i){t.next=5;break}e.errorMessage=$localize(rg||(rg=Wg(["There are missing fields in the registration form, please check that you filled in all fields."]))),t.next=21;break;case 5:return t.next=7,e.authService.doRegister(n,r,i);case 7:if(!(a=t.sent).isSuccess()){t.next=20;break}return t.next=11,e.authService.sendEmailVerification();case 11:if(!(o=t.sent).isSuccess()){t.next=17;break}return t.next=15,e.router.navigate(["/verify-account"]);case 15:t.next=18;break;case 17:e.errorMessage=o.getReason();case 18:t.next=21;break;case 20:e.errorMessage=a.getReason();case 21:case"end":return t.stop()}},t)}))()}},{key:"registerWithGoogle",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.doGoogleLogin();case 2:if(!(n=t.sent).isSuccess()){t.next=8;break}return t.next=6,e.router.navigate(["/verify-account"]);case 6:t.next=9;break;case 8:e.errorMessage=n.getReason();case 9:case"end":return t.stop()}},t)}))()}},{key:"getPasswordHelpClass",value:function(){var e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}},{key:"canRegister",value:function(){var e,t,n,r=null!==(e=this.registrationForm.value.password)&&void 0!==e?e:"";return!(""===(null!==(t=this.registrationForm.value.email)&&void 0!==t?t:"")||""===(null!==(n=this.registrationForm.value.username)&&void 0!==n?n:"")||""===r||r.length<6)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(G7),_P(yF))},e.\u0275cmp=vk({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){return[[1,"box"],[1,"title"],$localize(ig||(ig=Wg(["Registering"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(ag||(ag=Wg(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",$localize(og||(og=Wg(["Email"]))),"type","email","autofocus","","required","",1,"input"],[1,"help"],$localize(sg||(sg=Wg(["A confirmation email will be sent to validate your account."]))),["for","username",1,"label"],$localize(ug||(ug=Wg(["Username"]))),["id","username","formControlName","username","name","username","placeholder",$localize(cg||(cg=Wg(["Username"]))),"type","text","required","",1,"input"],["for","password",1,"label"],$localize(lg||(lg=Wg(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",$localize(fg||(fg=Wg(["Password"]))),"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],$localize(hg||(hg=Wg(["The password should be at least 6 characters long"]))),["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(dg||(dg=Wg(["Register"]))),[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(vg||(vg=Wg(["Register with Google"]))),[1,"help","level-right"],$localize(pg||(pg=Wg(["Have an account?"]))),[3,"routerLink"],$localize(gg||(gg=Wg(["Log in"]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(yg||(yg=Wg(["Registration error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(PP(0,"div",0),PP(1,"p",1),gO(2,2),SP(),PP(3,"form",3),PP(4,"div",4),PP(5,"div",5),PP(6,"label",6),gO(7,7),SP(),SP(),PP(8,"div",8),PP(9,"div",9),PP(10,"div",10),OP(11,"input",11),PP(12,"p",12),gO(13,13),SP(),SP(),SP(),SP(),SP(),PP(14,"div",4),PP(15,"div",5),PP(16,"label",14),gO(17,15),SP(),SP(),PP(18,"div",8),PP(19,"div",9),PP(20,"div",10),OP(21,"input",16),SP(),SP(),SP(),SP(),PP(22,"div",4),PP(23,"div",5),PP(24,"label",17),gO(25,18),SP(),SP(),PP(26,"div",8),PP(27,"div",9),PP(28,"div",19),OP(29,"input",20),PP(30,"span",21),OP(31,"fa-icon",22),SP(),PP(32,"p",23),gO(33,24),SP(),SP(),SP(),SP(),SP(),PP(34,"div",4),OP(35,"div",5),PP(36,"div",8),PP(37,"div",9),PP(38,"div",10),PP(39,"button",25),RP("click",function(){return t.registerWithEmail()}),gO(40,26),SP(),SP(),SP(),SP(),SP(),PP(41,"div",4),OP(42,"div",5),PP(43,"div",27),CP(44,Cye,5,1,"div",28),SP(),SP(),PP(45,"div",4),OP(46,"div",5),PP(47,"div",8),PP(48,"button",29),RP("click",function(){return t.registerWithGoogle()}),gO(49,30),SP(),SP(),SP(),PP(50,"p",31),TP(51),gO(52,32),IP(),uS(53,"\xa0 "),PP(54,"a",33),gO(55,34),SP(),SP(),SP(),SP()),2&e&&(BE(3),EP("formGroup",t.registrationForm),BE(28),EP("icon",t.faEye),BE(1),EP("ngClass",t.getPasswordHelpClass()),BE(7),EP("disabled",!t.canRegister()),BE(5),EP("ngIf",t.errorMessage),BE(10),EP("routerLink",AT(6,wye)))},directives:[yR,Vx,ER,ux,Ux,PR,Fve,DR,qee,Uve,rM,sM,CF],encapsulation:2}),e}(),Eye=function(){var e=function(){function e(t){gy(this,e),this.router=t}return my(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"playLocally",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["local/"+e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(yF))},e.\u0275cmp=vk({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(mg||(mg=Wg(["Play offline"])))]},template:function(e,t){1&e&&(PP(0,"app-pick-game",0),RP("pickGame",function(e){return t.pickGame(e)}),SP(),PP(1,"button",1),RP("click",function(){return t.playLocally()}),gO(2,2),SP()),2&e&&(BE(1),EP("disabled",!t.selectedGame))},directives:[xve],encapsulation:2}),e}(),bye=function(){var e=function(){function e(t){gy(this,e),this.router=t}return my(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"launchTutorial",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/tutorial/",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(yF))},e.\u0275cmp=vk({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(kg||(kg=Wg(["Learn the rules"])))]},template:function(e,t){1&e&&(PP(0,"app-pick-game",0),RP("pickGame",function(e){return t.pickGame(e)}),SP(),PP(1,"button",1),RP("click",function(){return t.launchTutorial()}),gO(2,2),SP()),2&e&&(BE(1),EP("disabled",!t.selectedGame))},directives:[xve],encapsulation:2}),e}(),Pye=function(){var e=my(function e(){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=vk({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){return[$localize(Cg||(Cg=Wg(["The replay game is loading, please wait, it should not take long."])))]},template:function(e,t){1&e&&(PP(0,"p"),gO(1,0),SP())},encapsulation:2}),e}();function Sye(e,t){if(1&e&&(NC(),OP(0,"polygon",4)),2&e){var n=LP();EP("id",n.mainShapeId)("ngClass",n.pieceClasses),pP("points",n.MartianChessQueenComponent.HEPTAGON)}}function Oye(e,t){if(1&e&&(NC(),OP(0,"polygon",4)),2&e){var n=LP();EP("id",n.mainShapeId)("ngClass",n.pieceClasses),pP("points",n.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function Tye(e,t){if(1&e&&(NC(),OP(0,"circle",5)),2&e){var n=LP();EP("id",n.mainShapeId)("ngClass",n.pieceClasses),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Iye(e,t){if(1&e&&(TP(0),NC(),OP(1,"circle",6),OP(2,"circle",6),OP(3,"circle",6),IP()),2&e){var n=LP();BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(3)),BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function Aye(e,t){if(1&e&&(NC(),PP(0,"g"),OP(1,"circle",7),OP(2,"circle",7),OP(3,"circle",7),SP()),2&e){var n=LP();BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.45*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),BE(1),pP("cx",.45*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),BE(1),pP("cx",.55*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Mye(e,t){if(1&e&&(NC(),PP(0,"g",8),OP(1,"circle",9),OP(2,"circle",9),OP(3,"circle",9),SP()),2&e){var n=LP();EP("ngClass",n.pieceClasses),BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE-3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE+3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}var xye=my(function e(){gy(this,e),this.MartianChessQueenComponent=e,this.MartianChessComponent=Sce,this.horizontalDotsRadius=Sce.SPACE_SIZE/15});function Rye(e,t){if(1&e&&(NC(),OP(0,"polygon",4)),2&e){var n=LP();EP("id",n.mainShapeId)("ngClass",n.pieceClasses),pP("points",n.MartianChessDroneComponent.PENTAGON)}}function Nye(e,t){if(1&e&&(NC(),OP(0,"polygon",4)),2&e){var n=LP();EP("id",n.mainShapeId)("ngClass",n.pieceClasses),pP("points",n.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function Dye(e,t){if(1&e&&(NC(),OP(0,"circle",5)),2&e){var n=LP();EP("id",n.mainShapeId)("ngClass",n.pieceClasses),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Lye(e,t){if(1&e&&(TP(0),NC(),OP(1,"circle",6),OP(2,"circle",6),IP()),2&e){var n=LP();BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function Fye(e,t){if(1&e&&(NC(),PP(0,"g",7),OP(1,"circle",8),OP(2,"circle",8),SP()),2&e){var n=LP();EP("ngClass",n.pieceClasses),BE(1),pP("cx",.4*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),BE(1),pP("cx",.6*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Uye(e,t){if(1&e&&(NC(),PP(0,"g",7),OP(1,"circle",9),OP(2,"circle",9),SP()),2&e){var n=LP();EP("ngClass",n.pieceClasses),BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE-2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE+2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}xye.HEPTAGON=Sce.getRegularPolygon(7),xye.EIGHT_POINTED_STAR=Sce.getNPointedStar(8,0),xye.\u0275fac=function(e){return new(e||xye)},xye.\u0275cmp=vk({type:xye,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(CP(0,Sye,1,3,"polygon",0),CP(1,Oye,1,3,"polygon",0),CP(2,Tye,1,5,"circle",1),CP(3,Iye,4,9,"ng-container",2),CP(4,Aye,4,9,"g",2),CP(5,Mye,4,10,"g",3)),2&e&&(EP("ngIf","Polygon"===t.style.shape),BE(1),EP("ngIf","Star"===t.style.shape),BE(1),EP("ngIf","Circle"===t.style.shape),BE(1),EP("ngIf","Concentric Circles"===t.style.points),BE(1),EP("ngIf","Dots"===t.style.points),BE(1),EP("ngIf","Horizontal Points"===t.style.points))},directives:[sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Vye=my(function e(){gy(this,e),this.MartianChessComponent=Sce,this.MartianChessDroneComponent=e,this.horizontalDotsRadius=Sce.SPACE_SIZE/15});function Bye(e,t){if(1&e&&(NC(),OP(0,"polygon",5)),2&e){var n=LP();EP("id",n.mainShapeId)("ngClass",n.pieceClasses),pP("points",n.MartianChessPawnComponent.TRIANGLE)}}function zye(e,t){if(1&e&&(NC(),OP(0,"polygon",5)),2&e){var n=LP();EP("id",n.mainShapeId)("ngClass",n.pieceClasses),pP("points",n.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function Hye(e,t){if(1&e&&(NC(),OP(0,"circle",6)),2&e){var n=LP();EP("id",n.mainShapeId)("ngClass",n.pieceClasses),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Gye(e,t){if(1&e&&(NC(),OP(0,"circle",7)),2&e){var n=LP();pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE+n.getConcreteTriangleYOffset())("r",n.MartianChessComponent.getRadius(1))}}function $ye(e,t){if(1&e&&(NC(),OP(0,"circle",8)),2&e){var n=LP();pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Zye(e,t){if(1&e&&(NC(),PP(0,"g",9),OP(1,"circle",10),SP()),2&e){var n=LP();EP("ngClass",n.pieceClasses),BE(1),pP("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}Vye.FOUR_POINTED_STAR_VERTICAL=Sce.getNPointedStar(4,0),Vye.PENTAGON=Sce.getRegularPolygon(5),Vye.\u0275fac=function(e){return new(e||Vye)},Vye.\u0275cmp=vk({type:Vye,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(CP(0,Rye,1,3,"polygon",0),CP(1,Nye,1,3,"polygon",0),CP(2,Dye,1,5,"circle",1),CP(3,Lye,3,6,"ng-container",2),CP(4,Fye,3,7,"g",3),CP(5,Uye,3,7,"g",3)),2&e&&(EP("ngIf","Polygon"===t.style.shape),BE(1),EP("ngIf","Star"===t.style.shape),BE(1),EP("ngIf","Circle"===t.style.shape),BE(1),EP("ngIf","Concentric Circles"===t.style.points),BE(1),EP("ngIf","Dots"===t.style.points),BE(1),EP("ngIf","Horizontal Points"===t.style.points))},directives:[sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var qye=function(){function e(){gy(this,e),this.MartianChessComponent=Sce,this.MartianChessPawnComponent=e,this.horizontalDotsRadius=Sce.SPACE_SIZE/15}return my(e,[{key:"getConcreteTriangleYOffset",value:function(){return"Polygon"===this.style.shape?e.TRIANGLE_Y_OFFSET:0}}],[{key:"getTriangle",value:function(){return Sce.getRegularPolygon(3,e.TRIANGLE_Y_OFFSET)}},{key:"yOffsetForVerticalCentering",value:function(){var e=Sce.getRegularPolygonCoords(3).map(function(e){return e.y});return(e.reduce(function(e,t){return Math.min(e,t)})+(100-e.reduce(function(e,t){return Math.max(e,t)})))/4}}]),e}();qye.FOUR_POINTED_STAR_DIAGONAL=Sce.getNPointedStar(4,45),qye.TRIANGLE_Y_OFFSET=qye.yOffsetForVerticalCentering(),qye.TRIANGLE=qye.getTriangle(),qye.\u0275fac=function(e){return new(e||qye)},qye.\u0275cmp=vk({type:qye,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(CP(0,Bye,1,3,"polygon",0),CP(1,zye,1,3,"polygon",0),CP(2,Hye,1,5,"circle",1),CP(3,Gye,1,3,"circle",2),CP(4,$ye,1,3,"circle",3),CP(5,Zye,2,4,"g",4)),2&e&&(EP("ngIf","Polygon"===t.style.shape),BE(1),EP("ngIf","Star"===t.style.shape),BE(1),EP("ngIf","Circle"===t.style.shape),BE(1),EP("ngIf","Concentric Circles"===t.style.points),BE(1),EP("ngIf","Dots"===t.style.points),BE(1),EP("ngIf","Horizontal Points"===t.style.points))},directives:[sM,rM],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Wye={apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631",appId:"1:936588361631:web:2c059886d8d427edbac7aa"},jye=function(){var e=function(){function e(t){gy(this,e),this.authService=t}return my(e,[{key:"canActivate",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){var n;e.userSub=e.authService.subscribeToUser((n=TB(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.evaluateUserPermission(r).then(t);case 2:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}))}));case 1:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bw(G7))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Yye=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e)).router=r,i}return my(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(jye);return e.\u0275fac=function(t){return new(t||e)(Bw(G7),Bw(yF))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Kye(e,t){1&e&&(PP(0,"p",20),gO(1,21),SP())}function Qye(e,t){if(1&e){var n=AP();PP(0,"div",7),PP(1,"p",8),gO(2,9),SP(),PP(3,"div",10),PP(4,"p",11),gO(5,12),SP(),PP(6,"button",13),RP("click",function(){return aC(n),LP().finalizeEmailVerification()}),gO(7,14),SP(),SP(),PP(8,"div",15),PP(9,"p",11),gO(10,16),SP(),PP(11,"button",17),RP("click",function(){return aC(n),LP().sendEmailVerification()}),gO(12,18),SP(),SP(),CP(13,Kye,2,0,"p",19),SP()}if(2&e){var r=LP();BE(2),yO(r.emailAddress),mO(2),BE(11),EP("ngIf",r.success)}}function Xye(e,t){if(1&e){var n=AP();PP(0,"div",24),PP(1,"div",8),gO(2,25),SP(),PP(3,"form",26),PP(4,"div",27),PP(5,"div",28),OP(6,"input",29),SP(),PP(7,"div",28),PP(8,"button",30),RP("click",function(){aC(n);var e=LP(2);return e.pickUsername(e.usernameForm.value)}),gO(9,31),SP(),SP(),SP(),SP(),SP()}if(2&e){var r=LP(2);BE(3),EP("formGroup",r.usernameForm)}}var Jye=function(){return["/lobby"]};function eme(e,t){1&e&&(PP(0,"div",32),vO(1,33),OP(2,"a",34),pO(),SP()),2&e&&(BE(2),EP("routerLink",AT(1,Jye)))}function tme(e,t){if(1&e&&(TP(0),CP(1,Xye,10,1,"div",22),CP(2,eme,3,2,"div",23),IP()),2&e){var n=LP();BE(1),EP("ngIf",!n.success),BE(1),EP("ngIf",n.success)}}function nme(e,t){if(1&e&&(PP(0,"div",35),PP(1,"div",36),uS(2),SP(),SP()),2&e){var n=LP();BE(2),cS(n.errorMessage)}}var rme=function(){var e=function(){function e(t,n){gy(this,e),this.authService=t,this.router=n,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new cR({username:new uR})}return my(e,[{key:"ngOnInit",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.userSub=e.authService.subscribeToUser(function(){var t=TB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.emailAddress=n.email.get(),!n.username.isAbsent()){t.next=5;break}e.verificationType="enter-username",t.next=11;break;case 5:if(e.verificationType="send-email",!0===e.triedToFinalize&&!1===n.verified&&(e.errorMessage=$localize(wg||(wg=Wg(["You have not verified your email! Click on the link in the verification email."])))),t.t0=!0===n.verified,!t.t0){t.next=11;break}return t.next=11,e.router.navigate(["/lobby"]);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"pickUsername",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authService.setUsername(e.username);case 2:(r=n.sent).isSuccess()?t.success=!0:t.errorMessage=r.getReason();case 4:case"end":return n.stop()}},n)}))()}},{key:"sendEmailVerification",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.sendEmailVerification();case 2:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=n.getReason();case 4:case"end":return t.stop()}},t)}))()}},{key:"finalizeEmailVerification",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.triedToFinalize=!0,t.next=3,e.authService.reloadUser();case 3:window.open(window.location.href,"_self");case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(G7),_P(yF))},e.\u0275cmp=vk({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){return[[1,"box"],[1,"message","is-info"],[1,"message-header"],$localize(_g||(_g=Wg(["Account verification"]))),["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],$localize(Eg||(Eg=Wg(["In order to finalize your account, you must click on the link that you should have received on your email address (",":INTERPOLATION:). The email could be in your spam folder."])),"\ufffd0\ufffd"),[1,"block","level-left"],[1,"level-item"],$localize(bg||(bg=Wg(["Once you have verified your email, click on the following button:"]))),["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],$localize(Pg||(Pg=Wg(["Finalize email verification"]))),[1,"level-left"],$localize(Sg||(Sg=Wg(["If you have not received the verification email, click on the following button:"]))),["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],$localize(Og||(Og=Wg(["Send verification email again"]))),["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],$localize(Tg||(Tg=Wg(["The email has been sent"]))),["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],$localize(Ig||(Ig=Wg(["In order to finalize your account, you must choose a username."]))),[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",$localize(Ag||(Ag=Wg(["Username"]))),"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],$localize(Mg||(Mg=Wg(["Pick username"]))),["id","success",1,"message-body"],$localize(xg||(xg=Wg(["Your account has now been finalized, you can go back to the ",":START_LINK:list of games",":CLOSE_LINK:."])),"\ufffd#2\ufffd","\ufffd/#2\ufffd"),[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(PP(0,"div",0),PP(1,"div",1),PP(2,"div",2),gO(3,3),SP(),CP(4,Qye,14,2,"div",4),CP(5,tme,3,2,"ng-container",5),SP(),CP(6,nme,3,1,"div",6),SP()),2&e&&(BE(4),EP("ngIf","send-email"===t.verificationType),BE(1),EP("ngIf","enter-username"===t.verificationType),BE(1),EP("ngIf",t.errorMessage))},directives:[sM,yR,Vx,ER,ux,DR,Ux,PR,CF],encapsulation:2}),e}(),ime=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e)).router=r,i}return my(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(jye);return e.\u0275fac=function(t){return new(t||e)(Bw(G7),Bw(yF))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ame=function(){var e=function(e){iy(n,e);var t=oy(n);function n(e,r){var i;return gy(this,n),(i=t.call(this,e)).router=r,i}return my(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(jye);return e.\u0275fac=function(t){return new(t||e)(Bw(G7),Bw(yF))},e.\u0275prov=Um({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function ome(e,t){1&e&&(PP(0,"p",12),gO(1,13),SP())}function sme(e,t){if(1&e&&(PP(0,"div",14),PP(1,"div",15),gO(2,16),SP(),PP(3,"div",17),uS(4),SP(),SP()),2&e){var n=LP();BE(4),cS(n.errorMessage.get())}}var ume=function(){return{standalone:!0}},cme=function(){var e=function(){function e(t){gy(this,e),this.authService=t,this.success=!1,this.errorMessage=NB.empty(),this.email=""}return my(e,[{key:"resetPassword",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return F7(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=NB.empty(),e.success=!1,t.next=3,e.authService.sendPasswordResetEmail(e.email);case 3:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=NB.of(n.getReason());case 5:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(G7))},e.\u0275cmp=vk({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){return[[1,"box"],[1,"title"],$localize(Rg||(Rg=Wg(["Password reset"]))),[1,"field"],[1,"control"],["id","email","name","email","placeholder",$localize(Ng||(Ng=Wg(["Email"]))),"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],$localize(Dg||(Dg=Wg(["An email will be sent with instruction to reset your password."]))),["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],$localize(Lg||(Lg=Wg(["Reset password"]))),["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],$localize(Fg||(Fg=Wg(["The email has been sent, please follow the instructions from that email."]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(Ug||(Ug=Wg(["Error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(PP(0,"div",0),PP(1,"p",1),gO(2,2),SP(),PP(3,"div",3),PP(4,"div",4),PP(5,"input",5),RP("ngModelChange",function(e){return t.email=e}),SP(),PP(6,"p",6),gO(7,7),SP(),CP(8,ome,2,0,"p",8),SP(),SP(),PP(9,"button",9),RP("click",function(){return t.resetPassword()}),gO(10,10),SP(),CP(11,sme,5,1,"div",11),SP()),2&e&&(BE(5),EP("ngModel",t.email)("ngModelOptions",AT(5,ume)),BE(3),EP("ngIf",t.success),BE(1),EP("disabled",""===t.email),BE(2),EP("ngIf",t.errorMessage.isPresent()))},directives:[ux,Fve,DR,Ux,gR,sM],encapsulation:2}),e}();function lme(e,t){if(1&e&&(PP(0,"option",13),uS(1),SP()),2&e){var n=t.$implicit,r=LP();EP("value",n.value)("selected",n.value===r.currentTheme),BE(1),lS(" ",n.name," ")}}function fme(e,t){if(1&e&&(PP(0,"option",13),uS(1),SP()),2&e){var n=t.$implicit,r=LP();EP("value",n.value)("selected",n.value===r.currentLanguage),BE(1),lS(" ",n.name," ")}}var hme=function(){var e=function(){function e(t,n){gy(this,e),this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize(Vg||(Vg=Wg(["Light"])))},{value:"dark",name:$localize(Bg||(Bg=Wg(["Dark"])))}],this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}return my(e,[{key:"changeLanguage",value:function(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}},{key:"changeTheme",value:function(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}},{key:"reload",value:function(){window.open(window.location.href,"_self")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(v9),_P(p9))},e.\u0275cmp=vk({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){return[[1,"box"],[1,"title"],$localize(zg||(zg=Wg(["User settings"]))),[1,"field"],["for","theme",1,"label"],$localize(Hg||(Hg=Wg(["Theme"]))),[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],$localize(Gg||(Gg=Wg(["Language"]))),["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(PP(0,"div",0),PP(1,"p",1),gO(2,2),SP(),PP(3,"div",3),PP(4,"label",4),gO(5,5),SP(),PP(6,"div",6),PP(7,"div",7),PP(8,"select",8),RP("change",function(e){return t.changeTheme(e)}),CP(9,lme,2,3,"option",9),SP(),SP(),SP(),SP(),PP(10,"div",3),PP(11,"label",10),gO(12,11),SP(),PP(13,"div",6),PP(14,"div",7),PP(15,"select",12),RP("change",function(e){return t.changeLanguage(e)}),CP(16,fme,2,3,"option",9),SP(),SP(),SP(),SP(),SP()),2&e&&(BE(9),EP("ngForOf",t.availableThemes),BE(7),EP("ngForOf",t.availableLanguages))},directives:[aM,IR,RR],encapsulation:2}),e}(),dme=function(){var e=my(function e(){gy(this,e)});return e.ALREADY_INGAME=function(){return $localize($g||($g=Wg(["You are already in a game. Finish it or cancel it first."])))},e}(),vme=function(){var e=function(){function e(t,n,r,i,a,o){gy(this,e),this.route=t,this.router=n,this.connectedUserService=r,this.messageDisplayer=i,this.activePartsService=a,this.gameService=o}return my(e,[{key:"ngOnInit",value:function(){var e=this;return TB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameAndRedirectOrShowError(e.extractGameFromURL());case 2:case"end":return t.stop()}},t)}))()}},{key:"extractGameFromURL",value:function(){return IB.getNonNullable(this.route.snapshot.paramMap.get("compo"))}},{key:"createGameAndRedirectOrShowError",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(F7((r=t.connectedUserService.user.get()).isConnected(),"User must be connected and have a username to reach this page"),i=r.toMinimalUser(),!1!==t.gameExists(e)){n.next=7;break}return n.next=6,t.router.navigate(["/notFound",vpe.NO_MATCHING_GAME(e)],{skipLocationChange:!0});case 6:case 19:return n.abrupt("return",!1);case 7:return n.next=9,t.canCreateOnlineGame(i);case 9:if(!n.sent){n.next=16;break}return n.next=12,t.gameService.createPartConfigRoomAndChat(e);case 12:return a=n.sent,n.next=15,t.router.navigate(["/play",e,a]);case 15:return n.abrupt("return",!0);case 16:return t.messageDisplayer.infoMessage(dme.ALREADY_INGAME()),n.next=19,t.router.navigate(["/lobby"]);case 20:case"end":return n.stop()}},n)}))()}},{key:"gameExists",value:function(e){return NB.ofNullable(Mve.ALL_GAMES().find(function(t){return t.urlName===e})).isPresent()}},{key:"canCreateOnlineGame",value:function(e){var t=this;return TB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=!1,n.next=3,t.activePartsService.userHasActivePart(e);case 3:return n.t1=n.sent,n.abrupt("return",n.t0===n.t1);case 5:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_P(KD),_P(yF),_P(G7),_P(D7),_P($ve),_P(c9))},e.\u0275cmp=vk({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){return[$localize(Zg||(Zg=Wg(["Creating online game, please wait, it should not take long."])))]},template:function(e,t){1&e&&(PP(0,"p"),gO(1,0),SP())},encapsulation:2}),e}();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[CS.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),gS[t]=e,n&&(gS[t][CS.ExtraData]=n)}(e,void 0,void 0)}(SB());var pme=[{path:"login",component:Hve},{path:"lobby",component:lpe,canActivate:[Yye]},{path:"settings",component:hme},{path:"register",component:_ye,canActivate:[ame]},{path:"reset-password",component:cme,canActivate:[ame]},{path:"notFound/:message",component:fpe},{path:"nextGameLoading",component:Pye,canActivate:[Yye]},{path:"verify-account",component:rme,canActivate:[ime]},{path:"play",component:Zve,canActivate:[Yye]},{path:"play/:compo",component:vme,canActivate:[Yye]},{path:"play/:compo/:id",component:Lge,canActivate:[Yye]},{path:"local",component:Eye},{path:"local/:compo",component:tye},{path:"tutorial",component:bye},{path:"tutorial/:compo",component:kye},{path:"",component:Lve},{path:"**",component:fpe}],gme=function(){function e(){gy(this,e)}return my(e,null,[{key:"app",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:n4,providers:[{provide:X3,useFactory:t4(e),multi:!0,deps:[EI,eP,G3].concat(n)}]}}(function(){return r4(Wye)})}},{key:"firestore",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:v7,providers:[{provide:l7,useFactory:f7(e),multi:!0,deps:[EI,eP,G3,Q3,[new jw,Y8],[new jw,L4]].concat(n)}]}}(function(){var e=w7();return e.toJSON(),e})}},{key:"auth",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:e7,providers:[{provide:K8,useFactory:Q8(e),multi:!0,deps:[EI,eP,G3,Q3,[new jw,L4]].concat(n)}]}}(function(){return n7()})}}]),e}(),yme=function(){var e=my(function e(){gy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=mk({type:e,bootstrap:[ste]}),e.\u0275inj=Vm({providers:[G7,c9,u9,V7,x7,p9,{provide:fI,useValue:d9.getLocale()}],imports:[[gme.app(),gme.firestore(),gme.auth(),jM,bN,xF.forRoot(pme,{useHash:!1}),BR,VR,bB,Wee]]}),e}();!function(e,t,n){var r=e.\u0275cmp;r.directiveDefs=function(){return t.map(pk)},r.pipeDefs=function(){return n.map(gk)}}(Sce,[aM,rM,sM,qye,Vye,xye],[]),"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;var mme=function(){function e(t){gy(this,e),this.digits=t}return my(e,[{key:"clone",value:function(){return new e(this.digits.slice())}},{key:"add",value:function(e){var t=this.clone();return t.addToSelf(e),t}},{key:"addToSelf",value:function(e){for(var t=Math.max(this.digits.length,e.digits.length),n=0,r=0;r<t;r++){var i=n;r<this.digits.length&&(i+=this.digits[r]),r<e.digits.length&&(i+=e.digits[r]),i>=10?(this.digits[r]=i-10,n=1):(this.digits[r]=i,n=0)}n>0&&(this.digits[t]=1)}},{key:"toString",value:function(){for(var e="",t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}],[{key:"zero",value:function(){return new e([0])}},{key:"one",value:function(){return new e([1])}}]),e}(),kme=function(){function e(t){gy(this,e),this.powerOfTwos=[t]}return my(e,[{key:"getValue",value:function(){return this.powerOfTwos[0]}},{key:"multiplyBy",value:function(e){var t=mme.zero();return this.multiplyByAndAddTo(e,t),t}},{key:"multiplyByAndAddTo",value:function(e,t){for(var n=0;0!==e;e>>>=1,n++)if(1&e){var r=this.getMultipliedByPowerOfTwo(n);t.addToSelf(r)}}},{key:"getMultipliedByPowerOfTwo",value:function(e){for(var t=this.powerOfTwos.length;t<=e;t++){var n=this.powerOfTwos[t-1];this.powerOfTwos[t]=n.add(n)}return this.powerOfTwos[e]}}]),e}(),Cme=function(){function e(t){gy(this,e),this.base=t,this.exponents=[new kme(mme.one())]}return my(e,[{key:"toThePowerOf",value:function(e){for(var t=this.exponents.length;t<=e;t++){var n=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new kme(n)}return this.exponents[e]}}]),e}();function wme(e){var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){var i=e.charCodeAt(n+1);i>=56320&&i<=57343&&(n++,r=(r-55296<<10)+i-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e),n=_me(t,0),r=_me(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function _me(e,t){var n,r=2654435769,i=2654435769,a=e.length;for(n=0;n+12<=a;n+=12){var o=Eme(r=Pme(r,Ime(e,n,bme.Little)),i=Pme(i,Ime(e,n+4,bme.Little)),t=Pme(t,Ime(e,n+8,bme.Little)));r=o[0],i=o[1],t=o[2]}return r=Pme(r,Ime(e,n,bme.Little)),i=Pme(i,Ime(e,n+4,bme.Little)),t=Pme(t,a),Eme(r,i,t=Pme(t,Ime(e,n+8,bme.Little)<<8))[2]}function Eme(e,t,n){return e=Ome(e,t),e=Ome(e,n),e^=n>>>13,t=Ome(t,n),t=Ome(t,e),t^=e<<8,n=Ome(n,e),n=Ome(n,t),n^=t>>>13,e=Ome(e,t),e=Ome(e,n),e^=n>>>12,t=Ome(t,n),t=Ome(t,e),t^=e<<16,n=Ome(n,e),n=Ome(n,t),n^=t>>>5,e=Ome(e,t),e=Ome(e,n),e^=n>>>3,t=Ome(t,n),t=Ome(t,e),t^=e<<10,n=Ome(n,e),n=Ome(n,t),[e,t,n^=t>>>15]}var bme=((bme=bme||{})[bme.Little=0]="Little",bme[bme.Big=1]="Big",bme);function Pme(e,t){return Sme(e,t)[1]}function Sme(e,t){var n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function Ome(e,t){var n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function Tme(e,t){return t>=e.length?0:e[t]}function Ime(e,t,n){var r=0;if(n===bme.Big)for(var i=0;i<4;i++)r+=Tme(e,t+i)<<24-8*i;else for(var a=0;a<4;a++)r+=Tme(e,t+a)<<8*a;return r}var Ame=new Cme(256);function Mme(e,t){if(":"!==t.charAt(0))return{text:e};var n=function(e,t){for(var n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error('Unterminated $localize metadata block in "'.concat(t,'".'))}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}function xme(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});var Rme=function(e){iy(n,e);var t=oy(n);function n(e){var r;return gy(this,n),(r=t.call(this,"No translation found for ".concat(Dme(e),"."))).parsedMessage=e,r.type="MissingTranslationError",r}return my(n)}(ey(Error));function Nme(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function Dme(e){var t=e.meaning&&' - "'.concat(e.meaning,'"'),n=e.legacyIds&&e.legacyIds.length>0?" [".concat(e.legacyIds.map(function(e){return'"'.concat(e,'"')}).join(", "),"]"):"";return'"'.concat(e.id,'"').concat(n,' ("').concat(e.text,'"').concat(t,")")}function Lme(e,t){try{return function(e,t,n){var r=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a={},o={},s=function(e,t){var n=Mme(e,t),r=n.text,i=n.block;if(void 0===i)return{text:r};var a=qg(i.split("\u241f")),o=a[0],s=a.slice(1),u=Qg(o.split("@@",2),2),c=u[0],l=u[1],f=Qg(c.split("|",2),2),h=f[0],d=f[1];return void 0===d&&(d=h,h=void 0),""===d&&(d=void 0),{text:r,meaning:h,description:d,customId:l,legacyIds:s}}(e[0],e.raw[0]),u=[s.text],c=[],l=s.text,f=1;f<e.length;f++){var h=Mme(e[f],e.raw[f]),d=h.text,v=h.block,p=void 0===v?xme(f):v;l+="{$".concat(p,"}").concat(d),void 0!==t&&(a[p]=t[f-1],o[p]=i[f-1]),c.push(p),u.push(d)}var g=s.customId||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=wme(e);if(t){var r=wme(t);n=function(e,t){var n=e[0],r=t[0],i=Sme(e[1],t[1]),a=i[0],o=i[1];return[Pme(Pme(n,r),a),o]}(function(e,t){var n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),r)}return function(e,t){var n=Ame.toThePowerOf(0).multiplyBy(t);return Ame.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(l,s.meaning||""),y=s.legacyIds?s.legacyIds.filter(function(e){return e!==g}):[];return{id:g,legacyIds:y,substitutions:a,substitutionLocations:o,text:l,customId:s.customId,meaning:s.meaning||"",description:s.description||"",messageParts:u,messagePartLocations:r,placeholderNames:c,location:n}}(t,n),i=e[r.id];if(void 0!==r.legacyIds)for(var a=0;a<r.legacyIds.length&&void 0===i;a++)i=e[r.legacyIds[a]];if(void 0===i)throw new Rme(r);return[i.messageParts,i.placeholderNames.map(function(e){if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error("There is a placeholder name mismatch with the translation provided for the message ".concat(Dme(r),".\nThe translation contains a placeholder with name ").concat(e,", which does not exist in the message."))})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function Fme(){(function(){if(DI)throw new Error("Cannot enable prod mode after platform setup.");NI=!1})(),qM().bootstrapModule(yme).catch(function(e){return console.error(e)})}var Ume=d9.getLocale();"en"!==Ume?fetch("/assets/"+Ume+".json").then(function(e){return e.ok?e.json():{locale:"en",translations:{}}}).then(function(e){(function(e){$localize.translate||($localize.translate=Lme),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(function(t){$localize.TRANSLATIONS[t]=function(e){for(var t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[],i=1;i<t.length-1;i+=2)r.push(t[i]),n.push("".concat(t[i+1]));var a=n.map(function(e){return":"===e.charAt(0)?"\\"+e:e});return{text:e,messageParts:Nme(n,a),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,Fme()}).catch(function(e){console.log(e)}):Fme()}},function(e){e(e.s=2791)}])}();