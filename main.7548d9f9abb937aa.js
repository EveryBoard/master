(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{9713:(l9,Q5,_c)=>{"use strict";function ln(n){return"function"==typeof n}function as(n){const e=n(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const e4=as(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,s)=>`${s+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function i3(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class k1{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const i of e)i.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(ln(r))try{r()}catch(i){t=i instanceof e4?i.errors:[i]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const i of s)try{vn(i)}catch(o){t=t??[],o instanceof e4?t=[...t,...o.errors]:t.push(o)}}if(t)throw new e4(t)}}add(t){var e;if(t&&t!==this)if(this.closed)vn(t);else{if(t instanceof k1){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&i3(e,t)}remove(t){const{_finalizers:e}=this;e&&i3(e,t),t instanceof k1&&t._removeParent(this)}}k1.EMPTY=(()=>{const n=new k1;return n.closed=!0,n})();const k8=k1.EMPTY;function o3(n){return n instanceof k1||n&&"closed"in n&&ln(n.remove)&&ln(n.add)&&ln(n.unsubscribe)}function vn(n){ln(n)?n():n.unsubscribe()}const vc={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},a3={setTimeout(n,t,...e){const{delegate:r}=a3;return r?.setTimeout?r.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=a3;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function t4(n){a3.setTimeout(()=>{const{onUnhandledError:t}=vc;if(!t)throw n;t(n)})}function yo(){}const ni=L8("C",void 0,void 0);function L8(n,t,e){return{kind:n,value:t,error:e}}let c3=null;function mt(n){if(vc.useDeprecatedSynchronousErrorHandling){const t=!c3;if(t&&(c3={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:r}=c3;if(c3=null,e)throw r}}else n()}class rn extends k1{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,o3(t)&&t.add(this)):this.destination=e7}static create(t,e,r){return new or(t,e,r)}next(t){this.isStopped?f9(function u9(n){return L8("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?f9(function cl(n){return L8("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?f9(ni,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const o1=Function.prototype.bind;function Fs(n,t){return o1.call(n,t)}class xn{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(r){n4(r)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(r){n4(r)}else n4(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){n4(e)}}}class or extends rn{constructor(t,e,r){let s;if(super(),ln(t)||!t)s={next:t??void 0,error:e??void 0,complete:r??void 0};else{let i;this&&vc.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&Fs(t.next,i),error:t.error&&Fs(t.error,i),complete:t.complete&&Fs(t.complete,i)}):s=t}this.destination=new xn(s)}}function n4(n){vc.useDeprecatedSynchronousErrorHandling?function ft(n){vc.useDeprecatedSynchronousErrorHandling&&c3&&(c3.errorThrown=!0,c3.error=n)}(n):t4(n)}function f9(n,t){const{onStoppedNotification:e}=vc;e&&a3.setTimeout(()=>e(n,t))}const e7={closed:!0,next:yo,error:function J5(n){throw n},complete:yo},E_="function"==typeof Symbol&&Symbol.observable||"@@observable";function ll(n){return n}function M_(n){return 0===n.length?ll:1===n.length?n[0]:function(e){return n.reduce((r,s)=>s(r),e)}}let Mr=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,s){const i=function t7(n){return n&&n instanceof rn||function mT(n){return n&&ln(n.next)&&ln(n.error)&&ln(n.complete)}(n)&&o3(n)}(e)?e:new or(e,r,s);return mt(()=>{const{operator:o,source:c}=this;i.add(o?o.call(i,c):c?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=h9(r))((s,i)=>{const o=new or({next:c=>{try{e(c)}catch(u){i(u),o.unsubscribe()}},error:i,complete:s});this.subscribe(o)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[E_](){return this}pipe(...e){return M_(e)(this)}toPromise(e){return new(e=h9(e))((r,s)=>{let i;this.subscribe(o=>i=o,o=>s(o),()=>r(i))})}}return n.create=t=>new n(t),n})();function h9(n){var t;return null!==(t=n??vc.Promise)&&void 0!==t?t:Promise}const mF=as(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let W2=(()=>{class n extends Mr{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new d9(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new mF}next(e){mt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){mt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){mt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:s,observers:i}=this;return r||s?k8:(this.currentObservers=null,i.push(e),new k1(()=>{this.currentObservers=null,i3(i,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:s,isStopped:i}=this;r?e.error(s):i&&e.complete()}asObservable(){const e=new Mr;return e.source=this,e}}return n.create=(t,e)=>new d9(t,e),n})();class d9 extends W2{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)}error(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:k8}}function S_(n){return ln(n?.lift)}function hr(n){return t=>{if(S_(t))return t.lift(function(e){try{return n(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function cs(n,t,e,r,s){return new _T(n,t,e,r,s)}class _T extends rn{constructor(t,e,r,s,i,o){super(t),this.onFinalize=i,this.shouldUnsubscribe=o,this._next=e?function(c){try{e(c)}catch(u){t.error(u)}}:super._next,this._error=s?function(c){try{s(c)}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function Cn(n,t){return hr((e,r)=>{let s=0;e.subscribe(cs(r,i=>{r.next(n.call(t,i,s++))}))})}function r7(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(n);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(e[r[s]]=n[r[s]])}return e}function jr(n){return this instanceof jr?(this.v=n,this):new jr(n)}function o2(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=e.apply(n,t||[]),i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(E){r[E]&&(s[E]=function(O){return new Promise(function(k,U){i.push([E,O,k,U])>1||c(E,O)})})}function c(E,O){try{!function u(E){E.value instanceof jr?Promise.resolve(E.value.v).then(h,g):m(i[0][2],E)}(r[E](O))}catch(k){m(i[0][3],k)}}function h(E){c("next",E)}function g(E){c("throw",E)}function m(E,O){E(O),i.shift(),i.length&&c(i[0][0],i[0][1])}}function PT(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function w_(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=n[i]&&function(o){return new Promise(function(c,u){!function s(i,o,c,u){Promise.resolve(u).then(function(h){i({value:h,done:c})},o)}(c,u,(o=n[i](o)).done,o.value)})}}}const N_=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function I_(n){return ln(n?.then)}function m9(n){return ln(n[E_])}function x_(n){return Symbol.asyncIterator&&ln(n?.[Symbol.asyncIterator])}function Cc(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const L1=function R8(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function yc(n){return ln(n?.[L1])}function La(n){return o2(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:r,done:s}=yield jr(e.read());if(s)return yield jr(void 0);yield yield jr(r)}}finally{e.releaseLock()}})}function k_(n){return ln(n?.getReader)}function Eo(n){if(n instanceof Mr)return n;if(null!=n){if(m9(n))return function ul(n){return new Mr(t=>{const e=n[E_]();if(ln(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(N_(n))return function a2(n){return new Mr(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(I_(n))return function L_(n){return new Mr(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,t4)})}(n);if(x_(n))return fl(n);if(yc(n))return function TT(n){return new Mr(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(k_(n))return function _9(n){return fl(La(n))}(n)}throw Cc(n)}function fl(n){return new Mr(t=>{(function wT(n,t){var e,r,s,i;return function yT(n,t,e,r){return new(e||(e=Promise))(function(i,o){function c(g){try{h(r.next(g))}catch(m){o(m)}}function u(g){try{h(r.throw(g))}catch(m){o(m)}}function h(g){g.done?i(g.value):function s(i){return i instanceof e?i:new e(function(o){o(i)})}(g.value).then(c,u)}h((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=PT(n);!(r=yield e.next()).done;)if(t.next(r.value),t.closed)return}catch(o){s={error:o}}finally{try{r&&!r.done&&(i=e.return)&&(yield i.call(e))}finally{if(s)throw s.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Bs(n,t,e,r=0,s=!1){const i=t.schedule(function(){e(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function Ve(n,t,e=1/0){return ln(t)?Ve((r,s)=>Cn((i,o)=>t(r,i,s,o))(Eo(n(r,s))),e):("number"==typeof t&&(e=t),hr((r,s)=>function Qo(n,t,e,r,s,i,o,c){const u=[];let h=0,g=0,m=!1;const E=()=>{m&&!u.length&&!h&&t.complete()},O=U=>h<r?k(U):u.push(U),k=U=>{i&&t.next(U),h++;let j=!1;Eo(e(U,g++)).subscribe(cs(t,oe=>{s?.(oe),i?O(oe):t.next(oe)},()=>{j=!0},void 0,()=>{if(j)try{for(h--;u.length&&h<r;){const oe=u.shift();o?Bs(t,o,()=>k(oe)):k(oe)}E()}catch(oe){t.error(oe)}}))};return n.subscribe(cs(t,O,()=>{m=!0,E()})),()=>{c?.()}}(r,s,n,e)))}function hl(n=1/0){return Ve(ll,n)}const Ec=new Mr(n=>n.complete());function dl(n){return n[n.length-1]}function tn(n){return ln(dl(n))?n.pop():void 0}function r4(n){return function V6(n){return n&&ln(n.schedule)}(dl(n))?n.pop():void 0}function pl(n,t=0){return hr((e,r)=>{e.subscribe(cs(r,s=>Bs(r,n,()=>r.next(s),t),()=>Bs(r,n,()=>r.complete(),t),s=>Bs(r,n,()=>r.error(s),t)))})}function Mc(n,t=0){return hr((e,r)=>{r.add(n.schedule(()=>e.subscribe(r),t))})}function o7(n,t){if(!n)throw new Error("Iterable cannot be null");return new Mr(e=>{Bs(e,t,()=>{const r=n[Symbol.asyncIterator]();Bs(e,t,()=>{r.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function ls(n,t){return t?function D8(n,t){if(null!=n){if(m9(n))return function i7(n,t){return Eo(n).pipe(Mc(t),pl(t))}(n,t);if(N_(n))return function ea(n,t){return new Mr(e=>{let r=0;return t.schedule(function(){r===n.length?e.complete():(e.next(n[r++]),e.closed||this.schedule())})})}(n,t);if(I_(n))return function H6(n,t){return Eo(n).pipe(Mc(t),pl(t))}(n,t);if(x_(n))return o7(n,t);if(yc(n))return function v9(n,t){return new Mr(e=>{let r;return Bs(e,t,()=>{r=n[L1](),Bs(e,t,()=>{let s,i;try{({value:s,done:i}=r.next())}catch(o){return void e.error(o)}i?e.complete():e.next(s)},0,!0)}),()=>ln(r?.return)&&r.return()})}(n,t);if(k_(n))return function F6(n,t){return o7(La(n),t)}(n,t)}throw Cc(n)}(n,t):Eo(n)}function a7(n,t,...e){if(!0===t)return void n();if(!1===t)return;const r=new or({next:()=>{r.unsubscribe(),n()}});return Eo(t(...e)).subscribe(r)}function T1(n){for(let t in n)if(n[t]===T1)return t;throw Error("Could not find renamed property on target object.")}function C9(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function Z1(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Z1).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function z8(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const D_=T1({__forward_ref__:T1});function w1(n){return n.__forward_ref__=w1,n.toString=function(){return Z1(this())},n}function sn(n){return B6(n)?n():n}function B6(n){return"function"==typeof n&&n.hasOwnProperty(D_)&&n.__forward_ref__===w1}class Ne extends Error{constructor(t,e){super(function l3(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}(t,e)),this.code=t}}function on(n){return"string"==typeof n?n:null==n?"":String(n)}function U6(n,t){throw new Ne(-201,!1)}function O1(n,t,e,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${e} ${r} ${t} <=Actual]`))}function nt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Zr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Rn(n){return F_(n,G6)||F_(n,S9)}function F_(n,t){return n.hasOwnProperty(t)?n[t]:null}function F8(n){return n&&(n.hasOwnProperty(Me)||n.hasOwnProperty(P9))?n[Me]:null}const G6=T1({\u0275prov:T1}),Me=T1({\u0275inj:T1}),S9=T1({ngInjectableDef:T1}),P9=T1({ngInjectorDef:T1});var Yt=(()=>((Yt=Yt||{})[Yt.Default=0]="Default",Yt[Yt.Host=1]="Host",Yt[Yt.Self=2]="Self",Yt[Yt.SkipSelf=4]="SkipSelf",Yt[Yt.Optional=8]="Optional",Yt))();let T9;function ta(n){const t=T9;return T9=n,t}function w9(n,t,e){const r=Rn(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&Yt.Optional?null:void 0!==t?t:void U6(Z1(n))}function o4(n){return{toString:n}.toString()}var Y2=(()=>((Y2=Y2||{})[Y2.OnPush=0]="OnPush",Y2[Y2.Default=1]="Default",Y2))(),$1=(()=>{return(n=$1||($1={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",$1;var n})();const X1=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),K={},M1=[],f7=T1({\u0275cmp:T1}),O9=T1({\u0275dir:T1}),b9=T1({\u0275pipe:T1}),B8=T1({\u0275mod:T1}),u3=T1({\u0275fac:T1}),f3=T1({__NG_ELEMENT_ID__:T1});let xT=0;function ct(n){return o4(()=>{const e=!0===n.standalone,r={},s={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Y2.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||M1,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||$1.Emulated,id:"c"+xT++,styles:n.styles||M1,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.dependencies,o=n.features;return s.inputs=N9(n.inputs,r),s.outputs=N9(n.outputs),o&&o.forEach(c=>c(s)),s.directiveDefs=i?()=>("function"==typeof i?i():i).map(A9).filter(h7):null,s.pipeDefs=i?()=>("function"==typeof i?i():i).map(l2).filter(h7):null,s})}function $8(n,t,e){const r=n.\u0275cmp;r.directiveDefs=()=>("function"==typeof t?t():t).map(A9),r.pipeDefs=()=>("function"==typeof e?e():e).map(l2)}function A9(n){return b1(n)||c2(n)}function h7(n){return null!==n}function oi(n){return o4(()=>({type:n.type,bootstrap:n.bootstrap||M1,declarations:n.declarations||M1,imports:n.imports||M1,exports:n.exports||M1,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function N9(n,t){if(null==n)return K;const e={};for(const r in n)if(n.hasOwnProperty(r)){let s=n[r],i=s;Array.isArray(s)&&(i=s[1],s=s[0]),e[s]=r,t&&(t[s]=i)}return e}const qt=ct;function ai(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function b1(n){return n[f7]||null}function c2(n){return n[O9]||null}function l2(n){return n[b9]||null}function So(n,t){const e=n[B8]||null;if(!e&&!0===t)throw new Error(`Type ${Z1(n)} does not have '\u0275mod' property.`);return e}function Po(n){return Array.isArray(n)&&"object"==typeof n[1]}function Sr(n){return Array.isArray(n)&&!0===n[1]}function X2(n){return 0!=(8&n.flags)}function ia(n){return 2==(2&n.flags)}function oa(n){return 1==(1&n.flags)}function Ss(n){return null!==n.template}function Y6(n){return 0!=(256&n[2])}function Da(n,t){return n.hasOwnProperty(u3)?n[u3]:null}class RT{constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function h2(){return W_}function W_(n){return n.type.prototype.ngOnChanges&&(n.setInput=j_),DT}function DT(){const n=v7(this),t=n?.current;if(t){const e=n.previous;if(e===K)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function j_(n,t,e,r){const s=v7(n)||function zT(n,t){return n[Z_]=t}(n,{previous:K,current:null}),i=s.current||(s.current={}),o=s.previous,c=this.declaredInputs[e],u=o[c];i[c]=new RT(u&&u.currentValue,t,o===K),n[r]=t}h2.ngInherit=!0;const Z_="__ngSimpleChanges__";function v7(n){return n[Z_]||null}function Pr(n){for(;Array.isArray(n);)n=n[0];return n}function q8(n,t){return Pr(t[n])}function d2(n,t){return Pr(t[n.index])}function R9(n,t){return n.data[t]}function _l(n,t){return n[t]}function Ri(n,t){const e=t[n];return Po(e)?e:e[0]}function Q6(n){return 64==(64&n[2])}function d3(n,t){return null==t?null:n[t]}function Q_(n){n[18]=0}function D9(n,t){n[5]+=t;let e=n,r=n[3];for(;null!==r&&(1===t&&1===e[5]||-1===t&&0===e[5]);)r[5]+=t,e=r,r=r[3]}const un={lFrame:U9(null),bindingsEnabled:!0};function z9(){return un.bindingsEnabled}function Re(){return un.lFrame.lView}function Jn(){return un.lFrame.tView}function de(n){return un.lFrame.contextLView=n,n[8]}function le(n){return un.lFrame.contextLView=null,n}function Vr(){let n=J_();for(;null!==n&&64===n.type;)n=n.parent;return n}function J_(){return un.lFrame.currentTNode}function vl(){const n=un.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}function Sc(n,t){const e=un.lFrame;e.currentTNode=n,e.isParent=t}function Yr(){return un.lFrame.isParent}function V9(){un.lFrame.isParent=!1}function Di(){const n=un.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function Pc(){return un.lFrame.bindingIndex}function e0(){return un.lFrame.bindingIndex++}function ca(n){const t=un.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function p2(n){un.lFrame.inI18n=n}function jT(n,t){const e=un.lFrame;e.bindingIndex=e.bindingRootIndex=n,p3(t)}function p3(n){un.lFrame.currentDirectiveIndex=n}function B9(){return un.lFrame.currentQueryIndex}function j8(n){un.lFrame.currentQueryIndex=n}function tv(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function P7(n,t,e){if(e&Yt.SkipSelf){let s=t,i=n;for(;!(s=s.parent,null!==s||e&Yt.Host||(s=tv(i),null===s||(i=i[15],10&s.type))););if(null===s)return!1;t=s,n=i}const r=un.lFrame=$9();return r.currentTNode=t,r.lView=n,!0}function Cl(n){const t=$9(),e=n[1];un.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function $9(){const n=un.lFrame,t=null===n?null:n.child;return null===t?U9(n):t}function U9(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function nv(){const n=un.lFrame;return un.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Z8=nv;function yl(){const n=nv();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function g2(){return un.lFrame.selectedIndex}function g3(n){un.lFrame.selectedIndex=n}function A1(){const n=un.lFrame;return R9(n.tView,n.selectedIndex)}function H(){un.lFrame.currentNamespace="svg"}function v3(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){const i=n.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:c,ngAfterViewInit:u,ngAfterViewChecked:h,ngOnDestroy:g}=i;o&&(n.contentHooks||(n.contentHooks=[])).push(-e,o),c&&((n.contentHooks||(n.contentHooks=[])).push(e,c),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,c)),u&&(n.viewHooks||(n.viewHooks=[])).push(-e,u),h&&((n.viewHooks||(n.viewHooks=[])).push(e,h),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,h)),null!=g&&(n.destroyHooks||(n.destroyHooks=[])).push(e,g)}}function za(n,t,e){rv(n,t,3,e)}function K8(n,t,e,r){(3&n[2])===e&&rv(n,t,e,r)}function X8(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function rv(n,t,e,r){const i=r??-1,o=t.length-1;let c=0;for(let u=void 0!==r?65535&n[18]:0;u<o;u++)if("number"==typeof t[u+1]){if(c=t[u],null!=r&&c>=r)break}else t[u]<0&&(n[18]+=65536),(c<i||-1==i)&&(sv(n,e,t,u),n[18]=(4294901760&n[18])+u+2),u++}function sv(n,t,e,r){const s=e[r]<0,i=e[r+1],c=n[s?-e[r]:e[r]];if(s){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{i.call(c)}finally{}}}else try{i.call(c)}finally{}}class Q8{constructor(t,e,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function Tc(n,t,e){let r=0;for(;r<e.length;){const s=e[r];if("number"==typeof s){if(0!==s)break;r++;const i=e[r++],o=e[r++],c=e[r++];n.setAttribute(t,o,c,i)}else{const i=s,o=e[++r];av(i)?n.setProperty(t,i,o):n.setAttribute(t,i,o),r++}}return r}function ov(n){return 3===n||4===n||6===n}function av(n){return 64===n.charCodeAt(0)}function r0(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){const s=t[r];"number"==typeof s?e=s:0===e||q9(n,e,s,null,-1===e||2===e?t[++r]:null)}}return n}function q9(n,t,e,r,s){let i=0,o=n.length;if(-1===t)o=-1;else for(;i<n.length;){const c=n[i++];if("number"==typeof c){if(c===t){o=-1;break}if(c>t){o=i-1;break}}}for(;i<n.length;){const c=n[i];if("number"==typeof c)break;if(c===e){if(null===r)return void(null!==s&&(n[i+1]=s));if(r===n[i+1])return void(n[i+2]=s)}i++,null!==r&&i++,null!==s&&i++}-1!==o&&(n.splice(o,0,t),i=o+1),n.splice(i++,0,e),null!==r&&n.splice(i++,0,r),null!==s&&n.splice(i++,0,s)}function W9(n){return-1!==n}function Ml(n){return 32767&n}function Sl(n,t){let e=function cv(n){return n>>16}(n),r=t;for(;e>0;)r=r[15],e--;return r}let w7=!0;function h4(n){const t=w7;return w7=n,t}let lv=0;const C3={};function O7(n,t){const e=eu(n,t);if(-1!==e)return e;const r=t[1];r.firstCreatePass&&(n.injectorIndex=t.length,Z9(r.data,n),Z9(t,null),Z9(r.blueprint,null));const s=Ha(n,t),i=n.injectorIndex;if(W9(s)){const o=Ml(s),c=Sl(s,t),u=c[1].data;for(let h=0;h<8;h++)t[i+h]=c[o+h]|u[o+h]}return t[i+8]=s,i}function Z9(n,t){n.push(0,0,0,0,0,0,0,0,t)}function eu(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Ha(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,r=null,s=t;for(;null!==s;){if(r=hv(s),null===r)return-1;if(e++,s=s[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function s0(n,t,e){!function LF(n,t,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(f3)&&(r=e[f3]),null==r&&(r=e[f3]=lv++);const s=255&r;t.data[n+(s>>5)]|=1<<s}(n,t,e)}function Y9(n,t,e){if(e&Yt.Optional||void 0!==n)return n;U6()}function K9(n,t,e,r){if(e&Yt.Optional&&void 0===r&&(r=null),0==(e&(Yt.Self|Yt.Host))){const s=n[9],i=ta(void 0);try{return s?s.get(t,r,e&Yt.Optional):w9(t,r,e&Yt.Optional)}finally{ta(i)}}return Y9(r,0,e)}function b7(n,t,e,r=Yt.Default,s){if(null!==n){if(1024&t[2]){const o=function A7(n,t,e,r,s){let i=n,o=t;for(;null!==i&&null!==o&&1024&o[2]&&!(256&o[2]);){const c=d4(i,o,e,r|Yt.Self,C3);if(c!==C3)return c;let u=i.parent;if(!u){const h=o[21];if(h){const g=h.get(e,C3,r);if(g!==C3)return g}u=hv(o),o=o[15]}i=u}return s}(n,t,e,r,C3);if(o!==C3)return o}const i=d4(n,t,e,r,C3);if(i!==C3)return i}return K9(t,e,r,s)}function d4(n,t,e,r,s){const i=function tu(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(f3)?n[f3]:void 0;return"number"==typeof t?t>=0?255&t:a0:t}(e);if("function"==typeof i){if(!P7(t,n,r))return r&Yt.Host?Y9(s,0,r):K9(t,e,r,s);try{const o=i(r);if(null!=o||r&Yt.Optional)return o;U6()}finally{Z8()}}else if("number"==typeof i){let o=null,c=eu(n,t),u=-1,h=r&Yt.Host?t[16][6]:null;for((-1===c||r&Yt.SkipSelf)&&(u=-1===c?Ha(n,t):t[c+8],-1!==u&&fv(r,!1)?(o=t[1],c=Ml(u),t=Sl(u,t)):c=-1);-1!==c;){const g=t[1];if(uv(i,c,g.data)){const m=X9(c,t,e,o,r,h);if(m!==C3)return m}u=t[c+8],-1!==u&&fv(r,t[1].data[c+8]===h)&&uv(i,c,t)?(o=g,c=Ml(u),t=Sl(u,t)):c=-1}}return s}function X9(n,t,e,r,s,i){const o=t[1],c=o.data[n+8],g=Kr(c,o,e,null==r?ia(c)&&w7:r!=o&&0!=(3&c.type),s&Yt.Host&&i===c);return null!==g?$s(t,o,g,c):C3}function Kr(n,t,e,r,s){const i=n.providerIndexes,o=t.data,c=1048575&i,u=n.directiveStart,g=i>>20,E=s?c+g:n.directiveEnd;for(let O=r?c:c+g;O<E;O++){const k=o[O];if(O<u&&e===k||O>=u&&k.type===e)return O}if(s){const O=o[u];if(O&&Ss(O)&&O.type===e)return u}return null}function $s(n,t,e,r){let s=n[e];const i=t.data;if(function ZT(n){return n instanceof Q8}(s)){const o=s;o.resolving&&function V8(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new Ne(-200,`Circular dependency in DI detected for ${n}${e}`)}(function Vt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():on(n)}(i[e]));const c=h4(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?ta(o.injectImpl):null;P7(n,r,Yt.Default);try{s=n[e]=o.factory(void 0,i,n,r),t.firstCreatePass&&e>=r.directiveStart&&function n0(n,t,e){const{ngOnChanges:r,ngOnInit:s,ngDoCheck:i}=t.type.prototype;if(r){const o=W_(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,o)}s&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,s),i&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,i),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,i))}(e,i[e],t)}finally{null!==u&&ta(u),h4(c),o.resolving=!1,Z8()}}return s}function uv(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function fv(n,t){return!(n&Yt.Self||n&Yt.Host&&t)}class o0{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,r){return b7(this._tNode,this._lView,t,r,e)}}function a0(){return new o0(Vr(),Re())}function Tr(n){return o4(()=>{const t=n.prototype.constructor,e=t[u3]||Q9(t),r=Object.prototype;let s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==r;){const i=s[u3]||Q9(s);if(i&&i!==e)return i;s=Object.getPrototypeOf(s)}return i=>new i})}function Q9(n){return B6(n)?()=>{const t=Q9(sn(n));return t&&t()}:Da(n)}function hv(n){const t=n[1],e=t.type;return 2===e?t.declTNode:1===e?n[6]:null}function nu(n){return function KT(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const r=e.length;let s=0;for(;s<r;){const i=e[s];if(ov(i))break;if(0===i)s+=2;else if("number"==typeof i)for(s++;s<r&&"string"==typeof e[s];)s++;else{if(i===t)return e[s+1];s+=2}}}return null}(Vr(),n)}const c0="__parameters__";function wl(n,t,e){return o4(()=>{const r=function N7(n){return function(...e){if(n){const r=n(...e);for(const s in r)this[s]=r[s]}}}(t);function s(...i){if(this instanceof s)return r.apply(this,i),this;const o=new s(...i);return c.annotation=o,c;function c(u,h,g){const m=u.hasOwnProperty(c0)?u[c0]:Object.defineProperty(u,c0,{value:[]})[c0];for(;m.length<=g;)m.push(null);return(m[g]=m[g]||[]).push(o),u}}return e&&(s.prototype=Object.create(e.prototype)),s.prototype.ngMetadataName=n,s.annotationCls=s,s})}class Dt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=nt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function m2(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let r=n[e];Array.isArray(r)?(t===n&&(t=n.slice(0,e)),m2(r,t)):t!==n&&t.push(r)}return t}function Fa(n,t){n.forEach(e=>Array.isArray(e)?Fa(e,t):t(e))}function y3(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function f0(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function Ol(n,t){const e=[];for(let r=0;r<n;r++)e.push(t);return e}function _2(n,t,e){let r=v2(n,t);return r>=0?n[1|r]=e:(r=~r,function ed(n,t,e,r){let s=n.length;if(s==t)n.push(e,r);else if(1===s)n.push(r,n[0]),n[0]=e;else{for(s--,n.push(n[s-1],n[s]);s>t;)n[s]=n[s-2],s--;n[t]=e,n[t+1]=r}}(n,r,t,e)),r}function ci(n,t){const e=v2(n,t);if(e>=0)return n[1|e]}function v2(n,t){return function k7(n,t,e){let r=0,s=n.length>>e;for(;s!==r;){const i=r+(s-r>>1),o=n[i<<e];if(t===o)return i<<e;o>t?s=i:r=i+1}return~(s<<e)}(n,t,1)}const ou={},au="__NG_DI_FLAG__",li="ngTempTokenPath",ew=/\n/gm,D7="__source";let cu;function d0(n){const t=cu;return cu=n,t}function tw(n,t=Yt.Default){if(void 0===cu)throw new Ne(-203,!1);return null===cu?w9(n,void 0,t):cu.get(n,t&Yt.Optional?null:void 0,t)}function ze(n,t=Yt.Default){return(function SF(){return T9}()||tw)(sn(n),t)}function Hr(n,t=Yt.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),ze(n,t)}function id(n){const t=[];for(let e=0;e<n.length;e++){const r=sn(n[e]);if(Array.isArray(r)){if(0===r.length)throw new Ne(900,!1);let s,i=Yt.Default;for(let o=0;o<r.length;o++){const c=r[o],u=Cv(c);"number"==typeof u?-1===u?s=c.token:i|=u:s=c}t.push(ze(s,i))}else t.push(ze(r))}return t}function bl(n,t){return n[au]=t,n.prototype[au]=t,n}function Cv(n){return n[au]}const ui=bl(wl("Optional"),8),lu=bl(wl("SkipSelf"),4);let dd,V7,H7;function Ev(){return void 0!==dd?dd:typeof document<"u"?document:void 0}function m4(n){return function pd(){if(void 0===V7&&(V7=null,X1.trustedTypes))try{V7=X1.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return V7}()?.createHTML(n)||n}function F7(n){return function gd(){if(void 0===H7&&(H7=null,X1.trustedTypes))try{H7=X1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return H7}()?.createHTML(n)||n}class _4{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class dw extends _4{getTypeName(){return"HTML"}}class pw extends _4{getTypeName(){return"Style"}}class gw extends _4{getTypeName(){return"Script"}}class Sv extends _4{getTypeName(){return"URL"}}class Pv extends _4{getTypeName(){return"ResourceURL"}}function wo(n){return n instanceof _4?n.changingThisBreaksApplicationSecurity:n}function Oo(n,t){const e=function Tv(n){return n instanceof _4&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function bv(n){const t=new zt(n);return function Cw(){try{return!!(new window.DOMParser).parseFromString(m4(""),"text/html")}catch{return!1}}()?new Av(t):t}class Av{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(m4(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class zt{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const r=this.inertDocument.createElement("body");e.appendChild(r)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=m4(t),e;const r=this.inertDocument.createElement("body");return r.innerHTML=m4(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(t){const e=t.attributes;for(let s=e.length-1;0<s;s--){const o=e.item(s).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&t.removeAttribute(o)}let r=t.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const Nv=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function ha(n){return(n=String(n)).match(Nv)?n:"unsafe:"+n}function Oc(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function hu(...n){const t={};for(const e of n)for(const r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}const Iv=Oc("area,br,col,hr,img,wbr"),xv=Oc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),B7=Oc("rp,rt"),du=hu(Iv,hu(xv,Oc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),hu(B7,Oc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),hu(B7,xv)),$7=Oc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),U7=hu($7,Oc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Oc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),yw=Oc("script,style,template");class Ew{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,r=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let s=this.checkClobberedElement(e,e.nextSibling);if(s){e=s;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!du.hasOwnProperty(e))return this.sanitizedSomething=!0,!yw.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=t.attributes;for(let s=0;s<r.length;s++){const i=r.item(s),o=i.name,c=o.toLowerCase();if(!U7.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let u=i.value;$7[c]&&(u=ha(u)),this.buf.push(" ",o,'="',Lv(u),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();du.hasOwnProperty(e)&&!Iv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Lv(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const Mw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Sw=/([^\#-~ |!])/g;function Lv(n){return n.replace(/&/g,"&amp;").replace(Mw,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(Sw,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let G7;function _d(n,t){let e=null;try{G7=G7||bv(n);let r=t?String(t):"";e=G7.getInertBodyElement(r);let s=5,i=r;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,r=i,i=e.innerHTML,e=G7.getInertBodyElement(r)}while(r!==i);return m4((new Ew).sanitizeChildren(bo(e)||e))}finally{if(e){const r=bo(e)||e;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function bo(n){return"content"in n&&function pu(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var Q1=(()=>((Q1=Q1||{})[Q1.NONE=0]="NONE",Q1[Q1.HTML=1]="HTML",Q1[Q1.STYLE=2]="STYLE",Q1[Q1.SCRIPT=3]="SCRIPT",Q1[Q1.URL=4]="URL",Q1[Q1.RESOURCE_URL=5]="RESOURCE_URL",Q1))();function gu(n){const t=_0();return t?F7(t.sanitize(Q1.HTML,n)||""):Oo(n,"HTML")?F7(wo(n)):_d(Ev(),on(n))}function E3(n){const t=_0();return t?t.sanitize(Q1.URL,n)||"":Oo(n,"URL")?wo(n):ha(on(n))}function _0(){const n=Re();return n&&n[12]}const Cu=new Dt("ENVIRONMENT_INITIALIZER"),Dv=new Dt("INJECTOR",-1),zv=new Dt("INJECTOR_DEF_TYPES");class Vv{get(t,e=ou){if(e===ou){const r=new Error(`NullInjectorError: No provider for ${Z1(t)}!`);throw r.name="NullInjectorError",r}return e}}function yu(...n){return{\u0275providers:Cd(0,n)}}function Cd(n,...t){const e=[],r=new Set;let s;return Fa(t,i=>{const o=i;M3(o,e,[],r)&&(s||(s=[]),s.push(o))}),void 0!==s&&Hv(s,e),e}function Hv(n,t){for(let e=0;e<n.length;e++){const{providers:s}=n[e];Fa(s,i=>{t.push(i)})}}function M3(n,t,e,r){if(!(n=sn(n)))return!1;let s=null,i=F8(n);const o=!i&&b1(n);if(i||o){if(o&&!o.standalone)return!1;s=n}else{const u=n.ngModule;if(i=F8(u),!i)return!1;s=u}const c=r.has(s);if(o){if(c)return!1;if(r.add(s),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const h of u)M3(h,t,e,r)}}else{if(!i)return!1;{if(null!=i.imports&&!c){let h;r.add(s);try{Fa(i.imports,g=>{M3(g,t,e,r)&&(h||(h=[]),h.push(g))})}finally{}void 0!==h&&Hv(h,t)}if(!c){const h=Da(s)||(()=>new s);t.push({provide:s,useFactory:h,deps:M1},{provide:zv,useValue:s,multi:!0},{provide:Cu,useValue:()=>ze(s),multi:!0})}const u=i.providers;null==u||c||Fa(u,g=>{t.push(g)})}}return s!==n&&void 0!==n.providers}const Pw=T1({provide:String,useValue:T1});function C2(n){return null!==n&&"object"==typeof n&&Pw in n}function Il(n){return"function"==typeof n}const Ed=new Dt("Set Injector scope."),W7={},$v={};let Md;function v4(){return void 0===Md&&(Md=new Vv),Md}class $a{}class j7 extends $a{constructor(t,e,r,s){super(),this.parent=e,this.source=r,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Y7(t,o=>this.processProvider(o)),this.records.set(Dv,xl(void 0,this)),s.has("environment")&&this.records.set($a,xl(void 0,this));const i=this.records.get(Ed);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(zv.multi,M1,Yt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=d0(this),r=ta(void 0);try{return t()}finally{d0(e),ta(r)}}get(t,e=ou,r=Yt.Default){this.assertNotDestroyed();const s=d0(this),i=ta(void 0);try{if(!(r&Yt.SkipSelf)){let c=this.records.get(t);if(void 0===c){const u=function qv(n){return"function"==typeof n||"object"==typeof n&&n instanceof Dt}(t)&&Rn(t);c=u&&this.injectableDefInScope(u)?xl(Ao(t),W7):null,this.records.set(t,c)}if(null!=c)return this.hydrate(t,c)}return(r&Yt.Self?v4():this.parent).get(t,e=r&Yt.Optional&&e===ou?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[li]=o[li]||[]).unshift(Z1(t)),s)throw o;return function nw(n,t,e,r){const s=n[li];throw t[D7]&&s.unshift(t[D7]),n.message=function Yn(n,t,e,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let s=Z1(t);if(Array.isArray(t))s=t.map(Z1).join(" -> ");else if("object"==typeof t){let i=[];for(let o in t)if(t.hasOwnProperty(o)){let c=t[o];i.push(o+":"+("string"==typeof c?JSON.stringify(c):Z1(c)))}s=`{${i.join(", ")}}`}return`${e}${r?"("+r+")":""}[${s}]: ${n.replace(ew,"\n  ")}`}("\n"+n.message,s,e,r),n.ngTokenPath=s,n[li]=null,n}(o,t,"R3InjectorError",this.source)}throw o}finally{ta(i),d0(s)}}resolveInjectorInitializers(){const t=d0(this),e=ta(void 0);try{const r=this.get(Cu.multi,M1,Yt.Self);for(const s of r)s()}finally{d0(t),ta(e)}}toString(){const t=[],e=this.records;for(const r of e.keys())t.push(Z1(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ne(205,!1)}processProvider(t){let e=Il(t=sn(t))?t:sn(t&&t.provide);const r=function ww(n){return C2(n)?xl(void 0,n.useValue):xl(Z7(n),W7)}(t);if(Il(t)||!0!==t.multi)this.records.get(e);else{let s=this.records.get(e);s||(s=xl(void 0,W7,!0),s.factory=()=>id(s.multi),this.records.set(e,s)),e=t,s.multi.push(t)}this.records.set(e,r)}hydrate(t,e){return e.value===W7&&(e.value=$v,e.value=e.factory()),"object"==typeof e.value&&e.value&&function Gv(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=sn(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Ao(n){const t=Rn(n),e=null!==t?t.factory:Da(n);if(null!==e)return e;if(n instanceof Dt)throw new Ne(204,!1);if(n instanceof Function)return function Eu(n){const t=n.length;if(t>0)throw Ol(t,"?"),new Ne(204,!1);const e=function B_(n){const t=n&&(n[G6]||n[S9]);if(t){const e=function ii(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new Ne(204,!1)}function Z7(n,t,e){let r;if(Il(n)){const s=sn(n);return Da(s)||Ao(s)}if(C2(n))r=()=>sn(n.useValue);else if(function Bv(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...id(n.deps||[]));else if(function yd(n){return!(!n||!n.useExisting)}(n))r=()=>ze(sn(n.useExisting));else{const s=sn(n&&(n.useClass||n.provide));if(!function Uv(n){return!!n.deps}(n))return Da(s)||Ao(s);r=()=>new s(...id(n.deps))}return r}function xl(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function Ow(n){return!!n.\u0275providers}function Y7(n,t){for(const e of n)Array.isArray(e)?Y7(e,t):Ow(e)?Y7(e.\u0275providers,t):t(e)}class Wv{}class Iw{resolveComponentFactory(t){throw function Aw(n){const t=Error(`No component factory found for ${Z1(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let v0=(()=>{class n{}return n.NULL=new Iw,n})();function WF(){return C0(Vr(),Re())}function C0(n,t){return new y2(d2(n,t))}let y2=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=WF,n})();function K7(n){return n instanceof y2?n.nativeElement:n}class y0{}let No=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function xw(){const n=Re(),e=Ri(Vr().index,n);return(Po(e)?e:n)[11]}(),n})(),jF=(()=>{class n{}return n.\u0275prov=nt({token:n,providedIn:"root",factory:()=>null}),n})();class E0{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const jv=new E0("14.2.10"),Td={};function Od(n){return n.ngOriginalError}class M0{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&Od(t);for(;e&&Od(e);)e=Od(e);return e||null}}const Bw=/^>|^->|<!--|-->|--!>|<!-$/g,$w=/(<|>)/;const bd=new Map;let Xv=0;const ef="__ngContext__";function Fi(n,t){Po(t)?(n[ef]=t[20],function Zw(n){bd.set(n[20],n)}(t)):n[ef]=t}function Ua(n){return n instanceof Function?n():n}var M2=(()=>((M2=M2||{})[M2.Important=1]="Important",M2[M2.DashCase=2]="DashCase",M2))();let Id;function xd(n,t){return Id(n,t)}function Pu(n){const t=n[3];return Sr(t)?t[3]:t}function kd(n){return bc(n[13])}function Ld(n){return bc(n[4])}function bc(n){for(;null!==n&&!Sr(n);)n=n[4];return n}function kl(n,t,e,r,s){if(null!=r){let i,o=!1;Sr(r)?i=r:Po(r)&&(o=!0,r=r[0]);const c=Pr(r);0===n&&null!==e?null==s?hC(t,e,c):T3(t,e,c,s||null,!0):1===n&&null!==e?T3(t,e,c,s||null,!0):2===n?vC(t,c,o):3===n&&t.destroyNode(c),null!=i&&function gO(n,t,e,r,s){const i=e[7];i!==Pr(e)&&kl(t,n,r,i,s);for(let c=10;c<e.length;c++){const u=e[c];T0(u[1],u,n,t,r,i)}}(t,n,i,e,s)}}function Rd(n,t){return n.createText(t)}function cC(n,t,e){n.setValue(t,e)}function oO(n,t){return n.createComment(function Kv(n){return n.replace(Bw,t=>t.replace($w,"\u200b$1\u200b"))}(t))}function Dd(n,t,e){return n.createElement(t,e)}function lC(n,t){const e=n[9],r=e.indexOf(t),s=t[3];512&t[2]&&(t[2]&=-513,D9(s,-1)),e.splice(r,1)}function zd(n,t){if(n.length<=10)return;const e=10+t,r=n[e];if(r){const s=r[17];null!==s&&s!==n&&lC(s,r),t>0&&(n[e-1][4]=r[4]);const i=f0(n,10+t);!function aO(n,t){T0(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const o=i[19];null!==o&&o.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function uC(n,t){if(!(128&t[2])){const e=t[11];e.destroyNode&&T0(n,t,e,3,null,null),function uO(n){let t=n[13];if(!t)return Vd(n[1],n);for(;t;){let e=null;if(Po(t))e=t[13];else{const r=t[10];r&&(e=r)}if(!e){for(;t&&!t[4]&&t!==n;)Po(t)&&Vd(t[1],t),t=t[3];null===t&&(t=n),Po(t)&&Vd(t[1],t),e=t&&t[4]}t=e}}(t)}}function Vd(n,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function dO(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let r=0;r<e.length;r+=2){const s=t[e[r]];if(!(s instanceof Q8)){const i=e[r+1];if(Array.isArray(i))for(let o=0;o<i.length;o+=2){const c=s[i[o]],u=i[o+1];try{u.call(c)}finally{}}else try{i.call(s)}finally{}}}}(n,t),function Hd(n,t){const e=n.cleanup,r=t[7];let s=-1;if(null!==e)for(let i=0;i<e.length-1;i+=2)if("string"==typeof e[i]){const o=e[i+1],c="function"==typeof o?o(t):Pr(t[o]),u=r[s=e[i+2]],h=e[i+3];"boolean"==typeof h?c.removeEventListener(e[i],u,h):h>=0?r[s=h]():r[s=-h].unsubscribe(),i+=2}else{const o=r[s=e[i+1]];e[i].call(o)}if(null!==r){for(let i=s+1;i<r.length;i++)(0,r[i])();t[7]=null}}(n,t),1===t[1].type&&t[11].destroy();const e=t[17];if(null!==e&&Sr(t[3])){e!==t[3]&&lC(e,t);const r=t[19];null!==r&&r.detachView(n)}!function Yw(n){bd.delete(n[20])}(t)}}function fC(n,t,e){return Fd(n,t.parent,e)}function Fd(n,t,e){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return e[0];if(2&r.flags){const s=n.data[r.directiveStart].encapsulation;if(s===$1.None||s===$1.Emulated)return null}return d2(r,e)}function T3(n,t,e,r,s){n.insertBefore(t,e,r,s)}function hC(n,t,e){n.appendChild(t,e)}function w3(n,t,e,r,s){null!==r?T3(n,t,e,r,s):hC(n,t,e)}function S0(n,t){return n.parentNode(t)}function gC(n,t,e){return _C(n,t,e)}function mC(n,t,e){return 40&n.type?d2(n,e):null}let Bd,_C=mC;function nf(n,t){_C=n,Bd=t}function Tu(n,t,e,r){const s=fC(n,r,t),i=t[11],c=gC(r.parent||t[6],r,t);if(null!=s)if(Array.isArray(e))for(let u=0;u<e.length;u++)w3(i,s,e[u],c,!1);else w3(i,s,e,c,!1);void 0!==Bd&&Bd(i,r,t,e,s)}function wu(n,t){if(null!==t){const e=t.type;if(3&e)return d2(t,n);if(4&e)return P0(-1,n[t.index]);if(8&e){const r=t.child;if(null!==r)return wu(n,r);{const s=n[t.index];return Sr(s)?P0(-1,s):Pr(s)}}if(32&e)return xd(t,n)()||Pr(n[t.index]);{const r=Ll(n,t);return null!==r?Array.isArray(r)?r[0]:wu(Pu(n[16]),r):wu(n,t.next)}}return null}function Ll(n,t){return null!==t?n[16][6].projection[t.projection]:null}function P0(n,t){const e=10+n+1;if(e<t.length){const r=t[e],s=r[1].firstChild;if(null!==s)return wu(r,s)}return t[7]}function vC(n,t,e){const r=S0(n,t);r&&function dC(n,t,e,r){n.removeChild(t,e,r)}(n,r,t,e)}function $d(n,t,e,r,s,i,o){for(;null!=e;){const c=r[e.index],u=e.type;if(o&&0===t&&(c&&Fi(Pr(c),r),e.flags|=4),64!=(64&e.flags))if(8&u)$d(n,t,e.child,r,s,i,!1),kl(t,n,s,c,i);else if(32&u){const h=xd(e,r);let g;for(;g=h();)kl(t,n,s,g,i);kl(t,n,s,c,i)}else 16&u?CC(n,t,r,e,s,i):kl(t,n,s,c,i);e=o?e.projectionNext:e.next}}function T0(n,t,e,r,s,i){$d(e,r,n.firstChild,t,s,i,!1)}function CC(n,t,e,r,s,i){const o=e[16],u=o[6].projection[r.projection];if(Array.isArray(u))for(let h=0;h<u.length;h++)kl(t,n,s,u[h],i);else $d(n,t,u,o[3],s,i,!0)}function Ou(n,t,e){n.setAttribute(t,"style",e)}function rf(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function EC(n,t,e){let r=n.length;for(;;){const s=n.indexOf(t,e);if(-1===s)return s;if(0===s||n.charCodeAt(s-1)<=32){const i=t.length;if(s+i===r||n.charCodeAt(s+i)<=32)return s}e=s+1}}const MC="ng-template";function Ud(n,t,e){let r=0;for(;r<n.length;){let s=n[r++];if(e&&"class"===s){if(s=n[r],-1!==EC(s.toLowerCase(),t,0))return!0}else if(1===s){for(;r<n.length&&"string"==typeof(s=n[r++]);)if(s.toLowerCase()===t)return!0;return!1}}return!1}function bu(n){return 4===n.type&&n.value!==MC}function SC(n,t,e){return t===(4!==n.type||e?n.value:MC)}function mO(n,t,e){let r=4;const s=n.attrs||[],i=function _O(n){for(let t=0;t<n.length;t++)if(ov(n[t]))return t;return n.length}(s);let o=!1;for(let c=0;c<t.length;c++){const u=t[c];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!SC(n,u,e)||""===u&&1===t.length){if(Ga(r))return!1;o=!0}}else{const h=8&r?u:t[++c];if(8&r&&null!==n.attrs){if(!Ud(n.attrs,h,e)){if(Ga(r))return!1;o=!0}continue}const m=PC(8&r?"class":u,s,bu(n),e);if(-1===m){if(Ga(r))return!1;o=!0;continue}if(""!==h){let E;E=m>i?"":s[m+1].toLowerCase();const O=8&r?E:null;if(O&&-1!==EC(O,h,0)||2&r&&h!==E){if(Ga(r))return!1;o=!0}}}}else{if(!o&&!Ga(r)&&!Ga(u))return!1;if(o&&Ga(u))continue;o=!1,r=u|1&r}}return Ga(r)||o}function Ga(n){return 0==(1&n)}function PC(n,t,e,r){if(null===t)return-1;let s=0;if(r||!e){let i=!1;for(;s<t.length;){const o=t[s];if(o===n)return s;if(3===o||6===o)i=!0;else{if(1===o||2===o){let c=t[++s];for(;"string"==typeof c;)c=t[++s];continue}if(4===o)break;if(0===o){s+=4;continue}}s+=i?1:2}return-1}return function vO(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const r=n[e];if("number"==typeof r)return-1;if(r===t)return e;e++}return-1}(t,n)}function TC(n,t,e=!1){for(let r=0;r<t.length;r++)if(mO(n,t[r],e))return!0;return!1}function OC(n,t){e:for(let e=0;e<t.length;e++){const r=t[e];if(n.length===r.length){for(let s=0;s<n.length;s++)if(n[s]!==r[s])continue e;return!0}}return!1}function Gd(n,t){return n?":not("+t.trim()+")":t}function CO(n){let t=n[0],e=1,r=2,s="",i=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&r){const c=n[++e];s+="["+o+(c.length>0?'="'+c+'"':"")+"]"}else 8&r?s+="."+o:4&r&&(s+=" "+o);else""!==s&&!Ga(o)&&(t+=Gd(i,s),s=""),r=o,i=i||!Ga(r);e++}return""!==s&&(t+=Gd(i,s)),t}const mn={};function T(n){AC(Jn(),Re(),g2()+n,!1)}function AC(n,t,e,r){if(!r)if(3==(3&t[2])){const i=n.preOrderCheckHooks;null!==i&&za(t,i,e)}else{const i=n.preOrderHooks;null!==i&&K8(t,i,0,e)}g3(e)}function Zd(n,t=null,e=null,r){const s=xC(n,t,e,r);return s.resolveInjectorInitializers(),s}function xC(n,t=null,e=null,r,s=new Set){const i=[e||M1,yu(n)];return r=r||("object"==typeof n?void 0:Z1(n)),new j7(i,t||v4(),r||null,s)}let fi=(()=>{class n{static create(e,r){if(Array.isArray(e))return Zd({name:""},r,e,"");{const s=e.name??"";return Zd({name:s},e.parent,e.providers,s)}}}return n.THROW_IF_NOT_FOUND=ou,n.NULL=new Vv,n.\u0275prov=nt({token:n,providedIn:"any",factory:()=>ze(Dv)}),n.__NG_ELEMENT_ID__=-1,n})();function Q(n,t=Yt.Default){const e=Re();return null===e?ze(n,t):b7(Vr(),e,sn(n),t)}function lf(){throw new Error("invalid")}function uf(n,t){return n<<17|t<<2}function qa(n){return n>>17&32767}function np(n){return 2|n}function Ac(n){return(131068&n)>>2}function Dl(n,t){return-131069&n|t<<2}function rp(n){return 1|n}function qC(n,t){const e=n.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const s=e[r],i=e[r+1];if(-1!==i){const o=n.data[i];j8(s),o.contentQueries(2,t[i],i)}}}function gf(n,t,e,r,s,i,o,c,u,h,g){const m=t.blueprint.slice();return m[0]=s,m[2]=76|r,(null!==g||n&&1024&n[2])&&(m[2]|=1024),Q_(m),m[3]=m[15]=n,m[8]=e,m[10]=o||n&&n[10],m[11]=c||n&&n[11],m[12]=u||n&&n[12]||null,m[9]=h||n&&n[9]||null,m[6]=i,m[20]=function cr(){return Xv++}(),m[21]=g,m[16]=2==t.type?n[16]:m,m}function O0(n,t,e,r,s){let i=n.data[t];if(null===i)i=mf(n,t,e,r,s),function la(){return un.lFrame.inI18n}()&&(i.flags|=64);else if(64&i.type){i.type=e,i.value=r,i.attrs=s;const o=vl();i.injectorIndex=null===o?-1:o.injectorIndex}return Sc(i,!0),i}function mf(n,t,e,r,s){const i=J_(),o=Yr(),u=n.data[t]=function yB(n,t,e,r,s,i){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?i:i&&i.parent,e,t,r,s);return null===n.firstChild&&(n.firstChild=u),null!==i&&(o?null==i.child&&null!==u.parent&&(i.child=u):null===i.next&&(i.next=u)),u}function zl(n,t,e,r){if(0===e)return-1;const s=t.length;for(let i=0;i<e;i++)t.push(r),n.blueprint.push(r),n.data.push(null);return s}function _f(n,t,e){Cl(t);try{const r=n.viewQuery;null!==r&&gp(1,r,e);const s=n.template;null!==s&&WC(n,t,s,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&qC(n,t),n.staticViewQueries&&gp(2,n.viewQuery,e);const i=n.components;null!==i&&function qO(n,t){for(let e=0;e<t.length;e++)OB(n,t[e])}(t,i)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[2]&=-5,yl()}}function vf(n,t,e,r){const s=t[2];if(128!=(128&s)){Cl(t);try{Q_(t),function ev(n){return un.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&WC(n,t,e,2,r);const o=3==(3&s);if(o){const h=n.preOrderCheckHooks;null!==h&&za(t,h,null)}else{const h=n.preOrderHooks;null!==h&&K8(t,h,0,null),X8(t,0)}if(function wB(n){for(let t=kd(n);null!==t;t=Ld(t)){if(!t[2])continue;const e=t[9];for(let r=0;r<e.length;r++){const s=e[r],i=s[3];0==(512&s[2])&&D9(i,1),s[2]|=512}}}(t),function tb(n){for(let t=kd(n);null!==t;t=Ld(t))for(let e=10;e<t.length;e++){const r=t[e],s=r[1];Q6(r)&&vf(s,r,s.template,r[8])}}(t),null!==n.contentQueries&&qC(n,t),o){const h=n.contentCheckHooks;null!==h&&za(t,h)}else{const h=n.contentHooks;null!==h&&K8(t,h,1),X8(t,1)}!function up(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const s=e[r];if(s<0)g3(~s);else{const i=s,o=e[++r],c=e[++r];jT(o,i),c(2,t[i])}}}finally{g3(-1)}}(n,t);const c=n.components;null!==c&&function GO(n,t){for(let e=0;e<t.length;e++)nb(n,t[e])}(t,c);const u=n.viewQuery;if(null!==u&&gp(2,u,r),o){const h=n.viewCheckHooks;null!==h&&za(t,h)}else{const h=n.viewHooks;null!==h&&K8(t,h,2),X8(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,D9(t[3],-1))}finally{yl()}}}function WC(n,t,e,r,s){const i=g2(),o=2&r;try{g3(-1),o&&t.length>22&&AC(n,t,22,!1),e(r,s)}finally{g3(i)}}function jC(n,t,e){if(X2(t)){const s=t.directiveEnd;for(let i=t.directiveStart;i<s;i++){const o=n.data[i];o.contentQueries&&o.contentQueries(1,e[i],i)}}}function fp(n,t,e){!z9()||(function XC(n,t,e,r){const s=e.directiveStart,i=e.directiveEnd;n.firstCreatePass||O7(e,t),Fi(r,t);const o=e.initialInputs;for(let c=s;c<i;c++){const u=n.data[c],h=Ss(u);h&&JO(t,e,u);const g=$s(t,n,c,e);Fi(g,t),null!==o&&TB(0,c-s,g,u,0,o),h&&(Ri(e.index,t)[8]=g)}}(n,t,e,d2(e,t)),128==(128&e.flags)&&function KO(n,t,e){const r=e.directiveStart,s=e.directiveEnd,i=e.index,o=function F9(){return un.lFrame.currentDirectiveIndex}();try{g3(i);for(let c=r;c<s;c++){const u=n.data[c],h=t[c];p3(c),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&XO(u,h)}}finally{g3(-1),p3(o)}}(n,t,e))}function b0(n,t,e=d2){const r=t.localNames;if(null!==r){let s=t.index+1;for(let i=0;i<r.length;i+=2){const o=r[i+1],c=-1===o?e(t,n):n[o];n[s++]=c}}}function ZC(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=YC(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function YC(n,t,e,r,s,i,o,c,u,h){const g=22+r,m=g+s,E=function WO(n,t){const e=[];for(let r=0;r<t;r++)e.push(r<n?null:mn);return e}(g,m),O="function"==typeof h?h():h;return E[1]={type:n,blueprint:E,template:e,queries:null,viewQuery:c,declTNode:t,data:E.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:O,incompleteFirstPass:!1}}function ZO(n,t,e,r){const s=sy(t);null===e?s.push(r):(s.push(e),n.firstCreatePass&&iy(n).push(r,s.length-1))}function A0(n,t,e){for(let r in n)if(n.hasOwnProperty(r)){const s=n[r];(e=null===e?{}:e).hasOwnProperty(r)?e[r].push(t,s):e[r]=[t,s]}return e}function Cf(n,t){const r=t.directiveEnd,s=n.data,i=t.attrs,o=[];let c=null,u=null;for(let h=t.directiveStart;h<r;h++){const g=s[h],m=g.inputs,E=null===i||bu(t)?null:eb(m,i);o.push(E),c=A0(m,h,c),u=A0(g.outputs,h,u)}null!==c&&(c.hasOwnProperty("class")&&(t.flags|=16),c.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=c,t.outputs=u}function Io(n,t,e,r,s,i,o,c){const u=d2(t,e);let g,h=t.inputs;!c&&null!=h&&(g=h[r])?(Pf(n,e,g,r,s),ia(t)&&KC(e,t.index)):3&t.type&&(r=function yf(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),s=null!=o?o(s,t.value||"",r):s,i.setProperty(u,r,s))}function KC(n,t){const e=Ri(t,n);16&e[2]||(e[2]|=32)}function Vl(n,t,e,r){let s=!1;if(z9()){const i=function QC(n,t,e){const r=n.directiveRegistry;let s=null;if(r)for(let i=0;i<r.length;i++){const o=r[i];TC(e,o.selectors,!1)&&(s||(s=[]),s0(O7(e,t),n,o.type),Ss(o)?(hp(n,e),s.unshift(o)):s.push(o))}return s}(n,t,e),o=null===r?null:{"":-1};if(null!==i){s=!0,JC(e,n.data.length,i.length);for(let g=0;g<i.length;g++){const m=i[g];m.providersResolver&&m.providersResolver(m)}let c=!1,u=!1,h=zl(n,t,i.length,null);for(let g=0;g<i.length;g++){const m=i[g];e.mergedAttrs=r0(e.mergedAttrs,m.hostAttrs),ey(n,e,t,h,m),PB(h,m,o),null!==m.contentQueries&&(e.flags|=8),(null!==m.hostBindings||null!==m.hostAttrs||0!==m.hostVars)&&(e.flags|=128);const E=m.type.prototype;!c&&(E.ngOnChanges||E.ngOnInit||E.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),c=!0),!u&&(E.ngOnChanges||E.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),u=!0),h++}Cf(n,e)}o&&function QO(n,t,e){if(t){const r=n.localNames=[];for(let s=0;s<t.length;s+=2){const i=e[t[s+1]];if(null==i)throw new Ne(-301,!1);r.push(t[s],i)}}}(e,r,o)}return e.mergedAttrs=r0(e.mergedAttrs,e.attrs),s}function Ef(n,t,e,r,s,i){const o=i.hostBindings;if(o){let c=n.hostBindingOpCodes;null===c&&(c=n.hostBindingOpCodes=[]);const u=~t.index;(function YO(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(c)!=u&&c.push(u),c.push(r,s,o)}}function XO(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function hp(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function PB(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;Ss(t)&&(e[""]=n)}}function JC(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function ey(n,t,e,r,s){n.data[r]=s;const i=s.factory||(s.factory=Da(s.type)),o=new Q8(i,Ss(s),Q);n.blueprint[r]=o,e[r]=o,Ef(n,t,0,r,zl(n,e,s.hostVars,mn),s)}function JO(n,t,e){const r=d2(t,n),s=ZC(e),i=n[10],o=Mf(n,gf(n,s,null,e.onPush?32:16,r,t,i,i.createRenderer(r,e),null,null,null));n[t.index]=o}function Nc(n,t,e,r,s,i){const o=d2(n,t);dp(t[11],o,i,n.value,e,r,s)}function dp(n,t,e,r,s,i,o){if(null==i)n.removeAttribute(t,s,e);else{const c=null==o?on(i):o(i,r||"",s);n.setAttribute(t,s,c,e)}}function TB(n,t,e,r,s,i){const o=i[t];if(null!==o){const c=r.setInput;for(let u=0;u<o.length;){const h=o[u++],g=o[u++],m=o[u++];null!==c?r.setInput(e,m,h,g):e[g]=m}}}function eb(n,t){let e=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;n.hasOwnProperty(s)&&(null===e&&(e=[]),e.push(s,n[s],t[r+1])),r+=2}else r+=2;else r+=4}return e}function ty(n,t,e,r){return new Array(n,!0,!1,t,null,0,r,e,null,null)}function nb(n,t){const e=Ri(t,n);if(Q6(e)){const r=e[1];48&e[2]?vf(r,e,r.template,e[8]):e[5]>0&&pp(e)}}function pp(n){for(let r=kd(n);null!==r;r=Ld(r))for(let s=10;s<r.length;s++){const i=r[s];if(Q6(i))if(512&i[2]){const o=i[1];vf(o,i,o.template,i[8])}else i[5]>0&&pp(i)}const e=n[1].components;if(null!==e)for(let r=0;r<e.length;r++){const s=Ri(e[r],n);Q6(s)&&s[5]>0&&pp(s)}}function OB(n,t){const e=Ri(t,n),r=e[1];(function rb(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(r,e),_f(r,e,e[8])}function Mf(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function ny(n){for(;n;){n[2]|=32;const t=Pu(n);if(Y6(n)&&!t)return n;n=t}return null}function Sf(n,t,e,r=!0){const s=t[10];s.begin&&s.begin();try{vf(n,t,n.template,e)}catch(o){throw r&&ay(t,o),o}finally{s.end&&s.end()}}function gp(n,t,e){j8(0),t(n,e)}function sy(n){return n[7]||(n[7]=[])}function iy(n){return n.cleanup||(n.cleanup=[])}function ay(n,t){const e=n[9],r=e?e.get(M0,null):null;r&&r.handleError(t)}function Pf(n,t,e,r,s){for(let i=0;i<e.length;){const o=e[i++],c=e[i++],u=t[o],h=n.data[o];null!==h.setInput?h.setInput(u,s,r,c):u[c]=s}}function b3(n,t,e){const r=q8(t,n);cC(n[11],r,e)}function Nu(n,t,e){let r=e?n.styles:null,s=e?n.classes:null,i=0;if(null!==t)for(let o=0;o<t.length;o++){const c=t[o];"number"==typeof c?i=c:1==i?s=z8(s,c):2==i&&(r=z8(r,c+": "+t[++o]+";"))}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=s:n.classesWithoutHost=s}function Tf(n,t,e,r,s=!1){for(;null!==e;){const i=t[e.index];if(null!==i&&r.push(Pr(i)),Sr(i))for(let c=10;c<i.length;c++){const u=i[c],h=u[1].firstChild;null!==h&&Tf(u[1],u,h,r)}const o=e.type;if(8&o)Tf(n,t,e.child,r);else if(32&o){const c=xd(e,t);let u;for(;u=c();)r.push(u)}else if(16&o){const c=Ll(t,e);if(Array.isArray(c))r.push(...c);else{const u=Pu(t[16]);Tf(u[1],u,c,r,!0)}}e=s?e.projectionNext:e.next}return r}class wf{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return Tf(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Sr(t)){const e=t[8],r=e?e.indexOf(this):-1;r>-1&&(zd(t,r),f0(e,r))}this._attachedToViewContainer=!1}uC(this._lView[1],this._lView)}onDestroy(t){ZO(this._lView[1],this._lView,null,t)}markForCheck(){ny(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Sf(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ne(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function lO(n,t){T0(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Ne(902,!1);this._appRef=t}}class ib extends wf{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Sf(t[1],t,t[8],!1)}checkNoChanges(){}get context(){return null}}class mp extends v0{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=b1(t);return new Iu(e,this.ngModule)}}function ob(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class ly{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,r){const s=this.injector.get(t,Td,r);return s!==Td||e===Td?s:this.parentInjector.get(t,e,r)}}class Iu extends Wv{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function yO(n){return n.map(CO).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return ob(this.componentDef.inputs)}get outputs(){return ob(this.componentDef.outputs)}create(t,e,r,s){let i=(s=s||this.ngModule)instanceof $a?s:s?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const o=i?new ly(t,i):t,c=o.get(y0,null);if(null===c)throw new Ne(407,!1);const u=o.get(jF,null),h=c.createRenderer(null,this.componentDef),g=this.componentDef.selectors[0][0]||"div",m=r?function jO(n,t,e){return n.selectRootElement(t,e===$1.ShadowDom)}(h,r,this.componentDef.encapsulation):Dd(h,g,function cy(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(g)),E=this.componentDef.onPush?288:272,O=YC(0,null,null,1,0,null,null,null,null,null),k=gf(null,O,null,E,null,null,c,h,u,o,null);let U,j;Cl(k);try{const oe=function cb(n,t,e,r,s,i){const o=e[1];e[22]=n;const u=O0(o,22,2,"#host",null),h=u.mergedAttrs=t.hostAttrs;null!==h&&(Nu(u,h,!0),null!==n&&(Tc(s,n,h),null!==u.classes&&rf(s,n,u.classes),null!==u.styles&&Ou(s,n,u.styles)));const g=r.createRenderer(n,t),m=gf(e,ZC(t),null,t.onPush?32:16,e[22],u,r,g,i||null,null,null);return o.firstCreatePass&&(s0(O7(u,e),o,t.type),hp(o,u),JC(u,e.length,1)),Mf(e,m),e[22]=m}(m,this.componentDef,k,c,h);if(m)if(r)Tc(h,m,["ng-version",jv.full]);else{const{attrs:Ee,classes:ne}=function bC(n){const t=[],e=[];let r=1,s=2;for(;r<n.length;){let i=n[r];if("string"==typeof i)2===s?""!==i&&t.push(i,n[++r]):8===s&&e.push(i);else{if(!Ga(s))break;s=i}r++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);Ee&&Tc(h,m,Ee),ne&&ne.length>0&&rf(h,m,ne.join(" "))}if(j=R9(O,22),void 0!==e){const Ee=j.projection=[];for(let ne=0;ne<this.ngContentSelectors.length;ne++){const ke=e[ne];Ee.push(null!=ke?Array.from(ke):null)}}U=function fy(n,t,e,r){const s=e[1],i=function SB(n,t,e){const r=Vr();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),ey(n,r,t,zl(n,t,1,null),e),Cf(n,r));const s=$s(t,n,r.directiveStart,r);Fi(s,t);const i=d2(r,t);return i&&Fi(i,t),s}(s,e,t);if(n[8]=e[8]=i,null!==r)for(const c of r)c(i,t);if(t.contentQueries){const c=Vr();t.contentQueries(1,i,c.directiveStart)}const o=Vr();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(g3(o.index),Ef(e[1],o,0,o.directiveStart,o.directiveEnd,t),XO(t,i)),i}(oe,this.componentDef,k,[d]),_f(O,k,null)}finally{yl()}return new ab(this.componentType,U,C0(j,k),k,j)}}class ab extends class bw{}{constructor(t,e,r,s,i){super(),this.location=r,this._rootLView=s,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new ib(s),this.componentType=t}setInput(t,e){const r=this._tNode.inputs;let s;if(null!==r&&(s=r[t])){const i=this._rootLView;Pf(i[1],i,s,t,e),KC(i,this._tNode.index)}}get injector(){return new o0(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function d(){const n=Vr();v3(Re()[1],n)}function l(n){let t=function a(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const r=[n];for(;t;){let s;if(Ss(n))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Ne(903,!1);s=t.\u0275dir}if(s){if(e){r.push(s);const o=n;o.inputs=p(n.inputs),o.declaredInputs=p(n.declaredInputs),o.outputs=p(n.outputs);const c=s.hostBindings;c&&N(n,c);const u=s.viewQuery,h=s.contentQueries;if(u&&_(n,u),h&&M(n,h),C9(n.inputs,s.inputs),C9(n.declaredInputs,s.declaredInputs),C9(n.outputs,s.outputs),Ss(s)&&s.data.animation){const g=n.data;g.animation=(g.animation||[]).concat(s.data.animation)}}const i=s.features;if(i)for(let o=0;o<i.length;o++){const c=i[o];c&&c.ngInherit&&c(n),c===l&&(e=!1)}}t=Object.getPrototypeOf(t)}!function f(n){let t=0,e=null;for(let r=n.length-1;r>=0;r--){const s=n[r];s.hostVars=t+=s.hostVars,s.hostAttrs=r0(s.hostAttrs,e=r0(e,s.hostAttrs))}}(r)}function p(n){return n===K?{}:n===M1?[]:n}function _(n,t){const e=n.viewQuery;n.viewQuery=e?(r,s)=>{t(r,s),e(r,s)}:t}function M(n,t){const e=n.contentQueries;n.contentQueries=e?(r,s,i)=>{t(r,s,i),e(r,s,i)}:t}function N(n,t){const e=n.hostBindings;n.hostBindings=e?(r,s)=>{t(r,s),e(r,s)}:t}let ie=null;function we(){if(!ie){const n=X1.Symbol;if(n&&n.iterator)ie=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const r=t[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(ie=r)}}}return ie}function He(n){return!!yt(n)&&(Array.isArray(n)||!(n instanceof Map)&&we()in n)}function yt(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function yn(n,t,e){return n[t]=e}function D1(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function S2(n,t,e,r){const s=D1(n,t,e);return D1(n,t+1,r)||s}function z(n,t,e,r){const s=Re();return D1(s,e0(),t)&&(Jn(),Nc(A1(),s,n,t,e,r)),z}function d1(n,t,e,r){return D1(n,e0(),e)?t+on(e)+r:mn}function Us(n,t,e,r,s,i){const c=S2(n,Pc(),e,s);return ca(2),c?t+on(e)+r+on(s)+i:mn}function da(n,t,e,r,s,i,o,c){const h=function ja(n,t,e,r,s){const i=S2(n,t,e,r);return D1(n,t+2,s)||i}(n,Pc(),e,s,o);return ca(3),h?t+on(e)+r+on(s)+i+on(o)+c:mn}function xu(n,t,e,r,s,i){const o=Re(),c=d1(o,t,e,r);return c!==mn&&Nc(A1(),o,n,c,s,i),xu}function x(n,t,e,r,s,i,o,c){const u=Re(),h=Jn(),g=n+22,m=h.firstCreatePass?function V4e(n,t,e,r,s,i,o,c,u){const h=t.consts,g=O0(t,n,4,o||null,d3(h,c));Vl(t,e,g,d3(h,u)),v3(t,g);const m=g.tViews=YC(2,g,r,s,i,t.directiveRegistry,t.pipeRegistry,null,t.schemas,h);return null!==t.queries&&(t.queries.template(t,g),m.queries=t.queries.embeddedTView(g)),g}(g,h,u,t,e,r,s,i,o):h.data[g];Sc(m,!1);const E=u[11].createComment("");Tu(h,u,E,m),Fi(E,u),Mf(u,u[g]=ty(E,u,E,m)),oa(m)&&fp(h,u,m),null!=o&&b0(u,m,c)}function Hn(n){return _l(function M7(){return un.lFrame.contextLView}(),22+n)}function w(n,t,e){const r=Re();return D1(r,e0(),t)&&Io(Jn(),A1(),r,n,t,r[11],e,!1),w}function lb(n,t,e,r,s){const o=s?"class":"style";Pf(n,e,t.inputs[o],o,r)}function b(n,t,e,r){const s=Re(),i=Jn(),o=22+n,c=s[11],u=s[o]=Dd(c,t,function _3(){return un.lFrame.currentNamespace}()),h=i.firstCreatePass?function F4e(n,t,e,r,s,i,o){const c=t.consts,h=O0(t,n,2,s,d3(c,i));return Vl(t,e,h,d3(c,o)),null!==h.attrs&&Nu(h,h.attrs,!1),null!==h.mergedAttrs&&Nu(h,h.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,h),h}(o,i,s,0,t,e,r):i.data[o];Sc(h,!0);const g=h.mergedAttrs;null!==g&&Tc(c,u,g);const m=h.classes;null!==m&&rf(c,u,m);const E=h.styles;return null!==E&&Ou(c,u,E),64!=(64&h.flags)&&Tu(i,s,u,h),0===function BT(){return un.lFrame.elementDepthCount}()&&Fi(u,s),function $T(){un.lFrame.elementDepthCount++}(),oa(h)&&(fp(i,s,h),jC(i,h,s)),null!==r&&b0(s,h),b}function A(){let n=Vr();Yr()?V9():(n=n.parent,Sc(n,!1));const t=n;!function UT(){un.lFrame.elementDepthCount--}();const e=Jn();return e.firstCreatePass&&(v3(e,n),X2(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function G9(n){return 0!=(16&n.flags)}(t)&&lb(e,t,Re(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function J8(n){return 0!=(32&n.flags)}(t)&&lb(e,t,Re(),t.stylesWithoutHost,!1),A}function X(n,t,e,r){return b(n,t,e,r),A(),X}function dn(n,t,e){const r=Re(),s=Jn(),i=n+22,o=s.firstCreatePass?function B4e(n,t,e,r,s){const i=t.consts,o=d3(i,r),c=O0(t,n,8,"ng-container",o);return null!==o&&Nu(c,o,!0),Vl(t,e,c,d3(i,s)),null!==t.queries&&t.queries.elementStart(t,c),c}(i,s,r,t,e):s.data[i];Sc(o,!0);const c=r[i]=r[11].createComment("");return Tu(s,r,c,o),Fi(c,r),oa(o)&&(fp(s,r,o),jC(s,o,r)),null!=e&&b0(r,o),dn}function pn(){let n=Vr();const t=Jn();return Yr()?V9():(n=n.parent,Sc(n,!1)),t.firstCreatePass&&(v3(t,n),X2(n)&&t.queries.elementEnd(n)),pn}function Ae(){return Re()}function _p(n){return!!n&&"function"==typeof n.then}const ub=function HB(n){return!!n&&"function"==typeof n.subscribe};function ee(n,t,e,r){const s=Re(),i=Jn(),o=Vr();return function BB(n,t,e,r,s,i,o,c){const u=oa(r),g=n.firstCreatePass&&iy(n),m=t[8],E=sy(t);let O=!0;if(3&r.type||c){const j=d2(r,t),oe=c?c(j):j,Ee=E.length,ne=c?Ue=>c(Pr(Ue[r.index])):r.index;let ke=null;if(!c&&u&&(ke=function $4e(n,t,e,r){const s=n.cleanup;if(null!=s)for(let i=0;i<s.length-1;i+=2){const o=s[i];if(o===e&&s[i+1]===r){const c=t[7],u=s[i+2];return c.length>u?c[u]:null}"string"==typeof o&&(i+=2)}return null}(n,t,s,r.index)),null!==ke)(ke.__ngLastListenerFn__||ke).__ngNextListenerFn__=i,ke.__ngLastListenerFn__=i,O=!1;else{i=UB(r,t,m,i,!1);const Ue=e.listen(oe,s,i);E.push(i,Ue),g&&g.push(s,ne,Ee,Ee+1)}}else i=UB(r,t,m,i,!1);const k=r.outputs;let U;if(O&&null!==k&&(U=k[s])){const j=U.length;if(j)for(let oe=0;oe<j;oe+=2){const et=t[U[oe]][U[oe+1]].subscribe(i),Bt=E.length;E.push(i,et),g&&g.push(s,r.index,Bt,-(Bt+1))}}}(i,s,s[11],o,n,t,0,r),ee}function $B(n,t,e,r){try{return!1!==e(r)}catch(s){return ay(n,s),!1}}function UB(n,t,e,r,s){return function i(o){if(o===Function)return r;ny(2&n.flags?Ri(n.index,t):t);let u=$B(t,0,r,o),h=i.__ngNextListenerFn__;for(;h;)u=$B(t,0,h,o)&&u,h=h.__ngNextListenerFn__;return s&&!1===u&&(o.preventDefault(),o.returnValue=!1),u}}function C(n=1){return function T7(n){return(un.lFrame.contextLView=function Y8(n,t){for(;n>0;)t=t[15],n--;return t}(n,un.lFrame.contextLView))[8]}(n)}function U4e(n,t){let e=null;const r=function wC(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let s=0;s<t.length;s++){const i=t[s];if("*"!==i){if(null===r?TC(n,i,!0):OC(r,i))return s}else e=s}return e}function p1(n,t,e,r,s){const i=Re(),o=d1(i,t,e,r);return o!==mn&&Io(Jn(),A1(),i,n,o,i[11],s,!1),p1}function Le(n,t,e,r,s,i,o){const c=Re(),u=Us(c,t,e,r,s,i);return u!==mn&&Io(Jn(),A1(),c,n,u,c[11],o,!1),Le}function J2(n,t,e,r,s,i,o,c,u){const h=Re(),g=da(h,t,e,r,s,i,o,c);return g!==mn&&Io(Jn(),A1(),h,n,g,h[11],u,!1),J2}function JB(n,t,e,r,s){const i=n[e+1],o=null===t;let c=r?qa(i):Ac(i),u=!1;for(;0!==c&&(!1===u||o);){const g=n[c+1];W4e(n[c],t)&&(u=!0,n[c+1]=r?rp(g):np(g)),c=r?qa(g):Ac(g)}u&&(n[e+1]=r?np(i):rp(i))}function W4e(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&v2(n,t)>=0}const hi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function e$(n){return n.substring(hi.key,hi.keyEnd)}function j4e(n){return n.substring(hi.value,hi.valueEnd)}function n$(n,t){const e=hi.textEnd;let r=hi.key=Of(n,t,e);return e===r?-1:(r=hi.keyEnd=function X4e(n,t,e){let r;for(;t<e&&(45===(r=n.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(n,r,e),r=s$(n,r,e),r=hi.value=Of(n,r,e),r=hi.valueEnd=function Q4e(n,t,e){let r=-1,s=-1,i=-1,o=t,c=o;for(;o<e;){const u=n.charCodeAt(o++);if(59===u)return c;34===u||39===u?c=o=i$(n,u,o,e):t===o-4&&85===i&&82===s&&76===r&&40===u?c=o=i$(n,41,o,e):u>32&&(c=o),i=s,s=r,r=-33&u}return c}(n,r,e),s$(n,r,e))}function Of(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function s$(n,t,e,r){return(t=Of(n,t,e))<e&&t++,t}function i$(n,t,e,r){let s=-1,i=e;for(;i<r;){const o=n.charCodeAt(i++);if(o==t&&92!==s)return i;s=92==o&&92===s?0:o}throw new Error}function hy(n,t){return function A3(n,t,e,r){const s=Re(),i=Jn(),o=ca(2);i.firstUpdatePass&&c$(i,n,o,r),t!==mn&&D1(s,o,t)&&u$(i,i.data[g2()],s,s[11],n,s[o+1]=function ale(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=Z1(wo(n)))),n}(t,e),r,o)}(n,t,null,!0),hy}function T2(n){!function N3(n,t,e,r){const s=Jn(),i=ca(2);s.firstUpdatePass&&c$(s,null,i,r);const o=Re();if(e!==mn&&D1(o,i,e)){const c=s.data[g2()];if(h$(c,r)&&!a$(s,i)){let u=r?c.classesWithoutHost:c.stylesWithoutHost;null!==u&&(e=z8(u,e||"")),lb(s,c,o,e,r)}else!function ole(n,t,e,r,s,i,o,c){s===mn&&(s=M1);let u=0,h=0,g=0<s.length?s[0]:null,m=0<i.length?i[0]:null;for(;null!==g||null!==m;){const E=u<s.length?s[u+1]:void 0,O=h<i.length?i[h+1]:void 0;let U,k=null;g===m?(u+=2,h+=2,E!==O&&(k=m,U=O)):null===m||null!==g&&g<m?(u+=2,k=g):(h+=2,k=m,U=O),null!==k&&u$(n,t,e,r,k,U,o,c),g=u<s.length?s[u]:null,m=h<i.length?i[h]:null}}(s,c,o,o[11],o[i+1],o[i+1]=function ile(n,t,e){if(null==e||""===e)return M1;const r=[],s=wo(e);if(Array.isArray(s))for(let i=0;i<s.length;i++)n(r,s[i],!0);else if("object"==typeof s)for(const i in s)s.hasOwnProperty(i)&&n(r,i,s[i]);else"string"==typeof s&&t(r,s);return r}(n,t,e),r,i)}}(l$,J4e,n,!1)}function J4e(n,t){for(let e=function Y4e(n){return function r$(n){hi.key=0,hi.keyEnd=0,hi.value=0,hi.valueEnd=0,hi.textEnd=n.length}(n),n$(n,Of(n,0,hi.textEnd))}(t);e>=0;e=n$(t,e))l$(n,e$(t),j4e(t))}function a$(n,t){return t>=n.expandoStartIndex}function c$(n,t,e,r){const s=n.data;if(null===s[e+1]){const i=s[g2()],o=a$(n,e);h$(i,r)&&null===t&&!o&&(t=!1),t=function tle(n,t,e,r){const s=function S7(n){const t=un.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let i=r?t.residualClasses:t.residualStyles;if(null===s)0===(r?t.classBindings:t.styleBindings)&&(e=vp(e=fb(null,n,t,e,r),t.attrs,r),i=null);else{const o=t.directiveStylingLast;if(-1===o||n[o]!==s)if(e=fb(s,n,t,e,r),null===i){let u=function nle(n,t,e){const r=e?t.classBindings:t.styleBindings;if(0!==Ac(r))return n[qa(r)]}(n,t,r);void 0!==u&&Array.isArray(u)&&(u=fb(null,n,t,u[1],r),u=vp(u,t.attrs,r),function rle(n,t,e,r){n[qa(e?t.classBindings:t.styleBindings)]=r}(n,t,r,u))}else i=function sle(n,t,e){let r;const s=t.directiveEnd;for(let i=1+t.directiveStylingLast;i<s;i++)r=vp(r,n[i].hostAttrs,e);return vp(r,t.attrs,e)}(n,t,r)}return void 0!==i&&(r?t.residualClasses=i:t.residualStyles=i),e}(s,i,t,r),function G4e(n,t,e,r,s,i){let o=i?t.classBindings:t.styleBindings,c=qa(o),u=Ac(o);n[r]=e;let g,h=!1;if(Array.isArray(e)){const m=e;g=m[1],(null===g||v2(m,g)>0)&&(h=!0)}else g=e;if(s)if(0!==u){const E=qa(n[c+1]);n[r+1]=uf(E,c),0!==E&&(n[E+1]=Dl(n[E+1],r)),n[c+1]=function cB(n,t){return 131071&n|t<<17}(n[c+1],r)}else n[r+1]=uf(c,0),0!==c&&(n[c+1]=Dl(n[c+1],r)),c=r;else n[r+1]=uf(u,0),0===c?c=r:n[u+1]=Dl(n[u+1],r),u=r;h&&(n[r+1]=np(n[r+1])),JB(n,g,r,!0),JB(n,g,r,!1),function q4e(n,t,e,r,s){const i=s?n.residualClasses:n.residualStyles;null!=i&&"string"==typeof t&&v2(i,t)>=0&&(e[r+1]=rp(e[r+1]))}(t,g,n,r,i),o=uf(c,u),i?t.classBindings=o:t.styleBindings=o}(s,i,t,e,o,r)}}function fb(n,t,e,r,s){let i=null;const o=e.directiveEnd;let c=e.directiveStylingLast;for(-1===c?c=e.directiveStart:c++;c<o&&(i=t[c],r=vp(r,i.hostAttrs,s),i!==n);)c++;return null!==n&&(e.directiveStylingLast=c),r}function vp(n,t,e){const r=e?1:2;let s=-1;if(null!==t)for(let i=0;i<t.length;i++){const o=t[i];"number"==typeof o?s=o:s===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),_2(n,o,!!e||t[++i]))}return void 0===n?null:n}function l$(n,t,e){_2(n,t,wo(e))}function u$(n,t,e,r,s,i,o,c){if(!(3&t.type))return;const u=n.data,h=u[c+1];dy(function HC(n){return 1==(1&n)}(h)?f$(u,t,e,s,Ac(h),o):void 0)||(dy(i)||function kO(n){return 2==(2&n)}(h)&&(i=f$(u,null,e,s,c,o)),function yC(n,t,e,r,s){if(t)s?n.addClass(e,r):n.removeClass(e,r);else{let i=-1===r.indexOf("-")?void 0:M2.DashCase;null==s?n.removeStyle(e,r,i):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),i|=M2.Important),n.setStyle(e,r,s,i))}}(r,o,q8(g2(),e),s,i))}function f$(n,t,e,r,s,i){const o=null===t;let c;for(;s>0;){const u=n[s],h=Array.isArray(u),g=h?u[1]:u,m=null===g;let E=e[s+1];E===mn&&(E=m?M1:void 0);let O=m?ci(E,r):g===r?E:void 0;if(h&&!dy(O)&&(O=ci(u,r)),dy(O)&&(c=O,o))return c;const k=n[s+1];s=o?qa(k):Ac(k)}if(null!==t){let u=i?t.residualClasses:t.residualStyles;null!=u&&(c=ci(u,r))}return c}function dy(n){return void 0!==n}function h$(n,t){return 0!=(n.flags&(t?16:32))}function wt(n,t=""){const e=Re(),r=Jn(),s=n+22,i=r.firstCreatePass?O0(r,s,1,t,null):r.data[s],o=e[s]=Rd(e[11],t);Tu(r,e,o,i),Sc(i,!1)}function c1(n){return Bi("",n,""),c1}function Bi(n,t,e){const r=Re(),s=d1(r,n,t,e);return s!==mn&&b3(r,g2(),s),Bi}function hb(n,t,e,r,s){const i=Re(),o=Us(i,n,t,e,r,s);return o!==mn&&b3(i,g2(),o),hb}function db(n,t,e,r,s,i,o){const c=Re(),u=da(c,n,t,e,r,s,i,o);return u!==mn&&b3(c,g2(),u),db}function pb(n,t,e){const r=Re();return D1(r,e0(),t)&&Io(Jn(),A1(),r,n,t,r[11],e,!0),pb}const ku=void 0;var Ole=["en",[["a","p"],["AM","PM"],ku],[["AM","PM"],ku,ku],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ku,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ku,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ku,"{1} 'at' {0}",ku],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function wle(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===r?1:5}];let bf={};function Lo(n){const t=function Ale(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=N$(t);if(e)return e;const r=t.split("-")[0];if(e=N$(r),e)return e;if("en"===r)return Ole;throw new Ne(701,!1)}function N$(n){return n in bf||(bf[n]=X1.ng&&X1.ng.common&&X1.ng.common.locales&&X1.ng.common.locales[n]),bf[n]}var Ct=(()=>((Ct=Ct||{})[Ct.LocaleId=0]="LocaleId",Ct[Ct.DayPeriodsFormat=1]="DayPeriodsFormat",Ct[Ct.DayPeriodsStandalone=2]="DayPeriodsStandalone",Ct[Ct.DaysFormat=3]="DaysFormat",Ct[Ct.DaysStandalone=4]="DaysStandalone",Ct[Ct.MonthsFormat=5]="MonthsFormat",Ct[Ct.MonthsStandalone=6]="MonthsStandalone",Ct[Ct.Eras=7]="Eras",Ct[Ct.FirstDayOfWeek=8]="FirstDayOfWeek",Ct[Ct.WeekendRange=9]="WeekendRange",Ct[Ct.DateFormat=10]="DateFormat",Ct[Ct.TimeFormat=11]="TimeFormat",Ct[Ct.DateTimeFormat=12]="DateTimeFormat",Ct[Ct.NumberSymbols=13]="NumberSymbols",Ct[Ct.NumberFormats=14]="NumberFormats",Ct[Ct.CurrencyCode=15]="CurrencyCode",Ct[Ct.CurrencySymbol=16]="CurrencySymbol",Ct[Ct.CurrencyName=17]="CurrencyName",Ct[Ct.Currencies=18]="Currencies",Ct[Ct.Directionality=19]="Directionality",Ct[Ct.PluralCase=20]="PluralCase",Ct[Ct.ExtraData=21]="ExtraData",Ct))();const Nle=["zero","one","two","few","many"],Af="en-US",py={marker:"element"},gy={marker:"ICU"};var us=(()=>((us=us||{})[us.SHIFT=2]="SHIFT",us[us.APPEND_EAGERLY=1]="APPEND_EAGERLY",us[us.COMMENT=2]="COMMENT",us))();let I$=Af;function x$(n){(function Mo(n,t){null==n&&O1(t,n,null,"!=")})(n,"Expected localeId to be defined"),"string"==typeof n&&(I$=n.toLowerCase().replace(/_/g,"-"))}function k$(n,t,e){const r=t.insertBeforeIndex,s=Array.isArray(r)?r[0]:r;return null===s?mC(n,0,e):Pr(e[s])}function L$(n,t,e,r,s){const i=t.insertBeforeIndex;if(Array.isArray(i)){let o=r,c=null;if(3&t.type||(c=o,o=s),null!==o&&0==(2&t.flags))for(let u=1;u<i.length;u++)T3(n,o,e[i[u]],c,!1)}}function R$(n,t){if(n.push(t),n.length>1)for(let e=n.length-2;e>=0;e--){const r=n[e];D$(r)||Lle(r,t)&&null===Rle(r)&&Dle(r,t.index)}}function D$(n){return!(64&n.type)}function Lle(n,t){return D$(t)||n.index>t.index}function Rle(n){const t=n.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function Dle(n,t){const e=n.insertBeforeIndex;Array.isArray(e)?e[0]=t:(nf(k$,L$),n.insertBeforeIndex=t)}function Cp(n,t){const e=n.data[t];return null===e||"string"==typeof e?null:e.hasOwnProperty("currentCaseLViewIndex")?e:e.value}function Hle(n,t,e){const r=mf(n,e,64,null,null);return R$(t,r),r}function my(n,t){const e=t[n.currentCaseLViewIndex];return null===e?e:e<0?~e:e}function z$(n){return n>>>17}function V$(n){return(131070&n)>>>1}let yp=0,Ep=0;function F$(n,t,e,r){const s=e[11];let o,i=null;for(let c=0;c<t.length;c++){const u=t[c];if("string"==typeof u){const h=t[++c];null===e[h]&&(e[h]=Rd(s,u))}else if("number"==typeof u)switch(1&u){case 0:const h=z$(u);let g,m;if(null===i&&(i=h,o=S0(s,r)),h===i?(g=r,m=o):(g=null,m=Pr(e[h])),null!==m){const U=V$(u);T3(s,m,e[U],g,!1);const oe=Cp(n,U);if(null!==oe&&"object"==typeof oe){const Ee=my(oe,e);null!==Ee&&F$(n,oe.create[Ee],e,e[oe.anchorIdx])}}break;case 1:const O=t[++c],k=t[++c];dp(s,q8(u>>>1,e),null,null,O,k,null)}else switch(u){case gy:const h=t[++c],g=t[++c];null===e[g]&&Fi(e[g]=oO(s,h),e);break;case py:const m=t[++c],E=t[++c];null===e[E]&&Fi(e[E]=Dd(s,m,null),e)}}}function B$(n,t,e,r,s){for(let i=0;i<e.length;i++){const o=e[i],c=e[++i];if(o&s){let u="";for(let h=i+1;h<=i+c;h++){const g=e[h];if("string"==typeof g)u+=g;else if("number"==typeof g)if(g<0)u+=on(t[r-g]);else{const m=g>>>2;switch(3&g){case 1:const E=e[++h],O=e[++h],k=n.data[m];"string"==typeof k?dp(t[11],t[m],null,k,E,u,O):Io(n,k,t,E,u,t[11],O,!1);break;case 0:const U=t[m];null!==U&&cC(t[11],U,u);break;case 2:Gle(n,Cp(n,m),t,u);break;case 3:$$(n,Cp(n,m),r,t)}}}}else{const u=e[i+1];if(u>0&&3==(3&u)){const g=Cp(n,u>>>2);t[g.currentCaseLViewIndex]<0&&$$(n,g,r,t)}}i+=c}}function $$(n,t,e,r){let s=r[t.currentCaseLViewIndex];if(null!==s){let i=yp;s<0&&(s=r[t.currentCaseLViewIndex]=~s,i=-1),B$(n,r,t.update[s],e,i)}}function Gle(n,t,e,r){const s=function qle(n,t){let e=n.cases.indexOf(t);if(-1===e)switch(n.type){case 1:{const r=function Ile(n,t){const e=function A$(n){return Lo(n)[Ct.PluralCase]}(t)(parseInt(n,10)),r=Nle[e];return void 0!==r?r:"other"}(t,function kle(){return I$}());e=n.cases.indexOf(r),-1===e&&"other"!==r&&(e=n.cases.indexOf("other"));break}case 0:e=n.cases.indexOf("other")}return-1===e?null:e}(t,r);if(my(t,e)!==s&&(U$(n,t,e),e[t.currentCaseLViewIndex]=null===s?null:~s,null!==s)){const o=e[t.anchorIdx];o&&F$(n,t.create[s],e,o)}}function U$(n,t,e){let r=my(t,e);if(null!==r){const s=t.remove[r];for(let i=0;i<s.length;i++){const o=s[i];if(o>0){const c=q8(o,e);null!==c&&vC(e[11],c)}else U$(n,Cp(n,~o),e)}}}function Wle(){const n=[];let e,r,t=-1;function i(c,u){t=0;const h=my(c,u);r=null!==h?c.remove[h]:M1}function o(){if(t<r.length){const c=r[t++];return c>0?e[c]:(n.push(t,r),i(e[1].data[~c],e),o())}return 0===n.length?null:(r=n.pop(),t=n.pop(),o())}return function s(c,u){for(e=u;n.length;)n.pop();return i(c.value,u),o}}const _y=/\ufffd(\d+):?\d*\ufffd/gi,Zle=/\ufffd(\d+)\ufffd/,q$=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,Yle=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,Kle=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,Xle=/\uE500/g;function W$(n,t,e,r,s,i,o){const c=zl(n,r,1,null);let u=c<<us.SHIFT,h=vl();t===h&&(h=null),null===h&&(u|=us.APPEND_EAGERLY),o&&(u|=us.COMMENT,function oC(n){void 0===Id&&(Id=n())}(Wle)),s.push(u,null===i?"":i);const g=mf(n,c,o?32:1,null===i?"":i,null);R$(e,g);const m=g.index;return Sc(g,!1),null!==h&&t!==h&&function Vle(n,t){let e=n.insertBeforeIndex;null===e?(nf(k$,L$),e=n.insertBeforeIndex=[null,t]):(function h1(n,t,e){n!=t&&O1(e,n,t,"==")}(Array.isArray(e),!0,"Expecting array here"),e.push(t))}(h,m),g}function e6e(n,t,e,r,s,i,o){const c=o.match(_y),u=W$(n,t,e,i,r,c?null:o,!1);c&&Sp(s,o,u.index,null,0,null)}function Sp(n,t,e,r,s,i){const o=n.length,c=o+1;n.push(null,null);const u=o+2,h=t.split(_y);let g=0;for(let m=0;m<h.length;m++){const E=h[m];if(1&m){const O=s+parseInt(E,10);n.push(-1-O),g|=j$(O)}else""!==E&&n.push(E)}return n.push(e<<2|(r?1:0)),r&&n.push(r,i),n[o]=g,n[c]=n.length-u,g}function j$(n){return 1<<Math.min(n,31)}function Z$(n){let t,i,e="",r=0,s=!1;for(;null!==(t=Yle.exec(n));)s?t[0]===`\ufffd/*${i}\ufffd`&&(r=t.index,s=!1):(e+=n.substring(r,t.index+t[0].length),i=t[1],s=!0);return e+=n.slice(r),e}function Y$(n,t,e,r,s,i){let o=0;const c={type:s.type,currentCaseLViewIndex:zl(n,t,1,null),anchorIdx:i,cases:[],create:[],remove:[],update:[]};(function c6e(n,t,e){n.push(j$(t.mainBinding),2,-1-t.mainBinding,e<<2|2)})(e,s,i),function zle(n,t,e){const r=n.data[t];null===r?n.data[t]=e:r.value=e}(n,i,c);const u=s.values;for(let h=0;h<u.length;h++){const g=u[h],m=[];for(let E=0;E<g.length;E++){const O=g[E];if("string"!=typeof O){const k=m.push(O)-1;g[E]=`\x3c!--\ufffd${k}\ufffd--\x3e`}}o=o6e(n,c,t,e,r,s.cases[h],g.join(""),m)|o}o&&function l6e(n,t,e){n.push(t,1,e<<2|3)}(e,o,i)}function i6e(n){const t=[],e=[];let r=1,s=0;const i=gb(n=n.replace(q$,function(o,c,u){return r="select"===u?0:1,s=parseInt(c.slice(1),10),""}));for(let o=0;o<i.length;){let c=i[o++].trim();1===r&&(c=c.replace(/\s*(?:=)?(\w+)\s*/,"$1")),c.length&&t.push(c);const u=gb(i[o++]);t.length>e.length&&e.push(u)}return{type:r,mainBinding:s,cases:t,values:e}}function gb(n){if(!n)return[];let t=0;const e=[],r=[],s=/[{}]/g;let i;for(s.lastIndex=0;i=s.exec(n);){const c=i.index;if("}"==i[0]){if(e.pop(),0==e.length){const u=n.substring(t,c);q$.test(u)?r.push(i6e(u)):r.push(u),t=c+1}}else{if(0==e.length){const u=n.substring(t,c);r.push(u),t=c+1}e.push("{")}}const o=n.substring(t);return r.push(o),r}function o6e(n,t,e,r,s,i,o,c){const u=[],h=[],g=[];t.cases.push(i),t.create.push(u),t.remove.push(h),t.update.push(g);const E=bv(Ev()).getInertBodyElement(o),O=bo(E)||E;return O?K$(n,t,e,r,u,h,g,O,s,c,0):0}function K$(n,t,e,r,s,i,o,c,u,h,g){let m=0,E=c.firstChild;for(;E;){const O=zl(n,e,1,null);switch(E.nodeType){case Node.ELEMENT_NODE:const k=E,U=k.tagName.toLowerCase();if(du.hasOwnProperty(U)){mb(s,py,U,u,O),n.data[O]=U;const ne=k.attributes;for(let ke=0;ke<ne.length;ke++){const Ue=ne.item(ke),et=Ue.name.toLowerCase();Ue.value.match(_y)?U7.hasOwnProperty(et)&&Sp(o,Ue.value,O,Ue.name,0,$7[et]?ha:null):u6e(s,O,Ue)}m=K$(n,t,e,r,s,i,o,E,O,h,g+1)|m,X$(i,O,g)}break;case Node.TEXT_NODE:const j=E.textContent||"",oe=j.match(_y);mb(s,null,oe?"":j,u,O),X$(i,O,g),oe&&(m=Sp(o,j,O,null,0,null)|m);break;case Node.COMMENT_NODE:const Ee=Zle.exec(E.textContent||"");if(Ee){const ke=h[parseInt(Ee[1],10)];mb(s,gy,"",u,O),Y$(n,e,r,u,ke,O),a6e(i,O,g)}}E=E.nextSibling}return m}function X$(n,t,e){0===e&&n.push(t)}function a6e(n,t,e){0===e&&(n.push(~t),n.push(t))}function mb(n,t,e,r,s){null!==t&&n.push(t),n.push(e,s,function Fle(n,t,e){return n|t<<17|e<<1}(0,r,s))}function u6e(n,t,e){n.push(t<<1|1,e.name,e.value)}function ga(n,t,e=-1){const r=Jn(),s=Re(),i=22+n,o=d3(r.consts,t),c=vl();r.firstCreatePass&&function Jle(n,t,e,r,s,i){const o=vl(),c=[],u=[],h=[[]];s=function s6e(n,t){if(function r6e(n){return-1===n}(t))return Z$(n);{const e=n.indexOf(`:${t}\ufffd`)+2+t.toString().length,r=n.search(new RegExp(`\ufffd\\/\\*\\d+:${t}\ufffd`));return Z$(n.substring(e,r))}}(s,i);const g=function Qle(n){return n.replace(Xle," ")}(s).split(Kle);for(let m=0;m<g.length;m++){let E=g[m];if(0==(1&m)){const O=gb(E);for(let k=0;k<O.length;k++){let U=O[k];if(0==(1&k)){const j=U;""!==j&&e6e(n,o,h[0],c,u,e,j)}else{const j=U;if("object"!=typeof j)throw new Error(`Unable to parse ICU expression in "${s}" message.`);Y$(n,e,u,t,j,W$(n,o,h[0],e,c,"",!0).index)}}}else{const O=47===E.charCodeAt(0),U=(E.charCodeAt(O?1:0),22+Number.parseInt(E.substring(O?2:1)));if(O)h.shift(),Sc(vl(),!1);else{const j=Hle(n,h[0],U);h.unshift([]),Sc(j,!0)}}}n.data[r]={create:c,update:u}}(r,null===c?0:c.index,s,i,o,e);const u=r.data[i],g=Fd(r,c===s[6]?null:c,s);(function Ule(n,t,e,r){const s=n[11];for(let i=0;i<t.length;i++){const o=t[i++],c=t[i],u=(o&us.COMMENT)===us.COMMENT,h=(o&us.APPEND_EAGERLY)===us.APPEND_EAGERLY,g=o>>>us.SHIFT;let m=n[g];null===m&&(m=n[g]=u?s.createComment(c):Rd(s,c)),h&&null!==e&&T3(s,e,m,r,!1)}})(s,u.create,g,c&&8&c.type?s[c.index]:null),p2(!0)}function ma(){p2(!1)}function Ce(n,t,e){ga(n,t,e),ma()}function S1(n){return function Ble(n){n&&(yp|=1<<Math.min(Ep,31)),Ep++}(D1(Re(),e0(),n)),S1}function N1(n){!function $le(n,t,e){if(Ep>0){const r=n.data[e];B$(n,t,Array.isArray(r)?r:r.update,Pc()-Ep-1,yp)}yp=0,Ep=0}(Jn(),Re(),n+22)}function _b(n,t,e,r,s){if(n=sn(n),Array.isArray(n))for(let i=0;i<n.length;i++)_b(n[i],t,e,r,s);else{const i=Jn(),o=Re();let c=Il(n)?n:sn(n.provide),u=Z7(n);const h=Vr(),g=1048575&h.providerIndexes,m=h.directiveStart,E=h.providerIndexes>>20;if(Il(n)||!n.multi){const O=new Q8(u,s,Q),k=Cb(c,t,s?g:g+E,m);-1===k?(s0(O7(h,o),i,c),vb(i,n,t.length),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(O),o.push(O)):(e[k]=O,o[k]=O)}else{const O=Cb(c,t,g+E,m),k=Cb(c,t,g,g+E),U=O>=0&&e[O],j=k>=0&&e[k];if(s&&!j||!s&&!U){s0(O7(h,o),i,c);const oe=function P6e(n,t,e,r,s){const i=new Q8(n,e,Q);return i.multi=[],i.index=t,i.componentProviders=0,J$(i,s,r&&!e),i}(s?S6e:M6e,e.length,s,r,u);!s&&j&&(e[k].providerFactory=oe),vb(i,n,t.length,0),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(oe),o.push(oe)}else vb(i,n,O>-1?O:k,J$(e[s?k:O],u,!s&&r));!s&&r&&j&&e[k].componentProviders++}}}function vb(n,t,e,r){const s=Il(t),i=function Tw(n){return!!n.useClass}(t);if(s||i){const u=(i?sn(t.useClass):t).prototype.ngOnDestroy;if(u){const h=n.destroyHooks||(n.destroyHooks=[]);if(!s&&t.multi){const g=h.indexOf(e);-1===g?h.push(e,[r,u]):h[g+1].push(r,u)}else h.push(e,u)}}}function J$(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function Cb(n,t,e,r){for(let s=e;s<r;s++)if(t[s]===n)return s;return-1}function M6e(n,t,e,r){return yb(this.multi,[])}function S6e(n,t,e,r){const s=this.multi;let i;if(this.providerFactory){const o=this.providerFactory.componentProviders,c=$s(e,e[1],this.providerFactory.index,r);i=c.slice(0,o),yb(s,i);for(let u=o;u<c.length;u++)i.push(c[u])}else i=[],yb(s,i);return i}function yb(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Fr(n,t=[]){return e=>{e.providersResolver=(r,s)=>function E6e(n,t,e){const r=Jn();if(r.firstCreatePass){const s=Ss(n);_b(e,r.data,r.blueprint,s,!0),_b(t,r.data,r.blueprint,s,!1)}}(r,s?s(n):n,t)}}class Lu{}class eU{}class tU extends Lu{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new mp(this);const r=So(t);this._bootstrapComponents=Ua(r.bootstrap),this._r3Injector=xC(t,e,[{provide:Lu,useValue:this},{provide:v0,useValue:this.componentFactoryResolver}],Z1(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Eb extends eU{constructor(t){super(),this.moduleType=t}create(t){return new tU(this.moduleType,t)}}class w6e extends Lu{constructor(t,e,r){super(),this.componentFactoryResolver=new mp(this),this.instance=null;const s=new j7([...t,{provide:Lu,useValue:this},{provide:v0,useValue:this.componentFactoryResolver}],e||v4(),r,new Set(["environment"]));this.injector=s,s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function vy(n,t,e=null){return new w6e(n,t,e).injector}let O6e=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const r=Cd(0,e.type),s=r.length>0?vy([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,s)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=nt({token:n,providedIn:"environment",factory:()=>new n(ze($a))}),n})();function nU(n){n.getStandaloneInjector=t=>t.get(O6e).getOrCreateStandaloneInjector(n)}function er(n,t,e){const r=Di()+n,s=Re();return s[r]===mn?yn(s,r,e?t.call(e):t()):function J1(n,t){return n[t]}(s,r)}function I3(n,t,e,r){return lU(Re(),Di(),n,t,e,r)}function Pp(n,t){const e=n[t];return e===mn?void 0:e}function lU(n,t,e,r,s,i){const o=t+e;return D1(n,o,s)?yn(n,o+1,i?r.call(i,s):r(s)):Pp(n,o+1)}function x3(n,t){const e=Jn();let r;const s=n+22;e.firstCreatePass?(r=function G6e(n,t){if(t)for(let e=t.length-1;e>=0;e--){const r=t[e];if(n===r.name)return r}}(t,e.pipeRegistry),e.data[s]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(s,r.onDestroy)):r=e.data[s];const i=r.factory||(r.factory=Da(r.type)),o=ta(Q);try{const c=h4(!1),u=i();return h4(c),function H4e(n,t,e,r){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=r}(e,Re(),s,u),u}finally{ta(o)}}function T4(n,t,e){const r=n+22,s=Re(),i=_l(s,r);return Tp(s,r)?lU(s,Di(),t,i.transform,e,i):i.transform(e)}function pU(n,t,e,r){const s=n+22,i=Re(),o=_l(i,s);return Tp(i,s)?function uU(n,t,e,r,s,i,o){const c=t+e;return S2(n,c,s,i)?yn(n,c+2,o?r.call(o,s,i):r(s,i)):Pp(n,c+2)}(i,Di(),t,o.transform,e,r,o):o.transform(e,r)}function Tp(n,t){return n[1].data[t].pure}function Sb(n){return t=>{setTimeout(n,void 0,t)}}const dr=class Z6e extends W2{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,r){let s=t,i=e||(()=>null),o=r;if(t&&"object"==typeof t){const u=t;s=u.next?.bind(u),i=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(i=Sb(i),s&&(s=Sb(s)),o&&(o=Sb(o)));const c=super.subscribe({next:s,error:i,complete:o});return t instanceof k1&&t.add(c),c}};function Y6e(){return this._results[we()]()}class Pb{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=we(),r=Pb.prototype;r[e]||(r[e]=Y6e)}get changes(){return this._changes||(this._changes=new dr)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const r=this;r.dirty=!1;const s=m2(t);(this._changesDetected=!function J9(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++){let s=n[r],i=t[r];if(e&&(s=e(s),i=e(i)),i!==s)return!1}return!0}(r._results,s,e))&&(r._results=s,r.length=s.length,r.last=s[this.length-1],r.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Hl=(()=>{class n{}return n.__NG_ELEMENT_ID__=Q6e,n})();const K6e=Hl,X6e=class extends K6e{constructor(t,e,r){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(t,e){const r=this._declarationTContainer.tViews,s=gf(this._declarationLView,r,t,16,null,r.declTNode,null,null,null,null,e||null);s[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(s[19]=o.createEmbeddedView(r)),_f(r,s,t),new wf(s)}};function Q6e(){return Cy(Vr(),Re())}function Cy(n,t){return 4&n.type?new X6e(t,n,C0(n,t)):null}let Za=(()=>{class n{}return n.__NG_ELEMENT_ID__=J6e,n})();function J6e(){return _U(Vr(),Re())}const e0e=Za,gU=class extends e0e{constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return C0(this._hostTNode,this._hostLView)}get injector(){return new o0(this._hostTNode,this._hostLView)}get parentInjector(){const t=Ha(this._hostTNode,this._hostLView);if(W9(t)){const e=Sl(t,this._hostLView),r=Ml(t);return new o0(e[1].data[r+8],e)}return new o0(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=mU(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,r){let s,i;"number"==typeof r?s=r:null!=r&&(s=r.index,i=r.injector);const o=t.createEmbeddedView(e||{},i);return this.insert(o,s),o}createComponent(t,e,r,s,i){const o=t&&!function zi(n){return"function"==typeof n}(t);let c;if(o)c=e;else{const m=e||{};c=m.index,r=m.injector,s=m.projectableNodes,i=m.environmentInjector||m.ngModuleRef}const u=o?t:new Iu(b1(t)),h=r||this.parentInjector;if(!i&&null==u.ngModule){const E=(o?h:this.parentInjector).get($a,null);E&&(i=E)}const g=u.create(h,s,void 0,i);return this.insert(g.hostView,c),g}insert(t,e){const r=t._lView,s=r[1];if(function W8(n){return Sr(n[3])}(r)){const g=this.indexOf(t);if(-1!==g)this.detach(g);else{const m=r[3],E=new gU(m,m[6],m[3]);E.detach(E.indexOf(t))}}const i=this._adjustIndex(e),o=this._lContainer;!function fO(n,t,e,r){const s=10+r,i=e.length;r>0&&(e[s-1][4]=t),r<i-10?(t[4]=e[s],y3(e,10+r,t)):(e.push(t),t[4]=null),t[3]=e;const o=t[17];null!==o&&e!==o&&function hO(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(o,t);const c=t[19];null!==c&&c.insertView(n),t[2]|=64}(s,r,o,i);const c=P0(i,o),u=r[11],h=S0(u,o[7]);return null!==h&&function cO(n,t,e,r,s,i){r[0]=s,r[6]=t,T0(n,r,e,1,s,i)}(s,o[6],u,r,h,c),t.attachToViewContainerRef(),y3(Tb(o),i,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=mU(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),r=zd(this._lContainer,e);r&&(f0(Tb(this._lContainer),e),uC(r[1],r))}detach(t){const e=this._adjustIndex(t,-1),r=zd(this._lContainer,e);return r&&null!=f0(Tb(this._lContainer),e)?new wf(r):null}_adjustIndex(t,e=0){return t??this.length+e}};function mU(n){return n[8]}function Tb(n){return n[8]||(n[8]=[])}function _U(n,t){let e;const r=t[n.index];if(Sr(r))e=r;else{let s;if(8&n.type)s=Pr(r);else{const i=t[11];s=i.createComment("");const o=d2(n,t);T3(i,S0(i,o),s,function pC(n,t){return n.nextSibling(t)}(i,o),!1)}t[n.index]=e=ty(r,t,s,n),Mf(t,e)}return new gU(e,n,t)}class wb{constructor(t){this.queryList=t,this.matches=null}clone(){return new wb(this.queryList)}setDirty(){this.queryList.setDirty()}}class Ob{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const r=null!==t.contentQueries?t.contentQueries[0]:e.length,s=[];for(let i=0;i<r;i++){const o=e.getByIndex(i);s.push(this.queries[o.indexInDeclarationView].clone())}return new Ob(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==MU(t,e).matches&&this.queries[e].setDirty()}}class vU{constructor(t,e,r=null){this.predicate=t,this.flags=e,this.read=r}}class bb{constructor(t=[]){this.queries=t}elementStart(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let r=0;r<this.length;r++){const s=null!==e?e.length:0,i=this.getByIndex(r).embeddedTView(t,s);i&&(i.indexInDeclarationView=r,null!==e?e.push(i):e=[i])}return null!==e?new bb(e):null}template(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Ab{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new Ab(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let s=0;s<r.length;s++){const i=r[s];this.matchTNodeWithReadOption(t,e,r0e(e,i)),this.matchTNodeWithReadOption(t,e,Kr(e,t,i,!1,!1))}else r===Hl?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Kr(e,t,r,!1,!1))}matchTNodeWithReadOption(t,e,r){if(null!==r){const s=this.metadata.read;if(null!==s)if(s===y2||s===Za||s===Hl&&4&e.type)this.addMatch(e.index,-2);else{const i=Kr(e,t,s,!1,!1);null!==i&&this.addMatch(e.index,i)}else this.addMatch(e.index,r)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function r0e(n,t){const e=n.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===t)return e[r+1];return null}function i0e(n,t,e,r){return-1===e?function s0e(n,t){return 11&n.type?C0(n,t):4&n.type?Cy(n,t):null}(t,n):-2===e?function o0e(n,t,e){return e===y2?C0(t,n):e===Hl?Cy(t,n):e===Za?_U(t,n):void 0}(n,t,r):$s(n,n[1],e,t)}function CU(n,t,e,r){const s=t[19].queries[r];if(null===s.matches){const i=n.data,o=e.matches,c=[];for(let u=0;u<o.length;u+=2){const h=o[u];c.push(h<0?null:i0e(t,i[h],o[u+1],e.metadata.read))}s.matches=c}return s.matches}function Nb(n,t,e,r){const s=n.queries.getByIndex(e),i=s.matches;if(null!==i){const o=CU(n,t,s,e);for(let c=0;c<i.length;c+=2){const u=i[c];if(u>0)r.push(o[c/2]);else{const h=i[c+1],g=t[-u];for(let m=10;m<g.length;m++){const E=g[m];E[17]===E[3]&&Nb(E[1],E,h,r)}if(null!==g[9]){const m=g[9];for(let E=0;E<m.length;E++){const O=m[E];Nb(O[1],O,h,r)}}}}}return r}function w4(n){const t=Re(),e=Jn(),r=B9();j8(r+1);const s=MU(e,r);if(n.dirty&&function X_(n){return 4==(4&n[2])}(t)===(2==(2&s.metadata.flags))){if(null===s.matches)n.reset([]);else{const i=s.crossesNgTemplate?Nb(e,t,r,[]):CU(e,t,s,r);n.reset(i,K7),n.notifyOnChanges()}return!0}return!1}function I0(n,t,e){const r=Jn();r.firstCreatePass&&(function EU(n,t,e){null===n.queries&&(n.queries=new bb),n.queries.track(new Ab(t,e))}(r,new vU(n,t,e),-1),2==(2&t)&&(r.staticViewQueries=!0)),function yU(n,t,e){const r=new Pb(4==(4&e));ZO(n,t,r,r.destroy),null===t[19]&&(t[19]=new Ob),t[19].queries.push(new wb(r))}(r,Re(),t)}function O4(){return function a0e(n,t){return n[19].queries[t].queryList}(Re(),B9())}function MU(n,t){return n.queries.getByIndex(t)}function qn(n,t){return Cy(n,t)}function Ey(...n){}const My=new Dt("Application Initializer");let Sy=(()=>{class n{constructor(e){this.appInits=e,this.resolve=Ey,this.reject=Ey,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,s)=>{this.resolve=r,this.reject=s})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const i=this.appInits[s]();if(_p(i))e.push(i);else if(ub(i)){const o=new Promise((c,u)=>{i.subscribe({complete:c,error:u})});e.push(o)}}Promise.all(e).then(()=>{r()}).catch(s=>{this.reject(s)}),0===e.length&&r(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(ze(My,8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Op=new Dt("AppId",{providedIn:"root",factory:function BU(){return`${Db()}${Db()}${Db()}`}});function Db(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const $U=new Dt("Platform Initializer"),bp=new Dt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),UU=new Dt("appBootstrapListener"),GU=new Dt("AnimationModuleType");let b0e=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const b4=new Dt("LocaleId",{providedIn:"root",factory:()=>Hr(b4,Yt.Optional|Yt.SkipSelf)||function A0e(){return typeof $localize<"u"&&$localize.locale||Af}()});class I0e{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let zb=(()=>{class n{compileModuleSync(e){return new Eb(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),i=Ua(So(e).declarations).reduce((o,c)=>{const u=b1(c);return u&&o.push(new Iu(u)),o},[]);return new I0e(r,i)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const L0e=(()=>Promise.resolve(0))();function Vb(n){typeof Zone>"u"?L0e.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class wr{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new dr(!1),this.onMicrotaskEmpty=new dr(!1),this.onStable=new dr(!1),this.onError=new dr(!1),typeof Zone>"u")throw new Ne(908,!1);Zone.assertZonePatched();const s=this;if(s._nesting=0,s._outer=s._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const i=Zone.AsyncStackTaggingZoneSpec;s._inner=s._inner.fork(new i("Angular"))}Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&e,s.shouldCoalesceRunChangeDetection=r,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function R0e(){let n=X1.requestAnimationFrame,t=X1.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function V0e(n){const t=()=>{!function z0e(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(X1,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Fb(n),n.isCheckStableRunning=!0,Hb(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Fb(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,s,i,o,c)=>{try{return jU(n),e.invokeTask(s,i,o,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||n.shouldCoalesceRunChangeDetection)&&t(),ZU(n)}},onInvoke:(e,r,s,i,o,c,u)=>{try{return jU(n),e.invoke(s,i,o,c,u)}finally{n.shouldCoalesceRunChangeDetection&&t(),ZU(n)}},onHasTask:(e,r,s,i)=>{e.hasTask(s,i),r===s&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,Fb(n),Hb(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,r,s,i)=>(e.handleError(s,i),n.runOutsideAngular(()=>n.onError.emit(i)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!wr.isInAngularZone())throw new Ne(909,!1)}static assertNotInAngularZone(){if(wr.isInAngularZone())throw new Ne(909,!1)}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,s){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+s,t,D0e,Ey,Ey);try{return i.runTask(o,e,r)}finally{i.cancelTask(o)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}}const D0e={};function Hb(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Fb(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function jU(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function ZU(n){n._nesting--,Hb(n)}class H0e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new dr,this.onMicrotaskEmpty=new dr,this.onStable=new dr,this.onError=new dr}run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,s){return t.apply(e,r)}}const YU=new Dt(""),Py=new Dt("");let Ub,Bb=(()=>{class n{constructor(e,r,s){this._ngZone=e,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Ub||(function F0e(n){Ub=n}(s),s.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{wr.assertNotInAngularZone(),Vb(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Vb(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,s){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==i),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:s})}whenStable(e,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,s){return[]}}return n.\u0275fac=function(e){return new(e||n)(ze(wr),ze($b),ze(Py))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),$b=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return Ub?.findTestabilityInTree(this,e,r)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),x0=null;const KU=new Dt("AllowMultipleToken"),Gb=new Dt("PlatformDestroyListeners");class XU{constructor(t,e){this.name=t,this.token=e}}function JU(n,t,e=[]){const r=`Platform: ${t}`,s=new Dt(r);return(i=[])=>{let o=qb();if(!o||o.injector.get(KU,!1)){const c=[...e,...i,{provide:s,useValue:!0}];n?n(c):function U0e(n){if(x0&&!x0.get(KU,!1))throw new Ne(400,!1);x0=n;const t=n.get(tG);(function QU(n){const t=n.get($U,null);t&&t.forEach(e=>e())})(n)}(function eG(n=[],t){return fi.create({name:t,providers:[{provide:Ed,useValue:"platform"},{provide:Gb,useValue:new Set([()=>x0=null])},...n]})}(c,r))}return function q0e(n){const t=qb();if(!t)throw new Ne(401,!1);return t}()}}function qb(){return x0?.get(tG)??null}let tG=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const s=function rG(n,t){let e;return e="noop"===n?new H0e:("zone.js"===n?void 0:n)||new wr(t),e}(r?.ngZone,function nG(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(r)),i=[{provide:wr,useValue:s}];return s.run(()=>{const o=fi.create({providers:i,parent:this.injector,name:e.moduleType.name}),c=e.create(o),u=c.injector.get(M0,null);if(!u)throw new Ne(402,!1);return s.runOutsideAngular(()=>{const h=s.onError.subscribe({next:g=>{u.handleError(g)}});c.onDestroy(()=>{Ty(this._modules,c),h.unsubscribe()})}),function sG(n,t,e){try{const r=e();return _p(r)?r.catch(s=>{throw t.runOutsideAngular(()=>n.handleError(s)),s}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}(u,s,()=>{const h=c.injector.get(Sy);return h.runInitializers(),h.donePromise.then(()=>(x$(c.injector.get(b4,Af)||Af),this._moduleDoBootstrap(c),c))})})}bootstrapModule(e,r=[]){const s=iG({},r);return function B0e(n,t,e){const r=new Eb(e);return Promise.resolve(r)}(0,0,e).then(i=>this.bootstrapModuleFactory(i,s))}_moduleDoBootstrap(e){const r=e.injector.get(Ap);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(s=>r.bootstrap(s));else{if(!e.instance.ngDoBootstrap)throw new Ne(403,!1);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ne(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const e=this._injector.get(Gb,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(ze(fi))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function iG(n,t){return Array.isArray(t)?t.reduce(iG,n):{...n,...t}}let Ap=(()=>{class n{constructor(e,r,s){this._zone=e,this._injector=r,this._exceptionHandler=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const i=new Mr(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),o=new Mr(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{wr.assertNotInAngularZone(),Vb(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{wr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=function R_(...n){const t=r4(n),e=function s7(n,t){return"number"==typeof dl(n)?n.pop():t}(n,1/0),r=n;return r.length?1===r.length?Eo(r[0]):hl(e)(ls(r,t)):Ec}(i,o.pipe(function OT(n={}){const{connector:t=(()=>new W2),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:s=!0}=n;return i=>{let o,c,u,h=0,g=!1,m=!1;const E=()=>{c?.unsubscribe(),c=void 0},O=()=>{E(),o=u=void 0,g=m=!1},k=()=>{const U=o;O(),U?.unsubscribe()};return hr((U,j)=>{h++,!m&&!g&&E();const oe=u=u??t();j.add(()=>{h--,0===h&&!m&&!g&&(c=a7(k,s))}),oe.subscribe(j),!o&&h>0&&(o=new or({next:Ee=>oe.next(Ee),error:Ee=>{m=!0,E(),c=a7(O,e,Ee),oe.error(Ee)},complete:()=>{g=!0,E(),c=a7(O,r),oe.complete()}}),Eo(U).subscribe(o))})(i)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,r){const s=e instanceof Wv;if(!this._injector.get(Sy).done)throw!s&&function ml(n){const t=b1(n)||c2(n)||l2(n);return null!==t&&t.standalone}(e),new Ne(405,false);let o;o=s?e:this._injector.get(v0).resolveComponentFactory(e),this.componentTypes.push(o.componentType);const c=function $0e(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Lu),h=o.create(fi.NULL,[],r||o.selector,c),g=h.location.nativeElement,m=h.injector.get(YU,null);return m?.registerApplication(g),h.onDestroy(()=>{this.detachView(h.hostView),Ty(this.components,h),m?.unregisterApplication(g)}),this._loadComponent(h),h}tick(){if(this._runningTick)throw new Ne(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;Ty(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(UU,[]).concat(this._bootstrapListeners).forEach(s=>s(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>Ty(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Ne(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)(ze(wr),ze($a),ze(M0))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ty(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let aG=!0,Ru=(()=>{class n{}return n.__NG_ELEMENT_ID__=Z0e,n})();function Z0e(n){return function Y0e(n,t,e){if(ia(n)&&!e){const r=Ri(n.index,t);return new wf(r,r)}return 47&n.type?new wf(t[16],t):null}(Vr(),Re(),16==(16&n))}class hG{constructor(){}supports(t){return He(t)}create(t){return new t8e(t)}}const e8e=(n,t)=>t;class t8e{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||e8e}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,r=this._removalsHead,s=0,i=null;for(;e||r;){const o=!r||e&&e.currentIndex<pG(r,s,i)?e:r,c=pG(o,s,i),u=o.currentIndex;if(o===r)s--,r=r._nextRemoved;else if(e=e._next,null==o.previousIndex)s++;else{i||(i=[]);const h=c-s,g=u-s;if(h!=g){for(let E=0;E<h;E++){const O=E<i.length?i[E]:i[E]=0,k=O+E;g<=k&&k<h&&(i[E]=O+1)}i[o.previousIndex]=g-h}}c!==u&&t(o,c,u)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!He(t))throw new Ne(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let s,i,o,e=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let c=0;c<this.length;c++)i=t[c],o=this._trackByFn(c,i),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,i,o,c)),Object.is(e.item,i)||this._addIdentityChange(e,i)):(e=this._mismatch(e,i,o,c),r=!0),e=e._next}else s=0,function ot(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[we()]();let r;for(;!(r=e.next()).done;)t(r.value)}}(t,c=>{o=this._trackByFn(s,c),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,c,o,s)),Object.is(e.item,c)||this._addIdentityChange(e,c)):(e=this._mismatch(e,c,o,s),r=!0),e=e._next,s++}),this.length=s;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,r,s){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,s)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,s))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,s)):t=this._addAfter(new n8e(e,r),i,s),t}_verifyReinsertion(t,e,r,s){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==i?t=this._reinsertAfter(i,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const s=t._prevRemoved,i=t._nextRemoved;return null===s?this._removalsHead=i:s._nextRemoved=i,null===i?this._removalsTail=s:i._prevRemoved=s,this._insertAfter(t,e,r),this._addToMoves(t,r),t}_moveAfter(t,e,r){return this._unlink(t),this._insertAfter(t,e,r),this._addToMoves(t,r),t}_addAfter(t,e,r){return this._insertAfter(t,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,r){const s=null===e?this._itHead:e._next;return t._next=s,t._prev=e,null===s?this._itTail=t:s._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new dG),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,r=t._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new dG),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class n8e{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class r8e{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const e=t._prevDup,r=t._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class dG{constructor(){this.map=new Map}put(t){const e=t.trackById;let r=this.map.get(e);r||(r=new r8e,this.map.set(e,r)),r.add(t)}get(t,e){const s=this.map.get(t);return s?s.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function pG(n,t,e){const r=n.previousIndex;if(null===r)return r;let s=0;return e&&r<e.length&&(s=e[r]),r+t+s}class gG{constructor(){}supports(t){return t instanceof Map||yt(t)}create(){return new s8e}}class s8e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||yt(t)))throw new Ne(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,s)=>{if(e&&e.key===s)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(s,r);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const r=t._prev;return e._next=t,e._prev=r,t._prev=e,r&&(r._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const s=this._records.get(t);this._maybeAddToChanges(s,e);const i=s._prev,o=s._next;return i&&(i._next=o),o&&(o._prev=i),s._next=null,s._prev=null,s}const r=new i8e(t);return this._records.set(t,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(r=>e(t[r],r))}}class i8e{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function mG(){return new by([new hG])}let by=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(null!=r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||mG()),deps:[[n,new lu,new ui]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(null!=r)return r;throw new Ne(901,!1)}}return n.\u0275prov=nt({token:n,providedIn:"root",factory:mG}),n})();function _G(){return new Np([new gG])}let Np=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||_G()),deps:[[n,new lu,new ui]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(r)return r;throw new Ne(901,!1)}}return n.\u0275prov=nt({token:n,providedIn:"root",factory:_G}),n})();const c8e=JU(null,"core",[]);let l8e=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(ze(Ap))},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({}),n})();function Bl(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let Ay=null;function A4(){return Ay}const Gs=new Dt("DocumentToken");let Kb=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:function(){return function d8e(){return ze(vG)}()},providedIn:"platform"}),n})();const p8e=new Dt("Location Initialized");let vG=(()=>{class n extends Kb{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return A4().getBaseHref(this._doc)}onPopState(e){const r=A4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=A4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,s){CG()?this._history.pushState(e,r,s):this.location.hash=s}replaceState(e,r,s){CG()?this._history.replaceState(e,r,s):this.location.hash=s}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(ze(Gs))},n.\u0275prov=nt({token:n,factory:function(){return function g8e(){return new vG(ze(Gs))}()},providedIn:"platform"}),n})();function CG(){return!!window.history.pushState}function Xb(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function yG(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function $l(n){return n&&"?"!==n[0]?"?"+n:n}let zu=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:function(){return Hr(MG)},providedIn:"root"}),n})();const EG=new Dt("appBaseHref");let MG=(()=>{class n extends zu{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Hr(Gs).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return Xb(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+$l(this._platformLocation.search),s=this._platformLocation.hash;return s&&e?`${r}${s}`:r}pushState(e,r,s,i){const o=this.prepareExternalUrl(s+$l(i));this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){const o=this.prepareExternalUrl(s+$l(i));this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(ze(Kb),ze(EG,8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),m8e=(()=>{class n extends zu{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=Xb(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,s,i){let o=this.prepareExternalUrl(s+$l(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){let o=this.prepareExternalUrl(s+$l(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(ze(Kb),ze(EG,8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),Qb=(()=>{class n{constructor(e){this._subject=new dr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._baseHref=yG(SG(r)),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+$l(r))}normalize(e){return n.stripTrailingSlash(function v8e(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,SG(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",s=null){this._locationStrategy.pushState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+$l(r)),s)}replaceState(e,r="",s=null){this._locationStrategy.replaceState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+$l(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(s=>s(e,r))}subscribe(e,r,s){return this._subject.subscribe({next:e,error:r,complete:s})}}return n.normalizeQueryParams=$l,n.joinWithSlash=Xb,n.stripTrailingSlash=yG,n.\u0275fac=function(e){return new(e||n)(ze(zu))},n.\u0275prov=nt({token:n,factory:function(){return function _8e(){return new Qb(ze(zu))}()},providedIn:"root"}),n})();function SG(n){return n.replace(/\/index.html$/,"")}var _a=(()=>((_a=_a||{})[_a.Decimal=0]="Decimal",_a[_a.Percent=1]="Percent",_a[_a.Currency=2]="Currency",_a[_a.Scientific=3]="Scientific",_a))(),Ts=(()=>((Ts=Ts||{})[Ts.Format=0]="Format",Ts[Ts.Standalone=1]="Standalone",Ts))(),e1=(()=>((e1=e1||{})[e1.Narrow=0]="Narrow",e1[e1.Abbreviated=1]="Abbreviated",e1[e1.Wide=2]="Wide",e1[e1.Short=3]="Short",e1))(),Qr=(()=>((Qr=Qr||{})[Qr.Short=0]="Short",Qr[Qr.Medium=1]="Medium",Qr[Qr.Long=2]="Long",Qr[Qr.Full=3]="Full",Qr))(),nn=(()=>((nn=nn||{})[nn.Decimal=0]="Decimal",nn[nn.Group=1]="Group",nn[nn.List=2]="List",nn[nn.PercentSign=3]="PercentSign",nn[nn.PlusSign=4]="PlusSign",nn[nn.MinusSign=5]="MinusSign",nn[nn.Exponential=6]="Exponential",nn[nn.SuperscriptingExponent=7]="SuperscriptingExponent",nn[nn.PerMille=8]="PerMille",nn[nn.Infinity=9]="Infinity",nn[nn.NaN=10]="NaN",nn[nn.TimeSeparator=11]="TimeSeparator",nn[nn.CurrencyDecimal=12]="CurrencyDecimal",nn[nn.CurrencyGroup=13]="CurrencyGroup",nn))();function Ny(n,t){return xc(Lo(n)[Ct.DateFormat],t)}function Iy(n,t){return xc(Lo(n)[Ct.TimeFormat],t)}function xy(n,t){return xc(Lo(n)[Ct.DateTimeFormat],t)}function Ic(n,t){const e=Lo(n),r=e[Ct.NumberSymbols][t];if(typeof r>"u"){if(t===nn.CurrencyDecimal)return e[Ct.NumberSymbols][nn.Decimal];if(t===nn.CurrencyGroup)return e[Ct.NumberSymbols][nn.Group]}return r}function TG(n){if(!n[Ct.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Ct.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function xc(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function eA(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const I8e=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Ip={},x8e=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var di=(()=>((di=di||{})[di.Short=0]="Short",di[di.ShortGMT=1]="ShortGMT",di[di.Long=2]="Long",di[di.Extended=3]="Extended",di))(),fn=(()=>((fn=fn||{})[fn.FullYear=0]="FullYear",fn[fn.Month=1]="Month",fn[fn.Date=2]="Date",fn[fn.Hours=3]="Hours",fn[fn.Minutes=4]="Minutes",fn[fn.Seconds=5]="Seconds",fn[fn.FractionalSeconds=6]="FractionalSeconds",fn[fn.Day=7]="Day",fn))(),zn=(()=>((zn=zn||{})[zn.DayPeriods=0]="DayPeriods",zn[zn.Days=1]="Days",zn[zn.Months=2]="Months",zn[zn.Eras=3]="Eras",zn))();function wG(n,t,e,r){let s=function B8e(n){if(AG(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[s,i=1,o=1]=n.split("-").map(c=>+c);return ky(s,i-1,o)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let r;if(r=n.match(I8e))return function $8e(n){const t=new Date(0);let e=0,r=0;const s=n[8]?t.setUTCFullYear:t.setFullYear,i=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),r=Number(n[9]+n[11])),s.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-e,c=Number(n[5]||0)-r,u=Number(n[6]||0),h=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return i.call(t,o,c,u,h),t}(r)}const t=new Date(n);if(!AG(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=Ul(e,t)||t;let c,o=[];for(;t;){if(c=x8e.exec(t),!c){o.push(t);break}{o=o.concat(c.slice(1));const g=o.pop();if(!g)break;t=g}}let u=s.getTimezoneOffset();r&&(u=bG(r,u),s=function F8e(n,t,e){const r=e?-1:1,s=n.getTimezoneOffset();return function H8e(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,r*(bG(t,s)-s))}(s,r,!0));let h="";return o.forEach(g=>{const m=function V8e(n){if(nA[n])return nA[n];let t;switch(n){case"G":case"GG":case"GGG":t=pr(zn.Eras,e1.Abbreviated);break;case"GGGG":t=pr(zn.Eras,e1.Wide);break;case"GGGGG":t=pr(zn.Eras,e1.Narrow);break;case"y":t=Ws(fn.FullYear,1,0,!1,!0);break;case"yy":t=Ws(fn.FullYear,2,0,!0,!0);break;case"yyy":t=Ws(fn.FullYear,3,0,!1,!0);break;case"yyyy":t=Ws(fn.FullYear,4,0,!1,!0);break;case"Y":t=zy(1);break;case"YY":t=zy(2,!0);break;case"YYY":t=zy(3);break;case"YYYY":t=zy(4);break;case"M":case"L":t=Ws(fn.Month,1,1);break;case"MM":case"LL":t=Ws(fn.Month,2,1);break;case"MMM":t=pr(zn.Months,e1.Abbreviated);break;case"MMMM":t=pr(zn.Months,e1.Wide);break;case"MMMMM":t=pr(zn.Months,e1.Narrow);break;case"LLL":t=pr(zn.Months,e1.Abbreviated,Ts.Standalone);break;case"LLLL":t=pr(zn.Months,e1.Wide,Ts.Standalone);break;case"LLLLL":t=pr(zn.Months,e1.Narrow,Ts.Standalone);break;case"w":t=tA(1);break;case"ww":t=tA(2);break;case"W":t=tA(1,!0);break;case"d":t=Ws(fn.Date,1);break;case"dd":t=Ws(fn.Date,2);break;case"c":case"cc":t=Ws(fn.Day,1);break;case"ccc":t=pr(zn.Days,e1.Abbreviated,Ts.Standalone);break;case"cccc":t=pr(zn.Days,e1.Wide,Ts.Standalone);break;case"ccccc":t=pr(zn.Days,e1.Narrow,Ts.Standalone);break;case"cccccc":t=pr(zn.Days,e1.Short,Ts.Standalone);break;case"E":case"EE":case"EEE":t=pr(zn.Days,e1.Abbreviated);break;case"EEEE":t=pr(zn.Days,e1.Wide);break;case"EEEEE":t=pr(zn.Days,e1.Narrow);break;case"EEEEEE":t=pr(zn.Days,e1.Short);break;case"a":case"aa":case"aaa":t=pr(zn.DayPeriods,e1.Abbreviated);break;case"aaaa":t=pr(zn.DayPeriods,e1.Wide);break;case"aaaaa":t=pr(zn.DayPeriods,e1.Narrow);break;case"b":case"bb":case"bbb":t=pr(zn.DayPeriods,e1.Abbreviated,Ts.Standalone,!0);break;case"bbbb":t=pr(zn.DayPeriods,e1.Wide,Ts.Standalone,!0);break;case"bbbbb":t=pr(zn.DayPeriods,e1.Narrow,Ts.Standalone,!0);break;case"B":case"BB":case"BBB":t=pr(zn.DayPeriods,e1.Abbreviated,Ts.Format,!0);break;case"BBBB":t=pr(zn.DayPeriods,e1.Wide,Ts.Format,!0);break;case"BBBBB":t=pr(zn.DayPeriods,e1.Narrow,Ts.Format,!0);break;case"h":t=Ws(fn.Hours,1,-12);break;case"hh":t=Ws(fn.Hours,2,-12);break;case"H":t=Ws(fn.Hours,1);break;case"HH":t=Ws(fn.Hours,2);break;case"m":t=Ws(fn.Minutes,1);break;case"mm":t=Ws(fn.Minutes,2);break;case"s":t=Ws(fn.Seconds,1);break;case"ss":t=Ws(fn.Seconds,2);break;case"S":t=Ws(fn.FractionalSeconds,1);break;case"SS":t=Ws(fn.FractionalSeconds,2);break;case"SSS":t=Ws(fn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=Ry(di.Short);break;case"ZZZZZ":t=Ry(di.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=Ry(di.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=Ry(di.Long);break;default:return null}return nA[n]=t,t}(g);h+=m?m(s,e,u):"''"===g?"'":g.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),h}function ky(n,t,e){const r=new Date(0);return r.setFullYear(n,t,e),r.setHours(0,0,0),r}function Ul(n,t){const e=function C8e(n){return Lo(n)[Ct.LocaleId]}(n);if(Ip[e]=Ip[e]||{},Ip[e][t])return Ip[e][t];let r="";switch(t){case"shortDate":r=Ny(n,Qr.Short);break;case"mediumDate":r=Ny(n,Qr.Medium);break;case"longDate":r=Ny(n,Qr.Long);break;case"fullDate":r=Ny(n,Qr.Full);break;case"shortTime":r=Iy(n,Qr.Short);break;case"mediumTime":r=Iy(n,Qr.Medium);break;case"longTime":r=Iy(n,Qr.Long);break;case"fullTime":r=Iy(n,Qr.Full);break;case"short":const s=Ul(n,"shortTime"),i=Ul(n,"shortDate");r=Ly(xy(n,Qr.Short),[s,i]);break;case"medium":const o=Ul(n,"mediumTime"),c=Ul(n,"mediumDate");r=Ly(xy(n,Qr.Medium),[o,c]);break;case"long":const u=Ul(n,"longTime"),h=Ul(n,"longDate");r=Ly(xy(n,Qr.Long),[u,h]);break;case"full":const g=Ul(n,"fullTime"),m=Ul(n,"fullDate");r=Ly(xy(n,Qr.Full),[g,m])}return r&&(Ip[e][t]=r),r}function Ly(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,r){return null!=t&&r in t?t[r]:e})),n}function L3(n,t,e="-",r,s){let i="";(n<0||s&&n<=0)&&(s?n=1-n:(n=-n,i=e));let o=String(n);for(;o.length<t;)o="0"+o;return r&&(o=o.slice(o.length-t)),i+o}function Ws(n,t,e=0,r=!1,s=!1){return function(i,o){let c=function L8e(n,t){switch(n){case fn.FullYear:return t.getFullYear();case fn.Month:return t.getMonth();case fn.Date:return t.getDate();case fn.Hours:return t.getHours();case fn.Minutes:return t.getMinutes();case fn.Seconds:return t.getSeconds();case fn.FractionalSeconds:return t.getMilliseconds();case fn.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,i);if((e>0||c>-e)&&(c+=e),n===fn.Hours)0===c&&-12===e&&(c=12);else if(n===fn.FractionalSeconds)return function k8e(n,t){return L3(n,3).substring(0,t)}(c,t);const u=Ic(o,nn.MinusSign);return L3(c,t,u,r,s)}}function pr(n,t,e=Ts.Format,r=!1){return function(s,i){return function R8e(n,t,e,r,s,i){switch(e){case zn.Months:return function M8e(n,t,e){const r=Lo(n),i=xc([r[Ct.MonthsFormat],r[Ct.MonthsStandalone]],t);return xc(i,e)}(t,s,r)[n.getMonth()];case zn.Days:return function E8e(n,t,e){const r=Lo(n),i=xc([r[Ct.DaysFormat],r[Ct.DaysStandalone]],t);return xc(i,e)}(t,s,r)[n.getDay()];case zn.DayPeriods:const o=n.getHours(),c=n.getMinutes();if(i){const h=function w8e(n){const t=Lo(n);return TG(t),(t[Ct.ExtraData][2]||[]).map(r=>"string"==typeof r?eA(r):[eA(r[0]),eA(r[1])])}(t),g=function O8e(n,t,e){const r=Lo(n);TG(r);const i=xc([r[Ct.ExtraData][0],r[Ct.ExtraData][1]],t)||[];return xc(i,e)||[]}(t,s,r),m=h.findIndex(E=>{if(Array.isArray(E)){const[O,k]=E,U=o>=O.hours&&c>=O.minutes,j=o<k.hours||o===k.hours&&c<k.minutes;if(O.hours<k.hours){if(U&&j)return!0}else if(U||j)return!0}else if(E.hours===o&&E.minutes===c)return!0;return!1});if(-1!==m)return g[m]}return function y8e(n,t,e){const r=Lo(n),i=xc([r[Ct.DayPeriodsFormat],r[Ct.DayPeriodsStandalone]],t);return xc(i,e)}(t,s,r)[o<12?0:1];case zn.Eras:return function S8e(n,t){return xc(Lo(n)[Ct.Eras],t)}(t,r)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(s,i,n,t,e,r)}}function Ry(n){return function(t,e,r){const s=-1*r,i=Ic(e,nn.MinusSign),o=s>0?Math.floor(s/60):Math.ceil(s/60);switch(n){case di.Short:return(s>=0?"+":"")+L3(o,2,i)+L3(Math.abs(s%60),2,i);case di.ShortGMT:return"GMT"+(s>=0?"+":"")+L3(o,1,i);case di.Long:return"GMT"+(s>=0?"+":"")+L3(o,2,i)+":"+L3(Math.abs(s%60),2,i);case di.Extended:return 0===r?"Z":(s>=0?"+":"")+L3(o,2,i)+":"+L3(Math.abs(s%60),2,i);default:throw new Error(`Unknown zone width "${n}"`)}}}function OG(n){return ky(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function tA(n,t=!1){return function(e,r){let s;if(t){const i=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();s=1+Math.floor((o+i)/7)}else{const i=OG(e),o=function z8e(n){const t=ky(n,0,1).getDay();return ky(n,0,1+(t<=4?4:11)-t)}(i.getFullYear()),c=i.getTime()-o.getTime();s=1+Math.round(c/6048e5)}return L3(s,n,Ic(r,nn.MinusSign))}}function zy(n,t=!1){return function(e,r){return L3(OG(e).getFullYear(),n,Ic(r,nn.MinusSign),t)}}const nA={};function bG(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function AG(n){return n instanceof Date&&!isNaN(n.valueOf())}const U8e=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function oA(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}function kG(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[s,i]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(s.trim()===t)return decodeURIComponent(i)}return null}let hn=(()=>{class n{constructor(e,r,s,i){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=s,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(He(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Z1(r.item)}`);this._toggleClass(r.item,!0)}),e.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!0)):Object.keys(e).forEach(r=>this._toggleClass(r,!!e[r])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!1)):Object.keys(e).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(e,r){(e=e.trim())&&e.split(/\s+/g).forEach(s=>{r?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return n.\u0275fac=function(e){return new(e||n)(Q(by),Q(Np),Q(y2),Q(No))},n.\u0275dir=qt({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class nue{constructor(t,e,r,s){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let En=(()=>{class n{constructor(e,r,s){this._viewContainer=e,this._template=r,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((s,i,o)=>{if(null==s.previousIndex)r.createEmbeddedView(this._template,new nue(s.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===i?void 0:i);else if(null!==i){const c=r.get(i);r.move(c,o),DG(c,s)}});for(let s=0,i=r.length;s<i;s++){const c=r.get(s).context;c.index=s,c.count=i,c.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{DG(r.get(s.currentIndex),s)})}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(Q(Za),Q(Hl),Q(by))},n.\u0275dir=qt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function DG(n,t){n.context.$implicit=t.item}let Kt=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new sue,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){zG("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){zG("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(Q(Za),Q(Hl))},n.\u0275dir=qt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class sue{constructor(){this.$implicit=null,this.ngIf=null}}function zG(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Z1(t)}'.`)}let FG=(()=>{class n{constructor(e){this._locale=e}transform(e,r,s){if(!function uA(n){return!(null==n||""===n||n!=n)}(e))return null;s=s||this._locale;try{return function Y8e(n,t,e){return function sA(n,t,e,r,s,i,o=!1){let c="",u=!1;if(isFinite(n)){let h=function X8e(n){let r,s,i,o,c,t=Math.abs(n)+"",e=0;for((s=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(s<0&&(s=i),s+=+t.slice(i+1),t=t.substring(0,i)):s<0&&(s=t.length),i=0;"0"===t.charAt(i);i++);if(i===(c=t.length))r=[0],s=1;else{for(c--;"0"===t.charAt(c);)c--;for(s-=i,r=[],o=0;i<=c;i++,o++)r[o]=Number(t.charAt(i))}return s>22&&(r=r.splice(0,21),e=s-1,s=1),{digits:r,exponent:e,integerLen:s}}(n);o&&(h=function K8e(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(h));let g=t.minInt,m=t.minFrac,E=t.maxFrac;if(i){const Ee=i.match(U8e);if(null===Ee)throw new Error(`${i} is not a valid digit info`);const ne=Ee[1],ke=Ee[3],Ue=Ee[5];null!=ne&&(g=oA(ne)),null!=ke&&(m=oA(ke)),null!=Ue?E=oA(Ue):null!=ke&&m>E&&(E=m)}!function Q8e(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let r=n.digits,s=r.length-n.integerLen;const i=Math.min(Math.max(t,s),e);let o=i+n.integerLen,c=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let m=o;m<r.length;m++)r[m]=0}else{s=Math.max(0,s),n.integerLen=1,r.length=Math.max(1,o=i+1),r[0]=0;for(let m=1;m<o;m++)r[m]=0}if(c>=5)if(o-1<0){for(let m=0;m>o;m--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;s<Math.max(0,i);s++)r.push(0);let u=0!==i;const h=t+n.integerLen,g=r.reduceRight(function(m,E,O,k){return k[O]=(E+=m)<10?E:E-10,u&&(0===k[O]&&O>=h?k.pop():u=!1),E>=10?1:0},0);g&&(r.unshift(g),n.integerLen++)}(h,m,E);let O=h.digits,k=h.integerLen;const U=h.exponent;let j=[];for(u=O.every(Ee=>!Ee);k<g;k++)O.unshift(0);for(;k<0;k++)O.unshift(0);k>0?j=O.splice(k,O.length):(j=O,O=[0]);const oe=[];for(O.length>=t.lgSize&&oe.unshift(O.splice(-t.lgSize,O.length).join(""));O.length>t.gSize;)oe.unshift(O.splice(-t.gSize,O.length).join(""));O.length&&oe.unshift(O.join("")),c=oe.join(Ic(e,r)),j.length&&(c+=Ic(e,s)+j.join("")),U&&(c+=Ic(e,nn.Exponential)+"+"+U)}else c=Ic(e,nn.Infinity);return c=n<0&&!u?t.negPre+c+t.negSuf:t.posPre+c+t.posSuf,c}(n,function iA(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(";"),s=r[0],i=r[1],o=-1!==s.indexOf(".")?s.split("."):[s.substring(0,s.lastIndexOf("0")+1),s.substring(s.lastIndexOf("0")+1)],c=o[0],u=o[1]||"";e.posPre=c.substring(0,c.indexOf("#"));for(let g=0;g<u.length;g++){const m=u.charAt(g);"0"===m?e.minFrac=e.maxFrac=g+1:"#"===m?e.maxFrac=g+1:e.posSuf+=m}const h=c.split(",");if(e.gSize=h[1]?h[1].length:0,e.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,i){const g=s.length-e.posPre.length-e.posSuf.length,m=i.indexOf("#");e.negPre=i.substring(0,m).replace(/'/g,""),e.negSuf=i.slice(m+g).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function Jb(n,t){return Lo(n)[Ct.NumberFormats][t]}(t,_a.Decimal),Ic(t,nn.MinusSign)),t,nn.Group,nn.Decimal,e)}(function fA(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),s,r)}catch(i){throw function R3(n,t){return new Ne(2100,!1)}()}}}return n.\u0275fac=function(e){return new(e||n)(Q(b4,16))},n.\u0275pipe=ai({name:"number",type:n,pure:!0,standalone:!0}),n})();let Nue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({}),n})();let Lue=(()=>{class n{}return n.\u0275prov=nt({token:n,providedIn:"root",factory:()=>new Rue(ze(Gs),window)}),n})();class Rue{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function Due(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let s=r.currentNode;for(;s;){const i=s.shadowRoot;if(i){const o=i.getElementById(t)||i.querySelector(`[name="${t}"]`);if(o)return o}s=r.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,s=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],s-i[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=$G(this.window.history)||$G(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function $G(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class UG{}class pA extends class e5e extends class h8e{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function f8e(n){Ay||(Ay=n)}(new pA)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function t5e(){return Lp=Lp||document.querySelector("base"),Lp?Lp.getAttribute("href"):null}();return null==e?null:function n5e(n){Fy=Fy||document.createElement("a"),Fy.setAttribute("href",n);const t=Fy.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){Lp=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return kG(document.cookie,t)}}let Fy,Lp=null;const jG=new Dt("TRANSITION_ID"),s5e=[{provide:My,useFactory:function r5e(n,t,e){return()=>{e.get(Sy).donePromise.then(()=>{const r=A4(),s=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let i=0;i<s.length;i++)r.remove(s[i])})}},deps:[jG,Gs,fi],multi:!0}];let o5e=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const By=new Dt("EventManagerPlugins");let $y=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(s=>s.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,s){return this._findPluginFor(r).addEventListener(e,r,s)}addGlobalEventListener(e,r,s){return this._findPluginFor(r).addGlobalEventListener(e,r,s)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const s=this._plugins;for(let i=0;i<s.length;i++){const o=s[i];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(ze(By),ze(wr))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class ZG{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const s=A4().getGlobalEventTarget(this._doc,t);if(!s)throw new Error(`Unsupported event target ${s} for event ${e}`);return this.addEventListener(s,e,r)}}let YG=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),r.add(s))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),Rp=(()=>{class n extends YG{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,s){e.forEach(i=>{const o=this._doc.createElement("style");o.textContent=i,s.push(r.appendChild(o))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(KG),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,s)=>{this._addStylesToHost(e,s,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(KG))}}return n.\u0275fac=function(e){return new(e||n)(ze(Gs))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();function KG(n){A4().remove(n)}const gA={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},mA=/%COMP%/g;function Uy(n,t,e){for(let r=0;r<t.length;r++){let s=t[r];Array.isArray(s)?Uy(n,s,e):(s=s.replace(mA,n),e.push(s))}return e}function JG(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let Gy=(()=>{class n{constructor(e,r,s){this.eventManager=e,this.sharedStylesHost=r,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new _A(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case $1.Emulated:{let s=this.rendererByCompId.get(r.id);return s||(s=new h5e(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,s)),s.applyToHost(e),s}case 1:case $1.ShadowDom:return new d5e(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const s=Uy(r.id,r.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(ze($y),ze(Rp),ze(Op))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class _A{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(gA[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(tq(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&(tq(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,s){if(s){e=s+":"+e;const i=gA[s];i?t.setAttributeNS(i,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const s=gA[r];s?t.removeAttributeNS(s,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,s){s&(M2.DashCase|M2.Important)?t.style.setProperty(e,r,s&M2.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&M2.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,JG(r)):this.eventManager.addEventListener(t,e,JG(r))}}function tq(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class h5e extends _A{constructor(t,e,r,s){super(t),this.component=r;const i=Uy(s+"-"+r.id,r.styles,[]);e.addStyles(i),this.contentAttr=function l5e(n){return"_ngcontent-%COMP%".replace(mA,n)}(s+"-"+r.id),this.hostAttr=function u5e(n){return"_nghost-%COMP%".replace(mA,n)}(s+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class d5e extends _A{constructor(t,e,r,s){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=Uy(s.id,s.styles,[]);for(let o=0;o<i.length;o++){const c=document.createElement("style");c.textContent=i[o],this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let p5e=(()=>{class n extends ZG{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,s){return e.addEventListener(r,s,!1),()=>this.removeEventListener(e,r,s)}removeEventListener(e,r,s){return e.removeEventListener(r,s)}}return n.\u0275fac=function(e){return new(e||n)(ze(Gs))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const nq=["alt","control","meta","shift"],g5e={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},m5e={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let _5e=(()=>{class n extends ZG{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,s){const i=n.parseEventName(r),o=n.eventCallback(i.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>A4().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const r=e.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const i=n._normalizeKey(r.pop());let o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),nq.forEach(h=>{const g=r.indexOf(h);g>-1&&(r.splice(g,1),o+=h+".")}),o+=i,0!=r.length||0===i.length)return null;const u={};return u.domEventName=s,u.fullKey=o,u}static matchEventFullKeyCode(e,r){let s=g5e[e.key]||e.key,i="";return r.indexOf("code.")>-1&&(s=e.code,i="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),nq.forEach(o=>{o!==s&&(0,m5e[o])(e)&&(i+=o+".")}),i+=s,i===r)}static eventCallback(e,r,s){return i=>{n.matchEventFullKeyCode(i,e)&&s.runGuarded(()=>r(i))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(ze(Gs))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const sq=[{provide:bp,useValue:"browser"},{provide:$U,useValue:function v5e(){pA.makeCurrent()},multi:!0},{provide:Gs,useFactory:function y5e(){return function uw(n){dd=n}(document),document},deps:[]}],E5e=JU(c8e,"browser",sq),iq=new Dt(""),oq=[{provide:Py,useClass:class i5e{addToWindow(t){X1.getAngularTestability=(r,s=!0)=>{const i=t.findTestabilityInTree(r,s);if(null==i)throw new Error("Could not find testability for element.");return i},X1.getAllAngularTestabilities=()=>t.getAllTestabilities(),X1.getAllAngularRootElements=()=>t.getAllRootElements(),X1.frameworkStabilizers||(X1.frameworkStabilizers=[]),X1.frameworkStabilizers.push(r=>{const s=X1.getAllAngularTestabilities();let i=s.length,o=!1;const c=function(u){o=o||u,i--,0==i&&r(o)};s.forEach(function(u){u.whenStable(c)})})}findTestabilityInTree(t,e,r){return null==e?null:t.getTestability(e)??(r?A4().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:YU,useClass:Bb,deps:[wr,$b,Py]},{provide:Bb,useClass:Bb,deps:[wr,$b,Py]}],aq=[{provide:Ed,useValue:"root"},{provide:M0,useFactory:function C5e(){return new M0},deps:[]},{provide:By,useClass:p5e,multi:!0,deps:[Gs,wr,bp]},{provide:By,useClass:_5e,multi:!0,deps:[Gs]},{provide:Gy,useClass:Gy,deps:[$y,Rp,Op]},{provide:y0,useExisting:Gy},{provide:YG,useExisting:Rp},{provide:Rp,useClass:Rp,deps:[Gs]},{provide:$y,useClass:$y,deps:[By,wr]},{provide:UG,useClass:o5e,deps:[]},[]];let cq=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:Op,useValue:e.appId},{provide:jG,useExisting:Op},s5e]}}}return n.\u0275fac=function(e){return new(e||n)(ze(iq,12))},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[...aq,...oq],imports:[Nue,l8e]}),n})(),lq=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(ze(Gs))},n.\u0275prov=nt({token:n,factory:function(e){let r=null;return r=e?new e:function S5e(){return new lq(ze(Gs))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;let hq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:function(e){let r=null;return r=e?new(e||n):ze(dq),r},providedIn:"root"}),n})(),dq=(()=>{class n extends hq{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case Q1.NONE:return r;case Q1.HTML:return Oo(r,"HTML")?wo(r):_d(this._doc,String(r)).toString();case Q1.STYLE:return Oo(r,"Style")?wo(r):r;case Q1.SCRIPT:if(Oo(r,"Script"))return wo(r);throw new Error("unsafe value used in a script context");case Q1.URL:return Oo(r,"URL")?wo(r):ha(String(r));case Q1.RESOURCE_URL:if(Oo(r,"ResourceURL"))return wo(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function wv(n){return new dw(n)}(e)}bypassSecurityTrustStyle(e){return function Ov(n){return new pw(n)}(e)}bypassSecurityTrustScript(e){return function mw(n){return new gw(n)}(e)}bypassSecurityTrustUrl(e){return function _w(n){return new Sv(n)}(e)}bypassSecurityTrustResourceUrl(e){return function vw(n){return new Pv(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(ze(Gs))},n.\u0275prov=nt({token:n,factory:function(e){let r=null;return r=e?new e:function N5e(n){return new dq(n.get(Gs))}(ze(fi)),r},providedIn:"root"}),n})();const{isArray:I5e}=Array,{getPrototypeOf:x5e,prototype:k5e,keys:L5e}=Object;function pq(n){if(1===n.length){const t=n[0];if(I5e(t))return{args:t,keys:null};if(function R5e(n){return n&&"object"==typeof n&&x5e(n)===k5e}(t)){const e=L5e(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}const{isArray:D5e}=Array;function gq(n){return Cn(t=>function z5e(n,t){return D5e(t)?n(...t):n(t)}(n,t))}function mq(n,t){return n.reduce((e,r,s)=>(e[r]=t[s],e),{})}let _q=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(Q(No),Q(y2))},n.\u0275dir=qt({type:n}),n})(),Vu=(()=>{class n extends _q{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,features:[l]}),n})();const N4=new Dt("NgValueAccessor"),H5e={provide:N4,useExisting:w1(()=>yA),multi:!0};let yA=(()=>{class n extends Vu{writeValue(e){this.setProperty("checked",e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.checked)})("blur",function(){return r.onTouched()})},features:[Fr([H5e]),l]}),n})();const F5e={provide:N4,useExisting:w1(()=>I4),multi:!0},$5e=new Dt("CompositionEventMode");let I4=(()=>{class n extends _q{constructor(e,r,s){super(e,r),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function B5e(){const n=A4()?A4().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(No),Q(y2),Q($5e,8))},n.\u0275dir=qt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&ee("input",function(i){return r._handleInput(i.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(i){return r._compositionEnd(i.target.value)})},features:[Fr([F5e]),l]}),n})();function L0(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function vq(n){return null!=n&&"number"==typeof n.length}const to=new Dt("NgValidators"),R0=new Dt("NgAsyncValidators"),G5e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Dp{static min(t){return function Cq(n){return t=>{if(L0(t.value)||L0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function yq(n){return t=>{if(L0(t.value)||L0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return Eq(t)}static requiredTrue(t){return function Mq(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function Sq(n){return L0(n.value)||G5e.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function Pq(n){return t=>L0(t.value)||!vq(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return Tq(t)}static pattern(t){return function wq(n){if(!n)return qy;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),r=>{if(L0(r.value))return null;const s=r.value;return t.test(s)?null:{pattern:{requiredPattern:e,actualValue:s}}}}(t)}static nullValidator(t){return null}static compose(t){return xq(t)}static composeAsync(t){return kq(t)}}function Eq(n){return L0(n.value)?{required:!0}:null}function Tq(n){return t=>vq(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}function qy(n){return null}function Oq(n){return null!=n}function bq(n){return _p(n)?ls(n):n}function Aq(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function Nq(n,t){return t.map(e=>e(n))}function Iq(n){return n.map(t=>function q5e(n){return!n.validate}(t)?t:e=>t.validate(e))}function xq(n){if(!n)return null;const t=n.filter(Oq);return 0==t.length?null:function(e){return Aq(Nq(e,t))}}function EA(n){return null!=n?xq(Iq(n)):null}function kq(n){if(!n)return null;const t=n.filter(Oq);return 0==t.length?null:function(e){return function V5e(...n){const t=tn(n),{args:e,keys:r}=pq(n),s=new Mr(i=>{const{length:o}=e;if(!o)return void i.complete();const c=new Array(o);let u=o,h=o;for(let g=0;g<o;g++){let m=!1;Eo(e[g]).subscribe(cs(i,E=>{m||(m=!0,h--),c[g]=E},()=>u--,void 0,()=>{(!u||!m)&&(h||i.next(r?mq(r,c):c),i.complete())}))}});return t?s.pipe(gq(t)):s}(Nq(e,t).map(bq)).pipe(Cn(Aq))}}function MA(n){return null!=n?kq(Iq(n)):null}function Lq(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function Rq(n){return n._rawValidators}function Dq(n){return n._rawAsyncValidators}function SA(n){return n?Array.isArray(n)?n:[n]:[]}function Wy(n,t){return Array.isArray(n)?n.includes(t):n===t}function zq(n,t){const e=SA(t);return SA(n).forEach(s=>{Wy(e,s)||e.push(s)}),e}function Vq(n,t){return SA(t).filter(e=>!Wy(n,e))}class Hq{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=EA(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=MA(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Do extends Hq{get formDirective(){return null}get path(){return null}}class D0 extends Hq{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Fq{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Gl=(()=>{class n extends Fq{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(D0,2))},n.\u0275dir=qt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&hy("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[l]}),n})(),Hu=(()=>{class n extends Fq{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(Do,10))},n.\u0275dir=qt({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,r){2&e&&hy("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[l]}),n})();const zp="VALID",Zy="INVALID",xf="PENDING",Vp="DISABLED";function OA(n){return(Yy(n)?n.validators:n)||null}function $q(n){return Array.isArray(n)?EA(n):n||null}function bA(n,t){return(Yy(t)?t.asyncValidators:n)||null}function Uq(n){return Array.isArray(n)?MA(n):n||null}function Yy(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function Gq(n,t,e){const r=n.controls;if(!(t?Object.keys(r):r).length)throw new Ne(1e3,"");if(!r[e])throw new Ne(1001,"")}function qq(n,t,e){n._forEachChild((r,s)=>{if(void 0===e[s])throw new Ne(1002,"")})}class Ky{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=$q(this._rawValidators),this._composedAsyncValidatorFn=Uq(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===zp}get invalid(){return this.status===Zy}get pending(){return this.status==xf}get disabled(){return this.status===Vp}get enabled(){return this.status!==Vp}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=$q(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=Uq(t)}addValidators(t){this.setValidators(zq(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(zq(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(Vq(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(Vq(t,this._rawAsyncValidators))}hasValidator(t){return Wy(this._rawValidators,t)}hasAsyncValidator(t){return Wy(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=xf,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Vp,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=zp,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===zp||this.status===xf)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Vp:zp}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=xf,this._hasOwnPendingAsyncValidator=!0;const e=bq(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,s)=>r&&r._find(s),this)}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new dr,this.statusChanges=new dr}_calculateStatus(){return this._allControlsDisabled()?Vp:this.errors?Zy:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(xf)?xf:this._anyControlsHaveStatus(Zy)?Zy:zp}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Yy(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}}class z0 extends Ky{constructor(t,e,r){super(OA(e),bA(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){qq(this,0,t),Object.keys(t).forEach(r=>{Gq(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{const s=this.controls[r];s&&s.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,s)=>((r.enabled||this.disabled)&&(e[s]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((s,i)=>{r=e(r,s,i)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class Wq extends z0{}function Xy(n,t){return[...t.path,n]}function Hp(n,t){AA(n,t),t.valueAccessor.writeValue(n.value),n.disabled&&t.valueAccessor.setDisabledState?.(!0),function J5e(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&jq(n,t)})}(n,t),function t7e(n,t){const e=(r,s)=>{t.valueAccessor.writeValue(r),s&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function e7e(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&jq(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function Q5e(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function Qy(n,t,e=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),eE(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Jy(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function AA(n,t){const e=Rq(n);null!==t.validator?n.setValidators(Lq(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=Dq(n);null!==t.asyncValidator?n.setAsyncValidators(Lq(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const s=()=>n.updateValueAndValidity();Jy(t._rawValidators,s),Jy(t._rawAsyncValidators,s)}function eE(n,t){let e=!1;if(null!==n){if(null!==t.validator){const s=Rq(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.validator);i.length!==s.length&&(e=!0,n.setValidators(i))}}if(null!==t.asyncValidator){const s=Dq(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.asyncValidator);i.length!==s.length&&(e=!0,n.setAsyncValidators(i))}}}const r=()=>{};return Jy(t._rawValidators,r),Jy(t._rawAsyncValidators,r),e}function jq(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Zq(n,t){AA(n,t)}function NA(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function Kq(n,t){n._syncPendingControls(),t.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function IA(n,t){if(!t)return null;let e,r,s;return Array.isArray(t),t.forEach(i=>{i.constructor===I4?e=i:function s7e(n){return Object.getPrototypeOf(n.constructor)===Vu}(i)?r=i:s=i}),s||r||e||null}const o7e={provide:Do,useExisting:w1(()=>Bp)},Fp=(()=>Promise.resolve())();let Bp=(()=>{class n extends Do{constructor(e,r){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new dr,this.form=new z0({},EA(e),MA(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Fp.then(()=>{const r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),Hp(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Fp.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Fp.then(()=>{const r=this._findContainer(e.path),s=new z0({});Zq(s,e),r.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Fp.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){Fp.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,Kq(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(Q(to,10),Q(R0,10))},n.\u0275dir=qt({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,r){1&e&&ee("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Fr([o7e]),l]}),n})();function Xq(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function Qq(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const Ya=class extends Ky{constructor(t=null,e,r){super(OA(e),bA(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Yy(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=Qq(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){Xq(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){Xq(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){Qq(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},l7e={provide:D0,useExisting:w1(()=>$p)},tW=(()=>Promise.resolve())();let $p=(()=>{class n extends D0{constructor(e,r,s,i,o){super(),this._changeDetectorRef=o,this.control=new Ya,this._registered=!1,this.update=new dr,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=IA(0,i)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),NA(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Hp(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){tW.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,s=0!==r&&Bl(r);tW.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Xy(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(Q(Do,9),Q(to,10),Q(R0,10),Q(N4,10),Q(Ru,8))},n.\u0275dir=qt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Fr([l7e]),l,h2]}),n})(),Fu=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=qt({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),rW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({}),n})();const d7e={provide:N4,useExisting:w1(()=>tE),multi:!0};let tE=(()=>{class n extends Vu{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.value)})("input",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},features:[Fr([d7e]),l]}),n})();const xA=new Dt("NgModelWithFormControlWarning"),p7e={provide:D0,useExisting:w1(()=>kA)};let kA=(()=>{class n extends D0{constructor(e,r,s,i){super(),this._ngModelWarningConfig=i,this.update=new dr,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(r),this.valueAccessor=IA(0,s)}set isDisabled(e){}ngOnChanges(e){if(this._isControlChanged(e)){const r=e.form.previousValue;r&&Qy(r,this,!1),Hp(this.form,this),this.form.updateValueAndValidity({emitEvent:!1})}NA(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Qy(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(Q(to,10),Q(R0,10),Q(N4,10),Q(xA,8))},n.\u0275dir=qt({type:n,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Fr([p7e]),l,h2]}),n})();const g7e={provide:Do,useExisting:w1(()=>Bu)};let Bu=(()=>{class n extends Do{constructor(e,r){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new dr,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(eE(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return Hp(r,e),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){Qy(e.control||null,e,!1),function i7e(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,Kq(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,s=this.form.get(e.path);r!==s&&(Qy(r||null,e),(n=>n instanceof Ya)(s)&&(Hp(s,e),e.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);Zq(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function n7e(n,t){return eE(n,t)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){AA(this.form,this),this._oldForm&&eE(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(Q(to,10),Q(R0,10))},n.\u0275dir=qt({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&ee("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Fr([g7e]),l,h2]}),n})();const v7e={provide:D0,useExisting:w1(()=>kf)};let kf=(()=>{class n extends D0{constructor(e,r,s,i,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new dr,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=IA(0,i)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),NA(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Xy(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(Q(Do,13),Q(to,10),Q(R0,10),Q(N4,10),Q(xA,8))},n.\u0275dir=qt({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Fr([v7e]),l,h2]}),n})();const C7e={provide:N4,useExisting:w1(()=>nE),multi:!0};function oW(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let nE=(()=>{class n extends Vu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const s=oW(this._getOptionId(e),e);this.setProperty("value",s)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function y7e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Fr([C7e]),l]}),n})(),Up=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(oW(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Q(y2),Q(No),Q(nE,9))},n.\u0275dir=qt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const E7e={provide:N4,useExisting:w1(()=>DA),multi:!0};function aW(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let DA=(()=>{class n extends Vu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let r;if(this.value=e,Array.isArray(e)){const s=e.map(i=>this._getOptionId(i));r=(i,o)=>{i._setSelected(s.indexOf(o.toString())>-1)}}else r=(s,i)=>{s._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const s=[],i=r.selectedOptions;if(void 0!==i){const o=i;for(let c=0;c<o.length;c++){const h=this._getOptionValue(o[c].value);s.push(h)}}else{const o=r.options;for(let c=0;c<o.length;c++){const u=o[c];if(u.selected){const h=this._getOptionValue(u.value);s.push(h)}}}this.value=s,e(s)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function M7e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Fr([E7e]),l]}),n})(),Gp=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(aW(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(aW(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Q(y2),Q(No),Q(DA,9))},n.\u0275dir=qt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();let $u=(()=>{class n{constructor(){this._validator=qy}ngOnChanges(e){if(this.inputName in e){const r=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):qy,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=qt({type:n,features:[h2]}),n})();const T7e={provide:to,useExisting:w1(()=>Uu),multi:!0};let Uu=(()=>{class n extends $u{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Bl,this.createValidator=e=>Eq}enabled(e){return e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,r){2&e&&z("required",r._enabled?"":null)},inputs:{required:"required"},features:[Fr([T7e]),l]}),n})();const A7e={provide:to,useExisting:w1(()=>zA),multi:!0};let zA=(()=>{class n extends $u{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>function cW(n){return"number"==typeof n?n:parseInt(n,10)}(e),this.createValidator=e=>Tq(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,r){2&e&&z("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Fr([A7e]),l]}),n})(),mW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({imports:[rW]}),n})(),I7e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({imports:[mW]}),n})(),_W=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:xA,useValue:e.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({imports:[mW]}),n})();class vW extends Ky{constructor(t,e,r){super(OA(e),bA(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){let s=this._adjustIndex(t);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),e&&(this.controls.splice(s,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){qq(this,0,t),t.forEach((r,s)=>{Gq(this,!1,s),this.at(s).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((r,s)=>{this.at(s)&&this.at(s).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function CW(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let x7e=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new n;return e.useNonNullable=!0,e}group(e,r=null){const s=this._reduceControls(e);let i={};return CW(r)?i=r:null!==r&&(i.validators=r.validator,i.asyncValidators=r.asyncValidator),new z0(s,i)}record(e,r=null){const s=this._reduceControls(e);return new Wq(s,r)}control(e,r,s){let i={};return this.useNonNullable?(CW(r)?i=r:(i.validators=r,i.asyncValidators=s),new Ya(e,{...i,nonNullable:!0})):new Ya(e,r,s)}array(e,r,s){const i=e.map(o=>this._createControl(o));return new vW(i,r,s)}_reduceControls(e){const r={};return Object.keys(e).forEach(s=>{r[s]=this._createControl(e[s])}),r}_createControl(e){return e instanceof Ya||e instanceof Ky?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:_W}),n})();function Xt(...n){return ls(n,r4(n))}function V0(n,t){return ln(t)?Ve(n,t,1):Ve(n,1)}function ql(n,t){return hr((e,r)=>{let s=0;e.subscribe(cs(r,i=>n.call(t,i,s++)&&r.next(i)))})}class yW{}class EW{}class Wl{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const s=e.slice(0,r),i=s.toLowerCase(),o=e.slice(r+1).trim();this.maybeSetNormalizedName(s,i),this.headers.has(i)?this.headers.get(i).push(o):this.headers.set(i,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const s=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(s,r),this.maybeSetNormalizedName(e,s))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Wl?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Wl;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Wl?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const s=("a"===t.op?this.headers.get(e):void 0)||[];s.push(...r),this.headers.set(e,s);break;case"d":const i=t.value;if(i){let o=this.headers.get(e);if(!o)return;o=o.filter(c=>-1===i.indexOf(c)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class k7e{encodeKey(t){return MW(t)}encodeValue(t){return MW(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const R7e=/%(\d[a-f0-9])/gi,D7e={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function MW(n){return encodeURIComponent(n).replace(R7e,(t,e)=>D7e[e]??t)}function rE(n){return`${n}`}class H0{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new k7e,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function L7e(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(s=>{const i=s.indexOf("="),[o,c]=-1==i?[t.decodeKey(s),""]:[t.decodeKey(s.slice(0,i)),t.decodeValue(s.slice(i+1))],u=e.get(o)||[];u.push(c),e.set(o,u)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e],s=Array.isArray(r)?r.map(rE):[rE(r)];this.map.set(e,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const s=t[r];Array.isArray(s)?s.forEach(i=>{e.push({param:r,value:i,op:"a"})}):e.push({param:r,value:s,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new H0({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(rE(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const s=r.indexOf(rE(t.value));-1!==s&&r.splice(s,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class z7e{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function SW(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function PW(n){return typeof Blob<"u"&&n instanceof Blob}function TW(n){return typeof FormData<"u"&&n instanceof FormData}class qp{constructor(t,e,r,s){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function V7e(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==r?r:null,i=s):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new Wl),this.context||(this.context=new z7e),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const c=e.indexOf("?");this.urlWithParams=e+(-1===c?"?":c<e.length-1?"&":"")+o}}else this.params=new H0,this.urlWithParams=e}serializeBody(){return null===this.body?null:SW(this.body)||PW(this.body)||TW(this.body)||function H7e(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof H0?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||TW(this.body)?null:PW(this.body)?this.body.type||null:SW(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof H0?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,r=t.url||this.url,s=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,c=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let u=t.headers||this.headers,h=t.params||this.params;const g=t.context??this.context;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((m,E)=>m.set(E,t.setHeaders[E]),u)),t.setParams&&(h=Object.keys(t.setParams).reduce((m,E)=>m.set(E,t.setParams[E]),h)),new qp(e,r,i,{params:h,headers:u,context:g,reportProgress:c,responseType:s,withCredentials:o})}}var js=(()=>((js=js||{})[js.Sent=0]="Sent",js[js.UploadProgress=1]="UploadProgress",js[js.ResponseHeader=2]="ResponseHeader",js[js.DownloadProgress=3]="DownloadProgress",js[js.Response=4]="Response",js[js.User=5]="User",js))();class VA{constructor(t,e=200,r="OK"){this.headers=t.headers||new Wl,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class HA extends VA{constructor(t={}){super(t),this.type=js.ResponseHeader}clone(t={}){return new HA({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class sE extends VA{constructor(t={}){super(t),this.type=js.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new sE({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class wW extends VA{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function FA(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let F7e=(()=>{class n{constructor(e){this.handler=e}request(e,r,s={}){let i;if(e instanceof qp)i=e;else{let u,h;u=s.headers instanceof Wl?s.headers:new Wl(s.headers),s.params&&(h=s.params instanceof H0?s.params:new H0({fromObject:s.params})),i=new qp(e,r,void 0!==s.body?s.body:null,{headers:u,context:s.context,params:h,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const o=Xt(i).pipe(V0(u=>this.handler.handle(u)));if(e instanceof qp||"events"===s.observe)return o;const c=o.pipe(ql(u=>u instanceof sE));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return c.pipe(Cn(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return c.pipe(Cn(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return c.pipe(Cn(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return c.pipe(Cn(u=>u.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new H0).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,s={}){return this.request("PATCH",e,FA(s,r))}post(e,r,s={}){return this.request("POST",e,FA(s,r))}put(e,r,s={}){return this.request("PUT",e,FA(s,r))}}return n.\u0275fac=function(e){return new(e||n)(ze(yW))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class OW{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const bW=new Dt("HTTP_INTERCEPTORS");let B7e=(()=>{class n{intercept(e,r){return r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const $7e=/^\)\]\}',?\n/;let AW=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Mr(r=>{const s=this.xhrFactory.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((O,k)=>s.setRequestHeader(O,k.join(","))),e.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const O=e.detectContentTypeHeader();null!==O&&s.setRequestHeader("Content-Type",O)}if(e.responseType){const O=e.responseType.toLowerCase();s.responseType="json"!==O?O:"text"}const i=e.serializeBody();let o=null;const c=()=>{if(null!==o)return o;const O=s.statusText||"OK",k=new Wl(s.getAllResponseHeaders()),U=function U7e(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(s)||e.url;return o=new HA({headers:k,status:s.status,statusText:O,url:U}),o},u=()=>{let{headers:O,status:k,statusText:U,url:j}=c(),oe=null;204!==k&&(oe=typeof s.response>"u"?s.responseText:s.response),0===k&&(k=oe?200:0);let Ee=k>=200&&k<300;if("json"===e.responseType&&"string"==typeof oe){const ne=oe;oe=oe.replace($7e,"");try{oe=""!==oe?JSON.parse(oe):null}catch(ke){oe=ne,Ee&&(Ee=!1,oe={error:ke,text:oe})}}Ee?(r.next(new sE({body:oe,headers:O,status:k,statusText:U,url:j||void 0})),r.complete()):r.error(new wW({error:oe,headers:O,status:k,statusText:U,url:j||void 0}))},h=O=>{const{url:k}=c(),U=new wW({error:O,status:s.status||0,statusText:s.statusText||"Unknown Error",url:k||void 0});r.error(U)};let g=!1;const m=O=>{g||(r.next(c()),g=!0);let k={type:js.DownloadProgress,loaded:O.loaded};O.lengthComputable&&(k.total=O.total),"text"===e.responseType&&!!s.responseText&&(k.partialText=s.responseText),r.next(k)},E=O=>{let k={type:js.UploadProgress,loaded:O.loaded};O.lengthComputable&&(k.total=O.total),r.next(k)};return s.addEventListener("load",u),s.addEventListener("error",h),s.addEventListener("timeout",h),s.addEventListener("abort",h),e.reportProgress&&(s.addEventListener("progress",m),null!==i&&s.upload&&s.upload.addEventListener("progress",E)),s.send(i),r.next({type:js.Sent}),()=>{s.removeEventListener("error",h),s.removeEventListener("abort",h),s.removeEventListener("load",u),s.removeEventListener("timeout",h),e.reportProgress&&(s.removeEventListener("progress",m),null!==i&&s.upload&&s.upload.removeEventListener("progress",E)),s.readyState!==s.DONE&&s.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(ze(UG))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const BA=new Dt("XSRF_COOKIE_NAME"),$A=new Dt("XSRF_HEADER_NAME");class NW{}let G7e=(()=>{class n{constructor(e,r,s){this.doc=e,this.platform=r,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=kG(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(ze(Gs),ze(bp),ze(BA))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),UA=(()=>{class n{constructor(e,r){this.tokenService=e,this.headerName=r}intercept(e,r){const s=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||s.startsWith("http://")||s.startsWith("https://"))return r.handle(e);const i=this.tokenService.getToken();return null!==i&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,i)})),r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(ze(NW),ze($A))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),q7e=(()=>{class n{constructor(e,r){this.backend=e,this.injector=r,this.chain=null}handle(e){if(null===this.chain){const r=this.injector.get(bW,[]);this.chain=r.reduceRight((s,i)=>new OW(s,i),this.backend)}return this.chain.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(ze(EW),ze(fi))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),W7e=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:UA,useClass:B7e}]}}static withOptions(e={}){return{ngModule:n,providers:[e.cookieName?{provide:BA,useValue:e.cookieName}:[],e.headerName?{provide:$A,useValue:e.headerName}:[]]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[UA,{provide:bW,useExisting:UA,multi:!0},{provide:NW,useClass:G7e},{provide:BA,useValue:"XSRF-TOKEN"},{provide:$A,useValue:"X-XSRF-TOKEN"}]}),n})(),j7e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[F7e,{provide:yW,useClass:q7e},AW,{provide:EW,useExisting:AW}],imports:[W7e.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();class D3 extends W2{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}const iE=as(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function IW(...n){const t=r4(n),e=tn(n),{args:r,keys:s}=pq(n);if(0===r.length)return ls([],t);const i=new Mr(function Z7e(n,t,e=ll){return r=>{xW(t,()=>{const{length:s}=n,i=new Array(s);let o=s,c=s;for(let u=0;u<s;u++)xW(t,()=>{const h=ls(n[u],t);let g=!1;h.subscribe(cs(r,m=>{i[u]=m,g||(g=!0,c--),c||r.next(e(i.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,t,s?o=>mq(s,o):ll));return e?i.pipe(gq(e)):i}function xW(n,t,e){n?Bs(e,n,t):t()}function GA(...n){return function Y7e(){return hl(1)}()(ls(n,r4(n)))}function kW(n){return new Mr(t=>{Eo(n()).subscribe(t)})}function Wp(n,t){const e=ln(n)?n:()=>n,r=s=>s.error(e());return new Mr(t?s=>t.schedule(r,0,s):r)}function qA(){return hr((n,t)=>{let e=null;n._refCount++;const r=cs(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const s=n._connection,i=e;e=null,s&&(!i||s===i)&&s.unsubscribe(),t.unsubscribe()});n.subscribe(r),r.closed||(e=n.connect())})}class LW extends Mr{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,S_(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new k1;const e=this.getSubject();t.add(this.source.subscribe(cs(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=k1.EMPTY)}return t}refCount(){return qA()(this)}}function x4(n,t){return hr((e,r)=>{let s=null,i=0,o=!1;const c=()=>o&&!s&&r.complete();e.subscribe(cs(r,u=>{s?.unsubscribe();let h=0;const g=i++;Eo(n(u,g)).subscribe(s=cs(r,m=>r.next(t?t(u,m,g,h++):m),()=>{s=null,c()}))},()=>{o=!0,c()}))})}function jp(n){return n<=0?()=>Ec:hr((t,e)=>{let r=0;t.subscribe(cs(e,s=>{++r<=n&&(e.next(s),n<=r&&e.complete())}))})}function oE(n){return hr((t,e)=>{let r=!1;t.subscribe(cs(e,s=>{r=!0,e.next(s)},()=>{r||e.next(n),e.complete()}))})}function RW(n=X7e){return hr((t,e)=>{let r=!1;t.subscribe(cs(e,s=>{r=!0,e.next(s)},()=>r?e.complete():e.error(n())))})}function X7e(){return new iE}function F0(n,t){const e=arguments.length>=2;return r=>r.pipe(n?ql((s,i)=>n(s,i,r)):ll,jp(1),e?oE(t):RW(()=>new iE))}function w2(n,t,e){const r=ln(n)||t||e?{next:n,error:t,complete:e}:n;return r?hr((s,i)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let c=!0;s.subscribe(cs(i,u=>{var h;null===(h=r.next)||void 0===h||h.call(r,u),i.next(u)},()=>{var u;c=!1,null===(u=r.complete)||void 0===u||u.call(r),i.complete()},u=>{var h;c=!1,null===(h=r.error)||void 0===h||h.call(r,u),i.error(u)},()=>{var u,h;c&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(h=r.finalize)||void 0===h||h.call(r)}))}):ll}function B0(n){return hr((t,e)=>{let i,r=null,s=!1;r=t.subscribe(cs(e,void 0,void 0,o=>{i=Eo(n(o,B0(n)(t))),r?(r.unsubscribe(),r=null,i.subscribe(e)):s=!0})),s&&(r.unsubscribe(),r=null,i.subscribe(e))})}function Q7e(n,t,e,r,s){return(i,o)=>{let c=e,u=t,h=0;i.subscribe(cs(o,g=>{const m=h++;u=c?n(u,g,m):(c=!0,g),r&&o.next(u)},s&&(()=>{c&&o.next(u),o.complete()})))}}function DW(n,t){return hr(Q7e(n,t,arguments.length>=2,!0))}function WA(n){return n<=0?()=>Ec:hr((t,e)=>{let r=[];t.subscribe(cs(e,s=>{r.push(s),n<r.length&&r.shift()},()=>{for(const s of r)e.next(s);e.complete()},void 0,()=>{r=null}))})}function zW(n,t){const e=arguments.length>=2;return r=>r.pipe(n?ql((s,i)=>n(s,i,r)):ll,WA(1),e?oE(t):RW(()=>new iE))}function jA(n){return hr((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const Wn="primary",Zp=Symbol("RouteTitle");class tfe{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Lf(n){return new tfe(n)}function nfe(n,t,e){const r=e.path.split("/");if(r.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||r.length<n.length))return null;const s={};for(let i=0;i<r.length;i++){const o=r[i],c=n[i];if(o.startsWith(":"))s[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:s}}function k4(n,t){const e=n?Object.keys(n):void 0,r=t?Object.keys(t):void 0;if(!e||!r||e.length!=r.length)return!1;let s;for(let i=0;i<e.length;i++)if(s=e[i],!VW(n[s],t[s]))return!1;return!0}function VW(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),r=[...t].sort();return e.every((s,i)=>r[i]===s)}return n===t}function HW(n){return Array.prototype.concat.apply([],n)}function FW(n){return n.length>0?n[n.length-1]:null}function O2(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function $0(n){return ub(n)?n:_p(n)?ls(Promise.resolve(n)):Xt(n)}const ife={exact:function UW(n,t,e){if(!qu(n.segments,t.segments)||!aE(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!n.children[r]||!UW(n.children[r],t.children[r],e))return!1;return!0},subset:GW},BW={exact:function ofe(n,t){return k4(n,t)},subset:function afe(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>VW(n[e],t[e]))},ignored:()=>!0};function $W(n,t,e){return ife[e.paths](n.root,t.root,e.matrixParams)&&BW[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function GW(n,t,e){return qW(n,t,t.segments,e)}function qW(n,t,e,r){if(n.segments.length>e.length){const s=n.segments.slice(0,e.length);return!(!qu(s,e)||t.hasChildren()||!aE(s,e,r))}if(n.segments.length===e.length){if(!qu(n.segments,e)||!aE(n.segments,e,r))return!1;for(const s in t.children)if(!n.children[s]||!GW(n.children[s],t.children[s],r))return!1;return!0}{const s=e.slice(0,n.segments.length),i=e.slice(n.segments.length);return!!(qu(n.segments,s)&&aE(n.segments,s,r)&&n.children[Wn])&&qW(n.children[Wn],t,i,r)}}function aE(n,t,e){return t.every((r,s)=>BW[e](n[s].parameters,r.parameters))}class Gu{constructor(t,e,r){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Lf(this.queryParams)),this._queryParamMap}toString(){return ufe.serialize(this)}}class Kn{constructor(t,e){this.segments=t,this.children=e,this.parent=null,O2(e,(r,s)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return cE(this)}}class Yp{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Lf(this.parameters)),this._parameterMap}toString(){return YW(this)}}function qu(n,t){return n.length===t.length&&n.every((e,r)=>e.path===t[r].path)}let WW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:function(){return new YA},providedIn:"root"}),n})();class YA{parse(t){const e=new Cfe(t);return new Gu(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${Kp(t.root,!0)}`,r=function dfe(n){const t=Object.keys(n).map(e=>{const r=n[e];return Array.isArray(r)?r.map(s=>`${lE(e)}=${lE(s)}`).join("&"):`${lE(e)}=${lE(r)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${r}${"string"==typeof t.fragment?`#${function ffe(n){return encodeURI(n)}(t.fragment)}`:""}`}}const ufe=new YA;function cE(n){return n.segments.map(t=>YW(t)).join("/")}function Kp(n,t){if(!n.hasChildren())return cE(n);if(t){const e=n.children[Wn]?Kp(n.children[Wn],!1):"",r=[];return O2(n.children,(s,i)=>{i!==Wn&&r.push(`${i}:${Kp(s,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function lfe(n,t){let e=[];return O2(n.children,(r,s)=>{s===Wn&&(e=e.concat(t(r,s)))}),O2(n.children,(r,s)=>{s!==Wn&&(e=e.concat(t(r,s)))}),e}(n,(r,s)=>s===Wn?[Kp(n.children[Wn],!1)]:[`${s}:${Kp(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Wn]?`${cE(n)}/${e[0]}`:`${cE(n)}/(${e.join("//")})`}}function jW(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function lE(n){return jW(n).replace(/%3B/gi,";")}function KA(n){return jW(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function uE(n){return decodeURIComponent(n)}function ZW(n){return uE(n.replace(/\+/g,"%20"))}function YW(n){return`${KA(n.path)}${function hfe(n){return Object.keys(n).map(t=>`;${KA(t)}=${KA(n[t])}`).join("")}(n.parameters)}`}const pfe=/^[^\/()?;=#]+/;function fE(n){const t=n.match(pfe);return t?t[0]:""}const gfe=/^[^=?&#]+/,_fe=/^[^&#]+/;class Cfe{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Kn([],{}):new Kn([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[Wn]=new Kn(t,e)),r}parseSegment(){const t=fE(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Ne(4009,!1);return this.capture(t),new Yp(uE(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=fE(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const s=fE(this.remaining);s&&(r=s,this.capture(r))}t[uE(e)]=uE(r)}parseQueryParam(t){const e=function mfe(n){const t=n.match(gfe);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const o=function vfe(n){const t=n.match(_fe);return t?t[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const s=ZW(e),i=ZW(r);if(t.hasOwnProperty(s)){let o=t[s];Array.isArray(o)||(o=[o],t[s]=o),o.push(i)}else t[s]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=fE(this.remaining),s=this.remaining[r.length];if("/"!==s&&")"!==s&&";"!==s)throw new Ne(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=Wn);const o=this.parseChildren();e[i]=1===Object.keys(o).length?o[Wn]:new Kn([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Ne(4011,!1)}}function XA(n){return n.segments.length>0?new Kn([],{[Wn]:n}):n}function hE(n){const t={};for(const r of Object.keys(n.children)){const i=hE(n.children[r]);(i.segments.length>0||i.hasChildren())&&(t[r]=i)}return function yfe(n){if(1===n.numberOfChildren&&n.children[Wn]){const t=n.children[Wn];return new Kn(n.segments.concat(t.segments),t.children)}return n}(new Kn(n.segments,t))}function Wu(n){return n instanceof Gu}function Sfe(n,t,e,r,s){if(0===e.length)return Rf(t.root,t.root,t.root,r,s);const i=function QW(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new XW(!0,0,n);let t=0,e=!1;const r=n.reduce((s,i,o)=>{if("object"==typeof i&&null!=i){if(i.outlets){const c={};return O2(i.outlets,(u,h)=>{c[h]="string"==typeof u?u.split("/"):u}),[...s,{outlets:c}]}if(i.segmentPath)return[...s,i.segmentPath]}return"string"!=typeof i?[...s,i]:0===o?(i.split("/").forEach((c,u)=>{0==u&&"."===c||(0==u&&""===c?e=!0:".."===c?t++:""!=c&&s.push(c))}),s):[...s,i]},[]);return new XW(e,t,r)}(e);return i.toRoot()?Rf(t.root,t.root,new Kn([],{}),r,s):function o(u){const h=function Tfe(n,t,e,r){if(n.isAbsolute)return new Df(t.root,!0,0);if(-1===r)return new Df(e,e===t.root,0);return function JW(n,t,e){let r=n,s=t,i=e;for(;i>s;){if(i-=s,r=r.parent,!r)throw new Ne(4005,!1);s=r.segments.length}return new Df(r,!1,s-i)}(e,r+(Xp(n.commands[0])?0:1),n.numberOfDoubleDots)}(i,t,n.snapshot?._urlSegment,u),g=h.processChildren?Jp(h.segmentGroup,h.index,i.commands):JA(h.segmentGroup,h.index,i.commands);return Rf(t.root,h.segmentGroup,g,r,s)}(n.snapshot?._lastPathIndex)}function Xp(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Qp(n){return"object"==typeof n&&null!=n&&n.outlets}function Rf(n,t,e,r,s){let o,i={};r&&O2(r,(u,h)=>{i[h]=Array.isArray(u)?u.map(g=>`${g}`):`${u}`}),o=n===t?e:KW(n,t,e);const c=XA(hE(o));return new Gu(c,i,s)}function KW(n,t,e){const r={};return O2(n.children,(s,i)=>{r[i]=s===t?e:KW(s,t,e)}),new Kn(n.segments,r)}class XW{constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&Xp(r[0]))throw new Ne(4003,!1);const s=r.find(Qp);if(s&&s!==FW(r))throw new Ne(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Df{constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}}function JA(n,t,e){if(n||(n=new Kn([],{})),0===n.segments.length&&n.hasChildren())return Jp(n,t,e);const r=function Ofe(n,t,e){let r=0,s=t;const i={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(r>=e.length)return i;const o=n.segments[s],c=e[r];if(Qp(c))break;const u=`${c}`,h=r<e.length-1?e[r+1]:null;if(s>0&&void 0===u)break;if(u&&h&&"object"==typeof h&&void 0===h.outlets){if(!tj(u,h,o))return i;r+=2}else{if(!tj(u,{},o))return i;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}(n,t,e),s=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const i=new Kn(n.segments.slice(0,r.pathIndex),{});return i.children[Wn]=new Kn(n.segments.slice(r.pathIndex),n.children),Jp(i,0,s)}return r.match&&0===s.length?new Kn(n.segments,{}):r.match&&!n.hasChildren()?eN(n,t,e):r.match?Jp(n,0,s):eN(n,t,e)}function Jp(n,t,e){if(0===e.length)return new Kn(n.segments,{});{const r=function wfe(n){return Qp(n[0])?n[0].outlets:{[Wn]:n}}(e),s={};return O2(r,(i,o)=>{"string"==typeof i&&(i=[i]),null!==i&&(s[o]=JA(n.children[o],t,i))}),O2(n.children,(i,o)=>{void 0===r[o]&&(s[o]=i)}),new Kn(n.segments,s)}}function eN(n,t,e){const r=n.segments.slice(0,t);let s=0;for(;s<e.length;){const i=e[s];if(Qp(i)){const u=bfe(i.outlets);return new Kn(r,u)}if(0===s&&Xp(e[0])){r.push(new Yp(n.segments[t].path,ej(e[0]))),s++;continue}const o=Qp(i)?i.outlets[Wn]:`${i}`,c=s<e.length-1?e[s+1]:null;o&&c&&Xp(c)?(r.push(new Yp(o,ej(c))),s+=2):(r.push(new Yp(o,{})),s++)}return new Kn(r,{})}function bfe(n){const t={};return O2(n,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[r]=eN(new Kn([],{}),0,e))}),t}function ej(n){const t={};return O2(n,(e,r)=>t[r]=`${e}`),t}function tj(n,t,e){return n==e.path&&k4(t,e.parameters)}class jl{constructor(t,e){this.id=t,this.url=e}}class tN extends jl{constructor(t,e,r="imperative",s=null){super(t,e),this.type=0,this.navigationTrigger=r,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class U0 extends jl{constructor(t,e,r){super(t,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class dE extends jl{constructor(t,e,r,s){super(t,e),this.reason=r,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class nj extends jl{constructor(t,e,r,s){super(t,e),this.error=r,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Afe extends jl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Nfe extends jl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ife extends jl{constructor(t,e,r,s,i){super(t,e),this.urlAfterRedirects=r,this.state=s,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class xfe extends jl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class kfe extends jl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Lfe{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Rfe{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Dfe{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zfe{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Vfe{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Hfe{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class rj{constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class sj{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=nN(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){const e=nN(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=rN(t,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return rN(t,this._root).map(e=>e.value)}}function nN(n,t){if(n===t.value)return t;for(const e of t.children){const r=nN(n,e);if(r)return r}return null}function rN(n,t){if(n===t.value)return[t];for(const e of t.children){const r=rN(n,e);if(r.length)return r.unshift(t),r}return[]}class Zl{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function zf(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class ij extends sj{constructor(t,e){super(t),this.snapshot=e,sN(this,t)}toString(){return this.snapshot.toString()}}function oj(n,t){const e=function Bfe(n,t){const o=new pE([],{},{},"",{},Wn,t,null,n.root,-1,{});return new cj("",new Zl(o,[]))}(n,t),r=new D3([new Yp("",{})]),s=new D3({}),i=new D3({}),o=new D3({}),c=new D3(""),u=new zo(r,s,o,c,i,Wn,t,e.root);return u.snapshot=e.root,new ij(new Zl(u,[]),e)}class zo{constructor(t,e,r,s,i,o,c,u){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.pipe(Cn(h=>h[Zp]))??Xt(void 0),this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Cn(t=>Lf(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Cn(t=>Lf(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function aj(n,t="emptyOnly"){const e=n.pathFromRoot;let r=0;if("always"!==t)for(r=e.length-1;r>=1;){const s=e[r],i=e[r-1];if(s.routeConfig&&""===s.routeConfig.path)r--;else{if(i.component)break;r--}}return function $fe(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class pE{constructor(t,e,r,s,i,o,c,u,h,g,m,E){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.[Zp],this.routeConfig=u,this._urlSegment=h,this._lastPathIndex=g,this._correctedLastPathIndex=E??g,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Lf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Lf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class cj extends sj{constructor(t,e){super(e),this.url=t,sN(this,e)}toString(){return lj(this._root)}}function sN(n,t){t.value._routerState=n,t.children.forEach(e=>sN(n,e))}function lj(n){const t=n.children.length>0?` { ${n.children.map(lj).join(", ")} } `:"";return`${n.value}${t}`}function iN(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,k4(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),k4(t.params,e.params)||n.params.next(e.params),function rfe(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!k4(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),k4(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function oN(n,t){const e=k4(n.params,t.params)&&function cfe(n,t){return qu(n,t)&&n.every((e,r)=>k4(e.parameters,t[r].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||oN(n.parent,t.parent))}function eg(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=t.value;const s=function Gfe(n,t,e){return t.children.map(r=>{for(const s of e.children)if(n.shouldReuseRoute(r.value,s.value.snapshot))return eg(n,r,s);return eg(n,r)})}(n,t,e);return new Zl(r,s)}{if(n.shouldAttach(t.value)){const i=n.retrieve(t.value);if(null!==i){const o=i.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(c=>eg(n,c)),o}}const r=function qfe(n){return new zo(new D3(n.url),new D3(n.params),new D3(n.queryParams),new D3(n.fragment),new D3(n.data),n.outlet,n.component,n)}(t.value),s=t.children.map(i=>eg(n,i));return new Zl(r,s)}}const aN="ngNavigationCancelingError";function uj(n,t){const{redirectTo:e,navigationBehaviorOptions:r}=Wu(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=fj(!1,0,t);return s.url=e,s.navigationBehaviorOptions=r,s}function fj(n,t,e){const r=new Error("NavigationCancelingError: "+(n||""));return r[aN]=!0,r.cancellationCode=t,e&&(r.url=e),r}function hj(n){return dj(n)&&Wu(n.url)}function dj(n){return n&&n[aN]}class Wfe{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new tg,this.attachRef=null}}let tg=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const s=this.getOrCreateContext(e);s.outlet=r,this.contexts.set(e,s)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new Wfe,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const gE=!1;let cN=(()=>{class n{constructor(e,r,s,i,o){this.parentContexts=e,this.location=r,this.changeDetector=i,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new dr,this.deactivateEvents=new dr,this.attachEvents=new dr,this.detachEvents=new dr,this.name=s||Wn,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ne(4012,gE);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ne(4012,gE);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ne(4012,gE);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new Ne(4013,gE);this._activatedRoute=e;const s=this.location,o=e._futureSnapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new jfe(e,c,s.injector);if(r&&function Zfe(n){return!!n.resolveComponentFactory}(r)){const h=r.resolveComponentFactory(o);this.activated=s.createComponent(h,s.length,u)}else this.activated=s.createComponent(o,{index:s.length,injector:u,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)(Q(tg),Q(Za),nu("name"),Q(Ru),Q($a))},n.\u0275dir=qt({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class jfe{constructor(t,e,r){this.route=t,this.childContexts=e,this.parent=r}get(t,e){return t===zo?this.route:t===tg?this.childContexts:this.parent.get(t,e)}}let lN=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],standalone:!0,features:[nU],decls:1,vars:0,template:function(e,r){1&e&&X(0,"router-outlet")},dependencies:[cN],encapsulation:2}),n})();function pj(n,t){return n.providers&&!n._injector&&(n._injector=vy(n.providers,t,`Route: ${n.path}`)),n._injector??t}function fN(n){const t=n.children&&n.children.map(fN),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Wn&&(e.component=lN),e}function kc(n){return n.outlet||Wn}function gj(n,t){const e=n.filter(r=>kc(r)===t);return e.push(...n.filter(r=>kc(r)!==t)),e}function ng(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class Jfe{constructor(t,e,r,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=s}activate(t){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),iN(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){const s=zf(e);t.children.forEach(i=>{const o=i.value.outlet;this.deactivateRoutes(i,s[o],r),delete s[o]}),O2(s,(i,o)=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(s===i)if(s.component){const o=r.getContext(s.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,r);else i&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=zf(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);if(r&&r.outlet){const o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:c})}}deactivateRouteAndOutlet(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=zf(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,e,r){const s=zf(e);t.children.forEach(i=>{this.activateRoutes(i,s[i.value.outlet],r),this.forwardEvent(new Hfe(i.value.snapshot))}),t.children.length&&this.forwardEvent(new zfe(t.value.snapshot))}activateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(iN(s),s===i)if(s.component){const o=r.getOrCreateContext(s.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,r);else if(s.component){const o=r.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const c=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),iN(c.route.value),this.activateChildRoutes(t,null,o.children)}else{const c=ng(s.snapshot),u=c?.get(v0)??null;o.attachRef=null,o.route=s,o.resolver=u,o.injector=c,o.outlet&&o.outlet.activateWith(s,o.injector),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,r)}}class mj{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class mE{constructor(t,e){this.component=t,this.route=e}}function ehe(n,t,e){const r=n._root;return rg(r,t?t._root:null,e,[r.value])}function Vf(n,t){const e=Symbol(),r=t.get(n,e);return r===e?"function"!=typeof n||function Z2(n){return null!==Rn(n)}(n)?t.get(n):n:r}function rg(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=zf(t);return n.children.forEach(o=>{(function nhe(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=n.value,o=t?t.value:null,c=e?e.getContext(n.value.outlet):null;if(o&&i.routeConfig===o.routeConfig){const u=function rhe(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!qu(n.url,t.url);case"pathParamsOrQueryParamsChange":return!qu(n.url,t.url)||!k4(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!oN(n,t)||!k4(n.queryParams,t.queryParams);default:return!oN(n,t)}}(o,i,i.routeConfig.runGuardsAndResolvers);u?s.canActivateChecks.push(new mj(r)):(i.data=o.data,i._resolvedData=o._resolvedData),rg(n,t,i.component?c?c.children:null:e,r,s),u&&c&&c.outlet&&c.outlet.isActivated&&s.canDeactivateChecks.push(new mE(c.outlet.component,o))}else o&&sg(t,c,s),s.canActivateChecks.push(new mj(r)),rg(n,null,i.component?c?c.children:null:e,r,s)})(o,i[o.value.outlet],e,r.concat([o.value]),s),delete i[o.value.outlet]}),O2(i,(o,c)=>sg(o,e.getContext(c),s)),s}function sg(n,t,e){const r=zf(n),s=n.value;O2(r,(i,o)=>{sg(i,s.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new mE(s.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,s))}function ig(n){return"function"==typeof n}function hN(n){return n instanceof iE||"EmptyError"===n?.name}const _E=Symbol("INITIAL_VALUE");function Hf(){return x4(n=>IW(n.map(t=>t.pipe(jp(1),function K7e(...n){const t=r4(n);return hr((e,r)=>{(t?GA(n,e,t):GA(n,e)).subscribe(r)})}(_E)))).pipe(Cn(t=>{for(const e of t)if(!0!==e){if(e===_E)return _E;if(!1===e||e instanceof Gu)return e}return!0}),ql(t=>t!==_E),jp(1)))}function _j(n){return function gT(...n){return M_(n)}(w2(t=>{if(Wu(t))throw uj(0,t)}),Cn(t=>!0===t))}const dN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function vj(n,t,e,r,s){const i=pN(n,t,e);return i.matched?function yhe(n,t,e,r){const s=t.canMatch;return s&&0!==s.length?Xt(s.map(o=>{const c=Vf(o,n);return $0(function lhe(n){return n&&ig(n.canMatch)}(c)?c.canMatch(t,e):n.runInContext(()=>c(t,e)))})).pipe(Hf(),_j()):Xt(!0)}(r=pj(t,r),t,e).pipe(Cn(o=>!0===o?i:{...dN})):Xt(i)}function pN(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...dN}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const s=(t.matcher||nfe)(e,n,t);if(!s)return{...dN};const i={};O2(s.posParams,(c,u)=>{i[u]=c.path});const o=s.consumed.length>0?{...i,...s.consumed[s.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:o,positionalParamSegments:s.posParams??{}}}function vE(n,t,e,r,s="corrected"){if(e.length>0&&function She(n,t,e){return e.some(r=>CE(n,t,r)&&kc(r)!==Wn)}(n,e,r)){const o=new Kn(t,function Mhe(n,t,e,r){const s={};s[Wn]=r,r._sourceSegment=n,r._segmentIndexShift=t.length;for(const i of e)if(""===i.path&&kc(i)!==Wn){const o=new Kn([],{});o._sourceSegment=n,o._segmentIndexShift=t.length,s[kc(i)]=o}return s}(n,t,r,new Kn(e,n.children)));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===e.length&&function Phe(n,t,e){return e.some(r=>CE(n,t,r))}(n,e,r)){const o=new Kn(n.segments,function Ehe(n,t,e,r,s,i){const o={};for(const c of r)if(CE(n,e,c)&&!s[kc(c)]){const u=new Kn([],{});u._sourceSegment=n,u._segmentIndexShift="legacy"===i?n.segments.length:t.length,o[kc(c)]=u}return{...s,...o}}(n,t,e,r,n.children,s));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:e}}const i=new Kn(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:e}}function CE(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function Cj(n,t,e,r){return!!(kc(n)===r||r!==Wn&&CE(t,e,n))&&("**"===n.path||pN(t,n,e).matched)}function yj(n,t,e){return 0===t.length&&!n.children[e]}const yE=!1;class EE{constructor(t){this.segmentGroup=t||null}}class Ej{constructor(t){this.urlTree=t}}function og(n){return Wp(new EE(n))}function Mj(n){return Wp(new Ej(n))}class bhe{constructor(t,e,r,s,i){this.injector=t,this.configLoader=e,this.urlSerializer=r,this.urlTree=s,this.config=i,this.allowRedirects=!0}apply(){const t=vE(this.urlTree.root,[],[],this.config).segmentGroup,e=new Kn(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,Wn).pipe(Cn(i=>this.createUrlTree(hE(i),this.urlTree.queryParams,this.urlTree.fragment))).pipe(B0(i=>{if(i instanceof Ej)return this.allowRedirects=!1,this.match(i.urlTree);throw i instanceof EE?this.noMatchError(i):i}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,Wn).pipe(Cn(s=>this.createUrlTree(hE(s),t.queryParams,t.fragment))).pipe(B0(s=>{throw s instanceof EE?this.noMatchError(s):s}))}noMatchError(t){return new Ne(4002,yE)}createUrlTree(t,e,r){const s=XA(t);return new Gu(s,e,r)}expandSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,e,r).pipe(Cn(i=>new Kn([],i))):this.expandSegment(t,r,e,r.segments,s,!0)}expandChildren(t,e,r){const s=[];for(const i of Object.keys(r.children))"primary"===i?s.unshift(i):s.push(i);return ls(s).pipe(V0(i=>{const o=r.children[i],c=gj(e,i);return this.expandSegmentGroup(t,c,o,i).pipe(Cn(u=>({segment:u,outlet:i})))}),DW((i,o)=>(i[o.outlet]=o.segment,i),{}),zW())}expandSegment(t,e,r,s,i,o){return ls(r).pipe(V0(c=>this.expandSegmentAgainstRoute(t,e,r,c,s,i,o).pipe(B0(h=>{if(h instanceof EE)return Xt(null);throw h}))),F0(c=>!!c),B0((c,u)=>{if(hN(c))return yj(e,s,i)?Xt(new Kn([],{})):og(e);throw c}))}expandSegmentAgainstRoute(t,e,r,s,i,o,c){return Cj(s,e,i,o)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(t,e,s,i,o):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o):og(e):og(e)}expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,s,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,r,s){const i=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?Mj(i):this.lineralizeSegments(r,i).pipe(Ve(o=>{const c=new Kn(o,{});return this.expandSegment(t,c,e,o,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){const{matched:c,consumedSegments:u,remainingSegments:h,positionalParamSegments:g}=pN(e,s,i);if(!c)return og(e);const m=this.applyRedirectCommands(u,s.redirectTo,g);return s.redirectTo.startsWith("/")?Mj(m):this.lineralizeSegments(s,m).pipe(Ve(E=>this.expandSegment(t,e,r,E.concat(h),o,!1)))}matchSegmentAgainstRoute(t,e,r,s,i){return"**"===r.path?(t=pj(r,t),r.loadChildren?(r._loadedRoutes?Xt({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(t,r)).pipe(Cn(c=>(r._loadedRoutes=c.routes,r._loadedInjector=c.injector,new Kn(s,{})))):Xt(new Kn(s,{}))):vj(e,r,s,t).pipe(x4(({matched:o,consumedSegments:c,remainingSegments:u})=>o?this.getChildConfig(t=r._injector??t,r,s).pipe(Ve(g=>{const m=g.injector??t,E=g.routes,{segmentGroup:O,slicedSegments:k}=vE(e,c,u,E),U=new Kn(O.segments,O.children);if(0===k.length&&U.hasChildren())return this.expandChildren(m,E,U).pipe(Cn(ne=>new Kn(c,ne)));if(0===E.length&&0===k.length)return Xt(new Kn(c,{}));const j=kc(r)===i;return this.expandSegment(m,U,E,k,j?Wn:i,!0).pipe(Cn(Ee=>new Kn(c.concat(Ee.segments),Ee.children)))})):og(e)))}getChildConfig(t,e,r){return e.children?Xt({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?Xt({routes:e._loadedRoutes,injector:e._loadedInjector}):function Che(n,t,e,r){const s=t.canLoad;return void 0===s||0===s.length?Xt(!0):Xt(s.map(o=>{const c=Vf(o,n);return $0(function ihe(n){return n&&ig(n.canLoad)}(c)?c.canLoad(t,e):n.runInContext(()=>c(t,e)))})).pipe(Hf(),_j())}(t,e,r).pipe(Ve(s=>s?this.configLoader.loadChildren(t,e).pipe(w2(i=>{e._loadedRoutes=i.routes,e._loadedInjector=i.injector})):function whe(n){return Wp(fj(yE,3))}())):Xt({routes:[],injector:t})}lineralizeSegments(t,e){let r=[],s=e.root;for(;;){if(r=r.concat(s.segments),0===s.numberOfChildren)return Xt(r);if(s.numberOfChildren>1||!s.children[Wn])return Wp(new Ne(4e3,yE));s=s.children[Wn]}}applyRedirectCommands(t,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,r)}applyRedirectCreateUrlTree(t,e,r,s){const i=this.createSegmentGroup(t,e.root,r,s);return new Gu(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const r={};return O2(t,(s,i)=>{if("string"==typeof s&&s.startsWith(":")){const c=s.substring(1);r[i]=e[c]}else r[i]=s}),r}createSegmentGroup(t,e,r,s){const i=this.createSegments(t,e.segments,r,s);let o={};return O2(e.children,(c,u)=>{o[u]=this.createSegmentGroup(t,c,r,s)}),new Kn(i,o)}createSegments(t,e,r,s){return e.map(i=>i.path.startsWith(":")?this.findPosParam(t,i,s):this.findOrReturn(i,r))}findPosParam(t,e,r){const s=r[e.path.substring(1)];if(!s)throw new Ne(4001,yE);return s}findOrReturn(t,e){let r=0;for(const s of e){if(s.path===t.path)return e.splice(r),s;r++}return t}}class Nhe{}class khe{constructor(t,e,r,s,i,o,c,u){this.injector=t,this.rootComponentType=e,this.config=r,this.urlTree=s,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=c,this.urlSerializer=u}recognize(){const t=vE(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,Wn).pipe(Cn(e=>{if(null===e)return null;const r=new pE([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Wn,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new Zl(r,e),i=new cj(this.url,s);return this.inheritParamsAndData(i._root),i}))}inheritParamsAndData(t){const e=t.value,r=aj(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),t.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,e,r):this.processSegment(t,e,r,r.segments,s)}processChildren(t,e,r){return ls(Object.keys(r.children)).pipe(V0(s=>{const i=r.children[s],o=gj(e,s);return this.processSegmentGroup(t,o,i,s)}),DW((s,i)=>s&&i?(s.push(...i),s):null),function J7e(n,t=!1){return hr((e,r)=>{let s=0;e.subscribe(cs(r,i=>{const o=n(i,s++);(o||t)&&r.next(i),!o&&r.complete()}))})}(s=>null!==s),oE(null),zW(),Cn(s=>{if(null===s)return null;const i=Sj(s);return function Lhe(n){n.sort((t,e)=>t.value.outlet===Wn?-1:e.value.outlet===Wn?1:t.value.outlet.localeCompare(e.value.outlet))}(i),i}))}processSegment(t,e,r,s,i){return ls(e).pipe(V0(o=>this.processSegmentAgainstRoute(o._injector??t,o,r,s,i)),F0(o=>!!o),B0(o=>{if(hN(o))return yj(r,s,i)?Xt([]):Xt(null);throw o}))}processSegmentAgainstRoute(t,e,r,s,i){if(e.redirectTo||!Cj(e,r,s,i))return Xt(null);let o;if("**"===e.path){const c=s.length>0?FW(s).parameters:{},u=Tj(r)+s.length;o=Xt({snapshot:new pE(s,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Oj(e),kc(e),e.component??e._loadedComponent??null,e,Pj(r),u,bj(e),u),consumedSegments:[],remainingSegments:[]})}else o=vj(r,e,s,t).pipe(Cn(({matched:c,consumedSegments:u,remainingSegments:h,parameters:g})=>{if(!c)return null;const m=Tj(r)+u.length;return{snapshot:new pE(u,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Oj(e),kc(e),e.component??e._loadedComponent??null,e,Pj(r),m,bj(e),m),consumedSegments:u,remainingSegments:h}}));return o.pipe(x4(c=>{if(null===c)return Xt(null);const{snapshot:u,consumedSegments:h,remainingSegments:g}=c;t=e._injector??t;const m=e._loadedInjector??t,E=function Rhe(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:O,slicedSegments:k}=vE(r,h,g,E.filter(j=>void 0===j.redirectTo),this.relativeLinkResolution);if(0===k.length&&O.hasChildren())return this.processChildren(m,E,O).pipe(Cn(j=>null===j?null:[new Zl(u,j)]));if(0===E.length&&0===k.length)return Xt([new Zl(u,[])]);const U=kc(e)===i;return this.processSegment(m,E,O,k,U?Wn:i).pipe(Cn(j=>null===j?null:[new Zl(u,j)]))}))}}function Dhe(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function Sj(n){const t=[],e=new Set;for(const r of n){if(!Dhe(r)){t.push(r);continue}const s=t.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==s?(s.children.push(...r.children),e.add(s)):t.push(r)}for(const r of e){const s=Sj(r.children);t.push(new Zl(r.value,s))}return t.filter(r=>!e.has(r))}function Pj(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function Tj(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function Oj(n){return n.data||{}}function bj(n){return n.resolve||{}}function Aj(n){return"string"==typeof n.title||null===n.title}function gN(n){return x4(t=>{const e=n(t);return e?ls(e).pipe(Cn(()=>t)):Xt(t)})}let Nj=(()=>{class n{buildTitle(e){let r,s=e.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(i=>i.outlet===Wn);return r}getResolvedTitleForRoute(e){return e.data[Zp]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:function(){return Hr(Ij)},providedIn:"root"}),n})(),Ij=(()=>{class n extends Nj{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(e){return new(e||n)(ze(lq))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ghe{}class Whe extends class qhe{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const SE=new Dt("",{providedIn:"root",factory:()=>({})}),mN=new Dt("ROUTES");let _N=(()=>{class n{constructor(e,r){this.injector=e,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Xt(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=$0(e.loadComponent()).pipe(w2(i=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=i}),jA(()=>{this.componentLoaders.delete(e)})),s=new LW(r,()=>new W2).pipe(qA());return this.componentLoaders.set(e,s),s}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Xt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(Cn(c=>{this.onLoadEndListener&&this.onLoadEndListener(r);let u,h,g=!1;Array.isArray(c)?h=c:(u=c.create(e).injector,h=HW(u.get(mN,[],Yt.Self|Yt.Optional)));return{routes:h.map(fN),injector:u}}),jA(()=>{this.childrenLoaders.delete(r)})),o=new LW(i,()=>new W2).pipe(qA());return this.childrenLoaders.set(r,o),o}loadModuleFactoryOrRoutes(e){return $0(e()).pipe(Ve(r=>r instanceof eU||Array.isArray(r)?Xt(r):ls(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(e){return new(e||n)(ze(fi),ze(zb))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Zhe{}class Yhe{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function Khe(n){throw n}function Xhe(n,t,e){return t.parse("/")}const Qhe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Jhe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function kj(){const n=Hr(WW),t=Hr(tg),e=Hr(Qb),r=Hr(fi),s=Hr(zb),i=Hr(mN,{optional:!0})??[],o=Hr(SE,{optional:!0})??{},c=Hr(Ij),u=Hr(Nj,{optional:!0}),h=Hr(Zhe,{optional:!0}),g=Hr(Ghe,{optional:!0}),m=new Xn(null,n,t,e,r,s,HW(i));return h&&(m.urlHandlingStrategy=h),g&&(m.routeReuseStrategy=g),m.titleStrategy=u??c,function e9e(n,t){n.errorHandler&&(t.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(t.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(t.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(t.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(t.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(t.canceledNavigationResolution=n.canceledNavigationResolution)}(o,m),m}let Xn=(()=>{class n{constructor(e,r,s,i,o,c,u){this.rootComponentType=e,this.urlSerializer=r,this.rootContexts=s,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new W2,this.errorHandler=Khe,this.malformedUriErrorHandler=Xhe,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Xt(void 0),this.urlHandlingStrategy=new Yhe,this.routeReuseStrategy=new Whe,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(_N),this.configLoader.onLoadEndListener=E=>this.triggerEvent(new Rfe(E)),this.configLoader.onLoadStartListener=E=>this.triggerEvent(new Lfe(E)),this.ngModule=o.get(Lu),this.console=o.get(b0e);const m=o.get(wr);this.isNgZoneEnabled=m instanceof wr&&wr.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=function sfe(){return new Gu(new Kn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=oj(this.currentUrlTree,this.rootComponentType),this.transitions=new D3({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const r=this.events;return e.pipe(ql(s=>0!==s.id),Cn(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),x4(s=>{let i=!1,o=!1;return Xt(s).pipe(w2(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),x4(c=>{const u=this.browserUrlTree.toString(),h=!this.navigated||c.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||h)&&this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Lj(c.source)&&(this.browserUrlTree=c.extractedUrl),Xt(c).pipe(x4(m=>{const E=this.transitions.getValue();return r.next(new tN(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),E!==this.transitions.getValue()?Ec:Promise.resolve(m)}),function Ahe(n,t,e,r){return x4(s=>function Ohe(n,t,e,r,s){return new bhe(n,t,e,r,s).apply()}(n,t,e,s.extractedUrl,r).pipe(Cn(i=>({...s,urlAfterRedirects:i}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),w2(m=>{this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects},s.urlAfterRedirects=m.urlAfterRedirects}),function Vhe(n,t,e,r,s,i){return Ve(o=>function xhe(n,t,e,r,s,i,o="emptyOnly",c="legacy"){return new khe(n,t,e,r,s,o,c,i).recognize().pipe(x4(u=>null===u?function Ihe(n){return new Mr(t=>t.error(n))}(new Nhe):Xt(u)))}(n,t,e,o.urlAfterRedirects,r.serialize(o.urlAfterRedirects),r,s,i).pipe(Cn(c=>({...o,targetSnapshot:c}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),w2(m=>{if(s.targetSnapshot=m.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const O=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(O,m)}this.browserUrlTree=m.urlAfterRedirects}const E=new Afe(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);r.next(E)}));if(h&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:E,extractedUrl:O,source:k,restoredState:U,extras:j}=c,oe=new tN(E,this.serializeUrl(O),k,U);r.next(oe);const Ee=oj(O,this.rootComponentType).snapshot;return Xt(s={...c,targetSnapshot:Ee,urlAfterRedirects:O,extras:{...j,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=c.rawUrl,c.resolve(null),Ec}),w2(c=>{const u=new Nfe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(u)}),Cn(c=>s={...c,guards:ehe(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),function fhe(n,t){return Ve(e=>{const{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:i,canDeactivateChecks:o}}=e;return 0===o.length&&0===i.length?Xt({...e,guardsResult:!0}):function hhe(n,t,e,r){return ls(n).pipe(Ve(s=>function vhe(n,t,e,r,s){const i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?Xt(i.map(c=>{const u=ng(t)??s,h=Vf(c,u);return $0(function che(n){return n&&ig(n.canDeactivate)}(h)?h.canDeactivate(n,t,e,r):u.runInContext(()=>h(n,t,e,r))).pipe(F0())})).pipe(Hf()):Xt(!0)}(s.component,s.route,e,t,r)),F0(s=>!0!==s,!0))}(o,r,s,n).pipe(Ve(c=>c&&function she(n){return"boolean"==typeof n}(c)?function dhe(n,t,e,r){return ls(t).pipe(V0(s=>GA(function ghe(n,t){return null!==n&&t&&t(new Dfe(n)),Xt(!0)}(s.route.parent,r),function phe(n,t){return null!==n&&t&&t(new Vfe(n)),Xt(!0)}(s.route,r),function _he(n,t,e){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(o=>function the(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(o)).filter(o=>null!==o).map(o=>kW(()=>Xt(o.guards.map(u=>{const h=ng(o.node)??e,g=Vf(u,h);return $0(function ahe(n){return n&&ig(n.canActivateChild)}(g)?g.canActivateChild(r,n):h.runInContext(()=>g(r,n))).pipe(F0())})).pipe(Hf())));return Xt(i).pipe(Hf())}(n,s.path,e),function mhe(n,t,e){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Xt(!0);const s=r.map(i=>kW(()=>{const o=ng(t)??e,c=Vf(i,o);return $0(function ohe(n){return n&&ig(n.canActivate)}(c)?c.canActivate(t,n):o.runInContext(()=>c(t,n))).pipe(F0())}));return Xt(s).pipe(Hf())}(n,s.route,e))),F0(s=>!0!==s,!0))}(r,i,n,t):Xt(c)),Cn(c=>({...e,guardsResult:c})))})}(this.ngModule.injector,c=>this.triggerEvent(c)),w2(c=>{if(s.guardsResult=c.guardsResult,Wu(c.guardsResult))throw uj(0,c.guardsResult);const u=new Ife(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.triggerEvent(u)}),ql(c=>!!c.guardsResult||(this.restoreHistory(c),this.cancelNavigationTransition(c,"",3),!1)),gN(c=>{if(c.guards.canActivateChecks.length)return Xt(c).pipe(w2(u=>{const h=new xfe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}),x4(u=>{let h=!1;return Xt(u).pipe(function Hhe(n,t){return Ve(e=>{const{targetSnapshot:r,guards:{canActivateChecks:s}}=e;if(!s.length)return Xt(e);let i=0;return ls(s).pipe(V0(o=>function Fhe(n,t,e,r){const s=n.routeConfig,i=n._resolve;return void 0!==s?.title&&!Aj(s)&&(i[Zp]=s.title),function Bhe(n,t,e,r){const s=function $he(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===s.length)return Xt({});const i={};return ls(s).pipe(Ve(o=>function Uhe(n,t,e,r){const s=ng(t)??r,i=Vf(n,s);return $0(i.resolve?i.resolve(t,e):s.runInContext(()=>i(t,e)))}(n[o],t,e,r).pipe(F0(),w2(c=>{i[o]=c}))),WA(1),function efe(n){return Cn(()=>n)}(i),B0(o=>hN(o)?Ec:Wp(o)))}(i,n,t,r).pipe(Cn(o=>(n._resolvedData=o,n.data=aj(n,e).resolve,s&&Aj(s)&&(n.data[Zp]=s.title),null)))}(o.route,r,n,t)),w2(()=>i++),WA(1),Ve(o=>i===s.length?Xt(e):Ec))})}(this.paramsInheritanceStrategy,this.ngModule.injector),w2({next:()=>h=!0,complete:()=>{h||(this.restoreHistory(u),this.cancelNavigationTransition(u,"",2))}}))}),w2(u=>{const h=new kfe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}))}),gN(c=>{const u=h=>{const g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe(w2(m=>{h.component=m}),Cn(()=>{})));for(const m of h.children)g.push(...u(m));return g};return IW(u(c.targetSnapshot.root)).pipe(oE(),jp(1))}),gN(()=>this.afterPreactivation()),Cn(c=>{const u=function Ufe(n,t,e){const r=eg(n,t._root,e?e._root:void 0);return new ij(r,t)}(this.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return s={...c,targetRouterState:u}}),w2(c=>{this.currentUrlTree=c.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),this.routerState=c.targetRouterState,"deferred"===this.urlUpdateStrategy&&(c.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,c),this.browserUrlTree=c.urlAfterRedirects)}),((n,t,e)=>Cn(r=>(new Jfe(t,r.targetRouterState,r.currentRouterState,e).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,c=>this.triggerEvent(c)),w2({next(){i=!0},complete(){i=!0}}),jA(()=>{i||o||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),B0(c=>{if(o=!0,dj(c)){hj(c)||(this.navigated=!0,this.restoreHistory(s,!0));const u=new dE(s.id,this.serializeUrl(s.extractedUrl),c.message,c.cancellationCode);if(r.next(u),hj(c)){const h=this.urlHandlingStrategy.merge(c.url,this.rawUrlTree),g={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Lj(s.source)};this.scheduleNavigation(h,"imperative",null,g,{resolve:s.resolve,reject:s.reject,promise:s.promise})}else s.resolve(!1)}else{this.restoreHistory(s,!0);const u=new nj(s.id,this.serializeUrl(s.extractedUrl),c,s.targetSnapshot??void 0);r.next(u);try{s.resolve(this.errorHandler(c))}catch(h){s.reject(h)}}return Ec}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const s={replaceUrl:!0},i=e.state?.navigationId?e.state:null;if(i){const c={...i};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(s.state=c)}const o=this.parseUrl(e.url);this.scheduleNavigation(o,r,i,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(fN),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:s,queryParams:i,fragment:o,queryParamsHandling:c,preserveFragment:u}=r,h=s||this.routerState.root,g=u?this.currentUrlTree.fragment:o;let m=null;switch(c){case"merge":m={...this.currentUrlTree.queryParams,...i};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=i||null}return null!==m&&(m=this.removeEmptyProps(m)),Sfe(h,this.currentUrlTree,e,m,g??null)}navigateByUrl(e,r={skipLocationChange:!1}){const s=Wu(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function t9e(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new Ne(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(s){r=this.malformedUriErrorHandler(s,this.urlSerializer,e)}return r}isActive(e,r){let s;if(s=!0===r?{...Qhe}:!1===r?{...Jhe}:r,Wu(e))return $W(this.currentUrlTree,e,s);const i=this.parseUrl(e);return $W(this.currentUrlTree,i,s)}removeEmptyProps(e){return Object.keys(e).reduce((r,s)=>{const i=e[s];return null!=i&&(r[s]=i),r},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new U0(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,r,s,i,o){if(this.disposed)return Promise.resolve(!1);let c,u,h;o?(c=o.resolve,u=o.reject,h=o.promise):h=new Promise((E,O)=>{c=E,u=O});const g=++this.navigationId;let m;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(s=this.location.getState()),m=s&&s.\u0275routerPageId?s.\u0275routerPageId:i.replaceUrl||i.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):m=0,this.setTransition({id:g,targetPageId:m,source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:i,resolve:c,reject:u,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(E=>Promise.reject(E))}setBrowserUrl(e,r){const s=this.urlSerializer.serialize(e),i={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl?this.location.replaceState(s,"",i):this.location.go(s,"",i)}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===s?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===s&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(s)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,r,s){const i=new dE(e.id,this.serializeUrl(e.extractedUrl),r,s);this.triggerEvent(i),e.resolve(!1)}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return n.\u0275fac=function(e){lf()},n.\u0275prov=nt({token:n,factory:function(){return kj()},providedIn:"root"}),n})();function Lj(n){return"imperative"!==n}let Ff=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.route=r,this.tabIndexAttribute=s,this.renderer=i,this.el=o,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new W2,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=Bl(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Bl(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Bl(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const r=this.renderer,s=this.el.nativeElement;null!==e?r.setAttribute(s,"tabindex",e):r.removeAttribute(s,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(Q(Xn),Q(zo),nu("tabindex"),Q(No),Q(y2))},n.\u0275dir=qt({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,r){1&e&&ee("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[h2]}),n})(),ju=(()=>{class n{constructor(e,r,s){this.router=e,this.route=r,this.locationStrategy=s,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new W2,this.subscription=e.events.subscribe(i=>{i instanceof U0&&this.updateTargetUrlAndHref()})}set preserveFragment(e){this._preserveFragment=Bl(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Bl(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Bl(e)}get replaceUrl(){return this._replaceUrl}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,r,s,i,o){return!!(0!==e||r||s||i||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(Q(Xn),Q(zo),Q(zu))},n.\u0275dir=qt({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,r){1&e&&ee("click",function(i){return r.onClick(i.button,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey)}),2&e&&z("target",r.target)("href",r.href,E3)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[h2]}),n})();class Rj{}let s9e=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.injector=s,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(ql(e=>e instanceof U0),V0(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const s=[];for(const i of r){i.providers&&!i._injector&&(i._injector=vy(i.providers,e,`Route: ${i.path}`));const o=i._injector??e,c=i._loadedInjector??o;i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent?s.push(this.preloadConfig(o,i)):(i.children||i._loadedRoutes)&&s.push(this.processRoutes(c,i.children??i._loadedRoutes))}return ls(s).pipe(hl())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let s;s=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):Xt(null);const i=s.pipe(Ve(o=>null===o?Xt(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));return r.loadComponent&&!r._loadedComponent?ls([i,this.loader.loadComponent(r)]).pipe(hl()):i})}}return n.\u0275fac=function(e){return new(e||n)(ze(Xn),ze(zb),ze($a),ze(Rj),ze(_N))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const vN=new Dt("");let Dj=(()=>{class n{constructor(e,r,s={}){this.router=e,this.viewportScroller=r,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof tN?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof U0&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof rj&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.router.triggerEvent(new rj(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(e){lf()},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();function Bf(n,t){return{\u0275kind:n,\u0275providers:t}}function CN(n){return[{provide:mN,multi:!0,useValue:n}]}function Vj(){const n=Hr(fi);return t=>{const e=n.get(Ap);if(t!==e.components[0])return;const r=n.get(Xn),s=n.get(Hj);1===n.get(yN)&&r.initialNavigation(),n.get(Fj,null,Yt.Optional)?.setUpPreloading(),n.get(vN,null,Yt.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),s.next(),s.complete()}}const Hj=new Dt("",{factory:()=>new W2}),yN=new Dt("",{providedIn:"root",factory:()=>1});const Fj=new Dt("");function c9e(n){return Bf(0,[{provide:Fj,useExisting:s9e},{provide:Rj,useExisting:n}])}const Bj=new Dt("ROUTER_FORROOT_GUARD"),l9e=[Qb,{provide:WW,useClass:YA},{provide:Xn,useFactory:kj},tg,{provide:zo,useFactory:function zj(n){return n.routerState.root},deps:[Xn]},_N];function u9e(){return new XU("Router",Xn)}let f9e=(()=>{class n{constructor(e){}static forRoot(e,r){return{ngModule:n,providers:[l9e,[],CN(e),{provide:Bj,useFactory:g9e,deps:[[Xn,new ui,new lu]]},{provide:SE,useValue:r||{}},r?.useHash?{provide:zu,useClass:m8e}:{provide:zu,useClass:MG},{provide:vN,useFactory:()=>{const n=Hr(Xn),t=Hr(Lue),e=Hr(SE);return e.scrollOffset&&t.setOffset(e.scrollOffset),new Dj(n,t,e)}},r?.preloadingStrategy?c9e(r.preloadingStrategy).\u0275providers:[],{provide:XU,multi:!0,useFactory:u9e},r?.initialNavigation?m9e(r):[],[{provide:$j,useFactory:Vj},{provide:UU,multi:!0,useExisting:$j}]]}}static forChild(e){return{ngModule:n,providers:[CN(e)]}}}return n.\u0275fac=function(e){return new(e||n)(ze(Bj,8))},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({imports:[lN]}),n})();function g9e(n){return"guarded"}function m9e(n){return["disabled"===n.initialNavigation?Bf(3,[{provide:My,multi:!0,useFactory:()=>{const t=Hr(Xn);return()=>{t.setUpLocationChangeListener()}}},{provide:yN,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Bf(2,[{provide:yN,useValue:0},{provide:My,multi:!0,deps:[fi],useFactory:t=>{const e=t.get(p8e,Promise.resolve());let r=!1;return()=>e.then(()=>new Promise(i=>{const o=t.get(Xn),c=t.get(Hj);(function s(i){t.get(Xn).events.pipe(ql(c=>c instanceof U0||c instanceof dE||c instanceof nj),Cn(c=>c instanceof U0||c instanceof dE&&(0===c.code||1===c.code)&&null),ql(c=>null!==c),jp(1)).subscribe(()=>{i()})})(()=>{i(!0),r=!0}),o.afterPreactivation=()=>(i(!0),r||c.closed?Xt(void 0):c),o.initialNavigation()}))}}]).\u0275providers:[]]}const $j=new Dt("");class Uj{}const Yl="*";function Gj(n,t=null){return{type:2,steps:n,options:t}}function qj(n){return{type:6,styles:n,offset:null}}function Wj(n){Promise.resolve().then(n)}class ag{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Wj(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class jj{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,r=0,s=0;const i=this.players.length;0==i?Wj(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==i&&this._onFinish()}),o.onDestroy(()=>{++r==i&&this._onDestroy()}),o.onStart(()=>{++s==i&&this._onStart()})}),this.totalTime=this.players.reduce((o,c)=>Math.max(o,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(r=>{const s=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(s)})}getPosition(){const t=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}function Zj(n){return new Ne(3e3,!1)}function J9e(){return typeof window<"u"&&typeof window.document<"u"}function MN(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function G0(n){switch(n.length){case 0:return new ag;case 1:return n[0];default:return new jj(n)}}function Yj(n,t,e,r,s=new Map,i=new Map){const o=[],c=[];let u=-1,h=null;if(r.forEach(g=>{const m=g.get("offset"),E=m==u,O=E&&h||new Map;g.forEach((k,U)=>{let j=U,oe=k;if("offset"!==U)switch(j=t.normalizePropertyName(j,o),oe){case"!":oe=s.get(U);break;case Yl:oe=i.get(U);break;default:oe=t.normalizeStyleValue(U,j,oe,o)}O.set(j,oe)}),E||c.push(O),h=O,u=m}),o.length)throw function B9e(n){return new Ne(3502,!1)}();return c}function SN(n,t,e,r){switch(t){case"start":n.onStart(()=>r(e&&PN(e,"start",n)));break;case"done":n.onDone(()=>r(e&&PN(e,"done",n)));break;case"destroy":n.onDestroy(()=>r(e&&PN(e,"destroy",n)))}}function PN(n,t,e){const i=TN(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),o=n._data;return null!=o&&(i._data=o),i}function TN(n,t,e,r,s="",i=0,o){return{element:n,triggerName:t,fromState:e,toState:r,phaseName:s,totalTime:i,disabled:!!o}}function Ka(n,t,e){let r=n.get(t);return r||n.set(t,r=e),r}function Kj(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let wN=(n,t)=>!1,Xj=(n,t,e)=>[],Qj=null;function ON(n){const t=n.parentNode||n.host;return t===Qj?null:t}(MN()||typeof Element<"u")&&(J9e()?(Qj=(()=>document.documentElement)(),wN=(n,t)=>{for(;t;){if(t===n)return!0;t=ON(t)}return!1}):wN=(n,t)=>n.contains(t),Xj=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const r=n.querySelector(t);return r?[r]:[]});let Zu=null,Jj=!1;const eZ=wN,tZ=Xj;let nZ=(()=>{class n{validateStyleProperty(e){return function tde(n){Zu||(Zu=function nde(){return typeof document<"u"?document.body:null}()||{},Jj=!!Zu.style&&"WebkitAppearance"in Zu.style);let t=!0;return Zu.style&&!function ede(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in Zu.style,!t&&Jj&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Zu.style)),t}(e)}matchesElement(e,r){return!1}containsElement(e,r){return eZ(e,r)}getParentElement(e){return ON(e)}query(e,r,s){return tZ(e,r,s)}computeStyle(e,r,s){return s||""}animate(e,r,s,i,o,c=[],u){return new ag(s,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),bN=(()=>{class n{}return n.NOOP=new nZ,n})();const AN="ng-enter",OE="ng-leave",bE="ng-trigger",AE=".ng-trigger",sZ="ng-animating",NN=".ng-animating";function Kl(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:IN(parseFloat(t[1]),t[2])}function IN(n,t){return"s"===t?1e3*n:n}function NE(n,t,e){return n.hasOwnProperty("duration")?n:function ide(n,t,e){let s,i=0,o="";if("string"==typeof n){const c=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return t.push(Zj()),{duration:0,delay:0,easing:""};s=IN(parseFloat(c[1]),c[2]);const u=c[3];null!=u&&(i=IN(parseFloat(u),c[4]));const h=c[5];h&&(o=h)}else s=n;if(!e){let c=!1,u=t.length;s<0&&(t.push(function C9e(){return new Ne(3100,!1)}()),c=!0),i<0&&(t.push(function y9e(){return new Ne(3101,!1)}()),c=!0),c&&t.splice(u,0,Zj())}return{duration:s,delay:i,easing:o}}(n,t,e)}function cg(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function iZ(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function q0(n,t=new Map,e){if(e)for(let[r,s]of e)t.set(r,s);for(let[r,s]of n)t.set(r,s);return t}function aZ(n,t,e){return e?t+":"+e+";":""}function cZ(n){let t="";for(let e=0;e<n.style.length;e++){const r=n.style.item(e);t+=aZ(0,r,n.style.getPropertyValue(r))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=aZ(0,lde(e),n.style[e]));n.setAttribute("style",t)}function L4(n,t,e){n.style&&(t.forEach((r,s)=>{const i=kN(s);e&&!e.has(s)&&e.set(s,n.style[i]),n.style[i]=r}),MN()&&cZ(n))}function Yu(n,t){n.style&&(t.forEach((e,r)=>{const s=kN(r);n.style[s]=""}),MN()&&cZ(n))}function lg(n){return Array.isArray(n)?1==n.length?n[0]:Gj(n):n}const xN=new RegExp("{{\\s*(.+?)\\s*}}","g");function lZ(n){let t=[];if("string"==typeof n){let e;for(;e=xN.exec(n);)t.push(e[1]);xN.lastIndex=0}return t}function ug(n,t,e){const r=n.toString(),s=r.replace(xN,(i,o)=>{let c=t[o];return null==c&&(e.push(function M9e(n){return new Ne(3003,!1)}()),c=""),c.toString()});return s==r?n:s}function IE(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const cde=/-+([a-z0-9])/g;function kN(n){return n.replace(cde,(...t)=>t[1].toUpperCase())}function lde(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Xa(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function S9e(n){return new Ne(3004,!1)}()}}function uZ(n,t){return window.getComputedStyle(n)[t]}function gde(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function mde(n,t,e){if(":"==n[0]){const u=function _de(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return t.push(function z9e(n){return new Ne(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof u)return void t.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function D9e(n){return new Ne(3015,!1)}()),t;const s=r[1],i=r[2],o=r[3];t.push(fZ(s,o));"<"==i[0]&&!("*"==s&&"*"==o)&&t.push(fZ(o,s))}(r,e,t)):e.push(n),e}const RE=new Set(["true","1"]),DE=new Set(["false","0"]);function fZ(n,t){const e=RE.has(n)||DE.has(n),r=RE.has(t)||DE.has(t);return(s,i)=>{let o="*"==n||n==s,c="*"==t||t==i;return!o&&e&&"boolean"==typeof s&&(o=s?RE.has(n):DE.has(n)),!c&&r&&"boolean"==typeof i&&(c=i?RE.has(t):DE.has(t)),o&&c}}const vde=new RegExp("s*:selfs*,?","g");function LN(n,t,e,r){return new Cde(n).build(t,e,r)}class Cde{constructor(t){this._driver=t}build(t,e,r){const s=new Mde(e);return this._resetContextStyleTimingState(s),Xa(this,lg(t),s)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let r=e.queryCount=0,s=e.depCount=0;const i=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push(function T9e(){return new Ne(3006,!1)}()),t.definitions.forEach(c=>{if(this._resetContextStyleTimingState(e),0==c.type){const u=c,h=u.name;h.toString().split(/\s*,\s*/).forEach(g=>{u.name=g,i.push(this.visitState(u,e))}),u.name=h}else if(1==c.type){const u=this.visitTransition(c,e);r+=u.queryCount,s+=u.depCount,o.push(u)}else e.errors.push(function w9e(){return new Ne(3007,!1)}())}),{type:7,name:t.name,states:i,transitions:o,queryCount:r,depCount:s,options:null}}visitState(t,e){const r=this.visitStyle(t.styles,e),s=t.options&&t.options.params||null;if(r.containsDynamicStyles){const i=new Set,o=s||{};r.styles.forEach(c=>{c instanceof Map&&c.forEach(u=>{lZ(u).forEach(h=>{o.hasOwnProperty(h)||i.add(h)})})}),i.size&&(IE(i.values()),e.errors.push(function O9e(n,t){return new Ne(3008,!1)}()))}return{type:0,name:t.name,style:r,options:s?{params:s}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const r=Xa(this,lg(t.animation),e);return{type:1,matchers:gde(t.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:Ku(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(r=>Xa(this,r,e)),options:Ku(t.options)}}visitGroup(t,e){const r=e.currentTime;let s=0;const i=t.steps.map(o=>{e.currentTime=r;const c=Xa(this,o,e);return s=Math.max(s,e.currentTime),c});return e.currentTime=s,{type:3,steps:i,options:Ku(t.options)}}visitAnimate(t,e){const r=function Pde(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return RN(NE(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(i=>"{"==i.charAt(0)&&"{"==i.charAt(1))){const i=RN(0,0,"");return i.dynamic=!0,i.strValue=e,i}const s=NE(e,t);return RN(s.duration,s.delay,s.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;let s,i=t.styles?t.styles:qj({});if(5==i.type)s=this.visitKeyframes(i,e);else{let o=t.styles,c=!1;if(!o){c=!0;const h={};r.easing&&(h.easing=r.easing),o=qj(h)}e.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,e);u.isEmptyStep=c,s=u}return e.currentAnimateTimings=null,{type:4,timings:r,style:s,options:null}}visitStyle(t,e){const r=this._makeStyleAst(t,e);return this._validateStyleAst(r,e),r}_makeStyleAst(t,e){const r=[],s=Array.isArray(t.styles)?t.styles:[t.styles];for(let c of s)"string"==typeof c?c===Yl?r.push(c):e.errors.push(new Ne(3002,!1)):r.push(iZ(c));let i=!1,o=null;return r.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(o=c.get("easing"),c.delete("easing")),!i))for(let u of c.values())if(u.toString().indexOf("{{")>=0){i=!0;break}}),{type:6,styles:r,easing:o,offset:t.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(t,e){const r=e.currentAnimateTimings;let s=e.currentTime,i=e.currentTime;r&&i>0&&(i-=r.duration+r.delay),t.styles.forEach(o=>{"string"!=typeof o&&o.forEach((c,u)=>{const h=e.collectedStyles.get(e.currentQuerySelector),g=h.get(u);let m=!0;g&&(i!=s&&i>=g.startTime&&s<=g.endTime&&(e.errors.push(function A9e(n,t,e,r,s){return new Ne(3010,!1)}()),m=!1),i=g.startTime),m&&h.set(u,{startTime:i,endTime:s}),e.options&&function ade(n,t,e){const r=t.params||{},s=lZ(n);s.length&&s.forEach(i=>{r.hasOwnProperty(i)||e.push(function E9e(n){return new Ne(3001,!1)}())})}(c,e.options,e.errors)})})}visitKeyframes(t,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function N9e(){return new Ne(3011,!1)}()),r;let i=0;const o=[];let c=!1,u=!1,h=0;const g=t.steps.map(oe=>{const Ee=this._makeStyleAst(oe,e);let ne=null!=Ee.offset?Ee.offset:function Sde(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(Ee.styles),ke=0;return null!=ne&&(i++,ke=Ee.offset=ne),u=u||ke<0||ke>1,c=c||ke<h,h=ke,o.push(ke),Ee});u&&e.errors.push(function I9e(){return new Ne(3012,!1)}()),c&&e.errors.push(function x9e(){return new Ne(3200,!1)}());const m=t.steps.length;let E=0;i>0&&i<m?e.errors.push(function k9e(){return new Ne(3202,!1)}()):0==i&&(E=1/(m-1));const O=m-1,k=e.currentTime,U=e.currentAnimateTimings,j=U.duration;return g.forEach((oe,Ee)=>{const ne=E>0?Ee==O?1:E*Ee:o[Ee],ke=ne*j;e.currentTime=k+U.delay+ke,U.duration=ke,this._validateStyleAst(oe,e),oe.offset=ne,r.styles.push(oe)}),r}visitReference(t,e){return{type:8,animation:Xa(this,lg(t.animation),e),options:Ku(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:Ku(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Ku(t.options)}}visitQuery(t,e){const r=e.currentQuerySelector,s=t.options||{};e.queryCount++,e.currentQuery=t;const[i,o]=function yde(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(vde,"")),n=n.replace(/@\*/g,AE).replace(/@\w+/g,e=>AE+"-"+e.slice(1)).replace(/:animating/g,NN),[n,t]}(t.selector);e.currentQuerySelector=r.length?r+" "+i:i,Ka(e.collectedStyles,e.currentQuerySelector,new Map);const c=Xa(this,lg(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:i,limit:s.limit||0,optional:!!s.optional,includeSelf:o,animation:c,originalSelector:t.selector,options:Ku(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function L9e(){return new Ne(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:NE(t.timings,e.errors,!0);return{type:12,animation:Xa(this,lg(t.animation),e),timings:r,options:null}}}class Mde{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Ku(n){return n?(n=cg(n)).params&&(n.params=function Ede(n){return n?cg(n):null}(n.params)):n={},n}function RN(n,t,e){return{duration:n,delay:t,easing:e}}function DN(n,t,e,r,s,i,o=null,c=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:r,duration:s,delay:i,totalTime:s+i,easing:o,subTimeline:c}}class zE{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const Ode=new RegExp(":enter","g"),Ade=new RegExp(":leave","g");function zN(n,t,e,r,s,i=new Map,o=new Map,c,u,h=[]){return(new Nde).buildKeyframes(n,t,e,r,s,i,o,c,u,h)}class Nde{buildKeyframes(t,e,r,s,i,o,c,u,h,g=[]){h=h||new zE;const m=new VN(t,e,h,s,i,g,[]);m.options=u;const E=u.delay?Kl(u.delay):0;m.currentTimeline.delayNextStep(E),m.currentTimeline.setStyles([o],null,m.errors,u),Xa(this,r,m);const O=m.timelines.filter(k=>k.containsAnimation());if(O.length&&c.size){let k;for(let U=O.length-1;U>=0;U--){const j=O[U];if(j.element===e){k=j;break}}k&&!k.allowOnlyTimelineStyles()&&k.setStyles([c],null,m.errors,u)}return O.length?O.map(k=>k.buildKeyframes()):[DN(e,[],[],[],0,E,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const r=e.subInstructions.get(e.element);if(r){const s=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(r,s,s.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const r=e.createSubContext(t.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,r),this.visitReference(t.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,r){for(const s of t){const i=s?.delay;if(i){const o="number"==typeof i?i:Kl(ug(i,s?.params??{},e.errors));r.delayNextStep(o)}}}_visitSubInstructions(t,e,r){let i=e.currentTimeline.currentTime;const o=null!=r.duration?Kl(r.duration):null,c=null!=r.delay?Kl(r.delay):null;return 0!==o&&t.forEach(u=>{const h=e.appendInstructionToTimeline(u,o,c);i=Math.max(i,h.duration+h.delay)}),i}visitReference(t,e){e.updateOptions(t.options,!0),Xa(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const r=e.subContextCount;let s=e;const i=t.options;if(i&&(i.params||i.delay)&&(s=e.createSubContext(i),s.transformIntoNewTimeline(),null!=i.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=VE);const o=Kl(i.delay);s.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>Xa(this,o,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>r&&s.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const r=[];let s=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?Kl(t.options.delay):0;t.steps.forEach(o=>{const c=e.createSubContext(t.options);i&&c.delayNextStep(i),Xa(this,o,c),s=Math.max(s,c.currentTimeline.currentTime),r.push(c.currentTimeline)}),r.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(s),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const r=t.strValue;return NE(e.params?ug(r,e.params,e.errors):r,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const r=e.currentAnimateTimings=this._visitTiming(t.timings,e),s=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),s.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(r.duration),this.visitStyle(i,e),s.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const r=e.currentTimeline,s=e.currentAnimateTimings;!s&&r.hasCurrentStyleProperties()&&r.forwardFrame();const i=s&&s.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(i):r.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const r=e.currentAnimateTimings,s=e.currentTimeline.duration,i=r.duration,c=e.createSubContext().currentTimeline;c.easing=r.easing,t.styles.forEach(u=>{c.forwardTime((u.offset||0)*i),c.setStyles(u.styles,u.easing,e.errors,e.options),c.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(c),e.transformIntoNewTimeline(s+i),e.previousNode=t}visitQuery(t,e){const r=e.currentTimeline.currentTime,s=t.options||{},i=s.delay?Kl(s.delay):0;i&&(6===e.previousNode.type||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=VE);let o=r;const c=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!s.optional,e.errors);e.currentQueryTotal=c.length;let u=null;c.forEach((h,g)=>{e.currentQueryIndex=g;const m=e.createSubContext(t.options,h);i&&m.delayNextStep(i),h===e.element&&(u=m.currentTimeline),Xa(this,t.animation,m),m.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,m.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),u&&(e.currentTimeline.mergeTimelineCollectedStyles(u),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const r=e.parentContext,s=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),c=o*(e.currentQueryTotal-1);let u=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":u=c-u;break;case"full":u=r.currentStaggerTime}const g=e.currentTimeline;u&&g.delayNextStep(u);const m=g.currentTime;Xa(this,t.animation,e),e.previousNode=t,r.currentStaggerTime=s.currentTime-m+(s.startTime-r.currentTimeline.startTime)}}const VE={};class VN{constructor(t,e,r,s,i,o,c,u){this._driver=t,this.element=e,this.subInstructions=r,this._enterClassName=s,this._leaveClassName=i,this.errors=o,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=VE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new HE(this._driver,e,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const r=t;let s=this.options;null!=r.duration&&(s.duration=Kl(r.duration)),null!=r.delay&&(s.delay=Kl(r.delay));const i=r.params;if(i){let o=s.params;o||(o=this.options.params={}),Object.keys(i).forEach(c=>{(!e||!o.hasOwnProperty(c))&&(o[c]=ug(i[c],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const r=t.params={};Object.keys(e).forEach(s=>{r[s]=e[s]})}}return t}createSubContext(t=null,e,r){const s=e||this.element,i=new VN(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,r||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=VE,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,r){const s={duration:e??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},i=new Ide(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,s,t.stretchStartingKeyframe);return this.timelines.push(i),s}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,r,s,i,o){let c=[];if(s&&c.push(this.element),t.length>0){t=(t=t.replace(Ode,"."+this._enterClassName)).replace(Ade,"."+this._leaveClassName);let h=this._driver.query(this.element,t,1!=r);0!==r&&(h=r<0?h.slice(h.length+r,h.length):h.slice(0,r)),c.push(...h)}return!i&&0==c.length&&o.push(function R9e(n){return new Ne(3014,!1)}()),c}}class HE{constructor(t,e,r,s){this._driver=t,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new HE(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||Yl),this._currentKeyframe.set(e,Yl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,r,s){e&&this._previousKeyframe.set("easing",e);const i=s&&s.params||{},o=function xde(n,t){const e=new Map;let r;return n.forEach(s=>{if("*"===s){r=r||t.keys();for(let i of r)e.set(i,Yl)}else q0(s,e)}),e}(t,this._globalTimelineStyles);for(let[c,u]of o){const h=ug(u,i,r);this._pendingStyles.set(c,h),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??Yl),this._updateStyle(c,h)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,r)=>{const s=this._styleSummary.get(r);(!s||e.time>s.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((c,u)=>{const h=q0(c,new Map,this._backFill);h.forEach((g,m)=>{"!"===g?t.add(m):g===Yl&&e.add(m)}),r||h.set("offset",u/this.duration),s.push(h)});const i=t.size?IE(t.values()):[],o=e.size?IE(e.values()):[];if(r){const c=s[0],u=new Map(c);c.set("offset",0),u.set("offset",1),s=[c,u]}return DN(this.element,s,i,o,this.duration,this.startTime,this.easing,!1)}}class Ide extends HE{constructor(t,e,r,s,i,o,c=!1){super(t,e,o.delay),this.keyframes=r,this.preStyleProps=s,this.postStyleProps=i,this._stretchStartingKeyframe=c,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:r,easing:s}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],o=r+e,c=e/o,u=q0(t[0]);u.set("offset",0),i.push(u);const h=q0(t[0]);h.set("offset",pZ(c)),i.push(h);const g=t.length-1;for(let m=1;m<=g;m++){let E=q0(t[m]);const O=E.get("offset");E.set("offset",pZ((e+O*r)/o)),i.push(E)}r=o,e=0,s="",t=i}return DN(this.element,t,this.preStyleProps,this.postStyleProps,r,e,s,!0)}}function pZ(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class HN{}const kde=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Lde extends HN{normalizePropertyName(t,e){return kN(t)}normalizeStyleValue(t,e,r,s){let i="";const o=r.toString().trim();if(kde.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)i="px";else{const c=r.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&s.push(function P9e(n,t){return new Ne(3005,!1)}())}return o+i}}function gZ(n,t,e,r,s,i,o,c,u,h,g,m,E){return{type:0,element:n,triggerName:t,isRemovalTransition:s,fromState:e,fromStyles:i,toState:r,toStyles:o,timelines:c,queriedElements:u,preStyleProps:h,postStyleProps:g,totalTime:m,errors:E}}const FN={};class mZ{constructor(t,e,r){this._triggerName=t,this.ast=e,this._stateStyles=r}match(t,e,r,s){return function Rde(n,t,e,r,s){return n.some(i=>i(t,e,r,s))}(this.ast.matchers,t,e,r,s)}buildStyles(t,e,r){let s=this._stateStyles.get("*");return void 0!==t&&(s=this._stateStyles.get(t?.toString())||s),s?s.buildStyles(e,r):new Map}build(t,e,r,s,i,o,c,u,h,g){const m=[],E=this.ast.options&&this.ast.options.params||FN,k=this.buildStyles(r,c&&c.params||FN,m),U=u&&u.params||FN,j=this.buildStyles(s,U,m),oe=new Set,Ee=new Map,ne=new Map,ke="void"===s,Ue={params:Dde(U,E),delay:this.ast.options?.delay},et=g?[]:zN(t,e,this.ast.animation,i,o,k,j,Ue,h,m);let Bt=0;if(et.forEach(x1=>{Bt=Math.max(x1.duration+x1.delay,Bt)}),m.length)return gZ(e,this._triggerName,r,s,ke,k,j,[],[],Ee,ne,Bt,m);et.forEach(x1=>{const bn=x1.element,L6=Ka(Ee,bn,new Set);x1.preStyleProps.forEach(ka=>L6.add(ka));const r3=Ka(ne,bn,new Set);x1.postStyleProps.forEach(ka=>r3.add(ka)),bn!==e&&oe.add(bn)});const B1=IE(oe.values());return gZ(e,this._triggerName,r,s,ke,k,j,et,B1,Ee,ne,Bt)}}function Dde(n,t){const e=cg(t);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(e[r]=n[r]);return e}class zde{constructor(t,e,r){this.styles=t,this.defaultParams=e,this.normalizer=r}buildStyles(t,e){const r=new Map,s=cg(this.defaultParams);return Object.keys(t).forEach(i=>{const o=t[i];null!==o&&(s[i]=o)}),this.styles.styles.forEach(i=>{"string"!=typeof i&&i.forEach((o,c)=>{o&&(o=ug(o,s,e));const u=this.normalizer.normalizePropertyName(c,e);o=this.normalizer.normalizeStyleValue(c,u,o,e),r.set(u,o)})}),r}}class Hde{constructor(t,e,r){this.name=t,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(s=>{this.states.set(s.name,new zde(s.style,s.options&&s.options.params||{},r))}),_Z(this.states,"true","1"),_Z(this.states,"false","0"),e.transitions.forEach(s=>{this.transitionFactories.push(new mZ(t,s,this.states))}),this.fallbackTransition=function Fde(n,t,e){return new mZ(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,c)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,r,s){return this.transitionFactories.find(o=>o.match(t,e,r,s))||null}matchStyles(t,e,r){return this.fallbackTransition.buildStyles(t,e,r)}}function _Z(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const Bde=new zE;class $de{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const r=[],i=LN(this._driver,e,r,[]);if(r.length)throw function $9e(n){return new Ne(3503,!1)}();this._animations.set(t,i)}_buildPlayer(t,e,r){const s=t.element,i=Yj(0,this._normalizer,0,t.keyframes,e,r);return this._driver.animate(s,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,r={}){const s=[],i=this._animations.get(t);let o;const c=new Map;if(i?(o=zN(this._driver,e,i,AN,OE,new Map,new Map,r,Bde,s),o.forEach(g=>{const m=Ka(c,g.element,new Map);g.postStyleProps.forEach(E=>m.set(E,null))})):(s.push(function U9e(){return new Ne(3300,!1)}()),o=[]),s.length)throw function G9e(n){return new Ne(3504,!1)}();c.forEach((g,m)=>{g.forEach((E,O)=>{g.set(O,this._driver.computeStyle(m,O,Yl))})});const h=G0(o.map(g=>{const m=c.get(g.element);return this._buildPlayer(g,new Map,m)}));return this._playersById.set(t,h),h.onDestroy(()=>this.destroy(t)),this.players.push(h),h}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function q9e(n){return new Ne(3301,!1)}();return e}listen(t,e,r,s){const i=TN(e,"","","");return SN(this._getPlayer(t),r,i,s),()=>{}}command(t,e,r,s){if("register"==r)return void this.register(t,s[0]);if("create"==r)return void this.create(t,e,s[0]||{});const i=this._getPlayer(t);switch(r){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(t)}}}const vZ="ng-animate-queued",BN="ng-animate-disabled",jde=[],CZ={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Zde={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Lc="__ng_removed";class $N{constructor(t,e=""){this.namespaceId=e;const r=t&&t.hasOwnProperty("value");if(this.value=function Qde(n){return n??null}(r?t.value:t),r){const i=cg(t);delete i.value,this.options=i}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const r=this.options.params;Object.keys(e).forEach(s=>{null==r[s]&&(r[s]=e[s])})}}}const fg="void",UN=new $N(fg);class Yde{constructor(t,e,r){this.id=t,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Rc(e,this._hostClassName)}listen(t,e,r,s){if(!this._triggers.has(e))throw function W9e(n,t){return new Ne(3302,!1)}();if(null==r||0==r.length)throw function j9e(n){return new Ne(3303,!1)}();if(!function Jde(n){return"start"==n||"done"==n}(r))throw function Z9e(n,t){return new Ne(3400,!1)}();const i=Ka(this._elementListeners,t,[]),o={name:e,phase:r,callback:s};i.push(o);const c=Ka(this._engine.statesByElement,t,new Map);return c.has(e)||(Rc(t,bE),Rc(t,bE+"-"+e),c.set(e,UN)),()=>{this._engine.afterFlush(()=>{const u=i.indexOf(o);u>=0&&i.splice(u,1),this._triggers.has(e)||c.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function Y9e(n){return new Ne(3401,!1)}();return e}trigger(t,e,r,s=!0){const i=this._getTrigger(e),o=new GN(this.id,e,t);let c=this._engine.statesByElement.get(t);c||(Rc(t,bE),Rc(t,bE+"-"+e),this._engine.statesByElement.set(t,c=new Map));let u=c.get(e);const h=new $N(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&h.absorbOptions(u.options),c.set(e,h),u||(u=UN),h.value!==fg&&u.value===h.value){if(!function npe(n,t){const e=Object.keys(n),r=Object.keys(t);if(e.length!=r.length)return!1;for(let s=0;s<e.length;s++){const i=e[s];if(!t.hasOwnProperty(i)||n[i]!==t[i])return!1}return!0}(u.params,h.params)){const U=[],j=i.matchStyles(u.value,u.params,U),oe=i.matchStyles(h.value,h.params,U);U.length?this._engine.reportError(U):this._engine.afterFlush(()=>{Yu(t,j),L4(t,oe)})}return}const E=Ka(this._engine.playersByElement,t,[]);E.forEach(U=>{U.namespaceId==this.id&&U.triggerName==e&&U.queued&&U.destroy()});let O=i.matchTransition(u.value,h.value,t,h.params),k=!1;if(!O){if(!s)return;O=i.fallbackTransition,k=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:O,fromState:u,toState:h,player:o,isFallbackTransition:k}),k||(Rc(t,vZ),o.onStart(()=>{$f(t,vZ)})),o.onDone(()=>{let U=this.players.indexOf(o);U>=0&&this.players.splice(U,1);const j=this._engine.playersByElement.get(t);if(j){let oe=j.indexOf(o);oe>=0&&j.splice(oe,1)}}),this.players.push(o),E.push(o),o}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(s=>s.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const r=this._engine.driver.query(t,AE,!0);r.forEach(s=>{if(s[Lc])return;const i=this._engine.fetchNamespacesByElement(s);i.size?i.forEach(o=>o.triggerLeaveAnimation(s,e,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(t,e,r,s){const i=this._engine.statesByElement.get(t),o=new Map;if(i){const c=[];if(i.forEach((u,h)=>{if(o.set(h,u.value),this._triggers.has(h)){const g=this.trigger(t,h,fg,s);g&&c.push(g)}}),c.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),r&&G0(c).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(e&&r){const s=new Set;e.forEach(i=>{const o=i.name;if(s.has(o))return;s.add(o);const u=this._triggers.get(o).fallbackTransition,h=r.get(o)||UN,g=new $N(fg),m=new GN(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:u,fromState:h,toState:g,player:m,isFallbackTransition:!0})})}}removeNode(t,e){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let s=!1;if(r.totalAnimations){const i=r.players.length?r.playersByQueriedElement.get(t):[];if(i&&i.length)s=!0;else{let o=t;for(;o=o.parentNode;)if(r.statesByElement.get(o)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(t),s)r.markElementAsRemoved(this.id,t,!1,e);else{const i=t[Lc];(!i||i===CZ)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}insertNode(t,e){Rc(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(r=>{const s=r.player;if(s.destroyed)return;const i=r.element,o=this._elementListeners.get(i);o&&o.forEach(c=>{if(c.name==r.triggerName){const u=TN(i,r.triggerName,r.fromState.value,r.toState.value);u._data=t,SN(r.player,c.phase,u,c.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):e.push(r)}),this._queue=[],e.sort((r,s)=>{const i=r.transition.ast.depCount,o=s.transition.ast.depCount;return 0==i||0==o?i-o:this._engine.driver.containsElement(r.element,s.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(r=>r.element===t)||e,e}}class Kde{constructor(t,e,r){this.bodyNode=t,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,i)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,e){const r=new Yde(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,e){const r=this._namespaceList,s=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,c=this.driver.getParentElement(e);for(;c;){const u=s.get(c);if(u){const h=r.indexOf(u);r.splice(h+1,0,t),o=!0;break}c=this.driver.getParentElement(c)}o||r.unshift(t)}else r.push(t);return s.set(e,t),t}register(t,e){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,e)),r}registerTrigger(t,e,r){let s=this._namespaceLookup[t];s&&s.register(e,r)&&this.totalAnimations++}destroy(t,e){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const s=this._namespaceList.indexOf(r);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,r=this.statesByElement.get(t);if(r)for(let s of r.values())if(s.namespaceId){const i=this._fetchNamespace(s.namespaceId);i&&e.add(i)}return e}trigger(t,e,r,s){if(FE(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,r,s),!0}return!1}insertNode(t,e,r,s){if(!FE(e))return;const i=e[Lc];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(e,r)}s&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Rc(t,BN)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),$f(t,BN))}removeNode(t,e,r,s){if(FE(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,s):this.markElementAsRemoved(t,e,!1,s),r){const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,s)}}else this._onRemovalComplete(e,s)}markElementAsRemoved(t,e,r,s,i){this.collectedLeaveElements.push(e),e[Lc]={namespaceId:t,setForRemoval:s,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:i}}listen(t,e,r,s,i){return FE(e)?this._fetchNamespace(t).listen(e,r,s,i):()=>{}}_buildInstruction(t,e,r,s,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,s,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,AE,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,NN,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return G0(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[Lc];if(e&&e.setForRemoval){if(t[Lc]=CZ,e.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(BN)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,s)=>this._balanceNamespaceList(r,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)Rc(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,t)}finally{for(let s=0;s<r.length;s++)r[s]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?G0(e).onDone(()=>{r.forEach(s=>s())}):r.forEach(s=>s())}}reportError(t){throw function K9e(n){return new Ne(3402,!1)}()}_flushAnimations(t,e){const r=new zE,s=[],i=new Map,o=[],c=new Map,u=new Map,h=new Map,g=new Set;this.disabledNodes.forEach(St=>{g.add(St);const Wt=this.driver.query(St,".ng-animate-queued",!0);for(let en=0;en<Wt.length;en++)g.add(Wt[en])});const m=this.bodyNode,E=Array.from(this.statesByElement.keys()),O=MZ(E,this.collectedEnterElements),k=new Map;let U=0;O.forEach((St,Wt)=>{const en=AN+U++;k.set(Wt,en),St.forEach(i1=>Rc(i1,en))});const j=[],oe=new Set,Ee=new Set;for(let St=0;St<this.collectedLeaveElements.length;St++){const Wt=this.collectedLeaveElements[St],en=Wt[Lc];en&&en.setForRemoval&&(j.push(Wt),oe.add(Wt),en.hasAnimation?this.driver.query(Wt,".ng-star-inserted",!0).forEach(i1=>oe.add(i1)):Ee.add(Wt))}const ne=new Map,ke=MZ(E,Array.from(oe));ke.forEach((St,Wt)=>{const en=OE+U++;ne.set(Wt,en),St.forEach(i1=>Rc(i1,en))}),t.push(()=>{O.forEach((St,Wt)=>{const en=k.get(Wt);St.forEach(i1=>$f(i1,en))}),ke.forEach((St,Wt)=>{const en=ne.get(Wt);St.forEach(i1=>$f(i1,en))}),j.forEach(St=>{this.processLeaveNode(St)})});const Ue=[],et=[];for(let St=this._namespaceList.length-1;St>=0;St--)this._namespaceList[St].drainQueuedTransitions(e).forEach(en=>{const i1=en.player,Zt=en.element;if(Ue.push(i1),this.collectedEnterElements.length){const Co=Zt[Lc];if(Co&&Co.setForMove){if(Co.previousTriggersValues&&Co.previousTriggersValues.has(en.triggerName)){const X5=Co.previousTriggersValues.get(en.triggerName),s3=this.statesByElement.get(en.element);if(s3&&s3.has(en.triggerName)){const pT=s3.get(en.triggerName);pT.value=X5,s3.set(en.triggerName,pT)}}return void i1.destroy()}}const al=!m||!this.driver.containsElement(m,Zt),mc=ne.get(Zt),x8=k.get(Zt),os=this._buildInstruction(en,r,x8,mc,al);if(os.errors&&os.errors.length)return void et.push(os);if(al)return i1.onStart(()=>Yu(Zt,os.fromStyles)),i1.onDestroy(()=>L4(Zt,os.toStyles)),void s.push(i1);if(en.isFallbackTransition)return i1.onStart(()=>Yu(Zt,os.fromStyles)),i1.onDestroy(()=>L4(Zt,os.toStyles)),void s.push(i1);const A4e=[];os.timelines.forEach(Co=>{Co.stretchStartingKeyframe=!0,this.disabledNodes.has(Co.element)||A4e.push(Co)}),os.timelines=A4e,r.append(Zt,os.timelines),o.push({instruction:os,player:i1,element:Zt}),os.queriedElements.forEach(Co=>Ka(c,Co,[]).push(i1)),os.preStyleProps.forEach((Co,X5)=>{if(Co.size){let s3=u.get(X5);s3||u.set(X5,s3=new Set),Co.forEach((pT,gF)=>s3.add(gF))}}),os.postStyleProps.forEach((Co,X5)=>{let s3=h.get(X5);s3||h.set(X5,s3=new Set),Co.forEach((pT,gF)=>s3.add(gF))})});if(et.length){const St=[];et.forEach(Wt=>{St.push(function X9e(n,t){return new Ne(3505,!1)}())}),Ue.forEach(Wt=>Wt.destroy()),this.reportError(St)}const Bt=new Map,B1=new Map;o.forEach(St=>{const Wt=St.element;r.has(Wt)&&(B1.set(Wt,Wt),this._beforeAnimationBuild(St.player.namespaceId,St.instruction,Bt))}),s.forEach(St=>{const Wt=St.element;this._getPreviousPlayers(Wt,!1,St.namespaceId,St.triggerName,null).forEach(i1=>{Ka(Bt,Wt,[]).push(i1),i1.destroy()})});const x1=j.filter(St=>PZ(St,u,h)),bn=new Map;EZ(bn,this.driver,Ee,h,Yl).forEach(St=>{PZ(St,u,h)&&x1.push(St)});const r3=new Map;O.forEach((St,Wt)=>{EZ(r3,this.driver,new Set(St),u,"!")}),x1.forEach(St=>{const Wt=bn.get(St),en=r3.get(St);bn.set(St,new Map([...Array.from(Wt?.entries()??[]),...Array.from(en?.entries()??[])]))});const ka=[],R6=[],D6={};o.forEach(St=>{const{element:Wt,player:en,instruction:i1}=St;if(r.has(Wt)){if(g.has(Wt))return en.onDestroy(()=>L4(Wt,i1.toStyles)),en.disabled=!0,en.overrideTotalTime(i1.totalTime),void s.push(en);let Zt=D6;if(B1.size>1){let mc=Wt;const x8=[];for(;mc=mc.parentNode;){const os=B1.get(mc);if(os){Zt=os;break}x8.push(mc)}x8.forEach(os=>B1.set(os,Zt))}const al=this._buildAnimation(en.namespaceId,i1,Bt,i,r3,bn);if(en.setRealPlayer(al),Zt===D6)ka.push(en);else{const mc=this.playersByElement.get(Zt);mc&&mc.length&&(en.parentPlayer=G0(mc)),s.push(en)}}else Yu(Wt,i1.fromStyles),en.onDestroy(()=>L4(Wt,i1.toStyles)),R6.push(en),g.has(Wt)&&s.push(en)}),R6.forEach(St=>{const Wt=i.get(St.element);if(Wt&&Wt.length){const en=G0(Wt);St.setRealPlayer(en)}}),s.forEach(St=>{St.parentPlayer?St.syncPlayerEvents(St.parentPlayer):St.destroy()});for(let St=0;St<j.length;St++){const Wt=j[St],en=Wt[Lc];if($f(Wt,OE),en&&en.hasAnimation)continue;let i1=[];if(c.size){let al=c.get(Wt);al&&al.length&&i1.push(...al);let mc=this.driver.query(Wt,NN,!0);for(let x8=0;x8<mc.length;x8++){let os=c.get(mc[x8]);os&&os.length&&i1.push(...os)}}const Zt=i1.filter(al=>!al.destroyed);Zt.length?epe(this,Wt,Zt):this.processLeaveNode(Wt)}return j.length=0,ka.forEach(St=>{this.players.push(St),St.onDone(()=>{St.destroy();const Wt=this.players.indexOf(St);this.players.splice(Wt,1)}),St.play()}),ka}elementContainsData(t,e){let r=!1;const s=e[Lc];return s&&s.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(t).elementContainsData(e)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,r,s,i){let o=[];if(e){const c=this.playersByQueriedElement.get(t);c&&(o=c)}else{const c=this.playersByElement.get(t);if(c){const u=!i||i==fg;c.forEach(h=>{h.queued||!u&&h.triggerName!=s||o.push(h)})}}return(r||s)&&(o=o.filter(c=>!(r&&r!=c.namespaceId||s&&s!=c.triggerName))),o}_beforeAnimationBuild(t,e,r){const i=e.element,o=e.isRemovalTransition?void 0:t,c=e.isRemovalTransition?void 0:e.triggerName;for(const u of e.timelines){const h=u.element,g=h!==i,m=Ka(r,h,[]);this._getPreviousPlayers(h,g,o,c,e.toState).forEach(O=>{const k=O.getRealPlayer();k.beforeDestroy&&k.beforeDestroy(),O.destroy(),m.push(O)})}Yu(i,e.fromStyles)}_buildAnimation(t,e,r,s,i,o){const c=e.triggerName,u=e.element,h=[],g=new Set,m=new Set,E=e.timelines.map(k=>{const U=k.element;g.add(U);const j=U[Lc];if(j&&j.removedBeforeQueried)return new ag(k.duration,k.delay);const oe=U!==u,Ee=function tpe(n){const t=[];return SZ(n,t),t}((r.get(U)||jde).map(Bt=>Bt.getRealPlayer())).filter(Bt=>!!Bt.element&&Bt.element===U),ne=i.get(U),ke=o.get(U),Ue=Yj(0,this._normalizer,0,k.keyframes,ne,ke),et=this._buildPlayer(k,Ue,Ee);if(k.subTimeline&&s&&m.add(U),oe){const Bt=new GN(t,c,U);Bt.setRealPlayer(et),h.push(Bt)}return et});h.forEach(k=>{Ka(this.playersByQueriedElement,k.element,[]).push(k),k.onDone(()=>function Xde(n,t,e){let r=n.get(t);if(r){if(r.length){const s=r.indexOf(e);r.splice(s,1)}0==r.length&&n.delete(t)}return r}(this.playersByQueriedElement,k.element,k))}),g.forEach(k=>Rc(k,sZ));const O=G0(E);return O.onDestroy(()=>{g.forEach(k=>$f(k,sZ)),L4(u,e.toStyles)}),m.forEach(k=>{Ka(s,k,[]).push(O)}),O}_buildPlayer(t,e,r){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,r):new ag(t.duration,t.delay)}}class GN{constructor(t,e,r){this.namespaceId=t,this.triggerName=e,this.element=r,this._player=new ag,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,r)=>{e.forEach(s=>SN(t,r,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Ka(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function FE(n){return n&&1===n.nodeType}function yZ(n,t){const e=n.style.display;return n.style.display=t??"none",e}function EZ(n,t,e,r,s){const i=[];e.forEach(u=>i.push(yZ(u)));const o=[];r.forEach((u,h)=>{const g=new Map;u.forEach(m=>{const E=t.computeStyle(h,m,s);g.set(m,E),(!E||0==E.length)&&(h[Lc]=Zde,o.push(h))}),n.set(h,g)});let c=0;return e.forEach(u=>yZ(u,i[c++])),o}function MZ(n,t){const e=new Map;if(n.forEach(c=>e.set(c,[])),0==t.length)return e;const s=new Set(t),i=new Map;function o(c){if(!c)return 1;let u=i.get(c);if(u)return u;const h=c.parentNode;return u=e.has(h)?h:s.has(h)?1:o(h),i.set(c,u),u}return t.forEach(c=>{const u=o(c);1!==u&&e.get(u).push(c)}),e}function Rc(n,t){n.classList?.add(t)}function $f(n,t){n.classList?.remove(t)}function epe(n,t,e){G0(e).onDone(()=>n.processLeaveNode(t))}function SZ(n,t){for(let e=0;e<n.length;e++){const r=n[e];r instanceof jj?SZ(r.players,t):t.push(r)}}function PZ(n,t,e){const r=e.get(n);if(!r)return!1;let s=t.get(n);return s?r.forEach(i=>s.add(i)):t.set(n,r),e.delete(n),!0}class BE{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(s,i)=>{},this._transitionEngine=new Kde(t,e,r),this._timelineEngine=new $de(t,e,r),this._transitionEngine.onRemovalComplete=(s,i)=>this.onRemovalComplete(s,i)}registerTrigger(t,e,r,s,i){const o=t+"-"+s;let c=this._triggerCache[o];if(!c){const u=[],g=LN(this._driver,i,u,[]);if(u.length)throw function F9e(n,t){return new Ne(3404,!1)}();c=function Vde(n,t,e){return new Hde(n,t,e)}(s,g,this._normalizer),this._triggerCache[o]=c}this._transitionEngine.registerTrigger(e,s,c)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,r,s){this._transitionEngine.insertNode(t,e,r,s)}onRemove(t,e,r,s){this._transitionEngine.removeNode(t,e,s||!1,r)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,r,s){if("@"==r.charAt(0)){const[i,o]=Kj(r);this._timelineEngine.command(i,e,o,s)}else this._transitionEngine.trigger(t,e,r,s)}listen(t,e,r,s,i){if("@"==r.charAt(0)){const[o,c]=Kj(r);return this._timelineEngine.listen(o,e,c,i)}return this._transitionEngine.listen(t,e,r,s,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let spe=(()=>{class n{constructor(e,r,s){this._element=e,this._startStyles=r,this._endStyles=s,this._state=0;let i=n.initialStylesByElement.get(e);i||n.initialStylesByElement.set(e,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&L4(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(L4(this._element,this._initialStyles),this._endStyles&&(L4(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Yu(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Yu(this._element,this._endStyles),this._endStyles=null),L4(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function qN(n){let t=null;return n.forEach((e,r)=>{(function ipe(n){return"display"===n||"position"===n})(r)&&(t=t||new Map,t.set(r,e))}),t}class TZ{constructor(t,e,r,s){this.element=t,this.keyframes=e,this.options=r,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(t,e,r){return t.animate(this._convertKeyframesToObject(e),r)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,s)=>{"offset"!==s&&t.set(s,this._finished?r:uZ(this.element,s))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class ope{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return eZ(t,e)}getParentElement(t){return ON(t)}query(t,e,r){return tZ(t,e,r)}computeStyle(t,e,r){return window.getComputedStyle(t)[e]}animate(t,e,r,s,i,o=[]){const u={duration:r,delay:s,fill:0==s?"both":"forwards"};i&&(u.easing=i);const h=new Map,g=o.filter(O=>O instanceof TZ);(function ude(n,t){return 0===n||0===t})(r,s)&&g.forEach(O=>{O.currentSnapshot.forEach((k,U)=>h.set(U,k))});let m=function ode(n){return n.length?n[0]instanceof Map?n:n.map(t=>iZ(t)):[]}(e).map(O=>q0(O));m=function fde(n,t,e){if(e.size&&t.length){let r=t[0],s=[];if(e.forEach((i,o)=>{r.has(o)||s.push(o),r.set(o,i)}),s.length)for(let i=1;i<t.length;i++){let o=t[i];s.forEach(c=>o.set(c,uZ(n,c)))}}return t}(t,m,h);const E=function rpe(n,t){let e=null,r=null;return Array.isArray(t)&&t.length?(e=qN(t[0]),t.length>1&&(r=qN(t[t.length-1]))):t instanceof Map&&(e=qN(t)),e||r?new spe(n,e,r):null}(t,m);return new TZ(t,m,u,E)}}let ape=(()=>{class n extends Uj{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:$1.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(e)?Gj(e):e;return wZ(this._renderer,null,r,"register",[s]),new cpe(r,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(ze(y0),ze(Gs))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class cpe extends class v9e{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new lpe(this._id,t,e||{},this._renderer)}}class lpe{constructor(t,e,r,s){this.id=t,this.element=e,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return wZ(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function wZ(n,t,e,r,s){return n.setProperty(t,`@@${e}:${r}`,s)}const OZ="@.disabled";let upe=(()=>{class n{constructor(e,r,s){this.delegate=e,this.engine=r,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(i,o)=>{const c=o?.parentNode(i);c&&o.removeChild(c,i)}}createRenderer(e,r){const i=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let g=this._rendererCache.get(i);return g||(g=new bZ("",i,this.engine,()=>this._rendererCache.delete(i)),this._rendererCache.set(i,g)),g}const o=r.id,c=r.id+"-"+this._currentId;this._currentId++,this.engine.register(c,e);const u=g=>{Array.isArray(g)?g.forEach(u):this.engine.registerTrigger(o,c,e,g.name,g)};return r.data.animation.forEach(u),new fpe(this,c,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,s){e>=0&&e<this._microtaskId?this._zone.run(()=>r(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(i=>{const[o,c]=i;o(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(ze(y0),ze(BE),ze(wr))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class bZ{constructor(t,e,r,s){this.namespaceId=t,this.delegate=e,this.engine=r,this._onDestroy=s,this.destroyNode=this.delegate.destroyNode?i=>e.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,r,s=!0){this.delegate.insertBefore(t,e,r),this.engine.onInsert(this.namespaceId,e,t,s)}removeChild(t,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,s){this.delegate.setAttribute(t,e,r,s)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,s){this.delegate.setStyle(t,e,r,s)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){"@"==e.charAt(0)&&e==OZ?this.disableAnimations(t,!!r):this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.delegate.listen(t,e,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class fpe extends bZ{constructor(t,e,r,s,i){super(e,r,s,i),this.factory=t,this.namespaceId=e}setProperty(t,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==OZ?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,e.slice(1),r):this.delegate.setProperty(t,e,r)}listen(t,e,r){if("@"==e.charAt(0)){const s=function hpe(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let i=e.slice(1),o="";return"@"!=i.charAt(0)&&([i,o]=function dpe(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(i)),this.engine.listen(this.namespaceId,s,i,o,c=>{this.factory.scheduleListenerCallback(c._data||-1,r,c)})}return this.delegate.listen(t,e,r)}}let ppe=(()=>{class n extends BE{constructor(e,r,s,i){super(e.body,r,s)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(ze(Gs),ze(bN),ze(HN),ze(Ap))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const AZ=[{provide:Uj,useClass:ape},{provide:HN,useFactory:function gpe(){return new Lde}},{provide:BE,useClass:ppe},{provide:y0,useFactory:function mpe(n,t,e){return new upe(n,t,e)},deps:[Gy,BE,wr]}],WN=[{provide:bN,useFactory:()=>new ope},{provide:GU,useValue:"BrowserAnimations"},...AZ],NZ=[{provide:bN,useClass:nZ},{provide:GU,useValue:"NoopAnimations"},...AZ];let _pe=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?NZ:WN}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:WN,imports:[cq]}),n})();const ws=void 0,Cpe=["fr",[["AM","PM"],ws,ws],ws,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],ws,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],ws,[["av. J.-C.","ap. J.-C."],ws,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",ws],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[ws,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[ws,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[ws,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[ws,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[ws,"\xa5"],KMF:[ws,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[ws,"$C"],NZD:["$NZ","$"],PHP:[ws,"\u20b1"],RHD:["$RH"],RON:[ws,"L"],RWF:[ws,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[ws,"$T"],TTD:["$TT","$"],TWD:[ws,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[ws,"$"],XPF:["FCFP"],ZMW:[ws,"Kw"]},"ltr",function vpe(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length,s=parseInt(n.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===e||1===e?1:0===s&&0!==e&&e%1e6==0&&0===r||!(s>=0&&s<=5)?4:5}];function IZ(n,t,e,r,s,i,o){try{var c=n[i](o),u=c.value}catch(h){return void e(h)}c.done?t(u):Promise.resolve(u).then(r,s)}function I(n){return function(){var t=this,e=arguments;return new Promise(function(r,s){var i=n.apply(t,e);function o(u){IZ(i,r,s,o,c,"next",u)}function c(u){IZ(i,r,s,o,c,"throw",u)}o(void 0)})}}const xZ=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=63&s|128):55296==(64512&s)&&r+1<n.length&&56320==(64512&n.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&n.charCodeAt(++r)),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=63&s|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=63&s|128)}return t},ZN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,c=o?n[s+1]:0,u=s+2<n.length,h=u?n[s+2]:0;let E=(15&c)<<2|h>>6,O=63&h;u||(O=64,o||(E=64)),r.push(e[i>>2],e[(3&i)<<4|c>>4],e[E],e[O])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(xZ(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):function(n){const t=[];let e=0,r=0;for(;e<n.length;){const s=n[e++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[e++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const u=((7&s)<<18|(63&n[e++])<<12|(63&n[e++])<<6|63&n[e++])-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(1023&u))}else{const i=n[e++],o=n[e++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=e[n.charAt(s++)],c=s<n.length?e[n.charAt(s)]:0;++s;const h=s<n.length?e[n.charAt(s)]:64;++s;const m=s<n.length?e[n.charAt(s)]:64;if(++s,null==i||null==c||null==h||null==m)throw Error();r.push(i<<2|c>>4),64!==h&&(r.push(c<<4&240|h>>2),64!==m&&r.push(h<<6&192|m))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},UE=function(n){return function(n){const t=xZ(n);return ZN.encodeByteArray(t,!0)}(n).replace(/\./g,"")},GE=function(n){try{return ZN.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function $i(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function YN(){const n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof n&&void 0!==n.id}function Xu(){return"object"==typeof indexedDB}function hg(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var i;t((null===(i=s.error)||void 0===i?void 0:i.message)||"")}}catch(e){t(e)}})}function KN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const XN=()=>{try{return function Ape(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&GE(n[1]);return t&&JSON.parse(t)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},LZ=n=>{var t,e;return null===(e=null===(t=XN())||void 0===t?void 0:t.emulatorHosts)||void 0===e?void 0:e[n]},RZ=n=>{var t;return null===(t=XN())||void 0===t?void 0:t[`_${n}`]};class qE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}class Dc extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,Dc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,R4.prototype.create)}}class R4{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?function zpe(n,t){return n.replace(Vpe,(e,r)=>{const s=t[r];return null!=s?String(s):`<${r}?>`})}(i,r):"Error";return new Dc(s,`${this.serviceName}: ${o} (${s}).`,r)}}const Vpe=/\{\$([^}]+)}/g;function jE(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const s of e){if(!r.includes(s))return!1;const i=n[s],o=t[s];if(zZ(i)&&zZ(o)){if(!jE(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!e.includes(s))return!1;return!0}function zZ(n){return null!==n&&"object"==typeof n}function dg(n){const t=[];for(const[e,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function pg(n){const t={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");t[decodeURIComponent(s)]=decodeURIComponent(i)}}),t}function gg(n){const t=n.indexOf("?");if(!t)return"";const e=n.indexOf("#",t);return n.substring(t,e>0?e:void 0)}class Bpe{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let s;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");s=function $pe(n,t){if("object"!=typeof n||null===n)return!1;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:r},void 0===s.next&&(s.next=QN),void 0===s.error&&(s.error=QN),void 0===s.complete&&(s.complete=QN);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function QN(){}function eI(n,t=1e3,e=2){const r=t*Math.pow(e,n),s=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+s)}function Jr(n){return n&&n._delegate?n._delegate:n}class no{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Qu="[DEFAULT]";class Zpe{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new qE;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const r=this.normalizeInstanceIdentifier(t?.identifier),s=null!==(e=t?.optional)&&void 0!==e&&e;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function Kpe(n){return"EAGER"===n.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:Qu})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=Qu){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return I(function*(){const e=Array.from(t.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=Qu){return this.instances.has(t)}getOptions(t=Qu){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[i,o]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(i)&&o.resolve(s);return s}onInit(t,e){var r;const s=this.normalizeInstanceIdentifier(e),i=null!==(r=this.onInitCallbacks.get(s))&&void 0!==r?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const s of r)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t,n===Qu?void 0:n),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}var n;return r||null}normalizeInstanceIdentifier(t=Qu){return this.component?this.component.multipleInstances?t:Qu:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Xpe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Zpe(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const tI=[];var g1=(()=>{return(n=g1||(g1={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",g1;var n})();const VZ={debug:g1.DEBUG,verbose:g1.VERBOSE,info:g1.INFO,warn:g1.WARN,error:g1.ERROR,silent:g1.SILENT},Qpe=g1.INFO,Jpe={[g1.DEBUG]:"log",[g1.VERBOSE]:"log",[g1.INFO]:"info",[g1.WARN]:"warn",[g1.ERROR]:"error"},ege=(n,t,...e)=>{if(t<n.logLevel)return;const r=(new Date).toISOString(),s=Jpe[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${r}]  ${n.name}:`,...e)};class Uf{constructor(t){this.name=t,this._logLevel=Qpe,this._logHandler=ege,this._userLogHandler=null,tI.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in g1))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?VZ[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,g1.DEBUG,...t),this._logHandler(this,g1.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,g1.VERBOSE,...t),this._logHandler(this,g1.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,g1.INFO,...t),this._logHandler(this,g1.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,g1.WARN,...t),this._logHandler(this,g1.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,g1.ERROR,...t),this._logHandler(this,g1.ERROR,...t)}}let HZ,FZ;const BZ=new WeakMap,nI=new WeakMap,$Z=new WeakMap,rI=new WeakMap,sI=new WeakMap;let iI={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return nI.get(n);if("objectStoreNames"===t)return n.objectStoreNames||$Z.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Xl(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function cge(n){return"function"==typeof n?function age(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function rge(){return FZ||(FZ=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...t){return n.apply(oI(this),t),Xl(BZ.get(this))}:function(...t){return Xl(n.apply(oI(this),t))}:function(t,...e){const r=n.call(oI(this),t,...e);return $Z.set(r,t.sort?t.sort():[t]),Xl(r)}}(n):(n instanceof IDBTransaction&&function ige(n){if(nI.has(n))return;const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{e(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});nI.set(n,t)}(n),((n,t)=>t.some(e=>n instanceof e))(n,function nge(){return HZ||(HZ=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,iI):n)}function Xl(n){if(n instanceof IDBRequest)return function sge(n){const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{e(Xl(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&BZ.set(e,n)}).catch(()=>{}),sI.set(t,n),t}(n);if(rI.has(n))return rI.get(n);const t=cge(n);return t!==n&&(rI.set(n,t),sI.set(t,n)),t}const oI=n=>sI.get(n);function ZE(n,t,{blocked:e,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,t),c=Xl(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Xl(o.result),u.oldVersion,u.newVersion,Xl(o.transaction))}),e&&o.addEventListener("blocked",()=>e()),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",()=>s())}).catch(()=>{}),c}function aI(n,{blocked:t}={}){const e=indexedDB.deleteDatabase(n);return t&&e.addEventListener("blocked",()=>t()),Xl(e).then(()=>{})}const lge=["get","getKey","getAll","getAllKeys","count"],uge=["put","add","delete","clear"],cI=new Map;function UZ(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(cI.get(t))return cI.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,s=uge.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!lge.includes(e))return;const i=function(){var o=I(function*(c,...u){const h=this.transaction(c,s?"readwrite":"readonly");let g=h.store;return r&&(g=g.index(u.shift())),(yield Promise.all([g[e](...u),s&&h.done]))[0]});return function(u){return o.apply(this,arguments)}}();return cI.set(t,i),i}!function oge(n){iI=n(iI)}(n=>({...n,get:(t,e,r)=>UZ(t,e)||n.get(t,e,r),has:(t,e)=>!!UZ(t,e)||n.has(t,e)}));class fge{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function hge(n){return"VERSION"===n.getComponent()?.type}(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}return null}).filter(e=>e).join(" ")}}const lI="@firebase/app",Ju=new Uf("@firebase/app"),YE="[DEFAULT]",Vge={[lI]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},e5=new Map,KE=new Map;function Hge(n,t){try{n.container.addComponent(t)}catch(e){Ju.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Vo(n){const t=n.name;if(KE.has(t))return Ju.debug(`There were multiple attempts to register component ${t}.`),!1;KE.set(t,n);for(const e of e5.values())Hge(e,n);return!0}function Gf(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}const Ql=new R4("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Bge{constructor(t,e,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new no("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ql.create("app-deleted",{appName:this._name})}}const qf="9.14.0";function qZ(n,t={}){let e=n;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:YE,automaticDataCollectionEnabled:!1},t),s=r.name;if("string"!=typeof s||!s)throw Ql.create("bad-app-name",{appName:String(s)});if(e||(e=(()=>{var n;return null===(n=XN())||void 0===n?void 0:n.config})()),!e)throw Ql.create("no-options");const i=e5.get(s);if(i){if(jE(e,i.options)&&jE(r,i.config))return i;throw Ql.create("duplicate-app",{appName:s})}const o=new Xpe(s);for(const u of KE.values())o.addComponent(u);const c=new Bge(e,r,o);return e5.set(s,c),c}function uI(n=YE){const t=e5.get(n);if(!t&&n===YE)return qZ();if(!t)throw Ql.create("no-app",{appName:n});return t}function WZ(){return Array.from(e5.values())}function fs(n,t,e){var r;let s=null!==(r=Vge[n])&&void 0!==r?r:n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${t}":`];return i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Ju.warn(c.join(" "))}Vo(new no(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const mg="firebase-heartbeat-store";let hI=null;function jZ(){return hI||(hI=ZE("firebase-heartbeat-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(mg)}}).catch(n=>{throw Ql.create("idb-open",{originalErrorMessage:n.message})})),hI}function dI(){return(dI=I(function*(n){var t;try{return(yield jZ()).transaction(mg).objectStore(mg).get(YZ(n))}catch(e){if(e instanceof Dc)Ju.warn(e.message);else{const r=Ql.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});Ju.warn(r.message)}}})).apply(this,arguments)}function ZZ(n,t){return pI.apply(this,arguments)}function pI(){return(pI=I(function*(n,t){var e;try{const s=(yield jZ()).transaction(mg,"readwrite");return yield s.objectStore(mg).put(t,YZ(n)),s.done}catch(r){if(r instanceof Dc)Ju.warn(r.message);else{const s=Ql.create("idb-set",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message});Ju.warn(s.message)}}})).apply(this,arguments)}function YZ(n){return`${n.name}!${n.options.appId}`}class jge{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Yge(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var t=this;return I(function*(){const r=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=KZ();if(null===t._heartbeatsCache&&(t._heartbeatsCache=yield t._heartbeatsCachePromise),t._heartbeatsCache.lastSentHeartbeatDate!==s&&!t._heartbeatsCache.heartbeats.some(i=>i.date===s))return t._heartbeatsCache.heartbeats.push({date:s,agent:r}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=2592e6}),t._storage.overwrite(t._heartbeatsCache)})()}getHeartbeatsHeader(){var t=this;return I(function*(){if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null===t._heartbeatsCache||0===t._heartbeatsCache.heartbeats.length)return"";const e=KZ(),{heartbeatsToSend:r,unsentEntries:s}=function Zge(n,t=1024){const e=[];let r=n.slice();for(const s of n){const i=e.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),XZ(e)>t){i.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),XZ(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}(t._heartbeatsCache.heartbeats),i=UE(JSON.stringify({version:2,heartbeats:r}));return t._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(t._heartbeatsCache.heartbeats=s,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),i})()}}function KZ(){return(new Date).toISOString().substring(0,10)}class Yge{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return I(function*(){return!!Xu()&&hg().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return I(function*(){return(yield t._canUseIndexedDBPromise)&&(yield function Gge(n){return dI.apply(this,arguments)}(t.app))||{heartbeats:[]}})()}overwrite(t){var e=this;return I(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return ZZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var e=this;return I(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return ZZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}})()}}function XZ(n){return UE(JSON.stringify({version:2,heartbeats:n})).length}!function Kge(n){Vo(new no("platform-logger",t=>new fge(t),"PRIVATE")),Vo(new no("heartbeat",t=>new jge(t),"PRIVATE")),fs(lI,"0.8.4",n),fs(lI,"0.8.4","esm2017"),fs("fire-js","")}("");var xt,Xge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Jl={},gI=gI||{},Mn=Xge||self;function XE(){}function QE(n){var t=typeof n;return"array"==(t="object"!=t?t:n?Array.isArray(n)?"array":t:"null")||"object"==t&&"number"==typeof n.length}function _g(n){var t=typeof n;return"object"==t&&null!=n||"function"==t}var mI="closure_uid_"+(1e9*Math.random()>>>0),Jge=0;function eme(n,t,e){return n.call.apply(n.bind,arguments)}function tme(n,t,e){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),n.apply(t,s)}}return function(){return n.apply(t,arguments)}}function ro(n,t,e){return(ro=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?eme:tme).apply(null,arguments)}function JE(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var r=e.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function b2(n,t){function e(){}e.prototype=t.prototype,n.X=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.Wb=function(r,s,i){for(var o=Array(arguments.length-2),c=2;c<arguments.length;c++)o[c-2]=arguments[c];return t.prototype[s].apply(r,o)}}function W0(){this.s=this.s,this.o=this.o}W0.prototype.s=!1,W0.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function Qge(n){Object.prototype.hasOwnProperty.call(n,mI)&&n[mI]||(n[mI]=++Jge)}(this)},W0.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const QZ=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if("string"==typeof n)return"string"!=typeof t||1!=t.length?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function _I(n){const t=n.length;if(0<t){const e=Array(t);for(let r=0;r<t;r++)e[r]=n[r];return e}return[]}function JZ(n,t){for(let e=1;e<arguments.length;e++){const r=arguments[e];if(QE(r)){const s=n.length||0,i=r.length||0;n.length=s+i;for(let o=0;o<i;o++)n[s+o]=r[o]}else n.push(r)}}function so(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}so.prototype.h=function(){this.defaultPrevented=!0};var rme=function(){if(!Mn.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Mn.addEventListener("test",XE,t),Mn.removeEventListener("test",XE,t)}catch{}return n}();function eM(n){return/^[\s\xa0]*$/.test(n)}var eY=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function vI(n,t){return n<t?-1:n>t?1:0}function tM(){var n=Mn.navigator;return n&&(n=n.userAgent)?n:""}function D4(n){return-1!=tM().indexOf(n)}function CI(n){return CI[" "](n),n}CI[" "]=XE;var nM,n,ime=D4("Opera"),Wf=D4("Trident")||D4("MSIE"),tY=D4("Edge"),yI=tY||Wf,nY=D4("Gecko")&&!(-1!=tM().toLowerCase().indexOf("webkit")&&!D4("Edge"))&&!(D4("Trident")||D4("MSIE"))&&!D4("Edge"),ome=-1!=tM().toLowerCase().indexOf("webkit")&&!D4("Edge");function rY(){var n=Mn.document;return n?n.documentMode:void 0}e:{var EI="",MI=(n=tM(),nY?/rv:([^\);]+)(\)|;)/.exec(n):tY?/Edge\/([\d\.]+)/.exec(n):Wf?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):ome?/WebKit\/(\S+)/.exec(n):ime?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(MI&&(EI=MI?MI[1]:""),Wf){var SI=rY();if(null!=SI&&SI>parseFloat(EI)){nM=String(SI);break e}}nM=EI}var ame={};var lme=Mn.document&&Wf&&(rY()||parseInt(nM,10))||void 0;function vg(n,t){if(so.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(nY){e:{try{CI(t.nodeName);var s=!0;break e}catch{}s=!1}s||(t=null)}}else"mouseover"==e?t=n.fromElement:"mouseout"==e&&(t=n.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:ume[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&vg.X.h.call(this)}}b2(vg,so);var ume={2:"touch",3:"pen",4:"mouse"};vg.prototype.h=function(){vg.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Cg="closure_listenable_"+(1e6*Math.random()|0),fme=0;function hme(n,t,e,r,s){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!r,this.ha=s,this.key=++fme,this.ba=this.ea=!1}function rM(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function TI(n,t,e){for(const r in n)t.call(e,n[r],r,n)}function iY(n){const t={};for(const e in n)t[e]=n[e];return t}const oY="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function aY(n,t){let e,r;for(let s=1;s<arguments.length;s++){for(e in r=arguments[s],r)n[e]=r[e];for(let i=0;i<oY.length;i++)e=oY[i],Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}}function sM(n){this.src=n,this.g={},this.h=0}function wI(n,t){var e=t.type;if(e in n.g){var i,r=n.g[e],s=QZ(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(rM(t),0==n.g[e].length&&(delete n.g[e],n.h--))}}function OI(n,t,e,r){for(var s=0;s<n.length;++s){var i=n[s];if(!i.ba&&i.listener==t&&i.capture==!!e&&i.ha==r)return s}return-1}sM.prototype.add=function(n,t,e,r,s){var i=n.toString();(n=this.g[i])||(n=this.g[i]=[],this.h++);var o=OI(n,t,r,s);return-1<o?(t=n[o],e||(t.ea=!1)):((t=new hme(t,this.src,i,!!r,s)).ea=e,n.push(t)),t};var bI="closure_lm_"+(1e6*Math.random()|0),AI={};function cY(n,t,e,r,s){if(r&&r.once)return uY(n,t,e,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)cY(n,t[i],e,r,s);return null}return e=kI(e),n&&n[Cg]?n.N(t,e,_g(r)?!!r.capture:!!r,s):lY(n,t,e,!1,r,s)}function lY(n,t,e,r,s,i){if(!t)throw Error("Invalid event type");var o=_g(s)?!!s.capture:!!s,c=II(n);if(c||(n[bI]=c=new sM(n)),(e=c.add(t,e,r,o,i)).proxy)return e;if(r=function dme(){const t=pme;return function n(e){return t.call(n.src,n.listener,e)}}(),e.proxy=r,r.src=n,r.listener=e,n.addEventListener)rme||(s=o),void 0===s&&(s=!1),n.addEventListener(t.toString(),r,s);else if(n.attachEvent)n.attachEvent(hY(t.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return e}function uY(n,t,e,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)uY(n,t[i],e,r,s);return null}return e=kI(e),n&&n[Cg]?n.O(t,e,_g(r)?!!r.capture:!!r,s):lY(n,t,e,!0,r,s)}function fY(n,t,e,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)fY(n,t[i],e,r,s);else r=_g(r)?!!r.capture:!!r,e=kI(e),n&&n[Cg]?(n=n.i,(t=String(t).toString())in n.g&&-1<(e=OI(i=n.g[t],e,r,s))&&(rM(i[e]),Array.prototype.splice.call(i,e,1),0==i.length&&(delete n.g[t],n.h--))):n&&(n=II(n))&&(t=n.g[t.toString()],n=-1,t&&(n=OI(t,e,r,s)),(e=-1<n?t[n]:null)&&NI(e))}function NI(n){if("number"!=typeof n&&n&&!n.ba){var t=n.src;if(t&&t[Cg])wI(t.i,n);else{var e=n.type,r=n.proxy;t.removeEventListener?t.removeEventListener(e,r,n.capture):t.detachEvent?t.detachEvent(hY(e),r):t.addListener&&t.removeListener&&t.removeListener(r),(e=II(t))?(wI(e,n),0==e.h&&(e.src=null,t[bI]=null)):rM(n)}}}function hY(n){return n in AI?AI[n]:AI[n]="on"+n}function pme(n,t){if(n.ba)n=!0;else{t=new vg(t,this);var e=n.listener,r=n.ha||n.src;n.ea&&NI(n),n=e.call(r,t)}return n}function II(n){return(n=n[bI])instanceof sM?n:null}var xI="__closure_events_fn_"+(1e9*Math.random()>>>0);function kI(n){return"function"==typeof n?n:(n[xI]||(n[xI]=function(t){return n.handleEvent(t)}),n[xI])}function Ui(){W0.call(this),this.i=new sM(this),this.P=this,this.I=null}function A2(n,t){var e,r=n.I;if(r)for(e=[];r;r=r.I)e.push(r);if(n=n.P,r=t.type||t,"string"==typeof t)t=new so(t,n);else if(t instanceof so)t.target=t.target||n;else{var s=t;aY(t=new so(r,n),s)}if(s=!0,e)for(var i=e.length-1;0<=i;i--){var o=t.g=e[i];s=iM(o,r,!0,t)&&s}if(s=iM(o=t.g=n,r,!0,t)&&s,s=iM(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=iM(o=t.g=e[i],r,!1,t)&&s}function iM(n,t,e,r){if(!(t=n.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.ba&&o.capture==e){var c=o.listener,u=o.ha||o.src;o.ea&&wI(n.i,o),s=!1!==c.call(u,r)&&s}}return s&&!r.defaultPrevented}b2(Ui,W0),Ui.prototype[Cg]=!0,Ui.prototype.removeEventListener=function(n,t,e,r){fY(this,n,t,e,r)},Ui.prototype.M=function(){if(Ui.X.M.call(this),this.i){var t,n=this.i;for(t in n.g){for(var e=n.g[t],r=0;r<e.length;r++)rM(e[r]);delete n.g[t],n.h--}}this.I=null},Ui.prototype.N=function(n,t,e,r){return this.i.add(String(n),t,!1,e,r)},Ui.prototype.O=function(n,t,e,r){return this.i.add(String(n),t,!0,e,r)};var LI=Mn.JSON.stringify;function gme(){var n=gY;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}var RI,dY=new class{constructor(n,t){this.i=n,this.j=t,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new _me,n=>n.reset());class _me{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function vme(n){Mn.setTimeout(()=>{throw n},0)}function pY(n,t){RI||function Cme(){var n=Mn.Promise.resolve(void 0);RI=function(){n.then(yme)}}(),DI||(RI(),DI=!0),gY.add(n,t)}var DI=!1,gY=new class mme{constructor(){this.h=this.g=null}add(t,e){const r=dY.get();r.set(t,e),this.h?this.h.next=r:this.g=r,this.h=r}};function yme(){for(var n;n=gme();){try{n.h.call(n.g)}catch(e){vme(e)}var t=dY;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}DI=!1}function oM(n,t){Ui.call(this),this.h=n||1,this.g=t||Mn,this.j=ro(this.lb,this),this.l=Date.now()}function zI(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function VI(n,t,e){if("function"==typeof n)e&&(n=ro(n,e));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=ro(n.handleEvent,n)}return 2147483647<Number(t)?-1:Mn.setTimeout(n,t||0)}function mY(n){n.g=VI(()=>{n.g=null,n.i&&(n.i=!1,mY(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}b2(oM,Ui),(xt=oM.prototype).ca=!1,xt.R=null,xt.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),A2(this,"tick"),this.ca&&(zI(this),this.start()))}},xt.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},xt.M=function(){oM.X.M.call(this),zI(this),delete this.g};class Eme extends W0{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:mY(this)}M(){super.M(),this.g&&(Mn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yg(n){W0.call(this),this.h=n,this.g={}}b2(yg,W0);var _Y=[];function vY(n,t,e,r){Array.isArray(e)||(e&&(_Y[0]=e.toString()),e=_Y);for(var s=0;s<e.length;s++){var i=cY(t,e[s],r||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function CY(n){TI(n.g,function(t,e){this.g.hasOwnProperty(e)&&NI(t)},n),n.g={}}function aM(){this.g=!0}function jf(n,t,e,r){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+function Tme(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var r=e[n];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return LI(e)}catch{return t}}(n,e)+(r?" "+r:"")})}yg.prototype.M=function(){yg.X.M.call(this),CY(this)},yg.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},aM.prototype.Aa=function(){this.g=!1},aM.prototype.info=function(){};var t5={},yY=null;function cM(){return yY=yY||new Ui}function EY(n){so.call(this,t5.Pa,n)}function Eg(n){const t=cM();A2(t,new EY(t))}function MY(n,t){so.call(this,t5.STAT_EVENT,n),this.stat=t}function Ho(n){const t=cM();A2(t,new MY(t,n))}function SY(n,t){so.call(this,t5.Qa,n),this.size=t}function Mg(n,t){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Mn.setTimeout(function(){n()},t)}t5.Pa="serverreachability",b2(EY,so),t5.STAT_EVENT="statevent",b2(MY,so),t5.Qa="timingevent",b2(SY,so);var lM={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},PY={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function HI(){}function wY(){}HI.prototype.h=null;var $I,Sg={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function FI(){so.call(this,"d")}function BI(){so.call(this,"c")}function uM(){}function Pg(n,t,e,r){this.l=n,this.j=t,this.m=e,this.U=r||1,this.S=new yg(this),this.O=wme,this.T=new oM(n=yI?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new OY}function OY(){this.i=null,this.g="",this.h=!1}b2(FI,so),b2(BI,so),b2(uM,HI),uM.prototype.g=function(){return new XMLHttpRequest},uM.prototype.i=function(){return{}},$I=new uM;var wme=45e3,UI={},fM={};function GI(n,t,e){n.K=1,n.v=gM(e6(t)),n.s=e,n.P=!0,bY(n,null)}function bY(n,t){n.F=Date.now(),Tg(n),n.A=e6(n.v);var e=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),VY(e.i,"t",r),n.C=0,e=n.l.H,n.h=new OY,n.g=cK(n.l,e?t:null,!n.s),0<n.N&&(n.L=new Eme(ro(n.La,n,n.g),n.N)),vY(n.S,n.g,"readystatechange",n.ib),t=n.H?iY(n.H):{},n.s?(n.u||(n.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,t)):(n.u="GET",n.g.da(n.A,n.u,null,t)),Eg(),function Mme(n,t,e,r,s,i){n.info(function(){if(n.g)if(i)for(var o="",c=i.split("&"),u=0;u<c.length;u++){var h=c[u].split("=");if(1<h.length){var g=h[0];h=h[1];var m=g.split("_");o=2<=m.length&&"type"==m[1]?o+(g+"=")+h+"&":o+(g+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+e+"\n"+o})}(n.j,n.u,n.A,n.m,n.U,n.s)}function AY(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function NY(n,t,e){let s,r=!0;for(;!n.I&&n.C<e.length;){if(s=Ome(n,e),s==fM){4==t&&(n.o=4,Ho(14),r=!1),jf(n.j,n.m,null,"[Incomplete Response]");break}if(s==UI){n.o=4,Ho(15),jf(n.j,n.m,e,"[Invalid Chunk]"),r=!1;break}jf(n.j,n.m,s,null),qI(n,s)}AY(n)&&s!=fM&&s!=UI&&(n.h.g="",n.C=0),4!=t||0!=e.length||n.h.h||(n.o=1,Ho(16),r=!1),n.i=n.i&&r,r?0<e.length&&!n.$&&(n.$=!0,(t=n.l).g==n&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+e.length),JI(t),t.K=!0,Ho(11))):(jf(n.j,n.m,e,"[Invalid Chunked Response]"),n5(n),wg(n))}function Ome(n,t){var e=n.C,r=t.indexOf("\n",e);return-1==r?fM:(e=Number(t.substring(e,r)),isNaN(e)?UI:(r+=1)+e>t.length?fM:(t=t.substr(r,e),n.C=r+e,t))}function Tg(n){n.V=Date.now()+n.O,IY(n,n.O)}function IY(n,t){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Mg(ro(n.gb,n),t)}function hM(n){n.B&&(Mn.clearTimeout(n.B),n.B=null)}function wg(n){0==n.l.G||n.I||sK(n.l,n)}function n5(n){hM(n);var t=n.L;t&&"function"==typeof t.na&&t.na(),n.L=null,zI(n.T),CY(n.S),n.g&&(t=n.g,n.g=null,t.abort(),t.na())}function qI(n,t){try{var e=n.l;if(0!=e.G&&(e.g==n||WI(e.h,n)))if(!n.J&&WI(e.h,n)&&3==e.G){try{var r=e.Fa.g.parse(t)}catch{r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!e.u){if(e.g){if(!(e.g.F+3e3<n.F))break e;EM(e),CM(e)}QI(e),Ho(18)}}else e.Ba=s[1],0<e.Ba-e.T&&37500>s[2]&&e.L&&0==e.A&&!e.v&&(e.v=Mg(ro(e.cb,e),6e3));if(1>=BY(e.h)&&e.ja){try{e.ja()}catch{}e.ja=void 0}}else s5(e,11)}else if((n.J||e.g==n)&&EM(e),!eM(t))for(s=e.Fa.g.parse(t),t=0;t<s.length;t++){let h=s[t];if(e.T=h[0],h=h[1],2==e.G)if("c"==h[0]){e.I=h[1],e.ka=h[2];const g=h[3];null!=g&&(e.ma=g,e.j.info("VER="+e.ma));const m=h[4];null!=m&&(e.Ca=m,e.j.info("SVER="+e.Ca));const E=h[5];null!=E&&"number"==typeof E&&0<E&&(e.J=r=1.5*E,e.j.info("backChannelRequestTimeoutMs_="+r)),r=e;const O=n.g;if(O){const k=O.g?O.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(k){var i=r.h;i.g||-1==k.indexOf("spdy")&&-1==k.indexOf("quic")&&-1==k.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(jI(i,i.h),i.h=null))}if(r.D){const U=O.g?O.g.getResponseHeader("X-HTTP-Session-Id"):null;U&&(r.za=U,Br(r.F,r.D,U))}}e.G=3,e.l&&e.l.xa(),e.$&&(e.P=Date.now()-n.F,e.j.info("Handshake RTT: "+e.P+"ms"));var o=n;if((r=e).sa=aK(r,r.H?r.ka:null,r.V),o.J){$Y(r.h,o);var c=o,u=r.J;u&&c.setTimeout(u),c.B&&(hM(c),Tg(c)),r.g=o}else nK(r);0<e.i.length&&yM(e)}else"stop"!=h[0]&&"close"!=h[0]||s5(e,7);else 3==e.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?s5(e,7):XI(e):"noop"!=h[0]&&e.l&&e.l.wa(h),e.A=0)}Eg()}catch{}}function xY(n,t){if(n.forEach&&"function"==typeof n.forEach)n.forEach(t,void 0);else if(QE(n)||"string"==typeof n)Array.prototype.forEach.call(n,t,void 0);else for(var e=function Ame(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(QE(n)||"string"==typeof n){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const r in n)t[e++]=r;return t}}}(n),r=function bme(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(QE(n)){for(var t=[],e=n.length,r=0;r<e;r++)t.push(n[r]);return t}for(r in t=[],e=0,n)t[e++]=n[r];return t}(n),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],e&&e[i],n)}(xt=Pg.prototype).setTimeout=function(n){this.O=n},xt.ib=function(n){n=n.target;const t=this.L;t&&3==t6(n)?t.l():this.La(n)},xt.La=function(n){try{if(n==this.g)e:{const g=t6(this.g);var t=this.g.Ea();if(this.g.aa(),!(3>g)&&(3!=g||yI||this.g&&(this.h.h||this.g.fa()||KY(this.g)))){this.I||4!=g||7==t||Eg(),hM(this);var e=this.g.aa();this.Y=e;t:if(AY(this)){var r=KY(this.g);n="";var s=r.length,i=4==t6(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){n5(this),wg(this);var o="";break t}this.h.i=new Mn.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,n+=this.h.i.decode(r[t],{stream:i&&t==s-1});r.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==e,function Sme(n,t,e,r,s,i,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+e+"\n"+i+" "+o})}(this.j,this.u,this.A,this.m,this.U,g,e),this.i){if(this.Z&&!this.J){t:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!eM(c)){var h=c;break t}}h=null}if(!(e=h)){this.i=!1,this.o=3,Ho(12),n5(this),wg(this);break e}jf(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,qI(this,e)}this.P?(NY(this,g,o),yI&&this.i&&3==g&&(vY(this.S,this.T,"tick",this.hb),this.T.start())):(jf(this.j,this.m,o,null),qI(this,o)),4==g&&n5(this),this.i&&!this.I&&(4==g?sK(this.l,this):(this.i=!1,Tg(this)))}else 400==e&&0<o.indexOf("Unknown SID")?(this.o=3,Ho(12)):(this.o=0,Ho(13)),n5(this),wg(this)}}}catch{}},xt.hb=function(){if(this.g){var n=t6(this.g),t=this.g.fa();this.C<t.length&&(hM(this),NY(this,n,t),this.i&&4!=n&&Tg(this))}},xt.cancel=function(){this.I=!0,n5(this)},xt.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function Pme(n,t){n.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(Eg(),Ho(17)),n5(this),this.o=2,wg(this)):IY(this,this.V-n)};var kY=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function r5(n,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof r5){this.h=void 0!==t?t:n.h,dM(this,n.j),this.s=n.s,this.g=n.g,pM(this,n.m),this.l=n.l,t=n.i;var e=new Ag;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),LY(this,e),this.o=n.o}else n&&(e=String(n).match(kY))?(this.h=!!t,dM(this,e[1]||"",!0),this.s=Og(e[2]||""),this.g=Og(e[3]||"",!0),pM(this,e[4]),this.l=Og(e[5]||"",!0),LY(this,e[6]||"",!0),this.o=Og(e[7]||"")):(this.h=!!t,this.i=new Ag(null,this.h))}function e6(n){return new r5(n)}function dM(n,t,e){n.j=e?Og(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function pM(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function LY(n,t,e){t instanceof Ag?(n.i=t,function Dme(n,t){t&&!n.j&&(j0(n),n.i=null,n.g.forEach(function(e,r){var s=r.toLowerCase();r!=s&&(DY(this,r),VY(this,s,e))},n)),n.j=t}(n.i,n.h)):(e||(t=bg(t,Lme)),n.i=new Ag(t,n.h))}function Br(n,t,e){n.i.set(t,e)}function gM(n){return Br(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Og(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function bg(n,t,e){return"string"==typeof n?(n=encodeURI(n).replace(t,Ime),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Ime(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}r5.prototype.toString=function(){var n=[],t=this.j;t&&n.push(bg(t,RY,!0),":");var e=this.g;return(e||"file"==t)&&(n.push("//"),(t=this.s)&&n.push(bg(t,RY,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.m)&&n.push(":",String(e))),(e=this.l)&&(this.g&&"/"!=e.charAt(0)&&n.push("/"),n.push(bg(e,"/"==e.charAt(0)?kme:xme,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",bg(e,Rme)),n.join("")};var RY=/[#\/\?@]/g,xme=/[#\?:]/g,kme=/[#\?]/g,Lme=/[#\?@]/g,Rme=/#/g;function Ag(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function j0(n){n.g||(n.g=new Map,n.h=0,n.i&&function Nme(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var r=n[e].indexOf("="),s=null;if(0<=r){var i=n[e].substring(0,r);s=n[e].substring(r+1)}else i=n[e];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function DY(n,t){j0(n),t=Zf(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function zY(n,t){return j0(n),t=Zf(n,t),n.g.has(t)}function VY(n,t,e){DY(n,t),0<e.length&&(n.i=null,n.g.set(Zf(n,t),_I(e)),n.h+=e.length)}function Zf(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function HY(n){this.l=n||Vme,n=Mn.PerformanceNavigationTiming?0<(n=Mn.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Mn.g&&Mn.g.Ga&&Mn.g.Ga()&&Mn.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(xt=Ag.prototype).add=function(n,t){j0(this),this.i=null,n=Zf(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this},xt.forEach=function(n,t){j0(this),this.g.forEach(function(e,r){e.forEach(function(s){n.call(t,s,r,this)},this)},this)},xt.oa=function(){j0(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let r=0;r<t.length;r++){const s=n[r];for(let i=0;i<s.length;i++)e.push(t[r])}return e},xt.W=function(n){j0(this);let t=[];if("string"==typeof n)zY(this,n)&&(t=t.concat(this.g.get(Zf(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t},xt.set=function(n,t){return j0(this),this.i=null,zY(this,n=Zf(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this},xt.get=function(n,t){return n&&0<(n=this.W(n)).length?String(n[0]):t},xt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var r=t[e];const i=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var s=i;""!==o[r]&&(s+="="+encodeURIComponent(String(o[r]))),n.push(s)}}return this.i=n.join("&")};var Vme=10;function FY(n){return!!n.h||!!n.g&&n.g.size>=n.j}function BY(n){return n.h?1:n.g?n.g.size:0}function WI(n,t){return n.h?n.h==t:!!n.g&&n.g.has(t)}function jI(n,t){n.g?n.g.add(t):n.h=t}function $Y(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}function UY(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let t=n.i;for(const e of n.g.values())t=t.concat(e.D);return t}return _I(n.i)}function ZI(){}function Hme(){this.g=new ZI}function Fme(n,t,e){const r=e||"";try{xY(n,function(s,i){let o=s;_g(s)&&(o=LI(s)),t.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function mM(n,t,e,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch{}}function Ng(n){this.l=n.ac||null,this.j=n.jb||!1}function _M(n,t){Ui.call(this),this.D=n,this.u=t,this.m=void 0,this.readyState=YI,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}HY.prototype.cancel=function(){if(this.i=UY(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},ZI.prototype.stringify=function(n){return Mn.JSON.stringify(n,void 0)},ZI.prototype.parse=function(n){return Mn.JSON.parse(n,void 0)},b2(Ng,HI),Ng.prototype.g=function(){return new _M(this.l,this.j)},Ng.prototype.i=function(n){return function(){return n}}({}),b2(_M,Ui);var YI=0;function GY(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function Ig(n){n.readyState=4,n.l=null,n.j=null,n.A=null,xg(n)}function xg(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(xt=_M.prototype).open=function(n,t){if(this.readyState!=YI)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,xg(this)},xt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.D||Mn).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},xt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ig(this)),this.readyState=YI},xt.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,xg(this)),this.g&&(this.readyState=3,xg(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof Mn.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;GY(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},xt.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?Ig(this):xg(this),3==this.readyState&&GY(this)}},xt.Va=function(n){this.g&&(this.response=this.responseText=n,Ig(this))},xt.Ua=function(n){this.g&&(this.response=n,Ig(this))},xt.ga=function(){this.g&&Ig(this)},xt.setRequestHeader=function(n,t){this.v.append(n,t)},xt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},xt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)n.push((e=e.value)[0]+": "+e[1]),e=t.next();return n.join("\r\n")},Object.defineProperty(_M.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var $me=Mn.JSON.parse;function hs(n){Ui.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=qY,this.K=this.L=!1}b2(hs,Ui);var qY="",Ume=/^https?$/i,Gme=["POST","PUT"];function WY(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,jY(n),vM(n)}function jY(n){n.D||(n.D=!0,A2(n,"complete"),A2(n,"error"))}function ZY(n){if(n.h&&typeof gI<"u"&&(!n.C[1]||4!=t6(n)||2!=n.aa()))if(n.v&&4==t6(n))VI(n.Ha,0,n);else if(A2(n,"readystatechange"),4==t6(n)){n.h=!1;try{const c=n.aa();e:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var e;if(!(e=t)){var r;if(r=0===c){var s=String(n.H).match(kY)[1]||null;if(!s&&Mn.self&&Mn.self.location){var i=Mn.self.location.protocol;s=i.substr(0,i.length-1)}r=!Ume.test(s?s.toLowerCase():"")}e=r}if(e)A2(n,"complete"),A2(n,"success");else{n.m=6;try{var o=2<t6(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.aa()+"]",jY(n)}}finally{vM(n)}}}function vM(n,t){if(n.g){YY(n);const e=n.g,r=n.C[0]?XE:null;n.g=null,n.C=null,t||A2(n,"ready");try{e.onreadystatechange=r}catch{}}}function YY(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(Mn.clearTimeout(n.A),n.A=null)}function t6(n){return n.g?n.g.readyState:0}function KY(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case qY:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function XY(n){let t="";return TI(n,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function KI(n,t,e){e:{for(r in e){var r=!1;break e}r=!0}r||(e=XY(e),"string"==typeof n?null!=e&&encodeURIComponent(String(e)):Br(n,t,e))}function kg(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function QY(n){this.Ca=0,this.i=[],this.j=new aM,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=kg("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=kg("baseRetryDelayMs",5e3,n),this.bb=kg("retryDelaySeedMs",1e4,n),this.$a=kg("forwardChannelMaxRetries",2,n),this.ta=kg("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new HY(n&&n.concurrentRequestLimit),this.Fa=new Hme,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function XI(n){if(JY(n),3==n.G){var t=n.U++,e=e6(n.F);Br(e,"SID",n.I),Br(e,"RID",t),Br(e,"TYPE","terminate"),Lg(n,e),(t=new Pg(n,n.j,t,void 0)).K=2,t.v=gM(e6(e)),e=!1,Mn.navigator&&Mn.navigator.sendBeacon&&(e=Mn.navigator.sendBeacon(t.v.toString(),"")),!e&&Mn.Image&&((new Image).src=t.v,e=!0),e||(t.g=cK(t.l,null),t.g.da(t.v)),t.F=Date.now(),Tg(t)}oK(n)}function CM(n){n.g&&(JI(n),n.g.cancel(),n.g=null)}function JY(n){CM(n),n.u&&(Mn.clearTimeout(n.u),n.u=null),EM(n),n.h.cancel(),n.m&&("number"==typeof n.m&&Mn.clearTimeout(n.m),n.m=null)}function yM(n){FY(n.h)||n.m||(n.m=!0,pY(n.Ja,n),n.C=0)}function eK(n,t){var e;e=t?t.m:n.U++;const r=e6(n.F);Br(r,"SID",n.I),Br(r,"RID",e),Br(r,"AID",n.T),Lg(n,r),n.o&&n.s&&KI(r,n.o,n.s),e=new Pg(n,n.j,e,n.C+1),null===n.o&&(e.H=n.s),t&&(n.i=t.D.concat(n.i)),t=tK(n,e,1e3),e.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),jI(n.h,e),GI(e,r,t)}function Lg(n,t){n.ia&&TI(n.ia,function(e,r){Br(t,r,e)}),n.l&&xY({},function(e,r){Br(t,r,e)})}function tK(n,t,e){e=Math.min(n.i.length,e);var r=n.l?ro(n.l.Ra,n.l,n):null;e:{var s=n.i;let i=-1;for(;;){const o=["count="+e];-1==i?0<e?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let c=!0;for(let u=0;u<e;u++){let h=s[u].h;const g=s[u].g;if(h-=i,0>h)i=Math.max(0,s[u].h-100),c=!1;else try{Fme(g,o,"req"+h+"_")}catch{r&&r(g)}}if(c){r=o.join("&");break e}}}return n=n.i.splice(0,e),t.D=n,r}function nK(n){n.g||n.u||(n.Z=1,pY(n.Ia,n),n.A=0)}function QI(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Mg(ro(n.Ia,n),iK(n,n.A)),n.A++,0))}function JI(n){null!=n.B&&(Mn.clearTimeout(n.B),n.B=null)}function rK(n){n.g=new Pg(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var t=e6(n.sa);Br(t,"RID","rpc"),Br(t,"SID",n.I),Br(t,"CI",n.L?"0":"1"),Br(t,"AID",n.T),Br(t,"TYPE","xmlhttp"),Lg(n,t),n.o&&n.s&&KI(t,n.o,n.s),n.J&&n.g.setTimeout(n.J);var e=n.g;n=n.ka,e.K=1,e.v=gM(e6(t)),e.s=null,e.P=!0,bY(e,n)}function EM(n){null!=n.v&&(Mn.clearTimeout(n.v),n.v=null)}function sK(n,t){var e=null;if(n.g==t){EM(n),JI(n),n.g=null;var r=2}else{if(!WI(n.h,t))return;e=t.D,$Y(n.h,t),r=1}if(0!=n.G)if(n.pa=t.Y,t.i)if(1==r){e=t.s?t.s.length:0,t=Date.now()-t.F;var s=n.C;A2(r=cM(),new SY(r,e)),yM(n)}else nK(n);else if(3==(s=t.o)||0==s&&0<n.pa||!(1==r&&function Wme(n,t){return!(BY(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=t.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Mg(ro(n.Ja,n,t),iK(n,n.C)),n.C++,0)))}(n,t)||2==r&&QI(n)))switch(e&&0<e.length&&(t=n.h,t.i=t.i.concat(e)),s){case 1:s5(n,5);break;case 4:s5(n,10);break;case 3:s5(n,6);break;default:s5(n,2)}}function iK(n,t){let e=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(e*=2),e*t}function s5(n,t){if(n.j.info("Error code "+t),2==t){var e=null;n.l&&(e=null);var r=ro(n.kb,n);e||(e=new r5("//www.google.com/images/cleardot.gif"),Mn.location&&"http"==Mn.location.protocol||dM(e,"https"),gM(e)),function Bme(n,t){const e=new aM;if(Mn.Image){const r=new Image;r.onload=JE(mM,e,r,"TestLoadImage: loaded",!0,t),r.onerror=JE(mM,e,r,"TestLoadImage: error",!1,t),r.onabort=JE(mM,e,r,"TestLoadImage: abort",!1,t),r.ontimeout=JE(mM,e,r,"TestLoadImage: timeout",!1,t),Mn.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else t(!1)}(e.toString(),r)}else Ho(2);n.G=0,n.l&&n.l.va(t),oK(n),JY(n)}function oK(n){if(n.G=0,n.la=[],n.l){const t=UY(n.h);(0!=t.length||0!=n.i.length)&&(JZ(n.la,t),JZ(n.la,n.i),n.h.i.length=0,_I(n.i),n.i.length=0),n.l.ua()}}function aK(n,t,e){var r=e instanceof r5?e6(e):new r5(e,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),pM(r,r.m);else{var s=Mn.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new r5(null,void 0);r&&dM(i,r),t&&(i.g=t),s&&pM(i,s),e&&(i.l=e),r=i}return t=n.za,(e=n.D)&&t&&Br(r,e,t),Br(r,"VER",n.ma),Lg(n,r),r}function cK(n,t,e){if(t&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new hs(e&&n.Da&&!n.ra?new Ng({jb:!0}):n.ra)).Ka(n.H),t}function lK(){}function MM(){if(Wf&&!(10<=Number(lme)))throw Error("Environmental error: no available transport.")}function Qa(n,t){Ui.call(this),this.g=new QY(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(n?n["X-WebChannel-Client-Profile"]=t.ya:n={"X-WebChannel-Client-Profile":t.ya}),this.g.S=n,(n=t&&t.Yb)&&!eM(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!eM(t)&&(this.g.D=t,null!==(n=this.h)&&t in n&&t in(n=this.h)&&delete n[t]),this.j=new Yf(this)}function uK(n){FI.call(this);var t=n.__sm__;if(t){e:{for(const e in t){n=e;break e}n=void 0}(this.i=n)&&(n=this.i,t=null!==t&&n in t?t[n]:void 0),this.data=t}else this.data=n}function fK(){BI.call(this),this.status=1}function Yf(n){this.g=n}(xt=hs.prototype).Ka=function(n){this.L=n},xt.da=function(n,t,e,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);t=t?t.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():$I.g(),this.C=function TY(n){return n.h||(n.h=n.i())}(this.u?this.u:$I),this.g.onreadystatechange=ro(this.Ha,this);try{this.F=!0,this.g.open(t,String(n),!0),this.F=!1}catch(i){return void WY(this,i)}if(n=e||"",e=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)e.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const i of r.keys())e.set(i,r.get(i))}r=Array.from(e.keys()).find(i=>"content-type"==i.toLowerCase()),s=Mn.FormData&&n instanceof Mn.FormData,!(0<=QZ(Gme,t))||r||s||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of e)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{YY(this),0<this.B&&((this.K=function qme(n){return Wf&&function cme(){return function sme(n){var t=ame;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=n(9)}(function(){let n=0;const t=eY(String(nM)).split("."),e=eY("9").split("."),r=Math.max(t.length,e.length);for(let o=0;0==n&&o<r;o++){var s=t[o]||"",i=e[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],0==s[0].length&&0==i[0].length)break;n=vI(0==s[1].length?0:parseInt(s[1],10),0==i[1].length?0:parseInt(i[1],10))||vI(0==s[2].length,0==i[2].length)||vI(s[2],i[2]),s=s[3],i=i[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ro(this.qa,this)):this.A=VI(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){WY(this,i)}},xt.qa=function(){typeof gI<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,A2(this,"timeout"),this.abort(8))},xt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,A2(this,"complete"),A2(this,"abort"),vM(this))},xt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),vM(this,!0)),hs.X.M.call(this)},xt.Ha=function(){this.s||(this.F||this.v||this.l?ZY(this):this.fb())},xt.fb=function(){ZY(this)},xt.aa=function(){try{return 2<t6(this)?this.g.status:-1}catch{return-1}},xt.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},xt.Sa=function(n){if(this.g){var t=this.g.responseText;return n&&0==t.indexOf(n)&&(t=t.substring(n.length)),$me(t)}},xt.Ea=function(){return this.m},xt.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(xt=QY.prototype).ma=8,xt.G=1,xt.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const s=new Pg(this,this.j,n,void 0);let i=this.s;if(this.S&&(i?(i=iY(i),aY(i,this.S)):i=this.S),null!==this.o||this.N||(s.H=i,i=null),this.O)e:{for(var t=0,e=0;e<this.i.length;e++){var r=this.i[e];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=e;break e}if(4096===t||e===this.i.length-1){t=e+1;break e}}t=1e3}else t=1e3;t=tK(this,s,t),Br(e=e6(this.F),"RID",n),Br(e,"CVER",22),this.D&&Br(e,"X-HTTP-Session-Id",this.D),Lg(this,e),i&&(this.N?t="headers="+encodeURIComponent(String(XY(i)))+"&"+t:this.o&&KI(e,this.o,i)),jI(this.h,s),this.Ya&&Br(e,"TYPE","init"),this.O?(Br(e,"$req",t),Br(e,"SID","null"),s.Z=!0,GI(s,e,null)):GI(s,e,t),this.G=2}}else 3==this.G&&(n?eK(this,n):0==this.i.length||FY(this.h)||eK(this))},xt.Ia=function(){if(this.u=null,rK(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Mg(ro(this.eb,this),n)}},xt.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Ho(10),CM(this),rK(this))},xt.cb=function(){null!=this.v&&(this.v=null,CM(this),QI(this),Ho(19))},xt.kb=function(n){n?(this.j.info("Successfully pinged google.com"),Ho(2)):(this.j.info("Failed to ping google.com"),Ho(1))},(xt=lK.prototype).xa=function(){},xt.wa=function(){},xt.va=function(){},xt.ua=function(){},xt.Ra=function(){},MM.prototype.g=function(n,t){return new Qa(n,t)},b2(Qa,Ui),Qa.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,t=this.l,e=this.h||void 0;Ho(0),n.V=t,n.ia=e||{},n.L=n.Y,n.F=aK(n,null,n.V),yM(n)},Qa.prototype.close=function(){XI(this.g)},Qa.prototype.u=function(n){var t=this.g;if("string"==typeof n){var e={};e.__data__=n,n=e}else this.v&&((e={}).__data__=LI(n),n=e);t.i.push(new class{constructor(n,t){this.h=n,this.g=t}}(t.ab++,n)),3==t.G&&yM(t)},Qa.prototype.M=function(){this.g.l=null,delete this.j,XI(this.g),delete this.g,Qa.X.M.call(this)},b2(uK,FI),b2(fK,BI),b2(Yf,lK),Yf.prototype.xa=function(){A2(this.g,"a")},Yf.prototype.wa=function(n){A2(this.g,new uK(n))},Yf.prototype.va=function(n){A2(this.g,new fK)},Yf.prototype.ua=function(){A2(this.g,"b")},MM.prototype.createWebChannel=MM.prototype.g,Qa.prototype.send=Qa.prototype.u,Qa.prototype.open=Qa.prototype.m,Qa.prototype.close=Qa.prototype.close,lM.NO_ERROR=0,lM.TIMEOUT=8,lM.HTTP_ERROR=6,PY.COMPLETE="complete",wY.EventType=Sg,Sg.OPEN="a",Sg.CLOSE="b",Sg.ERROR="c",Sg.MESSAGE="d",Ui.prototype.listen=Ui.prototype.N,hs.prototype.listenOnce=hs.prototype.O,hs.prototype.getLastError=hs.prototype.Oa,hs.prototype.getLastErrorCode=hs.prototype.Ea,hs.prototype.getStatus=hs.prototype.aa,hs.prototype.getResponseJson=hs.prototype.Sa,hs.prototype.getResponseText=hs.prototype.fa,hs.prototype.send=hs.prototype.da,hs.prototype.setWithCredentials=hs.prototype.Ka;var jme=Jl.createWebChannelTransport=function(){return new MM},Zme=Jl.getStatEventTarget=function(){return cM()},ex=Jl.ErrorCode=lM,Yme=Jl.EventType=PY,Kme=Jl.Event=t5,hK=Jl.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Xme=Jl.FetchXmlHttpFactory=Ng,SM=Jl.WebChannel=wY,Qme=Jl.XhrIo=hs;const dK="@firebase/firestore";class Gi{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Gi.UNAUTHENTICATED=new Gi(null),Gi.GOOGLE_CREDENTIALS=new Gi("google-credentials-uid"),Gi.FIRST_PARTY=new Gi("first-party-uid"),Gi.MOCK_USER=new Gi("mock-user");let Kf="9.14.0";const Z0=new Uf("@firebase/firestore");function tx(){return Z0.logLevel}function qe(n,...t){if(Z0.logLevel<=g1.DEBUG){const e=t.map(nx);Z0.debug(`Firestore (${Kf}): ${n}`,...e)}}function Os(n,...t){if(Z0.logLevel<=g1.ERROR){const e=t.map(nx);Z0.error(`Firestore (${Kf}): ${n}`,...e)}}function Xf(n,...t){if(Z0.logLevel<=g1.WARN){const e=t.map(nx);Z0.warn(`Firestore (${Kf}): ${n}`,...e)}}function nx(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Ot(n="Unexpected state"){const t=`FIRESTORE (${Kf}) INTERNAL ASSERTION FAILED: `+n;throw Os(t),new Error(t)}function an(n,t){n||Ot()}function ht(n,t){return n}const Oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends Dc{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class pi{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class pK{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Jme{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Gi.UNAUTHENTICATED))}shutdown(){}}class e_e{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class t_e{constructor(t){this.t=t,this.currentUser=Gi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var r=this;let s=this.i;const i=h=>this.i!==s?(s=this.i,e(h)):Promise.resolve();let o=new pi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new pi,t.enqueueRetryable(()=>i(this.currentUser))};const c=()=>{const h=o;t.enqueueRetryable(I(function*(){yield h.promise,yield i(r.currentUser)}))},u=h=>{qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),c()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new pi)}},0),c()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(r=>this.i!==t?(qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(an("string"==typeof r.accessToken),new pK(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return an(null===t||"string"==typeof t),new Gi(t)}}class n_e{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s,this.type="FirstParty",this.user=Gi.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(an(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class r_e{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s}getToken(){return Promise.resolve(new n_e(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable(()=>e(Gi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class gK{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class s_e{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const r=i=>{null!=i.error&&qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,qe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?s(i):qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(an("string"==typeof e.token),this.A=e.token,new gK(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function i_e(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}class mK{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const s=i_e(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<e&&(r+=t.charAt(s[i]%t.length))}return r}}function Sn(n,t){return n<t?-1:n>t?1:0}function Qf(n,t,e){return n.length===t.length&&n.every((r,s)=>e(r,t[s]))}class es{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new $e(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new $e(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new $e(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new $e(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return es.fromMillis(Date.now())}static fromDate(t){return es.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*e));return new es(e,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Sn(this.nanoseconds,t.nanoseconds):Sn(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class cn{constructor(t){this.timestamp=t}static fromTimestamp(t){return new cn(t)}static min(){return new cn(new es(0,0))}static max(){return new cn(new es(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Rg{constructor(t,e,r){void 0===e?e=0:e>t.length&&Ot(),void 0===r?r=t.length-e:r>t.length-e&&Ot(),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return 0===Rg.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Rg?t.forEach(r=>{e.push(r)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let s=0;s<r;s++){const i=t.get(s),o=e.get(s);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class m1 extends Rg{construct(t,e,r){return new m1(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new $e(Oe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter(s=>s.length>0))}return new m1(e)}static emptyPath(){return new m1([])}}const o_e=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bs extends Rg{construct(t,e,r){return new bs(t,e,r)}static isValidIdentifier(t){return o_e.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bs.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new bs(["__name__"])}static fromServerFormat(t){const e=[];let r="",s=0;const i=()=>{if(0===r.length)throw new $e(Oe.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let o=!1;for(;s<t.length;){const c=t[s];if("\\"===c){if(s+1===t.length)throw new $e(Oe.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[s+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new $e(Oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,s+=2}else"`"===c?(o=!o,s++):"."!==c||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new $e(Oe.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new bs(e)}static emptyPath(){return new bs([])}}class lt{constructor(t){this.path=t}static fromPath(t){return new lt(m1.fromString(t))}static fromName(t){return new lt(m1.fromString(t).popFirst(5))}static empty(){return new lt(m1.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===m1.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return m1.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new lt(new m1(t.slice()))}}function CK(n){return new Ja(n.readTime,n.key,-1)}class Ja{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new Ja(cn.min(),lt.empty(),-1)}static max(){return new Ja(cn.max(),lt.empty(),-1)}}function sx(n,t){let e=n.readTime.compareTo(t.readTime);return 0!==e?e:(e=lt.comparator(n.documentKey,t.documentKey),0!==e?e:Sn(n.largestBatchId,t.largestBatchId))}const yK="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function Y0(n){return ix.apply(this,arguments)}function ix(){return ix=I(function*(n){if(n.code!==Oe.FAILED_PRECONDITION||n.message!==yK)throw n;qe("LocalStore","Unexpectedly lost primary lease")}),ix.apply(this,arguments)}class Se{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ot(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Se((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(e,i).next(r,s)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof Se?e:Se.resolve(e)}catch(e){return Se.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):Se.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):Se.reject(e)}static resolve(t){return new Se((e,r)=>{e(t)})}static reject(t){return new Se((e,r)=>{r(t)})}static waitFor(t){return new Se((e,r)=>{let s=0,i=0,o=!1;t.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&e()},u=>r(u))}),o=!0,i===s&&e()})}static or(t){let e=Se.resolve(!1);for(const r of t)e=e.next(s=>s?Se.resolve(s):r());return e}static forEach(t,e){const r=[];return t.forEach((s,i)=>{r.push(e.call(this,s,i))}),this.waitFor(r)}static mapArray(t,e){return new Se((r,s)=>{const i=t.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;e(t[h]).next(g=>{o[h]=g,++c,c===i&&r(o)},g=>s(g))}})}static doWhile(t,e){return new Se((r,s)=>{const i=()=>{!0===t()?e().next(()=>{i()},s):r()};i()})}}function K0(n){return"IndexedDbTransactionError"===n.name}class va{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>e.writeSequenceNumber(r))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}function MK(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function a5(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function SK(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}va.at=-1;class ds{constructor(t,e){this.comparator=t,this.root=e||N2.EMPTY}insert(t,e){return new ds(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,N2.BLACK,null,null))}remove(t){return new ds(this.comparator,this.root.remove(t,this.comparator).copy(null,null,N2.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(0===r)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(0===s)return e+r.left.size;s<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,r)=>(t(e,r),!1))}toString(){const t=[];return this.inorderTraversal((e,r)=>(t.push(`${e}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new OM(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new OM(this.root,t,this.comparator,!1)}getReverseIterator(){return new OM(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new OM(this.root,t,this.comparator,!0)}}class OM{constructor(t,e,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?r(t.key,e):1,e&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class N2{constructor(t,e,r,s,i){this.key=t,this.value=e,this.color=r??N2.RED,this.left=s??N2.EMPTY,this.right=i??N2.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,s,i){return new N2(t??this.key,e??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,r),null):0===i?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return N2.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return N2.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,N2.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,N2.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ot();const t=this.left.check();if(t!==this.right.check())throw Ot();return t+(this.isRed()?0:1)}}N2.EMPTY=null,N2.RED=!0,N2.BLACK=!1,N2.EMPTY=new class{constructor(){this.size=0}get key(){throw Ot()}get value(){throw Ot()}get color(){throw Ot()}get left(){throw Ot()}get right(){throw Ot()}copy(n,t,e,r,s){return this}insert(n,t,e){return new N2(n,t)}remove(n,t){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class tr{constructor(t){this.comparator=t,this.data=new ds(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,r)=>(t(e),!1))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let r;for(r=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new PK(this.data.getIterator())}getIteratorFrom(t){return new PK(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(r=>{e=e.add(r)}),e}isEqual(t){if(!(t instanceof tr)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(0!==this.comparator(s,i))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new tr(this.comparator);return e.data=t,e}}class PK{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ec{constructor(t){this.fields=t,t.sort(bs.comparator)}static empty(){return new ec([])}unionWith(t){let e=new tr(bs.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new ec(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Qf(this.fields,t.fields,(e,r)=>e.isEqual(r))}}class gi{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new gi(e)}static fromUint8Array(t){const e=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(t);return new gi(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Sn(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}gi.EMPTY_BYTE_STRING=new gi("");const p_e=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function X0(n){if(an(!!n),"string"==typeof n){let t=0;const e=p_e.exec(n);if(an(!!e),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:ps(n.seconds),nanos:ps(n.nanos)}}function ps(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function c5(n){return"string"==typeof n?gi.fromBase64String(n):gi.fromUint8Array(n)}function ax(n){var t,e;return"server_timestamp"===(null===(e=((null===(t=n?.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===e?void 0:e.stringValue)}function TK(n){const t=n.mapValue.fields.__previous_value__;return ax(t)?TK(t):t}function Vg(n){const t=X0(n.mapValue.fields.__local_write_time__.timestampValue);return new es(t.seconds,t.nanos)}class g_e{constructor(t,e,r,s,i,o,c,u){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.useFetchStreams=u}}class l5{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new l5("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof l5&&t.projectId===this.projectId&&t.database===this.database}}function Hg(n){return null==n}function Fg(n){return 0===n&&1/n==-1/0}const Q0_mapValue={fields:{__type__:{stringValue:"__max__"}}};function u5(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ax(n)?4:NK(n)?9007199254740991:10:Ot()}function z4(n,t){if(n===t)return!0;const e=u5(n);if(e!==u5(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Vg(n).isEqual(Vg(t));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=X0(r.timestampValue),o=X0(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return s=t,c5(n.bytesValue).isEqual(c5(s.bytesValue));case 7:return n.referenceValue===t.referenceValue;case 8:return function(r,s){return ps(r.geoPointValue.latitude)===ps(s.geoPointValue.latitude)&&ps(r.geoPointValue.longitude)===ps(s.geoPointValue.longitude)}(n,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return ps(r.integerValue)===ps(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=ps(r.doubleValue),o=ps(s.doubleValue);return i===o?Fg(i)===Fg(o):isNaN(i)&&isNaN(o)}return!1}(n,t);case 9:return Qf(n.arrayValue.values||[],t.arrayValue.values||[],z4);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(MK(i)!==MK(o))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(void 0===o[c]||!z4(i[c],o[c])))return!1;return!0}(n,t);default:return Ot()}var s}function Bg(n,t){return void 0!==(n.values||[]).find(e=>z4(e,t))}function J0(n,t){if(n===t)return 0;const e=u5(n),r=u5(t);if(e!==r)return Sn(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return Sn(n.booleanValue,t.booleanValue);case 2:return function(s,i){const o=ps(s.integerValue||s.doubleValue),c=ps(i.integerValue||i.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(n,t);case 3:return OK(n.timestampValue,t.timestampValue);case 4:return OK(Vg(n),Vg(t));case 5:return Sn(n.stringValue,t.stringValue);case 6:return function(s,i){const o=c5(s),c=c5(i);return o.compareTo(c)}(n.bytesValue,t.bytesValue);case 7:return function(s,i){const o=s.split("/"),c=i.split("/");for(let u=0;u<o.length&&u<c.length;u++){const h=Sn(o[u],c[u]);if(0!==h)return h}return Sn(o.length,c.length)}(n.referenceValue,t.referenceValue);case 8:return function(s,i){const o=Sn(ps(s.latitude),ps(i.latitude));return 0!==o?o:Sn(ps(s.longitude),ps(i.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(s,i){const o=s.values||[],c=i.values||[];for(let u=0;u<o.length&&u<c.length;++u){const h=J0(o[u],c[u]);if(h)return h}return Sn(o.length,c.length)}(n.arrayValue,t.arrayValue);case 10:return function(s,i){if(s===Q0_mapValue&&i===Q0_mapValue)return 0;if(s===Q0_mapValue)return 1;if(i===Q0_mapValue)return-1;const o=s.fields||{},c=Object.keys(o),u=i.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let g=0;g<c.length&&g<h.length;++g){const m=Sn(c[g],h[g]);if(0!==m)return m;const E=J0(o[c[g]],u[h[g]]);if(0!==E)return E}return Sn(c.length,h.length)}(n.mapValue,t.mapValue);default:throw Ot()}}function OK(n,t){if("string"==typeof n&&"string"==typeof t&&n.length===t.length)return Sn(n,t);const e=X0(n),r=X0(t),s=Sn(e.seconds,r.seconds);return 0!==s?s:Sn(e.nanos,r.nanos)}function eh(n){return cx(n)}function cx(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const s=X0(r);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?c5(n.bytesValue).toBase64():"referenceValue"in n?lt.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(t=n.geoPointValue).latitude},${t.longitude})`:"arrayValue"in n?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=cx(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of s)o?o=!1:i+=",",i+=`${c}:${cx(r.fields[c])}`;return i+"}"}(n.mapValue):Ot();var t}function f5(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function lx(n){return!!n&&"integerValue"in n}function $g(n){return!!n&&"arrayValue"in n}function bK(n){return!!n&&"nullValue"in n}function AK(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function AM(n){return!!n&&"mapValue"in n}function Ug(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return a5(n.mapValue.fields,(e,r)=>t.mapValue.fields[e]=Ug(r)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Ug(n.arrayValue.values[e]);return t}return Object.assign({},n)}function NK(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}class I2{constructor(t){this.value=t}static empty(){return new I2({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!AM(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ug(e)}setAll(t){let e=bs.emptyPath(),r={},s=[];t.forEach((o,c)=>{if(!e.isImmediateParentOf(c)){const u=this.getFieldsMap(e);this.applyChanges(u,r,s),r={},s=[],e=c.popLast()}o?r[c.lastSegment()]=Ug(o):s.push(c.lastSegment())});const i=this.getFieldsMap(e);this.applyChanges(i,r,s)}delete(t){const e=this.field(t.popLast());AM(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return z4(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=e.mapValue.fields[t.get(r)];AM(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,r){a5(e,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new I2(Ug(this.value))}}function kK(n){const t=[];return a5(n.fields,(e,r)=>{const s=new bs([e]);if(AM(r)){const i=kK(r.mapValue).fields;if(0===i.length)t.push(s);else for(const o of i)t.push(s.child(o))}else t.push(s)}),new ec(t)}class gr{constructor(t,e,r,s,i,o){this.key=t,this.documentType=e,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(t){return new gr(t,0,cn.min(),cn.min(),I2.empty(),0)}static newFoundDocument(t,e,r){return new gr(t,1,e,cn.min(),r,0)}static newNoDocument(t,e){return new gr(t,2,e,cn.min(),I2.empty(),0)}static newUnknownDocument(t,e){return new gr(t,3,e,cn.min(),I2.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=I2.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=I2.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=cn.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof gr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new gr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class v_e{constructor(t,e=null,r=[],s=[],i=null,o=null,c=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ht=null}}function LK(n,t=null,e=[],r=[],s=null,i=null,o=null){return new v_e(n,t,e,r,s,i,o)}function h5(n){const t=ht(n);if(null===t.ht){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+eh(s.value);var s}).join(","),e+="|ob:",e+=t.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),Hg(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(r=>eh(r)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(r=>eh(r)).join(",")),t.ht=e}return t.ht}function Gg(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!O_e(n.orderBy[s],t.orderBy[s]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if((e=n.filters[s]).op!==(r=t.filters[s]).op||!e.field.isEqual(r.field)||!z4(e.value,r.value))return!1;var e,r;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!HK(n.startAt,t.startAt)&&HK(n.endAt,t.endAt)}function NM(n){return lt.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class x2 extends class{}{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.lt(t,e,r):new y_e(t,e,r):"array-contains"===e?new S_e(t,r):"in"===e?new P_e(t,r):"not-in"===e?new T_e(t,r):"array-contains-any"===e?new w_e(t,r):new x2(t,e,r)}static lt(t,e,r){return"in"===e?new E_e(t,r):new M_e(t,r)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.ft(J0(e,this.value)):null!==e&&u5(this.value)===u5(e)&&this.ft(J0(e,this.value))}ft(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ot()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class y_e extends x2{constructor(t,e,r){super(t,e,r),this.key=lt.fromName(r.referenceValue)}matches(t){const e=lt.comparator(t.key,this.key);return this.ft(e)}}class E_e extends x2{constructor(t,e){super(t,"in",e),this.keys=zK(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class M_e extends x2{constructor(t,e){super(t,"not-in",e),this.keys=zK(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function zK(n,t){var e;return((null===(e=t.arrayValue)||void 0===e?void 0:e.values)||[]).map(r=>lt.fromName(r.referenceValue))}class S_e extends x2{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return $g(e)&&Bg(e.arrayValue,this.value)}}class P_e extends x2{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Bg(this.value.arrayValue,e)}}class T_e extends x2{constructor(t,e){super(t,"not-in",e)}matches(t){if(Bg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Bg(this.value.arrayValue,e)}}class w_e extends x2{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!$g(e)||!e.arrayValue.values)&&e.arrayValue.values.some(r=>Bg(this.value.arrayValue,r))}}class e8{constructor(t,e){this.position=t,this.inclusive=e}}class th{constructor(t,e="asc"){this.field=t,this.dir=e}}function O_e(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}function VK(n,t,e){let r=0;for(let s=0;s<n.position.length;s++){const i=t[s],o=n.position[s];if(r=i.field.isKeyField()?lt.comparator(lt.fromName(o.referenceValue),e.key):J0(o,e.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function HK(n,t){if(null===n)return null===t;if(null===t||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!z4(n.position[e],t.position[e]))return!1;return!0}class n6{constructor(t,e=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this._t=null,this.wt=null}}function nh(n){return new n6(n)}function BK(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function ux(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function fx(n){for(const t of n.filters)if(t.dt())return t.field;return null}function hx(n){return null!==n.collectionGroup}function rh(n){const t=ht(n);if(null===t._t){t._t=[];const e=fx(t),r=ux(t);if(null!==e&&null===r)e.isKeyField()||t._t.push(new th(e)),t._t.push(new th(bs.keyField(),"asc"));else{let s=!1;for(const i of t.explicitOrderBy)t._t.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new th(bs.keyField(),i))}}}return t._t}function Fo(n){const t=ht(n);if(!t.wt)if("F"===t.limitType)t.wt=LK(t.path,t.collectionGroup,rh(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of rh(t))e.push(new th(i.field,"desc"===i.dir?"asc":"desc"));const r=t.endAt?new e8(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new e8(t.startAt.position,t.startAt.inclusive):null;t.wt=LK(t.path,t.collectionGroup,e,t.filters,t.limit,r,s)}return t.wt}function xM(n,t,e){return new n6(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function qg(n,t){return Gg(Fo(n),Fo(t))&&n.limitType===t.limitType}function $K(n){return`${h5(Fo(n))}|lt:${n.limitType}`}function dx(n){return`Query(target=${function C_e(n){let t=n.path.canonicalString();return null!==n.collectionGroup&&(t+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(t+=`, filters: [${n.filters.map(e=>{return`${(r=e).field.canonicalString()} ${r.op} ${eh(r.value)}`;var r}).join(", ")}]`),Hg(n.limit)||(t+=", limit: "+n.limit),n.orderBy.length>0&&(t+=`, orderBy: [${n.orderBy.map(e=>{return`${(r=e).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(t+=", startAt: ",t+=n.startAt.inclusive?"b:":"a:",t+=n.startAt.position.map(e=>eh(e)).join(",")),n.endAt&&(t+=", endAt: ",t+=n.endAt.inclusive?"a:":"b:",t+=n.endAt.position.map(e=>eh(e)).join(",")),`Target(${t})`}(Fo(n))}; limitType=${n.limitType})`}function px(n,t){return t.isFoundDocument()&&function(e,r){const s=r.key.path;return null!==e.collectionGroup?r.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(s):lt.isDocumentKey(e.path)?e.path.isEqual(s):e.path.isImmediateParentOf(s)}(n,t)&&function(e,r){for(const s of e.explicitOrderBy)if(!s.field.isKeyField()&&null===r.data.field(s.field))return!1;return!0}(n,t)&&function(e,r){for(const s of e.filters)if(!s.matches(r))return!1;return!0}(n,t)&&(r=t,!((e=n).startAt&&!function(s,i,o){const c=VK(s,i,o);return s.inclusive?c<=0:c<0}(e.startAt,rh(e),r)||e.endAt&&!function(s,i,o){const c=VK(s,i,o);return s.inclusive?c>=0:c>0}(e.endAt,rh(e),r)));var e,r}function GK(n){return(t,e)=>{let r=!1;for(const s of rh(n)){const i=b_e(s,t,e);if(0!==i)return i;r=r||s.field.isKeyField()}return 0}}function b_e(n,t,e){const r=n.field.isKeyField()?lt.comparator(t.key,e.key):function(s,i,o){const c=i.data.field(s),u=o.data.field(s);return null!==c&&null!==u?J0(c,u):Ot()}(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ot()}}function qK(n,t){if(n.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fg(t)?"-0":t}}function WK(n){return{integerValue:""+n}}function jK(n,t){return function wK(n){return"number"==typeof n&&Number.isInteger(n)&&!Fg(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}(t)?WK(t):qK(n,t)}class kM{constructor(){this._=void 0}}function A_e(n,t,e){return n instanceof sh?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(e,t):n instanceof d5?YK(n,t):n instanceof p5?KK(n,t):function(r,s){const i=ZK(r,s),o=XK(i)+XK(r.yt);return lx(i)&&lx(r.yt)?WK(o):qK(r.It,o)}(n,t)}function N_e(n,t,e){return n instanceof d5?YK(n,t):n instanceof p5?KK(n,t):e}function ZK(n,t){return n instanceof ih?lx(e=t)||(r=e)&&"doubleValue"in r?t:{integerValue:0}:null;var r,e}class sh extends kM{}class d5 extends kM{constructor(t){super(),this.elements=t}}function YK(n,t){const e=QK(t);for(const r of n.elements)e.some(s=>z4(s,r))||e.push(r);return{arrayValue:{values:e}}}class p5 extends kM{constructor(t){super(),this.elements=t}}function KK(n,t){let e=QK(t);for(const r of n.elements)e=e.filter(s=>!z4(s,r));return{arrayValue:{values:e}}}class ih extends kM{constructor(t,e){super(),this.It=t,this.yt=e}}function XK(n){return ps(n.integerValue||n.doubleValue)}function QK(n){return $g(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Wg{constructor(t,e){this.field=t,this.transform=e}}class x_e{constructor(t,e){this.version=t,this.transformResults=e}}class $r{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new $r}static exists(t){return new $r(void 0,t)}static updateTime(t){return new $r(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function LM(n,t){return void 0!==n.updateTime?t.isFoundDocument()&&t.version.isEqual(n.updateTime):void 0===n.exists||n.exists===t.isFoundDocument()}class RM{}function JK(n,t){if(!n.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return n.isNoDocument()?new ah(n.key,$r.none()):new oh(n.key,n.data,$r.none());{const e=n.data,r=I2.empty();let s=new tr(bs.comparator);for(let i of t.fields)if(!s.has(i)){let o=e.field(i);null===o&&i.length>1&&(i=i.popLast(),o=e.field(i)),null===o?r.delete(i):r.set(i,o),s=s.add(i)}return new r6(n.key,r,new ec(s.toArray()),$r.none())}}function k_e(n,t,e){n instanceof oh?function(r,s,i){const o=r.value.clone(),c=nX(r.fieldTransforms,s,i.transformResults);o.setAll(c),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,t,e):n instanceof r6?function(r,s,i){if(!LM(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=nX(r.fieldTransforms,s,i.transformResults),c=s.data;c.setAll(tX(r)),c.setAll(o),s.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(n,t,e):t.convertToNoDocument(e.version).setHasCommittedMutations()}function jg(n,t,e,r){return n instanceof oh?function(s,i,o,c){if(!LM(s.precondition,i))return o;const u=s.value.clone(),h=rX(s.fieldTransforms,c,i);return u.setAll(h),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(n,t,e,r):n instanceof r6?function(s,i,o,c){if(!LM(s.precondition,i))return o;const u=rX(s.fieldTransforms,c,i),h=i.data;return h.setAll(tX(s)),h.setAll(u),i.convertToFoundDocument(i.version,h).setHasLocalMutations(),null===o?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,t,e,r):(o=e,LM(n.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o);var i,o}function L_e(n,t){let e=null;for(const r of n.fieldTransforms){const s=t.data.field(r.field),i=ZK(r.transform,s||null);null!=i&&(null===e&&(e=I2.empty()),e.set(r.field,i))}return e||null}function eX(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(e=n.fieldTransforms)&&void 0===r||e&&r&&Qf(e,r,(s,i)=>function I_e(n,t){return n.field.isEqual(t.field)&&(r=t.transform,(e=n.transform)instanceof d5&&r instanceof d5||e instanceof p5&&r instanceof p5?Qf(e.elements,r.elements,z4):e instanceof ih&&r instanceof ih?z4(e.yt,r.yt):e instanceof sh&&r instanceof sh);var e,r}(s,i))))&&(0===n.type?n.value.isEqual(t.value):1!==n.type||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask));var e,r}class oh extends RM{constructor(t,e,r,s=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class r6 extends RM{constructor(t,e,r,s,i=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function tX(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}}),t}function nX(n,t,e){const r=new Map;an(n.length===e.length);for(let s=0;s<e.length;s++){const i=n[s],o=i.transform,c=t.data.field(i.field);r.set(i.field,N_e(o,c,e[s]))}return r}function rX(n,t,e){const r=new Map;for(const s of n){const i=s.transform,o=e.data.field(s.field);r.set(s.field,A_e(i,o,t))}return r}class ah extends RM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gx extends RM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class R_e{constructor(t){this.count=t}}var Zs,_1;function sX(n){switch(n){default:return Ot();case Oe.CANCELLED:case Oe.UNKNOWN:case Oe.DEADLINE_EXCEEDED:case Oe.RESOURCE_EXHAUSTED:case Oe.INTERNAL:case Oe.UNAVAILABLE:case Oe.UNAUTHENTICATED:return!1;case Oe.INVALID_ARGUMENT:case Oe.NOT_FOUND:case Oe.ALREADY_EXISTS:case Oe.PERMISSION_DENIED:case Oe.FAILED_PRECONDITION:case Oe.ABORTED:case Oe.OUT_OF_RANGE:case Oe.UNIMPLEMENTED:case Oe.DATA_LOSS:return!0}}function iX(n){if(void 0===n)return Os("GRPC error has no .code"),Oe.UNKNOWN;switch(n){case Zs.OK:return Oe.OK;case Zs.CANCELLED:return Oe.CANCELLED;case Zs.UNKNOWN:return Oe.UNKNOWN;case Zs.DEADLINE_EXCEEDED:return Oe.DEADLINE_EXCEEDED;case Zs.RESOURCE_EXHAUSTED:return Oe.RESOURCE_EXHAUSTED;case Zs.INTERNAL:return Oe.INTERNAL;case Zs.UNAVAILABLE:return Oe.UNAVAILABLE;case Zs.UNAUTHENTICATED:return Oe.UNAUTHENTICATED;case Zs.INVALID_ARGUMENT:return Oe.INVALID_ARGUMENT;case Zs.NOT_FOUND:return Oe.NOT_FOUND;case Zs.ALREADY_EXISTS:return Oe.ALREADY_EXISTS;case Zs.PERMISSION_DENIED:return Oe.PERMISSION_DENIED;case Zs.FAILED_PRECONDITION:return Oe.FAILED_PRECONDITION;case Zs.ABORTED:return Oe.ABORTED;case Zs.OUT_OF_RANGE:return Oe.OUT_OF_RANGE;case Zs.UNIMPLEMENTED:return Oe.UNIMPLEMENTED;case Zs.DATA_LOSS:return Oe.DATA_LOSS;default:return Ot()}}(_1=Zs||(Zs={}))[_1.OK=0]="OK",_1[_1.CANCELLED=1]="CANCELLED",_1[_1.UNKNOWN=2]="UNKNOWN",_1[_1.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_1[_1.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_1[_1.NOT_FOUND=5]="NOT_FOUND",_1[_1.ALREADY_EXISTS=6]="ALREADY_EXISTS",_1[_1.PERMISSION_DENIED=7]="PERMISSION_DENIED",_1[_1.UNAUTHENTICATED=16]="UNAUTHENTICATED",_1[_1.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_1[_1.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_1[_1.ABORTED=10]="ABORTED",_1[_1.OUT_OF_RANGE=11]="OUT_OF_RANGE",_1[_1.UNIMPLEMENTED=12]="UNIMPLEMENTED",_1[_1.INTERNAL=13]="INTERNAL",_1[_1.UNAVAILABLE=14]="UNAVAILABLE",_1[_1.DATA_LOSS=15]="DATA_LOSS";class t8{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0!==r)for(const[s,i]of r)if(this.equalsFn(s,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const r=this.mapKeyFn(t),s=this.inner[r];if(void 0===s)return this.inner[r]=[[t,e]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0===r)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return 1===r.length?delete this.inner[e]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){a5(this.inner,(e,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return SK(this.inner)}size(){return this.innerSize}}const D_e=new ds(lt.comparator);function Ca(){return D_e}const oX=new ds(lt.comparator);function Zg(...n){let t=oX;for(const e of n)t=t.insert(e.key,e);return t}function aX(n){let t=oX;return n.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function V4(){return Yg()}function cX(){return Yg()}function Yg(){return new t8(n=>n.toString(),(n,t)=>n.isEqual(t))}const z_e=new ds(lt.comparator),V_e=new tr(lt.comparator);function kn(...n){let t=V_e;for(const e of n)t=t.add(e);return t}const H_e=new tr(Sn);function DM(){return H_e}class Kg{constructor(t,e,r,s,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const s=new Map;return s.set(t,Xg.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new Kg(cn.min(),s,DM(),Ca(),kn())}}class Xg{constructor(t,e,r,s,i){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new Xg(r,e,kn(),kn(),kn())}}class zM{constructor(t,e,r,s){this.Tt=t,this.removedTargetIds=e,this.key=r,this.Et=s}}class lX{constructor(t,e){this.targetId=t,this.At=e}}class uX{constructor(t,e,r=gi.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=s}}class fX{constructor(){this.Rt=0,this.bt=dX(),this.Pt=gi.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(t){t.approximateByteSize()>0&&(this.Vt=!0,this.Pt=t)}xt(){let t=kn(),e=kn(),r=kn();return this.bt.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:r=r.add(s);break;default:Ot()}}),new Xg(this.Pt,this.vt,t,e,r)}Nt(){this.Vt=!1,this.bt=dX()}kt(t,e){this.Vt=!0,this.bt=this.bt.insert(t,e)}Ot(t){this.Vt=!0,this.bt=this.bt.remove(t)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class F_e{constructor(t){this.Bt=t,this.Lt=new Map,this.Ut=Ca(),this.qt=hX(),this.Kt=new tr(Sn)}Gt(t){for(const e of t.Tt)t.Et&&t.Et.isFoundDocument()?this.Qt(e,t.Et):this.jt(e,t.key,t.Et);for(const e of t.removedTargetIds)this.jt(e,t.key,t.Et)}Wt(t){this.forEachTarget(t,e=>{const r=this.zt(e);switch(t.state){case 0:this.Ht(e)&&r.Ct(t.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(t.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(e);break;case 3:this.Ht(e)&&(r.$t(),r.Ct(t.resumeToken));break;case 4:this.Ht(e)&&(this.Jt(e),r.Ct(t.resumeToken));break;default:Ot()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Lt.forEach((r,s)=>{this.Ht(s)&&e(s)})}Yt(t){const e=t.targetId,r=t.At.count,s=this.Xt(e);if(s){const i=s.target;if(NM(i))if(0===r){const o=new lt(i.path);this.jt(e,o,gr.newNoDocument(o,cn.min()))}else an(1===r);else this.Zt(e)!==r&&(this.Jt(e),this.Kt=this.Kt.add(e))}}te(t){const e=new Map;this.Lt.forEach((i,o)=>{const c=this.Xt(o);if(c){if(i.current&&NM(c.target)){const u=new lt(c.target.path);null!==this.Ut.get(u)||this.ee(o,u)||this.jt(o,u,gr.newNoDocument(u,t))}i.Dt&&(e.set(o,i.xt()),i.Nt())}});let r=kn();this.qt.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Xt(u);return!h||2===h.purpose||(c=!1,!1)}),c&&(r=r.add(i))}),this.Ut.forEach((i,o)=>o.setReadTime(t));const s=new Kg(t,e,this.Kt,this.Ut,r);return this.Ut=Ca(),this.qt=hX(),this.Kt=new tr(Sn),s}Qt(t,e){if(!this.Ht(t))return;const r=this.ee(t,e.key)?2:0;this.zt(t).kt(e.key,r),this.Ut=this.Ut.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ne(e.key).add(t))}jt(t,e,r){if(!this.Ht(t))return;const s=this.zt(t);this.ee(t,e)?s.kt(e,1):s.Ot(e),this.qt=this.qt.insert(e,this.ne(e).delete(t)),r&&(this.Ut=this.Ut.insert(e,r))}removeTarget(t){this.Lt.delete(t)}Zt(t){const e=this.zt(t).xt();return this.Bt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Mt(t){this.zt(t).Mt()}zt(t){let e=this.Lt.get(t);return e||(e=new fX,this.Lt.set(t,e)),e}ne(t){let e=this.qt.get(t);return e||(e=new tr(Sn),this.qt=this.qt.insert(t,e)),e}Ht(t){const e=null!==this.Xt(t);return e||qe("WatchChangeAggregator","Detected inactive target",t),e}Xt(t){const e=this.Lt.get(t);return e&&e.St?null:this.Bt.se(t)}Jt(t){this.Lt.set(t,new fX),this.Bt.getRemoteKeysForTarget(t).forEach(e=>{this.jt(t,e,null)})}ee(t,e){return this.Bt.getRemoteKeysForTarget(t).has(e)}}function hX(){return new ds(lt.comparator)}function dX(){return new ds(lt.comparator)}const B_e={asc:"ASCENDING",desc:"DESCENDING"},$_e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class U_e{constructor(t,e){this.databaseId=t,this.gt=e}}function Qg(n,t){return n.gt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function pX(n,t){return n.gt?t.toBase64():t.toUint8Array()}function G_e(n,t){return Qg(n,t.toTimestamp())}function qi(n){return an(!!n),cn.fromTimestamp(function(t){const e=X0(t);return new es(e.seconds,e.nanos)}(n))}function mx(n,t){return(e=n,new m1(["projects",e.projectId,"databases",e.database])).child("documents").child(t).canonicalString();var e}function gX(n){const t=m1.fromString(n);return an(SX(t)),t}function Jg(n,t){return mx(n.databaseId,t.path)}function H4(n,t){const e=gX(t);if(e.get(1)!==n.databaseId.projectId)throw new $e(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new $e(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new lt(_X(e))}function _x(n,t){return mx(n.databaseId,t)}function em(n){return new m1(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function _X(n){return an(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function vX(n,t,e){return{name:Jg(n,t),fields:e.value.mapValue.fields}}function yX(n,t){return{documents:[_x(n,t.path)]}}function Cx(n,t){const e={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(e.parent=_x(n,r),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=_x(n,r.popLast()),e.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(u){if(0===u.length)return;const h=u.map(g=>function(m){if("=="===m.op){if(AK(m.value))return{unaryFilter:{field:ch(m.field),op:"IS_NAN"}};if(bK(m.value))return{unaryFilter:{field:ch(m.field),op:"IS_NULL"}}}else if("!="===m.op){if(AK(m.value))return{unaryFilter:{field:ch(m.field),op:"IS_NOT_NAN"}};if(bK(m.value))return{unaryFilter:{field:ch(m.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ch(m.field),op:K_e(m.op),value:m.value}}}(g));return 1===h.length?h[0]:{compositeFilter:{op:"AND",filters:h}}}(t.filters);s&&(e.structuredQuery.where=s);const i=function(u){if(0!==u.length)return u.map(h=>{return{field:ch((g=h).field),direction:Y_e(g.dir)};var g})}(t.orderBy);i&&(e.structuredQuery.orderBy=i);const o=(h=t.limit,n.gt||Hg(h)?h:{value:h});var h,c,u;return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt={before:(c=t.startAt).inclusive,values:c.position}),t.endAt&&(e.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),e}function EX(n){let t=function mX(n){const t=gX(n);return 4===t.length?m1.emptyPath():_X(t)}(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let s=null;if(r>0){an(1===r);const g=e.from[0];g.allDescendants?s=g.collectionId:t=t.child(g.collectionId)}let i=[];e.where&&(i=MX(e.where));let o=[];e.orderBy&&(o=e.orderBy.map(g=>{return new th(lh((m=g).field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction));var m}));let c=null;e.limit&&(c=function(g){let m;return m="object"==typeof g?g.value:g,Hg(m)?null:m}(e.limit));let u=null;var g;e.startAt&&(u=new e8((g=e.startAt).values||[],!!g.before));let h=null;return e.endAt&&(h=function(g){return new e8(g.values||[],!g.before)}(e.endAt)),function FK(n,t,e,r,s,i,o,c){return new n6(n,t,e,r,s,i,o,c)}(t,s,o,i,c,"F",u,h)}function MX(n){return n?void 0!==n.unaryFilter?[Q_e(n)]:void 0!==n.fieldFilter?[X_e(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(t=>MX(t)).reduce((t,e)=>t.concat(e)):Ot():[]}function Y_e(n){return B_e[n]}function K_e(n){return $_e[n]}function ch(n){return{fieldPath:n.canonicalString()}}function lh(n){return bs.fromServerFormat(n.fieldPath)}function X_e(n){return x2.create(lh(n.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ot()}}(n.fieldFilter.op),n.fieldFilter.value)}function Q_e(n){switch(n.unaryFilter.op){case"IS_NAN":const t=lh(n.unaryFilter.field);return x2.create(t,"==",{doubleValue:NaN});case"IS_NULL":const e=lh(n.unaryFilter.field);return x2.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=lh(n.unaryFilter.field);return x2.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=lh(n.unaryFilter.field);return x2.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Ot()}}function J_e(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function SX(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class Ex{constructor(t,e,r,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&k_e(i,t,r[s])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=jg(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=jg(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=cX();return this.mutations.forEach(s=>{const i=t.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=e.has(s.key)?null:c;const u=JK(o,c);null!==u&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(cn.min())}),r}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),kn())}isEqual(t){return this.batchId===t.batchId&&Qf(this.mutations,t.mutations,(e,r)=>eX(e,r))&&Qf(this.baseMutations,t.baseMutations,(e,r)=>eX(e,r))}}class Mx{constructor(t,e,r,s){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=s}static from(t,e,r){an(t.mutations.length===r.length);let s=z_e;const i=t.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Mx(t,e,r,s)}}class Sx{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class n8{constructor(t,e,r,s,i=cn.min(),o=cn.min(),c=gi.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c}withSequenceNumber(t){return new n8(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new n8(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new n8(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class NX{constructor(t){this.re=t}}function Px(n){const t=EX({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?xM(t,t.limit,"L"):t}class v5{constructor(){}ce(t,e){this.ae(t,e),e.he()}ae(t,e){if("nullValue"in t)this.le(e,5);else if("booleanValue"in t)this.le(e,10),e.fe(t.booleanValue?1:0);else if("integerValue"in t)this.le(e,15),e.fe(ps(t.integerValue));else if("doubleValue"in t){const r=ps(t.doubleValue);isNaN(r)?this.le(e,13):(this.le(e,15),Fg(r)?e.fe(0):e.fe(r))}else if("timestampValue"in t){const r=t.timestampValue;this.le(e,20),"string"==typeof r?e.de(r):(e.de(`${r.seconds||""}`),e.fe(r.nanos||0))}else if("stringValue"in t)this._e(t.stringValue,e),this.we(e);else if("bytesValue"in t)this.le(e,30),e.me(c5(t.bytesValue)),this.we(e);else if("referenceValue"in t)this.ge(t.referenceValue,e);else if("geoPointValue"in t){const r=t.geoPointValue;this.le(e,45),e.fe(r.latitude||0),e.fe(r.longitude||0)}else"mapValue"in t?NK(t)?this.le(e,Number.MAX_SAFE_INTEGER):(this.ye(t.mapValue,e),this.we(e)):"arrayValue"in t?(this.pe(t.arrayValue,e),this.we(e)):Ot()}_e(t,e){this.le(e,25),this.Ie(t,e)}Ie(t,e){e.de(t)}ye(t,e){const r=t.fields||{};this.le(e,55);for(const s of Object.keys(r))this._e(s,e),this.ae(r[s],e)}pe(t,e){const r=t.values||[];this.le(e,50);for(const s of r)this.ae(s,e)}ge(t,e){this.le(e,37),lt.fromName(t).path.forEach(r=>{this.le(e,60),this.Ie(r,e)})}le(t,e){t.fe(e)}we(t){t.fe(2)}}v5.Te=new v5;class Tve{constructor(){this.Ye=new wx}addToCollectionParentIndex(t,e){return this.Ye.add(e),Se.resolve()}getCollectionParents(t,e){return Se.resolve(this.Ye.getEntries(e))}addFieldIndex(t,e){return Se.resolve()}deleteFieldIndex(t,e){return Se.resolve()}getDocumentsMatchingTarget(t,e){return Se.resolve(null)}getIndexType(t,e){return Se.resolve(0)}getFieldIndexes(t,e){return Se.resolve([])}getNextCollectionGroupToUpdate(t){return Se.resolve(null)}getMinOffset(t,e){return Se.resolve(Ja.min())}getMinOffsetFromCollectionGroup(t,e){return Se.resolve(Ja.min())}updateCollectionGroup(t,e,r){return Se.resolve()}updateIndexEntries(t,e){return Se.resolve()}}class wx{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e]||new tr(m1.comparator),i=!s.has(r);return this.index[e]=s.add(r),i}has(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e];return s&&s.has(r)}getEntries(t){return(this.index[t]||new tr(m1.comparator)).toArray()}}new Uint8Array(0);class ya{constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}static withCacheSize(t){return new ya(t,ya.DEFAULT_COLLECTION_PERCENTILE,ya.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}ya.DEFAULT_COLLECTION_PERCENTILE=10,ya.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ya.DEFAULT=new ya(41943040,ya.DEFAULT_COLLECTION_PERCENTILE,ya.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ya.DISABLED=new ya(-1,0,0);class E5{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new E5(0)}static vn(){return new E5(-1)}}class Rve{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class XX{constructor(t,e,r,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next(s=>(r=s,this.getBaseDocument(t,e,r))).next(s=>(null!==r&&jg(r.mutation,s,ec.empty(),es.now()),s))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.getLocalViewOfDocuments(t,r,kn()).next(()=>r))}getLocalViewOfDocuments(t,e,r=kn()){const s=V4();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,r).next(i=>{let o=Zg();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const r=V4();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,kn()))}populateOverlays(t,e,r){const s=[];return r.forEach(i=>{e.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((o,c)=>{e.set(o,c)})})}computeViews(t,e,r,s){let i=Ca();const o=Yg(),c=Yg();return e.forEach((u,h)=>{const g=r.get(h.key);s.has(h.key)&&(void 0===g||g.mutation instanceof r6)?i=i.insert(h.key,h):void 0!==g&&(o.set(h.key,g.mutation.getFieldMask()),jg(g.mutation,h,g.mutation.getFieldMask(),es.now()))}),this.recalculateAndSaveOverlays(t,i).next(u=>(u.forEach((h,g)=>o.set(h,g)),e.forEach((h,g)=>{var m;return c.set(h,new Rve(g,null!==(m=o.get(h))&&void 0!==m?m:null))}),c))}recalculateAndSaveOverlays(t,e){const r=Yg();let s=new ds((o,c)=>o-c),i=kn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=e.get(u);if(null===h)return;let g=r.get(u)||ec.empty();g=c.applyToLocalView(h,g),r.set(u,g);const m=(s.get(c.batchId)||kn()).add(u);s=s.insert(c.batchId,m)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,g=u.value,m=cX();g.forEach(E=>{if(!i.has(E)){const O=JK(e.get(E),r.get(E));null!==O&&m.set(E,O),i=i.add(E)}}),o.push(this.documentOverlayCache.saveOverlays(t,h,m))}return Se.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,e,r){return lt.isDocumentKey((s=e).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):hx(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r):this.getDocumentsMatchingCollectionQuery(t,e,r);var s}getNextDocuments(t,e,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,s-i.size):Se.resolve(V4());let c=-1,u=i;return o.next(h=>Se.forEach(h,(g,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(g)?Se.resolve():this.getBaseDocument(t,g,m).next(E=>{u=u.insert(g,E)}))).next(()=>this.populateOverlays(t,h,i)).next(()=>this.computeViews(t,u,h,kn())).next(g=>({batchId:c,changes:aX(g)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new lt(e)).next(r=>{let s=Zg();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,e,r){const s=e.collectionGroup;let i=Zg();return this.indexManager.getCollectionParents(t,s).next(o=>Se.forEach(o,c=>{const u=(h=e,g=c.child(s),new n6(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,g;return this.getDocumentsMatchingCollectionQuery(t,u,r).next(h=>{h.forEach((g,m)=>{i=i.insert(g,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,e,r){let s;return this.remoteDocumentCache.getAllFromCollection(t,e.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId))).next(i=>{i.forEach((c,u)=>{const h=u.getKey();null===s.get(h)&&(s=s.insert(h,gr.newInvalidDocument(h)))});let o=Zg();return s.forEach((c,u)=>{const h=i.get(c);void 0!==h&&jg(h.mutation,u,ec.empty(),es.now()),px(e,u)&&(o=o.insert(c,u))}),o})}getBaseDocument(t,e,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(t,e):Se.resolve(gr.newInvalidDocument(e))}}class Dve{constructor(t){this.It=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return Se.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var r;return this.Zn.set(e.id,{id:(r=e).id,version:r.version,createTime:qi(r.createTime)}),Se.resolve()}getNamedQuery(t,e){return Se.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,{name:(r=e).name,query:Px(r.bundledQuery),readTime:qi(r.readTime)}),Se.resolve();var r}}class zve{constructor(){this.overlays=new ds(lt.comparator),this.es=new Map}getOverlay(t,e){return Se.resolve(this.overlays.get(e))}getOverlays(t,e){const r=V4();return Se.forEach(e,s=>this.getOverlay(t,s).next(i=>{null!==i&&r.set(s,i)})).next(()=>r)}saveOverlays(t,e,r){return r.forEach((s,i)=>{this.ue(t,e,i)}),Se.resolve()}removeOverlaysForBatchId(t,e,r){const s=this.es.get(r);return void 0!==s&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.es.delete(r)),Se.resolve()}getOverlaysForCollection(t,e,r){const s=V4(),i=e.length+1,o=new lt(e.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!e.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return Se.resolve(s)}getOverlaysForCollectionGroup(t,e,r,s){let i=new ds((h,g)=>h-g);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===e&&h.largestBatchId>r){let g=i.get(h.largestBatchId);null===g&&(g=V4(),i=i.insert(h.largestBatchId,g)),g.set(h.getKey(),h)}}const c=V4(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,g)=>c.set(h,g)),!(c.size()>=s)););return Se.resolve(c)}ue(t,e,r){const s=this.overlays.get(r.key);if(null!==s){const o=this.es.get(s.largestBatchId).delete(r.key);this.es.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Sx(e,r));let i=this.es.get(e);void 0===i&&(i=kn(),this.es.set(e,i)),this.es.set(e,i.add(r.key))}}class Ox{constructor(){this.ns=new tr(ji.ss),this.rs=new tr(ji.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const r=new ji(t,e);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(t,e){t.forEach(r=>this.addReference(r,e))}removeReference(t,e){this.cs(new ji(t,e))}hs(t,e){t.forEach(r=>this.removeReference(r,e))}ls(t){const e=new lt(new m1([])),r=new ji(e,t),s=new ji(e,t+1),i=[];return this.rs.forEachInRange([r,s],o=>{this.cs(o),i.push(o.key)}),i}fs(){this.ns.forEach(t=>this.cs(t))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new lt(new m1([])),r=new ji(e,t),s=new ji(e,t+1);let i=kn();return this.rs.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(t){const e=new ji(t,0),r=this.ns.firstAfterOrEqual(e);return null!==r&&t.isEqual(r.key)}}class ji{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return lt.comparator(t.key,e.key)||Sn(t._s,e._s)}static os(t,e){return Sn(t._s,e._s)||lt.comparator(t.key,e.key)}}class Vve{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new tr(ji.ss)}checkEmpty(t){return Se.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,r,s){const i=this.ws;this.ws++;const o=new Ex(i,e,r,s);this.mutationQueue.push(o);for(const c of s)this.gs=this.gs.add(new ji(c.key,i)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast());return Se.resolve(o)}lookupMutationBatch(t,e){return Se.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const s=this.ps(e+1),i=s<0?0:s;return Se.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Se.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return Se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new ji(e,0),s=new ji(e,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([r,s],o=>{const c=this.ys(o._s);i.push(c)}),Se.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new tr(Sn);return e.forEach(s=>{const i=new ji(s,0),o=new ji(s,Number.POSITIVE_INFINITY);this.gs.forEachInRange([i,o],c=>{r=r.add(c._s)})}),Se.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,s=r.length+1;let i=r;lt.isDocumentKey(i)||(i=i.child(""));const o=new ji(new lt(i),0);let c=new tr(Sn);return this.gs.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(u._s)),!0)},o),Se.resolve(this.Is(c))}Is(t){const e=[];return t.forEach(r=>{const s=this.ys(r);null!==s&&e.push(s)}),e}removeMutationBatch(t,e){an(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return Se.forEach(e.mutations,s=>{const i=new ji(s.key,e.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.gs=r})}An(t){}containsKey(t,e){const r=new ji(e,0),s=this.gs.firstAfterOrEqual(r);return Se.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return Se.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Hve{constructor(t){this.Es=t,this.docs=new ds(lt.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,s=this.docs.get(r),i=s?s.size:0,o=this.Es(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return Se.resolve(r?r.document.mutableCopy():gr.newInvalidDocument(e))}getEntries(t,e){let r=Ca();return e.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():gr.newInvalidDocument(s))}),Se.resolve(r)}getAllFromCollection(t,e,r){let s=Ca();const i=new lt(e.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:c,value:{document:u}}=o.getNext();if(!e.isPrefixOf(c.path))break;c.path.length>e.length+1||sx(CK(u),r)<=0||(s=s.insert(u.key,u.mutableCopy()))}return Se.resolve(s)}getAllFromCollectionGroup(t,e,r,s){Ot()}As(t,e){return Se.forEach(this.docs,r=>e(r))}newChangeBuffer(t){return new Fve(this)}getSize(t){return Se.resolve(this.size)}}class Fve extends class xve{constructor(){this.changes=new t8(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,gr.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return void 0!==r?Se.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?e.push(this.Yn.addEntry(t,s)):this.Yn.removeEntry(r)}),Se.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class Bve{constructor(t){this.persistence=t,this.Rs=new t8(e=>h5(e),Gg),this.lastRemoteSnapshotVersion=cn.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Ox,this.targetCount=0,this.vs=E5.Pn()}forEachTarget(t,e){return this.Rs.forEach((r,s)=>e(s)),Se.resolve()}getLastRemoteSnapshotVersion(t){return Se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Se.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),Se.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.bs&&(this.bs=e),Se.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new E5(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,Se.resolve()}updateTargetData(t,e){return this.Dn(e),Se.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,Se.resolve()}removeTargets(t,e,r){let s=0;const i=[];return this.Rs.forEach((o,c)=>{c.sequenceNumber<=e&&null===r.get(c.targetId)&&(this.Rs.delete(o),i.push(this.removeMatchingKeysForTargetId(t,c.targetId)),s++)}),Se.waitFor(i).next(()=>s)}getTargetCount(t){return Se.resolve(this.targetCount)}getTargetData(t,e){const r=this.Rs.get(e)||null;return Se.resolve(r)}addMatchingKeys(t,e,r){return this.Ps.us(e,r),Se.resolve()}removeMatchingKeys(t,e,r){this.Ps.hs(e,r);const s=this.persistence.referenceDelegate,i=[];return s&&e.forEach(o=>{i.push(s.markPotentiallyOrphaned(t,o))}),Se.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),Se.resolve()}getMatchingKeysForTargetId(t,e){const r=this.Ps.ds(e);return Se.resolve(r)}containsKey(t,e){return Se.resolve(this.Ps.containsKey(e))}}class QX{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new va(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new Bve(this),this.indexManager=new Tve,this.remoteDocumentCache=new Hve(r=>this.referenceDelegate.xs(r)),this.It=new NX(e),this.Ns=new Dve(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new zve,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.Vs[t.toKey()];return r||(r=new Vve(e,this.referenceDelegate),this.Vs[t.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,r){qe("MemoryPersistence","Starting transaction:",t);const s=new $ve(this.Ss.next());return this.referenceDelegate.ks(),r(s).next(i=>this.referenceDelegate.Os(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ms(t,e){return Se.or(Object.values(this.Vs).map(r=>()=>r.containsKey(t,e)))}}class $ve extends class l_e{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}{constructor(t){super(),this.currentSequenceNumber=t}}class WM{constructor(t){this.persistence=t,this.Fs=new Ox,this.$s=null}static Bs(t){return new WM(t)}get Ls(){if(this.$s)return this.$s;throw Ot()}addReference(t,e,r){return this.Fs.addReference(r,e),this.Ls.delete(r.toString()),Se.resolve()}removeReference(t,e,r){return this.Fs.removeReference(r,e),this.Ls.add(r.toString()),Se.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),Se.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach(s=>this.Ls.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(s=>{s.forEach(i=>this.Ls.add(i.toString()))}).next(()=>r.removeTargetData(t,e))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Se.forEach(this.Ls,r=>{const s=lt.fromPath(r);return this.Us(t,s).next(i=>{i||e.removeEntry(s,cn.min())})}).next(()=>(this.$s=null,e.apply(t)))}updateLimboDocument(t,e){return this.Us(t,e).next(r=>{r?this.Ls.delete(e.toString()):this.Ls.add(e.toString())})}xs(t){return 0}Us(t,e){return Se.or([()=>Se.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class Ix{constructor(t,e,r,s){this.targetId=t,this.fromCache=e,this.Si=r,this.Di=s}static Ci(t,e){let r=kn(),s=kn();for(const i of e.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ix(t,e.fromCache,r,s)}}class eQ{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,r,s){return this.ki(t,e).next(i=>i||this.Oi(t,e,s,r)).next(i=>i||this.Mi(t,e))}ki(t,e){if(BK(e))return Se.resolve(null);let r=Fo(e);return this.indexManager.getIndexType(t,r).next(s=>0===s?null:(null!==e.limit&&1===s&&(e=xM(e,null,"F"),r=Fo(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=kn(...i);return this.Ni.getDocuments(t,o).next(c=>this.indexManager.getMinOffset(t,r).next(u=>{const h=this.Fi(e,c);return this.$i(e,h,o,u.readTime)?this.ki(t,xM(e,null,"F")):this.Bi(t,h,e,u)}))})))}Oi(t,e,r,s){return BK(e)||s.isEqual(cn.min())?this.Mi(t,e):this.Ni.getDocuments(t,r).next(i=>{const o=this.Fi(e,i);return this.$i(e,o,r,s)?this.Mi(t,e):(tx()<=g1.DEBUG&&qe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),dx(e)),this.Bi(t,o,e,function vK(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=cn.fromTimestamp(1e9===r?new es(e+1,0):new es(e,r));return new Ja(s,lt.empty(),t)}(s,-1)))})}Fi(t,e){let r=new tr(GK(t));return e.forEach((s,i)=>{px(t,i)&&(r=r.add(i))}),r}$i(t,e,r,s){if(null===t.limit)return!1;if(r.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(t,e){return tx()<=g1.DEBUG&&qe("QueryEngine","Using full collection scan to execute query:",dx(e)),this.Ni.getDocumentsMatchingQuery(t,e,Ja.min())}Bi(t,e,r,s){return this.Ni.getDocumentsMatchingQuery(t,r,s).next(i=>(e.forEach(o=>{i=i.insert(o.key,o)}),i))}}class Gve{constructor(t,e,r,s){this.persistence=t,this.Li=e,this.It=s,this.Ui=new ds(Sn),this.qi=new t8(i=>h5(i),Gg),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(r)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new XX(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ui))}}function nQ(n,t){return xx.apply(this,arguments)}function xx(){return xx=I(function*(n,t){const e=ht(n);return yield e.persistence.runTransaction("Handle user change","readonly",r=>{let s;return e.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,e.Qi(t),e.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=kn();for(const h of s){o.push(h.batchId);for(const g of h.mutations)u=u.add(g.key)}for(const h of i){c.push(h.batchId);for(const g of h.mutations)u=u.add(g.key)}return e.localDocuments.getDocuments(r,u).next(h=>({ji:h,removedBatchIds:o,addedBatchIds:c}))})})}),xx.apply(this,arguments)}function qve(n,t){const e=ht(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=e.Gi.newChangeBuffer({trackRemovals:!0});return function(o,c,u,h){const g=u.batch,m=g.keys();let E=Se.resolve();return m.forEach(O=>{E=E.next(()=>h.getEntry(c,O)).next(k=>{const U=u.docVersions.get(O);an(null!==U),k.version.compareTo(U)<0&&(g.applyToRemoteDocument(k,u),k.isValidDocument()&&(k.setReadTime(u.commitVersion),h.addEntry(k)))})}),E.next(()=>o.mutationQueue.removeMutationBatch(c,g))}(e,r,t,i).next(()=>i.apply(r)).next(()=>e.mutationQueue.performConsistencyCheck(r)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let c=kn();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(c=c.add(o.batch.mutations[u].key));return c}(t))).next(()=>e.localDocuments.getDocuments(r,s))})}function rQ(n){const t=ht(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Cs.getLastRemoteSnapshotVersion(e))}function Wve(n,t){const e=ht(n),r=t.snapshotVersion;let s=e.Ui;return e.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=e.Gi.newChangeBuffer({trackRemovals:!0});s=e.Ui;const c=[];t.targetChanges.forEach((g,m)=>{const E=s.get(m);if(!E)return;c.push(e.Cs.removeMatchingKeys(i,g.removedDocuments,m).next(()=>e.Cs.addMatchingKeys(i,g.addedDocuments,m)));let O=E.withSequenceNumber(i.currentSequenceNumber);var k,U,j;t.targetMismatches.has(m)?O=O.withResumeToken(gi.EMPTY_BYTE_STRING,cn.min()).withLastLimboFreeSnapshotVersion(cn.min()):g.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(g.resumeToken,r)),s=s.insert(m,O),U=O,j=g,(0===(k=E).resumeToken.approximateByteSize()||U.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8||j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0)&&c.push(e.Cs.updateTargetData(i,O))});let u=Ca(),h=kn();if(t.documentUpdates.forEach(g=>{t.resolvedLimboDocuments.has(g)&&c.push(e.persistence.referenceDelegate.updateLimboDocument(i,g))}),c.push(function sQ(n,t,e){let r=kn(),s=kn();return e.forEach(i=>r=r.add(i)),t.getEntries(n,r).next(i=>{let o=Ca();return e.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(cn.min())?(t.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||0===u.version.compareTo(h.version)&&h.hasPendingWrites?(t.addEntry(u),o=o.insert(c,u)):qe("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Wi:o,zi:s}})}(i,o,t.documentUpdates).next(g=>{u=g.Wi,h=g.zi})),!r.isEqual(cn.min())){const g=e.Cs.getLastRemoteSnapshotVersion(i).next(m=>e.Cs.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(g)}return Se.waitFor(c).next(()=>o.apply(i)).next(()=>e.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(e.Ui=s,i))}function jve(n,t){const e=ht(n);return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function hh(n,t){const e=ht(n);return e.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return e.Cs.getTargetData(r,t).next(i=>i?(s=i,Se.resolve(s)):e.Cs.allocateTargetId(r).next(o=>(s=new n8(t,o,0,r.currentSequenceNumber),e.Cs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=e.Ui.get(r.targetId);return(null===s||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ui=e.Ui.insert(r.targetId,r),e.qi.set(t,r.targetId)),r})}function dh(n,t,e){return kx.apply(this,arguments)}function kx(){return kx=I(function*(n,t,e){const r=ht(n),s=r.Ui.get(t),i=e?"readwrite":"readwrite-primary";try{e||(yield r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!K0(o))throw o;qe("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.Ui=r.Ui.remove(t),r.qi.delete(s.target)}),kx.apply(this,arguments)}function ZM(n,t,e){const r=ht(n);let s=cn.min(),i=kn();return r.persistence.runTransaction("Execute query","readonly",o=>function(c,u,h){const g=ht(c),m=g.qi.get(h);return void 0!==m?Se.resolve(g.Ui.get(m)):g.Cs.getTargetData(u,h)}(r,o,Fo(t)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Li.getDocumentsMatchingQuery(o,t,e?s:cn.min(),e?i:kn())).next(c=>(function aQ(n,t,e){let r=n.Ki.get(t)||cn.min();e.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Ki.set(t,r)}(r,function UK(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}(t),c),{documents:c,Hi:i})))}class Vx{constructor(){this.activeTargetIds=DM()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class uQ{constructor(){this.Lr=new Vx,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t){return this.Lr.er(t),this.Ur[t]||"not-current"}updateQueryState(t,e,r){this.Ur[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.Ur[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new Vx,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Kve{qr(t){}shutdown(){}}class fQ{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){qe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){qe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Xve={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Qve{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class Jve extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.oo=(t.ssl?"https":"http")+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,r,s,i){const o=this.ho(t,e);qe("RestConnection","Sending: ",o,r);const c={};return this.lo(c,s,i),this.fo(t,o,c,r).then(u=>(qe("RestConnection","Received: ",u),u),u=>{throw Xf("RestConnection",`${t} failed with error: `,u,"url: ",o,"request:",r),u})}_o(t,e,r,s,i,o){return this.ao(t,e,r,s,i)}lo(t,e,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+Kf,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((s,i)=>t[i]=s),r&&r.headers.forEach((s,i)=>t[i]=s)}ho(t,e){return`${this.oo}/v1/${e}:${Xve[t]}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,r,s){return new Promise((i,o)=>{const c=new Qme;c.setWithCredentials(!0),c.listenOnce(Yme.COMPLETE,()=>{var h;try{switch(c.getLastErrorCode()){case ex.NO_ERROR:const g=c.getResponseJson();qe("Connection","XHR received:",JSON.stringify(g)),i(g);break;case ex.TIMEOUT:qe("Connection",'RPC "'+t+'" timed out'),o(new $e(Oe.DEADLINE_EXCEEDED,"Request time out"));break;case ex.HTTP_ERROR:const m=c.getStatus();if(qe("Connection",'RPC "'+t+'" failed with status:',m,"response text:",c.getResponseText()),m>0){let E=c.getResponseJson();Array.isArray(E)&&(E=E[0]);const O=null===(h=E)||void 0===h?void 0:h.error;if(O&&O.status&&O.message){const k=function(U){const j=U.toLowerCase().replace(/_/g,"-");return Object.values(Oe).indexOf(j)>=0?j:Oe.UNKNOWN}(O.status);o(new $e(k,O.message))}else o(new $e(Oe.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new $e(Oe.UNAVAILABLE,"Connection failed."));break;default:Ot()}}finally{qe("Connection",'RPC "'+t+'" completed.')}});const u=JSON.stringify(s);c.send(e,"POST",u,r,15)})}wo(t,e,r){const s=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=jme(),o=Zme(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(c.xmlHttpFactory=new Xme({})),this.lo(c.initMessageHeaders,e,r),c.encodeInitMessageHeaders=!0;const u=s.join("");qe("Connection","Creating WebChannel: "+u,c);const h=i.createWebChannel(u,c);let g=!1,m=!1;const E=new Qve({Hr:k=>{m?qe("Connection","Not sending because WebChannel is closed:",k):(g||(qe("Connection","Opening WebChannel transport."),h.open(),g=!0),qe("Connection","WebChannel sending:",k),h.send(k))},Jr:()=>h.close()}),O=(k,U,j)=>{k.listen(U,oe=>{try{j(oe)}catch(Ee){setTimeout(()=>{throw Ee},0)}})};return O(h,SM.EventType.OPEN,()=>{m||qe("Connection","WebChannel transport opened.")}),O(h,SM.EventType.CLOSE,()=>{m||(m=!0,qe("Connection","WebChannel transport closed"),E.io())}),O(h,SM.EventType.ERROR,k=>{m||(m=!0,Xf("Connection","WebChannel transport errored:",k),E.io(new $e(Oe.UNAVAILABLE,"The operation could not be completed")))}),O(h,SM.EventType.MESSAGE,k=>{var U;if(!m){const j=k.data[0];an(!!j);const oe=j,Ee=oe.error||(null===(U=oe[0])||void 0===U?void 0:U.error);if(Ee){qe("Connection","WebChannel received error:",Ee);const ne=Ee.status;let ke=function(et){const Bt=Zs[et];if(void 0!==Bt)return iX(Bt)}(ne),Ue=Ee.message;void 0===ke&&(ke=Oe.INTERNAL,Ue="Unknown error status: "+ne+" with message "+Ee.message),m=!0,E.io(new $e(ke,Ue)),h.close()}else qe("Connection","WebChannel received:",j),E.ro(j)}}),O(o,Kme.STAT_EVENT,k=>{k.stat===hK.PROXY?qe("Connection","Detected buffering proxy"):k.stat===hK.NOPROXY&&qe("Connection","Detected no buffering proxy")}),setTimeout(()=>{E.so()},0),E}}function XM(){return typeof document<"u"?document:null}function um(n){return new U_e(n,!0)}class Fx{constructor(t,e,r=1e3,s=1.5,i=6e4){this.Hs=t,this.timerId=e,this.mo=r,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),s=Math.max(0,e-r);s>0&&qe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,()=>(this.Eo=Date.now(),t())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class dQ{constructor(t,e,r,s,i,o,c,u){this.Hs=t,this.vo=r,this.Vo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Fx(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var t=this;return I(function*(){t.No()&&(yield t.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(t){this.Lo(),this.stream.send(t)}$o(){var t=this;return I(function*(){if(t.ko())return t.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(t,e){var r=this;return I(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==t?r.xo.reset():e&&e.code===Oe.RESOURCE_EXHAUSTED?(Os(e.toString()),Os("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):e&&e.code===Oe.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=t,yield r.listener.Zr(e)})()}qo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.So===e&&this.Go(r,s)},r=>{t(()=>{const s=new $e(Oe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(s)})})}Go(t,e){const r=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(s=>{r(()=>this.Qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Oo(){var t=this;this.state=5,this.xo.Ro(I(function*(){t.state=0,t.start()}))}Qo(t){return qe("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget(()=>this.So===t?e():(qe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class eCe extends dQ{constructor(t,e,r,s,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,s,o),this.It=i}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function W_e(n,t){let e;if("targetChange"in t){const r="NO_CHANGE"===(u=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:Ot(),s=t.targetChange.targetIds||[],i=function(u,h){return u.gt?(an(void 0===h||"string"==typeof h),gi.fromBase64String(h||"")):(an(void 0===h||h instanceof Uint8Array),gi.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,c=o&&function(u){const h=void 0===u.code?Oe.UNKNOWN:iX(u.code);return new $e(h,u.message||"")}(o);e=new uX(r,s,i,c||null)}else if("documentChange"in t){const r=t.documentChange,s=H4(n,r.document.name),i=qi(r.document.updateTime),o=new I2({mapValue:{fields:r.document.fields}}),c=gr.newFoundDocument(s,i,o);e=new zM(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){const r=t.documentDelete,s=H4(n,r.document),i=r.readTime?qi(r.readTime):cn.min(),o=gr.newNoDocument(s,i);e=new zM([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){const r=t.documentRemove,s=H4(n,r.document);e=new zM([],r.removedTargetIds||[],s,null)}else{if(!("filter"in t))return Ot();{const r=t.filter,i=new R_e(r.count||0);e=new lX(r.targetId,i)}}var u;return e}(this.It,t),r=function(s){if(!("targetChange"in s))return cn.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?cn.min():i.readTime?qi(i.readTime):cn.min()}(t);return this.listener.Wo(e,r)}zo(t){const e={};e.database=em(this.It),e.addTarget=function(s,i){let o;const c=i.target;return o=NM(c)?{documents:yX(s,c)}:{query:Cx(s,c)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=pX(s,i.resumeToken):i.snapshotVersion.compareTo(cn.min())>0&&(o.readTime=Qg(s,i.snapshotVersion.toTimestamp())),o}(this.It,t);const r=function Z_e(n,t){const e=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ot()}}(0,t.purpose);return null==e?null:{"goog-listen-tags":e}}(0,t);r&&(e.labels=r),this.Bo(e)}Ho(t){const e={};e.database=em(this.It),e.removeTarget=t,this.Bo(e)}}class tCe extends dQ{constructor(t,e,r,s,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,s,o),this.It=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(an(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function j_e(n,t){return n&&n.length>0?(an(void 0!==t),n.map(e=>function(r,s){let i=qi(r.updateTime?r.updateTime:s);return i.isEqual(cn.min())&&(i=qi(s)),new x_e(i,r.transformResults||[])}(e,t))):[]}(t.writeResults,t.commitTime),r=qi(t.commitTime);return this.listener.Zo(r,e)}return an(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=em(this.It),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map(r=>function tm(n,t){let e;if(t instanceof oh)e={update:vX(n,t.key,t.value)};else if(t instanceof ah)e={delete:Jg(n,t.key)};else if(t instanceof r6)e={update:vX(n,t.key,t.data),updateMask:J_e(t.fieldMask)};else{if(!(t instanceof gx))return Ot();e={verify:Jg(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof sh)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof d5)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof p5)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof ih)return{fieldPath:i.field.canonicalString(),increment:o.yt};throw Ot()}(0,r))),t.precondition.isNone||(e.currentDocument=void 0!==(s=t.precondition).updateTime?{updateTime:G_e(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Ot()),e;var s}(this.It,r))};this.Bo(e)}}class nCe extends class{}{constructor(t,e,r,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.It=s,this.nu=!1}su(){if(this.nu)throw new $e(Oe.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.ao(t,e,r,s,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new $e(Oe.UNKNOWN,s.toString())})}_o(t,e,r,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection._o(t,e,r,i,o,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new $e(Oe.UNKNOWN,i.toString())})}terminate(){this.nu=!0}}class sCe{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Os(e),this.ou=!1):qe("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class iCe{constructor(t,e,r,s,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr(c=>{r.enqueueAndForget(I(function*(){var u;s6(o)&&(qe("RemoteStore","Restarting streams for network reachability change."),yield(u=I(function*(h){const g=ht(h);g._u.add(4),yield ph(g),g.gu.set("Unknown"),g._u.delete(4),yield fm(g)}),function(h){return u.apply(this,arguments)})(o))}))}),this.gu=new sCe(r,s)}}function fm(n){return $x.apply(this,arguments)}function $x(){return $x=I(function*(n){if(s6(n))for(const t of n.wu)yield t(!0)}),$x.apply(this,arguments)}function ph(n){return Ux.apply(this,arguments)}function Ux(){return Ux=I(function*(n){for(const t of n.wu)yield t(!1)}),Ux.apply(this,arguments)}function QM(n,t){const e=ht(n);e.du.has(t.targetId)||(e.du.set(t.targetId,t),Wx(e)?qx(e):mh(e).ko()&&Gx(e,t))}function hm(n,t){const e=ht(n),r=mh(e);e.du.delete(t),r.ko()&&pQ(e,t),0===e.du.size&&(r.ko()?r.Fo():s6(e)&&e.gu.set("Unknown"))}function Gx(n,t){n.yu.Mt(t.targetId),mh(n).zo(t)}function pQ(n,t){n.yu.Mt(t),mh(n).Ho(t)}function qx(n){n.yu=new F_e({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),se:t=>n.du.get(t)||null}),mh(n).start(),n.gu.uu()}function Wx(n){return s6(n)&&!mh(n).No()&&n.du.size>0}function s6(n){return 0===ht(n)._u.size}function gQ(n){n.yu=void 0}function oCe(n){return jx.apply(this,arguments)}function jx(){return jx=I(function*(n){n.du.forEach((t,e)=>{Gx(n,t)})}),jx.apply(this,arguments)}function aCe(n,t){return Zx.apply(this,arguments)}function Zx(){return Zx=I(function*(n,t){gQ(n),Wx(n)?(n.gu.hu(t),qx(n)):n.gu.set("Unknown")}),Zx.apply(this,arguments)}function cCe(n,t,e){return Yx.apply(this,arguments)}function Yx(){return Yx=I(function*(n,t,e){if(n.gu.set("Online"),t instanceof uX&&2===t.state&&t.cause)try{yield(r=I(function*(s,i){const o=i.cause;for(const c of i.targetIds)s.du.has(c)&&(yield s.remoteSyncer.rejectListen(c,o),s.du.delete(c),s.yu.removeTarget(c))}),function(s,i){return r.apply(this,arguments)})(n,t)}catch(r){qe("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield JM(n,r)}else if(t instanceof zM?n.yu.Gt(t):t instanceof lX?n.yu.Yt(t):n.yu.Wt(t),!e.isEqual(cn.min()))try{const r=yield rQ(n.localStore);e.compareTo(r)>=0&&(yield function(s,i){const o=s.yu.te(i);return o.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.du.get(u);h&&s.du.set(u,h.withResumeToken(c.resumeToken,i))}}),o.targetMismatches.forEach(c=>{const u=s.du.get(c);if(!u)return;s.du.set(c,u.withResumeToken(gi.EMPTY_BYTE_STRING,u.snapshotVersion)),pQ(s,c);const h=new n8(u.target,c,1,u.sequenceNumber);Gx(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(n,e))}catch(r){qe("RemoteStore","Failed to raise snapshot:",r),yield JM(n,r)}var r}),Yx.apply(this,arguments)}function JM(n,t,e){return Kx.apply(this,arguments)}function Kx(){return Kx=I(function*(n,t,e){if(!K0(t))throw t;n._u.add(1),yield ph(n),n.gu.set("Offline"),e||(e=()=>rQ(n.localStore)),n.asyncQueue.enqueueRetryable(I(function*(){qe("RemoteStore","Retrying IndexedDB access"),yield e(),n._u.delete(1),yield fm(n)}))}),Kx.apply(this,arguments)}function mQ(n,t){return t().catch(e=>JM(n,e,t))}function gh(n){return Xx.apply(this,arguments)}function Xx(){return Xx=I(function*(n){const t=ht(n),e=i8(t);let r=t.fu.length>0?t.fu[t.fu.length-1].batchId:-1;for(;lCe(t);)try{const s=yield jve(t.localStore,r);if(null===s){0===t.fu.length&&e.Fo();break}r=s.batchId,uCe(t,s)}catch(s){yield JM(t,s)}_Q(t)&&vQ(t)}),Xx.apply(this,arguments)}function lCe(n){return s6(n)&&n.fu.length<10}function uCe(n,t){n.fu.push(t);const e=i8(n);e.ko()&&e.Yo&&e.Xo(t.mutations)}function _Q(n){return s6(n)&&!i8(n).No()&&n.fu.length>0}function vQ(n){i8(n).start()}function fCe(n){return Qx.apply(this,arguments)}function Qx(){return Qx=I(function*(n){i8(n).eu()}),Qx.apply(this,arguments)}function hCe(n){return Jx.apply(this,arguments)}function Jx(){return Jx=I(function*(n){const t=i8(n);for(const e of n.fu)t.Xo(e.mutations)}),Jx.apply(this,arguments)}function dCe(n,t,e){return ek.apply(this,arguments)}function ek(){return ek=I(function*(n,t,e){const r=n.fu.shift(),s=Mx.from(r,t,e);yield mQ(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield gh(n)}),ek.apply(this,arguments)}function pCe(n,t){return tk.apply(this,arguments)}function tk(){return tk=I(function*(n,t){var e;t&&i8(n).Yo&&(yield(e=I(function*(r,s){if(sX(i=s.code)&&i!==Oe.ABORTED){const o=r.fu.shift();i8(r).Mo(),yield mQ(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield gh(r)}var i}),function(r,s){return e.apply(this,arguments)})(n,t)),_Q(n)&&vQ(n)}),tk.apply(this,arguments)}function CQ(n,t){return nk.apply(this,arguments)}function nk(){return nk=I(function*(n,t){const e=ht(n);e.asyncQueue.verifyOperationInProgress(),qe("RemoteStore","RemoteStore received new credentials");const r=s6(e);e._u.add(3),yield ph(e),r&&e.gu.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e._u.delete(3),yield fm(e)}),nk.apply(this,arguments)}function sk(){return sk=I(function*(n,t){const e=ht(n);t?(e._u.delete(2),yield fm(e)):t||(e._u.add(2),yield ph(e),e.gu.set("Unknown"))}),sk.apply(this,arguments)}function mh(n){return n.pu||(n.pu=function(t,e,r){const s=ht(t);return s.su(),new eCe(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:oCe.bind(null,n),Zr:aCe.bind(null,n),Wo:cCe.bind(null,n)}),n.wu.push(function(){var t=I(function*(e){e?(n.pu.Mo(),Wx(n)?qx(n):n.gu.set("Unknown")):(yield n.pu.stop(),gQ(n))});return function(e){return t.apply(this,arguments)}}())),n.pu}function i8(n){return n.Iu||(n.Iu=function(t,e,r){const s=ht(t);return s.su(),new tCe(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:fCe.bind(null,n),Zr:pCe.bind(null,n),tu:hCe.bind(null,n),Zo:dCe.bind(null,n)}),n.wu.push(function(){var t=I(function*(e){e?(n.Iu.Mo(),yield gh(n)):(yield n.Iu.stop(),n.fu.length>0&&(qe("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(e){return t.apply(this,arguments)}}())),n.Iu}class ik{constructor(t,e,r,s,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(t,e,r,s,i){const o=Date.now()+r,c=new ik(t,e,o,s,i);return c.start(r),c}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new $e(Oe.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _h(n,t){if(Os("AsyncQueue",`${t}: ${n}`),K0(n))return new $e(Oe.UNAVAILABLE,`${t}: ${n}`);throw n}class vh{constructor(t){this.comparator=t?(e,r)=>t(e,r)||lt.comparator(e.key,r.key):(e,r)=>lt.comparator(e.key,r.key),this.keyedMap=Zg(),this.sortedSet=new ds(this.comparator)}static emptySet(t){return new vh(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,r)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof vh)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const r=new vh;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class yQ{constructor(){this.Tu=new ds(lt.comparator)}track(t){const e=t.doc.key,r=this.Tu.get(e);r?0!==t.type&&3===r.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==r.type?this.Tu=this.Tu.insert(e,{type:r.type,doc:t.doc}):2===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===r.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===r.type?this.Tu=this.Tu.remove(e):1===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:1,doc:r.doc}):0===t.type&&1===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):Ot():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal((e,r)=>{t.push(r)}),t}}class Ch{constructor(t,e,r,s,i,o,c,u,h){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(t,e,r,s,i){const o=[];return e.forEach(c=>{o.push({type:0,doc:c})}),new Ch(t,e,vh.emptySet(e),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&qg(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==r[s].type||!e[s].doc.isEqual(r[s].doc))return!1;return!0}}class gCe{constructor(){this.Au=void 0,this.listeners=[]}}class mCe{constructor(){this.queries=new t8(t=>$K(t),qg),this.onlineState="Unknown",this.Ru=new Set}}function ok(n,t){return ak.apply(this,arguments)}function ak(){return ak=I(function*(n,t){const e=ht(n),r=t.query;let s=!1,i=e.queries.get(r);if(i||(s=!0,i=new gCe),s)try{i.Au=yield e.onListen(r)}catch(o){const c=_h(o,`Initialization of query '${dx(t.query)}' failed`);return void t.onError(c)}e.queries.set(r,i),i.listeners.push(t),t.bu(e.onlineState),i.Au&&t.Pu(i.Au)&&uk(e)}),ak.apply(this,arguments)}function ck(n,t){return lk.apply(this,arguments)}function lk(){return lk=I(function*(n,t){const e=ht(n),r=t.query;let s=!1;const i=e.queries.get(r);if(i){const o=i.listeners.indexOf(t);o>=0&&(i.listeners.splice(o,1),s=0===i.listeners.length)}if(s)return e.queries.delete(r),e.onUnlisten(r)}),lk.apply(this,arguments)}function _Ce(n,t){const e=ht(n);let r=!1;for(const s of t){const o=e.queries.get(s.query);if(o){for(const c of o.listeners)c.Pu(s)&&(r=!0);o.Au=s}}r&&uk(e)}function vCe(n,t,e){const r=ht(n),s=r.queries.get(t);if(s)for(const i of s.listeners)i.onError(e);r.queries.delete(t)}function uk(n){n.Ru.forEach(t=>{t.next()})}class fk{constructor(t,e,r){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)3!==s.type&&r.push(s);t=new Ch(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){return!t.fromCache||(!this.options.Nu||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(t){t=Ch.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class SQ{constructor(t){this.key=t}}class PQ{constructor(t){this.key=t}}class TQ{constructor(t,e){this.query=t,this.Uu=e,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=kn(),this.mutatedKeys=kn(),this.Gu=GK(t),this.Qu=new vh(this.Gu)}get ju(){return this.Uu}Wu(t,e){const r=e?e.zu:new yQ,s=e?e.Qu:this.Qu;let i=e?e.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,h="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((g,m)=>{const E=s.get(g),O=px(this.query,m)?m:null,k=!!E&&this.mutatedKeys.has(E.key),U=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let j=!1;E&&O?E.data.isEqual(O.data)?k!==U&&(r.track({type:3,doc:O}),j=!0):this.Hu(E,O)||(r.track({type:2,doc:O}),j=!0,(u&&this.Gu(O,u)>0||h&&this.Gu(O,h)<0)&&(c=!0)):!E&&O?(r.track({type:0,doc:O}),j=!0):E&&!O&&(r.track({type:1,doc:E}),j=!0,(u||h)&&(c=!0)),j&&(O?(o=o.add(O),i=U?i.add(g):i.delete(g)):(o=o.delete(g),i=i.delete(g)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const g="F"===this.query.limitType?o.last():o.first();o=o.delete(g.key),i=i.delete(g.key),r.track({type:1,doc:g})}return{Qu:o,zu:r,$i:c,mutatedKeys:i}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r){const s=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const i=t.zu.Eu();i.sort((h,g)=>function(m,E){const O=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ot()}};return O(m)-O(E)}(h.type,g.type)||this.Gu(h.doc,g.doc)),this.Ju(r);const o=e?this.Yu():[],c=0===this.Ku.size&&this.current?1:0,u=c!==this.qu;return this.qu=c,0!==i.length||u?{snapshot:new Ch(this.query,t.Qu,s,i,t.mutatedKeys,0===c,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new yQ,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.Uu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach(e=>this.Uu=this.Uu.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Uu=this.Uu.delete(e)),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=kn(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const e=[];return t.forEach(r=>{this.Ku.has(r)||e.push(new PQ(r))}),this.Ku.forEach(r=>{t.has(r)||e.push(new SQ(r))}),e}tc(t){this.Uu=t.Hi,this.Ku=kn();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return Ch.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class ECe{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class MCe{constructor(t){this.key=t,this.nc=!1}}class SCe{constructor(t,e,r,s,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new t8(c=>$K(c),qg),this.rc=new Map,this.oc=new Set,this.uc=new ds(lt.comparator),this.cc=new Map,this.ac=new Ox,this.hc={},this.lc=new Map,this.fc=E5.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function PCe(n,t){return hk.apply(this,arguments)}function hk(){return hk=I(function*(n,t){const e=Rk(n);let r,s;const i=e.ic.get(t);if(i)r=i.targetId,e.sharedClientState.addLocalQueryTarget(r),s=i.view.ec();else{const o=yield hh(e.localStore,Fo(t));e.isPrimaryClient&&QM(e.remoteStore,o);const c=e.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=yield dk(e,t,r,"current"===c,o.resumeToken)}return s}),hk.apply(this,arguments)}function dk(n,t,e,r,s){return pk.apply(this,arguments)}function pk(){return pk=I(function*(n,t,e,r,s){n._c=(m,E,O)=>{return(k=I(function*(U,j,oe,Ee){let ne=j.view.Wu(oe);ne.$i&&(ne=yield ZM(U.localStore,j.query,!1).then(({documents:et})=>j.view.Wu(et,ne)));const ke=Ee&&Ee.targetChanges.get(j.targetId),Ue=j.view.applyChanges(ne,U.isPrimaryClient,ke);return Pk(U,j.targetId,Ue.Xu),Ue.snapshot}),function(U,j,oe,Ee){return k.apply(this,arguments)})(n,m,E,O);var k};const i=yield ZM(n.localStore,t,!0),o=new TQ(t,i.Hi),c=o.Wu(i.documents),u=Xg.createSynthesizedTargetChangeForCurrentChange(e,r&&"Offline"!==n.onlineState,s),h=o.applyChanges(c,n.isPrimaryClient,u);Pk(n,e,h.Xu);const g=new ECe(t,e,o);return n.ic.set(t,g),n.rc.has(e)?n.rc.get(e).push(t):n.rc.set(e,[t]),h.snapshot}),pk.apply(this,arguments)}function TCe(n,t){return gk.apply(this,arguments)}function gk(){return gk=I(function*(n,t){const e=ht(n),r=e.ic.get(t),s=e.rc.get(r.targetId);if(s.length>1)return e.rc.set(r.targetId,s.filter(i=>!qg(i,t))),void e.ic.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(r.targetId),e.sharedClientState.isActiveQueryTarget(r.targetId)||(yield dh(e.localStore,r.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(r.targetId),hm(e.remoteStore,r.targetId),yh(e,r.targetId)}).catch(Y0))):(yh(e,r.targetId),yield dh(e.localStore,r.targetId,!0))}),gk.apply(this,arguments)}function mk(){return mk=I(function*(n,t,e){const r=Dk(n);try{const s=yield function(i,o){const c=ht(i),u=es.now(),h=o.reduce((E,O)=>E.add(O.key),kn());let g,m;return c.persistence.runTransaction("Locally write mutations","readwrite",E=>{let O=Ca(),k=kn();return c.Gi.getEntries(E,h).next(U=>{O=U,O.forEach((j,oe)=>{oe.isValidDocument()||(k=k.add(j))})}).next(()=>c.localDocuments.getOverlayedDocuments(E,O)).next(U=>{g=U;const j=[];for(const oe of o){const Ee=L_e(oe,g.get(oe.key).overlayedDocument);null!=Ee&&j.push(new r6(oe.key,Ee,kK(Ee.value.mapValue),$r.exists(!0)))}return c.mutationQueue.addMutationBatch(E,u,j,o)}).next(U=>{m=U;const j=U.applyToLocalDocumentSet(g,k);return c.documentOverlayCache.saveOverlays(E,U.batchId,j)})}).then(()=>({batchId:m.batchId,changes:aX(g)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,c){let u=i.hc[i.currentUser.toKey()];u||(u=new ds(Sn)),u=u.insert(o,c),i.hc[i.currentUser.toKey()]=u}(r,s.batchId,e),yield i6(r,s.changes),yield gh(r.remoteStore)}catch(s){const i=_h(s,"Failed to persist write");e.reject(i)}}),mk.apply(this,arguments)}function wQ(n,t){return _k.apply(this,arguments)}function _k(){return _k=I(function*(n,t){const e=ht(n);try{const r=yield Wve(e.localStore,t);t.targetChanges.forEach((s,i)=>{const o=e.cc.get(i);o&&(an(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.nc=!0:s.modifiedDocuments.size>0?an(o.nc):s.removedDocuments.size>0&&(an(o.nc),o.nc=!1))}),yield i6(e,r,t)}catch(r){yield Y0(r)}}),_k.apply(this,arguments)}function OQ(n,t,e){const r=ht(n);if(r.isPrimaryClient&&0===e||!r.isPrimaryClient&&1===e){const s=[];r.ic.forEach((i,o)=>{const c=o.view.bu(t);c.snapshot&&s.push(c.snapshot)}),function(i,o){const c=ht(i);c.onlineState=o;let u=!1;c.queries.forEach((h,g)=>{for(const m of g.listeners)m.bu(o)&&(u=!0)}),u&&uk(c)}(r.eventManager,t),s.length&&r.sc.Wo(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function OCe(n,t,e){return vk.apply(this,arguments)}function vk(){return vk=I(function*(n,t,e){const r=ht(n);r.sharedClientState.updateQueryState(t,"rejected",e);const s=r.cc.get(t),i=s&&s.key;if(i){let o=new ds(lt.comparator);o=o.insert(i,gr.newNoDocument(i,cn.min()));const c=kn().add(i),u=new Kg(cn.min(),new Map,new tr(Sn),o,c);yield wQ(r,u),r.uc=r.uc.remove(i),r.cc.delete(t),Tk(r)}else yield dh(r.localStore,t,!1).then(()=>yh(r,t,e)).catch(Y0)}),vk.apply(this,arguments)}function bCe(n,t){return Ck.apply(this,arguments)}function Ck(){return Ck=I(function*(n,t){const e=ht(n),r=t.batch.batchId;try{const s=yield qve(e.localStore,t);Sk(e,r,null),Mk(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),yield i6(e,s)}catch(s){yield Y0(s)}}),Ck.apply(this,arguments)}function ACe(n,t,e){return yk.apply(this,arguments)}function yk(){return yk=I(function*(n,t,e){const r=ht(n);try{const s=yield function(i,o){const c=ht(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,o).next(g=>(an(null!==g),h=g.keys(),c.mutationQueue.removeMutationBatch(u,g))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(r.localStore,t);Sk(r,t,e),Mk(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),yield i6(r,s)}catch(s){yield Y0(s)}}),yk.apply(this,arguments)}function Mk(n,t){(n.lc.get(t)||[]).forEach(e=>{e.resolve()}),n.lc.delete(t)}function Sk(n,t,e){const r=ht(n);let s=r.hc[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(e?i.reject(e):i.resolve(),s=s.remove(t)),r.hc[r.currentUser.toKey()]=s}}function yh(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.rc.get(t))n.ic.delete(r),e&&n.sc.wc(r,e);n.rc.delete(t),n.isPrimaryClient&&n.ac.ls(t).forEach(r=>{n.ac.containsKey(r)||bQ(n,r)})}function bQ(n,t){n.oc.delete(t.path.canonicalString());const e=n.uc.get(t);null!==e&&(hm(n.remoteStore,e),n.uc=n.uc.remove(t),n.cc.delete(e),Tk(n))}function Pk(n,t,e){for(const r of e)r instanceof SQ?(n.ac.addReference(r.key,t),ICe(n,r)):r instanceof PQ?(qe("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,t),n.ac.containsKey(r.key)||bQ(n,r.key)):Ot()}function ICe(n,t){const e=t.key,r=e.path.canonicalString();n.uc.get(e)||n.oc.has(r)||(qe("SyncEngine","New document in limbo: "+e),n.oc.add(r),Tk(n))}function Tk(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const t=n.oc.values().next().value;n.oc.delete(t);const e=new lt(m1.fromString(t)),r=n.fc.next();n.cc.set(r,new MCe(e)),n.uc=n.uc.insert(e,r),QM(n.remoteStore,new n8(Fo(nh(e.path)),r,2,va.at))}}function i6(n,t,e){return wk.apply(this,arguments)}function wk(){return wk=I(function*(n,t,e){const r=ht(n),s=[],i=[],o=[];var c;r.ic.isEmpty()||(r.ic.forEach((c,u)=>{o.push(r._c(u,t,e).then(h=>{if((h||e)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,h?.fromCache?"not-current":"current"),h){s.push(h);const g=Ix.Ci(u.targetId,h);i.push(g)}}))}),yield Promise.all(o),r.sc.Wo(s),yield(c=I(function*(u,h){const g=ht(u);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Se.forEach(h,E=>Se.forEach(E.Si,O=>g.persistence.referenceDelegate.addReference(m,E.targetId,O)).next(()=>Se.forEach(E.Di,O=>g.persistence.referenceDelegate.removeReference(m,E.targetId,O)))))}catch(m){if(!K0(m))throw m;qe("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const E=m.targetId;if(!m.fromCache){const O=g.Ui.get(E),U=O.withLastLimboFreeSnapshotVersion(O.snapshotVersion);g.Ui=g.Ui.insert(E,U)}}}),function(u,h){return c.apply(this,arguments)})(r.localStore,i))}),wk.apply(this,arguments)}function xCe(n,t){return Ok.apply(this,arguments)}function Ok(){return Ok=I(function*(n,t){const e=ht(n);if(!e.currentUser.isEqual(t)){qe("SyncEngine","User change. New user:",t.toKey());const r=yield nQ(e.localStore,t);e.currentUser=t,(s=e).lc.forEach(o=>{o.forEach(c=>{c.reject(new $e(Oe.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.lc.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),yield i6(e,r.ji)}var s}),Ok.apply(this,arguments)}function kCe(n,t){const e=ht(n),r=e.cc.get(t);if(r&&r.nc)return kn().add(r.key);{let s=kn();const i=e.rc.get(t);if(!i)return s;for(const o of i){const c=e.ic.get(o);s=s.unionWith(c.view.ju)}return s}}function Rk(n){const t=ht(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=wQ.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=kCe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=OCe.bind(null,t),t.sc.Wo=_Ce.bind(null,t.eventManager),t.sc.wc=vCe.bind(null,t.eventManager),t}function Dk(n){const t=ht(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=bCe.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=ACe.bind(null,t),t}class $Ce{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return I(function*(){e.It=um(t.databaseInfo.databaseId),e.sharedClientState=e.gc(t),e.persistence=e.yc(t),yield e.persistence.start(),e.localStore=e.Ic(t),e.gcScheduler=e.Tc(t,e.localStore),e.indexBackfillerScheduler=e.Ec(t,e.localStore)})()}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return function tQ(n,t,e,r){return new Gve(n,t,e,r)}(this.persistence,new eQ,t.initialUser,this.It)}yc(t){return new QX(WM.Bs,this.It)}gc(t){return new uQ}terminate(){var t=this;return I(function*(){t.gcScheduler&&t.gcScheduler.stop(),yield t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class zk{initialize(t,e){var r=this;return I(function*(){r.localStore||(r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(e),r.remoteStore=r.createRemoteStore(e),r.eventManager=r.createEventManager(e),r.syncEngine=r.createSyncEngine(e,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=s=>OQ(r.syncEngine,s,1),r.remoteStore.remoteSyncer.handleCredentialChange=xCe.bind(null,r.syncEngine),yield function rk(n,t){return sk.apply(this,arguments)}(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(t){return new mCe}createDatastore(t){const e=um(t.databaseInfo.databaseId),r=new Jve(t.databaseInfo);return new nCe(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return e=this.localStore,r=this.datastore,s=t.asyncQueue,i=c=>OQ(this.syncEngine,c,0),o=fQ.C()?new fQ:new Kve,new iCe(e,r,s,i,o);var e,r,s,i,o}createSyncEngine(t,e){return function(r,s,i,o,c,u,h){const g=new SCe(r,s,i,o,c,u);return h&&(g.dc=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return(t=I(function*(e){const r=ht(e);qe("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield ph(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}function Vk(n,t,e){if(!e)throw new $e(Oe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function IQ(n){if(!lt.isDocumentKey(n))throw new $e(Oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function xQ(n){if(lt.isDocumentKey(n))throw new $e(Oe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function eS(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const t=(e=n).constructor?e.constructor.name:null;return t?`a custom ${t} object`:"an object"}}var e;return"function"==typeof n?"a function":Ot()}function l1(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new $e(Oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=eS(n);throw new $e(Oe.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}const LQ=new Map;class RQ{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new $e(Oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new $e(Oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function qCe(n,t,e,r){if(!0===t&&!0===r)throw new $e(Oe.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class dm{constructor(t,e,r,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new RQ({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new $e(Oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new $e(Oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new RQ(t),void 0!==t.credentials&&(this._authCredentials=function(e){if(!e)return new Jme;switch(e.type){case"gapi":return new r_e(e.client,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new $e(Oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=LQ.get(t);e&&(qe("ComponentProvider","Removing Datastore"),LQ.delete(t),e.terminate())}(this),Promise.resolve()}}function DQ(n,t,e,r={}){var s;const i=(n=l1(n,dm))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&Xf("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},i),{host:`${t}:${e}`,ssl:!1})),r.mockUserToken){let o,c;if("string"==typeof r.mockUserToken)o=r.mockUserToken,c=Gi.MOCK_USER;else{o=function Rpe(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[UE(JSON.stringify({alg:"none",type:"JWT"})),UE(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=n._app)||void 0===s?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new $e(Oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Gi(u)}n._authCredentials=new e_e(new pK(o,c))}}class As{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new B4(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new As(this.firestore,t,this._key)}}class io{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new io(this.firestore,t,this._query)}}class B4 extends io{constructor(t,e,r){super(t,e,nh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new As(this.firestore,null,new lt(t))}withConverter(t){return new B4(this.firestore,t,this._path)}}function WCe(n,t,...e){if(n=Jr(n),Vk("collection","path",t),n instanceof dm){const r=m1.fromString(t,...e);return xQ(r),new B4(n,null,r)}{if(!(n instanceof As||n instanceof B4))throw new $e(Oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(m1.fromString(t,...e));return xQ(r),new B4(n.firestore,null,r)}}function zQ(n,t,...e){if(n=Jr(n),1===arguments.length&&(t=mK.R()),Vk("doc","path",t),n instanceof dm){const r=m1.fromString(t,...e);return IQ(r),new As(n,null,new lt(r))}{if(!(n instanceof As||n instanceof B4))throw new $e(Oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(m1.fromString(t,...e));return IQ(r),new As(n.firestore,n instanceof B4?n.converter:null,new lt(r))}}class tS{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):Os("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class QCe{constructor(t,e,r,s){var i=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=s,this.user=Gi.UNAUTHENTICATED,this.clientId=mK.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=I(function*(c){qe("FirestoreClient","Received user=",c.uid),yield i.authCredentialListener(c),i.user=c});return function(c){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(qe("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var t=this;return I(function*(){return{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new $e(Oe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(I(function*(){try{t.onlineComponents&&(yield t.onlineComponents.terminate()),t.offlineComponents&&(yield t.offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(r){const s=_h(r,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}function FQ(n,t){return Hk.apply(this,arguments)}function Hk(){return Hk=I(function*(n,t){n.asyncQueue.verifyOperationInProgress(),qe("FirestoreClient","Initializing OfflineComponentProvider");const e=yield n.getConfiguration();yield t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener(function(){var s=I(function*(i){r.isEqual(i)||(yield nQ(t.localStore,i),r=i)});return function(i){return s.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=t}),Hk.apply(this,arguments)}function BQ(n,t){return Fk.apply(this,arguments)}function Fk(){return Fk=I(function*(n,t){n.asyncQueue.verifyOperationInProgress();const e=yield Bk(n);qe("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield t.initialize(e,r),n.setCredentialChangeListener(s=>CQ(t.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>CQ(t.remoteStore,i)),n.onlineComponents=t}),Fk.apply(this,arguments)}function Bk(n){return $k.apply(this,arguments)}function $k(){return $k=I(function*(n){return n.offlineComponents||(qe("FirestoreClient","Using default OfflineComponentProvider"),yield FQ(n,new $Ce)),n.offlineComponents}),$k.apply(this,arguments)}function nS(n){return Uk.apply(this,arguments)}function Uk(){return Uk=I(function*(n){return n.onlineComponents||(qe("FirestoreClient","Using default OnlineComponentProvider"),yield BQ(n,new zk)),n.onlineComponents}),Uk.apply(this,arguments)}function Eh(n){return Wk.apply(this,arguments)}function Wk(){return Wk=I(function*(n){const t=yield nS(n),e=t.eventManager;return e.onListen=PCe.bind(null,t.syncEngine),e.onUnlisten=TCe.bind(null,t.syncEngine),e}),Wk.apply(this,arguments)}class oye{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new Fx(this,"async_queue_retry"),this.Wc=()=>{const e=XM();e&&qe("AsyncQueue","Visibility state changed to "+e.visibilityState),this.xo.Po()};const t=XM();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.Uc){this.Uc=!0,this.Qc=t||!1;const e=XM();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.Uc)return new Promise(()=>{});const e=new pi;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Lc.push(t),this.Jc()))}Jc(){var t=this;return I(function*(){if(0!==t.Lc.length){try{yield t.Lc[0](),t.Lc.shift(),t.xo.reset()}catch(e){if(!K0(e))throw e;qe("AsyncQueue","Operation failed with retryable error: "+e)}t.Lc.length>0&&t.xo.Ro(()=>t.Jc())}})()}Hc(t){const e=this.Bc.then(()=>(this.Gc=!0,t().catch(r=>{throw this.Kc=r,this.Gc=!1,Os("INTERNAL UNHANDLED ERROR: ",function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+"\n"+i.stack),o}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=e,e}enqueueAfterDelay(t,e,r){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const s=ik.createAndSchedule(this,t,e,r,i=>this.Yc(i));return this.qc.push(s),s}zc(){this.Kc&&Ot()}verifyOperationInProgress(){}Xc(){var t=this;return I(function*(){let e;do{e=t.Bc,yield e}while(e!==t.Bc)})()}Zc(t){for(const e of this.qc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then(()=>{this.qc.sort((e,r)=>e.targetTimeMs-r.targetTimeMs);for(const e of this.qc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()})}ea(t){this.jc.push(t)}Yc(t){const e=this.qc.indexOf(t);this.qc.splice(e,1)}}function jk(n){return function(t,e){if("object"!=typeof t||null===t)return!1;const r=t;for(const s of["next","error","complete"])if(s in r&&"function"==typeof r[s])return!0;return!1}(n)}class Or extends dm{constructor(t,e,r,s){super(t,e,r,s),this.type="firestore",this._queue=new oye,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||WQ(this),this._firestoreClient.terminate()}}function cye(n,t){const r="string"==typeof n?n:t||"(default)",s=Gf("object"==typeof n?n:uI(),"firestore").getImmediate({identifier:r});if(!s._initialized){const i=(n=>{const t=LZ("firestore");if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return"["===t[0]?[t.substring(1,e-1),r]:[t.substring(0,e),r]})();i&&DQ(s,...i)}return s}function Ys(n){return n._firestoreClient||WQ(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function WQ(n){var t;const e=n._freezeSettings(),r=(i=(null===(t=n._app)||void 0===t?void 0:t.options.appId)||"",new g_e(n._databaseId,i,n._persistenceKey,(c=e).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams));var i,c;n._firestoreClient=new QCe(n._authCredentials,n._appCheckCredentials,n._queue,r)}class S5{constructor(t){this._byteString=t}static fromBase64String(t){try{return new S5(gi.fromBase64String(t))}catch(e){throw new $e(Oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new S5(gi.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Mh{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new $e(Oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bs(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class sS{constructor(t){this._methodName=t}}class Zk{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new $e(Oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new $e(Oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Sn(this._lat,t._lat)||Sn(this._long,t._long)}}const lye=/^__.*__$/;class uye{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return null!==this.fieldMask?new r6(t,this.data,this.fieldMask,e,this.fieldTransforms):new oh(t,this.data,e,this.fieldTransforms)}}class YQ{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new r6(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function KQ(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ot()}}class iS{constructor(t,e,r,s,i,o){this.settings=t,this.databaseId=e,this.It=r,this.ignoreUndefinedProperties=s,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new iS(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.ua(t),s}ca(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.na(),s}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return aS(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(KQ(this.sa)&&lye.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class fye{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.It=r||um(t)}da(t,e,r,s=!1){return new iS({sa:t,methodName:e,fa:r,path:bs.emptyPath(),oa:!1,la:s},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Sh(n){const t=n._freezeSettings(),e=um(n._databaseId);return new fye(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Yk(n,t,e,r,s,i={}){const o=n.da(i.merge||i.mergeFields?2:0,t,e,s);Xk("Data must be an object, but it was:",o,r);const c=tJ(r,o);let u,h;if(i.merge)u=new ec(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const g=[];for(const m of i.mergeFields){const E=Qk(t,m,e);if(!o.contains(E))throw new $e(Oe.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);rJ(g,E)||g.push(E)}u=new ec(g),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new uye(new I2(c),u,h)}class pm extends sS{_toFieldTransform(t){if(2!==t.sa)throw t.ha(1===t.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof pm}}class Kk extends sS{_toFieldTransform(t){return new Wg(t.path,new sh)}isEqual(t){return t instanceof Kk}}function P5(n,t){if(nJ(n=Jr(n)))return Xk("Unsupported field value:",t,n),tJ(n,t);if(n instanceof sS)return function(e,r){if(!KQ(r.sa))throw r.ha(`${e._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${e._methodName}() is not currently supported inside arrays`);const s=e._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,t),null;if(void 0===n&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,r){const s=[];let i=0;for(const o of e){let c=P5(o,r.aa(i));null==c&&(c={nullValue:"NULL_VALUE"}),s.push(c),i++}return{arrayValue:{values:s}}}(n,t)}return function(e,r){if(null===(e=Jr(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return jK(r.It,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const s=es.fromDate(e);return{timestampValue:Qg(r.It,s)}}if(e instanceof es){const s=new es(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Qg(r.It,s)}}if(e instanceof Zk)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof S5)return{bytesValue:pX(r.It,e._byteString)};if(e instanceof As){const s=r.databaseId,i=e.firestore._databaseId;if(!i.isEqual(s))throw r.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:mx(e.firestore._databaseId||r.databaseId,e._key.path)}}throw r.ha(`Unsupported field value: ${eS(e)}`)}(n,t)}function tJ(n,t){const e={};return SK(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):a5(n,(r,s)=>{const i=P5(s,t.ra(r));null!=i&&(e[r]=i)}),{mapValue:{fields:e}}}function nJ(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof es||n instanceof Zk||n instanceof S5||n instanceof As||n instanceof sS)}function Xk(n,t,e){if(!nJ(e)||"object"!=typeof(r=e)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=eS(e);throw t.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function Qk(n,t,e){if((t=Jr(t))instanceof Mh)return t._internalPath;if("string"==typeof t)return oS(n,t);throw aS("Field path arguments must be of type string or ",n,!1,void 0,e)}const gye=new RegExp("[~\\*/\\[\\]]");function oS(n,t,e){if(t.search(gye)>=0)throw aS(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Mh(...t.split("."))._internalPath}catch{throw aS(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function aS(n,t,e,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let c=`Function ${t}() called with invalid data`;e&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new $e(Oe.INVALID_ARGUMENT,c+n+u)}function rJ(n,t){return n.some(e=>e.isEqual(t))}class Jk{constructor(t,e,r,s,i){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new As(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new mye(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(cS("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class mye extends Jk{data(){return super.data()}}function cS(n,t){return"string"==typeof t?oS(n,t):t instanceof Mh?t._internalPath:t._delegate._internalPath}function sJ(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new $e(Oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class eL{}function _ye(n,...t){for(const e of t)n=e._apply(n);return n}class vye extends eL{constructor(t,e,r){super(),this.ma=t,this.ga=e,this.ya=r,this.type="where"}_apply(t){const e=Sh(t.firestore),r=function(s,i,o,c,u,h,g){let m;if(u.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new $e(Oe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){uJ(g,h);const O=[];for(const k of g)O.push(lJ(c,s,k));m={arrayValue:{values:O}}}else m=lJ(c,s,g)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||uJ(g,h),m=function eJ(n,t,e,r=!1){return P5(e,n.da(r?4:3,t))}(o,"where",g,"in"===h||"not-in"===h);const E=x2.create(u,h,m);return function(O,k){if(k.dt()){const j=fx(O);if(null!==j&&!j.isEqual(k.field))throw new $e(Oe.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${j.toString()}' and '${k.field.toString()}'`);const oe=ux(O);null!==oe&&fJ(0,k.field,oe)}const U=function(j,oe){for(const Ee of j.filters)if(oe.indexOf(Ee.op)>=0)return Ee.op;return null}(O,function(j){switch(j){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(k.op));if(null!==U)throw new $e(Oe.INVALID_ARGUMENT,U===k.op?`Invalid query. You cannot use more than one '${k.op.toString()}' filter.`:`Invalid query. You cannot use '${k.op.toString()}' filters with '${U.toString()}' filters.`)}(s,E),E}(t._query,0,e,t.firestore._databaseId,this.ma,this.ga,this.ya);return new io(t.firestore,t.converter,function(s,i){const o=s.filters.concat([i]);return new n6(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(t._query,r))}}function Cye(n,t,e){const r=t,s=cS("where",n);return new vye(s,r,e)}class yye extends eL{constructor(t,e){super(),this.ma=t,this.pa=e,this.type="orderBy"}_apply(t){const e=function(r,s,i){if(null!==r.startAt)throw new $e(Oe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new $e(Oe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new th(s,i);return function(c,u){if(null===ux(c)){const h=fx(c);null!==h&&fJ(0,h,u.field)}}(r,o),o}(t._query,this.ma,this.pa);return new io(t.firestore,t.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new n6(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,e))}}function Eye(n,t="asc"){const e=t,r=cS("orderBy",n);return new yye(r,e)}class iJ extends eL{constructor(t,e,r){super(),this.type=t,this.Ia=e,this.Ta=r}_apply(t){return new io(t.firestore,t.converter,xM(t._query,this.Ia,this.Ta))}}function Mye(n){return function kQ(n,t){if(t<=0)throw new $e(Oe.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}("limit",n),new iJ("limit",n,"F")}function lJ(n,t,e){if("string"==typeof(e=Jr(e))){if(""===e)throw new $e(Oe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!hx(t)&&-1!==e.indexOf("/"))throw new $e(Oe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const r=t.path.child(m1.fromString(e));if(!lt.isDocumentKey(r))throw new $e(Oe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return f5(n,new lt(r))}if(e instanceof As)return f5(n,e._key);throw new $e(Oe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${eS(e)}.`)}function uJ(n,t){if(!Array.isArray(n)||0===n.length)throw new $e(Oe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(n.length>10)throw new $e(Oe.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function fJ(n,t,e){if(!e.isEqual(t))throw new $e(Oe.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${e.toString()}' instead.`)}function tL(n,t,e){let r;return r=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,r}class T5{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Ph extends Jk{constructor(t,e,r,s,i,o){super(t,e,r,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new lS(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(cS("DocumentSnapshot.get",t));if(null!==r)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}}class lS extends Ph{data(t={}){return super.data(t)}}class Th{constructor(t,e,r,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new T5(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(r=>{t.call(e,new lS(this._firestore,this._userDataWriter,r.key,r,new T5(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new $e(Oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new lS(r._firestore,r._userDataWriter,o.doc.key,o.doc,new T5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||3!==o.type).map(o=>{const c=new lS(r._firestore,r._userDataWriter,o.doc.key,o.doc,new T5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return 0!==o.type&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),1!==o.type&&(i=i.add(o.doc),h=i.indexOf(o.doc.key)),{type:Pye(o.type),doc:c,oldIndex:u,newIndex:h}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Pye(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ot()}}function Tye(n){n=l1(n,As);const t=l1(n.firestore,Or);return function GQ(n,t,e={}){const r=new pi;return n.asyncQueue.enqueueAndForget(I(function*(){return function(s,i,o,c,u){const h=new tS({next:m=>{i.enqueueAndForget(()=>ck(s,g));const E=m.docs.has(o);!E&&m.fromCache?u.reject(new $e(Oe.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&m.fromCache&&c&&"server"===c.source?u.reject(new $e(Oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new fk(nh(o.path),h,{includeMetadataChanges:!0,Nu:!0});return ok(s,g)}(yield Eh(n),n.asyncQueue,t,e,r)})),r.promise}(Ys(t),n._key).then(e=>nL(t,n,e))}class o8 extends class Sye{convertValue(t,e="none"){switch(u5(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ps(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(c5(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Ot()}}convertObject(t,e){const r={};return a5(t.fields,(s,i)=>{r[s]=this.convertValue(i,e)}),r}convertGeoPoint(t){return new Zk(ps(t.latitude),ps(t.longitude))}convertArray(t,e){return(t.values||[]).map(r=>this.convertValue(r,e))}convertServerTimestamp(t,e){switch(e){case"previous":const r=TK(t);return null==r?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(Vg(t));default:return null}}convertTimestamp(t){const e=X0(t);return new es(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=m1.fromString(t);an(SX(r));const s=new l5(r.get(1),r.get(3)),i=new lt(r.popFirst(5));return s.isEqual(e)||Os(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}{constructor(t){super(),this.firestore=t}convertBytes(t){return new S5(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new As(this.firestore,null,e)}}function wye(n){n=l1(n,io);const t=l1(n.firestore,Or),e=Ys(t),r=new o8(t);return sJ(n._query),function qQ(n,t,e={}){const r=new pi;return n.asyncQueue.enqueueAndForget(I(function*(){return function(s,i,o,c,u){const h=new tS({next:m=>{i.enqueueAndForget(()=>ck(s,g)),m.fromCache&&"server"===c.source?u.reject(new $e(Oe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new fk(o,h,{includeMetadataChanges:!0,Nu:!0});return ok(s,g)}(yield Eh(n),n.asyncQueue,t,e,r)})),r.promise}(e,n._query).then(s=>new Th(t,r,n,s))}function Oye(n,t,e){n=l1(n,As);const r=l1(n.firestore,Or),s=tL(n.converter,t,e);return gm(r,[Yk(Sh(r),"setDoc",n._key,s,null!==n.converter,e).toMutation(n._key,$r.none())])}function bye(n,t,e,...r){n=l1(n,As);const s=l1(n.firestore,Or),i=Sh(s);let o;return o="string"==typeof(t=Jr(t))||t instanceof Mh?function JQ(n,t,e,r,s,i){const o=n.da(1,t,e),c=[Qk(t,r,e)],u=[s];if(i.length%2!=0)throw new $e(Oe.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<i.length;E+=2)c.push(Qk(t,i[E])),u.push(i[E+1]);const h=[],g=I2.empty();for(let E=c.length-1;E>=0;--E)if(!rJ(h,c[E])){const O=c[E];let k=u[E];k=Jr(k);const U=o.ca(O);if(k instanceof pm)h.push(O);else{const j=P5(k,U);null!=j&&(h.push(O),g.set(O,j))}}const m=new ec(h);return new YQ(g,m,o.fieldTransforms)}(i,"updateDoc",n._key,t,e,r):function QQ(n,t,e,r){const s=n.da(1,t,e);Xk("Data must be an object, but it was:",s,r);const i=[],o=I2.empty();a5(r,(u,h)=>{const g=oS(t,u,e);h=Jr(h);const m=s.ca(g);if(h instanceof pm)i.push(g);else{const E=P5(h,m);null!=E&&(i.push(g),o.set(g,E))}});const c=new ec(i);return new YQ(o,c,s.fieldTransforms)}(i,"updateDoc",n._key,t),gm(s,[o.toMutation(n._key,$r.exists(!0))])}function Aye(n){return gm(l1(n.firestore,Or),[new ah(n._key,$r.none())])}function Nye(n,t){const e=l1(n.firestore,Or),r=zQ(n),s=tL(n.converter,t);return gm(e,[Yk(Sh(n.firestore),"addDoc",r._key,s,null!==n.converter,{}).toMutation(r._key,$r.exists(!1))]).then(()=>r)}function Iye(n,...t){var e,r,s;n=Jr(n);let i={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||jk(t[o])||(i=t[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges};if(jk(t[o])){const m=t[o];t[o]=null===(e=m.next)||void 0===e?void 0:e.bind(m),t[o+1]=null===(r=m.error)||void 0===r?void 0:r.bind(m),t[o+2]=null===(s=m.complete)||void 0===s?void 0:s.bind(m)}let u,h,g;if(n instanceof As)h=l1(n.firestore,Or),g=nh(n._key.path),u={next:m=>{t[o]&&t[o](nL(h,n,m))},error:t[o+1],complete:t[o+2]};else{const m=l1(n,io);h=l1(m.firestore,Or),g=m._query;const E=new o8(h);u={next:O=>{t[o]&&t[o](new Th(h,E,m,O))},error:t[o+1],complete:t[o+2]},sJ(n._query)}return function(m,E,O,k){const U=new tS(k),j=new fk(E,U,O);return m.asyncQueue.enqueueAndForget(I(function*(){return ok(yield Eh(m),j)})),()=>{U.bc(),m.asyncQueue.enqueueAndForget(I(function*(){return ck(yield Eh(m),j)}))}}(Ys(h),g,c,u)}function gm(n,t){return function(e,r){const s=new pi;return e.asyncQueue.enqueueAndForget(I(function*(){return function wCe(n,t,e){return mk.apply(this,arguments)}(yield function qk(n){return nS(n).then(t=>t.syncEngine)}(e),r,s)})),s.promise}(Ys(n),t)}function nL(n,t,e){const r=e.docs.get(t._key),s=new o8(n);return new Ph(n,s,t._key,r,new T5(e.hasPendingWrites,e.fromCache),t.converter)}function $4(){return new Kk("serverTimestamp")}function dJ(n,t){if(null!=n&&null!=t&&"object"==typeof n){if(null!=n.equals)return n.equals(t);{const e=n,r=t;for(const s of Object.keys(e)){if(!(s in r))return!1;if(!1===dJ(e[s],r[s]))return!1}return!0}}return n===t}function rL(n){return null==n||function Rye(n){return"object"==typeof n&&null!=n&&null!=n.equals}(n)||function WOe(n){return"string"==typeof n||"number"==typeof n||"boolean"==typeof n||null===n}(n)||function Dye(n){if("object"==typeof n){for(const t in n)if(null!=n[t]&&!1===rL(n[t]))return!1;return null!=n&&n.constructor.prototype===Object.prototype}return!1}(n)}function tc(n,t){if(rL(n)&&rL(t))return dJ(n,t);throw new Error(`Comparing non comparable objects: ${n.constructor.name} and ${t.constructor.name}`)}!function(n,t=!0){Kf="9.14.0",Vo(new no("firestore",(e,{instanceIdentifier:r,options:s})=>{const i=e.getProvider("app").getImmediate(),o=new Or(new t_e(e.getProvider("auth-internal")),new s_e(e.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new $e(Oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new l5(c.options.projectId,u)}(i,r),i);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),fs(dK,"3.7.3",n),fs(dK,"3.7.3","esm2017")}();class Ye{static fromFunctions(t,e){return new class extends Ye{encode(r){return t(r)}decode(r){return e(r)}}}static identity(){function t(e){return e}return Ye.fromFunctions(t,t)}static constant(t,e){return new class extends Ye{encode(r){return t}decode(r){return e}}}static tuple(t,e,r){return new class extends Ye{encode(s){const i=e(s),o={};return Object.keys(i).forEach(c=>{o[c]=t[c].encode(i[c])}),o}decode(s){const i={};return Object.keys(t).reverse().forEach(o=>{i[o]=t[o].decode(s[o])}),r(Object.values(i))}}}static disjunction(t,e){return ge.assert(t.length===e.length,"typePredicates and encoders should have same length"),new class extends Ye{encode(r){let s=0;for(const i of t){if(!0===i(r))return{type:s,encoded:e[s].encode(r)};s++}}decode(r){const s=ge.getNonNullable(r).type,i=ge.getNonNullable(r).encoded;return e[s].decode(i)}}}static list(t){return new class extends Ye{encode(e){return e.map(r=>{const s=t.encode(r);return ge.assert(!1===Array.isArray(s),"This encoder should not encode as array"),s})}decode(e){return e.map(t.decode)}}}}class y{constructor(t){this.value=t}static of(t){return new y(t)}static ofNullable(t){return null==t?y.empty():y.of(t)}static empty(){return new y(null)}static getEncoder(t){return new class extends Ye{encode(e){return e.isPresent()?t.encode(e.get()):null}decode(e){return null===e?y.empty():y.of(t.decode(e))}}}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(t){return this.isPresent()?this.value:t}equals(t){return this.isAbsent()?t.isAbsent():!t.isAbsent()&&tc(this.value,t.value)}equalsValue(t){return this.equals(y.of(t))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(t){return this.isPresent()?y.of(t(this.get())):y.empty()}}class ve{static success(t){return new zye(t)}static failure(t){return new Vye(t)}constructor(){}equals(t){return this.isFailure()?t.isFailure()&&this.getReason()===t.getReason():!t.isFailure()&&tc(this.get(),t.get())}}class zye extends ve{constructor(t){super(),this.value=t}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(t){return t}toOptional(){return y.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class Vye extends ve{constructor(t){super(),this.reason=t}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(t){return this.getReason()}toOptional(){return y.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return ve.failure(this.reason)}}var R;!function(n){n.SUCCESS=ve.success(void 0),n.ofFallible=function t(r){return r.isSuccess()?n.SUCCESS:n.failure(r.getReason())},n.failure=function e(r){return ve.failure(r)}}(R||(R={})),fs("firebase","9.14.0","app");const pJ="@firebase/installations",sL="0.5.16",mJ=`w:${sL}`,_J="FIS_v2",o6=new R4("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function vJ(n){return n instanceof Dc&&n.code.includes("request-failed")}function iL({projectId:n}){return`https://firebaseinstallations.googleapis.com/v1/projects/${n}/installations`}function CJ(n){return{token:n.token,requestStatus:2,expiresIn:Wye(n.expiresIn),creationTime:Date.now()}}function oL(n,t){return aL.apply(this,arguments)}function aL(){return aL=I(function*(n,t){const r=(yield t.json()).error;return o6.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}),aL.apply(this,arguments)}function yJ({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function EJ(n,{refreshToken:t}){const e=yJ(n);return e.append("Authorization",function jye(n){return`${_J} ${n}`}(t)),e}function cL(n){return lL.apply(this,arguments)}function lL(){return lL=I(function*(n){const t=yield n();return t.status>=500&&t.status<600?n():t}),lL.apply(this,arguments)}function Wye(n){return Number(n.replace("s","000"))}function Zye(n,t){return uL.apply(this,arguments)}function uL(){return uL=I(function*({appConfig:n,heartbeatServiceProvider:t},{fid:e}){const r=iL(n),s=yJ(n),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({fid:e,authVersion:_J,appId:n.appId,sdkVersion:mJ})},u=yield cL(()=>fetch(r,c));if(u.ok){const h=yield u.json();return{fid:h.fid||e,registrationStatus:2,refreshToken:h.refreshToken,authToken:CJ(h.authToken)}}throw yield oL("Create Installation",u)}),uL.apply(this,arguments)}function MJ(n){return new Promise(t=>{setTimeout(t,n)})}const Kye=/^[cdef][\w-]{21}$/;function Xye(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const e=function Qye(n){return function Yye(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return Kye.test(e)?e:""}catch{return""}}function wh(n){return`${n.appName}!${n.appId}`}const Oh=new Map;function SJ(n,t){const e=wh(n);PJ(e,t),function tEe(n,t){const e=function TJ(){return!w5&&"BroadcastChannel"in self&&(w5=new BroadcastChannel("[Firebase] FID Change"),w5.onmessage=n=>{PJ(n.data.key,n.data.fid)}),w5}();e&&e.postMessage({key:n,fid:t}),function wJ(){0===Oh.size&&w5&&(w5.close(),w5=null)}()}(e,t)}function PJ(n,t){const e=Oh.get(n);if(e)for(const r of e)r(t)}let w5=null;const O5="firebase-installations-store";let hL=null;function dL(){return hL||(hL=ZE("firebase-installations-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(O5)}})),hL}function fS(n,t){return pL.apply(this,arguments)}function pL(){return pL=I(function*(n,t){const e=wh(n),s=(yield dL()).transaction(O5,"readwrite"),i=s.objectStore(O5),o=yield i.get(e);return yield i.put(t,e),yield s.done,(!o||o.fid!==t.fid)&&SJ(n,t.fid),t}),pL.apply(this,arguments)}function gL(n){return mL.apply(this,arguments)}function mL(){return mL=I(function*(n){const t=wh(n),r=(yield dL()).transaction(O5,"readwrite");yield r.objectStore(O5).delete(t),yield r.done}),mL.apply(this,arguments)}function mm(n,t){return _L.apply(this,arguments)}function _L(){return _L=I(function*(n,t){const e=wh(n),s=(yield dL()).transaction(O5,"readwrite"),i=s.objectStore(O5),o=yield i.get(e),c=t(o);return void 0===c?yield i.delete(e):yield i.put(c,e),yield s.done,c&&(!o||o.fid!==c.fid)&&SJ(n,c.fid),c}),_L.apply(this,arguments)}function vL(n){return CL.apply(this,arguments)}function CL(){return CL=I(function*(n){let t;const e=yield mm(n.appConfig,r=>{const s=sEe(r),i=iEe(n,s);return t=i.registrationPromise,i.installationEntry});return""===e.fid?{installationEntry:yield t}:{installationEntry:e,registrationPromise:t}}),CL.apply(this,arguments)}function sEe(n){return bJ(n||{fid:Xye(),registrationStatus:0})}function iEe(n,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(o6.create("app-offline"))};const e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function oEe(n,t){return yL.apply(this,arguments)}(n,e);return{installationEntry:e,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:aEe(n)}:{installationEntry:t}}function yL(){return yL=I(function*(n,t){try{const e=yield Zye(n,t);return fS(n.appConfig,e)}catch(e){throw vJ(e)&&409===e.customData.serverCode?yield gL(n.appConfig):yield fS(n.appConfig,{fid:t.fid,registrationStatus:0}),e}}),yL.apply(this,arguments)}function aEe(n){return EL.apply(this,arguments)}function EL(){return EL=I(function*(n){let t=yield OJ(n.appConfig);for(;1===t.registrationStatus;)yield MJ(100),t=yield OJ(n.appConfig);if(0===t.registrationStatus){const{installationEntry:e,registrationPromise:r}=yield vL(n);return r||e}return t}),EL.apply(this,arguments)}function OJ(n){return mm(n,t=>{if(!t)throw o6.create("installation-not-found");return bJ(t)})}function bJ(n){return function cEe(n){return 1===n.registrationStatus&&n.registrationTime+1e4<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function lEe(n,t){return ML.apply(this,arguments)}function ML(){return ML=I(function*({appConfig:n,heartbeatServiceProvider:t},e){const r=uEe(n,e),s=EJ(n,e),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({installation:{sdkVersion:mJ,appId:n.appId}})},u=yield cL(()=>fetch(r,c));if(u.ok)return CJ(yield u.json());throw yield oL("Generate Auth Token",u)}),ML.apply(this,arguments)}function uEe(n,{fid:t}){return`${iL(n)}/${t}/authTokens:generate`}function SL(n){return PL.apply(this,arguments)}function PL(){return PL=I(function*(n,t=!1){let e;const r=yield mm(n.appConfig,i=>{if(!NJ(i))throw o6.create("not-registered");const o=i.authToken;if(!t&&dEe(o))return i;if(1===o.requestStatus)return e=fEe(n,t),i;{if(!navigator.onLine)throw o6.create("app-offline");const c=gEe(i);return e=hEe(n,c),c}});return e?yield e:r.authToken}),PL.apply(this,arguments)}function fEe(n,t){return TL.apply(this,arguments)}function TL(){return TL=I(function*(n,t){let e=yield AJ(n.appConfig);for(;1===e.authToken.requestStatus;)yield MJ(100),e=yield AJ(n.appConfig);const r=e.authToken;return 0===r.requestStatus?SL(n,t):r}),TL.apply(this,arguments)}function AJ(n){return mm(n,t=>{if(!NJ(t))throw o6.create("not-registered");return function mEe(n){return 1===n.requestStatus&&n.requestTime+1e4<Date.now()}(t.authToken)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}function hEe(n,t){return wL.apply(this,arguments)}function wL(){return wL=I(function*(n,t){try{const e=yield lEe(n,t),r=Object.assign(Object.assign({},t),{authToken:e});return yield fS(n.appConfig,r),e}catch(e){if(!vJ(e)||401!==e.customData.serverCode&&404!==e.customData.serverCode){const r=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});yield fS(n.appConfig,r)}else yield gL(n.appConfig);throw e}}),wL.apply(this,arguments)}function NJ(n){return void 0!==n&&2===n.registrationStatus}function dEe(n){return 2===n.requestStatus&&!function pEe(n){const t=Date.now();return t<n.creationTime||n.creationTime+n.expiresIn<t+36e5}(n)}function gEe(n){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:t})}function OL(){return OL=I(function*(n){const t=n,{installationEntry:e,registrationPromise:r}=yield vL(t);return r?r.catch(console.error):SL(t).catch(console.error),e.fid}),OL.apply(this,arguments)}function bL(){return bL=I(function*(n,t=!1){const e=n;return yield CEe(e),(yield SL(e,t)).token}),bL.apply(this,arguments)}function CEe(n){return AL.apply(this,arguments)}function AL(){return AL=I(function*(n){const{registrationPromise:t}=yield vL(n);t&&(yield t)}),AL.apply(this,arguments)}function xL(n){return o6.create("missing-app-config-values",{valueName:n})}const IJ="installations",PEe=n=>{const t=n.getProvider("app").getImmediate(),e=function MEe(n){if(!n||!n.options)throw xL("App Configuration");if(!n.name)throw xL("App Name");const t=["projectId","apiKey","appId"];for(const e of t)if(!n.options[e])throw xL(e);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(t);return{app:t,appConfig:e,heartbeatServiceProvider:Gf(t,"heartbeat"),_delete:()=>Promise.resolve()}},TEe=n=>{const e=Gf(n.getProvider("app").getImmediate(),IJ).getImmediate();return{getId:()=>function _Ee(n){return OL.apply(this,arguments)}(e),getToken:s=>function vEe(n){return bL.apply(this,arguments)}(e,s)}};(function wEe(){Vo(new no(IJ,PEe,"PUBLIC")),Vo(new no("installations-internal",TEe,"PRIVATE"))})(),fs(pJ,sL),fs(pJ,sL,"esm2017");const kL="@firebase/remote-config",Ea=new R4("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class zEe{constructor(t,e,r,s){this.client=t,this.storage=e,this.storageCache=r,this.logger=s}isCachedDataFresh(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-e,s=r<=t;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${t}. Is cache hit: ${s}.`),s}fetch(t){var e=this;return I(function*(){const[r,s]=yield Promise.all([e.storage.getLastSuccessfulFetchTimestampMillis(),e.storage.getLastSuccessfulFetchResponse()]);if(s&&e.isCachedDataFresh(t.cacheMaxAgeMillis,r))return s;t.eTag=s&&s.eTag;const i=yield e.client.fetch(t),o=[e.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===i.status&&o.push(e.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(o),i})()}}function VEe(n=navigator){return n.languages&&n.languages[0]||n.language}class HEe{constructor(t,e,r,s,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=r,this.projectId=s,this.apiKey=i,this.appId=o}fetch(t){var e=this;return I(function*(){var r,s,i;const[o,c]=yield Promise.all([e.firebaseInstallations.getId(),e.firebaseInstallations.getToken()]),h=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${e.projectId}/namespaces/${e.namespace}:fetch?key=${e.apiKey}`,g={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},m={sdk_version:e.sdkVersion,app_instance_id:o,app_instance_id_token:c,app_id:e.appId,language_code:VEe()},E={method:"POST",headers:g,body:JSON.stringify(m)},O=fetch(h,E),k=new Promise((ke,Ue)=>{t.signal.addEventListener(()=>{const et=new Error("The operation was aborted.");et.name="AbortError",Ue(et)})});let U;try{yield Promise.race([O,k]),U=yield O}catch(ke){let Ue="fetch-client-network";throw"AbortError"===(null===(r=ke)||void 0===r?void 0:r.name)&&(Ue="fetch-timeout"),Ea.create(Ue,{originalErrorMessage:null===(s=ke)||void 0===s?void 0:s.message})}let j=U.status;const oe=U.headers.get("ETag")||void 0;let Ee,ne;if(200===U.status){let ke;try{ke=yield U.json()}catch(Ue){throw Ea.create("fetch-client-parse",{originalErrorMessage:null===(i=Ue)||void 0===i?void 0:i.message})}Ee=ke.entries,ne=ke.state}if("INSTANCE_STATE_UNSPECIFIED"===ne?j=500:"NO_CHANGE"===ne?j=304:("NO_TEMPLATE"===ne||"EMPTY_CONFIG"===ne)&&(Ee={}),304!==j&&200!==j)throw Ea.create("fetch-status",{httpStatus:j});return{status:j,eTag:oe,config:Ee}})()}}class $Ee{constructor(t,e){this.client=t,this.storage=e}fetch(t){var e=this;return I(function*(){const r=(yield e.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return e.attemptFetch(t,r)})()}attemptFetch(t,{throttleEndTimeMillis:e,backoffCount:r}){var s=this;return I(function*(){yield function FEe(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(Ea.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(t.signal,e);try{const i=yield s.client.fetch(t);return yield s.storage.deleteThrottleMetadata(),i}catch(i){if(!function BEe(n){if(!(n instanceof Dc&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i))throw i;const o={throttleEndTimeMillis:Date.now()+eI(r),backoffCount:r+1};return yield s.storage.setThrottleMetadata(o),s.attemptFetch(t,o)}})()}}class qEe{constructor(t,e,r,s,i){this.app=t,this._client=e,this._storageCache=r,this._storage=s,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function dS(n,t){var e;const r=n.target.error||void 0;return Ea.create(t,{originalErrorMessage:r&&(null===(e=r)||void 0===e?void 0:e.message)})}const b5="app_namespace_store";class YEe{constructor(t,e,r,s=function ZEe(){return new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase_remote_config",1);r.onerror=s=>{t(dS(s,"storage-open"))},r.onsuccess=s=>{n(s.target.result)},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(b5,{keyPath:"compositeKey"})}}catch(r){t(Ea.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}})}()){this.appId=t,this.appName=e,this.namespace=r,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(t){return this.set("last_fetch_status",t)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(t){return this.set("last_successful_fetch_timestamp_millis",t)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(t){return this.set("last_successful_fetch_response",t)}getActiveConfig(){return this.get("active_config")}setActiveConfig(t){return this.set("active_config",t)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(t){return this.set("active_config_etag",t)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(t){return this.set("throttle_metadata",t)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(t){var e=this;return I(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([b5],"readonly").objectStore(b5),h=e.createCompositeKey(t);try{const g=u.get(h);g.onerror=m=>{i(dS(m,"storage-get"))},g.onsuccess=m=>{const E=m.target.result;s(E?E.value:void 0)}}catch(g){i(Ea.create("storage-get",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}set(t,e){var r=this;return I(function*(){const s=yield r.openDbPromise;return new Promise((i,o)=>{var c;const h=s.transaction([b5],"readwrite").objectStore(b5),g=r.createCompositeKey(t);try{const m=h.put({compositeKey:g,value:e});m.onerror=E=>{o(dS(E,"storage-set"))},m.onsuccess=()=>{i()}}catch(m){o(Ea.create("storage-set",{originalErrorMessage:null===(c=m)||void 0===c?void 0:c.message}))}})})()}delete(t){var e=this;return I(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([b5],"readwrite").objectStore(b5),h=e.createCompositeKey(t);try{const g=u.delete(h);g.onerror=m=>{i(dS(m,"storage-delete"))},g.onsuccess=()=>{s()}}catch(g){i(Ea.create("storage-delete",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}createCompositeKey(t){return[this.appId,this.appName,this.namespace,t].join()}}class KEe{constructor(t){this.storage=t}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var t=this;return I(function*(){const e=t.storage.getLastFetchStatus(),r=t.storage.getLastSuccessfulFetchTimestampMillis(),s=t.storage.getActiveConfig(),i=yield e;i&&(t.lastFetchStatus=i);const o=yield r;o&&(t.lastSuccessfulFetchTimestampMillis=o);const c=yield s;c&&(t.activeConfig=c)})()}setLastFetchStatus(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)}setLastSuccessfulFetchTimestampMillis(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)}setActiveConfig(t){return this.activeConfig=t,this.storage.setActiveConfig(t)}}function QEe(){return VL.apply(this,arguments)}function VL(){return(VL=I(function*(){if(!Xu())return!1;try{return yield hg()}catch{return!1}})).apply(this,arguments)}!function XEe(){Vo(new no("remote-config",function n(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Ea.create("registration-window");if(!Xu())throw Ea.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:c}=r.options;if(!i)throw Ea.create("registration-project-id");if(!o)throw Ea.create("registration-api-key");if(!c)throw Ea.create("registration-app-id");const u=new YEe(c,r.name,e=e||"firebase"),h=new KEe(u),g=new Uf(kL);g.logLevel=g1.ERROR;const m=new HEe(s,qf,e,i,o,c),E=new $Ee(m,u),O=new zEe(E,u,h,g),k=new qEe(r,O,h,u,g);return function LEe(n){const t=Jr(n);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0}))}(k),k},"PUBLIC").setMultipleInstances(!0)),fs(kL,"0.3.15"),fs(kL,"0.3.15","esm2017")}();const JEe="/firebase-messaging-sw.js",eMe="/firebase-cloud-messaging-push-scope",RJ="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",DJ="google.c.a.c_id",nMe="google.c.a.c_l",rMe="google.c.a.ts",sMe="google.c.a.e";var bh=(()=>(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"}(bh||(bh={})),bh))();function a6(n){const t=new Uint8Array(n);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function iMe(n){const e=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(e),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}const HL="fcm_token_details_db",zJ="fcm_token_object_Store";function aMe(n){return FL.apply(this,arguments)}function FL(){return FL=I(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(i=>i.name).includes(HL))return null;let t=null;return(yield ZE(HL,5,{upgrade:(r=I(function*(s,i,o,c){var u;if(i<2||!s.objectStoreNames.contains(zJ))return;const h=c.objectStore(zJ),g=yield h.index("fcmSenderId").get(n);if(yield h.clear(),g)if(2===i){const m=g;if(!m.auth||!m.p256dh||!m.endpoint)return;t={token:m.fcmToken,createTime:null!==(u=m.createTime)&&void 0!==u?u:Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:"string"==typeof m.vapidKey?m.vapidKey:a6(m.vapidKey)}}}else if(3===i){const m=g;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:a6(m.auth),p256dh:a6(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:a6(m.vapidKey)}}}else if(4===i){const m=g;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:a6(m.auth),p256dh:a6(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:a6(m.vapidKey)}}}}),function(i,o,c,u){return r.apply(this,arguments)})})).close(),yield aI(HL),yield aI("fcm_vapid_details_db"),yield aI("undefined"),cMe(t)?t:null;var r}),FL.apply(this,arguments)}function cMe(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:t}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}const A5="firebase-messaging-store";let BL=null;function $L(){return BL||(BL=ZE("firebase-messaging-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(A5)}})),BL}function VJ(n){return UL.apply(this,arguments)}function UL(){return UL=I(function*(n){const t=jL(n),r=yield(yield $L()).transaction(A5).objectStore(A5).get(t);if(r)return r;{const s=yield aMe(n.appConfig.senderId);if(s)return yield GL(n,s),s}}),UL.apply(this,arguments)}function GL(n,t){return qL.apply(this,arguments)}function qL(){return qL=I(function*(n,t){const e=jL(n),s=(yield $L()).transaction(A5,"readwrite");return yield s.objectStore(A5).put(t,e),yield s.done,t}),qL.apply(this,arguments)}function fMe(n){return WL.apply(this,arguments)}function WL(){return WL=I(function*(n){const t=jL(n),r=(yield $L()).transaction(A5,"readwrite");yield r.objectStore(A5).delete(t),yield r.done}),WL.apply(this,arguments)}function jL({appConfig:n}){return n.appId}const k2=new R4("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function dMe(n,t){return ZL.apply(this,arguments)}function ZL(){return ZL=I(function*(n,t){var e;const r=yield QL(n),s=FJ(t),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(XL(n.appConfig),i)).json()}catch(c){throw k2.create("token-subscribe-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw k2.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw k2.create("token-subscribe-no-token");return o.token}),ZL.apply(this,arguments)}function pMe(n,t){return YL.apply(this,arguments)}function YL(){return YL=I(function*(n,t){var e;const r=yield QL(n),s=FJ(t.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(`${XL(n.appConfig)}/${t.token}`,i)).json()}catch(c){throw k2.create("token-update-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw k2.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw k2.create("token-update-no-token");return o.token}),YL.apply(this,arguments)}function HJ(n,t){return KL.apply(this,arguments)}function KL(){return KL=I(function*(n,t){var e;const s={method:"DELETE",headers:yield QL(n)};try{const o=yield(yield fetch(`${XL(n.appConfig)}/${t}`,s)).json();if(o.error)throw k2.create("token-unsubscribe-failed",{errorInfo:o.error.message})}catch(i){throw k2.create("token-unsubscribe-failed",{errorInfo:null===(e=i)||void 0===e?void 0:e.toString()})}}),KL.apply(this,arguments)}function XL({projectId:n}){return`https://fcmregistrations.googleapis.com/v1/projects/${n}/registrations`}function QL(n){return JL.apply(this,arguments)}function JL(){return JL=I(function*({appConfig:n,installations:t}){const e=yield t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${e}`})}),JL.apply(this,arguments)}function FJ({p256dh:n,auth:t,endpoint:e,vapidKey:r}){const s={web:{endpoint:e,auth:t,p256dh:n}};return r!==RJ&&(s.web.applicationPubKey=r),s}function mMe(n){return eR.apply(this,arguments)}function eR(){return eR=I(function*(n){const t=yield vMe(n.swRegistration,n.vapidKey),e={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:t.endpoint,auth:a6(t.getKey("auth")),p256dh:a6(t.getKey("p256dh"))},r=yield VJ(n.firebaseDependencies);if(r){if(CMe(r.subscriptionOptions,e))return Date.now()>=r.createTime+6048e5?_Me(n,{token:r.token,createTime:Date.now(),subscriptionOptions:e}):r.token;try{yield HJ(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return $J(n.firebaseDependencies,e)}return $J(n.firebaseDependencies,e)}),eR.apply(this,arguments)}function BJ(n){return tR.apply(this,arguments)}function tR(){return tR=I(function*(n){const t=yield VJ(n.firebaseDependencies);t&&(yield HJ(n.firebaseDependencies,t.token),yield fMe(n.firebaseDependencies));const e=yield n.swRegistration.pushManager.getSubscription();return!e||e.unsubscribe()}),tR.apply(this,arguments)}function _Me(n,t){return nR.apply(this,arguments)}function nR(){return nR=I(function*(n,t){try{const e=yield pMe(n.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:e,createTime:Date.now()});return yield GL(n.firebaseDependencies,r),e}catch(e){throw yield BJ(n),e}}),nR.apply(this,arguments)}function $J(n,t){return rR.apply(this,arguments)}function rR(){return rR=I(function*(n,t){const r={token:yield dMe(n,t),createTime:Date.now(),subscriptionOptions:t};return yield GL(n,r),r.token}),rR.apply(this,arguments)}function vMe(n,t){return sR.apply(this,arguments)}function sR(){return sR=I(function*(n,t){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:iMe(t)})}),sR.apply(this,arguments)}function CMe(n,t){return t.vapidKey===n.vapidKey&&t.endpoint===n.endpoint&&t.auth===n.auth&&t.p256dh===n.p256dh}function UJ(n){const t={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function yMe(n,t){if(!t.notification)return;n.notification={};const e=t.notification.title;e&&(n.notification.title=e);const r=t.notification.body;r&&(n.notification.body=r);const s=t.notification.image;s&&(n.notification.image=s);const i=t.notification.icon;i&&(n.notification.icon=i)}(t,n),function EMe(n,t){!t.data||(n.data=t.data)}(t,n),function MMe(n,t){var e,r,s,i,o;if(!(t.fcmOptions||null!==(e=t.notification)&&void 0!==e&&e.click_action))return;n.fcmOptions={};const c=null!==(s=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==s?s:null===(i=t.notification)||void 0===i?void 0:i.click_action;c&&(n.fcmOptions.link=c);const u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(n.fcmOptions.analyticsLabel=u)}(t,n),t}function SMe(n){return"object"==typeof n&&!!n&&DJ in n}function GJ(n,t){const e=[];for(let r=0;r<n.length;r++)e.push(n.charAt(r)),r<t.length&&e.push(t.charAt(r));return e.join("")}function iR(n){return k2.create("missing-app-config-values",{valueName:n})}GJ("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),GJ("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class TMe{constructor(t,e,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=function PMe(n){if(!n||!n.options)throw iR("App Configuration Object");if(!n.name)throw iR("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:e}=n;for(const r of t)if(!e[r])throw iR(r);return{appName:n.name,projectId:e.projectId,apiKey:e.apiKey,appId:e.appId,senderId:e.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:s,installations:e,analyticsProvider:r}}_delete(){return Promise.resolve()}}function qJ(n){return oR.apply(this,arguments)}function oR(){return oR=I(function*(n){var t;try{n.swRegistration=yield navigator.serviceWorker.register(JEe,{scope:eMe}),n.swRegistration.update().catch(()=>{})}catch(e){throw k2.create("failed-service-worker-registration",{browserErrorMessage:null===(t=e)||void 0===t?void 0:t.message})}}),oR.apply(this,arguments)}function wMe(n,t){return aR.apply(this,arguments)}function aR(){return aR=I(function*(n,t){if(!t&&!n.swRegistration&&(yield qJ(n)),t||!n.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw k2.create("invalid-sw-registration");n.swRegistration=t}}),aR.apply(this,arguments)}function OMe(n,t){return cR.apply(this,arguments)}function cR(){return cR=I(function*(n,t){t?n.vapidKey=t:n.vapidKey||(n.vapidKey=RJ)}),cR.apply(this,arguments)}function lR(){return lR=I(function*(n,t){if(!navigator)throw k2.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw k2.create("permission-blocked");return yield OMe(n,t?.vapidKey),yield wMe(n,t?.serviceWorkerRegistration),mMe(n)}),lR.apply(this,arguments)}function bMe(n,t,e){return uR.apply(this,arguments)}function uR(){return uR=I(function*(n,t,e){const r=AMe(t);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:e[DJ],message_name:e[nMe],message_time:e[rMe],message_device_time:Math.floor(Date.now()/1e3)})}),uR.apply(this,arguments)}function AMe(n){switch(n){case bh.NOTIFICATION_CLICKED:return"notification_open";case bh.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function fR(){return fR=I(function*(n,t){const e=t.data;if(!e.isFirebaseMessaging)return;n.onMessageHandler&&e.messageType===bh.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(UJ(e)):n.onMessageHandler.next(UJ(e)));const r=e.data;SMe(r)&&"1"===r[sMe]&&(yield bMe(n,e.messageType,r))}),fR.apply(this,arguments)}const jJ="@firebase/messaging",IMe=n=>{const t=new TMe(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>function NMe(n,t){return fR.apply(this,arguments)}(t,e)),t},xMe=n=>{const t=n.getProvider("messaging").getImmediate();return{getToken:r=>function WJ(n,t){return lR.apply(this,arguments)}(t,r)}};function YJ(){return hR.apply(this,arguments)}function hR(){return(hR=I(function*(){try{yield hg()}catch{return!1}return typeof window<"u"&&Xu()&&KN()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function kMe(){Vo(new no("messaging",IMe,"PUBLIC")),Vo(new no("messaging-internal",xMe,"PRIVATE")),fs(jJ,"0.11.0"),fs(jJ,"0.11.0","esm2017")}();const pS="analytics",DMe="firebase_id",HMe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",KJ="https://www.googletagmanager.com/gtag/js",L2=new Uf("@firebase/analytics");function XJ(n){return Promise.all(n.map(t=>t.catch(e=>e)))}function FMe(n,t){const e=document.createElement("script");e.src=`${KJ}?l=${n}&id=${t}`,e.async=!0,document.head.appendChild(e)}function $Me(n,t,e,r,s,i){return gR.apply(this,arguments)}function gR(){return gR=I(function*(n,t,e,r,s,i){const o=r[s];try{if(o)yield t[o];else{const u=(yield XJ(e)).find(h=>h.measurementId===s);u&&(yield t[u.appId])}}catch(c){L2.error(c)}n("config",s,i)}),gR.apply(this,arguments)}function UMe(n,t,e,r,s){return mR.apply(this,arguments)}function mR(){return mR=I(function*(n,t,e,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const c=yield XJ(e);for(const u of o){const h=c.find(m=>m.measurementId===u),g=h&&t[h.appId];if(!g){i=[];break}i.push(g)}}0===i.length&&(i=Object.values(t)),yield Promise.all(i),n("event",r,s||{})}catch(i){L2.error(i)}}),mR.apply(this,arguments)}function WMe(n){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(KJ)&&e.src.includes(n))return e;return null}const nc=new R4("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),QJ=new class KMe{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function XMe(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function QMe(n){return _R.apply(this,arguments)}function _R(){return _R=I(function*(n){var t;const{appId:e,apiKey:r}=n,s={method:"GET",headers:XMe(r)},i=HMe.replace("{app-id}",e),o=yield fetch(i,s);if(200!==o.status&&304!==o.status){let c="";try{const u=yield o.json();null!==(t=u.error)&&void 0!==t&&t.message&&(c=u.error.message)}catch{}throw nc.create("config-fetch-failed",{httpStatus:o.status,responseMessage:c})}return o.json()}),_R.apply(this,arguments)}function JMe(n){return vR.apply(this,arguments)}function vR(){return vR=I(function*(n,t=QJ,e){const{appId:r,apiKey:s,measurementId:i}=n.options;if(!r)throw nc.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw nc.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new nSe;return setTimeout(I(function*(){c.abort()}),void 0!==e?e:6e4),JJ({appId:r,apiKey:s,measurementId:i},o,c,t)}),vR.apply(this,arguments)}function JJ(n,t,e){return CR.apply(this,arguments)}function CR(){return CR=I(function*(n,{throttleEndTimeMillis:t,backoffCount:e},r,s=QJ){var i,o;const{appId:c,measurementId:u}=n;try{yield eSe(r,t)}catch(h){if(u)return L2.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${null===(i=h)||void 0===i?void 0:i.message}]`),{appId:c,measurementId:u};throw h}try{const h=yield QMe(n);return s.deleteThrottleMetadata(c),h}catch(h){const g=h;if(!tSe(g)){if(s.deleteThrottleMetadata(c),u)return L2.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:c,measurementId:u};throw h}const m=503===Number(null===(o=g?.customData)||void 0===o?void 0:o.httpStatus)?eI(e,s.intervalMillis,30):eI(e,s.intervalMillis),E={throttleEndTimeMillis:Date.now()+m,backoffCount:e+1};return s.setThrottleMetadata(c,E),L2.debug(`Calling attemptFetch again in ${m} millis`),JJ(n,E,r,s)}}),CR.apply(this,arguments)}function eSe(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(nc.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function tSe(n){if(!(n instanceof Dc&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}class nSe{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let yR,wR;function ER(){return ER=I(function*(n,t,e,r,s){if(s&&s.global)n("event",e,r);else{const i=yield t;n("event",e,Object.assign(Object.assign({},r),{send_to:i}))}}),ER.apply(this,arguments)}function eee(n){wR=n}function tee(n){yR=n}function cSe(){return OR.apply(this,arguments)}function OR(){return OR=I(function*(){var n;if(!Xu())return L2.warn(nc.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield hg()}catch(t){return L2.warn(nc.create("indexeddb-unavailable",{errorInfo:null===(n=t)||void 0===n?void 0:n.toString()}).message),!1}return!0}),OR.apply(this,arguments)}function bR(){return bR=I(function*(n,t,e,r,s,i,o){var c;const u=JMe(n);u.then(O=>{e[O.measurementId]=O.appId,n.options.measurementId&&O.measurementId!==n.options.measurementId&&L2.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${O.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(O=>L2.error(O)),t.push(u);const h=cSe().then(O=>{if(O)return r.getId()}),[g,m]=yield Promise.all([u,h]);WMe(i)||FMe(i,g.measurementId),wR&&(s("consent","default",wR),eee(void 0)),s("js",new Date);const E=null!==(c=o?.config)&&void 0!==c?c:{};return E.origin="firebase",E.update=!0,null!=m&&(E[DMe]=m),s("config",g.measurementId,E),yR&&(s("set",yR),tee(void 0)),g.measurementId}),bR.apply(this,arguments)}class uSe{constructor(t){this.app=t}_delete(){return delete c6[this.app.options.appId],Promise.resolve()}}let c6={},nee=[];const ree={};let iee,l6,gS="dataLayer",AR=!1;function hSe(n,t,e){!function fSe(){const n=[];if(YN()&&n.push("This is a browser extension environment."),KN()||n.push("Cookies are not available."),n.length>0){const t=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),e=nc.create("invalid-analytics-context",{errorInfo:t});L2.warn(e.message)}}();const r=n.options.appId;if(!r)throw nc.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw nc.create("no-api-key");L2.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=c6[r])throw nc.create("already-exists",{id:r});if(!AR){!function BMe(n){let t=[];Array.isArray(window[n])?t=window[n]:window[n]=t}(gS);const{wrappedGtag:i,gtagCore:o}=function qMe(n,t,e,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&"function"==typeof window[s]&&(i=window[s]),window[s]=function GMe(n,t,e,r){function i(){return(i=I(function*(o,c,u){try{"event"===o?yield UMe(n,t,e,c,u):"config"===o?yield $Me(n,t,e,r,c,u):"consent"===o?n("consent","update",u):n("set",c)}catch(h){L2.error(h)}})).apply(this,arguments)}return function s(o,c,u){return i.apply(this,arguments)}}(i,n,t,e),{gtagCore:i,wrappedGtag:window[s]}}(c6,nee,ree,gS,"gtag");l6=i,iee=o,AR=!0}return c6[r]=function lSe(n,t,e,r,s,i,o){return bR.apply(this,arguments)}(n,nee,ree,t,iee,gS,e),new uSe(n)}function pSe(){return NR.apply(this,arguments)}function NR(){return(NR=I(function*(){if(YN()||!KN()||!Xu())return!1;try{return yield hg()}catch{return!1}})).apply(this,arguments)}const oee="@firebase/analytics";!function mSe(){Vo(new no(pS,(t,{options:e})=>hSe(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e),"PUBLIC")),Vo(new no("analytics-internal",function n(t){try{const e=t.getProvider(pS).getImmediate();return{logEvent:(r,s,i)=>function gSe(n,t,e,r){n=Jr(n),function rSe(n,t,e,r,s){return ER.apply(this,arguments)}(l6,c6[n.app.options.appId],t,e,r).catch(s=>L2.error(s))}(e,r,s,i)}}catch(e){throw nc.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),fs(oee,"0.8.4"),fs(oee,"0.8.4","esm2017")}();class _Se extends k1{constructor(t,e){super()}schedule(t,e=0){return this}}const mS={setInterval(n,t,...e){const{delegate:r}=mS;return r?.setInterval?r.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=mS;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class cee extends _Se{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var r;if(this.closed)return this;this.state=t;const s=this.id,i=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(i,s,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,e),this}requestAsyncId(t,e,r=0){return mS.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&mS.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let s,r=!1;try{this.work(t)}catch(i){r=!0,s=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,i3(r,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const IR={now:()=>(IR.delegate||Date).now(),delegate:void 0};class _m{constructor(t,e=_m.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,r){return new this.schedulerActionCtor(this,t).schedule(r,e)}}_m.now=IR.now;class lee extends _m{constructor(t,e=_m.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}}const ySe=new class CSe extends lee{}(class vSe extends cee{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(t,e,r):(t.flush(this),0)}}),ESe=new lee(cee),_S=new E0("7.4.1"),xR="__angularfire_symbol__analyticsIsSupportedValue",kR="__angularfire_symbol__analyticsIsSupported",LR="__angularfire_symbol__remoteConfigIsSupportedValue",RR="__angularfire_symbol__remoteConfigIsSupported",DR="__angularfire_symbol__messagingIsSupportedValue",zR="__angularfire_symbol__messagingIsSupported";function HR(n,t,e){if(t){if(1===t.length)return t[0];const i=t.filter(o=>o.app===e);if(1===i.length)return i[0]}return e.container.getProvider(n).getImmediate({optional:!0})}globalThis[kR]||(globalThis[kR]=pSe().then(n=>globalThis[xR]=n).catch(()=>globalThis[xR]=!1)),globalThis[zR]||(globalThis[zR]=YJ().then(n=>globalThis[DR]=n).catch(()=>globalThis[DR]=!1)),globalThis[RR]||(globalThis[RR]=QEe().then(n=>globalThis[LR]=n).catch(()=>globalThis[LR]=!1));const FR=(n,t)=>{const e=t?[t]:WZ(),r=[];return e.forEach(s=>{s.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r};function Ah(){}class uee{constructor(t,e=ySe){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,r){const s=this.zone;return this.delegate.schedule(function(o){s.runGuarded(()=>{t.apply(this,[o])})},e,r)}}class MSe{constructor(t){this.zone=t,this.task=null}call(t,e){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ah,{},Ah,Ah)),e.pipe(w2({next:r,complete:r,error:r})).subscribe(t).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let BR=(()=>{class n{constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new uee(Zone.current)),this.insideAngular=e.run(()=>new uee(Zone.current,ESe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(e){return new(e||n)(ze(wr))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function N5(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function SSe(n){return N5().ngZone.runOutsideAngular(()=>n())}function I5(n){return N5().ngZone.run(()=>n())}function PSe(n){return N5(),function TSe(n){return function(e){return(e=e.lift(new MSe(n.ngZone))).pipe(Mc(n.outsideAngular),pl(n.insideAngular))}}(N5())(n)}const wSe=(n,t)=>function(){const r=arguments;return t&&setTimeout(()=>{"scheduled"===t.state&&t.invoke()},10),I5(()=>n.apply(void 0,r))},br=(n,t)=>function(){let e;const r=arguments;for(let i=0;i<arguments.length;i++)"function"==typeof r[i]&&(t&&(e||(e=I5(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ah,{},Ah,Ah)))),r[i]=wSe(r[i],e));const s=SSe(()=>n.apply(this,r));if(!t){if(s instanceof Mr){const i=N5();return s.pipe(Mc(i.outsideAngular),pl(i.insideAngular))}return I5(()=>s)}return s instanceof Mr?s.pipe(PSe):s instanceof Promise?I5(()=>new Promise((i,o)=>s.then(c=>I5(()=>i(c)),c=>I5(()=>o(c))))):"function"==typeof s&&e?function(){return setTimeout(()=>{e&&"scheduled"===e.state&&e.invoke()},10),s.apply(this,arguments)}:I5(()=>s)};class Nh{constructor(t){return t}}class $R{constructor(){return WZ()}}const UR=new Dt("angularfire2._apps"),bSe={provide:Nh,useFactory:function OSe(n){return n&&1===n.length?n[0]:new Nh(uI())},deps:[[new ui,UR]]},ASe={provide:$R,deps:[[new ui,UR]]};function NSe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new Nh(r)}}let ISe=(()=>{class n{constructor(e){fs("angularfire",_S.full,"core"),fs("angularfire",_S.full,"app"),fs("angular",jv.full,e.toString())}}return n.\u0275fac=function(e){return new(e||n)(ze(bp))},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[bSe,ASe]}),n})();const kSe=br(qZ,!0),GR=new Map,fee={activated:!1,tokenObservers:[]},LSe={initialized:!1,enabled:!1};function R2(n){return GR.get(n)||Object.assign({},fee)}function vS(){return LSe}class FSe{constructor(t,e,r,s,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){var e=this;return I(function*(){e.stop();try{e.pending=new qE,yield function BSe(n){return new Promise(t=>{setTimeout(t,n)})}(e.getNextRun(t)),e.pending.resolve(),yield e.pending.promise,e.pending=new qE,yield e.operation(),e.pending.resolve(),yield e.pending.promise,e.process(!0).catch(()=>{})}catch(r){e.retryPolicy(r)?e.process(!1).catch(()=>{}):e.stop()}})()}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const $o=new R4("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function dee(n){if(!R2(n).activated)throw $o.create("use-before-activation",{appName:n.name})}function jR(n,t){return ZR.apply(this,arguments)}function ZR(){return ZR=I(function*({url:n,body:t},e){var r,s;const i={"Content-Type":"application/json"},o=e.getImmediate({optional:!0});if(o){const O=yield o.getHeartbeatsHeader();O&&(i["X-Firebase-Client"]=O)}const c={method:"POST",body:JSON.stringify(t),headers:i};let u,h;try{u=yield fetch(n,c)}catch(O){throw $o.create("fetch-network-error",{originalErrorMessage:null===(r=O)||void 0===r?void 0:r.message})}if(200!==u.status)throw $o.create("fetch-status-error",{httpStatus:u.status});try{h=yield u.json()}catch(O){throw $o.create("fetch-parse-error",{originalErrorMessage:null===(s=O)||void 0===s?void 0:s.message})}const g=h.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw $o.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const m=1e3*Number(g[1]),E=Date.now();return{token:h.token,expireTimeMillis:E+m,issuedAtTimeMillis:E}}),ZR.apply(this,arguments)}function qSe(n,t){const{projectId:e,appId:r,apiKey:s}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${e}/apps/${r}:exchangeDebugToken?key=${s}`,body:{debug_token:t}}}const vm="firebase-app-check-store";let ES=null;function gee(){return ES||(ES=new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=s=>{n(s.target.result)},r.onerror=s=>{var i;t($o.create("storage-open",{originalErrorMessage:null===(i=s.target.error)||void 0===i?void 0:i.message}))},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(vm,{keyPath:"compositeKey"})}}catch(r){t($o.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}}),ES)}function YR(){return YR=I(function*(n,t){const r=(yield gee()).transaction(vm,"readwrite"),i=r.objectStore(vm).put({compositeKey:n,value:t});return new Promise((o,c)=>{i.onsuccess=u=>{o()},r.onerror=u=>{var h;c($o.create("storage-set",{originalErrorMessage:null===(h=u.target.error)||void 0===h?void 0:h.message}))}})}),YR.apply(this,arguments)}const Cm=new Uf("@firebase/app-check");function QR(n,t){return Xu()?function YSe(n,t){return function mee(n,t){return YR.apply(this,arguments)}(function vee(n){return`${n.options.appId}-${n.name}`}(n),t)}(n,t).catch(e=>{Cm.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function Cee(){return vS().enabled}function yee(){return eD.apply(this,arguments)}function eD(){return eD=I(function*(){const n=vS();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),eD.apply(this,arguments)}const tPe={error:"UNKNOWN_ERROR"};function nPe(n){return ZN.encodeString(JSON.stringify(n),!1)}function MS(n){return tD.apply(this,arguments)}function tD(){return tD=I(function*(n,t=!1){const e=n.app;dee(e);const r=R2(e);let i,s=r.token;if(s&&!Ih(s)&&(r.token=void 0,s=void 0),!s){const u=yield r.cachedTokenPromise;u&&(Ih(u)?s=u:yield QR(e,void 0))}if(!t&&s&&Ih(s))return{token:s.token};let c,o=!1;if(Cee()){r.exchangeTokenPromise||(r.exchangeTokenPromise=jR(qSe(e,yield yee()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);const u=yield r.exchangeTokenPromise;return yield QR(e,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),s=yield R2(e).exchangeTokenPromise}catch(u){"appCheck/throttled"===u.code?Cm.warn(u.message):Cm.error(u),i=u}return s?i?c=Ih(s)?{token:s.token,internalError:i}:See(i):(c={token:s.token},r.token=s,yield QR(e,s)):c=See(i),o&&Mee(e,c),c}),tD.apply(this,arguments)}function rD(n,t){const e=R2(n),r=e.tokenObservers.filter(s=>s.next!==t);0===r.length&&e.tokenRefresher&&e.tokenRefresher.isRunning()&&e.tokenRefresher.stop(),e.tokenObservers=r}function Eee(n){const{app:t}=n,e=R2(t);let r=e.tokenRefresher;r||(r=function rPe(n){const{app:t}=n;return new FSe(I(function*(){let r;if(r=R2(t).token?yield MS(n,!0):yield MS(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const e=R2(t);if(e.token){let r=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,e.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),e.tokenRefresher=r),!r.isRunning()&&e.isTokenAutoRefreshEnabled&&r.start()}function Mee(n,t){const e=R2(n).tokenObservers;for(const r of e)try{"EXTERNAL"===r.type&&null!=t.error?r.error(t.error):r.next(t)}catch{}}function Ih(n){return n.expireTimeMillis-Date.now()>0}function See(n){return{token:nPe(tPe),error:n}}class sPe{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=R2(this.app);for(const e of t)rD(this.app,e.next);return Promise.resolve()}}const Iee="app-check-internal";!function vPe(){Vo(new no("app-check",n=>function iPe(n,t){return new sPe(n,t)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,e)=>{n.getProvider(Iee).initialize()})),Vo(new no(Iee,n=>function oPe(n){return{getToken:t=>MS(n,t),addTokenListener:t=>function nD(n,t,e,r){const{app:s}=n,i=R2(s);if(i.tokenObservers=[...i.tokenObservers,{next:e,error:r,type:t}],i.token&&Ih(i.token)){const c=i.token;Promise.resolve().then(()=>{e({token:c.token}),Eee(n)}).catch(()=>{})}i.cachedTokenPromise.then(()=>Eee(n))}(n,"INTERNAL",t),removeTokenListener:t=>rD(n.app,t)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),fs("@firebase/app-check","0.5.17")}();class aD{constructor(){return FR("app-check")}}typeof window<"u"&&window;const SPe=function kee(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Lee=new R4("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ree=new Uf("@firebase/auth");function PS(n,...t){Ree.logLevel<=g1.ERROR&&Ree.error(`Auth (${qf}): ${n}`,...t)}function Ma(n,...t){throw lD(n,...t)}function rc(n,...t){return lD(n,...t)}function Dee(n,t,e){const r=Object.assign(Object.assign({},SPe()),{[t]:e});return new R4("auth","Firebase",r).create(t,{appName:n.name})}function xh(n,t,e){if(!(t instanceof e))throw e.name!==t.constructor.name&&Ma(n,"argument-error"),Dee(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function lD(n,...t){if("string"!=typeof n){const e=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(e,...r)}return Lee.create(n,...t)}function st(n,t,...e){if(!n)throw lD(t,...e)}function U4(n){const t="INTERNAL ASSERTION FAILED: "+n;throw PS(t),new Error(t)}function u6(n,t){n||U4(t)}const zee=new Map;function f6(n){u6(n instanceof Function,"Expected a class definition");let t=zee.get(n);return t?(u6(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,zee.set(n,t),t)}function ym(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.href)||""}function Vee(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.protocol)||null}class Em{constructor(t,e){this.shortDelay=t,this.longDelay=e,u6(e>t,"Short delay should be less than long delay!"),this.isMobile=function Tpe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($i())}()||function Ope(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function wPe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function uD(){return"http:"===Vee()||"https:"===Vee()}()||YN()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function fD(n,t){u6(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class Hee{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void U4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void U4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void U4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const bPe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},APe=new Em(3e4,6e4);function mi(n,t){return n.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:n.tenantId}):t}function Zi(n,t,e,r){return hD.apply(this,arguments)}function hD(){return hD=I(function*(n,t,e,r,s={}){return Fee(n,s,I(function*(){let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const c=dg(Object.assign({key:n.config.apiKey},o)).slice(1),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode),Hee.fetch()(Bee(n,n.config.apiHost,e,c),Object.assign({method:t,headers:u,referrerPolicy:"no-referrer"},i))}))}),hD.apply(this,arguments)}function Fee(n,t,e){return dD.apply(this,arguments)}function dD(){return dD=I(function*(n,t,e){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},bPe),t);try{const s=new NPe(n),i=yield Promise.race([e(),s.promise]);s.clearNetworkTimeout();const o=yield i.json();if("needConfirmation"in o)throw Mm(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===u)throw Mm(n,"credential-already-in-use",o);if("EMAIL_EXISTS"===u)throw Mm(n,"email-already-in-use",o);if("USER_DISABLED"===u)throw Mm(n,"user-disabled",o);const g=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Dee(n,g,h);Ma(n,g)}}catch(s){if(s instanceof Dc)throw s;Ma(n,"network-request-failed")}}),dD.apply(this,arguments)}function h6(n,t,e,r){return pD.apply(this,arguments)}function pD(){return pD=I(function*(n,t,e,r,s={}){const i=yield Zi(n,t,e,r,s);return"mfaPendingCredential"in i&&Ma(n,"multi-factor-auth-required",{_serverResponse:i}),i}),pD.apply(this,arguments)}function Bee(n,t,e,r){const s=`${t}${e}?${r}`;return n.config.emulator?fD(n.config,s):`${n.config.apiScheme}://${s}`}class NPe{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(rc(this.auth,"network-request-failed")),APe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Mm(n,t,e){const r={appName:n.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const s=rc(n,t,r);return s.customData._tokenResponse=e,s}function gD(){return gD=I(function*(n,t){return Zi(n,"POST","/v1/accounts:delete",t)}),gD.apply(this,arguments)}function kPe(n,t){return _D.apply(this,arguments)}function _D(){return _D=I(function*(n,t){return Zi(n,"POST","/v1/accounts:lookup",t)}),_D.apply(this,arguments)}function Sm(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}function vD(){return vD=I(function*(n,t=!1){const e=Jr(n),r=yield e.getIdToken(t),s=TS(r);st(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const i="object"==typeof s.firebase?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:Sm(CD(s.auth_time)),issuedAtTime:Sm(CD(s.iat)),expirationTime:Sm(CD(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}),vD.apply(this,arguments)}function CD(n){return 1e3*Number(n)}function TS(n){var t;const[e,r,s]=n.split(".");if(void 0===e||void 0===r||void 0===s)return PS("JWT malformed, contained fewer than 3 sections"),null;try{const i=GE(r);return i?JSON.parse(i):(PS("Failed to decode base64 JWT payload"),null)}catch(i){return PS("Caught error parsing JWT payload as JSON",null===(t=i)||void 0===t?void 0:t.toString()),null}}function d6(n,t){return yD.apply(this,arguments)}function yD(){return yD=I(function*(n,t,e=!1){if(e)return t;try{return yield t}catch(r){throw r instanceof Dc&&DPe(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}}),yD.apply(this,arguments)}function DPe({code:n}){return"auth/user-disabled"===n||"auth/user-token-expired"===n}class zPe{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const s=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){var e=this;if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(I(function*(){yield e.iteration()}),r)}iteration(){var t=this;return I(function*(){var e;try{yield t.user.getIdToken(!0)}catch(r){return void("auth/network-request-failed"===(null===(e=r)||void 0===e?void 0:e.code)&&t.schedule(!0))}t.schedule()})()}}class $ee{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sm(this.lastLoginAt),this.creationTime=Sm(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Pm(n){return ED.apply(this,arguments)}function ED(){return ED=I(function*(n){var t;const e=n.auth,r=yield n.getIdToken(),s=yield d6(n,kPe(e,{idToken:r}));st(s?.users.length,e,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=null!==(t=i.providerUserInfo)&&void 0!==t&&t.length?FPe(i.providerUserInfo):[],c=HPe(n.providerData,o),g=!!n.isAnonymous&&!(n.email&&i.passwordHash||c?.length),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new $ee(i.createdAt,i.lastLoginAt),isAnonymous:g};Object.assign(n,m)}),ED.apply(this,arguments)}function MD(){return MD=I(function*(n){const t=Jr(n);yield Pm(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}),MD.apply(this,arguments)}function HPe(n,t){return[...n.filter(r=>!t.some(s=>s.providerId===r.providerId)),...t]}function FPe(n){return n.map(t=>{var{providerId:e}=t,r=r7(t,["providerId"]);return{providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function SD(){return SD=I(function*(n,t){const e=yield Fee(n,{},I(function*(){const r=dg({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=Bee(n,s,"/v1/token",`key=${i}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Hee.fetch()(o,{method:"POST",headers:c,body:r})}));return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}),SD.apply(this,arguments)}class Tm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){st(t.idToken,"internal-error"),st(typeof t.idToken<"u","internal-error"),st(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):function RPe(n){const t=TS(n);return st(t,"internal-error"),st(typeof t.exp<"u","internal-error"),st(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}getToken(t,e=!1){var r=this;return I(function*(){return st(!r.accessToken||r.refreshToken,t,"user-token-expired"),e||!r.accessToken||r.isExpired?r.refreshToken?(yield r.refresh(t,r.refreshToken),r.accessToken):null:r.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(t,e){var r=this;return I(function*(){const{accessToken:s,refreshToken:i,expiresIn:o}=yield function BPe(n,t){return SD.apply(this,arguments)}(t,e);r.updateTokensAndExpiration(s,i,Number(o))})()}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(t,e){const{refreshToken:r,accessToken:s,expirationTime:i}=e,o=new Tm;return r&&(st("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),s&&(st("string"==typeof s,"internal-error",{appName:t}),o.accessToken=s),i&&(st("number"==typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Tm,this.toJSON())}_performRefresh(){return U4("not implemented")}}function a8(n,t){st("string"==typeof n||typeof n>"u","internal-error",{appName:t})}class x5{constructor(t){var{uid:e,auth:r,stsTokenManager:s}=t,i=r7(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new zPe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new $ee(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(t){var e=this;return I(function*(){const r=yield d6(e,e.stsTokenManager.getToken(e.auth,t));return st(r,e.auth,"internal-error"),e.accessToken!==r&&(e.accessToken=r,yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)),r})()}getIdTokenResult(t){return function LPe(n){return vD.apply(this,arguments)}(this,t)}reload(){return function VPe(n){return MD.apply(this,arguments)}(this)}_assign(t){this!==t&&(st(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>Object.assign({},e)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new x5(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){st(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(t,e=!1){var r=this;return I(function*(){let s=!1;t.idToken&&t.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(t),s=!0),e&&(yield Pm(r)),yield r.auth._persistUserIfCurrent(r),s&&r.auth._notifyListenersIfCurrent(r)})()}delete(){var t=this;return I(function*(){const e=yield t.getIdToken();return yield d6(t,function IPe(n,t){return gD.apply(this,arguments)}(t.auth,{idToken:e})),t.stsTokenManager.clearRefreshToken(),t.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var r,s,i,o,c,u,h,g;const m=null!==(r=e.displayName)&&void 0!==r?r:void 0,E=null!==(s=e.email)&&void 0!==s?s:void 0,O=null!==(i=e.phoneNumber)&&void 0!==i?i:void 0,k=null!==(o=e.photoURL)&&void 0!==o?o:void 0,U=null!==(c=e.tenantId)&&void 0!==c?c:void 0,j=null!==(u=e._redirectEventId)&&void 0!==u?u:void 0,oe=null!==(h=e.createdAt)&&void 0!==h?h:void 0,Ee=null!==(g=e.lastLoginAt)&&void 0!==g?g:void 0,{uid:ne,emailVerified:ke,isAnonymous:Ue,providerData:et,stsTokenManager:Bt}=e;st(ne&&Bt,t,"internal-error");const B1=Tm.fromJSON(this.name,Bt);st("string"==typeof ne,t,"internal-error"),a8(m,t.name),a8(E,t.name),st("boolean"==typeof ke,t,"internal-error"),st("boolean"==typeof Ue,t,"internal-error"),a8(O,t.name),a8(k,t.name),a8(U,t.name),a8(j,t.name),a8(oe,t.name),a8(Ee,t.name);const x1=new x5({uid:ne,auth:t,email:E,emailVerified:ke,displayName:m,isAnonymous:Ue,photoURL:k,phoneNumber:O,tenantId:U,stsTokenManager:B1,createdAt:oe,lastLoginAt:Ee});return et&&Array.isArray(et)&&(x1.providerData=et.map(bn=>Object.assign({},bn))),j&&(x1._redirectEventId=j),x1}static _fromIdTokenResponse(t,e,r=!1){return I(function*(){const s=new Tm;s.updateFromServerResponse(e);const i=new x5({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:r});return yield Pm(i),i})()}}const Uee=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return I(function*(){return!0})()}_set(e,r){var s=this;return I(function*(){s.storage[e]=r})()}_get(e){var r=this;return I(function*(){const s=r.storage[e];return void 0===s?null:s})()}_remove(e){var r=this;return I(function*(){delete r.storage[e]})()}_addListener(e,r){}_removeListener(e,r){}}return n.type="NONE",n})();function wS(n,t,e){return`firebase:${n}:${t}:${e}`}class kh{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=wS(this.userKey,s.apiKey,i),this.fullPersistenceKey=wS("persistence",s.apiKey,i),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}getCurrentUser(){var t=this;return I(function*(){const e=yield t.persistence._get(t.fullUserKey);return e?x5._fromJSON(t.auth,e):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(t){var e=this;return I(function*(){if(e.persistence===t)return;const r=yield e.getCurrentUser();return yield e.removeCurrentUser(),e.persistence=t,r?e.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(t,e,r="authUser"){return I(function*(){if(!e.length)return new kh(f6(Uee),t,r);const s=(yield Promise.all(e.map(function(){var h=I(function*(g){if(yield g._isAvailable())return g});return function(g){return h.apply(this,arguments)}}()))).filter(h=>h);let i=s[0]||f6(Uee);const o=wS(r,t.config.apiKey,t.name);let c=null;for(const h of e)try{const g=yield h._get(o);if(g){const m=x5._fromJSON(t,g);h!==i&&(c=m),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return i._shouldAllowMigration&&u.length?(i=u[0],c&&(yield i._set(o,c.toJSON())),yield Promise.all(e.map(function(){var h=I(function*(g){if(g!==i)try{yield g._remove(o)}catch{}});return function(g){return h.apply(this,arguments)}}())),new kh(i,t,r)):new kh(i,t,r)})()}}function Gee(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(jee(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(qee(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Yee(t))return"Blackberry";if(Kee(t))return"Webos";if(PD(t))return"Safari";if((t.includes("chrome/")||Wee(t))&&!t.includes("edge/"))return"Chrome";if(Zee(t))return"Android";{const r=n.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function qee(n=$i()){return/firefox\//i.test(n)}function PD(n=$i()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Wee(n=$i()){return/crios\//i.test(n)}function jee(n=$i()){return/iemobile/i.test(n)}function Zee(n=$i()){return/android/i.test(n)}function Yee(n=$i()){return/blackberry/i.test(n)}function Kee(n=$i()){return/webos/i.test(n)}function OS(n=$i()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Xee(n=$i()){return OS(n)||Zee(n)||Kee(n)||Yee(n)||/windows phone/i.test(n)||jee(n)}function Qee(n,t=[]){let e;switch(n){case"Browser":e=Gee($i());break;case"Worker":e=`${Gee($i())}-${n}`;break;default:e=n}const r=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${qf}/${r}`}class qPe{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=i=>new Promise((o,c)=>{try{o(t(i))}catch(u){c(u)}});r.onAbort=e,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}runMiddleware(t){var e=this;return I(function*(){var r;if(e.auth.currentUser===t)return;const s=[];try{for(const i of e.queue)yield i(t),i.onAbort&&s.push(i.onAbort)}catch(i){s.reverse();for(const o of s)try{o()}catch{}throw e.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=i)||void 0===r?void 0:r.message})}})()}}class WPe{constructor(t,e,r){this.app=t,this.heartbeatServiceProvider=e,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jee(this),this.idTokenSubscription=new Jee(this),this.beforeStateQueue=new qPe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Lee,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(t,e){var r=this;return e&&(this._popupRedirectResolver=f6(e)),this._initializationPromise=this.queue(I(function*(){var s,i;if(!r._deleted&&(r.persistenceManager=yield kh.create(r,t),!r._deleted)){if(null!==(s=r._popupRedirectResolver)&&void 0!==s&&s._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(e),r.lastNotifiedUid=(null===(i=r.currentUser)||void 0===i?void 0:i.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var t=this;return I(function*(){if(t._deleted)return;const e=yield t.assertedPersistence.getCurrentUser();if(t.currentUser||e){if(t.currentUser&&e&&t.currentUser.uid===e.uid)return t._currentUser._assign(e),void(yield t.currentUser.getIdToken());yield t._updateCurrentUser(e,!0)}})()}initializeCurrentUser(t){var e=this;return I(function*(){var r;const s=yield e.assertedPersistence.getCurrentUser();let i=s,o=!1;if(t&&e.config.authDomain){yield e.getOrInitRedirectPersistenceManager();const c=null===(r=e.redirectUser)||void 0===r?void 0:r._redirectEventId,u=i?._redirectEventId,h=yield e.tryRedirectSignIn(t);(!c||c===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return e.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield e.beforeStateQueue.runMiddleware(i)}catch(c){i=s,e._popupRedirectResolver._overrideRedirectResult(e,()=>Promise.reject(c))}return i?e.reloadAndSetCurrentUserOrClear(i):e.directlySetCurrentUser(null)}return st(e._popupRedirectResolver,e,"argument-error"),yield e.getOrInitRedirectPersistenceManager(),e.redirectUser&&e.redirectUser._redirectEventId===i._redirectEventId?e.directlySetCurrentUser(i):e.reloadAndSetCurrentUserOrClear(i)})()}tryRedirectSignIn(t){var e=this;return I(function*(){let r=null;try{r=yield e._popupRedirectResolver._completeRedirectFn(e,t,!0)}catch{yield e._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(t){var e=this;return I(function*(){var r;try{yield Pm(t)}catch(s){if("auth/network-request-failed"!==(null===(r=s)||void 0===r?void 0:r.code))return e.directlySetCurrentUser(null)}return e.directlySetCurrentUser(t)})()}useDeviceLanguage(){this.languageCode=function OPe(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}()}_delete(){var t=this;return I(function*(){t._deleted=!0})()}updateCurrentUser(t){var e=this;return I(function*(){const r=t?Jr(t):null;return r&&st(r.auth.config.apiKey===e.config.apiKey,e,"invalid-user-token"),e._updateCurrentUser(r&&r._clone(e))})()}_updateCurrentUser(t,e=!1){var r=this;return I(function*(){if(!r._deleted)return t&&st(r.tenantId===t.tenantId,r,"tenant-id-mismatch"),e||(yield r.beforeStateQueue.runMiddleware(t)),r.queue(I(function*(){yield r.directlySetCurrentUser(t),r.notifyAuthListeners()}))})()}signOut(){var t=this;return I(function*(){return yield t.beforeStateQueue.runMiddleware(null),(t.redirectPersistenceManager||t._popupRedirectResolver)&&(yield t._setRedirectUser(null)),t._updateCurrentUser(null,!0)})()}setPersistence(t){var e=this;return this.queue(I(function*(){yield e.assertedPersistence.setPersistence(f6(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new R4("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}_setRedirectUser(t,e){var r=this;return I(function*(){const s=yield r.getOrInitRedirectPersistenceManager(e);return null===t?s.removeCurrentUser():s.setCurrentUser(t)})()}getOrInitRedirectPersistenceManager(t){var e=this;return I(function*(){if(!e.redirectPersistenceManager){const r=t&&f6(t)||e._popupRedirectResolver;st(r,e,"argument-error"),e.redirectPersistenceManager=yield kh.create(e,[f6(r._redirectPersistence)],"redirectUser"),e.redirectUser=yield e.redirectPersistenceManager.getCurrentUser()}return e.redirectPersistenceManager})()}_redirectUserForId(t){var e=this;return I(function*(){var r,s;return e._isInitialized&&(yield e.queue(I(function*(){}))),(null===(r=e._currentUser)||void 0===r?void 0:r._redirectEventId)===t?e._currentUser:(null===(s=e.redirectUser)||void 0===s?void 0:s._redirectEventId)===t?e.redirectUser:null})()}_persistUserIfCurrent(t){var e=this;return I(function*(){if(t===e.currentUser)return e.queue(I(function*(){return e.directlySetCurrentUser(t)}))})()}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,s){if(this._deleted)return()=>{};const i="function"==typeof e?e:e.next.bind(e),o=this._isInitialized?Promise.resolve():this._initializationPromise;return st(o,this,"internal-error"),o.then(()=>i(this.currentUser)),"function"==typeof e?t.addObserver(e,r,s):t.addObserver(e)}directlySetCurrentUser(t){var e=this;return I(function*(){e.currentUser&&e.currentUser!==t&&e._currentUser._stopProactiveRefresh(),t&&e.isProactiveRefreshEnabled&&t._startProactiveRefresh(),e.currentUser=t,t?yield e.assertedPersistence.setCurrentUser(t):yield e.assertedPersistence.removeCurrentUser()})()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return st(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Qee(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var t=this;return I(function*(){var e;const r={"X-Client-Version":t.clientVersion};t.app.options.appId&&(r["X-Firebase-gmpid"]=t.app.options.appId);const s=yield null===(e=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();return s&&(r["X-Firebase-Client"]=s),r})()}}function Sa(n){return Jr(n)}class Jee{constructor(t){this.auth=t,this.observer=null,this.addObserver=function Fpe(n,t){const e=new Bpe(n,t);return e.subscribe.bind(e)}(e=>this.observer=e)}get next(){return st(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function ete(n,t,e){const r=Sa(n);st(r._canInitEmulator,r,"emulator-config-failed"),st(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!e?.disableWarnings,i=tte(t),{host:o,port:c}=function jPe(n){const t=tte(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:nte(r.substr(i.length+1))}}{const[i,o]=r.split(":");return{host:i,port:nte(o)}}}(t);r.config.emulator={url:`${i}//${o}${null===c?"":`:${c}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function ZPe(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",n):n())}()}function tte(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function nte(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}class TD{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return U4("not implemented")}_getIdTokenResponse(t){return U4("not implemented")}_linkToIdToken(t,e){return U4("not implemented")}_getReauthenticationResolver(t){return U4("not implemented")}}function OD(){return OD=I(function*(n,t){return Zi(n,"POST","/v1/accounts:update",t)}),OD.apply(this,arguments)}function AD(){return AD=I(function*(n,t){return h6(n,"POST","/v1/accounts:signInWithPassword",mi(n,t))}),AD.apply(this,arguments)}function bS(n,t){return ND.apply(this,arguments)}function ND(){return ND=I(function*(n,t){return Zi(n,"POST","/v1/accounts:sendOobCode",mi(n,t))}),ND.apply(this,arguments)}function XPe(n,t){return ID.apply(this,arguments)}function ID(){return ID=I(function*(n,t){return bS(n,t)}),ID.apply(this,arguments)}function QPe(n,t){return xD.apply(this,arguments)}function xD(){return xD=I(function*(n,t){return bS(n,t)}),xD.apply(this,arguments)}function RD(){return RD=I(function*(n,t){return h6(n,"POST","/v1/accounts:signInWithEmailLink",mi(n,t))}),RD.apply(this,arguments)}function DD(){return DD=I(function*(n,t){return h6(n,"POST","/v1/accounts:signInWithEmailLink",mi(n,t))}),DD.apply(this,arguments)}class wm extends TD{constructor(t,e,r,s=null){super("password",r),this._email=t,this._password=e,this._tenantId=s}static _fromEmailAndPassword(t,e){return new wm(t,e,"password")}static _fromEmailAndCode(t,e,r=null){return new wm(t,e,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if(e?.email&&e?.password){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}_getIdTokenResponse(t){var e=this;return I(function*(){switch(e.signInMethod){case"password":return function KPe(n,t){return AD.apply(this,arguments)}(t,{returnSecureToken:!0,email:e._email,password:e._password});case"emailLink":return function tTe(n,t){return RD.apply(this,arguments)}(t,{email:e._email,oobCode:e._password});default:Ma(t,"internal-error")}})()}_linkToIdToken(t,e){var r=this;return I(function*(){switch(r.signInMethod){case"password":return function ste(n,t){return OD.apply(this,arguments)}(t,{idToken:e,returnSecureToken:!0,email:r._email,password:r._password});case"emailLink":return function nTe(n,t){return DD.apply(this,arguments)}(t,{idToken:e,email:r._email,oobCode:r._password});default:Ma(t,"internal-error")}})()}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}function p6(n,t){return zD.apply(this,arguments)}function zD(){return zD=I(function*(n,t){return h6(n,"POST","/v1/accounts:signInWithIdp",mi(n,t))}),zD.apply(this,arguments)}class Lh extends TD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Lh(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Ma("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:r,signInMethod:s}=e,i=r7(e,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Lh(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(t){return p6(t,this.buildRequest())}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,p6(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,p6(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=dg(e)}return t}}class bm{constructor(t){var e,r,s,i,o,c;const u=pg(gg(t)),h=null!==(e=u.apiKey)&&void 0!==e?e:null,g=null!==(r=u.oobCode)&&void 0!==r?r:null,m=function lTe(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(s=u.mode)&&void 0!==s?s:null);st(h&&g&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=g,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(c=u.tenantId)&&void 0!==c?c:null}static parseLink(t){const e=function uTe(n){const t=pg(gg(n)).link,e=t?pg(gg(t)).deep_link_id:null,r=pg(gg(n)).deep_link_id;return(r?pg(gg(r)).link:null)||r||e||t||n}(t);try{return new bm(e)}catch{return null}}}let ite=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(e,r){return wm._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const s=bm.parseLink(r);return st(s,"argument-error"),wm._fromEmailAndCode(e,s.code,s.tenantId)}}return n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink",n})();class c8{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class ote extends c8{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}let fTe=(()=>{class n extends ote{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Lh._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:s}=e;if(!r&&!s)return null;try{return n.credential(r,s)}catch{return null}}}return n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com",n})();function ate(n,t){return UD.apply(this,arguments)}function UD(){return UD=I(function*(n,t){return h6(n,"POST","/v1/accounts:signUp",mi(n,t))}),UD.apply(this,arguments)}class zc{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static _fromIdTokenResponse(t,e,r,s=!1){return I(function*(){const i=yield x5._fromIdTokenResponse(t,r,s),o=cte(r);return new zc({user:i,providerId:o,_tokenResponse:r,operationType:e})})()}static _forOperation(t,e,r){return I(function*(){yield t._updateTokensIfNecessary(r,!0);const s=cte(r);return new zc({user:t,providerId:s,_tokenResponse:r,operationType:e})})()}}function cte(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class NS extends Dc{constructor(t,e,r,s){var i;super(e.code,e.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,NS.prototype),this.customData={appName:t.name,tenantId:null!==(i=t.tenantId)&&void 0!==i?i:void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,s){return new NS(t,e,r,s)}}function lte(n,t,e,r){return("reauthenticate"===t?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(i=>{throw"auth/multi-factor-auth-required"===i.code?NS._fromErrorAndOperation(n,i,t,r):i})}function WD(n,t){return jD.apply(this,arguments)}function jD(){return jD=I(function*(n,t,e=!1){const r=yield d6(n,t._linkToIdToken(n.auth,yield n.getIdToken()),e);return zc._forOperation(n,"link",r)}),jD.apply(this,arguments)}function YD(){return YD=I(function*(n,t,e=!1){var r;const{auth:s}=n,i="reauthenticate";try{const o=yield d6(n,lte(s,i,t,n),e);st(o.idToken,s,"internal-error");const c=TS(o.idToken);st(c,s,"internal-error");const{sub:u}=c;return st(n.uid===u,s,"user-mismatch"),zc._forOperation(n,i,o)}catch(o){throw"auth/user-not-found"===(null===(r=o)||void 0===r?void 0:r.code)&&Ma(s,"user-mismatch"),o}}),YD.apply(this,arguments)}function hte(n,t){return KD.apply(this,arguments)}function KD(){return KD=I(function*(n,t,e=!1){const r="signIn",s=yield lte(n,r,t),i=yield zc._fromIdTokenResponse(n,r,s);return e||(yield n._updateCurrentUser(i.user)),i}),KD.apply(this,arguments)}function QD(){return QD=I(function*(n,t){return hte(Sa(n),t)}),QD.apply(this,arguments)}function xS(n,t,e){var r;st((null===(r=e.url)||void 0===r?void 0:r.length)>0,n,"invalid-continue-uri"),st(typeof e.dynamicLinkDomain>"u"||e.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),t.continueUrl=e.url,t.dynamicLinkDomain=e.dynamicLinkDomain,t.canHandleCodeInApp=e.handleCodeInApp,e.iOS&&(st(e.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),t.iOSBundleId=e.iOS.bundleId),e.android&&(st(e.android.packageName.length>0,n,"missing-android-pkg-name"),t.androidInstallApp=e.android.installApp,t.androidMinimumVersionCode=e.android.minimumVersion,t.androidPackageName=e.android.packageName)}function _Te(n,t,e){return iz.apply(this,arguments)}function iz(){return iz=I(function*(n,t,e){const r=Jr(n),s={requestType:"PASSWORD_RESET",email:t};e&&xS(r,s,e),yield QPe(r,s)}),iz.apply(this,arguments)}function CTe(n,t,e){return uz.apply(this,arguments)}function uz(){return uz=I(function*(n,t,e){const r=Sa(n),s=yield ate(r,{returnSecureToken:!0,email:t,password:e}),i=yield zc._fromIdTokenResponse(r,"signIn",s);return yield r._updateCurrentUser(i.user),i}),uz.apply(this,arguments)}function yTe(n,t,e){return function XD(n,t){return QD.apply(this,arguments)}(Jr(n),ite.credential(t,e))}function MTe(n,t){return gz.apply(this,arguments)}function gz(){return gz=I(function*(n,t){const e=Jr(n),s={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};t&&xS(e.auth,s,t);const{email:i}=yield XPe(e.auth,s);i!==n.email&&(yield n.reload())}),gz.apply(this,arguments)}function STe(n,t){return _z.apply(this,arguments)}function _z(){return _z=I(function*(n,t){return Zi(n,"POST","/v1/accounts:update",t)}),_z.apply(this,arguments)}function PTe(n,t){return vz.apply(this,arguments)}function vz(){return vz=I(function*(n,{displayName:t,photoURL:e}){if(void 0===t&&void 0===e)return;const r=Jr(n),i={idToken:yield r.getIdToken(),displayName:t,photoUrl:e,returnSecureToken:!0},o=yield d6(r,STe(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>"password"===u);c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),yield r._updateTokensIfNecessary(o)}),vz.apply(this,arguments)}function xTe(n,t,e,r){return Jr(n).onAuthStateChanged(t,e,r)}const kS="__sak";class pte{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(kS,"1"),this.storage.removeItem(kS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const HTe=(()=>{class n extends pte{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function DTe(){const n=$i();return PD(n)||OS(n)}()&&function GPe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Xee(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const s=this.storage.getItem(r),i=this.localCache[r];s!==i&&e(r,i,s)}}onStorageEvent(e,r=!1){if(!e.key)return void this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});const s=e.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const c=this.storage.getItem(s);if(e.newValue!==c)null!==e.newValue?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!r)return}const i=()=>{const c=this.storage.getItem(s);!r&&this.localCache[s]===c||this.notifyListeners(s,c)},o=this.storage.getItem(s);!function UPe(){return function bpe(){const n=$i();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:s}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,r){var s=()=>super._set,i=this;return I(function*(){yield s().call(i,e,r),i.localCache[e]=JSON.stringify(r)})()}_get(e){var r=()=>super._get,s=this;return I(function*(){const i=yield r().call(s,e);return s.localCache[e]=JSON.stringify(i),i})()}_remove(e){var r=()=>super._remove,s=this;return I(function*(){yield r().call(s,e),delete s.localCache[e]})()}}return n.type="LOCAL",n})(),gte=(()=>{class n extends pte{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}return n.type="SESSION",n})();let BTe=(()=>{class n{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const s=new n(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}handleEvent(e){var r=this;return I(function*(){const s=e,{eventId:i,eventType:o,data:c}=s.data,u=r.handlersMap[o];if(!u?.size)return;s.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const h=Array.from(u).map(function(){var m=I(function*(E){return E(s.origin,c)});return function(E){return m.apply(this,arguments)}}()),g=yield function FTe(n){return Promise.all(n.map(function(){var t=I(function*(e){try{return{fulfilled:!0,value:yield e}}catch(r){return{fulfilled:!1,reason:r}}});return function(e){return t.apply(this,arguments)}}()))}(h);s.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})})()}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return n.receivers=[],n})();function LS(n="",t=10){let e="";for(let r=0;r<t;r++)e+=Math.floor(10*Math.random());return n+e}class $Te{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}_send(t,e,r=50){var s=this;return I(function*(){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const g=LS("",20);i.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:i,onMessage(E){const O=E;if(O.data.eventId===g)switch(O.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(O.data.response);break;default:clearTimeout(m),clearTimeout(o),h(new Error("invalid_response"))}}},s.handlers.add(c),i.port1.addEventListener("message",c.onMessage),s.target.postMessage({eventType:t,eventId:g,data:e},[i.port2])}).finally(()=>{c&&s.removeMessageHandler(c)})})()}}function _i(){return window}function Tz(){return typeof _i().WorkerGlobalScope<"u"&&"function"==typeof _i().importScripts}function wz(){return(wz=I(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const mte="firebaseLocalStorageDb",RS="firebaseLocalStorage",_te="fbase_key";class Nm{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function DS(n,t){return n.transaction([RS],t?"readwrite":"readonly").objectStore(RS)}function Oz(){const n=indexedDB.open(mte,1);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(RS,{keyPath:_te})}catch(s){e(s)}}),n.addEventListener("success",I(function*(){const r=n.result;r.objectStoreNames.contains(RS)?t(r):(r.close(),yield function ZTe(){const n=indexedDB.deleteDatabase(mte);return new Nm(n).toPromise()}(),t(yield Oz()))}))})}function vte(n,t,e){return bz.apply(this,arguments)}function bz(){return bz=I(function*(n,t,e){const r=DS(n,!0).put({[_te]:t,value:e});return new Nm(r).toPromise()}),bz.apply(this,arguments)}function Az(){return Az=I(function*(n,t){const e=DS(n,!1).get(t),r=yield new Nm(e).toPromise();return void 0===r?null:r.value}),Az.apply(this,arguments)}function Cte(n,t){const e=DS(n,!0).delete(t);return new Nm(e).toPromise()}const QTe=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return I(function*(){return e.db||(e.db=yield Oz()),e.db})()}_withRetries(e){var r=this;return I(function*(){let s=0;for(;;)try{const i=yield r._openDb();return yield e(i)}catch(i){if(s++>3)throw i;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return I(function*(){return Tz()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return I(function*(){e.receiver=BTe._getInstance(function WTe(){return Tz()?self:null}()),e.receiver._subscribe("keyChanged",function(){var r=I(function*(s,i){return{keyProcessed:(yield e._poll()).includes(i.key)}});return function(s,i){return r.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var r=I(function*(s,i){return["keyChanged"]});return function(s,i){return r.apply(this,arguments)}}())})()}initializeSender(){var e=this;return I(function*(){var r,s;if(e.activeServiceWorker=yield function GTe(){return wz.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new $Te(e.activeServiceWorker);const i=yield e.sender._send("ping",{},800);!i||(null===(r=i[0])||void 0===r?void 0:r.fulfilled)&&(null===(s=i[0])||void 0===s?void 0:s.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var r=this;return I(function*(){if(r.sender&&r.activeServiceWorker&&function qTe(){var n;return(null===(n=navigator?.serviceWorker)||void 0===n?void 0:n.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:e},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return I(function*(){try{if(!indexedDB)return!1;const e=yield Oz();return yield vte(e,kS,"1"),yield Cte(e,kS),!0}catch{}return!1})()}_withPendingWrite(e){var r=this;return I(function*(){r.pendingWrites++;try{yield e()}finally{r.pendingWrites--}})()}_set(e,r){var s=this;return I(function*(){return s._withPendingWrite(I(function*(){return yield s._withRetries(i=>vte(i,e,r)),s.localCache[e]=r,s.notifyServiceWorker(e)}))})()}_get(e){var r=this;return I(function*(){const s=yield r._withRetries(i=>function YTe(n,t){return Az.apply(this,arguments)}(i,e));return r.localCache[e]=s,s})()}_remove(e){var r=this;return I(function*(){return r._withPendingWrite(I(function*(){return yield r._withRetries(s=>Cte(s,e)),delete r.localCache[e],r.notifyServiceWorker(e)}))})()}_poll(){var e=this;return I(function*(){const r=yield e._withRetries(o=>{const c=DS(o,!1).getAll();return new Nm(c).toPromise()});if(!r)return[];if(0!==e.pendingWrites)return[];const s=[],i=new Set;for(const{fbase_key:o,value:c}of r)i.add(o),JSON.stringify(e.localCache[o])!==JSON.stringify(c)&&(e.notifyListeners(o,c),s.push(o));for(const o of Object.keys(e.localCache))e.localCache[o]&&!i.has(o)&&(e.notifyListeners(o,null),s.push(o));return s})()}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(I(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return n.type="LOCAL",n})();function Ete(n){return`__${n}${Math.floor(1e6*Math.random())}`}function L5(n,t){return t?f6(t):(st(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}Ete("rcb"),new Em(3e4,6e4);class Hz extends TD{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return p6(t,this._buildIdpRequest())}_linkToIdToken(t,e){return p6(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return p6(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function gwe(n){return hte(n.auth,new Hz(n),n.bypassAuthState)}function mwe(n){const{auth:t,user:e}=n;return st(e,t,"internal-error"),function fte(n,t){return YD.apply(this,arguments)}(e,new Hz(n),n.bypassAuthState)}function _we(n){return Fz.apply(this,arguments)}function Fz(){return Fz=I(function*(n){const{auth:t,user:e}=n;return st(e,t,"internal-error"),WD(e,new Hz(n),n.bypassAuthState)}),Fz.apply(this,arguments)}class Ste{constructor(t,e,r,s,i=!1){this.auth=t,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){var t=this;return new Promise(function(){var e=I(function*(r,s){t.pendingPromise={resolve:r,reject:s};try{t.eventManager=yield t.resolver._initialize(t.auth),yield t.onExecution(),t.eventManager.registerConsumer(t)}catch(i){t.reject(i)}});return function(r,s){return e.apply(this,arguments)}}())}onAuthEvent(t){var e=this;return I(function*(){const{urlResponse:r,sessionId:s,postBody:i,tenantId:o,error:c,type:u}=t;if(c)return void e.reject(c);const h={auth:e.auth,requestUri:r,sessionId:s,tenantId:o||void 0,postBody:i||void 0,user:e.user,bypassAuthState:e.bypassAuthState};try{e.resolve(yield e.getIdpTask(u)(h))}catch(g){e.reject(g)}})()}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return gwe;case"linkViaPopup":case"linkViaRedirect":return _we;case"reauthViaPopup":case"reauthViaRedirect":return mwe;default:Ma(this.auth,"internal-error")}}resolve(t){u6(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){u6(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const vwe=new Em(2e3,1e4);function Cwe(n,t,e){return Bz.apply(this,arguments)}function Bz(){return Bz=I(function*(n,t,e){const r=Sa(n);xh(n,t,c8);const s=L5(r,e);return new Gz(r,"signInViaPopup",t,s).executeNotNull()}),Bz.apply(this,arguments)}let Gz=(()=>{class n extends Ste{constructor(e,r,s,i,o){super(e,r,i,o),this.provider=s,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){var e=this;return I(function*(){const r=yield e.execute();return st(r,e.auth,"internal-error"),r})()}onExecution(){var e=this;return I(function*(){u6(1===e.filter.length,"Popup operations only handle one event");const r=LS();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],r),e.authWindow.associatedEvent=r,e.resolver._originValidation(e.auth).catch(s=>{e.reject(s)}),e.resolver._isIframeWebStorageSupported(e.auth,s=>{s||e.reject(rc(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(rc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,s;this.pollId=null!==(s=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==s&&s.closed?window.setTimeout(()=>{this.pollId=null,this.reject(rc(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(e,vwe.get())};e()}}return n.currentPopupAction=null,n})();const Im=new Map;class Ewe extends Ste{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}execute(){var t=()=>super.execute,e=this;return I(function*(){let r=Im.get(e.auth._key());if(!r){try{const i=(yield function Mwe(n,t){return qz.apply(this,arguments)}(e.resolver,e.auth))?yield t().call(e):null;r=()=>Promise.resolve(i)}catch(s){r=()=>Promise.reject(s)}Im.set(e.auth._key(),r)}return e.bypassAuthState||Im.set(e.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(t){var e=()=>super.onAuthEvent,r=this;return I(function*(){if("signInViaRedirect"===t.type)return e().call(r,t);if("unknown"!==t.type){if(t.eventId){const s=yield r.auth._redirectUserForId(t.eventId);if(s)return r.user=s,e().call(r,t);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return I(function*(){})()}cleanUp(){}}function qz(){return qz=I(function*(n,t){const e=Tte(t),r=Pte(n);if(!(yield r._isAvailable()))return!1;const s="true"===(yield r._get(e));return yield r._remove(e),s}),qz.apply(this,arguments)}function Swe(n,t){Im.set(n._key(),t)}function Pte(n){return f6(n._redirectPersistence)}function Tte(n){return wS("pendingRedirect",n.config.apiKey,n.name)}function wte(n,t){return Qz.apply(this,arguments)}function Qz(){return Qz=I(function*(n,t,e=!1){const r=Sa(n),s=L5(r,t),o=yield new Ewe(r,s,e).execute();return o&&!e&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,t)),o}),Qz.apply(this,arguments)}class bwe{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function Awe(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ate(n);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var r;if(t.error&&!Ate(t)){const s=(null===(r=t.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";e.onError(rc(this.auth,s))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(bte(t))}saveEventToCache(t){this.cachedEventUids.add(bte(t)),this.lastProcessedEventTime=Date.now()}}function bte(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function Ate({type:n,error:t}){return"unknown"===n&&"auth/no-auth-event"===t?.code}function Nwe(n){return eV.apply(this,arguments)}function eV(){return eV=I(function*(n,t={}){return Zi(n,"GET","/v1/projects",t)}),eV.apply(this,arguments)}const Iwe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xwe=/^https?/;function tV(){return tV=I(function*(n){if(n.config.emulator)return;const{authorizedDomains:t}=yield Nwe(n);for(const e of t)try{if(Lwe(e))return}catch{}Ma(n,"unauthorized-domain")}),tV.apply(this,arguments)}function Lwe(n){const t=ym(),{protocol:e,hostname:r}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return""===o.hostname&&""===r?"chrome-extension:"===e&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===e&&o.hostname===r}if(!xwe.test(e))return!1;if(Iwe.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const Rwe=new Em(3e4,6e4);function Nte(){const n=_i().___jsl;if(n?.H)for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}let VS=null;function zwe(n){return VS=VS||function Dwe(n){return new Promise((t,e)=>{var r,s,i;function o(){Nte(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Nte(),e(rc(n,"network-request-failed"))},timeout:Rwe.get()})}if(null!==(s=null===(r=_i().gapi)||void 0===r?void 0:r.iframes)&&void 0!==s&&s.Iframe)t(gapi.iframes.getContext());else{if(null===(i=_i().gapi)||void 0===i||!i.load){const c=Ete("iframefcb");return _i()[c]=()=>{gapi.load?o():e(rc(n,"network-request-failed"))},function yte(n){return new Promise((t,e)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=t,r.onerror=s=>{const i=rc("internal-error");i.customData=s,e(i)},r.type="text/javascript",r.charset="UTF-8",function nwe(){var n,t;return null!==(t=null===(n=document.getElementsByTagName("head"))||void 0===n?void 0:n[0])&&void 0!==t?t:document}().appendChild(r)})}(`https://apis.google.com/js/api.js?onload=${c}`).catch(u=>e(u))}o()}}).catch(t=>{throw VS=null,t})}(n),VS}const Vwe=new Em(5e3,15e3),Bwe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$we=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Uwe(n){const t=n.config;st(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?fD(t,"emulator/auth/iframe"):`https://${n.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:n.name,v:qf},s=$we.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${e}?${dg(r).slice(1)}`}function nV(){return nV=I(function*(n){const t=yield zwe(n),e=_i().gapi;return st(e,n,"internal-error"),t.open({where:document.body,url:Uwe(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Bwe,dontclear:!0},r=>new Promise(function(){var s=I(function*(i,o){yield r.restyle({setHideOnLeave:!1});const c=rc(n,"network-request-failed"),u=_i().setTimeout(()=>{o(c)},Vwe.get());function h(){_i().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(c)})});return function(i,o){return s.apply(this,arguments)}}()))}),nV.apply(this,arguments)}const qwe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Ite{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function xte(n,t,e,r,s,i){st(n.config.authDomain,n,"auth-domain-config-required"),st(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:r,v:qf,eventId:s};if(t instanceof c8){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",function Hpe(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,h]of Object.entries(i||{}))o[u]=h}if(t instanceof ote){const u=t.getScopes().filter(h=>""!==h);u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const u of Object.keys(c))void 0===c[u]&&delete c[u];return`${function eOe({config:n}){return n.emulator?fD(n,"emulator/auth/handler"):`https://${n.authDomain}/__/auth/handler`}(n)}?${dg(c).slice(1)}`}const rV="webStorageSupport",nOe=class tOe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gte,this._completeRedirectFn=wte,this._overrideRedirectResult=Swe}_openPopup(t,e,r,s){var i=this;return I(function*(){var o;u6(null===(o=i.eventManagers[t._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const c=xte(t,e,r,ym(),s);return function Kwe(n,t,e,r=500,s=600){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},qwe),{width:r.toString(),height:s.toString(),top:i,left:o}),h=$i().toLowerCase();e&&(c=Wee(h)?"_blank":e),qee(h)&&(t=t||"http://localhost",u.scrollbars="yes");const g=Object.entries(u).reduce((E,[O,k])=>`${E}${O}=${k},`,"");if(function $Pe(n=$i()){var t;return OS(n)&&!(null===(t=window.navigator)||void 0===t||!t.standalone)}(h)&&"_self"!==c)return function Xwe(n,t){const e=document.createElement("a");e.href=n,e.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}(t||"",c),new Ite(null);const m=window.open(t||"",c,g);st(m,n,"popup-blocked");try{m.focus()}catch{}return new Ite(m)}(t,c,LS())})()}_openRedirect(t,e,r,s){var i=this;return I(function*(){return yield i._originValidation(t),function UTe(n){_i().location.href=n}(xte(t,e,r,ym(),s)),new Promise(()=>{})})()}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:i}=this.eventManagers[e];return s?Promise.resolve(s):(u6(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}initAndGetManager(t){var e=this;return I(function*(){const r=yield function Gwe(n){return nV.apply(this,arguments)}(t),s=new bwe(t);return r.register("authEvent",i=>(st(i?.authEvent,t,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),e.eventManagers[t._key()]={manager:s},e.iframes[t._key()]=r,s})()}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(rV,{type:rV},s=>{var i;const o=null===(i=s?.[0])||void 0===i?void 0:i[rV];void 0!==o&&e(!!o),Ma(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function kwe(n){return tV.apply(this,arguments)}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Xee()||PD()||OS()}};var Lte="@firebase/auth";class rOe{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}getToken(t){var e=this;return I(function*(){return e.assertAuthConfigured(),yield e.auth._initializationPromise,e.auth.currentUser?{accessToken:yield e.auth.currentUser.getIdToken(t)}:null})()}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(r=>{var s;t((null===(s=r)||void 0===s?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);!e||(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){st(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const aOe=RZ("authIdTokenMaxAge")||300;let Dte=null;const cOe=n=>function(){var t=I(function*(e){const r=e&&(yield e.getIdTokenResult()),s=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(s&&s>aOe)return;const i=r?.token;Dte!==i&&(Dte=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});return function(e){return t.apply(this,arguments)}}();function lOe(n=uI()){const t=Gf(n,"auth");if(t.isInitialized())return t.getImmediate();const e=function PPe(n,t){const e=Gf(n,"auth");if(e.isInitialized()){const s=e.getImmediate();if(jE(e.getOptions(),t??{}))return s;Ma(s,"already-initialized")}return e.initialize({options:t})}(n,{popupRedirectResolver:nOe,persistence:[QTe,HTe,gte]}),r=RZ("authTokenSyncURL");if(r){const i=cOe(r);(function ITe(n,t,e){Jr(n).beforeAuthStateChanged(t,e)})(e,i,()=>i(e.currentUser)),function NTe(n,t,e,r){Jr(n).onIdTokenChanged(t,e,r)}(e,o=>i(o))}const s=LZ("auth");return s&&ete(e,`http://${s}`),e}!function iOe(n){Vo(new no("auth",(t,{options:e})=>{const r=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),{apiKey:i,authDomain:o}=r.options;return((c,u)=>{st(i&&!i.includes(":"),"invalid-api-key",{appName:c.name}),st(!o?.includes(":"),"argument-error",{appName:c.name});const h={apiKey:i,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qee(n)},g=new WPe(c,u,h);return function TPe(n,t){const e=t?.persistence||[],r=(Array.isArray(e)?e:[e]).map(f6);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(r,t?.popupRedirectResolver)}(g,e),g})(r,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,r)=>{t.getProvider("auth-internal").initialize()})),Vo(new no("auth-internal",t=>{const e=Sa(t.getProvider("auth").getImmediate());return new rOe(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),fs(Lte,"0.20.11",function sOe(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(n)),fs(Lte,"0.20.11","esm2017")}("Browser");class HS{constructor(t){return t}}class Vte{constructor(){return FR("auth")}}const sV=new Dt("angularfire2.auth-instances");function fOe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new HS(r)}}const hOe={provide:Vte,deps:[[new ui,sV]]},dOe={provide:HS,useFactory:function uOe(n,t){const e=HR("auth",n,t);return e&&new HS(e)},deps:[[new ui,sV],Nh]};let pOe=(()=>{class n{constructor(){fs("angularfire",_S.full,"auth")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[dOe,hOe]}),n})();const _Oe=br(CTe,!0),vOe=br(lOe,!0),COe=br(xTe,!0),yOe=br(MTe,!0),EOe=br(_Te,!0),MOe=br(yTe,!0),SOe=br(Cwe,!0),POe=br(PTe,!0);class l8{constructor(t){return t}}const iV=new Dt("angularfire2.firestore-instances");function OOe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new l8(r)}}const bOe={provide:class TOe{constructor(){return FR("firestore")}},deps:[[new ui,iV]]},AOe={provide:l8,useFactory:function wOe(n,t){const e=HR("firestore",n,t);return e&&new l8(e)},deps:[[new ui,iV],Nh]};let NOe=(()=>{class n{constructor(){fs("angularfire",_S.full,"fst")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[AOe,bOe]}),n})();const xOe=br(Nye,!0),kOe=br(WCe,!0),ROe=br(Aye,!0),xm=br(zQ,!0),DOe=br(Tye,!0),zOe=br(wye,!0),VOe=br(cye,!0),HOe=br(Mye,!0),Fte=br(Iye,!0),FOe=br(Eye,!0),FS=br(_ye,!0),BOe=br(Oye,!0),$Oe=br(bye,!0),UOe=br(Cye,!0);let km=(()=>{class n{constructor(e,r){this.collectionName=e,this.firestore=r,this.subDAOs={};this.collection=kOe(r,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var r=this;return I(function*(){return J(n.VERBOSE,{called:r.collectionName+".create",newElement:e}),(yield xOe(r.collection,e)).id})()}read(e){var r=this;return I(function*(){J(n.VERBOSE,{called:r.collectionName+".read",id:e});const s=yield DOe(xm(r.collection,e));return s.exists()?y.of(ge.getNonNullable(s.data())):y.empty()})()}exists(e){var r=this;return I(function*(){return J(n.VERBOSE,{called:r.collectionName+".exists",id:e}),(yield r.read(e)).isPresent()})()}update(e,r){var s=this;return I(function*(){return J(n.VERBOSE,{called:s.collectionName+".update",id:e,update:r}),$Oe(xm(s.collection,e),r)})()}delete(e){return J(n.VERBOSE,{called:this.collectionName+".delete",id:e}),ROe(xm(this.collection,e))}set(e,r){return J(n.VERBOSE,{called:this.collectionName+".set",id:e,element:r}),BOe(xm(this.collection,e),r)}subscribeToChanges(e,r){return new k1(Fte(xm(this.collection,e),s=>{r(y.ofNullable(s.data()))}))}findWhere(e,r,s){var i=this;return I(function*(){const o=i.constructQuery(e,r,s);return(yield zOe(o)).docs.map(u=>({id:u.id,data:u.data()}))})()}observingWhere(e,r,s){J(n.VERBOSE,{called:this.collectionName+".observingWhere"});const i=this.constructQuery(e,s);return new k1(Fte(i,o=>{const c=[],u=[],h=[];o.docChanges().forEach(g=>{const m={id:g.doc.id,data:g.doc.data()};switch(g.type){case"added":c.push(m);break;case"modified":u.push(m);break;case"removed":h.push(m)}}),c.length>0&&(J(n.VERBOSE,"firebase gave us "+c.length+" NEW "+this.collectionName),r.onDocumentCreated(c)),u.length>0&&(J(n.VERBOSE,"firebase gave us "+u.length+" MODIFIED "+this.collectionName),r.onDocumentModified(u)),h.length>0&&(J(n.VERBOSE,"firebase gave us "+h.length+" DELETED "+this.collectionName),r.onDocumentDeleted(h))}))}constructQuery(e,r,s){let i=FS(this.collection);null!=r&&(i=FS(i,FOe(r))),null!=s&&(i=FS(i,HOe(s)));for(const o of e)i=FS(i,UOe(o[0],o[1],o[2]));return i}subCollectionDAO(e,r){const s=`${this.collection.path}/${e}/${r}`;if(s in this.subDAOs)return this.subDAOs[s];{const i=new class extends n{constructor(o){super(s,o)}}(this.firestore);return this.subDAOs[s]=i,i}}}return n.VERBOSE=!1,n})(),GOe=(()=>{class n extends km{constructor(e){super("errors",e)}}return n.\u0275fac=function(e){return new(e||n)(ze(l8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var qOe=_c(2486);let _n=(()=>{class n{infoMessage(e){this.message(e,"is-info")}gameMessage(e){this.message(e,"is-warning")}criticalMessage(e){this.message(e,"is-danger")}message(e,r){(0,qOe.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:r,dismissible:!0})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ns{constructor(t,e,r){this.errorDAO=t,this.router=e,this.messageDisplayer=r,Ns.setSingletonInstance(this)}static setSingletonInstance(t){Ns.singleton=y.of(t)}static logErrorAndFail(t,e,r){throw Ns.logError(t,e,r),new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`)}static logError(t,e,r){if(this.singleton.isAbsent())throw new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`);return this.singleton.get().logError(t,e,r),R.failure(t+": "+e)}findErrors(t,e,r,s){return this.errorDAO.findWhere(void 0===s?[["component","==",t],["route","==",e],["message","==",r]]:[["component","==",t],["route","==",e],["message","==",r],["data","==",s]])}logError(t,e,r){var s=this;return I(function*(){s.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const i=s.router.url,o=yield s.findErrors(t,i,e,r);if(0===o.length){const c={component:t,route:i,message:e,firstEncounter:$4(),lastEncounter:$4(),occurences:1};null!=r&&(c.data=r),yield s.errorDAO.create(c)}else{const c=o[0].id,u=o[0].data;yield s.errorDAO.update(c,{lastEncounter:$4(),occurences:u.occurences+1})}})()}}Ns.singleton=y.empty(),Ns.\u0275fac=function(t){return new(t||Ns)(ze(GOe),ze(Xn),ze(_n))},Ns.\u0275prov=nt({token:Ns,factory:Ns.\u0275fac,providedIn:"root"});class ge{static expectToBe(t,e,r){if(t!==e)throw void 0!==r?new Error(r):new Error(`A default switch case did not observe the correct value, expected ${e}, but got ${t} instead.`)}static expectToBeMultiple(t,e){let r=!1;for(const s of e)if(t===s){r=!0;break}if(!1===r)throw new Error(`A default switch case did not observe the correct value, expected a value among ${e}, but got ${t} instead.`)}static getNonNullable(t){if(null==t)throw new Error("Expected value not to be null or undefined, but it was.");return t}static assert(t,e){if(!1===t)throw Ns.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}static identity(t){return t}}function J(n,t){n&&console.log(t)}let jOe=(()=>{class n extends km{constructor(e){super("chats",e),J(n.VERBOSE,"ChatDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(ze(l8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Bte=(()=>{class n{}return n.CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`,n.FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`,n})(),BS=(()=>{class n{constructor(e){this.chatDAO=e,J(n.VERBOSE,"ChatService.constructor")}addMessage(e,r){var s=this;return I(function*(){return s.chatDAO.subCollectionDAO(e,"messages").create(r)})()}getLastMessages(e,r){var s=this;return I(function*(){return s.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",r)})()}subscribeToMessages(e,r){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],r,"postedTime")}deleteChat(e){var r=this;return I(function*(){return J(n.VERBOSE,"ChatService.deleteChat "+e),r.chatDAO.delete(e)})()}createNewChat(e){var r=this;return I(function*(){return r.chatDAO.set(e,{})})()}sendMessage(e,r,s,i){var o=this;return I(function*(){if(!1===o.userCanSendMessage(r.name,e))return R.failure(Bte.CANNOT_SEND_MESSAGE());if(o.isForbiddenMessage(s))return R.failure(Bte.FORBIDDEN_MESSAGE());const c={content:s,sender:r,postedTime:$4(),currentTurn:i};return yield o.addMessage(e,c),R.SUCCESS})()}userCanSendMessage(e,r){return""!==e}isForbiddenMessage(e){return""===e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(ze(jOe))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function We(n,t,e){if(!1===n)throw void 0!==e&&console.log(e),Ns.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}let oV=(()=>{class n extends km{constructor(e){super(n.COLLECTION_NAME,e),J(n.VERBOSE,"UserDAO.constructor")}}return n.VERBOSE=!1,n.COLLECTION_NAME="users",n.\u0275fac=function(e){return new(e||n)(ze(l8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Rh=(()=>{class n{constructor(e){this.userDAO=e}usernameIsAvailable(e){var r=this;return I(function*(){return 0===(yield r.userDAO.findWhere([["username","==",e]])).length})()}setUsername(e,r){var s=this;return I(function*(){yield s.userDAO.update(e,{username:r})})()}markAsVerified(e){var r=this;return I(function*(){yield r.userDAO.update(e,{verified:!0})})()}observeUserOnServer(e,r){return this.userDAO.subscribeToChanges(e,s=>{s.isPresent()&&null===s.get().lastUpdateTime||r(s)})}getUserLastUpdateTime(e){var r=this;return I(function*(){const s=yield r.userDAO.read(e);if(s.isAbsent())return y.empty();{const i=s.get().lastUpdateTime;return We(null!=i,"should not receive a lastUpdateTime equal to null"),y.of(i)}})()}updatePresenceToken(e){return this.userDAO.update(e,{lastUpdateTime:$4()})}getServerTime(e){var r=this;return I(function*(){return new Promise(s=>{let i=!1;const c=r.userDAO.subscribeToChanges(e,u=>{null==u.get().lastUpdateTime?i=!0:i&&(c.unsubscribe(),s(u.get().lastUpdateTime))});r.updatePresenceToken(e)})})()}}return n.\u0275fac=function(e){return new(e||n)(ze(oV))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class $te extends W2{constructor(t=1/0,e=1/0,r=IR){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:r,_infiniteTimeWindow:s,_timestampProvider:i,_windowTime:o}=this;e||(r.push(t),!s&&r.push(i.now()+o)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:r,_buffer:s}=this,i=s.slice();for(let o=0;o<i.length&&!t.closed;o+=r?1:2)t.next(i[o]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:r,_infiniteTimeWindow:s}=this,i=(s?1:2)*t;if(t<1/0&&i<r.length&&r.splice(0,r.length-i),!s){const o=e.now();let c=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)c=u;c&&r.splice(0,c+1)}}}let Lm=(()=>{class n{}return n.YOU_ARE_ALREADY_PLAYING=()=>$localize`You are already playing in another game.`,n.YOU_ARE_ALREADY_CREATING=()=>$localize`You are already the creator of another game.`,n.YOU_ARE_ALREADY_CHOSEN_OPPONENT=()=>$localize`You are already the chosen opponent in another game.`,n.YOU_ARE_ALREADY_CANDIDATE=()=>$localize`You are already candidate in another game.`,n.YOU_ARE_ALREADY_OBSERVING=()=>$localize`You are already observing another game.`,n})();class u8{static createUserWithEmailAndPassword(t,e,r){return _Oe(t,e,r)}static sendEmailVerification(t){return yOe(t)}static sendPasswordResetEmail(t,e){return EOe(t,e)}static signInWithEmailAndPassword(t,e,r){return I(function*(){return(yield MOe(t,e,r)).user})()}static signInWithPopup(t,e){return I(function*(){return(yield SOe(t,e)).user})()}static updateProfile(t,e){return POe(t,e)}}class R5{constructor(t,e,r,s){this.id=t,this.email=e,this.username=r,this.verified=s}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(t){return this.id===t.id&&this.email.equals(t.email)&&this.username.equals(t.username)&&this.verified===t.verified}}R5.NOT_CONNECTED=new R5("",y.empty(),y.empty(),!1);let Is=(()=>{class n{constructor(e,r,s){var i=this;this.userDAO=e,this.userService=r,this.auth=s,this.user=y.empty(),this.userSubscription=new k1,J(n.VERBOSE,"ConnectedUserService constructor"),this.userRS=new $te(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new k1(COe(this.auth,function(){var o=I(function*(c){null==c?(J(n.VERBOSE,"User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(R5.NOT_CONNECTED),i.user=y.empty()):(We(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(c.uid,u=>{if(u.isPresent()){const h=u.get(),g=h.username;J(n.VERBOSE,`User ${g} is connected, and the verified status is ${i.emailVerified(c)}`);const m=!0===i.emailVerified(c)&&null!=g;if(!0===m&&!1===h.verified)return i.userService.markAsVerified(c.uid);const E=new R5(c.uid,y.ofNullable(c.email),y.ofNullable(g),m);!1===i.user.equalsValue(E)&&(i.user=y.of(E),i.userRS.next(E))}}))});return function(c){return o.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var r=this;return I(function*(){try{return yield u8.sendPasswordResetEmail(r.auth,e),R.SUCCESS}catch(s){return R.failure(r.mapFirebaseError(s))}})()}doRegister(e,r,s){var i=this;return I(function*(){return J(n.VERBOSE,"ConnectedUserService.doRegister("+r+")"),(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,r,s):ve.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,r,s){var i=this;return I(function*(){try{const o=yield u8.createUserWithEmailAndPassword(i.auth,r,s);yield u8.signInWithEmailAndPassword(i.auth,r,s);const c=ge.getNonNullable(o.user);return yield i.createUser(c.uid,e),ve.success(c)}catch(o){return ve.failure(i.mapFirebaseError(o))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return Ns.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return I(function*(){J(n.VERBOSE,"ConnectedUserService.sendEmailVerification()");const r=y.ofNullable(e.auth.currentUser);if(!r.isPresent())return Ns.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(r.get()))return Ns.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield u8.sendEmailVerification(r.get()),R.SUCCESS}catch(s){return R.failure(e.mapFirebaseError(s))}})()}doEmailLogin(e,r){var s=this;return I(function*(){J(n.VERBOSE,"ConnectedUserService.doEmailLogin("+e+")");try{return yield u8.signInWithEmailAndPassword(s.auth,e,r),R.SUCCESS}catch(i){return R.failure(s.mapFirebaseError(i))}})()}createUser(e,r){var s=this;return I(function*(){null==r?yield s.userDAO.set(e,{verified:!1,currentGame:null}):yield s.userDAO.set(e,{username:r,verified:!1,currentGame:null})})()}doGoogleLogin(){var e=this;return I(function*(){return R.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return I(function*(){try{const r=new fTe;r.addScope("profile"),r.addScope("email");const s=yield u8.signInWithPopup(e.auth,r);return!1===(yield e.userDAO.exists(s.uid))&&(yield e.createUser(s.uid)),ve.success(s)}catch(r){return ve.failure(e.mapFirebaseError(r))}})()}disconnect(){var e=this;return I(function*(){return y.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),R.SUCCESS):R.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var r=this;return I(function*(){if(""===e)return R.failure($localize`Your username may not be empty.`);try{if(!1===(yield r.userService.usernameIsAvailable(e)))return R.failure($localize`This username is already in use, please select a different one.`);const i=ge.getNonNullable(r.auth.currentUser);return yield u8.updateProfile(i,{displayName:e}),yield r.userService.setUsername(i.uid,e),yield r.userService.markAsVerified(i.uid),yield r.reloadUser(),R.SUCCESS}catch(s){return R.failure(r.mapFirebaseError(s))}})()}setPicture(e){var r=this;return I(function*(){try{const s=ge.getNonNullable(r.auth.currentUser);return yield u8.updateProfile(s,{photoURL:e}),R.SUCCESS}catch(s){return R.failure(r.mapFirebaseError(s))}})()}reloadUser(){var e=this;return I(function*(){const r=ge.getNonNullable(e.auth.currentUser);yield r.getIdToken(!0),yield r.reload()})()}sendPresenceToken(){return We(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(ze(oV),ze(Rh),ze(HS))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class P1{constructor(t){this.value=t}}P1.HARD_DRAW=new P1(0),P1.RESIGN=new P1(1),P1.ESCAPE=new P1(2),P1.VICTORY=new P1(3),P1.TIMEOUT=new P1(4),P1.UNACHIEVED=new P1(5),P1.AGREED_DRAW_BY_ZERO=new P1(6),P1.AGREED_DRAW_BY_ONE=new P1(7);class $S{constructor(t,e){this.id=t,this.data=e}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===P1.HARD_DRAW.value}isAgreedDraw(){return this.data.result===P1.AGREED_DRAW_BY_ZERO.value||this.data.result===P1.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===P1.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(We(this.data.result===P1.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),ge.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===P1.VICTORY.value}isTimeout(){return this.data.result===P1.TIMEOUT.value}isResign(){return this.data.result===P1.RESIGN.value}getWinner(){return y.ofNullable(this.data.winner)}getLoser(){return y.ofNullable(this.data.loser)}setWinnerAndLoser(t,e){return new $S(this.id,{...this.data,winner:t,loser:e})}}class Ks{constructor(t){this.value=t}static of(t){switch(t){case"CREATOR":return Ks.CREATOR;case"RANDOM":return Ks.RANDOM;default:return We("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),Ks.CHOSEN_PLAYER}}}Ks.CREATOR=new Ks("CREATOR"),Ks.RANDOM=new Ks("RANDOM"),Ks.CHOSEN_PLAYER=new Ks("CHOSEN_PLAYER");class Ar{constructor(t){this.value=t}static of(t){switch(t){case"STANDARD":return Ar.STANDARD;case"BLITZ":return Ar.BLITZ;case"CUSTOM":return Ar.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}Ar.STANDARD=new Ar("STANDARD"),Ar.BLITZ=new Ar("BLITZ"),Ar.CUSTOM=new Ar("CUSTOM"),Ar.NORMAL_MOVE_DURATION=120,Ar.NORMAL_PART_DURATION=1800,Ar.BLITZ_MOVE_DURATION=30,Ar.BLITZ_PART_DURATION=900;class Xs{constructor(t){this.value=t}}Xs.PART_CREATED=new Xs(0),Xs.CONFIG_PROPOSED=new Xs(2),Xs.PART_STARTED=new Xs(3),Xs.PART_FINISHED=new Xs(4);class aV{constructor(){this.value=2}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(t){return this===t}}aV.NONE=new aV;class B{constructor(t){this.value=t}static of(t){return 0===t?B.ZERO:(ge.expectToBe(t,1),B.ONE)}static ofTurn(t){return t%2==0?B.ZERO:B.ONE}isPlayer(){return!0}toString(){return this===B.ZERO?"PLAYER_ZERO":(ge.expectToBe(this,B.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(t){return this===t}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===B.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===B.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===B.ZERO?B.ONE:(ge.expectToBe(this,B.ONE),B.ZERO)}}var ue;B.encoder=Ye.tuple([Ye.identity()],n=>[n.value],n=>B.of(n[0])),B.ZERO=new B(0),B.ONE=new B(1),B.PLAYERS=[B.ZERO,B.ONE],function(n){n.ZERO=B.ZERO,n.ONE=B.ONE,n.NONE=aV.NONE,n.encoder=new class extends Ye{encode(t){return t.value}decode(t){return 2===t?n.NONE:(ge.assert(0===t||1===t,"Invalid encoded player: "+t),B.of(t))}}}(ue||(ue={}));let cV=(()=>{class n extends km{constructor(e){super("parts",e),J(n.VERBOSE,"PartDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(ze(l8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class US{constructor(t,e,r){this.onDocumentCreated=t,this.onDocumentModified=e,this.onDocumentDeleted=r}}let lV=(()=>{class n{constructor(e){this.partDAO=e}eventsCollection(e){return this.partDAO.subCollectionDAO(e,"events")}addEvent(e,r){return this.eventsCollection(e).create(r)}addMove(e,r,s){return this.addEvent(e,{eventType:"Move",time:$4(),player:r.value,move:s})}addRequest(e,r,s){return this.addEvent(e,{eventType:"Request",time:$4(),player:r.value,requestType:s})}addReply(e,r,s,i,o=null){return this.addEvent(e,{eventType:"Reply",time:$4(),player:r.value,reply:s,requestType:i,data:o})}startGame(e,r){return this.addAction(e,r,"StartGame")}addAction(e,r,s){return this.addEvent(e,{eventType:"Action",time:$4(),player:r.value,action:s})}subscribeToEvents(e,r){const s=new US(i=>{const o=i.map(c=>c.data).filter(c=>null!=c.time);o.length>0&&r(o)},i=>{r(i.map(o=>o.data))},()=>{});return this.eventsCollection(e).observingWhere([],s,"time")}}return n.\u0275fac=function(e){return new(e||n)(ze(cV))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ZOe=(()=>{class n extends km{constructor(e){super("config-room",e),J(n.VERBOSE,"ConfigRoomDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(ze(l8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),uV=(()=>{class n{constructor(e,r){this.configRoomDAO=e,this.connectedUserService=r,J(n.VERBOSE,"ConfigRoomService.constructor")}addCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(r.id,r)}removeCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(r.id)}subscribeToChanges(e,r){return this.configRoomDAO.subscribeToChanges(e,r)}subscribeToCandidates(e,r){let s=[];const i=new US(c=>{for(const u of c)s.push(u.data);r(s)},c=>{for(const u of c)s=s.map(h=>h.id===u.data.id?u.data:h);r(s)},c=>{for(const u of c)s=s.filter(h=>h.id!==u.data.id);r(s)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var r=this;return I(function*(){J(n.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+e+")");const s=r.connectedUserService.user.get().toMinimalUser();return r.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:Ks.RANDOM.value,partType:Ar.STANDARD.value,partStatus:Xs.PART_CREATED.value,maximalMoveDuration:Ar.NORMAL_MOVE_DURATION,totalPartDuration:Ar.NORMAL_PART_DURATION,creator:s})})()}joinGame(e){var r=this;return I(function*(){J(n.VERBOSE,"ConfigRoomService.joinGame("+e+")");const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);return i.isAbsent()?R.failure(n.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==s.id&&(yield r.addCandidate(e,s)),R.SUCCESS)})()}cancelJoining(e){var r=this;return I(function*(){J(n.VERBOSE,`ConfigRoomService.cancelJoining(${e})`);const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);if(!i.isAbsent()){const o=i.get(),c=[r.removeCandidate(e,s)];o.chosenOpponent?.id===s.id&&c.push(r.configRoomDAO.update(e,{chosenOpponent:null,partStatus:Xs.PART_CREATED.value})),yield Promise.all(c)}})()}deleteConfigRoom(e,r){var s=this;return I(function*(){J(n.VERBOSE,`ConfigRoomService.deleteConfigRoom(${e}`),yield Promise.all(r.map(i=>s.removeCandidate(e,i))),yield s.configRoomDAO.delete(e)})()}proposeConfig(e,r,s,i,o,c){var u=this;return I(function*(){return J(n.VERBOSE,{configRoomService_proposeConfig:{configRoomId:e,maximalMoveDuration:i,firstPlayer:o,totalPartDuration:c}}),u.configRoomDAO.update(e,{partStatus:Xs.CONFIG_PROPOSED.value,chosenOpponent:r,partType:s.value,maximalMoveDuration:i,totalPartDuration:c,firstPlayer:o.value})})()}setChosenOpponent(e,r){return J(n.VERBOSE,`ConfigRoomService.setChosenOpponent(${e}, ${r.name})`),this.configRoomDAO.update(e,{chosenOpponent:r})}reviewConfig(e){var r=this;return I(function*(){return J(n.VERBOSE,`ConfigRoomService.reviewConfig(${e})`),r.configRoomDAO.update(e,{partStatus:Xs.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var r=this;return I(function*(){return J(n.VERBOSE,`ConfigRoomService.reviewConfigAndRemoveChosenOpponent(${e})`),r.configRoomDAO.update(e,{partStatus:Xs.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return J(n.VERBOSE,`ConfigRoomService.acceptConfig(${e}`),this.configRoomDAO.update(e,{partStatus:Xs.PART_STARTED.value})}createConfigRoom(e,r){var s=this;return I(function*(){return J(n.VERBOSE,`ConfigRoomService.create(${e}`+JSON.stringify(r)+")"),s.configRoomDAO.set(e,r)})()}readConfigRoomById(e){var r=this;return I(function*(){return J(n.VERBOSE,`ConfigRoomService.readConfigRoomById(${e})`),(yield r.configRoomDAO.read(e)).get()})()}}return n.VERBOSE=!1,n.GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`,n.\u0275fac=function(e){return new(e||n)(ze(ZOe),ze(Is))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),GS=(()=>{class n{constructor(e,r,s,i,o){this.partDAO=e,this.gameEventService=r,this.connectedUserService=s,this.configRoomService=i,this.chatService=o,J(n.VERBOSE,"GameService.constructor")}update(e,r){var s=this;return I(function*(){return s.partDAO.update(e,r)})()}getPartValidity(e,r){var s=this;return I(function*(){const i=yield s.partDAO.read(e);return i.isAbsent()?R.failure("NONEXISTENT_PART"):i.get().typeGame===r?R.SUCCESS:R.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){J(n.VERBOSE,"GameService.createUnstartedPart("+e+")");const r=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({typeGame:e,playerZero:r,turn:-1,result:P1.UNACHIEVED.value})}createChat(e){return J(n.VERBOSE,"GameService.createChat("+e+")"),this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var r=this;return I(function*(){J(n.VERBOSE,`GameService.createGame(${e})`);const s=yield r.createUnstartedPart(e);return yield r.configRoomService.createInitialConfigRoom(s),yield r.createChat(s),s})()}getStartingConfig(e){let s,i,r=Ks.of(e.firstPlayer);return r===Ks.RANDOM&&(r=Math.random()<.5?Ks.CREATOR:Ks.CHOSEN_PLAYER),r===Ks.CREATOR?(s=e.creator,i=ge.getNonNullable(e.chosenOpponent)):(s=ge.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:s,playerOne:i,turn:0,beginning:$4()}}deletePart(e){return J(n.VERBOSE,"GameService.deletePart("+e+")"),this.partDAO.delete(e)}acceptConfig(e,r){var s=this;return I(function*(){J(n.VERBOSE,{gameService_acceptConfig:{partId:e,configRoom:r}}),yield s.configRoomService.acceptConfig(e);const i=s.getStartingConfig(r);let o;o=i.playerZero===r.creator?B.ONE:B.ZERO,yield s.partDAO.update(e,i),yield s.gameEventService.startGame(e,o)})()}getPart(e){return this.partDAO.read(e)}subscribeToChanges(e,r){return this.partDAO.subscribeToChanges(e,r)}resign(e,r,s,i){var o=this;return I(function*(){const c={winner:s,loser:i,result:P1.RESIGN.value};yield o.partDAO.update(e,c),yield o.gameEventService.addAction(e,r,"EndGame")})()}notifyTimeout(e,r,s,i){var o=this;return I(function*(){const c={winner:s,loser:i,result:P1.TIMEOUT.value};yield o.partDAO.update(e,c),yield o.gameEventService.addAction(e,r,"EndGame")})()}proposeDraw(e,r){var s=this;return I(function*(){yield s.gameEventService.addRequest(e,r,"Draw")})()}acceptDraw(e,r){var s=this;return I(function*(){yield s.gameEventService.addReply(e,r,"Accept","Draw");const o={result:(r===B.ZERO?P1.AGREED_DRAW_BY_ZERO:P1.AGREED_DRAW_BY_ONE).value};yield s.partDAO.update(e,o),yield s.gameEventService.addAction(e,r,"EndGame")})()}refuseDraw(e,r){var s=this;return I(function*(){yield s.gameEventService.addReply(e,r,"Reject","Draw")})()}proposeRematch(e,r){var s=this;return I(function*(){yield s.gameEventService.addRequest(e,r,"Rematch")})()}rejectRematch(e,r){var s=this;return I(function*(){yield s.gameEventService.addReply(e,r,"Reject","Rematch")})()}acceptRematch(e,r){var s=this;return I(function*(){J(n.VERBOSE,{called:"GameService.acceptRematch",partDocument:e});const i=ge.getNonNullable(e.data),o=yield s.configRoomService.readConfigRoomById(e.id);let c;const u=s.connectedUserService.user.get().toMinimalUser();let h;i.playerZero.id===u.id?(h=ge.getNonNullable(i.playerOne),c=Ks.CHOSEN_PLAYER):(h=i.playerZero,c=Ks.CREATOR);const g={...o,firstPlayer:c.value,creator:u,chosenOpponent:h,partStatus:Xs.PART_STARTED.value},m=s.getStartingConfig(g),E={typeGame:i.typeGame,result:P1.UNACHIEVED.value,...m},O=yield s.partDAO.create(E);yield s.configRoomService.createConfigRoom(O,g),yield s.createChat(O),yield s.gameEventService.addReply(e.id,r,"Accept","Rematch",O),yield s.gameEventService.startGame(O,r.getOpponent())})()}askTakeBack(e,r){var s=this;return I(function*(){yield s.gameEventService.addRequest(e,r,"TakeBack")})()}acceptTakeBack(e,r,s){var i=this;return I(function*(){let o=r-1;o%2===s.value&&o--;const c={turn:o};return yield i.gameEventService.addReply(e,s,"Accept","TakeBack"),yield i.partDAO.update(e,c)})()}refuseTakeBack(e,r){var s=this;return I(function*(){yield s.gameEventService.addReply(e,r,"Reject","TakeBack")})()}addGlobalTime(e,r){var s=this;return I(function*(){yield s.gameEventService.addAction(e,r,"AddGlobalTime")})()}addTurnTime(e,r){var s=this;return I(function*(){yield s.gameEventService.addAction(e,r,"AddTurnTime")})()}preparePartUpdate(e,r){var s=this;return I(function*(){let c={turn:(yield s.partDAO.read(e)).get().turn+1};return c=s.updateScore(c,r),c})()}updatePart(e,r){var s=this;return I(function*(){J(n.VERBOSE,{gameService_updatePart:{partId:e,scores:r}});const i=yield s.preparePartUpdate(e,r);yield s.update(e,i)})()}drawPart(e,r,s){var i=this;return I(function*(){let o=yield i.preparePartUpdate(e,s);o={...o,result:P1.HARD_DRAW.value},yield i.update(e,o),yield i.gameEventService.addAction(e,r,"EndGame")})()}endPartWithVictory(e,r,s,i,o){var c=this;return I(function*(){let u=yield c.preparePartUpdate(e,o);u={...u,winner:s,loser:i,result:P1.VICTORY.value},yield c.update(e,u),yield c.gameEventService.addAction(e,r,"EndGame")})()}addMove(e,r,s){var i=this;return I(function*(){yield i.gameEventService.addMove(e,r,s)})()}updateScore(e,r){return r.isPresent()?{...e,scorePlayerZero:r.get()[0],scorePlayerOne:r.get()[1]}:e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(ze(cV),ze(lV),ze(Is),ze(uV),ze(BS))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var hne={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},vne={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},Cne={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class Rm{static getNavigatorLanguage(){return navigator.language}static getLocale(){const r=(localStorage.getItem("locale")??Rm.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(s=>s===r)?r:"fr"}}let Pne=(()=>{class n{changeTheme(e){localStorage.setItem("theme",e)}getTheme(){return y.ofNullable(localStorage.getItem("theme"))}changeLanguage(e){localStorage.setItem("locale",e.toLowerCase())}getLanguage(){return Rm.getLocale()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),qS=(()=>{class n{constructor(e,r){this.document=e,this.userSettingsService=r,this.availableThemes=["dark","light"];const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const e=this.userSettingsService.getTheme();if(e.isPresent()){const r=e.get();if(this.availableThemes.some(s=>s===r))return y.of(r)}return y.empty()}loadTheme(e){this.loadStyle(e+".css"),this.theme=e}loadStyle(e){const r=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=e;else{const i=this.document.createElement("link");i.id="theme",i.rel="stylesheet",i.href=`${e}`,r.appendChild(i)}}getTheme(){return this.theme}}return n.\u0275fac=function(e){return new(e||n)(ze(Gs),ze(Pne))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Tne(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),e.push.apply(e,r)}return e}function Pt(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?Tne(Object(e),!0).forEach(function(r){vi(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):Tne(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function WS(n){return(WS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function wne(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function vi(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function hV(n,t){return function NDe(n){if(Array.isArray(n))return n}(n)||function xDe(n,t){var e=null==n?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var o,c,r=[],s=!0,i=!1;try{for(e=e.call(n);!(s=(o=e.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(u){i=!0,c=u}finally{try{!s&&null!=e.return&&e.return()}finally{if(i)throw c}}return r}}(n,t)||One(n,t)||function LDe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zm(n){return function ADe(n){if(Array.isArray(n))return dV(n)}(n)||function IDe(n){if(typeof Symbol<"u"&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||One(n)||function kDe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function One(n,t){if(n){if("string"==typeof n)return dV(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if("Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return dV(n,t)}}function dV(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var bne=function(){},pV={},Ane={},Nne=null,Ine={mark:bne,measure:bne};try{typeof window<"u"&&(pV=window),typeof document<"u"&&(Ane=document),typeof MutationObserver<"u"&&(Nne=MutationObserver),typeof performance<"u"&&(Ine=performance)}catch{}var YS,KS,XS,QS,JS,xne=(pV.navigator||{}).userAgent,kne=void 0===xne?"":xne,f8=pV,Nr=Ane,Lne=Nne,ZS=Ine,g6=!!Nr.documentElement&&!!Nr.head&&"function"==typeof Nr.addEventListener&&"function"==typeof Nr.createElement,Rne=~kne.indexOf("MSIE")||~kne.indexOf("Trident/"),m6="___FONT_AWESOME___",zne="svg-inline--fa",D5="data-fa-i2svg",mV="data-fa-pseudo-element",_V="data-prefix",vV="data-icon",Vne="fontawesome-i2svg",VDe=["HTML","HEAD","STYLE","SCRIPT"],Hne=function(){try{return!0}catch{return!1}}(),Ir="classic",gs="sharp",CV=[Ir,gs];function Vm(n){return new Proxy(n,{get:function(e,r){return r in e?e[r]:e[Ir]}})}var Hm=Vm((vi(YS={},Ir,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),vi(YS,gs,{fa:"solid",fass:"solid","fa-solid":"solid"}),YS)),Fm=Vm((vi(KS={},Ir,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),vi(KS,gs,{solid:"fass"}),KS)),Bm=Vm((vi(XS={},Ir,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),vi(XS,gs,{fass:"fa-solid"}),XS)),HDe=Vm((vi(QS={},Ir,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),vi(QS,gs,{"fa-solid":"fass"}),QS)),FDe=/fa(s|r|l|t|d|b|k|ss)?[\-\ ]/,Fne="fa-layers-text",BDe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,$De=Vm((vi(JS={},Ir,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),vi(JS,gs,{900:"fass"}),JS)),Bne=[1,2,3,4,5,6,7,8,9,10],UDe=Bne.concat([11,12,13,14,15,16,17,18,19,20]),GDe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],$m=new Set;Object.keys(Fm[Ir]).map($m.add.bind($m)),Object.keys(Fm[gs]).map($m.add.bind($m));var qDe=[].concat(CV,zm($m),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul","duotone-group","swap-opacity","primary","secondary"]).concat(Bne.map(function(n){return"".concat(n,"x")})).concat(UDe.map(function(n){return"w-".concat(n)})),Um=f8.FontAwesomeConfig||{};Nr&&"function"==typeof Nr.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(n){var t=hV(n,2),r=t[1],s=function jDe(n){return""===n||"false"!==n&&("true"===n||n)}(function WDe(n){var t=Nr.querySelector("script["+n+"]");if(t)return t.getAttribute(n)}(t[0]));null!=s&&(Um[r]=s)});var $ne={styleDefault:"solid",familyDefault:"classic",cssPrefix:"fa",replacementClass:zne,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};Um.familyPrefix&&(Um.cssPrefix=Um.familyPrefix);var Dh=Pt(Pt({},$ne),Um);Dh.autoReplaceSvg||(Dh.observeMutations=!1);var kt={};Object.keys($ne).forEach(function(n){Object.defineProperty(kt,n,{enumerable:!0,set:function(e){Dh[n]=e,Gm.forEach(function(r){return r(kt)})},get:function(){return Dh[n]}})}),Object.defineProperty(kt,"familyPrefix",{enumerable:!0,set:function(t){Dh.cssPrefix=t,Gm.forEach(function(e){return e(kt)})},get:function(){return Dh.cssPrefix}}),f8.FontAwesomeConfig=kt;var Gm=[],G4={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function qm(){for(var n=12,t="";n-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function zh(n){for(var t=[],e=(n||[]).length>>>0;e--;)t[e]=n[e];return t}function yV(n){return n.classList?zh(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(t){return t})}function Une(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function eP(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,": ").concat(n[e].trim(),";")},"")}function EV(n){return n.size!==G4.size||n.x!==G4.x||n.y!==G4.y||n.rotate!==G4.rotate||n.flipX||n.flipY}function Gne(){var n="fa",t=zne,e=kt.cssPrefix,r=kt.replacementClass,s=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';if(e!==n||r!==t){var i=new RegExp("\\.".concat(n,"\\-"),"g"),o=new RegExp("\\--".concat(n,"\\-"),"g"),c=new RegExp("\\.".concat(t),"g");s=s.replace(i,".".concat(e,"-")).replace(o,"--".concat(e,"-")).replace(c,".".concat(r))}return s}var qne=!1;function MV(){kt.autoAddCss&&!qne&&(function KDe(n){if(n&&g6){var t=Nr.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=n;for(var e=Nr.head.childNodes,r=null,s=e.length-1;s>-1;s--){var i=e[s],o=(i.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=i)}Nr.head.insertBefore(t,r)}}(Gne()),qne=!0)}var nze={mixout:function(){return{dom:{css:Gne,insertCss:MV}}},hooks:function(){return{beforeDOMElementCreation:function(){MV()},beforeI2svg:function(){MV()}}}},_6=f8||{};_6[m6]||(_6[m6]={}),_6[m6].styles||(_6[m6].styles={}),_6[m6].hooks||(_6[m6].hooks={}),_6[m6].shims||(_6[m6].shims=[]);var V3=_6[m6],Wne=[],tP=!1;function sze(n){!g6||(tP?setTimeout(n,0):Wne.push(n))}function Wm(n){var t=n.tag,e=n.attributes,r=void 0===e?{}:e,s=n.children,i=void 0===s?[]:s;return"string"==typeof n?Une(n):"<".concat(t," ").concat(function QDe(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,'="').concat(Une(n[e]),'" ')},"").trim()}(r),">").concat(i.map(Wm).join(""),"</").concat(t,">")}function jne(n,t,e){if(n&&n[t]&&n[t][e])return{prefix:t,iconName:e,icon:n[t][e]}}g6&&((tP=(Nr.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Nr.readyState))||Nr.addEventListener("DOMContentLoaded",function n(){Nr.removeEventListener("DOMContentLoaded",n),tP=1,Wne.map(function(t){return t()})}));var SV=function(t,e,r,s){var u,h,g,i=Object.keys(t),o=i.length,c=void 0!==s?function(t,e){return function(r,s,i,o){return t.call(e,r,s,i,o)}}(e,s):e;for(void 0===r?(u=1,g=t[i[0]]):(u=0,g=r);u<o;u++)g=c(g,t[h=i[u]],h,t);return g};function PV(n){var t=function oze(n){for(var t=[],e=0,r=n.length;e<r;){var s=n.charCodeAt(e++);if(s>=55296&&s<=56319&&e<r){var i=n.charCodeAt(e++);56320==(64512&i)?t.push(((1023&s)<<10)+(1023&i)+65536):(t.push(s),e--)}else t.push(s)}return t}(n);return 1===t.length?t[0].toString(16):null}function Zne(n){return Object.keys(n).reduce(function(t,e){var r=n[e];return r.icon?t[r.iconName]=r.icon:t[e]=r,t},{})}function TV(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.skipHooks,s=void 0!==r&&r,i=Zne(t);"function"!=typeof V3.hooks.addPack||s?V3.styles[n]=Pt(Pt({},V3.styles[n]||{}),i):V3.hooks.addPack(n,Zne(t)),"fas"===n&&TV("fa",t)}var nP,rP,sP,Vh=V3.styles,cze=V3.shims,lze=(vi(nP={},Ir,Object.values(Bm[Ir])),vi(nP,gs,Object.values(Bm[gs])),nP),wV=null,Yne={},Kne={},Xne={},Qne={},Jne={},uze=(vi(rP={},Ir,Object.keys(Hm[Ir])),vi(rP,gs,Object.keys(Hm[gs])),rP);function hze(n,t){var e=t.split("-"),r=e[0],s=e.slice(1).join("-");return r!==n||""===s||function fze(n){return~qDe.indexOf(n)}(s)?null:s}var e1e=function(){var t=function(i){return SV(Vh,function(o,c,u){return o[u]=SV(c,i,{}),o},{})};Yne=t(function(s,i,o){return i[3]&&(s[i[3]]=o),i[2]&&i[2].filter(function(u){return"number"==typeof u}).forEach(function(u){s[u.toString(16)]=o}),s}),Kne=t(function(s,i,o){return s[o]=o,i[2]&&i[2].filter(function(u){return"string"==typeof u}).forEach(function(u){s[u]=o}),s}),Jne=t(function(s,i,o){var c=i[2];return s[o]=o,c.forEach(function(u){s[u]=o}),s});var e="far"in Vh||kt.autoFetchSvg,r=SV(cze,function(s,i){var o=i[0],c=i[1],u=i[2];return"far"===c&&!e&&(c="fas"),"string"==typeof o&&(s.names[o]={prefix:c,iconName:u}),"number"==typeof o&&(s.unicodes[o.toString(16)]={prefix:c,iconName:u}),s},{names:{},unicodes:{}});Xne=r.names,Qne=r.unicodes,wV=iP(kt.styleDefault,{family:kt.familyDefault})};function OV(n,t){return(Yne[n]||{})[t]}function V5(n,t){return(Jne[n]||{})[t]}function t1e(n){return Xne[n]||{prefix:null,iconName:null}}function d8(){return wV}function iP(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.family,r=void 0===e?Ir:e,s=Hm[r][n],i=Fm[r][n]||Fm[r][s],o=n in V3.styles?n:null;return i||o||null}(function YDe(n){Gm.push(n)})(function(n){wV=iP(n.styleDefault,{family:kt.familyDefault})}),e1e();var n1e=(vi(sP={},Ir,Object.keys(Bm[Ir])),vi(sP,gs,Object.keys(Bm[gs])),sP);function oP(n){var t,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.skipLookups,s=void 0!==r&&r,i=(vi(t={},Ir,"".concat(kt.cssPrefix,"-").concat(Ir)),vi(t,gs,"".concat(kt.cssPrefix,"-").concat(gs)),t),o=null,c=Ir;(n.includes(i[Ir])||n.some(function(h){return n1e[Ir].includes(h)}))&&(c=Ir),(n.includes(i[gs])||n.some(function(h){return n1e[gs].includes(h)}))&&(c=gs);var u=n.reduce(function(h,g){var m=hze(kt.cssPrefix,g);if(Vh[g]?(g=lze[c].includes(g)?HDe[c][g]:g,o=g,h.prefix=g):uze[c].indexOf(g)>-1?(o=g,h.prefix=iP(g,{family:c})):m?h.iconName=m:g!==kt.replacementClass&&g!==i[Ir]&&g!==i[gs]&&h.rest.push(g),!s&&h.prefix&&h.iconName){var E="fa"===o?t1e(h.iconName):{},O=V5(h.prefix,h.iconName);E.prefix&&(o=null),h.iconName=E.iconName||O||h.iconName,h.prefix=E.prefix||h.prefix,"far"===h.prefix&&!Vh.far&&Vh.fas&&!kt.autoFetchSvg&&(h.prefix="fas")}return h},{prefix:null,iconName:null,rest:[]});return(n.includes("fa-brands")||n.includes("fab"))&&(u.prefix="fab"),(n.includes("fa-duotone")||n.includes("fad"))&&(u.prefix="fad"),!u.prefix&&c===gs&&(Vh.fass||kt.autoFetchSvg)&&(u.prefix="fass",u.iconName=V5(u.prefix,u.iconName)||u.iconName),("fa"===u.prefix||"fa"===o)&&(u.prefix=d8()||"fas"),u}var gze=function(){function n(){(function wDe(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),this.definitions={}}return function ODe(n,t,e){t&&wne(n.prototype,t),e&&wne(n,e),Object.defineProperty(n,"prototype",{writable:!1})}(n,[{key:"add",value:function(){for(var e=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var o=s.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(c){e.definitions[c]=Pt(Pt({},e.definitions[c]||{}),o[c]),TV(c,o[c]);var u=Bm[Ir][c];u&&TV(u,o[c]),e1e()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,r){var s=r.prefix&&r.iconName&&r.icon?{0:r}:r;return Object.keys(s).map(function(i){var o=s[i],c=o.prefix,u=o.iconName,h=o.icon,g=h[2];e[c]||(e[c]={}),g.length>0&&g.forEach(function(m){"string"==typeof m&&(e[c][m]=h)}),e[c][u]=h}),e}}]),n}(),r1e=[],Hh={},Fh={},mze=Object.keys(Fh);function AV(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),s=2;s<e;s++)r[s-2]=arguments[s];var i=Hh[n]||[];return i.forEach(function(o){t=o.apply(null,[t].concat(r))}),t}function H5(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];var s=Hh[n]||[];s.forEach(function(i){i.apply(null,e)})}function v6(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);return Fh[n]?Fh[n].apply(null,t):void 0}function NV(n){"fa"===n.prefix&&(n.prefix="fas");var t=n.iconName,e=n.prefix||d8();if(t)return t=V5(e,t)||t,jne(s1e.definitions,e,t)||jne(V3.styles,e,t)}var s1e=new gze,Cze={i2svg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return g6?(H5("beforeI2svg",t),v6("pseudoElements2svg",t),v6("i2svg",t)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot;!1===kt.autoReplaceSvg&&(kt.autoReplaceSvg=!0),kt.observeMutations=!0,sze(function(){Eze({autoReplaceSvgRoot:e}),H5("watch",t)})}},sc={noAuto:function(){kt.autoReplaceSvg=!1,kt.observeMutations=!1,H5("noAuto")},config:kt,dom:Cze,parse:{icon:function(t){if(null===t)return null;if("object"===WS(t)&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:V5(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&2===t.length){var e=0===t[1].indexOf("fa-")?t[1].slice(3):t[1],r=iP(t[0]);return{prefix:r,iconName:V5(r,e)||e}}if("string"==typeof t&&(t.indexOf("".concat(kt.cssPrefix,"-"))>-1||t.match(FDe))){var s=oP(t.split(" "),{skipLookups:!0});return{prefix:s.prefix||d8(),iconName:V5(s.prefix,s.iconName)||s.iconName}}if("string"==typeof t){var i=d8();return{prefix:i,iconName:V5(i,t)||t}}}},library:s1e,findIconDefinition:NV,toHtml:Wm},Eze=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot,r=void 0===e?Nr:e;(Object.keys(V3.styles).length>0||kt.autoFetchSvg)&&g6&&kt.autoReplaceSvg&&sc.dom.i2svg({node:r})};function aP(n,t){return Object.defineProperty(n,"abstract",{get:t}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(r){return Wm(r)})}}),Object.defineProperty(n,"node",{get:function(){if(g6){var r=Nr.createElement("div");return r.innerHTML=n.html,r.children}}}),n}function IV(n){var t=n.icons,e=t.main,r=t.mask,s=n.prefix,i=n.iconName,o=n.transform,c=n.symbol,u=n.title,h=n.maskId,g=n.titleId,m=n.extra,E=n.watchable,O=void 0!==E&&E,k=r.found?r:e,U=k.width,j=k.height,oe="fak"===s,Ee=[kt.replacementClass,i?"".concat(kt.cssPrefix,"-").concat(i):""].filter(function(x1){return-1===m.classes.indexOf(x1)}).filter(function(x1){return""!==x1||!!x1}).concat(m.classes).join(" "),ne={children:[],attributes:Pt(Pt({},m.attributes),{},{"data-prefix":s,"data-icon":i,class:Ee,role:m.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(U," ").concat(j)})},ke=oe&&!~m.classes.indexOf("fa-fw")?{width:"".concat(U/j*16*.0625,"em")}:{};O&&(ne.attributes[D5]=""),u&&(ne.children.push({tag:"title",attributes:{id:ne.attributes["aria-labelledby"]||"title-".concat(g||qm())},children:[u]}),delete ne.attributes.title);var Ue=Pt(Pt({},ne),{},{prefix:s,iconName:i,main:e,mask:r,maskId:h,transform:o,symbol:c,styles:Pt(Pt({},ke),m.styles)}),et=r.found&&e.found?v6("generateAbstractMask",Ue)||{children:[],attributes:{}}:v6("generateAbstractIcon",Ue)||{children:[],attributes:{}},B1=et.attributes;return Ue.children=et.children,Ue.attributes=B1,c?function Sze(n){var e=n.iconName,r=n.children,s=n.attributes,i=n.symbol,o=!0===i?"".concat(n.prefix,"-").concat(kt.cssPrefix,"-").concat(e):i;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Pt(Pt({},s),{},{id:o}),children:r}]}]}(Ue):function Mze(n){var t=n.children,e=n.main,r=n.mask,s=n.attributes,i=n.styles,o=n.transform;if(EV(o)&&e.found&&!r.found){var h={x:e.width/e.height/2,y:.5};s.style=eP(Pt(Pt({},i),{},{"transform-origin":"".concat(h.x+o.x/16,"em ").concat(h.y+o.y/16,"em")}))}return[{tag:"svg",attributes:s,children:t}]}(Ue)}function i1e(n){var t=n.content,e=n.width,r=n.height,s=n.transform,i=n.title,o=n.extra,c=n.watchable,u=void 0!==c&&c,h=Pt(Pt(Pt({},o.attributes),i?{title:i}:{}),{},{class:o.classes.join(" ")});u&&(h[D5]="");var g=Pt({},o.styles);EV(s)&&(g.transform=function eze(n){var t=n.transform,e=n.width,s=n.height,i=void 0===s?16:s,o=n.startCentered,c=void 0!==o&&o,u="";return u+=c&&Rne?"translate(".concat(t.x/16-(void 0===e?16:e)/2,"em, ").concat(t.y/16-i/2,"em) "):c?"translate(calc(-50% + ".concat(t.x/16,"em), calc(-50% + ").concat(t.y/16,"em)) "):"translate(".concat(t.x/16,"em, ").concat(t.y/16,"em) "),(u+="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "))+"rotate(".concat(t.rotate,"deg) ")}({transform:s,startCentered:!0,width:e,height:r}),g["-webkit-transform"]=g.transform);var m=eP(g);m.length>0&&(h.style=m);var E=[];return E.push({tag:"span",attributes:h,children:[t]}),i&&E.push({tag:"span",attributes:{class:"sr-only"},children:[i]}),E}function Pze(n){var t=n.content,e=n.title,r=n.extra,s=Pt(Pt(Pt({},r.attributes),e?{title:e}:{}),{},{class:r.classes.join(" ")}),i=eP(r.styles);i.length>0&&(s.style=i);var o=[];return o.push({tag:"span",attributes:s,children:[t]}),e&&o.push({tag:"span",attributes:{class:"sr-only"},children:[e]}),o}var xV=V3.styles;function kV(n){var t=n[0],e=n[1],i=hV(n.slice(4),1)[0];return{found:!0,width:t,height:e,icon:Array.isArray(i)?{tag:"g",attributes:{class:"".concat(kt.cssPrefix,"-").concat("duotone-group")},children:[{tag:"path",attributes:{class:"".concat(kt.cssPrefix,"-").concat("secondary"),fill:"currentColor",d:i[0]}},{tag:"path",attributes:{class:"".concat(kt.cssPrefix,"-").concat("primary"),fill:"currentColor",d:i[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:i}}}}var Tze={found:!1,width:512,height:512};function LV(n,t){var e=t;return"fa"===t&&null!==kt.styleDefault&&(t=d8()),new Promise(function(r,s){if(v6("missingIconAbstract"),"fa"===e){var o=t1e(n)||{};n=o.iconName||n,t=o.prefix||t}if(n&&t&&xV[t]&&xV[t][n])return r(kV(xV[t][n]));(function wze(n,t){!Hne&&!kt.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(t,'" is missing.'))})(n,t),r(Pt(Pt({},Tze),{},{icon:kt.showMissingIcons&&n&&v6("missingIconAbstract")||{}}))})}var o1e=function(){},RV=kt.measurePerformance&&ZS&&ZS.mark&&ZS.measure?ZS:{mark:o1e,measure:o1e},jm='FA "6.2.1"',DV_begin=function(t){return RV.mark("".concat(jm," ").concat(t," begins")),function(){return function(t){RV.mark("".concat(jm," ").concat(t," ends")),RV.measure("".concat(jm," ").concat(t),"".concat(jm," ").concat(t," begins"),"".concat(jm," ").concat(t," ends"))}(t)}},cP=function(){};function c1e(n){return"string"==typeof(n.getAttribute?n.getAttribute(D5):null)}function Ize(n){return Nr.createElementNS("http://www.w3.org/2000/svg",n)}function xze(n){return Nr.createElement(n)}function l1e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.ceFn,r=void 0===e?"svg"===n.tag?Ize:xze:e;if("string"==typeof n)return Nr.createTextNode(n);var s=r(n.tag);Object.keys(n.attributes||[]).forEach(function(o){s.setAttribute(o,n.attributes[o])});var i=n.children||[];return i.forEach(function(o){s.appendChild(l1e(o,{ceFn:r}))}),s}var lP={replace:function(t){var e=t[0];if(e.parentNode)if(t[1].forEach(function(s){e.parentNode.insertBefore(l1e(s),e)}),null===e.getAttribute(D5)&&kt.keepOriginalSource){var r=Nr.createComment(function kze(n){var t=" ".concat(n.outerHTML," ");return"".concat(t,"Font Awesome fontawesome.com ")}(e));e.parentNode.replaceChild(r,e)}else e.remove()},nest:function(t){var e=t[0],r=t[1];if(~yV(e).indexOf(kt.replacementClass))return lP.replace(t);var s=new RegExp("".concat(kt.cssPrefix,"-.*"));if(delete r[0].attributes.id,r[0].attributes.class){var i=r[0].attributes.class.split(" ").reduce(function(c,u){return u===kt.replacementClass||u.match(s)?c.toSvg.push(u):c.toNode.push(u),c},{toNode:[],toSvg:[]});r[0].attributes.class=i.toSvg.join(" "),0===i.toNode.length?e.removeAttribute("class"):e.setAttribute("class",i.toNode.join(" "))}var o=r.map(function(c){return Wm(c)}).join("\n");e.setAttribute(D5,""),e.innerHTML=o}};function u1e(n){n()}function f1e(n,t){var e="function"==typeof t?t:cP;if(0===n.length)e();else{var r=u1e;"async"===kt.mutateApproach&&(r=f8.requestAnimationFrame||u1e),r(function(){var s=function Nze(){return!0===kt.autoReplaceSvg?lP.replace:lP[kt.autoReplaceSvg]||lP.replace}(),i=DV_begin("mutate");n.map(s),i(),e()})}}var zV=!1;function h1e(){zV=!0}function VV(){zV=!1}var uP=null;function d1e(n){if(Lne&&kt.observeMutations){var t=n.treeCallback,e=void 0===t?cP:t,r=n.nodeCallback,s=void 0===r?cP:r,i=n.pseudoElementsCallback,o=void 0===i?cP:i,c=n.observeMutationsRoot,u=void 0===c?Nr:c;uP=new Lne(function(h){if(!zV){var g=d8();zh(h).forEach(function(m){if("childList"===m.type&&m.addedNodes.length>0&&!c1e(m.addedNodes[0])&&(kt.searchPseudoElements&&o(m.target),e(m.target)),"attributes"===m.type&&m.target.parentNode&&kt.searchPseudoElements&&o(m.target.parentNode),"attributes"===m.type&&c1e(m.target)&&~GDe.indexOf(m.attributeName))if("class"===m.attributeName&&function bze(n){var t=n.getAttribute?n.getAttribute(_V):null,e=n.getAttribute?n.getAttribute(vV):null;return t&&e}(m.target)){var E=oP(yV(m.target)),k=E.iconName;m.target.setAttribute(_V,E.prefix||g),k&&m.target.setAttribute(vV,k)}else(function Aze(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(kt.replacementClass)})(m.target)&&s(m.target)})}}),g6&&uP.observe(u,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function Rze(n){var t=n.getAttribute("style"),e=[];return t&&(e=t.split(";").reduce(function(r,s){var i=s.split(":"),o=i[0],c=i.slice(1);return o&&c.length>0&&(r[o]=c.join(":").trim()),r},{})),e}function Dze(n){var t=n.getAttribute("data-prefix"),e=n.getAttribute("data-icon"),r=void 0!==n.innerText?n.innerText.trim():"",s=oP(yV(n));return s.prefix||(s.prefix=d8()),t&&e&&(s.prefix=t,s.iconName=e),s.iconName&&s.prefix||(s.prefix&&r.length>0&&(s.iconName=function dze(n,t){return(Kne[n]||{})[t]}(s.prefix,n.innerText)||OV(s.prefix,PV(n.innerText))),!s.iconName&&kt.autoFetchSvg&&n.firstChild&&n.firstChild.nodeType===Node.TEXT_NODE&&(s.iconName=n.firstChild.data)),s}function zze(n){var t=zh(n.attributes).reduce(function(s,i){return"class"!==s.name&&"style"!==s.name&&(s[i.name]=i.value),s},{}),e=n.getAttribute("title"),r=n.getAttribute("data-fa-title-id");return kt.autoA11y&&(e?t["aria-labelledby"]="".concat(kt.replacementClass,"-title-").concat(r||qm()):(t["aria-hidden"]="true",t.focusable="false")),t}function p1e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},e=Dze(n),r=e.iconName,s=e.prefix,i=e.rest,o=zze(n),c=AV("parseNodeAttributes",{},n),u=t.styleParser?Rze(n):[];return Pt({iconName:r,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:s,transform:G4,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:i,styles:u,attributes:o}},c)}var Hze=V3.styles;function g1e(n){var t="nest"===kt.autoReplaceSvg?p1e(n,{styleParser:!1}):p1e(n);return~t.extra.classes.indexOf(Fne)?v6("generateLayersText",n,t):v6("generateSvgReplacementMutation",n,t)}var p8=new Set;function m1e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!g6)return Promise.resolve();var e=Nr.documentElement.classList,r=function(m){return e.add("".concat(Vne,"-").concat(m))},s=function(m){return e.remove("".concat(Vne,"-").concat(m))},i=kt.autoFetchSvg?p8:CV.map(function(g){return"fa-".concat(g)}).concat(Object.keys(Hze));i.includes("fa")||i.push("fa");var o=[".".concat(Fne,":not([").concat(D5,"])")].concat(i.map(function(g){return".".concat(g,":not([").concat(D5,"])")})).join(", ");if(0===o.length)return Promise.resolve();var c=[];try{c=zh(n.querySelectorAll(o))}catch{}if(!(c.length>0))return Promise.resolve();r("pending"),s("complete");var u=DV_begin("onTree"),h=c.reduce(function(g,m){try{var E=g1e(m);E&&g.push(E)}catch(O){Hne||"MissingIcon"===O.name&&console.error(O)}return g},[]);return new Promise(function(g,m){Promise.all(h).then(function(E){f1e(E,function(){r("active"),r("complete"),s("pending"),"function"==typeof t&&t(),u(),g()})}).catch(function(E){u(),m(E)})})}function Fze(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;g1e(n).then(function(e){e&&f1e([e],t)})}function Bze(n){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:NV(t||{}),s=e.mask;return s&&(s=(s||{}).icon?s:NV(s||{})),n(r,Pt(Pt({},e),{},{mask:s}))}}CV.map(function(n){p8.add("fa-".concat(n))}),Object.keys(Hm[Ir]).map(p8.add.bind(p8)),Object.keys(Hm[gs]).map(p8.add.bind(p8)),p8=zm(p8);var $ze=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.transform,s=void 0===r?G4:r,i=e.symbol,o=void 0!==i&&i,c=e.mask,u=void 0===c?null:c,h=e.maskId,g=void 0===h?null:h,m=e.title,E=void 0===m?null:m,O=e.titleId,k=void 0===O?null:O,U=e.classes,j=void 0===U?[]:U,oe=e.attributes,Ee=void 0===oe?{}:oe,ne=e.styles,ke=void 0===ne?{}:ne;if(t){var Ue=t.prefix,et=t.iconName,Bt=t.icon;return aP(Pt({type:"icon"},t),function(){return H5("beforeDOMElementCreation",{iconDefinition:t,params:e}),kt.autoA11y&&(E?Ee["aria-labelledby"]="".concat(kt.replacementClass,"-title-").concat(k||qm()):(Ee["aria-hidden"]="true",Ee.focusable="false")),IV({icons:{main:kV(Bt),mask:u?kV(u.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Ue,iconName:et,transform:Pt(Pt({},G4),s),symbol:o,title:E,maskId:g,titleId:k,extra:{attributes:Ee,styles:ke,classes:j}})})}},Uze={mixout:function(){return{icon:Bze($ze)}},hooks:function(){return{mutationObserverCallbacks:function(e){return e.treeCallback=m1e,e.nodeCallback=Fze,e}}},provides:function(t){t.i2svg=function(e){var r=e.node,i=e.callback;return m1e(void 0===r?Nr:r,void 0===i?function(){}:i)},t.generateSvgReplacementMutation=function(e,r){var s=r.iconName,i=r.title,o=r.titleId,c=r.prefix,u=r.transform,h=r.symbol,g=r.mask,m=r.maskId,E=r.extra;return new Promise(function(O,k){Promise.all([LV(s,c),g.iconName?LV(g.iconName,g.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(U){var j=hV(U,2);O([e,IV({icons:{main:j[0],mask:j[1]},prefix:c,iconName:s,transform:u,symbol:h,maskId:m,title:i,titleId:o,extra:E,watchable:!0})])}).catch(k)})},t.generateAbstractIcon=function(e){var h,r=e.children,s=e.attributes,i=e.main,o=e.transform,u=eP(e.styles);return u.length>0&&(s.style=u),EV(o)&&(h=v6("generateAbstractTransformGrouping",{main:i,transform:o,containerWidth:i.width,iconWidth:i.width})),r.push(h||i.icon),{children:r,attributes:s}}}},Gze={mixout:function(){return{layer:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.classes,i=void 0===s?[]:s;return aP({type:"layer"},function(){H5("beforeDOMElementCreation",{assembler:e,params:r});var o=[];return e(function(c){Array.isArray(c)?c.map(function(u){o=o.concat(u.abstract)}):o=o.concat(c.abstract)}),[{tag:"span",attributes:{class:["".concat(kt.cssPrefix,"-layers")].concat(zm(i)).join(" ")},children:o}]})}}}},qze={mixout:function(){return{counter:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.title,i=void 0===s?null:s,o=r.classes,c=void 0===o?[]:o,u=r.attributes,h=void 0===u?{}:u,g=r.styles,m=void 0===g?{}:g;return aP({type:"counter",content:e},function(){return H5("beforeDOMElementCreation",{content:e,params:r}),Pze({content:e.toString(),title:i,extra:{attributes:h,styles:m,classes:["".concat(kt.cssPrefix,"-layers-counter")].concat(zm(c))}})})}}}},Wze={mixout:function(){return{text:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.transform,i=void 0===s?G4:s,o=r.title,c=void 0===o?null:o,u=r.classes,h=void 0===u?[]:u,g=r.attributes,m=void 0===g?{}:g,E=r.styles,O=void 0===E?{}:E;return aP({type:"text",content:e},function(){return H5("beforeDOMElementCreation",{content:e,params:r}),i1e({content:e,transform:Pt(Pt({},G4),i),title:c,extra:{attributes:m,styles:O,classes:["".concat(kt.cssPrefix,"-layers-text")].concat(zm(h))}})})}}},provides:function(t){t.generateLayersText=function(e,r){var s=r.title,i=r.transform,o=r.extra,c=null,u=null;if(Rne){var h=parseInt(getComputedStyle(e).fontSize,10),g=e.getBoundingClientRect();c=g.width/h,u=g.height/h}return kt.autoA11y&&!s&&(o.attributes["aria-hidden"]="true"),Promise.resolve([e,i1e({content:e.innerHTML,width:c,height:u,transform:i,title:s,extra:o,watchable:!0})])}}},jze=new RegExp('"',"ug"),_1e=[1105920,1112319];function v1e(n,t){var e="".concat("data-fa-pseudo-element-pending").concat(t.replace(":","-"));return new Promise(function(r,s){if(null!==n.getAttribute(e))return r();var o=zh(n.children).filter(function(Bt){return Bt.getAttribute(mV)===t})[0],c=f8.getComputedStyle(n,t),u=c.getPropertyValue("font-family").match(BDe),h=c.getPropertyValue("font-weight"),g=c.getPropertyValue("content");if(o&&!u)return n.removeChild(o),r();if(u&&"none"!==g&&""!==g){var m=c.getPropertyValue("content"),E=~["Sharp"].indexOf(u[2])?gs:Ir,O=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(u[2])?Fm[E][u[2].toLowerCase()]:$De[E][h],k=function Zze(n){var t=n.replace(jze,""),e=function aze(n,t){var s,e=n.length,r=n.charCodeAt(t);return r>=55296&&r<=56319&&e>t+1&&(s=n.charCodeAt(t+1))>=56320&&s<=57343?1024*(r-55296)+s-56320+65536:r}(t,0),r=e>=_1e[0]&&e<=_1e[1],s=2===t.length&&t[0]===t[1];return{value:PV(s?t[0]:t),isSecondary:r||s}}(m),U=k.value,j=k.isSecondary,oe=u[0].startsWith("FontAwesome"),Ee=OV(O,U),ne=Ee;if(oe){var ke=function pze(n){var t=Qne[n],e=OV("fas",n);return t||(e?{prefix:"fas",iconName:e}:null)||{prefix:null,iconName:null}}(U);ke.iconName&&ke.prefix&&(Ee=ke.iconName,O=ke.prefix)}if(!Ee||j||o&&o.getAttribute(_V)===O&&o.getAttribute(vV)===ne)r();else{n.setAttribute(e,ne),o&&n.removeChild(o);var Ue=function Vze(){return{iconName:null,title:null,titleId:null,prefix:null,transform:G4,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),et=Ue.extra;et.attributes[mV]=t,LV(Ee,O).then(function(Bt){var B1=IV(Pt(Pt({},Ue),{},{icons:{main:Bt,mask:{prefix:null,iconName:null,rest:[]}},prefix:O,iconName:ne,extra:et,watchable:!0})),x1=Nr.createElement("svg");"::before"===t?n.insertBefore(x1,n.firstChild):n.appendChild(x1),x1.outerHTML=B1.map(function(bn){return Wm(bn)}).join("\n"),n.removeAttribute(e),r()}).catch(s)}}else r()})}function Yze(n){return Promise.all([v1e(n,"::before"),v1e(n,"::after")])}function Kze(n){return!(n.parentNode===document.head||~VDe.indexOf(n.tagName.toUpperCase())||n.getAttribute(mV)||n.parentNode&&"svg"===n.parentNode.tagName)}function C1e(n){if(g6)return new Promise(function(t,e){var r=zh(n.querySelectorAll("*")).filter(Kze).map(Yze),s=DV_begin("searchPseudoElements");h1e(),Promise.all(r).then(function(){s(),VV(),t()}).catch(function(){s(),VV(),e()})})}var y1e=!1,E1e=function(t){return t.toLowerCase().split(" ").reduce(function(r,s){var i=s.toLowerCase().split("-"),o=i[0],c=i.slice(1).join("-");if(o&&"h"===c)return r.flipX=!0,r;if(o&&"v"===c)return r.flipY=!0,r;if(c=parseFloat(c),isNaN(c))return r;switch(o){case"grow":r.size=r.size+c;break;case"shrink":r.size=r.size-c;break;case"left":r.x=r.x-c;break;case"right":r.x=r.x+c;break;case"up":r.y=r.y-c;break;case"down":r.y=r.y+c;break;case"rotate":r.rotate=r.rotate+c}return r},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},HV={x:0,y:0,width:"100%",height:"100%"};function M1e(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n.attributes&&(n.attributes.fill||t)&&(n.attributes.fill="black"),n}function eVe(n){return"g"===n.tag?n.children:[n]}var tVe={hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-mask"),i=s?oP(s.split(" ").map(function(o){return o.trim()})):{prefix:null,iconName:null,rest:[]};return i.prefix||(i.prefix=d8()),e.mask=i,e.maskId=r.getAttribute("data-fa-mask-id"),e}}},provides:function(t){t.generateAbstractMask=function(e){var r=e.children,s=e.attributes,i=e.main,o=e.mask,c=e.maskId,g=i.icon,E=o.icon,O=function JDe(n){var t=n.transform,r=n.iconWidth,s={transform:"translate(".concat(n.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),o="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),c="rotate(".concat(t.rotate," 0 0)");return{outer:s,inner:{transform:"".concat(i," ").concat(o," ").concat(c)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}({transform:e.transform,containerWidth:o.width,iconWidth:i.width}),k={tag:"rect",attributes:Pt(Pt({},HV),{},{fill:"white"})},U=g.children?{children:g.children.map(M1e)}:{},j={tag:"g",attributes:Pt({},O.inner),children:[M1e(Pt({tag:g.tag,attributes:Pt(Pt({},g.attributes),O.path)},U))]},oe={tag:"g",attributes:Pt({},O.outer),children:[j]},Ee="mask-".concat(c||qm()),ne="clip-".concat(c||qm()),ke={tag:"mask",attributes:Pt(Pt({},HV),{},{id:Ee,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[k,oe]},Ue={tag:"defs",children:[{tag:"clipPath",attributes:{id:ne},children:eVe(E)},ke]};return r.push(Ue,{tag:"rect",attributes:Pt({fill:"currentColor","clip-path":"url(#".concat(ne,")"),mask:"url(#".concat(Ee,")")},HV)}),{children:r,attributes:s}}}};!function _ze(n,t){var e=t.mixoutsTo;r1e=n,Hh={},Object.keys(Fh).forEach(function(r){-1===mze.indexOf(r)&&delete Fh[r]}),r1e.forEach(function(r){var s=r.mixout?r.mixout():{};if(Object.keys(s).forEach(function(o){"function"==typeof s[o]&&(e[o]=s[o]),"object"===WS(s[o])&&Object.keys(s[o]).forEach(function(c){e[o]||(e[o]={}),e[o][c]=s[o][c]})}),r.hooks){var i=r.hooks();Object.keys(i).forEach(function(o){Hh[o]||(Hh[o]=[]),Hh[o].push(i[o])})}r.provides&&r.provides(Fh)})}([nze,Uze,Gze,qze,Wze,{hooks:function(){return{mutationObserverCallbacks:function(e){return e.pseudoElementsCallback=C1e,e}}},provides:function(t){t.pseudoElements2svg=function(e){var r=e.node;kt.searchPseudoElements&&C1e(void 0===r?Nr:r)}}},{mixout:function(){return{dom:{unwatch:function(){h1e(),y1e=!0}}}},hooks:function(){return{bootstrap:function(){d1e(AV("mutationObserverCallbacks",{}))},noAuto:function(){!function Lze(){!uP||uP.disconnect()}()},watch:function(e){var r=e.observeMutationsRoot;y1e?VV():d1e(AV("mutationObserverCallbacks",{observeMutationsRoot:r}))}}}},{mixout:function(){return{parse:{transform:function(e){return E1e(e)}}}},hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-transform");return s&&(e.transform=E1e(s)),e}}},provides:function(t){t.generateAbstractTransformGrouping=function(e){var r=e.main,s=e.transform,o=e.iconWidth,c={transform:"translate(".concat(e.containerWidth/2," 256)")},u="translate(".concat(32*s.x,", ").concat(32*s.y,") "),h="scale(".concat(s.size/16*(s.flipX?-1:1),", ").concat(s.size/16*(s.flipY?-1:1),") "),g="rotate(".concat(s.rotate," 0 0)"),O={outer:c,inner:{transform:"".concat(u," ").concat(h," ").concat(g)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:Pt({},O.outer),children:[{tag:"g",attributes:Pt({},O.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:Pt(Pt({},r.icon.attributes),O.path)}]}]}}}},tVe,{provides:function(t){var e=!1;f8.matchMedia&&(e=f8.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){var r=[],s={fill:"currentColor"},i={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};r.push({tag:"path",attributes:Pt(Pt({},s),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=Pt(Pt({},i),{},{attributeName:"opacity"}),c={tag:"circle",attributes:Pt(Pt({},s),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||c.children.push({tag:"animate",attributes:Pt(Pt({},i),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Pt(Pt({},o),{},{values:"1;0;1;1;0;1;"})}),r.push(c),r.push({tag:"path",attributes:Pt(Pt({},s),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:Pt(Pt({},o),{},{values:"1;0;0;0;0;1;"})}]}),e||r.push({tag:"path",attributes:Pt(Pt({},s),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Pt(Pt({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:r}}}},{hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-symbol");return e.symbol=null!==s&&(""===s||s),e}}}}],{mixoutsTo:sc});var iVe=sc.parse,oVe=sc.icon;const aVe=["*"],uVe=n=>{const t={"fa-spin":n.spin,"fa-pulse":n.pulse,"fa-fw":n.fixedWidth,"fa-border":n.border,"fa-inverse":n.inverse,"fa-layers-counter":n.counter,"fa-flip-horizontal":"horizontal"===n.flip||"both"===n.flip,"fa-flip-vertical":"vertical"===n.flip||"both"===n.flip,[`fa-${n.size}`]:null!==n.size,[`fa-rotate-${n.rotate}`]:null!==n.rotate,[`fa-pull-${n.pull}`]:null!==n.pull,[`fa-stack-${n.stackItemSize}`]:null!=n.stackItemSize};return Object.keys(t).map(e=>t[e]?e:null).filter(e=>e)};let dVe=(()=>{class n{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),pVe=(()=>{class n{constructor(){this.definitions={}}addIcons(...e){for(const r of e){r.prefix in this.definitions||(this.definitions[r.prefix]={}),this.definitions[r.prefix][r.iconName]=r;for(const s of r.icon[2])"string"==typeof s&&(this.definitions[r.prefix][s]=r)}}addIconPacks(...e){for(const r of e){const s=Object.keys(r).map(i=>r[i]);this.addIcons(...s)}}getIconDefinition(e,r){return e in this.definitions&&r in this.definitions[e]?this.definitions[e][r]:null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),gVe=(()=>{class n{constructor(){this.stackItemSize="1x"}ngOnChanges(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=qt({type:n,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[h2]}),n})(),mVe=(()=>{class n{constructor(e,r){this.renderer=e,this.elementRef=r}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${e.size.currentValue}`),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${e.size.previousValue}`))}}return n.\u0275fac=function(e){return new(e||n)(Q(No),Q(y2))},n.\u0275cmp=ct({type:n,selectors:[["fa-stack"]],inputs:{size:"size"},features:[h2],ngContentSelectors:aVe,decls:1,vars:0,template:function(e,r){1&e&&(function GB(n){const t=Re()[16][6];if(!t.projection){const r=t.projection=Ol(n?n.length:1,null),s=r.slice();let i=t.child;for(;null!==i;){const o=n?U4e(i,n):0;null!==o&&(s[o]?s[o].projectionNext=i:r[o]=i,s[o]=i),i=i.next}}}(),function qB(n,t=0,e){const r=Re(),s=Jn(),i=O0(s,22+n,16,null,e||null);null===i.projection&&(i.projection=t),V9(),64!=(64&i.flags)&&function pO(n,t,e){CC(t[11],0,t,e,fC(n,e,t),gC(e.parent||t[6],e,t))}(s,r,i)}(0))},encapsulation:2}),n})(),F5=(()=>{class n{constructor(e,r,s,i,o){this.sanitizer=e,this.config=r,this.iconLibrary=s,this.stackItem=i,this.classes=[],null!=o&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(e){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let r=null;if(r=this.icon??this.config.fallbackIcon,e){const s=this.findIconDefinition(r);if(null!=s){const i=this.buildParams();this.renderIcon(s,i)}}}render(){this.ngOnChanges({})}findIconDefinition(e){const r=((n,t)=>(n=>void 0!==n.prefix&&void 0!==n.iconName)(n)?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:t,iconName:n}:void 0)(e,this.config.defaultPrefix);return"icon"in r?r:this.iconLibrary.getIconDefinition(r.prefix,r.iconName)??((n=>{throw new Error(`Could not find icon with iconName=${n.iconName} and prefix=${n.prefix} in the icon library.`)})(r),null)}buildParams(){const e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},r="string"==typeof this.transform?iVe.transform(this.transform):this.transform;return{title:this.title,transform:r,classes:[...uVe(e),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(e,r){const s=oVe(e,r);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return n.\u0275fac=function(e){return new(e||n)(Q(hq),Q(dVe),Q(pVe),Q(gVe,8),Q(mVe,8))},n.\u0275cmp=ct({type:n,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,r){2&e&&(pb("innerHTML",r.renderedIconHTML,gu),z("title",r.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[h2],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),_Ve=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({}),n})();var UV={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},Tre={prefix:"fas",iconName:"flag",icon:[448,512,[127988,61725],"f024","M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"]},ose={prefix:"fas",iconName:"repeat",icon:[512,512,[128257],"f363","M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"]},sH={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"]},hoe={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336c44.2 0 80-35.8 80-80s-35.8-80-80-80s-80 35.8-80 80s35.8 80 80 80z"]},hH={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"]},Moe={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},$ae={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"]},bH={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},Pce={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C87.5 32 35.1 48.6 9 59.9c-5.6 2.4-9 8-9 14V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V73.9c0-6.1-3.4-11.6-9-14C540.9 48.6 488.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class Qce{static toComparableObjectSet(t){const e=[];return t.forEach(r=>{e.some(s=>s.equals(r))||e.push(r)}),e}static toComparableSet(t){const e=[];return t.forEach(r=>{e.some(s=>tc(s,r))||e.push(r)}),e}}class bt{constructor(t){this.values=void 0===t?[]:Qce.toComparableSet(t)}equals(t){if(t.size()!==this.size())return!1;for(const e of this)if(!1===t.contains(e))return!1;return!0}toString(){let t="";for(const e of this)t+=null==e?"null, ":e.toString()+", ";return"["+t.slice(0,-2)+"]"}add(t){return!this.contains(t)&&(this.values.push(t),!0)}remove(t){for(let e=0;e<this.values.length;e++)if(tc(this.values[e],t))return this.values.splice(e,1),!0;return!1}addAll(t){for(const e of t)this.add(e)}union(t){const e=new bt(this.toList());return e.addAll(t),e}contains(t){for(const e of this.values)if(tc(e,t))return!0;return!1}size(){return this.values.length}toList(){const t=[];for(const e of this)t.push(e);return t}getAnyElement(){return this.size()>0?y.of(this.values[0]):y.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(t){const e=[];for(const r of this.values)e.push(t(r));return new bt(e)}flatMap(t){const e=new bt;for(const r of this)e.addAll(t(r));return e}filter(t){const e=new bt;for(const r of this)t(r)&&e.add(r);return e}findAnyCommonElement(t){for(const e of t)if(this.contains(e))return y.of(e);return y.empty()}intersection(t){const e=new bt;for(const r of t)this.contains(r)&&e.add(r);return e}[Symbol.iterator](){return this.values.values()}}class jn{constructor(t=[],e=!1){this.map=t,this.isImmutable=e}static from(t){const e=Object.keys(t),r=new jn;for(const s of e)r.set(s,t[s]);return r}makeImmutable(){this.isImmutable=!0}get(t){for(const e of this.map)if(tc(e.key,t))return y.of(e.value);return y.empty()}getAnyPair(){return this.size()>0?y.of(this.map[0]):y.empty()}forEach(t){for(const e of this.map)t(e)}putAll(t){this.checkImmutability("putAll");for(const e of t.map)this.put(e.key,e.value)}checkImmutability(t){if(this.isImmutable)throw new Error("Cannot call "+t+" on immutable map!")}put(t,e){this.checkImmutability("put");for(const r of this.map)if(tc(r.key,t)){const s=r.value;return r.value=e,y.of(s)}return this.map.push({key:t,value:e}),y.empty()}containsKey(t){return this.map.some(e=>tc(e.key,t))}size(){return this.map.length}listKeys(){return this.map.map(t=>t.key)}getKeySet(){return new bt(this.listKeys())}filter(t){const e=new jn;for(const r of this.map)t(r.key,r.value)&&e.set(r.key,r.value);return e}replace(t,e){if(this.checkImmutability("replace"),this.get(t).isAbsent())throw new Error("No Value to replace for key "+t.toString()+"!");return this.put(t,e),e}set(t,e){if(this.checkImmutability("set"),this.containsKey(t))throw new Error("Key "+t.toString()+" already exist in Map!");this.map.push({key:t,value:e})}delete(t){this.checkImmutability("delete");for(let e=0;e<this.map.length;e++)if(tc(this.map[e].key,t)){const s=this.map[e].value,i=this.map.slice(0,e),o=this.map.slice(e+1);return this.map=i.concat(o),s}throw new Error('No Value to delete for key "'+t.toString()+'"!')}getCopy(){const t=new this.constructor;for(const e of this.listKeys())t.set(e,this.get(e).get());return t}equals(t){const e=this.getKeySet(),r=t.getKeySet();if(!1===e.equals(r))return!1;for(const s of e){const i=this.get(s).get(),o=t.get(s);if(We(o.isPresent(),"value is absent in a map even though its key is present!"),!1===tc(i,o.get()))return!1}return!0}}class Jm extends jn{reverse(){const t=new Jm;for(const e of this.listKeys()){const r=this.get(e).get();if(t.containsKey(r))t.get(r).get().add(e);else{const s=new bt;s.add(e),t.set(r,s)}}return t}}class D2{constructor(t,e,r){var s=this;this.userDAO=t,this.userService=e,this.connectedUserService=r,this.userSubscription=new k1,this.currentGame=y.empty(),this.currentGameRS=new $te(1),this.currentGameObs=this.currentGameRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(function(){var i=I(function*(o){yield s.onUserUpdate(o)});return function(o){return i.apply(this,arguments)}}())}onUserUpdate(t){var e=this;return I(function*(){if(t===R5.NOT_CONNECTED)e.userSubscription.unsubscribe(),e.currentGame=y.empty(),e.currentGameRS.next(y.empty());else{e.userSubscription=e.userService.observeUserOnServer(t.id,s=>{We(s.isPresent(),"Observing part service expected user to already have a document!");const i=s.get();e.onCurrentGameUpdate(i.currentGame)});const r=yield e.userDAO.read(t.id);e.currentGame=y.ofNullable(r.get().currentGame),e.currentGameRS.next(e.currentGame)}})()}onCurrentGameUpdate(t){const e=this.currentGame,r=null==t&&e.isAbsent(),s=null!=t&&e.equalsValue(t);!1===r&&!1===s&&(this.currentGame=y.ofNullable(t),this.currentGameRS.next(this.currentGame))}updateCurrentGame(t){if(We(this.connectedUserService.user.isPresent(),"Should not call updateCurrentGame when not connected"),this.currentGame.isPresent()){const r={...this.currentGame.get(),...t};return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:r})}{const r=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const s of r)We(null!=t[s],"field "+s+" should be set before updating currentGame");return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:t})}}removeCurrentGame(){return We(this.connectedUserService.user.isPresent(),"Should not call removeCurrentGame when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:null})}subscribeToCurrentGame(t){return this.currentGameObs.subscribe(t)}canUserCreate(){if(this.currentGame.isAbsent())return R.SUCCESS;{const t=D2.roleToMessage.get(this.currentGame.get().role).get()();return R.failure(t)}}canUserJoin(t,e){if(this.currentGame.isAbsent()||this.currentGame.get().id===t)return R.SUCCESS;if(e&&"Observer"===this.currentGame.get().role)return R.SUCCESS;{const r=D2.roleToMessage.get(this.currentGame.get().role).get()();return R.failure(r)}}getCurrentGame(){return new Promise(t=>{let e=new k1;e=this.currentGameObs.subscribe(r=>{t(r),e.unsubscribe()})})}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function V3t(n,t){if(1&n&&(dn(0),Ce(1,31),pn()),2&n){const e=C(2);T(1),S1(e.currentGame.get().typeGame)(null==e.currentGame.get().opponent?null:e.currentGame.get().opponent.name),N1(1)}}function H3t(n,t){if(1&n&&(dn(0),Ce(1,33),pn()),2&n){const e=C(3);T(1),S1(e.currentGame.get().typeGame)(null==e.currentGame.get().opponent?null:e.currentGame.get().opponent.name),N1(1)}}function F3t(n,t){if(1&n&&(dn(0),Ce(1,34),pn()),2&n){const e=C(3);T(1),S1(e.currentGame.get().typeGame),N1(1)}}function B3t(n,t){if(1&n&&(x(0,H3t,2,2,"ng-container",27),x(1,F3t,2,1,"ng-template",null,32,qn)),2&n){const e=Hn(2);w("ngIf",C(2).currentGame.get().opponent)("ngIfElse",e)}}function $3t(n,t){if(1&n){const e=Ae();b(0,"a",29),ee("click",function(){return de(e),le(C().navigateToPart())}),x(1,V3t,2,2,"ng-container",27),x(2,B3t,3,2,"ng-template",null,30,qn),A()}if(2&n){const e=Hn(3),r=C();T(1),w("ngIf","Observer"===r.currentGame.get().role||"Candidate"===r.currentGame.get().role)("ngIfElse",e)}}function U3t(n,t){if(1&n&&(dn(0),X(1,"fa-icon",35),pn()),2&n){const e=C();T(1),w("icon",e.faSpinner)}}function G3t(n,t){if(1&n){const e=Ae();dn(0),b(1,"div",10)(2,"a",37),wt(3),A(),b(4,"div",13)(5,"a",38),Ce(6,39),A(),b(7,"a",40),ee("click",function(){return de(e),le(C(2).logout())}),Ce(8,41),A()()(),pn()}if(2&n){const e=C(2);T(3),c1(e.username.get())}}D2.roleToMessage=new jn([{key:"Candidate",value:Lm.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:Lm.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:Lm.YOU_ARE_ALREADY_CREATING},{key:"Player",value:Lm.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:Lm.YOU_ARE_ALREADY_OBSERVING}]),D2.\u0275fac=function(t){return new(t||D2)(ze(oV),ze(Rh),ze(Is))},D2.\u0275prov=nt({token:D2,factory:D2.\u0275fac,providedIn:"root"});const q3t=function(){return["/register"]},W3t=function(){return["/login"]};function j3t(n,t){1&n&&(b(0,"div",42)(1,"a",43)(2,"strong"),Ce(3,44),A()(),b(4,"a",45),Ce(5,46),A()()),2&n&&(T(1),w("routerLink",er(2,q3t)),T(3),w("routerLink",er(3,W3t)))}function Z3t(n,t){if(1&n&&(x(0,G3t,9,1,"ng-container",27),x(1,j3t,6,4,"ng-template",null,36,qn)),2&n){const e=Hn(2);w("ngIf",C().username.isPresent())("ngIfElse",e)}}const Jce=function(){return["/"]},Y3t=function(){return["/play"]},K3t=function(){return["/lobby"]},X3t=function(){return["/local"]},Q3t=function(){return["/tutorial"]},J3t=function(){return["/settings"]};let e4t=(()=>{class n{constructor(e,r,s,i){this.router=e,this.connectedUserService=r,this.currentGameService=s,this.userService=i,this.loading=!0,this.username=y.empty(),this.faCog=hoe,this.faSpinner=$ae,this.showMenu=!1,this.currentGame=y.empty()}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(e=>{this.loading=!1,this.username=e.username.isPresent()?e.username:e.email}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(e=>{this.currentGame=e})}logout(){var e=this;return I(function*(){yield e.connectedUserService.disconnect(),yield e.router.navigate(["/"])})()}navigateToPart(){var e=this;return I(function*(){return e.router.navigate(["/play",e.currentGame.get().typeGame,e.currentGame.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(Xn),Q(Is),Q(D2),Q(Rh))},n.\u0275cmp=ct({type:n,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E,O,k,U;return t=$localize`Home`,e=$localize`Play online`,r=$localize`Create a game`,s=$localize`Join a game`,i=$localize`Play offline`,o=$localize`Create a game`,c=$localize`Learn the rules`,u=$localize`Settings`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,g=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,E=$localize`Account`,O=$localize`Log out`,k=$localize`Register`,U=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],e,[1,"navbar-dropdown"],r,s,["id","playOffline",1,"navbar-link"],i,["id","playLocally",1,"navbar-item",3,"routerLink"],o,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","currentGameLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",u,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","currentGameLink",1,"navbar-item",3,"click"],["activeUser",""],h,["waitingForOpponent",""],g,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","account","routerLink","/account",1,"navbar-item"],E,["id","logout",1,"navbar-item",3,"click"],O,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],k,["id","login",1,"button","is-light",3,"routerLink"],U]},template:function(e,r){if(1&e&&(b(0,"nav",0)(1,"div",1)(2,"a",2),X(3,"img",3),A(),b(4,"a",4),ee("click",function(){return r.showMenu=!r.showMenu}),X(5,"span",5)(6,"span",5)(7,"span",5),A()(),b(8,"div",6),ee("click",function(){return r.showMenu=!r.showMenu}),b(9,"div",7)(10,"a",8),Ce(11,9),A(),b(12,"div",10)(13,"a",11),Ce(14,12),A(),b(15,"div",13)(16,"a",2),Ce(17,14),A(),b(18,"a",2),Ce(19,15),A()()(),b(20,"div",10)(21,"a",16),Ce(22,17),A(),b(23,"div",13)(24,"a",18),Ce(25,19),A(),b(26,"a",20),Ce(27,21),A()()()(),b(28,"div",22),x(29,$3t,4,2,"a",23),b(30,"a",24),X(31,"fa-icon",25),A(),b(32,"div",26),x(33,U3t,2,1,"ng-container",27),x(34,Z3t,3,2,"ng-template",null,28,qn),A()()()()),2&e){const s=Hn(35);T(2),w("routerLink",er(13,Jce)),T(2),w("ngClass",r.showMenu?"is-active":""),T(4),w("ngClass",r.showMenu?"is-active":""),T(2),w("routerLink",er(14,Jce)),T(6),w("routerLink",er(15,Y3t)),T(2),w("routerLink",er(16,K3t)),T(6),w("routerLink",er(17,X3t)),T(2),w("routerLink",er(18,Q3t)),T(3),w("ngIf",r.currentGame.isPresent()),T(1),w("routerLink",er(19,J3t)),T(1),w("icon",r.faCog),T(2),w("ngIf",r.loading)("ngIfElse",s)}},dependencies:[hn,Kt,ju,F5],encapsulation:2}),n})(),t4t=(()=>{class n{constructor(e,r){this._themeService=e,this._errorLoggerService=r,this.faTwitter=Cne,this.faFacebook=hne,this.faGithub=vne}}return n.\u0275fac=function(e){return new(e||n)(Q(qS),Q(Ns))},n.\u0275cmp=ct({type:n,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(e,r){1&e&&(X(0,"app-header"),b(1,"main",0),X(2,"router-outlet"),A(),b(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),ga(7,3),X(8,"strong"),ma(),A(),wt(9," \xa0 "),b(10,"a",4),X(11,"fa-icon",5),A(),wt(12,"\xa0 "),b(13,"a",6),X(14,"fa-icon",5),A(),wt(15,"\xa0 "),b(16,"a",7),X(17,"fa-icon",5),A()()()()),2&e&&(T(11),w("icon",r.faGithub),T(3),w("icon",r.faTwitter),T(3),w("icon",r.faFacebook))},dependencies:[cN,F5,e4t],encapsulation:2}),n})();class oo{}class gn{constructor(t){this.x=t}static of(t){switch(t){case 0:return gn.ZERO;case 1:return gn.ONE;case 2:return gn.TWO;default:return We(3===t,"Invalid Apagos Coord "+t),gn.THREE}}equals(t){return this.x===t.x}}gn.encoder=Ye.tuple([Ye.identity()],n=>[n.x],n=>gn.of(n[0])),gn.ZERO=new gn(0),gn.ONE=new gn(1),gn.TWO=new gn(2),gn.THREE=new gn(3);let Bh=(()=>{class n{}return n.PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`,n.CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`,n.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`,n.NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`,n.NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`,n})();class lr extends oo{constructor(t,e,r){super(),this.landing=t,this.piece=e,this.starting=r}static drop(t,e){return ge.getNonNullable(lr.ALL_MOVES.find(s=>s.landing.equals(t)&&s.piece.equalsValue(e)&&s.starting.equals(y.empty())))}static transfer(t,e){if(t.x<=e.x)return ve.failure(Bh.PIECE_SHOULD_MOVE_DOWNWARD());const r=ge.getNonNullable(lr.ALL_MOVES.find(s=>s.landing.equals(e)&&s.piece.equals(y.empty())&&s.starting.equals(y.of(t))));return ve.success(r)}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(t){return!1!==this.starting.equals(t.starting)&&!1!==this.landing.equals(t.landing)&&this.piece.equals(t.piece)}}lr.ALL_MOVES=[new lr(gn.ZERO,y.of(B.ZERO),y.empty()),new lr(gn.ONE,y.of(B.ZERO),y.empty()),new lr(gn.TWO,y.of(B.ZERO),y.empty()),new lr(gn.THREE,y.of(B.ZERO),y.empty()),new lr(gn.ZERO,y.of(B.ONE),y.empty()),new lr(gn.ONE,y.of(B.ONE),y.empty()),new lr(gn.TWO,y.of(B.ONE),y.empty()),new lr(gn.THREE,y.of(B.ONE),y.empty()),new lr(gn.TWO,y.empty(),y.of(gn.THREE)),new lr(gn.ONE,y.empty(),y.of(gn.THREE)),new lr(gn.ZERO,y.empty(),y.of(gn.THREE)),new lr(gn.ONE,y.empty(),y.of(gn.TWO)),new lr(gn.ZERO,y.empty(),y.of(gn.TWO)),new lr(gn.ZERO,y.empty(),y.of(gn.ONE))],lr.encoder=Ye.tuple([gn.encoder,y.getEncoder(B.encoder),y.getEncoder(gn.encoder)],n=>[n.landing,n.piece,n.starting],n=>new lr(n[0],n[1],n[2]));class OP{constructor(t){this.turn=t}getCurrentPlayer(){return B.ofTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?B.ZERO:B.ONE}}class Je{static mapBiArray(t,e){const r=[];let s=0;for(;s<t.length;){r[s]=[];let i=0;for(;i<t[s].length;)r[s][i]=e(t[s][i]),i++;s++}return r}static create3DTable(t,e,r,s){const i=[];for(let o=0;o<t;o++)i.push(Je.createTable(e,r,s));return i}static createTable(t,e,r){const s=[];for(let i=0;i<e;i++)s.push(Je.createArray(t,r));return s}static createArray(t,e){const r=[];for(let s=0;s<t;s++)r.push(e);return r}static copyBiArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=Je.copyImmutableArray(t[r]),r++;return e}static copyImmutableArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=t[r],r++;return e}static sortByDescending(t,e){t.sort((r,s)=>{const i=e(r),o=e(s);return i<o?1:i>o?-1:0})}static compareArray(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===tc(t[r],e[r]))return!1;return!0}static compareTable(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===Je.compareArray(t[r],e[r]))return!1;return!0}static isPrefix(t,e){return!(t.length>e.length)&&Je.compareArray(t,e.slice(0,t.length))}static range(t){const e=[];for(let r=0;r<t;r++)e.push(r);return e}static smallerFirst(t,e){return t-e}}class e3e{constructor(){this.content=new jn}get(t){const e=this.content.get(t.y);return e.isAbsent()?y.empty():e.get().get(t.x)}set(t,e){const r=this.content.get(t.y);let s;r.isPresent()?s=r.get():(s=new jn,this.content.set(t.y,s)),s.set(t.x,e)}[Symbol.iterator](){const t=[],e=this.content.getKeySet().toList();e.sort(Je.smallerFirst);for(const r of e){const s=this.content.get(r).get(),i=s.getKeySet().toList();i.sort(Je.smallerFirst);for(const o of i){const c=s.get(o).get();t.push({x:o,y:r,content:c})}}return t.values()}}class e_{constructor(t){this.containing=t}static from(t,e,r){if(t+e>r)return ve.failure("invalid starting space");const s=new jn([{key:B.ZERO,value:t},{key:B.ONE,value:e},{key:ue.NONE,value:r}]);s.makeImmutable();const i=new e_(s);return ve.success(i)}isFull(){return this.count(B.ZERO)+this.count(B.ONE)>=this.count(ue.NONE)}count(t){return this.containing.get(t).get()}addPiece(t){let e=this.count(B.ZERO),r=this.count(B.ONE);const s=this.count(ue.NONE);return t===B.ZERO?e++:r++,e_.from(e,r,s).get()}substractPiece(t){let e=this.count(B.ZERO),r=this.count(B.ONE);const s=this.count(ue.NONE);return t===B.ZERO?e--:r--,e_.from(e,r,s).get()}getDominatingPlayer(){const t=this.count(B.ZERO),e=this.count(B.ONE);return t>e?B.ZERO:e>t?B.ONE:ue.NONE}equals(t){return this.containing.equals(t.containing)}}let g8=(()=>{class n extends OP{constructor(e,r,s){super(e),this.board=r,this.remaining=s,this.remaining.makeImmutable()}static getInitialState(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(e,r,s,i){const o=[];for(let u=0;u<4;u++){const E=e_.from(r[0][u],r[1][u],r[2][u]).get();o.push(E)}const c=new jn;return c.set(B.ZERO,s),c.set(B.ONE,i),new n(e,o,c)}getPieceAt(e){return this.board[e.x]}updateAt(e,r){const s=[];for(let o=0;o<4;o++)s.push(e.x===o?r:this.board[o]);const i=this.getRemainingCopy();return new n(this.turn,s,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&Je.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}return n.PIECES_PER_PLAYER=10,n})();class te{constructor(t,e,r){this.title=t,this.instruction=e,this.state=r,this.previousMove=y.empty()}static fromMove(t,e,r,s,i,o){return new n4t(t,e,r,s,i,o)}static forClick(t,e,r,s,i,o){return new s4t(t,e,r,s,i,o)}static anyMove(t,e,r,s,i){return new r4t(t,e,r,s,i)}static fromPredicate(t,e,r,s,i,o){return new i4t(t,e,r,s,i,o)}static informational(t,e,r){return new o4t(t,e,r)}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(t){return this.previousMove=y.of(t),this}}class bP extends te{constructor(t,e,r,s){super(t,e,r),this.successMessage=s}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class n4t extends bP{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedMoves=s,this.failureMessage=o,We(s.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class r4t extends bP{constructor(t,e,r,s,i){super(t,e,r,i),this.solutionMove=s}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class s4t extends bP{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedClicks=s,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class i4t extends bP{constructor(t,e,r,s,i,o){super(t,e,r,o),this.solutionMove=s,this.predicate=i}getSolution(){return this.solutionMove}isPredicate(){return!0}}class o4t extends te{isInformation(){return!0}}class z1{}class t3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,g8.getInitialState()),te.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,g8.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),lr.drop(gn.ZERO,B.ZERO),$localize`Congratulations!`),te.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,g8.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),lr.transfer(gn.TWO,gn.ZERO).get(),(t,e,r)=>t.isDrop()?R.failure($localize`This move is a drop, please do a transfer!`):R.SUCCESS,$localize`Congratulations!`),te.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,g8.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),lr.drop(gn.TWO,B.ONE),(t,e,r)=>t.isDrop()?t.piece.equalsValue(B.ONE)?R.SUCCESS:R.failure($localize`You actively made your opponent win!`):R.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)]}}class Fn{constructor(t){this.value=t}static fromWinner(t){return t.isPlayer()?new Fn(t.getVictoryValue()):new Fn(0)}static of(t,e){return t*=B.ZERO.getScoreModifier(),e*=B.ONE.getScoreModifier(),new Fn(t+e)}toString(){return""+this.value}}Fn.VICTORIES=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];class Ie{constructor(t,e){this.isEndGame=t,this.winner=e}static getVictory(t){return t===B.ZERO?Ie.ZERO_WON:Ie.ONE_WON}static getDefeat(t){return t===B.ZERO?Ie.ONE_WON:Ie.ZERO_WON}toBoardValue(){return this.winner.isPlayer()?new Fn(this.winner.getVictoryValue()):new Fn(0)}}Ie.ZERO_WON=new Ie(!0,B.ZERO),Ie.ONE_WON=new Ie(!0,B.ONE),Ie.DRAW=new Ie(!0,ue.NONE),Ie.ONGOING=new Ie(!1,ue.NONE);var Pn=(()=>(function(n){n.VICTORY="VICTORY",n.PRE_VICTORY="PRE_VICTORY",n.DEFAULT="DEFAULT"}(Pn||(Pn={})),Pn))();let AP=(()=>{class n{}return n.createdNodes=0,n.minimaxTime=0,n})();class mr{constructor(t,e=y.empty(),r=y.empty(),s){if(this.gameState=t,this.mother=e,this.move=r,this.minimaxCreator=s,this.childs=y.empty(),this.hopedValue=new jn,this.ownValue=new jn,this.possibleMoves=new jn,this.ownValue=new jn,null!=s){const i=s.getBoardValue(this);this.ownValue.set(s.name,i),this.hopedValue.set(s.name,i.value)}AP.createdNodes++,J(mr.VERBOSE,"creating "+this.myToString())}static getScoreStatus(t){return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(J(mr.VERBOSE||!1,"VICTORY"),Pn.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(J(mr.VERBOSE||!1,"PRE_VICTORY_MIN"),Pn.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(J(mr.VERBOSE||!1,"PRE_VICTORY_MAX"),Pn.PRE_VICTORY):(J(mr.VERBOSE||!1,"DEFAULT"),Pn.DEFAULT)}findBestMove(t,e,r=!1,s=!0){const i=(new Date).getTime();let o=this.alphaBeta(t,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,e,r,s);for(;o.gameState.turn>this.gameState.turn+1;)o=o.mother.get(),t--;return AP.minimaxTime+=(new Date).getTime()-i,o.move.get()}alphaBeta(t,e,r,s,i,o){if(t<1)return J(mr.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(s.ruler.getGameStatus(this).isEndGame)return J(mr.VERBOSE||!1,"isLeaf-EndGame("+s.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;const u=this.getPossibleMoves(s);We(u.size()>0,"Minimax "+s.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=y.of([]));const h=this.getBestChilds(u,t,e,r,s,i,o),g=this.getBestChildAmongst(h,i),m=g.hopedValue.get(s.toString()).get();return this.hopedValue.put(s.toString(),m),g}getPossibleMoves(t){const e=this.possibleMoves.get(t.name);if(e.isAbsent()){const r=t.getListMoves(this);return this.possibleMoves.set(t.name,new bt(r)),new bt(r)}return e.get()}getBestChilds(t,e,r,s,i,o,c){let u=[];const h=this.gameState.getCurrentPlayer();let g=h===B.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const m=h===B.ZERO?(E,O)=>E<O:(E,O)=>O<E;for(const E of t){const k=this.getOrCreateChild(E,i).alphaBeta(e-1,r,s,i,o,c),U=k.getHopedValue(i);if(m(U,g)||0===u.length?(g=U,u=[k]):U===g&&u.push(k),c&&m(g,h===B.ZERO?r:s))break;h===B.ZERO?s=Math.min(g,s):r=Math.max(g,r)}return u}getBestChildAmongst(t,e){return e?t[Math.floor(Math.random()*t.length)]:t[0]}getOrCreateChild(t,e){let r=this.getSonByMove(t);if(r.isAbsent()){const s=e.ruler.isLegal(t,this.gameState),i=t.toString();We(s.isSuccess(),'The minimax "'+e.name+'" has proposed an illegal move ('+i+"), refusal reason: "+s.getReasonOr("")+" this should not happen.");const o=e.ruler.applyLegalMove(t,this.gameState,s.get());r=y.of(new mr(o,y.of(this),y.of(t),e)),this.childs.get().push(r.get())}return r.get()}getSonByMove(t){We(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const e of this.childs.get())if(e.move.isPresent()&&e.move.equalsValue(t))return y.of(e);return y.empty()}getHopedValue(t){return this.hopedValue.get(t.name).get()}getOwnValue(t){const e=this.ownValue.get(t.name);if(e.isAbsent()){const r=t.getBoardValue(this);return this.ownValue.set(t.name,r),r}return e.get()}myToString(){let t="",e=this;if(e.mother.isAbsent())return"NodeInitial: "+e.gameState.turn;for(;e.mother.isPresent();)t=(e.move.isAbsent()?" ":" > "+e.move.get().toString()+"> ")+e.gameState.turn+" "+t,e=e.mother.get();return"Node: "+t}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let t=this.childs.get().length;for(const e of this.childs.get())t+=e.countDescendants();return t}}mr.VERBOSE=!1,mr.minimaxes=new jn;class I1{constructor(t){this.stateType=t}choose(t,e){J(!1,"Rules.choose: "+e.toString()+" was proposed");const s=this.isLegal(e,t.gameState);if(t.hasMoves()){J(!1,"Rules.choose: current node has moves");const c=t.getSonByMove(e);if(c.isPresent())return We(s.isSuccess(),"Rules.choose: Move is illegal: "+s.getReasonOr("")),J(!1,"Rules.choose: and this proposed move is found in the list, so it is legal"),y.of(c.get())}if(J(!1,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),s.isFailure())return J(!1,"Rules.choose: Move is illegal: "+s.getReason()),y.empty();J(!1,"Rules.choose: Move is legal, let's apply it");const i=this.applyLegalMove(e,t.gameState,s.get()),o=new mr(i,y.of(t),y.of(e));return y.of(o)}getInitialNode(){const t=this.stateType.getInitialState();return new mr(t)}}class C6 extends I1{constructor(){super(g8)}static get(){return C6.singleton.isAbsent()&&(C6.singleton=y.of(new C6)),C6.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalTransfer(t,e)}applyLegalDrop(t,e){const r=e.getRemainingCopy(),s=r.get(t.piece.get()).get();r.put(t.piece.get(),s-1);const i=new g8(e.turn+1,e.board,r),o=t.piece.get(),c=i.getPieceAt(t.landing).addPiece(o);if(t.landing===gn.THREE)return i.updateAt(t.landing,c);{const u=gn.of(t.landing.x+1),h=i.getPieceAt(u);return i.updateAt(t.landing,h).updateAt(u,c)}}applyLegalTransfer(t,e){const r=e.getCurrentPlayer(),s=t.starting.get(),i=e.getPieceAt(s).substractPiece(r),o=e.getPieceAt(t.landing).addPiece(r);let c=e.updateAt(s,i);return c=c.updateAt(t.landing,o),new g8(c.turn+1,c.board,c.remaining)}isLegal(t,e){return e.getPieceAt(t.landing).isFull()?R.failure(Bh.CANNOT_LAND_ON_A_FULL_SQUARE()):t.isDrop()?this.isLegalDrop(t,e):this.isLegalSlideDown(t,e)}isLegalDrop(t,e){return e.getRemaining(t.piece.get())<=0?R.failure(Bh.NO_PIECE_REMAINING_TO_DROP()):R.SUCCESS}isLegalSlideDown(t,e){const r=e.getCurrentPlayer();return 0===e.getPieceAt(t.starting.get()).count(r)?R.failure(Bh.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):R.SUCCESS}getGameStatus(t){const e=t.gameState;for(let s=0;s<4;s++)if(!1===e.getPieceAt(gn.of(s)).isFull())return Ie.ONGOING;const r=e.getPieceAt(gn.THREE).getDominatingPlayer();return We(r.isPlayer(),"winner can only be a player if the game is finished"),Ie.getVictory(r)}}C6.singleton=y.empty();class DH{static gcd(t,e){return 0===e?Math.abs(t):DH.gcd(e,t%e)}}class $t{constructor(t,e){this.x=t,this.y=e}equals(t){return this.x===t.x&&this.y===t.y}isDiagonalOfLength(t){return Math.abs(this.x)===t&&Math.abs(this.y)===t}toMinimalVector(){const t=DH.gcd(this.x,this.y);return new $t(this.x/t,this.y/t)}combine(t,e=1){return new $t(this.x+e*t.x,this.y+e*t.y)}toString(){return"("+this.x+", "+this.y+")"}}class zH extends $t{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class VH{from(t,e){for(const r of this.all)if(r.x===t&&r.y===e)return ve.success(r);return ve.failure("Invalid x and y in direction construction")}fromDelta(t,e){return 0===t&&0===e?ve.failure("Empty delta for direction"):Math.abs(t)===Math.abs(e)||0===t||0===e?this.from(Math.sign(t),Math.sign(e)):ve.failure(a4t.DIRECTION_MUST_BE_LINEAR())}fromMove(t,e){return this.fromDelta(e.x-t.x,e.y-t.y)}fromString(t){switch(t){case"UP":return this.from(0,-1);case"RIGHT":return this.from(1,0);case"DOWN":return this.from(0,1);case"LEFT":return this.from(-1,0);case"UP_LEFT":return this.from(-1,-1);case"UP_RIGHT":return this.from(1,-1);case"DOWN_LEFT":return this.from(-1,1);case"DOWN_RIGHT":return this.from(1,1);default:return ve.failure(`Invalid direction string ${t}`)}}fromInt(t){switch(t){case 0:return this.from(0,-1);case 1:return this.from(1,0);case 2:return this.from(0,1);case 3:return this.from(-1,0);case 4:return this.from(-1,-1);case 5:return this.from(1,-1);case 6:return this.from(-1,1);case 7:return this.from(1,1);default:return ve.failure(`Invalid int direction: ${t}`)}}}class be extends zH{constructor(t,e){super(t,e)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return be.factory.from(-this.x,-this.y).get()}}be.UP=new be(0,-1),be.UP_RIGHT=new be(1,-1),be.RIGHT=new be(1,0),be.DOWN_RIGHT=new be(1,1),be.DOWN=new be(0,1),be.DOWN_LEFT=new be(-1,1),be.LEFT=new be(-1,0),be.UP_LEFT=new be(-1,-1),be.factory=new class extends VH{constructor(){super(...arguments),this.all=[be.UP,be.UP_RIGHT,be.RIGHT,be.DOWN_RIGHT,be.DOWN,be.DOWN_LEFT,be.LEFT,be.UP_LEFT]}},be.DIRECTIONS=be.factory.all,be.DIAGONALS=[be.UP_RIGHT,be.DOWN_RIGHT,be.DOWN_LEFT,be.UP_LEFT],be.ORTHOGONALS=[be.UP,be.RIGHT,be.DOWN,be.LEFT],be.encoder=Ye.fromFunctions(n=>n.toString(),n=>(We("string"==typeof n,"Invalid encoded direction"),be.factory.fromString(n).get()));class Be extends zH{constructor(t,e){super(t,e)}getOpposite(){return Be.factory.from(-this.x,-this.y).get()}rotateClockwise(){return Be.factory.from(-this.y,this.x).get()}}Be.UP=new Be(0,-1),Be.RIGHT=new Be(1,0),Be.DOWN=new Be(0,1),Be.LEFT=new Be(-1,0),Be.factory=new class extends VH{constructor(){super(...arguments),this.all=[Be.UP,Be.RIGHT,Be.DOWN,Be.LEFT]}from(n,t){return 0===n&&-1===t?ve.success(Be.UP):1===n&&0===t?ve.success(Be.RIGHT):0===n&&1===t?ve.success(Be.DOWN):-1===n&&0===t?ve.success(Be.LEFT):ve.failure("Invalid orthogonal from x and y")}},Be.ORTHOGONALS=Be.factory.all,Be.encoder=Ye.fromFunctions(n=>n.toString(),n=>(We("string"==typeof n,"Invalid encoded orthogonal"),Be.factory.fromString(n).get()));let a4t=(()=>{class n{}return n.DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`,n})(),$h=(()=>{class n{}return n.OUT_OF_RANGE=t=>`The coordinate ${t.toString()} is not on the board`,n})();class S extends $t{constructor(t,e){super(t,e)}static getEncoder(t){return Ye.tuple([Ye.identity(),Ye.identity()],e=>[e.x,e.y],e=>t(e[0],e[1]))}getNext(t,e){const r=this.combine(t,e);return new S(r.x,r.y)}getPrevious(t,e){return this.getNext(t,-(e=e??1))}getLeft(t){return new S(this.x+t.y,this.y+-t.x)}getRight(t){return new S(this.x+-t.y,this.y+t.x)}isInRange(t,e){return!(this.x<0||this.y<0||this.x>=t||this.y>=e)}isNotInRange(t,e){return this.x<0||this.y<0||this.x>=t||this.y>=e}getDirectionToward(t){return be.factory.fromMove(this,t)}getOrthogonalDistance(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}getDistance(t){if(!t.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const e=Math.abs(t.x-this.x),r=Math.abs(t.y-this.y);return Math.max(e,r)}isHexagonallyAlignedWith(t){const e=this.x-t.x,r=this.y-t.y;return e!==r&&(e===-r||e*r==0)}isAlignedWith(t){const e=Math.abs(this.x-t.x),r=Math.abs(this.y-t.y);return e===r||e*r==0}getVectorToward(t){return new $t(t.x-this.x,t.y-this.y)}toVector(){return new $t(this.x,this.y)}getCoordsToward(t){if(t.equals(this))return[];if(!t.isAlignedWith(this))return[];const e=this.getDirectionToward(t).get();let r=this.getNext(e,1);const s=[];for(;!1===r.equals(t);)s.push(r),r=r.getNext(e,1);return s}getUntil(t){const e=[],r=this.getDirectionToward(t).get();let s=this.getNext(r);for(;!1===s.equals(t);)e.push(s),s=s.getNext(r);return e}equals(t){return this===t||t.x===this.x&&t.y===this.y}compareTo(t){return t.y===this.y?t.x===this.x?0:this.x<t.x?-1:1:this.y<t.y?-1:1}toSVGPoint(){return this.x+","+this.y}}S.encoder=S.getEncoder((n,t)=>new S(n,t));class n3e{constructor(){this.ArrayUtils=Je}getPlayerClass(t){switch(t){case B.ZERO:return"player0-fill";case B.ONE:return"player1-fill";default:return ge.expectToBe(t,ue.NONE),""}}}let m8=(()=>{class n extends n3e{constructor(e){super(),this.messageDisplayer=e,this.Player=B,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.canPass=!1,this.scores=y.empty(),this.imagesLocation="assets/images/",this.hasAsymmetricBoard=!1,this.rotation=""}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?R.SUCCESS:(this.messageDisplayer.gameMessage(e),R.failure(e))}cancelMoveAttempt(){}pass(){var e=this;return I(function*(){return Ns.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.node.gameState.turn}getCurrentPlayer(){return this.node.gameState.getCurrentPlayer()}getState(){return this.node.gameState}getPreviousState(){return this.node.mother.get().gameState}showLastMove(e){}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Uh=(()=>{class n extends m8{getHexaPointsAtXY(e,r){const s=new S(e,r);return this.getHexaPointsAt(s)}getHexaPointsAt(e){return this.hexaLayout.getHexaPointsAt(e)}getCenterAtXY(e,r){const s=new S(e,r);return this.getCenterAt(s)}getCenterAt(e){return this.hexaLayout.getCenterAt(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class xe{constructor(t){this.value=t}static of(t){switch(t){case xe.ZERO.value:return xe.ZERO;case xe.ONE.value:return xe.ONE;case xe.EMPTY.value:return xe.EMPTY;case xe.UNREACHABLE.value:return xe.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}static ofPlayer(t){return t===B.ZERO?xe.ZERO:(ge.expectToBe(t,B.ONE),xe.ONE)}equals(t){return this===t}is(t){return this.value===t.value}isPlayer(){return this===xe.ZERO||this===xe.ONE}}xe.ZERO=new xe(B.ZERO.value),xe.ONE=new xe(B.ONE.value),xe.EMPTY=new xe(ue.NONE.value),xe.UNREACHABLE=new xe(3);class De extends zH{constructor(t,e){super(t,e)}static getAngle(t){switch(t){case De.UP:return 0;case De.UP_RIGHT:return 60;case De.RIGHT:return 120;case De.DOWN:return 180;case De.DOWN_LEFT:return 240;default:return ge.expectToBe(t,De.LEFT),300}}getOpposite(){return De.factory.from(-this.x,-this.y).get()}}De.UP=new De(0,-1),De.LEFT=new De(-1,0),De.UP_RIGHT=new De(1,-1),De.DOWN_LEFT=new De(-1,1),De.RIGHT=new De(1,0),De.DOWN=new De(0,1),De.factory=new class extends VH{constructor(){super(...arguments),this.all=[De.UP,De.UP_RIGHT,De.RIGHT,De.DOWN,De.DOWN_LEFT,De.LEFT]}},De.encoder=Ye.fromFunctions(n=>{switch(n){case De.UP:return 0;case De.UP_RIGHT:return 1;case De.RIGHT:return 2;case De.DOWN:return 3;case De.DOWN_LEFT:return 4;default:return 5}},n=>(ge.assert(0<=n&&n<=5,"Invalid encoded number for HexaDirection "+n),De.factory.all[n]));class r3e{}class NP extends r3e{constructor(){super(),this.startAngle=.5,this.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],this.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3]}}NP.INSTANCE=new NP;class xs extends r3e{constructor(){super(),this.startAngle=0,this.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],this.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3]}isOnBorder(t,e){return this.isOnTopRightBorder(t,e)||this.isOnRightBorder(t,e)||this.isOnBottomRightBorder(t,e)||this.isOnBottomLeftBorder(t,e)||this.isOnLeftBorder(t,e)||this.isOnTopLeftBorder(t,e)}isOnTopRightBorder(t,e){return 0===e.y}isOnRightBorder(t,e){return e.x===t.width-1}isOnLeftBorder(t,e){return 0===e.x}isOnBottomLeftBorder(t,e){return e.y===t.height-1}isOnTopLeftBorder(t,e){return null!=t.excludedSpaces[e.y]?e.x===t.excludedSpaces[e.y]:e.y===t.excludedSpaces.length&&0===e.x}isOnBottomRightBorder(t,e){return null!=t.excludedSpaces[t.height-1-e.y]?t.width-1-e.x===t.excludedSpaces[t.height-1-e.y]:t.height-1-e.y===t.excludedSpaces.length&&e.x===t.width-1}getAllBorders(t){const e=[];return t.forEachCoord((r,s)=>{this.isOnBorder(t,r)&&e.push(r)}),e}isTopCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnTopRightBorder(t,e)}isTopLeftCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isTopRightCorner(t,e){return this.isOnTopRightBorder(t,e)&&this.isOnRightBorder(t,e)}isBottomCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnBottomRightBorder(t,e)}isBottomLeftCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isBottomRightCorner(t,e){return this.isOnBottomRightBorder(t,e)&&this.isOnRightBorder(t,e)}}xs.INSTANCE=new xs;class Gh{constructor(t,e,r){this.size=t,this.origin=e,this.orientation=r}getCenterAt(t){const e=this.orientation.conversionMatrix;return new S(this.size*(e[0]*t.x+e[1]*t.y)+this.origin.x,this.size*(e[2]*t.x+e[3]*t.y)+this.origin.y)}getCornerOffset(t){const e=2*Math.PI*(this.orientation.startAngle+t)/6;return new S(this.size*Math.cos(e),this.size*Math.sin(e))}getHexaPointsListAt(t){const e=this.getCenterAt(t),r=[];for(let s=0;s<6;s+=1){const i=this.getCornerOffset(s);r.push(new S(e.x+i.x,e.y+i.y))}return r}getHexaPointsAt(t){return this.getHexaPointsListAt(t).map(r=>r.toSVGPoint()).join(" ")}getIsoPoints(t,e){ge.assert(this.orientation===xs.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const r=this.getCenterAt(t),s=this.getCornerOffset(0),i=this.getCornerOffset(1),o=this.getCornerOffset(2),c=this.getCornerOffset(3);return[[new S(r.x+c.x,r.y+c.y),new S(r.x+c.x,r.y+c.y+e),new S(r.x+o.x,r.y+o.y+e),new S(r.x+o.x,r.y+o.y)],[new S(r.x+s.x,r.y+s.y),new S(r.x+s.x,r.y+s.y+e),new S(r.x+i.x,r.y+i.y+e),new S(r.x+o.x,r.y+o.y+e),new S(r.x+o.x,r.y+o.y),new S(r.x+i.x,r.y+i.y)],[new S(r.x+c.x,r.y+c.y),new S(r.x+c.x,r.y+c.y+e),new S(r.x+o.x,r.y+o.y+e),new S(r.x+i.x,r.y+i.y+e),new S(r.x+s.x,r.y+s.y+e),new S(r.x+s.x,r.y+s.y),new S(r.x+i.x,r.y+i.y),new S(r.x+o.x,r.y+o.y)]]}}let Xe=(()=>{class n{}return n.CANNOT_CHOOSE_OPPONENT_PIECE=()=>$localize`You cannot pick a piece of the opponent.`,n.MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`,n.MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`,n.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`,n.CANNOT_SELF_CAPTURE=()=>$localize`You cannot capture your own pieces.`,n.MUST_CHOOSE_PLAYER_PIECE=()=>$localize`You must pick one of your pieces.`,n.CANNOT_PASS=()=>$localize`You cannot pass your turn.`,n.MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`,n.MUST_PASS=()=>$localize`You must pass your turn.`,n.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`,n.MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`,n.SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`,n})();class ic{constructor(t,e){this.ruler=t,this.name=e}toString(){return this.name}}class ks extends ic{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return Fn.fromWinner(e.winner);{const r=this.getMetrics(t);return Fn.of(r[0],r[1])}}}class xr extends OP{constructor(t,e){super(e),this.board=t}getPieceAt(t){if(this.isOnBoard(t))return this.board[t.y][t.x];throw new Error("Accessing coord not on board "+t+".")}tryToGetPieceAt(t){return this.isOnBoard(t)?y.of(this.board[t.y][t.x]):y.empty()}isOnBoard(t){return t.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(t,e){return this.getPieceAt(new S(t,e))}forEachCoord(t){for(const{coord:e,content:r}of this.getCoordsAndContents())t(e,r)}getCoordsAndContents(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new S(r,e);this.isOnBoard(s)&&t.push({coord:s,content:this.getPieceAt(s)})}return t}getCopiedBoard(){return Je.copyBiArray(this.board)}toMap(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[0].length;r++){const s=new S(r,e);t.push({key:s,value:this.getPieceAt(s)})}return t}[Symbol.iterator](){const t=[];for(const e of this.board)t.push(...e);return t.values()}}class _8 extends xr{static getInitialState(){const t=xe.EMPTY,e=xe.UNREACHABLE,r=xe.ZERO,s=xe.ONE;return new _8([[e,e,e,e,s,s,s,s,s],[e,e,e,s,s,s,s,s,s],[e,e,t,t,s,s,s,t,t],[e,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,e],[t,t,r,r,r,t,t,e,e],[r,r,r,r,r,r,e,e,e],[r,r,r,r,r,e,e,e,e]],0)}isInBoard(t){return t.isInRange(9,9)&&this.getPieceAt(t)!==xe.UNREACHABLE}isPiece(t){return this.getPieceAt(t).isPlayer()}getScores(){const t=[14,14];for(let e=0;e<9;e++)for(let r=0;r<9;r++)this.getPieceAtXY(r,e)===xe.ZERO&&(t[1]=t[1]-1),this.getPieceAtXY(r,e)===xe.ONE&&(t[0]=t[0]-1);return t}}class ms extends oo{constructor(t,e){super(),this.coord=new S(t,e)}static getFallibleEncoder(t){return Ye.tuple([S.encoder],e=>[e.coord],e=>t(e[0]).get())}static getEncoder(t){return Ye.tuple([S.encoder],e=>[e.coord],e=>t(e[0]))}equals(t){return this===t||this.coord.equals(t.coord)}}class Yi extends ms{constructor(t,e,r){if(super(t.x,t.y),this.dir=e,this.lastPiece=r,t.isNotInRange(9,9))throw new Error("Coord "+t.toString()+" out of range, invalid move!")}static fromSingleCoord(t,e){try{return ve.success(new Yi(t,e,y.empty()))}catch(r){return ve.failure(r.message)}}static fromDoubleCoord(t,e,r){const s=[t,e];Je.sortByDescending(s,Yi.sortCoord);const i=s[1].getDirectionToward(s[0]).get(),o=De.factory.fromDelta(i.x,i.y);if(o.isFailure())return ve.failure("Invalid direction");const c=o.get();return s[1].getDistance(s[0])>2?ve.failure("Distance between first coord and last coord is too big"):c.equals(r)?Yi.fromSingleCoord(s[1],r):c.getOpposite().equals(r)?Yi.fromSingleCoord(s[0],r):ve.success(new Yi(s[1],r,y.of(s[0])))}static sortCoord(t){return 9*t.y+t.x}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(t){return t.coord.equals(this.coord)&&t.dir.equals(this.dir)&&t.lastPiece.equals(this.lastPiece)}}Yi.encoder=Ye.tuple([S.encoder,De.encoder,y.getEncoder(S.encoder)],n=>[n.coord,n.dir,n.lastPiece],n=>new Yi(n[0],n[1],n[2]));let v8=(()=>{class n{}return n.CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`,n.NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`,n.CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`,n.MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`,n.TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`,n.LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`,n})();class Uo extends I1{constructor(){super(_8)}static get(){return Uo.singleton.isAbsent()&&(Uo.singleton=y.of(new Uo)),Uo.singleton.get()}static isLegal(t,e){const r=this.getFirstPieceValidity(t,e);return r.isFailure()?r.toOtherFallible():t.isSingleCoord()?Uo.isLegalPush(t,e):Uo.isLegalSideStep(t,e)}static getFirstPieceValidity(t,e){const r=e.getPieceAt(t.coord);return!1===e.isPiece(t.coord)?R.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r===xe.ofPlayer(e.getCurrentOpponent())?R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):R.SUCCESS}static isLegalPush(t,e){let r=1,s=t.coord.getNext(t.dir);const i=xe.ofPlayer(e.getCurrentPlayer()),o=xe.EMPTY,c=e.getCopiedBoard();for(c[t.coord.y][t.coord.x]=o;r<=3&&e.isOnBoard(s)&&e.getPieceAt(s)===i;)r++,s=s.getNext(t.dir);return r>3?ve.failure(v8.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===e.isInBoard(s)||(c[s.y][s.x]=i,e.getPieceAt(s)===o)?ve.success(c):Uo.isLegalRealPush(s,t,e,r,c)}static isLegalRealPush(t,e,r,s,i){let o=0;const c=xe.ofPlayer(r.getCurrentOpponent()),u=xe.ofPlayer(r.getCurrentPlayer());for(;o<s&&r.isOnBoard(t)&&r.getPieceAt(t)===c;)o++,t=t.getNext(e.dir);return o>=s?ve.failure(v8.NOT_ENOUGH_PIECE_TO_PUSH()):t.isInRange(9,9)&&(r.getPieceAt(t)===xe.EMPTY&&(i[t.y][t.x]=c),r.getPieceAt(t)===u)?ve.failure(v8.CANNOT_PUSH_YOUR_OWN_PIECES()):ve.success(i)}static isLegalSideStep(t,e){let r=t.lastPiece.get();const s=t.coord.getDirectionToward(r).get();r=r.getNext(s);let i=t.coord;const o=xe.ofPlayer(e.getCurrentPlayer()),c=e.getCopiedBoard();for(;!1===i.equals(r)&&i.isInRange(9,9);){if(e.getPieceAt(i)!==o)return ve.failure(v8.MUST_ONLY_TRANSLATE_YOUR_PIECES());const u=i.getNext(t.dir);if(c[i.y][i.x]=xe.EMPTY,u.isInRange(9,9)){if(e.isPiece(u))return ve.failure(v8.TRANSLATION_IMPOSSIBLE());e.getPieceAt(u)===xe.EMPTY&&(c[u.y][u.x]=o)}i=i.getNext(s)}return ve.success(c)}static getGameStatus(t){const e=t.gameState.getScores();return e[0]>5?Ie.ZERO_WON:e[1]>5?Ie.ONE_WON:Ie.ONGOING}applyLegalMove(t,e,r){return new _8(r,e.turn+1)}isLegal(t,e){return Uo.isLegal(t,e)}getGameStatus(t){return Uo.getGameStatus(t)}}Uo.singleton=y.empty();class c4t extends ks{getListMoves(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<9;i++)for(let o=0;o<9;o++){const c=new S(o,i);if(!1!==r.getPieceAt(c).is(s))for(const u of De.factory.all){const h=Yi.fromSingleCoord(c,u).get();if(this.isAcceptablePush(h,r)){e.push(h);for(const g of De.factory.all)for(let m=1;m<=2&&!g.equals(u);m++){const E=c.getNext(g,m);if(!E.isInRange(9,9))break;{const O=Yi.fromDoubleCoord(c,E,u).get();Uo.isLegal(O,r).isSuccess()&&e.push(O)}}}}}return new bt(e).toList()}isAcceptablePush(t,e){const r=e.getScores(),s=Uo.isLegal(t,e);if(s.isSuccess()){const i=e.getCurrentOpponent().value;return!(new _8(s.get(),e.turn+1).getScores()[i]>r[i])}return!1}getMetrics(t){return t.gameState.getScores()}}const In=xe.EMPTY,Qs=xe.UNREACHABLE,Vc=xe.ZERO,qh=xe.ONE;class s3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,_8.getInitialState()),te.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,_8.getInitialState(),Yi.fromSingleCoord(new S(2,6),De.UP).get(),$localize`Congratulations!`),te.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new _8([[Qs,Qs,Qs,Qs,In,Vc,Vc,qh,qh],[Qs,Qs,Qs,In,In,In,In,In,In],[Qs,Qs,In,Vc,Vc,Vc,qh,Vc,In],[Qs,In,In,In,In,In,In,In,In],[In,In,In,In,Vc,Vc,Vc,qh,qh],[In,In,In,In,In,In,In,In,Qs],[In,In,In,In,Vc,qh,In,Qs,Qs],[In,In,In,Vc,In,In,Qs,Qs,Qs],[In,In,Vc,In,In,Qs,Qs,Qs,Qs]],0),[Yi.fromSingleCoord(new S(4,4),De.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)]}}function l4t(n,t){if(1&n){const e=Ae();H(),b(0,"circle",6),ee("click",function(){de(e);const s=C(2).index,i=C().index;return le(C().onPieceClick(s,i))}),A()}if(2&n){const e=C(2).index,r=C().index,s=C();Le("id","piece_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),z("cx",s.getCenterAtXY(e,r).x)("cy",s.getCenterAtXY(e,r).y)("r",.5*s.SPACE_SIZE)}}function u4t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"polygon",4),ee("click",function(){de(e);const s=C().index,i=C().index;return le(C().onSpaceClick(s,i))}),A(),x(2,l4t,1,6,"circle",5),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();T(1),Le("id","space_",r,"_",i,""),w("ngClass",o.getSquareClasses(r,i)),z("points",o.getHexaPointsAtXY(r,i)),T(1),w("ngIf",o.isPiece(s))}}function f4t(n,t){if(1&n&&(H(),b(0,"g"),x(1,u4t,3,5,"g",3),A()),2&n){const e=t.$implicit,r=C(2);T(1),w("ngIf",r.isBoard(e))}}function h4t(n,t){if(1&n&&(H(),b(0,"g"),x(1,f4t,2,1,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function d4t(n,t){1&n&&(H(),b(0,"marker",7),X(1,"polygon",8),A()),2&n&&p1("id","arrowhead_",t.$implicit.dir.toString(),"")}function p4t(n,t){if(1&n){const e=Ae();H(),b(0,"g"),X(1,"line",9),b(2,"line",10),ee("click",function(){const i=de(e).$implicit;return le(C().chooseDirection(i.dir))}),A(),b(3,"polygon",11),ee("click",function(){const i=de(e).$implicit;return le(C().chooseDirection(i.dir))}),A()()}if(2&n){const e=t.$implicit;T(1),p1("id","line_start_",e.dir.toString(),""),z("x1",e.startCenter.x)("y1",e.startCenter.y)("x2",e.middle.x)("y2",e.middle.y),T(1),p1("id","line_end_",e.dir.toString(),""),z("x1",e.middle.x)("y1",e.middle.y)("x2",e.landingCenter.x)("y2",e.landingCenter.y),T(1),p1("id","direction_",e.dir.toString(),""),z("transform",e.transformation)}}class g4t{constructor(t,e,r,s,i,o){this.startCenter=t,this.middle=e,this.landingCenter=r,this.landing=s,this.dir=i,this.transformation=o}}let m4t=(()=>{class n extends Uh{constructor(e){super(e),this.moveds=[],this.directions=[],this.selecteds=[],this.rules=Uo.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new c4t(this.rules,"Dummy")],this.encoder=Yi.encoder,this.tutorial=(new s3e).tutorial,this.scores=y.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new Gh(this.SPACE_SIZE,new S(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),NP.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=y.of(this.getState().getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(e){e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}showPushingMove(e){const r=this.getPreviousState();let s=e.coord;for(this.moveds=[s],s=s.getNext(e.dir);s.isInRange(9,9)&&r.isPiece(s);)this.moveds.push(s),s=s.getNext(e.dir);s.isInRange(9,9)&&this.moveds.push(s)}showSideStepMove(e){let r=e.lastPiece.get();const s=e.coord.getDirectionToward(r).get();r=r.getNext(s);let i=e.coord;for(;!1===i.equals(r);)this.moveds.push(i),this.moveds.push(i.getNext(e.dir)),i=i.getNext(s)}onPieceClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#piece_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentOpponent();return s.hexaBoard[r][e].is(o)?s.opponentClick(e,r):0===s.selecteds.length?s.firstClick(e,r):1===s.selecteds.length?s.secondClick(e,r):s.thirdClick(e,r)})()}opponentClick(e,r){var s=this;return I(function*(){return(yield s.tryChoosingDirection(e,r)).isSuccess()?R.SUCCESS:s.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(e,r){var s=this;return I(function*(){return s.selecteds=[new S(e,r)],s.showPossibleDirections(),R.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(e){const r=this.getState(),s=xe.ofPlayer(r.getCurrentPlayer()),i=this.selecteds[0],o=this.selecteds[this.selecteds.length-1];for(const c of De.factory.all){let h,u=i.getNext(c,1);if(r.isOnBoard(u)&&r.getPieceAt(u)===s){if(e)continue;if(u=o.getNext(c,1),r.isOnBoard(u)&&r.getPieceAt(u)===s)continue}if(h=e?Yi.fromSingleCoord(i,c).get():Yi.fromDoubleCoord(i,o,c).get(),this.rules.isLegal(h,r).isSuccess()){const m=this.getCenterAt(i),E=this.getCenterAt(u),O=this.getMiddleOfArrow(c,u,E),k=E.x+" "+E.y,U=De.getAngle(c)+150,ne=new g4t(m,O,E,u,c,"rotate("+U+" "+k+") translate("+k+")");this.directions.push(ne)}}}getMiddleOfArrow(e,r,s){const i=r.getPrevious(e),o=this.getCenterAt(i);return new S(o.x+(s.x-o.x)/2,o.y+(s.y-o.y)/2)}isBoard(e){return e!==xe.UNREACHABLE}isPiece(e){return e!==xe.EMPTY}secondClick(e,r){var s=this;return I(function*(){const i=s.selecteds[0],o=new S(e,r);if(o.equals(i))return s.cancelMoveAttempt(),R.SUCCESS;if(!1===o.isHexagonallyAlignedWith(i))return s.cancelMoveAttempt(),s.firstClick(e,r);const c=o.getDistance(i);if(c>2)return s.cancelMove(v8.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const u=i.getDirectionToward(o).get();s.selecteds=[i];for(let h=0;h<c;h++)s.selecteds.push(i.getNext(u,h+1));if(3===s.selecteds.length){const h=s.selecteds[1],g=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[h.y][h.x].is(g))return s.cancelMoveAttempt(),s.firstClick(e,r)}return s.showPossibleDirections(),R.SUCCESS})()}thirdClick(e,r){var s=this;return I(function*(){const i=new S(e,r),o=s.selecteds[0];if(i.equals(o))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return i.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&i.equals(s.selecteds[1])?(s.cancelMoveAttempt(),R.SUCCESS):s.tryExtension(i,o,c)})()}tryExtension(e,r,s){var i=this;return I(function*(){const o=be.factory.fromMove(r,e);if(o.isSuccess()){const u=be.factory.fromMove(s,e);if(o.equals(u)){const h=r.getDistance(e),g=s.getDistance(e);return 2===Math.max(h,g)?(i.selecteds.push(e),Je.sortByDescending(i.selecteds,Yi.sortCoord),i.showPossibleDirections(),R.SUCCESS):i.cancelMove(v8.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=i.cancelMove(v8.LINE_AND_COORD_NOT_ALIGNED());return yield i.firstClick(e.x,e.y),c})()}deselectExtremity(e){var r=this;return I(function*(){return r.selecteds=r.selecteds.slice(e?1:0,e?void 0:-1),r.showPossibleDirections(),R.SUCCESS})()}chooseDirection(e){var r=this;return I(function*(){const s=r.canUserPlay("#direction_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):r._chooseDirection(e)})()}_chooseDirection(e){var r=this;return I(function*(){const s=r.selecteds[0];if(1===r.selecteds.length){const i=Yi.fromSingleCoord(s,e).get();return r.chooseMove(i)}{const o=Yi.fromDoubleCoord(s,r.selecteds[r.selecteds.length-1],e).get();return r.chooseMove(o)}})()}onSpaceClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#space_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.tryChoosingDirection(e,r)})()}tryChoosingDirection(e,r){var s=this;return I(function*(){const i=new S(e,r);for(const o of s.directions)if(o.landing.equals(i))return s._chooseDirection(o.dir);return R.failure("not a direction")})()}getSquareClasses(e,r){const s=new S(e,r),i=[];return this.moveds.some(o=>o.equals(s))&&i.push("moved-fill"),i}getPieceClasses(e,r){const s=new S(e,r),i=B.of(this.hexaBoard[r][e].value),o=[this.getPlayerClass(i)];return this.selecteds.some(c=>c.equals(s))&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-abalone"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,h4t,2,1,"g",1),b(2,"defs"),x(3,d4t,2,1,"marker",2),A(),x(4,p4t,4,12,"g",1),A()),2&e&&(T(1),w("ngForOf",r.hexaBoard),T(2),w("ngForOf",r.directions),T(1),w("ngForOf",r.directions))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class _4t extends ks{getListMoves(t){const e=t.gameState;return lr.ALL_MOVES.filter(function r(s){return C6.get().isLegal(s,e).isSuccess()})}getMetrics(t){const e=t.gameState.board[3].getDominatingPlayer(),r=[0,0];return e.isPlayer()&&(r[e.value]=1),r}}function v4t(n,t){if(1&n&&(H(),X(0,"circle",5)),2&n){const e=t.$implicit,r=C();z("cx",r.getRemainingPieceCx(e))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function C4t(n,t){if(1&n&&(H(),X(0,"circle",6)),2&n){const e=t.$implicit,r=C();z("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(e))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function y4t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",9),ee("click",function(){de(e);const s=C().index,i=C();return le(i.onArrowClick(s,i.PlayerOrNone.ZERO))}),A()}if(2&n){const e=C().index,r=C();p1("id","dropArrow_zero_",e,""),w("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ZERO)),z("points",r.ARROW_COORD)("transform","translate("+r.SPACE_SIZE/2+" "+-r.SPACE_SIZE/2+")")}}function E4t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",9),ee("click",function(){de(e);const s=C().index,i=C();return le(i.onArrowClick(s,i.PlayerOrNone.ONE))}),A()}if(2&n){const e=C().index,r=C();p1("id","dropArrow_one_",e,""),w("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ONE)),z("points",r.ARROW_COORD)("transform","translate(0 "+-r.SPACE_SIZE/2+")")}}function M4t(n,t){if(1&n){const e=Ae();H(),dn(0),b(1,"circle",10),ee("click",function(){de(e);const s=C().index;return le(C().onSquareClick(s))}),A(),pn()}if(2&n){const e=t.$implicit,r=C(),s=r.index,i=r.$implicit,o=C();T(1),J2("id","square_",s,"_piece_",e,"_out_of_",i.count(o.PlayerOrNone.NONE),""),w("ngClass",o.getPieceClasses(s,e,i)),z("cx",o.getCircleCenter(s,e,i).x)("cy",o.getCircleCenter(s,e,i).y)}}function S4t(n,t){if(1&n){const e=Ae();H(),b(0,"g"),x(1,y4t,1,4,"polygon",7),x(2,E4t,1,4,"polygon",7),b(3,"rect",8),ee("click",function(){const i=de(e).index;return le(C().onSquareClick(i))}),A(),x(4,M4t,2,6,"ng-container",4),A()}if(2&n){const e=t.$implicit,r=t.index,s=C();z("transform",s.getBlockTransform(r)),T(1),w("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ZERO)),T(1),w("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ONE)),T(1),p1("id","square_",r,""),w("ngClass",s.getSquareClasses(r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngForOf",s.ArrayUtils.range(e.count(s.PlayerOrNone.NONE)))}}let P4t=(()=>{class n extends m8{constructor(e){super(e),this.PlayerOrNone=ue,this.BOARD_WIDTH=4*this.SPACE_SIZE,this.BOARD_HEIGHT=4.5*this.SPACE_SIZE,this.ARROW_COORD=n.getArrowCoord(),this.PIECES_PER_PLAYER=g8.PIECES_PER_PLAYER,this.selectedPiece=y.empty(),this.leftPiece=y.empty(),this.droppedPiece=y.empty(),this.displayableArrow=[],this.rules=C6.get(),this.node=this.rules.getInitialNode(),this.hasAsymmetricBoard=!0,this.availableMinimaxes=[new _4t(this.rules,"ApagosDummyMinimax")],this.encoder=lr.encoder,this.tutorial=(new t3e).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5),this.updateBoard()}static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}cancelMoveAttempt(){this.selectedPiece=y.empty(),this.showPossibleDrops()}updateBoard(){const e=this.getState();this.board=e.board,this.remainingZero=e.remaining.get(B.ZERO).get(),this.remainingOne=e.remaining.get(B.ONE).get(),this.hideLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=y.empty(),this.leftPiece=y.empty(),this.selectedPiece=y.empty()}showLastMove(e){e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}showLastDrop(e){const r=e.piece.get();let s=e.landing.x;this.movedSquare=[s],3!==e.landing.x&&(s+=1,this.movedSquare.push(s));const o=this.getLowestPlayerPiece(this.board[s],r);this.droppedPiece=y.of({square:s,piece:o})}getLowestPlayerPiece(e,r){const s=e.count(r);return r===B.ZERO?s-1:e.count(ue.NONE)-s}showLastTransfer(e){const r=this.getPreviousState(),s=r.getCurrentPlayer(),i=e.starting.get().x,c=this.getLowestPlayerPiece(r.board[i],s);this.leftPiece=y.of({square:i,piece:c});const u=e.landing.x,g=this.getLowestPlayerPiece(this.board[u],s);this.droppedPiece=y.of({square:u,piece:g})}showPossibleDrops(){this.displayableArrow=[];const e=this.getState();for(let r=0;r<4;r++)!1===e.board[r].isFull()&&(e.remaining.get(B.ZERO).get()>0&&this.displayableArrow.push({x:r,player:B.ZERO}),e.remaining.get(B.ONE).get()>0&&this.displayableArrow.push({x:r,player:B.ONE}))}getCircleCenter(e,r,s){const i=this.SPACE_SIZE/2,o=this.SPACE_SIZE/2;if(1===s.count(ue.NONE))return new S(i,o);const c=s.count(ue.NONE),u=2*r*Math.PI/c-Math.PI/2,h=.3*this.SPACE_SIZE,g=h*Math.cos(u),m=h*Math.sin(u);return new S(i+g,o+m)}canDisplayArrow(e,r){return this.displayableArrow.some(s=>s.x===e&&s.player.equals(r))}getArrowClasses(e,r){return[this.getPlayerClass(r)]}getBlockTransform(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(e){const r=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?r.push("selected-stroke"):this.movedSquare.includes(e)&&r.push("last-move-stroke"),r}onArrowClick(e,r){var s=this;return I(function*(){const o=s.canUserPlay("#dropArrow_"+(r===B.ZERO?"zero":"one")+"_"+e);if(o.isFailure())return s.cancelMove(o.getReason());const c=gn.of(e);if(s.selectedPiece.isPresent()){const u=s.selectedPiece.get().square,h=lr.transfer(gn.of(u),c).get();return s.chooseMove(h)}{const u=lr.drop(c,r);return s.chooseMove(u)}})()}getPieceClasses(e,r,s){const i={square:e,piece:r},o=[];let c=s.count(B.ZERO),u=s.count(B.ONE);if(this.selectedPiece.equalsValue(i))o.push("selected-stroke");else if(this.droppedPiece.equalsValue(i))o.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===r)return o.push("captured-stroke"),o;this.getState().getCurrentOpponent()===B.ZERO?c++:u++}const h=s.count(ue.NONE)-(u+c),g=this.getPieceColor(r,c,h);return""!==g&&o.push(g),o}getPieceColor(e,r,s){return e<r?"player0-fill":e>=r+s?"player1-fill":""}onSquareClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#square_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.selectedPiece.isPresent()&&r.selectedPiece.get().square===e)return r.cancelMoveAttempt(),R.SUCCESS;const i=r.getState().getCurrentPlayer(),o=r.board[e];return o.count(i)<=0?r.cancelMove(Bh.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(r.selectedPiece=y.of({square:e,piece:r.getLowestPlayerPiece(o,i)}),0===r.showAndGetPossibleTranfers().length?r.cancelMove(Bh.NO_POSSIBLE_TRANSFER_REMAINS()):R.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let e=this.selectedPiece.get().square-1;const r=this.getState().getCurrentPlayer();for(;0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:r}),e--;return this.displayableArrow}getRemainingPieceCx(e){return(e+.5)*this.PIECE_RADIUS*1.5}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-apagos"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0)(1,"g"),x(2,v4t,1,3,"circle",1),x(3,C4t,1,3,"circle",2),A(),b(4,"g",3),x(5,S4t,5,8,"g",4),A()()),2&e&&(z("viewBox",-r.STROKE_WIDTH/2+" "+-r.STROKE_WIDTH/2+" "+(r.BOARD_WIDTH+r.STROKE_WIDTH)+" "+(r.BOARD_HEIGHT+r.STROKE_WIDTH)),T(1),z("transform","rotate("+180*r.role.value+" "+r.BOARD_WIDTH/2+" "+r.BOARD_HEIGHT/2+")"),T(1),w("ngForOf",r.ArrayUtils.range(r.remainingOne)),T(1),w("ngForOf",r.ArrayUtils.range(r.remainingZero)),T(2),w("ngForOf",r.board))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),ao=(()=>{class n extends m8{getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class Go extends xr{constructor(t,e,r){super(t,e),this.captured=r}static getInitialState(){const t=Je.createTable(6,2,4);return new Go(t,0,[0,0])}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let HH=(()=>{class n{}return n.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=()=>$localize`You cannot distribute from the opponent's home.`,n.MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`,n.SHOULD_DISTRIBUTE=()=>$localize`You should distribute but you do not.`,n})();class q1 extends I1{constructor(){super(Go)}static get(){return q1.singleton.isAbsent()&&(q1.singleton=y.of(new q1)),q1.singleton.get()}applyLegalMove(t,e,r){J(q1.VERBOSE,{called:"AwaleRules.applyLegalMove",move:t,state:e});const s=t.x,i=e.getCurrentPlayer(),c=e.getCurrentOpponent().value,u=e.getCopiedBoard(),h=q1.distribute(s,c,u),g=h[h.length-1];return g.y===c?new Go(u,e.turn+1,e.captured):this.applyPotentialCapture(i,g,u,e)}applyPotentialCapture(t,e,r,s){const i=s.getCurrentOpponent(),o=[s.captured[0],s.captured[1]],c=q1.captureIfLegal(e.x,e.y,t,r);o[t.value]+=c.capturedSum;const u=c.resultingBoard;if(q1.mustMansoon(t,u)){const h=q1.mansoon(i,u);return o[i.value]+=h.capturedSum,new Go(h.resultingBoard,s.turn+1,o)}return new Go(u,s.turn+1,o)}static mustMansoon(t,e){return q1.isStarving(t,e)&&!1===q1.canDistribute(t.getOpponent(),e)}static mansoon(t,e){const r=Je.copyBiArray(e);let s=0;const i=[[0,0,0,0,0,0],[0,0,0,0,0,0]];let o=0;const c=t.getOpponent().value;do{s+=r[c][o],i[c][o]=r[c][o],r[c][o]=0,o++}while(o<6);return{capturedSum:s,captureMap:i,resultingBoard:r}}static isLegal(t,e){const r=e.getCurrentOpponent(),s=r.value,i=t.x;if(0===e.getPieceAtXY(i,s))return R.failure(HH.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=q1.isStarving(r,e.board),c=!1===q1.doesDistribute(i,s,e.board);return o&&c?R.failure(HH.SHOULD_DISTRIBUTE()):R.SUCCESS}isLegal(t,e){return q1.isLegal(t,e)}static doesDistribute(t,e,r){return 0===e?r[e][t]>5-t:r[e][t]>t}static canDistribute(t,e){for(let r=0;r<6;r++)if(q1.doesDistribute(r,t.getOpponent().value,e))return!0;return!1}static isStarving(t,e){let r=0;const s=t.getOpponent().value;do{if(e[s][r++]>0)return!1}while(r<6);return!0}static distribute(t,e,r){const s=t,i=e;let o=r[e][t];const c=[];for(r[e][t]=0;o>0;)0===e?5===t?e=1:t++:0===t?e=0:t--,(t!==s||e!==i)&&(r[e][t]+=1,c.push(new S(t,e)),o--);return c}static capture(t,e,r,s){const i=Je.copyBiArray(s);We(e!==r.getOpponent().value,"AwaleRules.capture cannot capture the players house");let c=i[e][t],u=0;const h=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(c<2||c>3)return{capturedSum:0,captureMap:h,resultingBoard:i};let g=-1,m=-1;r===B.ONE&&(g=1,m=6);do{h[e][t]=c,u+=c,i[e][t]=0,c=i[e][t+=g]}while(t!==m&&(2===c||3===c));return{capturedSum:u,captureMap:h,resultingBoard:i}}static captureIfLegal(t,e,r,s){const i=Je.copyBiArray(s),o=q1.capture(t,e,r,s),c=q1.isStarving(r.getOpponent(),o.resultingBoard);return o.capturedSum>0&&c?{capturedSum:0,resultingBoard:i,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:o}static getGameStatus(t){const e=t.gameState;return e.captured[0]>24?Ie.ZERO_WON:e.captured[1]>24?Ie.ONE_WON:24===e.captured[0]&&24===e.captured[1]?Ie.DRAW:Ie.ONGOING}getGameStatus(t){return q1.getGameStatus(t)}}q1.VERBOSE=!1,q1.singleton=y.empty();class v1 extends oo{constructor(t){super(),this.x=t}static of(t){switch(t){case 0:return v1.ZERO;case 1:return v1.ONE;case 2:return v1.TWO;case 3:return v1.THREE;case 4:return v1.FOUR;default:return ge.expectToBe(t,5,"Invalid x for AwaleMove: "+t),v1.FIVE}}equals(t){return t===this||t.x===this.x}toString(){return"AwaleMove("+this.x+")"}}v1.ZERO=new v1(0),v1.ONE=new v1(1),v1.TWO=new v1(2),v1.THREE=new v1(3),v1.FOUR=new v1(4),v1.FIVE=new v1(5),v1.encoder=Ye.tuple([Ye.identity()],n=>[n.x],n=>v1.of(n[0]));class T4t extends ks{getListMoves(t){const e=[],r=t.gameState,i=(r.turn+1)%2;let o,c=0;do{0!==r.getPieceAtXY(c,i)&&(o=v1.of(c),q1.isLegal(o,r).isSuccess()&&(o=v1.of(c),e.push(o))),c++}while(c<6);return this.orderMoves(t,e)}orderMoves(t,e){const r=t.gameState.getCurrentPlayer(),s=t.gameState.getCurrentOpponent().value,i=r.value;return Je.sortByDescending(e,o=>{const c=t.gameState.getCopiedBoard(),u=c[s][o.x],h=q1.distribute(o.x,s,c),g=h[h.length-1];let m,E=0;return g.y===s?(m=0,u<=6&&(E=10)):m=q1.captureIfLegal(g.x,i,r,c).capturedSum,100*m+E-u}),e}getMetrics(t){const e=t.gameState.getCapturedCopy();return[e[0],e[1]]}}class i3e extends z1{constructor(){super(...arguments),this.tutorial=[te.anyMove($localize`Sowing`,$localize`Awal is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown. The spaces in Awal are called the houses.
         As you're playing Dark, the 6 houses on the bottom are yours.<br/><br>
         Click on any of the bottom houses to sow the seeds it contains: they will be sown clockwise, one seed per house.`,Go.getInitialState(),v1.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),te.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new Go([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),v1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),te.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new Go([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[v1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),te.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new Go([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[v1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),te.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new Go([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[v1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),te.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new Go([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[v1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),te.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        You're playing Dark. Try it.`,new Go([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[v1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),te.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new Go([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),v1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),te.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new Go([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),v1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}}function w4t(n,t){if(1&n){const e=Ae();H(),b(0,"text",7),ee("click",function(){de(e);const s=C().index,i=C().index;return le(C().onClick(s,i))}),wt(1),A()}if(2&n){const e=C().index,r=C().index,s=C();Le("id","captured_",e,"_",r,""),z("x",65+100*e)("y",81+120*r)("transform",s.getPieceRotation(e,r)),T(1),Bi(" ",-s.captured[r][e]," ")}}function O4t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"circle",4),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),A(),b(2,"text",5),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),wt(3),A(),x(4,w4t,2,6,"text",6),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Le("id","click_",r,"_",s,""),w("ngClass",i.getSpaceClasses(r,s)),z("cx",i.getPieceCx(r))("cy",i.getPieceCy(s)),T(1),Le("id","number_",r,"__",s,""),z("x",50+100*r)("y",66+120*s)("transform",i.getPieceRotation(r,s)),T(1),Bi(" ",e," "),T(1),w("ngIf",i.captured[s][r]>0)}}function b4t(n,t){if(1&n&&(H(),b(0,"g"),x(1,O4t,5,12,"g",2),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let A4t=(()=>{class n extends ao{constructor(e){super(e),this.last=y.empty(),this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.hasAsymmetricBoard=!0,this.scores=y.of([0,0]),this.rules=q1.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new T4t(this.rules,"AwaleMinimax")],this.encoder=v1.encoder,this.tutorial=(new i3e).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.scores=y.of(e.getCapturedCopy()),this.hidePreviousMove(),this.board=e.getCopiedBoard(),this.last=y.empty()}hidePreviousMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}showLastMove(e){const r=this.getState().getCurrentPlayer().value;this.last=y.of(new S(e.x,r));const s=this.getPreviousState(),i=Je.copyBiArray(s.board),o=s.getCurrentOpponent().value;this.filledCoords=q1.distribute(e.x,o,i);const c=this.filledCoords[this.filledCoords.length-1];if(c.y!==o){const u=q1.captureIfLegal(c.x,c.y,s.getCurrentPlayer(),i);this.captured=u.captureMap;const h=this.getState().getCurrentPlayer();q1.mustMansoon(h.getOpponent(),u.resultingBoard)&&(this.captured=q1.mansoon(h,u.resultingBoard).captureMap)}}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(r===s.getState().getCurrentPlayer().value)return s.cancelMove(HH.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());s.last=y.empty();const o=v1.of(e);return s.chooseMove(o)})()}getSpaceClasses(e,r){const s=new S(e,r),i="player"+(r+1)%2+"-fill";return this.captured[r][e]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(s)?["moved-stroke","last-move-stroke",i]:this.filledCoords.some(o=>o.equals(s))?["moved-stroke",i]:[i]}getPieceCx(e){return 50+100*e}getPieceCy(e){return 50+120*e}getPieceRotation(e,r){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(r)+")"}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-awale-component"]],features:[l],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),X(1,"rect",1),x(2,b4t,2,1,"g",2),X(3,"line",3),A()),2&e&&(z("transform",r.rotation),T(2),w("ngForOf",r.board))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Pa extends oo{constructor(t,e){super(),this.first=t,this.second=e}static getFallibleEncoder(t){return Ye.tuple([S.encoder,S.encoder],e=>[e.first,e.second],e=>t(e[0],e[1]).get())}static getEncoder(t){return Ye.tuple([S.encoder,S.encoder],e=>[e.first,e.second],e=>t(e[0],e[1]))}getFirst(){return this.first}getSecond(){return this.second}}class Hc extends Pa{constructor(t,e){if(super(t,e),t.equals(e))throw new Error(Xe.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return be.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}equals(t){return this===t||!1!==this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}let IP=(()=>{class n{}return n.LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`,n.THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`,n.SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`,n.MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`,n})();class FH extends Hc{constructor(t,e){if(super(t,e),t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+t.toString()+".");if(e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+e.toString()+".");const r=t.getDirectionToward(e);if(r.isFailure()||r.get().isDiagonal())throw new Error(IP.MOVE_MUST_BE_ORTHOGONAL())}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class qo extends FH{static of(t,e){return new qo(t,e)}static from(t,e){try{const r=new qo(t,e);return ve.success(r)}catch(r){return ve.failure(r.message)}}getMaximalDistance(){return 7}}qo.encoder=Pa.getFallibleEncoder(qo.from);const N4t={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:B.ZERO};class Tn{constructor(t,e){this.owner=t,this.king=e}isKing(){return this.king}getOwner(){return this.owner}}Tn.UNOCCUPIED=new Tn(ue.NONE,!1),Tn.PLAYER_ONE_KING=new Tn(ue.ONE,!0),Tn.INVADERS=new Tn(ue.ZERO,!1),Tn.DEFENDERS=new Tn(ue.ONE,!1);class Y1{constructor(t){this.value=t}}Y1.NONE=new Y1("NONE"),Y1.OPPONENT=new Y1("OPPONENT"),Y1.PLAYER=new Y1("PLAYER");class BH extends xr{isCentralThrone(t){return t.equals(this.getCentralThrone())}getCentralThrone(){const t=(this.board.length-1)/2;return new S(t,t)}getRelativeOwner(t,e){const r=this.getAbsoluteOwner(e);let s;return s=r===ue.NONE?Y1.NONE:t===r?Y1.PLAYER:Y1.OPPONENT,s}getAbsoluteOwner(t){return this.getPieceAt(t).getOwner()}}class H3 extends BH{static getInitialState(){const t=Tn.UNOCCUPIED,e=Tn.INVADERS,r=Tn.DEFENDERS;return new H3([[t,t,t,e,t,t,t],[t,t,t,e,t,t,t],[t,t,t,r,t,t,t],[e,e,r,Tn.PLAYER_ONE_KING,r,e,e],[t,t,t,r,t,t,t],[t,t,t,e,t,t,t],[t,t,t,e,t,t,t]],0)}of(t,e){return new H3(t,e)}}let $H=(()=>{class n extends I1{constructor(e,r,s){super(e),this.config=r,this.generateMove=s}isLegal(e,r){J(n.VERBOSE,{tablutRules_isLegal:{move:e,state:r}});const s=r.getCurrentPlayer(),i=this.getMoveValidity(s,e,r);return i.isFailure()?R.failure(i.getReason()):R.SUCCESS}getMoveValidity(e,r,s){const i=s.getRelativeOwner(e,r.getStart());if(i===Y1.NONE)return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());if(i===Y1.OPPONENT)return R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());if(s.getRelativeOwner(e,r.getEnd())!==Y1.NONE)return R.failure(IP.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(s,r.getEnd())){if(!s.getPieceAt(r.getStart()).isKing())return R.failure(IP.SOLDIERS_CANNOT_SIT_ON_THRONE());if(s.isCentralThrone(r.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return R.failure(IP.THRONE_IS_LEFT_FOR_GOOD())}const c=r.getStart().getDirectionToward(r.getEnd()).get(),u=r.getStart().getOrthogonalDistance(r.getEnd());let h=r.getStart().getNext(c);for(let g=1;g<u;g++){if(s.getPieceAt(h)!==Tn.UNOCCUPIED)return R.failure(Xe.SOMETHING_IN_THE_WAY());h=h.getNext(c)}return R.SUCCESS}isThrone(e,r){return!!this.isExternalThrone(r)||e.isCentralThrone(r)}isExternalThrone(e){const r=this.config.WIDTH-1;return!(0!==e.x&&e.x!==r||0!==e.y&&e.y!==r)}tryCapture(e,r,s,i){const o=r.getNext(s);return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&i.getRelativeOwner(e,o)===Y1.OPPONENT?i.getPieceAt(o).isKing()?this.captureKing(e,r,s,i):this.capturePawn(e,r,s,i):y.empty()}captureKing(e,r,s,i){const o=r.getNext(s),{backCoord:c,back:u,backInRange:h,left:g,leftCoord:m,right:E,rightCoord:O}=this.getSurroundings(o,s,e,i);return!1===h?this.captureKingAgainstTheWall(g,E,o):u===Y1.NONE&&this.isThrone(i,c)?this.captureKingAgainstThrone(c,o,g,E):u===Y1.PLAYER?this.captureKingWithAtLeastASandwich(i,o,g,m,E,O):y.empty()}getSurroundings(e,r,s,i){const o=e.getNext(r),c=o.isInRange(this.config.WIDTH,this.config.WIDTH),u=c?i.getRelativeOwner(s,o):Y1.NONE,h=e.getLeft(r),m=h.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,h):Y1.NONE,E=e.getRight(r),k=E.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,E):Y1.NONE;return{backCoord:o,back:u,backInRange:c,leftCoord:h,left:m,rightCoord:E,right:k}}captureKingAgainstTheWall(e,r,s){let o=e===Y1.PLAYER?1:0;return o+=r===Y1.PLAYER?1:0,2===o&&this.config.BORDER_CAN_SURROUND_KING?(J(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),y.of(s)):y.empty()}captureKingAgainstThrone(e,r,s,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return y.of(r)}else{const c=i===Y1.PLAYER,u=s===Y1.PLAYER||c;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&u)return y.of(r)}return y.empty()}capturePawn(e,r,s,i){const c=r.getNext(s),u=c.getNext(s);let h=Y1.NONE;return u.isInRange(this.config.WIDTH,this.config.WIDTH)&&(h=i.getRelativeOwner(e,u)),h===Y1.NONE?!1===this.isThrone(i,u)?(J(n.VERBOSE||!1,"cannot capture a pawn without an ally; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")cannot capture a pawn without an ally behind"),y.empty()):(J(n.VERBOSE||!1,"pawn captured by 1 opponent and 1 throne; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),y.of(c)):h===Y1.PLAYER?(J(n.VERBOSE||!1,"pawn captured by 2 opponents; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),y.of(c)):(J(n.VERBOSE||!1,"no captures; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),y.empty())}captureKingWithAtLeastASandwich(e,r,s,i,o,c){if(!1===this.kingTouchCentralThrone(e,r)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return y.of(r);const h=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,g=this.isThrone(e,i),m=s===Y1.PLAYER||g&&h,E=this.isThrone(e,c);return m&&(o===Y1.PLAYER||E&&h)?(J(n.VERBOSE||!1,"king captured by 4 invaders"),y.of(r)):y.empty()}kingTouchCentralThrone(e,r){const s=e.getCentralThrone();return r.getOrthogonalDistance(s)<=1}applyLegalMove(e,r,s){J(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:r}});const i=r.turn,o=r.getCopiedBoard(),c=r.getCurrentPlayer(),u=e.getStart(),h=e.getEnd();o[h.y][h.x]=o[u.y][u.x],o[u.y][u.x]=Tn.UNOCCUPIED;for(const g of Be.ORTHOGONALS){const m=this.tryCapture(c,e.getEnd(),g,r);m.isPresent()&&(o[m.get().y][m.get().x]=Tn.UNOCCUPIED)}return r.of(o,i+1)}getGameStatus(e){const s=this.getWinner(e.gameState);return s.isPresent()?Ie.getVictory(s.get()):Ie.ONGOING}getWinner(e){const s=this.getKingCoord(e);if(s.isAbsent())return J(!1,"The king is dead, victory to invader"),y.of(this.getInvader());const i=s.get();return this.isExternalThrone(i)?(J(!1,"The king escape, victory to defender"),y.of(this.getDefender())):this.isPlayerImmobilized(B.ZERO,e)?(J(!1,"Zero has no move, victory to one"),y.of(B.ONE)):this.isPlayerImmobilized(B.ONE,e)?(J(!1,"One has no move, victory to zero"),y.of(B.ZERO)):(J(!1,"no victory"),y.empty())}getKingCoord(e){J(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(let r=0;r<this.config.WIDTH;r++)for(let s=0;s<this.config.WIDTH;s++)if(e.getPieceAtXY(s,r).isKing())return y.of(new S(s,r));return y.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,r){return 0===this.getPlayerListMoves(e,r).length}getPlayerListMoves(e,r){const i=[],o=this.getPlayerListPawns(e,r);J(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:r}});for(const c of o){const u=this.getPossibleDestinations(c,r);for(const h of u){const g=this.generateMove(c,h).get();i.push(g)}}return i}getPlayerListPawns(e,r){const s=[];for(let i=0;i<this.config.WIDTH;i++)for(let o=0;o<this.config.WIDTH;o++){const c=new S(o,i);r.getAbsoluteOwner(c)===e&&s.push(c)}return s}getPossibleDestinations(e,r){const s=[];let i;for(const o of Be.ORTHOGONALS){i=e.getNext(o,1);let c=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===c;)r.getAbsoluteOwner(i)===ue.NONE?this.isExternalThrone(i)?r.getPieceAt(e).isKing()&&s.push(i):r.isCentralThrone(i)?r.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&s.push(i):s.push(i):c=!0,i=i.getNext(o,1)}return s}}return n.VERBOSE=!1,n})();class C8 extends $H{constructor(){super(H3,N4t,qo.from)}static get(){return C8.singleton.isAbsent()&&(C8.singleton=y.of(new C8)),C8.singleton.get()}}C8.singleton=y.empty();class UH extends ao{constructor(t,e,r){super(t),this.VERBOSE=e,this.generateMove=r,this.viewInfo={pieceClasses:[]},this.EMPTY=Tn.UNOCCUPIED,this.capturedCoords=[],this.chosen=y.empty(),this.lastMove=y.empty()}getViewBox(){const t=-this.STROKE_WIDTH,e=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return t+" "+t+" "+e+" "+e}updateBoard(){J(this.VERBOSE,"taflComponent.updateBoard"),this.board=this.getState().getCopiedBoard(),this.capturedCoords=[],this.updateViewInfo(),this.lastMove=this.node.move}showLastMove(t){const e=this.getPreviousState(),r=this.getState().getCurrentOpponent();for(const s of Be.ORTHOGONALS){const i=this.lastMove.get().getEnd().getNext(s,1);if(i.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const c=e.getRelativeOwner(r,i)===Y1.OPPONENT,h=this.getState().getPieceAt(i)===Tn.UNOCCUPIED;c&&h&&this.capturedCoords.push(i)}}}updateViewInfo(){const t=[];this.board=this.getState().getCopiedBoard();for(let e=0;e<this.board.length;e++){const r=[];for(let s=0;s<this.board[0].length;s++){let i=[];i=this.board[e][s].getOwner()===ue.NONE?[""]:this.getPieceClasses(s,e),r.push(i)}t.push(r)}this.viewInfo={pieceClasses:t}}onClick(t,e){var r=this;return I(function*(){J(r.VERBOSE,"TaflComponent.onClick("+t+", "+e+")");const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(t,e);return r.chosen.equalsValue(i)?(r.cancelMoveAttempt(),R.SUCCESS):r.chosen.isAbsent()||r.pieceBelongToCurrentPlayer(i)?r.choosePiece(i):r.chooseDestination(t,e)})()}chooseDestination(t,e){var r=this;return I(function*(){J(r.VERBOSE,"TaflComponent.chooseDestination");const s=r.chosen.get(),i=new S(t,e),o=r.generateMove(s,i);return o.isSuccess()?yield r.chooseMove(o.get()):r.cancelMove(o.getReason())})()}choosePiece(t){return J(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t.y][t.x]===Tn.UNOCCUPIED?this.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(t)?(this.chosen=y.of(t),this.updateViewInfo(),J(this.VERBOSE,"selected piece = ("+t.x+", "+t.y+")"),R.SUCCESS):this.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE())}pieceBelongToCurrentPlayer(t){const e=this.getState(),r=e.getCurrentPlayer();return e.getRelativeOwner(r,t)===Y1.PLAYER}cancelMoveAttempt(){this.chosen=y.empty(),this.updateViewInfo()}isThrone(t,e){const r=this.getState();return this.rules.isThrone(r,new S(t,e))}isCentralThrone(t,e){return this.getState().isCentralThrone(new S(t,e))}getPieceClasses(t,e){const r=[],s=new S(t,e),i=this.getState().getAbsoluteOwner(s);return r.push(this.getPlayerClass(i)),this.chosen.equalsValue(s)&&r.push("selected-stroke"),r}getRectClasses(t,e){const r=[],s=new S(t,e);if(this.capturedCoords.some(i=>i.equals(s)))r.push("captured-fill");else if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();(s.equals(i)||s.equals(o))&&r.push("moved-fill")}return r}getClickables(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new S(r,e);this.isClickable(s)&&t.push(s)}return t}isClickable(t){return this.pieceBelongToCurrentPlayer(t)}isInvader(t,e){return this.board[e][t]===Tn.INVADERS}isKing(t,e){return this.board[e][t].isKing()}}class xP extends ks{getListMoves(t){J(!1,{TaflMinimax_getListMoves:{node:t}});const r=t.gameState,s=r.getCurrentPlayer(),i=this.ruler.getPlayerListMoves(s,r);return this.orderMoves(r,i)}orderMoves(t,e){const r=this.ruler.getKingCoord(t).get();return t.getCurrentPlayer()===this.ruler.config.INVADER?Je.sortByDescending(e,s=>-s.getEnd().getOrthogonalDistance(r)):Je.sortByDescending(e,s=>s.getStart().equals(r)?this.ruler.isExternalThrone(s.getEnd())?2:1:0),e}getMetrics(t){const e=t.gameState,r=this.ruler.getPlayerListPawns(B.ZERO,e).length,s=this.ruler.getPlayerListPawns(B.ONE,e).length;return[r*[1,2][this.ruler.config.INVADER.value],s*[2,1][this.ruler.config.INVADER.value]]}}class kP{constructor(t,e){this.directThreats=t,this.mover=e}equals(t){return t.directThreats.equals(this.directThreats)&&t.mover.equals(this.mover)}}class o3e extends kP{constructor(t,e){super(new bt([t]),e),this.directThreat=t}}class I4t extends bt{constructor(t){if(super(),this.valueMap=[],this.values=[],void 0!==t)for(const e of t)this.add(e)}add(t){const e=this.toFields(t);let r=this.valueMap;for(const i of e[0])void 0===r[i]&&(r[i]=[]),r=r[i];const s=e[1];return void 0===r[s]&&(r[s]=!0,this.values.push(t),!0)}contains(t){const e=this.toFields(t);let r=this.valueMap;for(const i of e[0]){if(void 0===r[i])return!1;r=r[i]}return void 0!==r[e[1]]}[Symbol.iterator](){return this.values.values()}}class kr extends I4t{toFields(t){return[[t.y],t.x]}}class LP extends xP{constructor(t,e){super(t,e),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=Tn.UNOCCUPIED;let i=0;const o=this.getPiecesMap(r),c=this.getThreatMap(r,o),u=this.filterThreatMap(c,r);for(const h of B.PLAYERS)for(const g of o.get(h).get())if(u.get(g).isPresent())i+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=h.getScoreModifier()*this.scoreBySafePiece;let m=0;for(const E of Be.ORTHOGONALS){let O=g.getNext(E,1);for(;O.isInRange(this.width,this.width)&&r.getPieceAt(O)===s;)m++,O=O.getNext(E,1)}i+=m*h.getScoreModifier()}return new Fn(i)}getPiecesMap(t){const e=Tn.UNOCCUPIED,r=[],s=[];for(let o=0;o<this.width;o++)for(let c=0;c<this.width;c++){const u=new S(c,o);t.getPieceAt(u)!==e&&(t.getAbsoluteOwner(u)===B.ZERO?r.push(u):s.push(u))}return new jn([{key:B.ZERO,value:new kr(r)},{key:B.ONE,value:new kr(s)}])}getThreatMap(t,e){const r=new jn;for(const s of B.PLAYERS)for(const i of e.get(s).get()){const o=this.getThreats(i,t);this.isThreatReal(i,t,o)&&r.set(i,new bt(o))}return r}getThreats(t,e){const r=e.getAbsoluteOwner(t);We(r.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const s=r.getOpponent(),i=[];for(const o of Be.ORTHOGONALS){const c=t.getPrevious(o,1);if(this.isAThreat(c,e,s)){const u=[];for(const h of Be.ORTHOGONALS){if(h===o.getOpposite())continue;let g=t.getNext(o,1);for(;g.isInRange(this.width,this.width)&&e.getPieceAt(g)===Tn.UNOCCUPIED;)g=g.getNext(h);g.isInRange(this.width,this.width)&&e.getAbsoluteOwner(g)===s&&!1===t.getNext(o,1).equals(g)&&u.push(g)}i.push(new o3e(c,new kr(u)))}}return i}isAThreat(t,e,r){return!(t.isNotInRange(this.width,this.width)||e.getAbsoluteOwner(t)!==r&&(!this.ruler.isThrone(e,t)||r!==B.ONE&&e.getPieceAt(t)!==Tn.UNOCCUPIED))}isThreatReal(t,e,r){if(0===r.length)return!1;if(e.getPieceAt(t).isKing())return 3===r.length;for(const s of r)if(s.mover.size()>0)return!0;return!1}filterThreatMap(t,e){const r=new jn,s=t.listKeys(),i=s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentPlayer()),o=new kr(s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentOpponent()));for(const c of i){const u=t.get(c).get(),h=[];for(const g of u)if(!1===o.contains(g.directThreat)){const m=[];for(const E of g.mover)!1===o.contains(E)&&m.push(E);m.length>0&&h.push(new o3e(g.directThreat,new kr(m)))}h.length>0&&r.set(c,new bt(h))}for(const c of o){const u=t.get(c).get();r.set(c,u)}return r}}class RP extends LP{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,i=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,r);let o=i.controlScore;o+=i.safeScore*this.getScoreBySafePiece(r);const c=this.getScoreByThreatenedPiece(r);return o+=i.threatenedScore*c,We(i.controlScore<=c,"Control Score should be below "+c+", got "+i.controlScore),We(i.threatenedScore<=16,"Threatened Score should be below 16, got "+i.threatenedScore),We(i.safeScore<=16,"Safe Score should be below 16, got "+i.threatenedScore),new Fn(o)}getControlScoreAndPieceScores(t,e){const r=this.getPiecesMap(e),s=this.getThreatMap(e,r),i=this.filterThreatMap(s,e),o={safeScore:0,threatenedScore:0,controlScore:0};for(const c of B.PLAYERS){const u=new kr;for(const h of r.get(c).get())if(i.get(h).isPresent())o.threatenedScore+=c.getScoreModifier();else{o.safeScore+=c.getScoreModifier();for(const g of Be.ORTHOGONALS){let m=h.getNext(g,1);for(;m.isInRange(t,t)&&e.getPieceAt(m)===Tn.UNOCCUPIED;)u.add(m),m=m.getNext(g,1)}}for(const h of u){const g=this.getControlledPieceValue(h.x,h.y,t);o.controlScore+=c.getScoreModifier()*g}}return o}getControlledPieceValue(t,e,r){let s=1;return(0===t||t===r-1)&&(s*=r),(0===e||e===r-1)&&(s*=r),s}getScoreByThreatenedPiece(t){const e=t.board.length,r=e-2;return 4*e*e+4*r*e+r*r}getScoreBySafePiece(t){return 16*this.getScoreByThreatenedPiece(t)+1}}class GH extends RP{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,i=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,r),o=r.getPieceAt(this.ruler.getKingCoord(r).get()).getOwner(),c=this.getStepForEscape(r)*o.getScoreModifier();if(-1===c)return new Fn(o.getOpponent().getPreVictory());const u=this.getScoreByThreatenedPiece(r);return ge.assert(i.controlScore<=u,"Control Score should be below "+u+", got "+i.controlScore),ge.assert(i.threatenedScore<=16,"Threatened Score should be below 16, got "+i.threatenedScore),ge.assert(i.safeScore<=16,"Safe Score should be below 16, got "+i.threatenedScore),new Fn(-1*c*(u+1)*17*17+i.safeScore*(u+1)*17+i.threatenedScore*(u+1)+i.controlScore)}getStepForEscape(t){const e=this.ruler.getKingCoord(t).get();return this._getStepForEscape(t,1,[e],[]).getOrElse(-1)}_getStepForEscape(t,e,r,s){const i=this.getNextGen(t,r,s);return 0===i.length?y.empty():i.some(o=>this.ruler.isExternalThrone(o))?y.of(e):(e++,s.push(...i),this._getStepForEscape(t,e,i,s))}getNextGen(t,e,r){const s=[];for(const i of e)for(const o of Be.ORTHOGONALS){let c=i.getNext(o,1);for(;c.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&t.getPieceAt(c)===Tn.UNOCCUPIED;)r.every(u=>!1===u.equals(c))&&s.push(c),c=c.getNext(o,1)}return s}}const re=Tn.UNOCCUPIED,K1=Tn.INVADERS,Ta=Tn.DEFENDERS,t_=Tn.PLAYER_ONE_KING;class a3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,H3.getInitialState()),te.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,H3.getInitialState(),qo.of(new S(3,1),new S(1,1)),$localize`Congratulations!`),te.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new H3([[re,re,re,K1,re,re,re],[re,re,re,K1,re,re,re],[K1,re,re,Ta,re,re,re],[re,re,Ta,t_,Ta,K1,K1],[re,re,K1,re,re,re,re],[re,re,re,Ta,re,K1,re],[re,re,re,K1,re,re,re]],1),[qo.of(new S(3,5),new S(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),te.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new H3([[re,re,re,K1,re,re,re],[re,re,K1,re,re,re,re],[re,re,re,Ta,re,re,re],[K1,Ta,re,re,Ta,K1,K1],[re,Ta,re,re,re,re,re],[re,K1,re,t_,re,K1,re],[re,re,re,K1,re,re,re]],12),[qo.of(new S(2,1),new S(3,1)),qo.of(new S(3,0),new S(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),te.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new H3([[re,re,re,re,re,re,re],[re,re,re,Ta,re,re,re],[re,re,re,K1,re,re,re],[re,K1,re,t_,K1,re,re],[re,re,re,K1,re,re,re],[re,Ta,re,re,re,re,re],[re,re,re,re,re,re,re]],72),[qo.of(new S(1,3),new S(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),te.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new H3([[re,re,K1,re,re,re,re],[re,re,re,K1,re,re,re],[re,re,re,t_,K1,re,re],[re,K1,Ta,re,Ta,re,re],[re,re,re,K1,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re]],72),[qo.of(new S(2,0),new S(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),te.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new H3([[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,K1,re,K1,re,re,re],[K1,re,re,re,Ta,re,re],[re,re,re,Ta,re,re,re],[re,re,re,re,re,re,re],[re,t_,re,K1,re,re,re]],72),[qo.of(new S(3,6),new S(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function x4t(n,t){1&n&&(H(),X(0,"polygon",8))}function k4t(n,t){1&n&&(H(),X(0,"rect",9))}function L4t(n,t){if(1&n&&(H(),b(0,"g"),x(1,x4t,1,0,"polygon",6),x(2,k4t,1,0,"ng-template",null,7,qn),A()),2&n){const e=Hn(3),r=C().index,s=C().index,i=C();T(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function R4t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=C(2).index,r=C().index,s=C();T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function D4t(n,t){if(1&n&&(H(),X(0,"polyline",16)),2&n){const e=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][e])}}function z4t(n,t){if(1&n&&(H(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function V4t(n,t){if(1&n&&(H(),x(0,D4t,1,1,"polyline",14),x(1,z4t,4,20,"ng-template",null,15,qn)),2&n){const e=Hn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",e)}}function H4t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"circle",10),x(2,R4t,6,25,"g",11),x(3,V4t,3,2,"ng-template",null,12,qn),A()),2&n){const e=Hn(4),r=C().index,s=C().index,i=C();T(1),Le("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),z("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),T(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function F4t(n,t){if(1&n){const e=Ae();H(),b(0,"g",3),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),X(1,"rect",4),x(2,L4t,4,2,"g",5),x(3,H4t,5,8,"g",5),A()}if(2&n){const e=t.index,r=C().index,s=C();Le("id","click_",e,"_",r,""),z("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),T(1),Le("id","space_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),T(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function B4t(n,t){if(1&n&&(H(),b(0,"g"),x(1,F4t,4,10,"g",2),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function $4t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",17),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),Le("id","click_",e.x,"_",e.y,""),z("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let U4t=(()=>{class n extends UH{constructor(e){super(e,!1,qo.from),this.rules=C8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new xP(this.rules,"DummyBot"),new LP(this.rules,"Piece > Influence"),new RP(this.rules,"Piece > Control"),new GH(this.rules,"Escape > Piece > Control")],this.encoder=qo.encoder,this.tutorial=(new a3e).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-brandhub"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,B4t,2,1,"g",1),x(2,$4t,2,6,"g",1),A()),2&e&&(z("viewBox",r.getViewBox()),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getClickables()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Ci=(()=>{class n extends xr{static getInitialState(){const e=Je.createTable(n.WIDTH,n.HEIGHT,ue.NONE);return new n(e,0)}}return n.WIDTH=19,n.HEIGHT=19,n})();class oc extends ms{constructor(t,e){super(t,e)}static isInRange(t){return t.isInRange(Ci.WIDTH,Ci.HEIGHT)}static of(t){return ge.assert(oc.isInRange(t),"FIRST_COORD_IS_OUT_OF_RANGE"),new oc(t.x,t.y)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}oc.encoder=ms.getEncoder(oc.of);class F3 extends Pa{static of(t,e){return ge.assert(t.isInRange(Ci.WIDTH,Ci.HEIGHT),"FIRST_COORD_IS_OUT_OF_RANGE"),ge.assert(e.isInRange(Ci.WIDTH,Ci.HEIGHT),"SECOND_COORD_IS_OUT_OF_RANGE"),ge.assert(!1===t.equals(e),"COORDS_SHOULD_BE_DIFFERENT"),new F3(t,e)}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(t){const e=this.getFirst(),r=t.getFirst(),s=this.getSecond(),i=t.getSecond();return!(!e.equals(r)||!s.equals(i))||!(!e.equals(i)||!s.equals(r))}}var qH;F3.encoder=Pa.getEncoder(F3.of),function(n){n.isFirstMove=function t(r){return r instanceof oc},n.isDrop=function e(r){return r instanceof F3},n.encoder=Ye.disjunction([n.isFirstMove,n.isDrop],[oc.encoder,F3.encoder])}(qH||(qH={}));class Wh{constructor(t,e,r){this.isInRange=t,this.getOwner=e,this.N=r}getBoardValue(t){let e=0;for(const r of t.getCoordsAndContents()){const i=r.coord;if(this.getOwner(r.content,t).isPlayer()){const o=this.getSquareScore(t,i);if(Fn.VICTORIES.some(c=>c===o))return new Fn(o);e+=o}}return new Fn(e)}getSquareScore(t,e){const r=t.getPieceAt(e),s=this.getOwner(r,t);We(s.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const i=new jn,o=new jn;for(const u of be.DIRECTIONS){const h=this.getNumberOfFreeSpacesAndAllies(t,e,u,s);i.set(u,h[0]),o.set(u,h[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(o,i)*s.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(t,e){let r=0;for(const s of[be.UP,be.UP_RIGHT,be.RIGHT,be.DOWN_RIGHT]){const i=t.get(s).get(),o=t.get(s.getOpposite()).get();if(this.N<=i+o+1)return Number.MAX_SAFE_INTEGER;const g=e.get(s).get()+e.get(s.getOpposite()).get();this.N<=g+1&&(r+=2+g-this.N)}return r}getNumberOfFreeSpacesAndAllies(t,e,r,s){let i=0,o=0,c=!0,u=new S(e.x+r.x,e.y+r.y),h=1;const g=s.getOpponent();for(;this.isInRange(u)&&h<this.N;){const m=t.getPieceAt(u);if(this.getOwner(m,t)===g)return[i,o];this.getOwner(m,t)===s&&c?o++:c=!1,m!==g&&m!==s&&i++,u=u.getNext(r),h++}return[i,o]}getVictoriousCoord(t){const e=[];for(const r of t.getCoordsAndContents())if(this.getOwner(r.content,t).isPlayer()){const s=r.coord,i=this.getSquareScore(t,s);mr.getScoreStatus(i)===Pn.VICTORY&&(i===B.ZERO.getVictoryValue()||i===B.ONE.getVictoryValue())&&e.push(s)}return e}}class ac extends I1{constructor(){super(Ci)}static get(){return ac.singleton.isAbsent()&&(ac.singleton=y.of(new ac)),ac.singleton.get()}static getVictoriousCoords(t){return ac.CONNECT_SIX_HELPER.getVictoriousCoord(t)}applyLegalMove(t,e,r){return t instanceof F3?this.applyLegalDrops(t,e):this.applyLegalFirstMove(t,e)}applyLegalDrops(t,e){const r=e.getCurrentPlayer(),s=t.getFirst(),i=t.getSecond(),o=e.getCopiedBoard();return o[s.y][s.x]=r,o[i.y][i.x]=r,new Ci(o,e.turn+1)}applyLegalFirstMove(t,e){const r=e.getCurrentPlayer(),s=e.getCopiedBoard();return s[t.coord.y][t.coord.x]=r,new Ci(s,e.turn+1)}isLegal(t,e){return 0===e.turn?(ge.assert(t instanceof oc,"First move should be instance of ConnectSixFirstMove"),R.SUCCESS):(ge.assert(t instanceof F3,"non-firsts moves should be instance of ConnectSixDrops"),this.isLegalDrops(t,e))}isLegalDrops(t,e){return e.getPieceAt(t.getFirst()).isPlayer()||e.getPieceAt(t.getSecond()).isPlayer()?R.failure(Xe.MUST_CLICK_ON_EMPTY_SQUARE()):R.SUCCESS}getGameStatus(t){const e=t.gameState;return ac.CONNECT_SIX_HELPER.getVictoriousCoord(e).length>0?Ie.getVictory(e.getCurrentOpponent()):181===e.turn?Ie.DRAW:Ie.ONGOING}}ac.singleton=y.empty(),ac.CONNECT_SIX_HELPER=new Wh(oc.isInRange,ge.identity,6);const G=ue.NONE,z2=ue.ZERO,Ki=ue.ONE;class c3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,Ci.getInitialState()),te.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,Ci.getInitialState(),oc.of(new S(9,9)),$localize`Congratulations!`),te.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new Ci([[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,Ki,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,z2,G,Ki,z2,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,z2,z2,G,G,Ki,G,G,G,G,G,G],[G,G,G,G,G,G,G,Ki,z2,z2,z2,z2,Ki,G,G,G,G,G,G],[G,G,G,G,G,G,Ki,z2,z2,z2,z2,Ki,G,G,G,G,G,G,G],[G,G,G,G,G,G,Ki,G,Ki,z2,Ki,Ki,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,z2,Ki,z2,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,Ki,G,Ki,G,z2,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,Ki,Ki,G,Ki,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,Ki,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,z2,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G]],20),F3.of(new S(4,11),new S(5,10)),$localize`Congratulations!`)]}}let WH=(()=>{class n extends ao{constructor(){super(...arguments),this.hoshis=[]}createHoshis(){const e=this.board.length,r=Math.floor(e/2),s=e<12?2:3,i=e-(s+1);18<e&&this.hoshis.push(new S(s,r),new S(r,s),new S(r,i),new S(i,r)),this.hoshis.push(new S(r,r),new S(s,s),new S(s,i),new S(i,s),new S(i,i))}isHoshi(e,r){return this.hoshis.some(s=>s.x===e&&s.y===r)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class G4t extends ic{getListMoves(t){return 0===t.gameState.turn?this.getFirstMove():this.getListDrops(t)}getFirstMove(){const e=Ci.HEIGHT,r=Math.floor(Ci.WIDTH/2),s=Math.floor(e/2);return[oc.of(new S(r,s))]}getListDrops(t){const e=this.getAvailableCoords(t.gameState),r=[];for(const s of e){const i=t.gameState.getCopiedBoard();i[s.y][s.x]=t.gameState.getCurrentPlayer();const o=new Ci(i,t.gameState.turn),c=this.getAvailableCoords(o);for(const u of c){const h=F3.of(s,u);r.push(h)}}return new bt(r).toList()}getAvailableCoords(t){const e=this.getUsefulCoordsMap(t),r=[];for(const s of t.getCoordsAndContents()){const i=s.coord;!0===e[i.y][i.x]&&!1===s.content.isPlayer()&&r.push(i)}return r}getUsefulCoordsMap(t){const e=Je.createTable(Ci.WIDTH,Ci.HEIGHT,!1);for(const r of t.getCoordsAndContents())r.content.isPlayer()&&this.addNeighboringCoord(e,r.coord);return e}addNeighboringCoord(t,e){const s=Math.max(0,e.x-1),i=Math.max(0,e.y-1),o=Math.min(Ci.WIDTH-1,e.x+1),c=Math.min(Ci.HEIGHT-1,e.y+1);for(let u=i;u<=c;u++)for(let h=s;h<=o;h++)t[u][h]=!0}getBoardValue(t){const e=t.gameState;let r=0;for(const s of e.getCoordsAndContents())if(s.content.isPlayer()){const i=ac.CONNECT_SIX_HELPER.getSquareScore(e,s.coord);if(mr.getScoreStatus(i)===Pn.VICTORY)return new Fn(i);r+=i}return new Fn(r)}}function q4t(n,t){if(1&n&&(H(),X(0,"circle",8)),2&n){const e=C().index,r=C().index,s=C();Le("id","piece_",e,"_",r,""),w("ngClass",s.getSpaceClass(e,r)),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function W4t(n,t){if(1&n&&(H(),X(0,"circle",12)),2&n){const e=C(2).index,r=C().index,s=C();Le("id","hoshi_",e,"_",r,""),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.1*s.SPACE_SIZE)}}function j4t(n,t){if(1&n&&(H(),X(0,"rect",9)(1,"line",10)(2,"line",10),x(3,W4t,1,5,"circle",11)),2&n){const e=C().index,r=C().index,s=C();z("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*e)("y",.5*s.SPACE_SIZE*r),T(1),z("x1",.5*s.SPACE_SIZE*e)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),z("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),w("ngIf",s.isHoshi(e,r))}}function Z4t(n,t){if(1&n){const e=Ae();H(),b(0,"g",5),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),x(1,q4t,1,6,"circle",6),x(2,j4t,4,13,"ng-template",null,7,qn),A()}if(2&n){const e=t.$implicit,r=t.index,s=Hn(3);Le("id","click_",r,"_",C().index,""),T(1),w("ngIf",e.isPlayer())("ngIfElse",s)}}function Y4t(n,t){if(1&n&&(H(),b(0,"g"),x(1,Z4t,4,4,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function K4t(n,t){if(1&n){const e=Ae();H(),b(0,"circle",13),ee("click",function(){de(e);const s=C();return le(s.onClick(s.droppedCoord.get().x,s.droppedCoord.get().y))}),A()}if(2&n){const e=C();w("ngClass",e.getSpaceClass(e.droppedCoord.get().x,e.droppedCoord.get().y)),z("cx",.25*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.droppedCoord.get().x)("cy",.25*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.droppedCoord.get().y)("r",.22*e.SPACE_SIZE)}}let X4t=(()=>{class n extends WH{constructor(e){super(e),this.droppedCoord=y.empty(),this.lastMoved=[],this.victoryCoords=[],this.rules=ac.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new G4t(this.rules,"Minimax")],this.encoder=qH.encoder,this.tutorial=(new c3e).tutorial}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.victoryCoords=ac.getVictoriousCoords(e),this.createHoshis()}showLastMove(e){this.lastMoved=e instanceof oc?[e.coord]:[e.getFirst(),e.getSecond()]}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);if(0===s.getState().turn){const c=oc.of(o);return s.chooseMove(c)}if(s.getState().getPieceAt(o).isPlayer())return s.cancelMove(Xe.MUST_CLICK_ON_EMPTY_SQUARE());if(s.droppedCoord.isPresent()){if(s.droppedCoord.equalsValue(o))return s.droppedCoord=y.empty(),R.SUCCESS;{const c=F3.of(s.droppedCoord.get(),o);return s.chooseMove(c)}}return s.droppedCoord=y.of(o),R.SUCCESS})()}getSpaceClass(e,r){const s=new S(e,r),i=this.getState().getPieceAt(s),o=[];return this.droppedCoord.equalsValue(s)?(o.push(this.getPlayerClass(this.getState().getCurrentPlayer())),o.push("highlighted-stroke")):(o.push(this.getPlayerClass(i)),this.victoryCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),this.lastMoved.some(c=>c.equals(s))&&o.push("last-move-stroke")),o}cancelMoveAttempt(){this.droppedCoord=y.empty()}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-connect-six"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["id","dropped","class","base mid-stroke moved-stroke",3,"ngClass","click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],["id","dropped",1,"base","mid-stroke","moved-stroke",3,"ngClass","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),X(1,"rect",1),x(2,Y4t,2,1,"g",2),x(3,K4t,1,4,"circle",3),A()),2&e&&(z("viewBox","0 -3 "+r.board.length*r.SPACE_SIZE*.5+" "+(6+r.board.length*r.SPACE_SIZE*.5)),T(1),z("width",r.board.length*r.SPACE_SIZE*.5)("height",r.board.length*r.SPACE_SIZE*.5),T(1),w("ngForOf",r.board),T(1),w("ngIf",r.droppedCoord.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),y6=(()=>{class n{}return n.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`,n.CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`,n.CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`,n.MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`,n.MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`,n.INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`,n.SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`,n})();class jt extends xr{static getInitialState(){const t=Je.createTable(jt.WIDTH,jt.HEIGHT,ue.NONE);return new jt(t,0)}isShelter(t){return 0===t.x||t.x===jt.WIDTH-1?jt.SHELTERS_INDICES.some(e=>t.y===e):(0===t.y||t.y===jt.HEIGHT-1)&&jt.SHELTERS_INDICES.some(e=>t.x===e)}isCentralZone(t){return t.x>=jt.CENTRAL_ZONE_TOP_LEFT.x&&t.x<=jt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&t.y>=jt.CENTRAL_ZONE_TOP_LEFT.y&&t.y<=jt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}jt.WIDTH=17,jt.HEIGHT=17,jt.CENTRAL_ZONE_TOP_LEFT=new S(4,6),jt.CENTRAL_ZONE_BOTTOM_RIGHT=new S(12,10),jt.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],jt.ALL_SHELTERS=new bt(jt.SHELTERS_INDICES.flatMap(n=>[new S(n,0),new S(n,jt.HEIGHT-1),new S(0,n),new S(jt.WIDTH-1,n)])).toList();class E6 extends ms{constructor(t){super(t.x,t.y)}static of(t){return ge.assert(t.isInRange(jt.WIDTH,jt.HEIGHT),"Move out of board"),new E6(t)}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(t){return!!yi.isDrop(t)&&this.coord.equals(t.coord)}}E6.encoder=ms.getEncoder(E6.of);class M6 extends Hc{constructor(t,e){super(t,e)}static from(t,e){const r=t.isInRange(jt.WIDTH,jt.HEIGHT),s=e.isInRange(jt.WIDTH,jt.HEIGHT);return ge.assert(r&&s,"Move out of board"),t.isAlignedWith(e)&&1===t.getDistance(e)?ve.success(new M6(t,e)):ve.failure(y6.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP())}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!!yi.isSimple(t)&&super.equals(t)}}M6.encoder=Pa.getFallibleEncoder(M6.from);class Fc extends oo{constructor(t){super(),this.coords=t}static from(t){if(t.length<2)return ve.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const r of t)if(r.isNotInRange(jt.WIDTH,jt.HEIGHT))return ve.failure("Move out of board");for(let r=1;r<t.length;r++)if(t[r-1].getDirectionToward(t[r]).isFailure()||2!==t[r-1].getDistance(t[r]))return ve.failure(y6.INVALID_JUMP());return new kr(t).size()===t.length?ve.success(new Fc(t)):ve.failure(y6.SAME_LOCATION_VISITED_IN_JUMP())}addJump(t){const e=Je.copyImmutableArray(this.coords);return e.push(t),Fc.from(e)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const t=[];for(let e=1;e<this.coords.length;e++){const r=this.coords[e-1].getDirectionToward(this.coords[e]).get();t.push(this.coords[e-1].getNext(r,1))}return t}toString(){return`ConspirateursMoveJump(${this.coords.map(e=>e.toString()).reduce((e,r)=>e+" -> "+r)})`}equals(t){return!(yi.isSimple(t)||yi.isDrop(t)||t!==this&&(!1===this.getStartingCoord().equals(t.getStartingCoord())||!1===this.getEndingCoord().equals(t.getEndingCoord())))}}var yi;Fc.encoder=Ye.tuple([Ye.list(S.encoder)],n=>[Je.copyImmutableArray(n.coords)],n=>Fc.from(n[0]).get()),function(n){n.isDrop=function t(s){return s instanceof E6},n.isSimple=function e(s){return s instanceof M6},n.isJump=function r(s){return s instanceof Fc},n.encoder=Ye.disjunction([n.isDrop,n.isSimple,n.isJump],[E6.encoder,M6.encoder,Fc.encoder])}(yi||(yi={}));const P=ue.NONE,Lt=ue.ZERO,It=ue.ONE;class l3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,jt.getInitialState()),te.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,jt.getInitialState(),E6.of(new S(7,7)),$localize`Congratulations!`),te.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new jt([[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,Lt,Lt,It,It,Lt,Lt,It,Lt,It,P,P,P,P],[P,P,P,P,Lt,It,Lt,It,Lt,Lt,Lt,Lt,It,P,P,P,P],[P,P,P,P,Lt,It,P,P,P,P,P,It,Lt,P,P,P,P],[P,P,P,P,It,Lt,Lt,It,It,It,Lt,Lt,Lt,P,P,P,P],[P,P,P,P,It,Lt,It,It,It,It,It,It,Lt,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P]],40),M6.from(new S(4,6),new S(3,5)).get(),(t,e,r)=>yi.isSimple(t)?R.SUCCESS:R.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),te.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new jt([[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,Lt,Lt,It,It,Lt,Lt,It,Lt,It,P,P,P,P],[P,P,P,P,Lt,It,Lt,It,Lt,Lt,Lt,Lt,It,P,P,P,P],[P,P,P,P,Lt,It,P,P,P,P,P,It,Lt,P,P,P,P],[P,P,P,P,It,Lt,Lt,It,It,It,Lt,Lt,Lt,P,P,P,P],[P,P,P,P,It,Lt,It,It,It,It,It,It,Lt,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P]],40),Fc.from([new S(6,7),new S(6,5)]).get(),(t,e,r)=>yi.isJump(t)?R.SUCCESS:R.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),te.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new jt([[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,It,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,It,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,It,P,P,P,P,P,P,P,P,P],[P,P,P,P,Lt,Lt,P,It,Lt,Lt,It,Lt,It,P,P,P,P],[P,P,P,P,Lt,P,Lt,It,Lt,Lt,Lt,Lt,It,P,P,P,P],[P,P,P,P,Lt,It,P,P,P,P,P,It,Lt,P,P,P,P],[P,P,P,P,It,Lt,Lt,It,It,It,Lt,Lt,Lt,P,P,P,P],[P,P,P,P,It,Lt,It,It,It,It,It,It,Lt,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P]],40),[Fc.from([new S(8,6),new S(6,4),new S(6,2),new S(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}}class cc extends I1{constructor(){super(jt)}static get(){return cc.singleton.isAbsent()&&(cc.singleton=y.of(new cc)),cc.singleton.get()}applyLegalMove(t,e,r){const s=e.getCopiedBoard();if(yi.isDrop(t))s[t.coord.y][t.coord.x]=e.getCurrentPlayer();else if(yi.isSimple(t))s[t.getStart().y][t.getStart().x]=ue.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer();else{const i=t.getStartingCoord(),o=t.getEndingCoord();s[i.y][i.x]=ue.NONE,s[o.y][o.x]=e.getCurrentPlayer()}return new jt(s,e.turn+1)}isLegal(t,e){return yi.isDrop(t)?this.dropLegality(t,e):yi.isSimple(t)?this.simpleMoveLegality(t,e):this.jumpLegality(t,e)}dropLegality(t,e){return e.turn>=40?R.failure(y6.CANNOT_DROP_AFTER_TURN_40()):e.getPieceAt(t.coord).isPlayer()?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):!1===e.isCentralZone(t.coord)?R.failure(y6.MUST_DROP_IN_CENTRAL_ZONE()):R.SUCCESS}simpleMoveLegality(t,e){return e.turn<40?R.failure(y6.CANNOT_MOVE_BEFORE_TURN_40()):e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE()):e.getPieceAt(t.getEnd()).isPlayer()?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):R.SUCCESS}jumpLegality(t,e){if(e.turn<40)return R.failure(y6.CANNOT_MOVE_BEFORE_TURN_40());if(e.getPieceAt(t.getStartingCoord())!==e.getCurrentPlayer())return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());for(const r of t.getJumpedOverCoords())if(e.getPieceAt(r)===ue.NONE)return R.failure(y6.MUST_JUMP_OVER_PIECES());for(const r of t.getLandingCoords())if(e.getPieceAt(r).isPlayer())return R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE());return R.SUCCESS}jumpTargetsFrom(t){const e=[new S(t.x+2,t.y),new S(t.x-2,t.y),new S(t.x,t.y+2),new S(t.x,t.y-2),new S(t.x+2,t.y+2),new S(t.x+2,t.y-2),new S(t.x-2,t.y+2),new S(t.x-2,t.y-2)],r=[];for(const s of e)Fc.from([t,s]).isSuccess()&&r.push(s);return r}nextJumps(t,e){const r=t.getEndingCoord(),s=[];for(const i of this.jumpTargetsFrom(r)){const o=t.addJump(i);o.isSuccess()&&this.jumpLegality(o.get(),e).isSuccess()&&s.push(o.get())}return s}jumpHasPossibleNextTargets(t,e){return this.nextJumps(t,e).length>0}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of jt.ALL_SHELTERS){const i=e.getPieceAt(s);if(i.isPlayer()&&(r[i.value]+=1,20===r[i.value]))return Ie.getVictory(i)}return Ie.ONGOING}}cc.singleton=y.empty();let n_=(()=>{class n{}return n.NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`,n.SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`,n.TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`,n.MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`,n.MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`,n})();class wn{constructor(t,e){this.owner=t,this.otherPieceType=e}static of(t,e){return t===B.ZERO?e?wn.ZERO_SECOND:wn.ZERO_FIRST:t===B.ONE?e?wn.ONE_SECOND:wn.ONE_FIRST:wn.EMPTY}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(t){return this===t}}wn.encoder=Ye.tuple([ue.encoder,Ye.identity()],n=>[n.owner,n.otherPieceType],n=>wn.of(n[0],n[1])),wn.EMPTY=new wn(ue.NONE,!1),wn.ZERO_FIRST=new wn(B.ZERO,!1),wn.ZERO_SECOND=new wn(B.ZERO,!0),wn.ONE_FIRST=new wn(B.ONE,!1),wn.ONE_SECOND=new wn(B.ONE,!0),wn.PLAYER_PIECES=[wn.ZERO_FIRST,wn.ZERO_SECOND,wn.ONE_FIRST,wn.ONE_SECOND];class u3e extends oo{isDrop(){return this instanceof S6}isShift(){return this instanceof Xi}}class S6 extends u3e{constructor(t,e){if(super(),this.target=t,this.piece=e,e===wn.EMPTY)throw new Error("Cannot drop an empty piece")}getTarget(){return this.target}equals(t){return t instanceof S6&&!(this.target!==t.target||this.piece!==t.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}S6.encoder=Ye.tuple([Ye.identity(),wn.encoder],n=>[n.target,n.piece],n=>new S6(n[0],n[1]));class Xi extends u3e{constructor(t,e){super(),this.start=t,this.moveDirection=e}static ofRepresentation(t,e){return new Xi(new S(t.x,3-t.y),e)}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(t){return t instanceof Xi&&!(!1===this.start.equals(t.start)||this.moveDirection!==t.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}Xi.encoder=Ye.tuple([S.encoder,Ye.identity()],n=>[n.start,"clockwise"===n.moveDirection],n=>new Xi(n[0],n[1]?"clockwise":"counterclockwise"));const Q4t=Ye.disjunction([n=>n.isDrop(),n=>n.isShift()],[S6.encoder,Xi.encoder]);let Ur=(()=>{class n extends xr{constructor(e,r,s){super(e,s),this.remainingPieces=r}static getInitialState(){const e=wn.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}static ofRepresentation(e,r){const s=e.reverse(),i=[4,4,4,4];for(let o=0;o<n.HEIGHT;o++)for(let c=0;c<n.WIDTH;c++){const u=s[o][c];s[o][c]!==wn.EMPTY&&i[n.pieceIndex(u)]--}return We(i.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new n(s,i,r)}static pieceIndex(e){switch(e){case wn.ZERO_FIRST:return 0;case wn.ZERO_SECOND:return 1;case wn.ONE_FIRST:return 2;default:return ge.expectToBe(e,wn.ONE_SECOND),3}}getRemainingPiecesOf(e){return this.remainingPieces[n.pieceIndex(e)]}getStackHeight(e){let r=0;for(let s=0;s<n.HEIGHT&&this.getPieceAtXY(e,s)!==wn.EMPTY;s++)r++;return r}}return n.WIDTH=8,n.HEIGHT=4,n})();class q4 extends I1{constructor(){super(Ur)}static get(){return q4.singleton.isAbsent()&&(q4.singleton=y.of(new q4)),q4.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalShift(t,e)}applyLegalDrop(t,e){const r=Je.copyBiArray(e.board);r[e.getStackHeight(t.target)][t.target]=t.piece;const s=Je.copyImmutableArray(e.remainingPieces);return s[Ur.pieceIndex(t.piece)]-=1,new Ur(r,s,e.turn+1)}applyLegalShift(t,e){const r=Je.copyBiArray(e.board),s=t.getTarget();let i=e.getStackHeight(s),o=t.start.y;for(;o<Ur.HEIGHT&&e.getPieceAtXY(t.start.x,o)!==wn.EMPTY;)r[i][s]=e.getPieceAtXY(t.start.x,o),r[o][t.start.x]=wn.EMPTY,i++,o++;return new Ur(r,e.remainingPieces,e.turn+1)}isLegal(t,e){return t.isDrop()?this.isDropLegal(t,e):this.isShiftLegal(t,e)}isDropLegal(t,e){return t.piece.owner!==e.getCurrentPlayer()?R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE()):0===e.getRemainingPiecesOf(t.piece)?R.failure(n_.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(t,e)}dropHeightValidity(t,e){return e.getStackHeight(t.target)===Ur.HEIGHT?R.failure(n_.SPACE_IS_FULL()):R.SUCCESS}isShiftLegal(t,e){return e.getPieceAt(t.start).owner!==e.getCurrentPlayer()?R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(t,e)}shiftHeightValidity(t,e){const r=e.getStackHeight(t.start.x)-t.start.y;return e.getStackHeight(t.getTarget())+r>Ur.HEIGHT?R.failure(n_.TARGET_STACK_TOO_HIGH()):R.SUCCESS}getGameStatus(t){const e=this.findHighestAlignment(t.gameState);if(e.isPresent()){const r=t.gameState.getPieceAt(e.get());return We(r.owner.isPlayer(),"highest alignment is owned by a player"),Ie.getVictory(r.owner)}return Ie.ONGOING}findHighestAlignment(t){for(let e=0;e<Ur.WIDTH/2;e++)for(let r=Ur.HEIGHT-1;r>0;r--){const s=t.getPieceAtXY(e,r),i=t.getPieceAtXY(e+Ur.WIDTH/2,r);if(s!==wn.EMPTY&&s===i)return y.of(new S(e,r))}return y.empty()}pieceCanMove(t,e){return!!this.isShiftLegal(new Xi(e,"clockwise"),t).isSuccess()||!!this.isShiftLegal(new Xi(e,"counterclockwise"),t).isSuccess()}}q4.singleton=y.empty();const it=wn.EMPTY,jh=wn.ZERO_FIRST,f3e=wn.ZERO_SECOND,DP=wn.ONE_FIRST,jH=wn.ONE_SECOND;class h3e{constructor(){this.tutorial=[te.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,Ur.getInitialState()),te.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,Ur.ofRepresentation([[it,it,it,it,it,it,it,it],[it,it,it,it,it,it,it,it],[it,it,it,it,DP,it,it,it],[jh,it,it,it,jh,it,it,it]],3),[new S6(0,wn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),te.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,Ur.ofRepresentation([[it,it,it,it,it,it,it,it],[it,it,it,it,jH,it,it,it],[it,it,it,it,jh,it,it,it],[DP,it,it,it,f3e,it,it,it]],4),[Xi.ofRepresentation(new S(4,3),"counterclockwise"),Xi.ofRepresentation(new S(4,3),"clockwise"),Xi.ofRepresentation(new S(4,2),"counterclockwise"),Xi.ofRepresentation(new S(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),te.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,Ur.ofRepresentation([[it,it,it,it,jh,it,it,it],[it,it,it,it,jH,it,it,jh],[it,it,it,it,jh,it,it,jH],[it,DP,it,it,f3e,it,it,DP]],8),[Xi.ofRepresentation(new S(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)]}}let d3e=(()=>{class n extends m8{constructor(){super(...arguments),this.SPACE_SIZE=50}getTriangleCornerCoords(e,r){return(e+r)%2==1?this.getDownwardCoordinate(e,r):this.getUpwardCoordinate(e,r)}getTriangleCoordinate(e,r){return this.getTriangleCornerCoords(e,r).map(o=>o.x+","+o.y).reduce((o,c)=>o+","+c)}getDownwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new S(.5*this.SPACE_SIZE*e,c);return[h,new S(i,u),new S(o,c),h]}getUpwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new S(.5*this.SPACE_SIZE*e,u);return[h,new S(i,c),new S(o,u),h]}getPyramidCoordinate(e,r){return(e+r)%2==1?this.getDownwardPyramidCoordinate(e,r):this.getUpwardPyramidCoordinate(e,r)}getDownwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=this.SPACE_SIZE*r,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}getUpwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=(r+1)*this.SPACE_SIZE,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),r_=(()=>{class n{}return n.INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`,n.NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`,n.FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`,n.CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`,n})();class _r{constructor(t,e){this.direction=t,this.str=e}static ofCoords(t,e){const r=t.getVectorToward(e),s=_r.STEPS.findIndex(i=>i.direction.equals(r));return ge.assert(-1!==s,r_.INVALID_DISTANCE()),_r.STEPS[s]}}_r.LEFT=new _r(new $t(-2,0),"LEFT"),_r.UP_LEFT=new _r(be.UP_LEFT,"UP_LEFT"),_r.UP_RIGHT=new _r(be.UP_RIGHT,"UP_RIGHT"),_r.RIGHT=new _r(new $t(2,0),"RIGHT"),_r.DOWN_LEFT=new _r(be.DOWN_LEFT,"DOWN_LEFT"),_r.DOWN_RIGHT=new _r(be.DOWN_RIGHT,"DOWN_RIGHT"),_r.STEPS=[_r.LEFT,_r.UP_LEFT,_r.UP_RIGHT,_r.RIGHT,_r.DOWN_LEFT,_r.DOWN_RIGHT];class Qi extends Hc{constructor(t,e){super(t,e)}static of(t,e){const r=_r.ofCoords(t,e);return Qi.ofMovement(t,r)}static ofMovement(t,e){ge.assert(t.isInRange(15,10),"Starting coord cannot be out of range (width: 15, height: 10).");const r=new S(t.x+e.direction.x,t.y+e.direction.y);return ge.assert(r.isInRange(15,10),"Landing coord cannot be out of range (width: 15, height: 10)."),new Qi(t,r)}toString(){return"CoerceoRegularMove("+this.getStart().toString()+" > "+this.getEnd().toString()+")"}equals(t){return!y8.isTileExchange(t)&&super.equals(t)}}Qi.encoder=Hc.getEncoder(Qi.of);class P6 extends ms{constructor(t){super(t.x,t.y)}static of(t){return ge.assert(t.isInRange(15,10),"Captured coord cannot be out of range (width: 15, height: 10)."),new P6(t)}toString(){return"CoerceoTileExchangeMove("+this.coord.x+", "+this.coord.y+")"}equals(t){return!!y8.isTileExchange(t)&&t.coord.equals(this.coord)}}var y8;P6.encoder=ms.getEncoder(P6.of),function(n){n.isNormalMove=function t(r){return r instanceof Qi},n.isTileExchange=function e(r){return r instanceof P6},n.encoder=Ye.disjunction([n.isNormalMove,n.isTileExchange],[Qi.encoder,P6.encoder])}(y8||(y8={}));class Bc{static getNeighbors(t){let e;const r=new S(t.x-1,t.y),s=new S(t.x+1,t.y);return e=(t.x+t.y)%2==1?[r,s,new S(t.x,t.y-1)]:[r,s,new S(t.x,t.y+1)],e}static getFakeNeighbors(t){return new S(t.x,(t.x+t.y)%2==1?t.y+1:t.y-1)}static getCommonNeighbor(t,e){const r=Bc.getNeighbors(t),s=Bc.getNeighbors(e);let i=0;for(;i<r.length;){const o=r[i];let c=0;for(;c<s.length;){if(o.equals(s[c]))return y.of(o);c++}i++}return y.empty()}static isSpaceDark(t){return(t.x+t.y)%2==0}}class B5 extends xr{static getEmptyNeighbors(t,e,r){const s=[];for(const i of Bc.getNeighbors(e))i.isInRange(t[0].length,t.length)&&t[i.y][i.x]===r&&s.push(i);return s}getEmptyNeighbors(t,e){return B5.getEmptyNeighbors(this.board,t,e)}}class V1 extends B5{constructor(t,e,r,s){super(t,e),this.tiles=r,this.captures=s}static getTilesUpperLeftCoord(t){const e=t.x-t.x%3;let r=t.y;return r-=e%2==0?t.y%2:(t.y+1)%2,new S(e,r)}static getPresentNeighborEntrances(t){return[new S(t.x+1,t.y-1),new S(t.x+3,t.y+0),new S(t.x+3,t.y+1),new S(t.x+1,t.y+2),new S(t.x-1,t.y+1),new S(t.x-1,t.y+0)].filter(V1.isInRange)}static getInitialState(){const t=xe.EMPTY,e=xe.UNREACHABLE,r=xe.ZERO,s=xe.ONE;return new V1([[e,e,e,e,e,e,r,t,r,e,e,e,e,e,e],[e,e,e,t,t,r,t,t,t,r,t,t,e,e,e],[t,s,t,s,t,t,r,t,r,t,t,s,t,s,t],[s,t,t,t,s,t,t,t,t,t,s,t,t,t,s],[t,s,t,s,t,t,t,t,t,t,t,s,t,s,t],[t,r,t,r,t,t,t,t,t,t,t,r,t,r,t],[r,t,t,t,r,t,t,t,t,t,r,t,t,t,r],[t,r,t,r,t,t,s,t,s,t,t,r,t,r,t],[e,e,e,t,t,s,t,t,t,s,t,t,e,e,e],[e,e,e,e,e,e,s,t,s,e,e,e,e,e,e]],0,[0,0],[0,0])}applyLegalMovement(t){J(V1.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:t}});const e=t.getStart(),r=t.getEnd(),s=this.getCopiedBoard();return s[r.y][r.x]=xe.ofPlayer(this.getCurrentPlayer()),s[e.y][e.x]=xe.EMPTY,new V1(s,this.turn,this.tiles,this.captures)}doMovementCaptures(t){J(V1.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:t}});const e=this.getCapturedNeighbors(t.getEnd());let r=this;for(const s of e)r=r.capture(s);return r}getCapturedNeighbors(t){const e=this.getCurrentOpponent();return Bc.getNeighbors(t).filter(s=>!s.isNotInRange(15,10)&&!!this.getPieceAt(s).is(e)&&this.isSurrounded(s))}isSurrounded(t){return 0===this.getEmptyNeighbors(t,xe.EMPTY).length}capture(t){J(V1.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:t}});const e=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return J(V1.VERBOSE,t.toString()+" has been captured"),e[t.y][t.x]=xe.EMPTY,r[this.getCurrentPlayer().value]+=1,new V1(e,this.turn,this.tiles,r)}removeTilesIfNeeded(t,e){J(V1.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:t,countTiles:e}});let r=this;const s=V1.getTilesUpperLeftCoord(t);if(this.isTileEmpty(s)&&this.isDeconnectable(s)){r=this.deconnectTile(s,e);const i=V1.getPresentNeighborEntrances(s);for(const o of i){const c=r.getPieceAt(o);c===xe.EMPTY?r=r.removeTilesIfNeeded(o,e):c.is(this.getCurrentOpponent())&&r.isSurrounded(o)&&(r=r.capture(o))}}return r}isTileEmpty(t){We(this.getPieceAt(t)!==xe.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let e=0;e<2;e++)for(let r=0;r<3;r++){const s=t.getNext(new $t(r,e),1);if(this.getPieceAt(s)!==xe.EMPTY)return!1}return!0}isDeconnectable(t){const e=this.getPresentNeighborTilesRelativeIndexes(t);if(e.length>3)return!1;let r=0;for(let s=1;s<e.length;s++)!1===this.areNeighbor(e[s-1],e[s])&&(r+=1);return!1===this.areNeighbor(e[0],e[e.length-1])&&(r+=1),r<=1}areNeighbor(t,e){return t+1===e||0===t&&5===e}getPresentNeighborTilesRelativeIndexes(t){const e=[];let r=y.empty();for(let s=0;s<6;s++){const o=t.getNext(V1.NEIGHBORS_TILES_DIRECTIONS[s],1);o.isInRange(15,10)&&this.getPieceAt(o)!==xe.UNREACHABLE&&(r.isAbsent()&&(r=y.of(s)),e.push(s-r.get()))}return e}deconnectTile(t,e){J(V1.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:t,countTiles:e}});const r=this.getCopiedBoard(),s=t.x,i=t.y;for(let c=0;c<2;c++)for(let u=0;u<3;u++)r[i+c][s+u]=xe.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return e&&(o[this.getCurrentPlayer().value]+=1),new V1(r,this.turn,o,this.captures)}getLegalLandings(t){const e=[];for(const r of _r.STEPS){const s=t.getNext(r.direction,1);this.isOnBoard(s)&&this.getPieceAt(s)===xe.EMPTY&&e.push(s)}return e}getPiecesByFreedom(){const t=[[0,0,0,0],[0,0,0,0]];for(let e=0;e<10;e++)for(let r=0;r<15;r++){const s=this.board[e][r];if(s.isPlayer()){const i=this.getEmptyNeighbors(new S(r,e),xe.EMPTY).length;t[s.value][i]=t[s.value][i]+1}}return t}}V1.VERBOSE=!1,V1.NEIGHBORS_TILES_DIRECTIONS=[new $t(0,-2),new $t(3,-1),new $t(3,1),new $t(0,2),new $t(-3,1),new $t(-3,-1)],V1.isInRange=n=>n.isInRange(15,10);class $c extends I1{constructor(){super(V1)}static get(){return $c.singleton.isAbsent()&&($c.singleton=y.of(new $c)),$c.singleton.get()}applyLegalMove(t,e,r){return y8.isTileExchange(t)?this.applyLegalTileExchange(t,e):this.applyLegalMovement(t,e)}applyLegalTileExchange(t,e){const r=e.getCopiedBoard(),s=t.coord;r[s.y][s.x]=xe.EMPTY;const i=[e.captures[0],e.captures[1]];i[e.getCurrentPlayer().value]+=1;const o=[e.tiles[0],e.tiles[1]];o[e.getCurrentPlayer().value]-=2;const c=new V1(r,e.turn,o,i),u=c.removeTilesIfNeeded(s,!1),h=new V1(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return J($c.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:e,afterCapture:c,afterTileRemoval:u,resultingState:h}}),h}applyLegalMovement(t,e){const r=e.applyLegalMovement(t),s=r.removeTilesIfNeeded(t.getStart(),!0),i=s.doMovementCaptures(t),o=new V1(i.board,e.turn+1,i.tiles,i.captures);return J($c.VERBOSE,{ab_state:e,afterMovement:r,afterTilesRemoved:s,afterCaptures:i,resultingState:o}),o}isLegal(t,e){return y8.isTileExchange(t)?this.isLegalTileExchange(t,e):this.isLegalMovement(t,e)}isLegalTileExchange(t,e){if(e.tiles[e.getCurrentPlayer().value]<2)return R.failure(r_.NOT_ENOUGH_TILES_TO_EXCHANGE());const r=e.getPieceAt(t.coord);return r===xe.UNREACHABLE||r===xe.EMPTY?R.failure(r_.CANNOT_CAPTURE_FROM_EMPTY()):r.is(e.getCurrentPlayer())?R.failure(Xe.CANNOT_SELF_CAPTURE()):R.SUCCESS}isLegalMovement(t,e){ge.assert(e.getPieceAt(t.getStart())!==xe.UNREACHABLE,"Cannot start with a coord outside the board "+t.getStart().toString()+"."),ge.assert(e.getPieceAt(t.getEnd())!==xe.UNREACHABLE,"Cannot end with a coord outside the board "+t.getEnd().toString()+".");const r=e.getPieceAt(t.getStart());return r===xe.EMPTY?R.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r.is(e.getCurrentOpponent())?R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):e.getPieceAt(t.getEnd()).is(e.getCurrentPlayer())?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):R.SUCCESS}static getGameStatus(t){const e=t.gameState;return e.captures[0]>=18?Ie.ZERO_WON:e.captures[1]>=18?Ie.ONE_WON:Ie.ONGOING}getGameStatus(t){return $c.getGameStatus(t)}}$c.VERBOSE=!1,$c.singleton=y.empty();class p3e extends ks{getListMoves(t){let e=this.getListExchanges(t);return e=e.concat(this.getListMovement(t)),this.putCaptureFirst(t,e)}getListExchanges(t){const e=[],r=t.gameState,s=r.getCurrentPlayer().value,i=xe.ofPlayer(r.getCurrentOpponent());if(r.tiles[s]<2)return e;for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new S(c,o);if(r.getPieceAt(u)===i){const h=P6.of(u);e.push(h)}}return e}getListMovement(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<10;i++)for(let o=0;o<15;o++){const c=new S(o,i);if(r.getPieceAt(c).is(s)){const u=r.getLegalLandings(c);for(const h of u){const g=Qi.of(c,h);e.push(g)}}}return e}getMetrics(t){const e=t.gameState,r=e.getPiecesByFreedom(),s=this.getPiecesScore(r);return[2*e.captures[0]+s[0],2*e.captures[1]+s[1]]}getPiecesScore(t){return[this.getPlayerPiecesScore(t[0]),this.getPlayerPiecesScore(t[1])]}getPlayerPiecesScore(t){return 3*t[0]+1*t[1]+3*t[2]+3*t[3]}putCaptureFirst(t,e){return Je.sortByDescending(e,r=>this.moveCapturesList(t,r).length),e}moveCapturesList(t,e){return y8.isTileExchange(e)?[e.coord]:t.gameState.applyLegalMovement(e).removeTilesIfNeeded(e.getStart(),!0).getCapturedNeighbors(e.getEnd())}}let J4t=(()=>{class n extends p3e{getMetrics(e){const r=e.gameState,s=this.getPiecesMap(r),i=this.getThreatMap(r,s),o=this.filterThreatMap(i,r),c=[0,0];for(const u of B.PLAYERS){for(const h of s.get(u).get())o.get(h).isPresent()?c[u.value]+=n.SCORE_BY_THREATENED_PIECE:c[u.value]+=n.SCORE_BY_SAFE_PIECE;c[u.value]+=r.tiles[u.value]}return c}getPiecesMap(e){const r=new jn,s=[],i=[];for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new S(c,o),h=e.getPieceAt(u);h===xe.ZERO?s.push(u):h===xe.ONE&&i.push(u)}return r.set(B.ZERO,new kr(s)),r.set(B.ONE,new kr(i)),r}getThreatMap(e,r){const s=new jn;for(const i of B.PLAYERS)for(const o of r.get(i).get()){const c=this.getThreat(o,e);c.isPresent()&&s.set(o,c.get())}return s}getThreat(e,r){const i=B.of(r.getPieceAt(e).value).getOpponent();let o=y.empty(),c=y.empty(),u=[];const h=Bc.getNeighbors(e).filter(g=>g.isInRange(15,10));for(const g of h){const m=r.getPieceAt(g);if(m.is(i))u.push(g),this.tileCouldBeRemovedThisTurn(g,r,i)&&(c=y.of(g));else if(m===xe.EMPTY){if(o.isPresent())return y.empty();o=y.of(g)}}if(o.isPresent()){const g=[];for(const m of _r.STEPS){const E=o.get().getNext(m.direction,1);E.isInRange(15,10)&&r.getPieceAt(E).is(i)&&!1===u.some(O=>O.equals(E))&&g.push(E)}if(g.length>0)return y.of(new kP(new kr(u),new kr(g)))}if(c.isPresent()){u=u.filter(m=>m.equals(c.get()));const g=new kr(u);return y.of(new kP(g,new kr([c.get()])))}return y.empty()}tileCouldBeRemovedThisTurn(e,r,s){const i=s.getOpponent();if(!1===r.isDeconnectable(e))return!1;let c=y.empty();const u=V1.getTilesUpperLeftCoord(e);for(let h=0;h<2;h++)for(let g=0;g<3;g++){const m=u.getNext(new $t(g,h),1);if(r.getPieceAt(m).is(s)){if(!this.pieceCouldLeaveTheTile(m,r))return!1;c=y.of(m)}else if(r.getPieceAt(m).is(i))return!1}return c.isPresent()}pieceCouldLeaveTheTile(e,r){const s=V1.getTilesUpperLeftCoord(e);for(const i of _r.STEPS){const o=e.getNext(i.direction,1),c=V1.getTilesUpperLeftCoord(o);if(!1===s.equals(c)&&r.getPieceAt(o)===xe.EMPTY)return!0}return!1}filterThreatMap(e,r){const s=new jn,i=e.listKeys(),o=i.filter(u=>r.getPieceAt(u).is(r.getCurrentPlayer())),c=new kr(i.filter(u=>r.getPieceAt(u).is(r.getCurrentOpponent())));for(const u of o){const h=e.get(u).get();let g=y.empty();for(const m of h.directThreats)if(!1===c.contains(m)){const E=[];for(const O of h.mover)!1===c.contains(O)&&E.push(O);E.length>0&&(g=y.of(new kP(h.directThreats,new kr(E))))}g.isPresent()&&s.set(u,g.get())}for(const u of c){const h=e.get(u).get();s.set(u,h)}return s}}return n.SCORE_BY_THREATENED_PIECE=1e3,n.SCORE_BY_SAFE_PIECE=1e6,n})();const pe=xe.EMPTY,$=xe.UNREACHABLE,W1=xe.ZERO,t1=xe.ONE;class g3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,V1.getInitialState()),te.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,V1.getInitialState(),Qi.of(new S(3,5),new S(5,5)),$localize`Congratulations! Let's see captures now.`),te.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new V1([[$,$,$,$,$,$,W1,pe,W1,$,$,$,$,$,$],[$,$,$,W1,pe,pe,pe,pe,pe,W1,pe,pe,$,$,$],[pe,t1,pe,t1,W1,t1,pe,pe,W1,pe,pe,t1,pe,t1,pe],[t1,pe,pe,pe,pe,pe,pe,pe,pe,pe,t1,pe,pe,pe,t1],[pe,t1,pe,t1,pe,pe,pe,pe,pe,pe,pe,t1,pe,t1,pe],[pe,W1,pe,W1,pe,pe,pe,pe,pe,pe,pe,W1,pe,W1,pe],[W1,pe,pe,pe,W1,pe,pe,pe,pe,pe,W1,pe,pe,pe,W1],[pe,W1,pe,W1,pe,pe,t1,pe,t1,pe,pe,W1,pe,W1,pe],[$,$,$,pe,pe,t1,pe,pe,pe,t1,pe,pe,$,$,$],[$,$,$,$,$,$,t1,pe,t1,$,$,$,$,$,$]],3,[0,0],[0,0]),[Qi.of(new S(5,2),new S(4,1)),Qi.of(new S(3,4),new S(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),te.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new V1([[$,$,$,$,$,$,pe,pe,pe,$,$,$,$,$,$],[$,$,$,$,$,$,t1,pe,pe,$,$,$,$,$,$],[pe,pe,pe,$,$,$,pe,pe,pe,$,$,$,$,$,$],[pe,pe,t1,pe,pe,pe,pe,W1,pe,$,$,$,$,$,$],[pe,pe,pe,t1,pe,pe,pe,pe,pe,$,$,$,$,$,$],[pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,W1,$,$,$],[pe,pe,W1,pe,pe,t1,pe,pe,pe,pe,W1,pe,pe,pe,W1],[pe,pe,pe,pe,pe,pe,t1,pe,t1,pe,pe,W1,pe,W1,pe],[$,$,$,pe,pe,t1,pe,pe,pe,t1,pe,pe,$,$,$],[$,$,$,$,$,$,t1,pe,t1,$,$,$,$,$,$]],2,[0,0],[0,0]),[Qi.of(new S(2,6),new S(4,6)),Qi.of(new S(2,6),new S(3,5)),Qi.of(new S(2,6),new S(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),te.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new V1([[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,pe,pe,W1,$,$,$,$,$,$,$,$,$],[$,$,$,pe,pe,pe,pe,pe,pe,$,$,$,$,$,$],[$,$,$,pe,pe,pe,t1,pe,t1,$,$,$,$,$,$],[$,$,$,pe,pe,t1,pe,pe,pe,$,$,$,$,$,$],[$,$,$,$,$,$,t1,pe,t1,$,$,$,$,$,$]],1,[0,2],[0,0]),[P6.of(new S(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),te.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new V1([[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,pe,pe,W1,$,$,$,$,$,$],[$,$,$,pe,pe,W1,pe,pe,pe,$,$,$,$,$,$],[$,$,$,pe,W1,t1,pe,t1,pe,$,$,$,$,$,$],[$,$,$,pe,t1,W1,pe,pe,pe,$,$,$,$,$,$],[$,$,$,pe,pe,t1,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$]],1,[0,0],[0,0]),[Qi.of(new S(7,6),new S(6,5)),Qi.of(new S(7,6),new S(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)]}}function elt(n,t){if(1&n&&(H(),X(0,"polygon",9)),2&n){const e=C().index,r=C().index,s=C();Le("id","pyramid_",e,"_",r,""),w("ngClass",s.getPyramidClass(e,r)),z("points",s.getPyramidCoordinate(e,r))}}function tlt(n,t){if(1&n&&(H(),X(0,"polygon",11)),2&n){const e=C(2).index,r=C().index,s=C();Le("id","empty_",e,"_",r,""),w("ngClass",s.getEmptyClass(e,r)),z("points",s.getTriangleCoordinate(e,r))}}function nlt(n,t){if(1&n&&(H(),x(0,tlt,1,4,"polygon",10)),2&n){const e=C().index,r=C().index;w("ngIf",C().isEmptySpace(e,r))}}function rlt(n,t){if(1&n&&(H(),b(0,"g"),X(1,"polygon",12)(2,"polygon",13),A()),2&n){const e=C().index,r=C().index,s=C();T(1),Le("id","base_line_",e,"_",r,""),z("points",s.getLineCoordinate(e,r)),T(1),Le("id","white_stroke_line_",e,"_",r,""),z("points",s.getLineCoordinate(e,r))}}function slt(n,t){if(1&n){const e=Ae();H(),b(0,"g",5),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),x(1,elt,1,4,"polygon",6),x(2,nlt,1,1,"ng-template",null,7,qn),x(4,rlt,3,6,"g",8),A()}if(2&n){const e=t.$implicit,r=t.index,s=Hn(3),i=C().index,o=C();Le("id","click_",r,"_",i,""),T(1),w("ngIf",o.isPyramid(r,i))("ngIfElse",s),T(3),w("ngIf",e!==o.NONE)}}function ilt(n,t){if(1&n&&(H(),b(0,"g"),x(1,slt,5,5,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function olt(n,t){if(1&n&&(H(),X(0,"polygon",16)),2&n){const e=t.$implicit;z("points",C(2).getTriangleCoordinate(e.x,e.y))}}function alt(n,t){if(1&n&&(H(),b(0,"g"),X(1,"polygon",14),x(2,olt,1,1,"polygon",15),A()),2&n){const e=C();T(1),Le("id","selected_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),z("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y)),T(1),w("ngForOf",e.possibleLandings)}}function clt(n,t){if(1&n&&(H(),X(0,"polygon",18)),2&n){const e=C(2);Le("id","last_start_",e.lastStart.get().x,"_",e.lastStart.get().y,""),z("points",e.getTriangleCoordinate(e.lastStart.get().x,e.lastStart.get().y))}}function llt(n,t){if(1&n&&(H(),X(0,"polygon",18)),2&n){const e=C(2);Le("id","last_end_",e.lastEnd.get().x,"_",e.lastEnd.get().y,""),z("points",e.getTriangleCoordinate(e.lastEnd.get().x,e.lastEnd.get().y))}}function ult(n,t){if(1&n&&(H(),x(0,clt,1,3,"polygon",17),x(1,llt,1,3,"polygon",17)),2&n){const e=C();w("ngIf",e.lastStart.isPresent()),T(1),w("ngIf",e.lastEnd.isPresent())}}const flt=function(n){return["base",n]};function hlt(n,t){if(1&n&&(H(),b(0,"g",20),X(1,"polygon",21),b(2,"text",22),wt(3),A()()),2&n){const e=C().$implicit,r=C();w("id","tilesCount"+e),T(1),w("ngClass",I3(8,flt,"player"+e+"-fill")),z("points",r.getTilesCountCoordinate(0===e?0:4.5,0===e?0:6))("stroke",r.lastTurnWasTilesExchange(e)?"yellow":"black"),T(1),z("x",r.SPACE_SIZE/2+r.SPACE_SIZE*(0===e?0:6.4))("y",16+r.SPACE_SIZE/2+r.SPACE_SIZE*(0===e?0:8.5))("font-size",r.SPACE_SIZE/2),T(1),c1(r.tiles[e])}}function dlt(n,t){if(1&n&&(H(),b(0,"g"),x(1,hlt,4,10,"g",19),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngIf",r.mustShowTilesOf(e))}}const plt=function(){return[0,1]};let glt=(()=>{class n extends d3e{constructor(e){super(e),this.tiles=[0,0],this.NONE=xe.UNREACHABLE,this.chosenCoord=y.empty(),this.lastStart=y.empty(),this.lastEnd=y.empty(),this.possibleLandings=[],this.scores=y.of([0,0]),this.rules=$c.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new p3e(this.rules,"Normal"),new J4t(this.rules,"Piece > Threat > Tiles")],this.encoder=y8.encoder,this.tutorial=(new g3e).tutorial,this.SPACE_SIZE=70,this.updateBoard()}updateBoard(){this.chosenCoord=y.empty(),this.state=this.getState(),this.scores=y.of(this.state.captures),this.tiles=this.state.tiles,this.board=this.getState().board}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=y.empty(),this.possibleLandings=[]}showLastMove(e){e instanceof Qi?(this.lastStart=y.of(e.getStart()),this.lastEnd=y.of(e.getEnd())):(this.lastStart=y.empty(),this.lastEnd=y.empty())}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(o)?(s.cancelMoveAttempt(),R.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(o).is(c)?s.firstClick(o):s.secondClick(o)})()}firstClick(e){var r=this;return I(function*(){const s=r.state.getPieceAt(e);if(s.is(r.state.getCurrentOpponent())){const i=P6.of(e);return r.chooseMove(i)}return s.is(r.state.getCurrentPlayer())?(r.chosenCoord=y.of(e),r.showHighlight(),R.SUCCESS):r.cancelMove(r_.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(e){var r=this;return I(function*(){if(r.possibleLandings.some(s=>s.equals(e))){const s=Qi.of(r.chosenCoord.get(),e);return r.chooseMove(s)}return r.cancelMove(r_.INVALID_DISTANCE())})()}isPyramid(e,r){return this.board[r][e].isPlayer()||this.wasOpponent(e,r)}wasOpponent(e,r){const s=this.node.mother;return s.isPresent()&&s.get().gameState.getPieceAtXY(e,r).is(s.get().gameState.getCurrentOpponent())}getPyramidClass(e,r){const s=this.board[r][e];return s===xe.ZERO?this.getPlayerClass(B.ZERO):s===xe.ONE?this.getPlayerClass(B.ONE):"captured-fill"}isEmptySpace(e,r){return this.board[r][e]===xe.EMPTY||this.wasRemoved(e,r)}wasRemoved(e,r){const i=this.node.mother;if(this.board[r][e]===xe.UNREACHABLE&&i.isPresent()){const o=i.get().gameState.getPieceAtXY(e,r);return o===xe.EMPTY||o.is(i.get().gameState.getCurrentPlayer())}return!1}getEmptyClass(e,r){return this.board[r][e]===xe.EMPTY?(e+r)%2==1?"background":"background2":"captured-alternate-fill"}getTilesCountCoordinate(e,r){const s=100*e,i=100*r,o=s+25;return o+", "+i+", "+(s+75)+", "+i+", "+(s+100)+", "+(i+50)+", "+(s+75)+", "+(i+100)+", "+(s+25)+", "+(i+100)+", "+(s+0)+", "+(i+50)+", "+o+", "+i}getLineCoordinate(e,r){const s=this.getTriangleCornerCoords(e,r);return e%3==0?s[0].x+","+s[0].y+","+s[1].x+","+s[1].y:e%3==1?s[0].x+","+s[0].y+","+s[2].x+","+s[2].y:s[1].x+","+s[1].y+","+s[2].x+","+s[2].y}mustShowTilesOf(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}lastTurnWasTilesExchange(e){return!this.node.mother.isAbsent()&&this.getPreviousState().tiles[e]>this.tiles[e]}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-coerceo"]],features:[l],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf","ngIfElse"],["emptySpace",""],[4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"id","ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","selected-stroke",3,"id"],["class","base no-fill selectable-stroke",4,"ngFor","ngForOf"],[1,"base","no-fill","selectable-stroke"],["class","base no-fill last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount",1,"text-giant"]],template:function(e,r){if(1&e&&(H(),b(0,"svg",0),x(1,ilt,2,1,"g",1),x(2,alt,3,4,"g",2),x(3,ult,2,2,"ng-template",null,3,qn),x(5,dlt,2,1,"g",1),A()),2&e){const s=Hn(4);z("viewBox","-5 -5 "+(10+8*r.SPACE_SIZE)+" "+(10+10*r.SPACE_SIZE)),T(1),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent())("ngIfElse",s),T(3),w("ngForOf",er(5,plt))}},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class mlt extends ks{getListMoves(t){return this.sortByNumberOfJump(t.gameState.turn<40?this.getListMovesDrop(t.gameState):this.getListMovesAfterDrop(t.gameState))}sortByNumberOfJump(t){return t.sort((e,r)=>{const s=yi.isDrop(e)?1:yi.isSimple(e)?2:e.coords.length;return(yi.isDrop(r)?1:yi.isSimple(r)?2:r.coords.length)-s})}getListMovesDrop(t){const e=[],r=jt.CENTRAL_ZONE_TOP_LEFT,s=jt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let i=r.y;i<=s.y;i++)for(let o=r.x;o<=s.x;o++)t.getPieceAtXY(o,i)===ue.NONE&&e.push(E6.of(new S(o,i)));return e}getListMovesAfterDrop(t){let e=[];const r=t.getCurrentPlayer();for(let s=0;s<jt.HEIGHT;s++)for(let i=0;i<jt.WIDTH;i++){const o=new S(i,s);t.getPieceAt(o)===r&&(e=e.concat(this.getListSimpleMoves(t,o)),e=e.concat(this.getListJumps(t,o)))}return e}getListSimpleMoves(t,e){const r=[],s=[new S(e.x+1,e.y),new S(e.x-1,e.y),new S(e.x,e.y+1),new S(e.x,e.y-1),new S(e.x+1,e.y+1),new S(e.x+1,e.y-1),new S(e.x-1,e.y+1),new S(e.x-1,e.y-1)];for(const i of s){const o=M6.from(e,i);o.isSuccess()&&cc.get().simpleMoveLegality(o.get(),t).isSuccess()&&r.push(o.get())}return r}getListJumps(t,e){const r=new bt;for(const s of cc.get().jumpTargetsFrom(e)){const i=Fc.from([e,s]).get();cc.get().jumpLegality(i,t).isSuccess()&&(r.add(i),r.addAll(this.getListJumpStartingFrom(t,i)))}return r.toList()}getListJumpStartingFrom(t,e){const r=cc.get().nextJumps(e,t),s=new bt(r);for(const i of r)s.addAll(this.getListJumpStartingFrom(t,i));return s}getMetrics(t){const e=t.gameState,r=[0,0];for(let s=0;s<jt.HEIGHT;s++)for(let i=0;i<jt.WIDTH;i++){const o=new S(i,s),c=e.getPieceAt(o);if(c.isPlayer())if(e.isShelter(o))r[c.value]+=20;else{let u=100;for(const h of jt.ALL_SHELTERS)if(e.getPieceAt(h)===ue.NONE){const g=o.getOrthogonalDistance(h);u=Math.min(u,g)}r[c.value]-=u}}return r}}function _lt(n,t){if(1&n){const e=Ae();H(),b(0,"rect",9),ee("click",function(){de(e);const s=C().$implicit;return le(C(2).onClick(s.coord))}),A()}if(2&n){const e=C().$implicit,r=C(2);z("x",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.x+r.STROKE_WIDTH)("y",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE-3*r.STROKE_WIDTH)("height",r.SPACE_SIZE-3*r.STROKE_WIDTH)}}function vlt(n,t){if(1&n){const e=Ae();H(),b(0,"circle",6),ee("click",function(){de(e);const s=C().$implicit;return le(C(2).onClick(s.coord))}),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();Le("id","piece_",r,"_",i,""),w("ngClass",s.pieceClasses),z("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Clt(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",6),ee("click",function(){const i=de(e).$implicit;return le(C(2).onClick(i.coord))}),A(),x(2,_lt,1,4,"rect",7),x(3,vlt,1,6,"circle",8),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Le("id","click_",r,"_",s,""),w("ngClass",e.squareClasses),z("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e.isShelter),T(1),w("ngIf",e.hasPiece)}}function ylt(n,t){if(1&n&&(H(),b(0,"g"),x(1,Clt,4,9,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function Elt(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",10),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),w("ngClass",r.viewInfo.boardInfo[e.y][e.x].shelterClasses),z("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function Mlt(n,t){if(1&n&&(H(),X(0,"circle",11)),2&n){const e=t.$implicit,r=C();p1("id","sidePiece_0_",e,""),z("cx",-r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Slt(n,t){if(1&n&&(H(),X(0,"circle",12)),2&n){const e=t.$implicit,r=C();p1("id","sidePiece_1_",e,""),z("cx",1715+r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Plt(n,t){if(1&n&&(H(),X(0,"rect",13)),2&n){const e=C();z("x",e.SPACE_SIZE*e.CENTRAL_ZONE_START.x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.CENTRAL_ZONE_START.y+e.STROKE_WIDTH)("width",e.CENTRAL_ZONE_SIZE.x*e.SPACE_SIZE)("height",e.CENTRAL_ZONE_SIZE.y*e.SPACE_SIZE)}}let Tlt=(()=>{class n extends m8{constructor(e){super(e),this.ALL_SHELTERS=jt.ALL_SHELTERS,this.CENTRAL_ZONE_START=jt.CENTRAL_ZONE_TOP_LEFT,this.CENTRAL_ZONE_SIZE=new $t(jt.CENTRAL_ZONE_BOTTOM_RIGHT.x-jt.CENTRAL_ZONE_TOP_LEFT.x+1,jt.CENTRAL_ZONE_BOTTOM_RIGHT.y-jt.CENTRAL_ZONE_TOP_LEFT.y+1),this.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},this.selected=y.empty(),this.jumpInConstruction=y.empty(),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=cc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new mlt(this.rules,"ConspirateursMinimax")],this.encoder=yi.encoder,this.tutorial=(new l3e).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo()}updateViewInfo(){const e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let r=0;r<jt.HEIGHT;r++){this.viewInfo.boardInfo.push([]);for(let s=0;s<jt.WIDTH;s++){const i=new S(s,r),o=e.getPieceAt(i),c={coord:i,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(o)],hasPiece:o.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[r].push(c)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const e of jt.ALL_SHELTERS){const r=this.viewInfo.boardInfo[e.y][e.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const e=this.jumpInConstruction.get(),r=e.getStartingCoord(),s=e.getEndingCoord();this.viewInfo.boardInfo[r.y][r.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const i of e.coords)this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("moved-fill")}else{const e=this.selected.get();this.viewInfo.boardInfo[e.y][e.x].pieceClasses.push("selected-stroke")}}updateVictory(){const e=this.getState(),r=cc.get().getGameStatus(this.node);if(!0===r.isEndGame)for(const s of jt.ALL_SHELTERS)e.getPieceAt(s)===r.winner&&this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("victory-fill")}showLastMove(e){if(yi.isDrop(e))this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill");else if(yi.isSimple(e))this.viewInfo.boardInfo[e.getStart().y][e.getStart().x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[e.getEnd().y][e.getEnd().x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";for(const r of e.coords)this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=y.empty(),this.selected=y.empty(),this.updateBoard()}onClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());const i=r.getState();if(i.getPieceAt(e)===r.getCurrentPlayer())return r.selected.equalsValue(e)?r.cancelMoveAttempt():(r.selected=y.of(e),r.jumpInConstruction=y.empty()),r.updateViewInfo(),R.SUCCESS;if(r.jumpInConstruction.isPresent())return r.constructJump(e);if(r.selected.isPresent())return r.selectNextCoord(e);if(i.isDropPhase()){const o=E6.of(e);return r.chooseMove(o)}return r.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(e){var r=this;return I(function*(){const s=r.jumpInConstruction.get(),i=r.getState();if(e.equals(s.getEndingCoord()))return r.chooseMove(s);{const o=s.addJump(e);if(o.isFailure())return r.cancelMove(o.getReason());const c=r.rules.jumpLegality(o.get(),i);return c.isFailure()?r.cancelMove(c.getReason()):r.updateJump(o.get())}})()}updateJump(e){var r=this;return I(function*(){const s=r.getState();return r.rules.jumpHasPossibleNextTargets(e,s)?(r.jumpInConstruction=y.of(e),r.updateViewInfo(),R.SUCCESS):r.chooseMove(e)})()}selectNextCoord(e){var r=this;return I(function*(){const s=r.selected.get(),i=M6.from(s,e);if(i.isSuccess())return r.chooseMove(i.get());{const o=Fc.from([s,e]);return o.isFailure()?r.cancelMove(o.getReason()):r.updateJump(o.get())}})()}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-conspirateurs"]],features:[l],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,ylt,2,1,"g",1),x(2,Elt,2,5,"g",1),x(3,Mlt,1,4,"circle",2),x(4,Slt,1,4,"circle",3),x(5,Plt,1,4,"rect",4),X(6,"polyline",5),A()),2&e&&(T(1),w("ngForOf",r.viewInfo.boardInfo),T(1),w("ngForOf",r.ALL_SHELTERS),T(1),w("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[0])),T(1),w("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[1])),T(1),w("ngIf",r.viewInfo.dropPhase),T(1),z("points",r.viewInfo.lastMoveArrow))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class wlt extends ks{getListMoves(t){const e=t.gameState,r=this.getListDrops(e),s=this.getListShifts(e);return r.concat(s)}getListShifts(t){const e=[],r=this.getShiftSources(t);for(const s of r)for(const i of[new Xi(s,"clockwise"),new Xi(s,"counterclockwise")])q4.get().shiftHeightValidity(i,t).isSuccess()&&e.push(i);return e}getListDrops(t){const e=this.getRemainingPiecesForCurrentPlayer(t),r=[];for(let s=0;s<Ur.WIDTH;s++)for(const i of e){const o=new S6(s,i);q4.get().dropHeightValidity(o,t).isSuccess()&&r.push(o)}return r}getRemainingPiecesForCurrentPlayer(t){const e=[];for(const r of wn.PLAYER_PIECES)this.currentPlayerCanDropPiece(t,r)&&e.push(r);return e}currentPlayerCanDropPiece(t,e){return t.getCurrentPlayer()===e.owner&&t.getRemainingPiecesOf(e)>0}getShiftSources(t){const e=[],r=t.getCurrentPlayer();for(let s=0;s<Ur.HEIGHT;s++)for(let i=0;i<Ur.WIDTH;i++)t.getPieceAtXY(i,s).owner===r&&e.push(new S(i,s));return e}getMetrics(t){return[0,0]}}function Olt(n,t){if(1&n){const e=Ae();H(),b(0,"g",6)(1,"path",7),ee("click",function(){const i=de(e).$implicit;return le(C().onSpaceClick(i))}),A(),b(2,"path",8),ee("click",function(){const i=de(e).$implicit;return le(C().onSpaceClick(i))}),A()()}if(2&n){const e=t.$implicit,r=C();p1("id","board_space_",e,""),T(1),p1("id","click_",e,""),w("ngClass",r.viewInfo.boardInfo[e].spaceClasses),z("d",r.BOARD_PATHS[e]),T(1),w("ngClass",r.viewInfo.boardInfo[e].spaceClasses),z("d",r.DECORATION_PATHS[e])}}function blt(n,t){if(1&n){const e=Ae();H(),b(0,"g",10),ee("click",function(){const i=de(e).$implicit,o=C().$implicit;return le(C().onPieceInGameClick(o,i.y))}),X(1,"use",11)(2,"use",12),A()}if(2&n){const e=t.$implicit;Le("id","click_",C().$implicit,"_",e.y,""),w("ngClass",e.foregroundClasses),T(1),w("ngClass",e.backgroundClasses),z("x",e.drawPosition.x)("y",e.drawPosition.y),T(1),z("x",e.drawPosition.x)("y",e.drawPosition.y)}}function Alt(n,t){if(1&n&&(H(),b(0,"g"),x(1,blt,3,8,"g",9),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",r.viewInfo.boardInfo[e].pieces)}}function Nlt(n,t){if(1&n){const e=Ae();H(),b(0,"g",14),ee("click",function(){const s=de(e),i=s.$implicit,o=s.index;return le(C(2).onRemainingPieceClick(i.actualPiece,o))}),X(1,"use",11)(2,"use",12),A()}if(2&n){const e=t.$implicit,r=t.index;J2("id","piece_",e.actualPiece.owner.toString(),"_",e.actualPiece.otherPieceType?1:0,"_",r,""),w("ngClass",e.foregroundClasses),T(1),w("ngClass",e.backgroundClasses),z("x",e.drawPosition.x)("y",e.drawPosition.y),T(1),z("x",e.drawPosition.x)("y",e.drawPosition.y)}}function Ilt(n,t){if(1&n&&(H(),b(0,"g"),x(1,Nlt,3,9,"g",13),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",r.viewInfo.remainingPieces.get(e).get())}}const xlt=function(){return[0,1,2,3,4,5,6,7]},klt=function(){return[2,1,3,0,4,7,5,6]};class B3 extends m8{constructor(t){super(t),this.BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],this.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],this.selected=y.empty(),this.viewInfo={boardInfo:[],remainingPieces:new jn([{key:B.ZERO,value:[]},{key:B.ONE,value:[]}])},this.rules=q4.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new wlt(this.rules,"DiamDummyMinimax")],this.encoder=Q4t,this.tutorial=(new h3e).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(t){var e=this;return I(function*(){const r=e.canUserPlay("#click_"+t);return r.isFailure()?e.cancelMove(r.getReason()):e.onSpaceClickAfterCheck(t)})()}onSpaceClickAfterCheck(t){var e=this;return I(function*(){if(e.selected.isPresent()){const r=e.selected.get();let s;if("pieceFromReserve"===r.type)s=new S6(t,r.piece);else if((r.position.x+1)%Ur.WIDTH===t)s=new Xi(r.position,"clockwise");else{if((r.position.x+(Ur.WIDTH-1))%Ur.WIDTH!==t)return e.cancelMove(n_.MUST_SHIFT_TO_NEIGHBOR());s=new Xi(r.position,"counterclockwise")}return e.chooseMove(s)}return e.cancelMove(n_.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(t,e);return r.getState().getPieceAt(i).owner===r.getCurrentPlayer()?(r.isSelected(null,i)?r.cancelMoveAttempt():r.selected=y.of({type:"pieceFromBoard",position:i}),r.updateViewInfo(),R.SUCCESS):r.selected.isPresent()?r.onSpaceClickAfterCheck(t):r.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(t,e){var r=this;return I(function*(){const s=r.canUserPlay(r.getPieceId(t,e));return s.isFailure()?r.cancelMove(s.getReason()):t.owner===r.getCurrentPlayer()?(r.selected=r.isSelected(t)?y.empty():y.of({type:"pieceFromReserve",piece:t}),r.updateViewInfo(),R.SUCCESS):r.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(t,e){return"#piece_"+t.owner.toString()+"_"+(t.otherPieceType?1:0)+"_"+e}isSelected(t,e){return!this.selected.isAbsent()&&(null==t&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(e):this.selected.get().piece===t)}updateBoard(){this.updateViewInfo()}getLastMovedFromDrop(t,e){const r=this.getDrawPositionRemainingPiece(t.piece,e.getRemainingPiecesOf(t.piece)-1),s=t.getTarget(),i=e.getStackHeight(t.getTarget()),o=this.getDrawPositionOnBoard(s,i),c=new S(s,i);return[{start:y.empty(),end:c,startDrawPosition:r,endDrawPosition:o}]}getLastMovedFromShift(t,e){const r=t.start.x,s=t.getTarget();let i=e.getStackHeight(s);const o=[];for(let c=t.start.y;c<Ur.HEIGHT&&e.getPieceAtXY(r,c)!==wn.EMPTY;c++,i++)o.push({start:y.of(new S(r,c)),end:new S(s,i),startDrawPosition:this.getDrawPositionOnBoard(r,c),endDrawPosition:this.getDrawPositionOnBoard(s,i)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let t=0;t<Ur.WIDTH;t++)this.viewInfo.boardInfo[t]={x:t,spaceClasses:[],pieces:this.getPieces(t)}}showLastMove(t){this.showLastMoveOnSpaces(t),this.showLastMoveOnPieces(t)}showLastMoveOnSpaces(t){for(let e=0;e<Ur.WIDTH;e++){const r=[];if(t.isDrop())t.getTarget()===e&&r.push("moved-fill");else{const s=t;(s.getTarget()===e||s.start.x===e)&&r.push("moved-fill")}this.viewInfo.boardInfo[e].spaceClasses=r}}showLastMoveOnPieces(t){const e=this.getPreviousState();let r=[];r=t.isDrop()?this.getLastMovedFromDrop(t,e):this.getLastMovedFromShift(t,e);for(const s of r)this.viewInfo.boardInfo[s.end.x].pieces[s.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const t=this.getCurrentPlayer();this.viewInfo.remainingPieces=new jn([{key:B.ZERO,value:[]},{key:B.ONE,value:[]}]);const e=this.isPlayerTurn();for(const r of wn.PLAYER_PIECES){const s=this.getState().getRemainingPiecesOf(r);for(let i=0;i<s;i++){const o=[];this.isTopPieceOfReserveAndSelected(i,s,r)&&o.push("selected-stroke"),e&&i===s-1&&r.owner===t&&o.push("clickable-stroke-hover");const c=this.viewInfo.remainingPieces.get(r.owner).get(),u=[];u.push(r.otherPieceType?"player"+r.owner.value+"-alternate-fill":"player"+r.owner.value+"-fill"),c.push({backgroundClasses:u,foregroundClasses:o,y:i,drawPosition:this.getDrawPositionRemainingPiece(r,i),actualPiece:r}),this.viewInfo.remainingPieces.put(r.owner,c)}}}isTopPieceOfReserveAndSelected(t,e,r){if(this.selected.isPresent()){const s=this.selected.get();return"pieceFromReserve"===s.type&&s.piece===r&&t===e-1}return!1}getDrawPositionRemainingPiece(t,e){let r,s;return r=t.owner===B.ZERO?-100:600,s=t.otherPieceType?100:450,new S(r,s).getNext(new $t(0,-e*B3.PIECE_HEIGHT))}getPieces(t){const e=this.rules.findHighestAlignment(this.getState()),r=this.isPlayerTurn(),s=[];for(let i=0;i<Ur.HEIGHT;i++){const o=this.getState().getPieceAtXY(t,i),c=new S(t,i);if(o!==wn.EMPTY){const u=[];this.pieceFromBoardIsSelected(t,i)&&u.push("selected-stroke"),this.isVictory(t,i,e)&&u.push("victory-stroke"),r&&this.rules.pieceCanMove(this.getState(),c)&&u.push("clickable-stroke-hover"),s.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:u,y:i,drawPosition:this.getDrawPositionOnBoard(t,i),actualPiece:o})}}return s}pieceFromBoardIsSelected(t,e){if(this.selected.isPresent()){const r=this.selected.get();return"pieceFromBoard"===r.type&&r.position.x===t&&r.position.y===e}return!1}isVictory(t,e,r){if(r.isPresent()){const s=r.get();return s.x%4==t%4&&s.y===e}return!1}getDrawPositionOnBoard(t,e){return B3.CENTER[t].getNext(new $t(0,-e*B3.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=y.empty(),this.updateBoard()}}B3.CENTER=[new S(40,160),new S(100,50),new S(255,2),new S(400,50),new S(460,160),new S(400,270),new S(255,320),new S(100,270)],B3.PIECE_HEIGHT=36,B3.\u0275fac=function(t){return new(t||B3)(Q(_n))},B3.\u0275cmp=ct({type:B3,selectors:[["app-diam"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(t,e){1&t&&(H(),b(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),A()(),x(5,Olt,3,6,"g",4),x(6,Alt,2,1,"g",5),x(7,Ilt,2,1,"g",5),A()),2&t&&(T(5),w("ngForOf",er(3,xlt)),T(1),w("ngForOf",er(4,klt)),T(1),w("ngForOf",e.Player.PLAYERS))},dependencies:[hn,En],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class lc{constructor(t,e){this.offset=t,this.constant=e}static fromTwoCoords(t,e){const r=t.x,s=e.x,i=t.y,o=e.y,c=r+i,u=s+o;return r===s&&i!==o&&c!==u?y.of(lc.constantQ(r)):r!==s&&i===o&&c!==u?y.of(lc.constantR(i)):r!==s&&i!==o&&c===u?y.of(lc.constantS(c)):y.empty()}static constantQ(t){return new lc(t,"q")}static constantR(t){return new lc(t,"r")}static constantS(t){return new lc(t,"s")}static areOnSameLine(t){if(t.length<2)return!0;const e=lc.fromTwoCoords(t[0],t[1]);if(e.isAbsent())return!1;const r=e.get();for(const s of t.slice(2))if(!1===r.contains(s))return!1;return!0}toString(){return`Line(${this.constant}, ${this.offset})`}equals(t){return this===t||!(this.offset!==t.offset||this.constant!==t.constant)}contains(t){switch(this.constant){case"q":return t.x===this.offset;case"r":return t.y===this.offset;case"s":return t.x+t.y===this.offset}}getDirection(){switch(this.constant){case"q":return De.DOWN;case"r":return De.RIGHT;case"s":return De.DOWN_LEFT}}}class ZH extends xr{constructor(t,e,r,s,i,o){super(e,t),this.width=r,this.height=s,this.excludedSpaces=i,this.empty=o,We(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(t,e){if(this.isOnBoard(t))return this.setAtUnsafe(t,e);throw new Error("Setting coord not on board: "+t+".")}equalsT(t,e){if(this===t)return!0;if(this.width!==t.width||this.height!==t.height||!1===e(this.empty,t.empty)||this.excludedSpaces.length!==t.excludedSpaces.length)return!1;for(let r=0;r<this.excludedSpaces.length;r++)if(this.excludedSpaces[r]!==t.excludedSpaces[r])return!1;for(const r of this.allCoords())if(!1===e(this.getPieceAt(r),t.getPieceAt(r)))return!1;return!0}allCoords(){const t=[];return this.forEachCoord(e=>{t.push(e)}),t}allLines(){const t=[];for(let e=0;e<this.width;e++)t.push(lc.constantQ(e));for(let e=0;e<this.height;e++)t.push(lc.constantR(e));for(let e=this.excludedSpaces.length;e<this.height+this.excludedSpaces.length;e++)t.push(lc.constantS(e));return t}getEntranceOnLine(t){let e,r;switch(t.constant){case"q":return r=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new S(t.offset,r));case"r":return e=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new S(e,t.offset));case"s":return this.findEntranceFrom(t,t.offset<this.width?new S(t.offset,0):new S(this.width-1,t.offset-this.width+1))}}findEntranceFrom(t,e){const r=t.getDirection();let s=e;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(s))return s;s=s.getNext(r)}const i=Ns.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:e.toString(),line:t.toString()});throw new Error(i.getReason())}}class Ei{static getNeighbors(t,e=1){const r=[];for(const s of De.factory.all)r.push(t.getNext(s,e));return r}static areNeighbors(t,e){for(const r of De.factory.all)if(t.getNext(r).equals(e))return!0;return!1}}class C1{constructor(t,e,r){this.owner=t,this.size=e,this.source=r}static append(t,e){return new C1(t.owner,t.size+e.size,t.source||e.source)}getOwner(){return this.owner}belongsTo(t){return this.owner===t}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(t){return this.owner===t.owner&&this.size===t.size&&this.source===t.source}}C1.encoder=Ye.tuple([Ye.identity(),B.encoder,Ye.identity()],n=>[n.source,n.owner,n.size],n=>new C1(n[1],n[2],n[0])),C1.MAX_SIZE=49,C1.EMPTY=new C1(ue.NONE,0,!1),C1.UNREACHABLE=new C1(ue.NONE,-1,!1),C1.PLAYER_ZERO=new C1(B.ZERO,1,!1),C1.PLAYER_ONE=new C1(B.ONE,1,!1),C1.SOURCE=new C1(ue.NONE,1,!0);let Uc=(()=>{class n extends ZH{constructor(e,r,s){super(r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,C1.EMPTY),this.alreadyPassed=s}static balancedBoard(){const e=C1.UNREACHABLE,r=C1.PLAYER_ZERO,s=C1.PLAYER_ONE,i=C1.SOURCE;return[[e,e,r,s,s,s,r,r,s,i,s],[e,s,s,r,r,r,s,s,r,s,s],[s,s,s,s,r,i,s,r,r,r,r],[r,r,s,r,r,s,s,s,r,r,e],[r,i,r,s,s,r,r,r,s,e,e]]}static isOnBoard(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==C1.UNREACHABLE}static getInitialState(){return new n(n.balancedBoard(),0,!1)}getAllPieces(){const e=[];for(let r=0;r<n.HEIGHT;r++)for(let s=0;s<n.WIDTH;s++){const i=new S(s,r);this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()&&e.push(i)}return e}numberOfNeighbors(e){return Ei.getNeighbors(e,1).filter(i=>this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()).length}setAtUnsafe(e,r){const s=Je.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.turn,this.alreadyPassed)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==C1.UNREACHABLE}}return n.WIDTH=11,n.HEIGHT=5,n.EXCLUDED_SPACES=[2,1],n})(),$5=(()=>{class n{}return n.NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`,n.EMPTY_STACK=()=>$localize`You must select a stack.`,n.TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`,n.CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`,n.INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`,n.EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`,n.MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`A stack must move in a straight line.`,n})();class Gr extends Hc{constructor(t,e){super(t,e)}static from(t,e){return-1===t.x&&-1===t.y&&-2===e.x&&-2===e.y?ve.success(Gr.PASS):Uc.isOnBoard(t)?Uc.isOnBoard(e)?t.y===e.y||t.x===e.x||t.x+t.y===e.x+e.y?ve.success(new Gr(t,e)):ve.failure($5.MUST_MOVE_IN_STRAIGHT_LINE()):ve.failure("End coord of DvonnMove must be on the board, not at "+t.toString()):ve.failure("Starting coord of DvonnMove must be on the board, not at "+t.toString())}toString(){return this===Gr.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}}Gr.PASS=new Gr(new S(-1,-1),new S(-2,-2)),Gr.encoder=Pa.getFallibleEncoder(Gr.from);const _e=C1.EMPTY,qr=C1.UNREACHABLE,E8=C1.SOURCE,Zh=C1.PLAYER_ZERO,Yh=C1.PLAYER_ONE,Llt=new C1(B.ZERO,2,!1),YH=new C1(B.ONE,2,!1),m3e=new C1(B.ZERO,4,!1),Rlt=new C1(B.ONE,4,!1);class _3e extends z1{constructor(){super(...arguments),this.tutorial=[te.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Uc.getInitialState(),Gr.from(new S(2,0),new S(3,0)).get(),$localize`Congratulations!`),te.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Uc([[qr,qr,Yh,E8,_e,_e,_e,_e,_e,_e,_e],[qr,_e,Zh,_e,_e,_e,_e,_e,_e,_e,_e],[_e,_e,Rlt,_e,_e,_e,_e,Yh,E8,_e,_e],[_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,qr],[_e,_e,_e,_e,_e,_e,_e,_e,_e,qr,qr]],0,!1),Gr.from(new S(2,1),new S(2,0)).get(),(t,e,r)=>t.getEnd().equals(new S(3,0))?R.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(We(t.getEnd().equals(new S(2,0)),"player made an impossible move"),R.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),te.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Uc([[qr,qr,E8,Yh,_e,_e,_e,_e,_e,_e,_e],[qr,Zh,Zh,_e,_e,_e,_e,_e,_e,_e,_e],[_e,Yh,Zh,Yh,_e,_e,Zh,YH,E8,_e,_e],[_e,_e,Yh,_e,_e,_e,_e,_e,_e,_e,qr],[_e,_e,_e,_e,_e,_e,_e,_e,_e,qr,qr]],0,!1),Gr.from(new S(2,1),new S(2,0)).get(),(t,e,r)=>t.getEnd().equals(new S(2,0))?R.SUCCESS:R.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),te.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Uc([[qr,qr,E8,_e,_e,_e,_e,_e,_e,_e,_e],[qr,_e,Llt,_e,_e,_e,_e,_e,_e,_e,_e],[_e,_e,YH,_e,_e,_e,_e,YH,E8,m3e,_e],[_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,qr],[_e,_e,_e,_e,_e,_e,_e,_e,_e,qr,qr]],0,!1)),te.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new Uc([[qr,qr,E8,_e,_e,_e,_e,_e,_e,_e,_e],[qr,_e,Zh,_e,_e,_e,_e,_e,_e,_e,_e],[_e,_e,_e,_e,_e,_e,_e,_e,E8,m3e,_e],[_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,qr],[_e,_e,_e,_e,_e,_e,_e,_e,_e,qr,qr]],0,!1),[Gr.from(new S(2,1),new S(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}}class _s extends I1{constructor(){super(Uc)}static get(){return _s.singleton.isAbsent()&&(_s.singleton=y.of(new _s)),_s.singleton.get()}static getGameStatus(t){const e=t.gameState,r=_s.getScores(e);return 0===_s.getMovablePieces(e).length?r[0]>r[1]?Ie.ZERO_WON:r[0]<r[1]?Ie.ONE_WON:Ie.DRAW:Ie.ONGOING}static getMovablePieces(t){return _s.getFreePieces(t).filter(e=>_s.pieceHasTarget(t,e))}static getFreePieces(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).belongsTo(t.getCurrentPlayer())&&t.numberOfNeighbors(e)<6)}static pieceHasTarget(t,e){const r=t.getPieceAt(e).getSize();return void 0!==Ei.getNeighbors(e,r).find(i=>t.isOnBoard(i)&&!t.getPieceAt(i).isEmpty())}static pieceTargets(t,e){const r=t.getPieceAt(e).getSize();return Ei.getNeighbors(e,r).filter(i=>t.isOnBoard(i)&&t.getPieceAt(i).hasPieces())}static getScores(t){let e=0,r=0;return t.getAllPieces().map(s=>{const i=t.getPieceAt(s);i.belongsTo(B.ZERO)?e+=i.getSize():i.belongsTo(B.ONE)&&(r+=i.getSize())}),[e,r]}isMovablePiece(t,e){We(t.isOnBoard(e),"piece is not on the board");const r=t.getPieceAt(e);return r.getSize()<1?R.failure($5.EMPTY_STACK()):r.belongsTo(t.getCurrentPlayer())?t.numberOfNeighbors(e)>=6?R.failure($5.TOO_MANY_NEIGHBORS()):_s.pieceHasTarget(t,e)?R.SUCCESS:R.failure($5.CANT_REACH_TARGET()):R.failure($5.NOT_PLAYER_PIECE())}canOnlyPass(t){return 0===_s.getMovablePieces(t).length}sourceCoords(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).containsSource())}markPiecesConnectedTo(t,e,r){Ei.getNeighbors(e,1).forEach(s=>{t.isOnBoard(s)&&!r[s.y][s.x]&&!t.getPieceAt(s).isEmpty()&&(r[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,r))})}removeDisconnectedPieces(t){const e=Je.createTable(Uc.WIDTH,Uc.HEIGHT,!1);this.sourceCoords(t).forEach(s=>{e[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,e)});let r=t;return r.getAllPieces().forEach(s=>{e[s.y][s.x]||(r=r.setAt(s,C1.EMPTY))}),r}applyLegalMove(t,e,r){if(t===Gr.PASS)return new Uc(e.board,e.turn+1,!0);{const s=e.getPieceAt(t.getStart()),i=e.getPieceAt(t.getEnd()),o=e.setAt(t.getStart(),C1.EMPTY).setAt(t.getEnd(),C1.append(s,i));return this.removeDisconnectedPieces(new Uc(o.board,e.turn+1,!1))}}isLegal(t,e){if(0===_s.getMovablePieces(e).length)return t!==Gr.PASS||e.alreadyPassed?R.failure(Xe.MUST_PASS()):R.SUCCESS;if(t===Gr.PASS)return R.failure(Xe.CANNOT_PASS());const r=this.isMovablePiece(e,t.getStart());if(r.isFailure())return r;const s=e.getPieceAt(t.getStart());return t.length()!==s.getSize()?ve.failure($5.INVALID_MOVE_LENGTH()):e.getPieceAt(t.getEnd()).isEmpty()?ve.failure($5.EMPTY_TARGET_STACK()):ve.success(void 0)}getGameStatus(t){return _s.getGameStatus(t)}}_s.singleton=y.empty();class v3e extends ks{getListMoves(t){const e=t.move,r=t.gameState,s=[];return _s.getMovablePieces(r).forEach(i=>_s.pieceTargets(r,i).forEach(o=>{const c=Gr.from(i,o).get();s.push(c)})),0===s.length&&!1===e.equalsValue(Gr.PASS)&&s.push(Gr.PASS),s}getMetrics(t){return _s.getScores(t.gameState)}}class Dlt extends v3e{getListMoves(t){const e=t.gameState,r=super.getListMoves(t),s=e.getCurrentPlayer().getOpponent();return Je.sortByDescending(r,i=>{We(i!==Gr.PASS,"Cannot sort with DvonnMove.PASS");const o=e.getPieceAt(i.getEnd());return o.belongsTo(s)?o.getSize():0}),r}getMetrics(t){const e=t.gameState,r=_s.getScores(e),s=e.getAllPieces(),i=s.length;for(const o of B.PLAYERS){const c=s.filter(u=>e.getPieceAt(u).belongsTo(o)).length;r[o.value]=r[o.value]*c/i}return r}}function zlt(n,t){if(1&n&&(H(),X(0,"circle",11)),2&n){const e=C().$implicit,r=C().$implicit,s=C();Le("id","piece_",r.x,"_",r.y,""),w("ngClass",s.getPieceClasses(e)),z("cx",s.getCenterAt(r).x)("cy",s.getCenterAt(r).y)("r",s.SPACE_SIZE)}}function Vlt(n,t){if(1&n&&(H(),X(0,"polygon",12)),2&n){const e=C().$implicit,r=C().$implicit,s=C();z("transform",1===e.getSize()?"translate("+(s.getCenterAt(r).x-18)+" "+(s.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(s.getCenterAt(r).x-3)+" "+(s.getCenterAt(r).y-12)+") scale(0.07)")}}function Hlt(n,t){if(1&n){const e=Ae();H(),b(0,"text",13),ee("click",function(){de(e);const s=C(2).$implicit;return le(C().onClick(s.x,s.y))}),wt(1),A()}if(2&n){const e=C().$implicit,r=C().$implicit,s=C();z("x",e.containsSource()?s.getCenterAt(r).x-7:s.getCenterAt(r).x)("y",s.getCenterAt(r).y),T(1),c1(e.getSize())}}function Flt(n,t){if(1&n){const e=Ae();H(),b(0,"g",6),ee("click",function(){de(e);const s=C().$implicit;return le(C().onClick(s.x,s.y))}),X(1,"polygon",7),x(2,zlt,1,6,"circle",8),x(3,Vlt,1,1,"polygon",9),x(4,Hlt,2,3,"text",10),A()}if(2&n){const e=t.$implicit,r=C().$implicit,s=C();Le("id","click_",r.x,"_",r.y,""),T(1),z("points",s.getHexaPointsAt(r)),T(1),w("ngIf",e.getSize()>0),T(1),w("ngIf",e.containsSource()),T(1),w("ngIf",e.getSize()>1)}}const Blt=function(n){return[n]};function $lt(n,t){if(1&n&&(H(),b(0,"g"),x(1,Flt,5,6,"g",5),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",I3(1,Blt,r.state.getPieceAt(e)))}}function Ult(n,t){if(1&n&&(H(),b(0,"text",18),wt(1),A()),2&n){const e=C().$implicit,r=C();z("x",r.getCenterAt(e.coord).x)("y",r.getCenterAt(e.coord).y),T(1),c1(e.spaceContent.getSize())}}function Glt(n,t){if(1&n&&(H(),b(0,"g",14),X(1,"polygon",15)(2,"circle",16),x(3,Ult,2,3,"text",17),A()),2&n){const e=t.$implicit,r=C();Le("id","disconnected_",e.coord.x,"_",e.coord.y,""),T(1),z("points",r.getHexaPointsAt(e.coord)),T(1),Le("id","captured_",e.coord.x,"_",e.coord.y,""),w("ngClass",r.getPieceClasses(e.spaceContent)),z("cx",r.getCenterAt(e.coord).x)("cy",r.getCenterAt(e.coord).y)("r",r.SPACE_SIZE),T(1),w("ngIf",e.spaceContent.getSize()>1)}}function qlt(n,t){if(1&n&&(H(),dn(0),X(1,"polygon",19)(2,"polygon",19),pn()),2&n){const e=C();T(1),z("points",e.getHexaPointsAt(e.lastMove.get().getStart())),T(1),z("points",e.getHexaPointsAt(e.lastMove.get().getEnd()))}}function Wlt(n,t){if(1&n&&(H(),X(0,"polygon",20)),2&n){const e=C();Le("id","chosen_",e.chosen.get().x,"_",e.chosen.get().y,""),z("points",e.getHexaPointsAt(e.chosen.get()))}}let jlt=(()=>{class n extends Uh{constructor(e){super(e),this.lastMove=y.empty(),this.chosen=y.empty(),this.disconnecteds=[],this.rules=_s.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new v3e(this.rules,"DvonnMinimax"),new Dlt(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=Gr.encoder,this.tutorial=(new _3e).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=y.of(_s.getScores(this.getState())),this.hexaLayout=new Gh(1.5*this.SPACE_SIZE,new S(-this.SPACE_SIZE,2*this.SPACE_SIZE),NP.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=y.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.getState(),this.disconnecteds=[],this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=y.of(_s.getScores(this.state))}showLastMove(e){this.lastMove=y.of(e);const r=this.getPreviousState(),s=this.getState();for(let i=0;i<s.board.length;i++)for(let o=0;o<s.board[i].length;o++){const c=new S(o,i);if(!0===s.isOnBoard(c)&&!1===c.equals(this.lastMove.get().getStart())){const u=s.getPieceAt(c),h=r.getPieceAt(c);if(u.isEmpty()&&!h.isEmpty()){const m={coord:new S(o,i),spaceContent:h};this.disconnecteds.push(m)}}}}cancelMoveAttempt(){this.chosen=y.empty()}pass(){var e=this;return I(function*(){return We(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Gr.PASS)})()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.chosen.isAbsent()?s.choosePiece(e,r):s.chosen.equalsValue(new S(e,r))?(s.cancelMoveAttempt(),R.SUCCESS):yield s.chooseDestination(e,r)})()}choosePiece(e,r){const s=new S(e,r),i=this.rules.isMovablePiece(this.getState(),s);return i.isSuccess()?(this.chosen=y.of(s),R.SUCCESS):this.cancelMove(i.getReason())}chooseDestination(e,r){var s=this;return I(function*(){const i=s.getState(),o=s.chosen.get(),c=new S(e,r),u=Gr.from(o,c);return u.isFailure()?s.rules.isMovablePiece(i,c).isSuccess()?s.choosePiece(e,r):s.cancelMove(u.getReason()):s.rules.isLegal(u.get(),i).isFailure()&&s.rules.isMovablePiece(i,c).isSuccess()?s.choosePiece(e,r):s.chooseMove(u.get())})()}getPieceClasses(e){if(e.containsSource()&&1===e.getSize())return["nonplayer-fill","dashed-stroke"];const r=this.getPlayerClass(e.getOwner());return e.containsSource()?[r,"nonplayer-stroke","dashed-stroke"]:[r]}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-dvonn"]],features:[l],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,$lt,2,3,"g",1),x(2,Glt,4,10,"g",2),x(3,qlt,3,2,"ng-container",3),x(4,Wlt,1,3,"polygon",4),A()),2&e&&(T(1),w("ngForOf",r.state.allCoords()),T(1),w("ngForOf",r.disconnecteds),T(1),w("ngIf",r.lastMove.isPresent()),T(1),w("ngIf",r.chosen.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();var nr=(()=>(function(n){n[n.NONE=0]="NONE",n[n.SMALL=1]="SMALL",n[n.MEDIUM=2]="MEDIUM",n[n.BIG=3]="BIG"}(nr||(nr={})),nr))();class tt{constructor(t){this.value=t}static of(t){switch(t){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+t+" for EncapsulePiece")}}static ofSizeAndPlayer(t,e){return e===B.ZERO&&t===nr.BIG?tt.BIG_DARK:e===B.ZERO&&t===nr.MEDIUM?tt.MEDIUM_DARK:e===B.ZERO&&t===nr.SMALL?tt.SMALL_DARK:e===B.ONE&&t===nr.BIG?tt.BIG_LIGHT:e===B.ONE&&t===nr.MEDIUM?tt.MEDIUM_LIGHT:e===B.ONE&&t===nr.SMALL?tt.SMALL_LIGHT:tt.NONE}getPlayer(){switch(this){case tt.SMALL_DARK:case tt.MEDIUM_DARK:case tt.BIG_DARK:return B.ZERO;case tt.SMALL_LIGHT:case tt.MEDIUM_LIGHT:case tt.BIG_LIGHT:return B.ONE;default:return ue.NONE}}getSize(){switch(this){case tt.BIG_DARK:case tt.BIG_LIGHT:return nr.BIG;case tt.MEDIUM_DARK:case tt.MEDIUM_LIGHT:return nr.MEDIUM;case tt.SMALL_DARK:case tt.SMALL_LIGHT:return nr.SMALL;default:return ge.expectToBe(this,tt.NONE),nr.NONE}}belongsTo(t){return this.getPlayer()===t}equals(t){return this===t}toString(){switch(this){case tt.BIG_DARK:return"BIG_DARK";case tt.BIG_LIGHT:return"BIG_LIGHT";case tt.MEDIUM_DARK:return"MEDIUM_DARK";case tt.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case tt.SMALL_DARK:return"SMALL_DARK";case tt.SMALL_LIGHT:return"SMALL_LIGHT";default:return ge.expectToBe(this,tt.NONE),"EMPTY"}}}tt.encoder=Ye.tuple([Ye.identity()],n=>[n.value],n=>tt.of(n[0])),tt.SMALL_DARK=new tt(0),tt.SMALL_LIGHT=new tt(1),tt.MEDIUM_DARK=new tt(2),tt.MEDIUM_LIGHT=new tt(3),tt.BIG_DARK=new tt(4),tt.BIG_LIGHT=new tt(5),tt.NONE=new tt(6);class M8 extends xr{constructor(t,e,r){super(t,e),this.remainingPieces=r}static getInitialState(){const t=new Ji(ue.NONE,ue.NONE,ue.NONE),e=Je.createTable(3,3,t);return new M8(e,0,[tt.BIG_DARK,tt.BIG_DARK,tt.BIG_LIGHT,tt.BIG_LIGHT,tt.MEDIUM_DARK,tt.MEDIUM_DARK,tt.MEDIUM_LIGHT,tt.MEDIUM_LIGHT,tt.SMALL_DARK,tt.SMALL_DARK,tt.SMALL_LIGHT,tt.SMALL_LIGHT])}getRemainingPieces(){return Je.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(t){return this.getRemainingPieces().filter(e=>e.getPlayer()===t)}pieceBelongsToCurrentPlayer(t){return t.belongsTo(this.getCurrentPlayer())}isDroppable(t){return this.pieceBelongsToCurrentPlayer(t)&&this.isInRemainingPieces(t)}isInRemainingPieces(t){return this.remainingPieces.some(e=>e===t)}getPlayerRemainingPieces(){return this.remainingPieces.filter(t=>this.pieceBelongsToCurrentPlayer(t))}}class Ji{constructor(t,e,r){this.small=t,this.medium=e,this.big=r}isEmpty(){return this.small===ue.NONE&&this.medium===ue.NONE&&this.big===ue.NONE}toList(){const t=[];return this.small.isPlayer()&&t.push(tt.ofSizeAndPlayer(nr.SMALL,this.small)),this.medium.isPlayer()&&t.push(tt.ofSizeAndPlayer(nr.MEDIUM,this.medium)),this.big.isPlayer()&&t.push(tt.ofSizeAndPlayer(nr.BIG,this.big)),t}toOrderedPieceNames(){const t=tt.ofSizeAndPlayer(nr.SMALL,this.small),e=tt.ofSizeAndPlayer(nr.MEDIUM,this.medium),r=tt.ofSizeAndPlayer(nr.BIG,this.big);return[t.toString(),e.toString(),r.toString()]}getBiggest(){return this.big===B.ZERO?tt.BIG_DARK:this.big===B.ONE?tt.BIG_LIGHT:this.medium===B.ZERO?tt.MEDIUM_DARK:this.medium===B.ONE?tt.MEDIUM_LIGHT:this.small===B.ZERO?tt.SMALL_DARK:this.small===B.ONE?tt.SMALL_LIGHT:tt.NONE}tryToSuperposePiece(t){const e=this.getBiggest().getSize();if(t===tt.NONE)throw new Error("Cannot move EMPTY on a space");return t.getSize()>e?y.of(this.put(t)):y.empty()}removeBiggest(){const t=this.getBiggest();if(t===tt.NONE)throw new Error("Cannot removed piece from empty space");let e;const r=t.getSize();switch(r){case nr.BIG:e=new Ji(this.small,this.medium,ue.NONE);break;case nr.MEDIUM:e=new Ji(this.small,ue.NONE,ue.NONE);break;default:ge.expectToBe(r,nr.SMALL),e=new Ji(ue.NONE,ue.NONE,ue.NONE)}return{removedSpace:e,removedPiece:t}}put(t){if(t===tt.NONE)throw new Error("Cannot put NONE on space");const e=t.getPlayer(),r=t.getSize();switch(r){case nr.BIG:return new Ji(this.small,this.medium,e);case nr.MEDIUM:return We(this.big===ue.NONE,"Cannot put a piece on top of a bigger one"),new Ji(this.small,e,this.big);default:return ge.expectToBe(r,nr.SMALL),We(this.big===ue.NONE,"Cannot put a piece on top of a bigger one"),We(this.medium===ue.NONE,"Cannot put a piece on top of a bigger one"),new Ji(e,this.medium,this.big)}}belongsTo(t){return this.getBiggest().getPlayer()===t}toString(){const t=this.toOrderedPieceNames();return"("+t[0]+", "+t[1]+", "+t[2]+")"}}Ji.EMPTY=new Ji(ue.NONE,ue.NONE,ue.NONE);let s_=(()=>{class n{}return n.PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`,n.INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`,n.NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`,n.INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`,n.END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`,n})();class co extends I1{constructor(){super(M8)}static get(){return co.singleton.isAbsent()&&(co.singleton=y.of(new co)),co.singleton.get()}static isVictory(t){const e=t.getCopiedBoard();for(const r of co.LINES){const i=co.isVictoriousLine([e[r[0].y][r[0].x],e[r[1].y][r[1].x],e[r[2].y][r[2].x]]);if(i.isPresent())return i}return y.empty()}static isVictoriousLine(t){const r=t.map(s=>s.getBiggest()).map(s=>s.getPlayer());return r[0]===ue.NONE?y.empty():r[0]===r[1]&&r[1]===r[2]?y.of(r[0]):y.empty()}static isLegal(t,e){let s;if(J(!1,t.toString()),t.isDropping()){if(s=t.piece.get(),!1===e.pieceBelongsToCurrentPlayer(s))return ve.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.isInRemainingPieces(s))return ve.failure(s_.PIECE_OUT_OF_STOCK())}else{const c=t.startingCoord.get();if(s=e.getPieceAt(c).getBiggest(),!1===e.pieceBelongsToCurrentPlayer(s))return ve.failure(Xe.MUST_CHOOSE_PLAYER_PIECE())}const o=e.getPieceAt(t.landingCoord).tryToSuperposePiece(s);return o.isPresent()?ve.success(o.get()):ve.failure(s_.INVALID_PLACEMENT())}isLegal(t,e){return co.isLegal(t,e)}applyLegalMove(t,e,r){const s=e.getCopiedBoard();let i=e.getRemainingPieces();const o=e.turn+1;let c;if(s[t.landingCoord.y][t.landingCoord.x]=r,t.isDropping()){c=t.piece.get();const h=i.indexOf(c);i=i.slice(0,h).concat(i.slice(h+1))}else{const h=t.startingCoord.get(),m=s[h.y][h.x].removeBiggest();s[h.y][h.x]=m.removedSpace,c=m.removedPiece}return new M8(s,o,i)}static getGameStatus(t){const r=co.isVictory(t.gameState);return r.isPresent()?Ie.getVictory(r.get()):Ie.ONGOING}getGameStatus(t){return co.getGameStatus(t)}}co.singleton=y.empty(),co.LINES=[[new S(0,0),new S(0,1),new S(0,2)],[new S(1,0),new S(1,1),new S(1,2)],[new S(2,0),new S(2,1),new S(2,2)],[new S(0,0),new S(1,0),new S(2,0)],[new S(0,1),new S(1,1),new S(2,1)],[new S(0,2),new S(1,2),new S(2,2)],[new S(0,0),new S(1,1),new S(2,2)],[new S(0,2),new S(1,1),new S(2,0)]];class Mi extends oo{constructor(t,e,r){super(),this.startingCoord=t,this.landingCoord=e,this.piece=r}static ofMove(t,e){return ge.assert(!1===t.equals(e),"Starting coord and landing coord must be separate coords"),new Mi(y.of(t),e,y.empty())}static ofDrop(t,e){return new Mi(y.empty(),e,y.of(t))}isDropping(){return this.startingCoord.isAbsent()}equals(t){return this===t||!1!==t.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(t.startingCoord)&&this.piece.equals(t.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}Mi.encoder=Ye.tuple([y.getEncoder(S.encoder),S.encoder,y.getEncoder(tt.encoder)],n=>[n.startingCoord,n.landingCoord,n.piece],n=>new Mi(n[0],n[1],n[2]));class Zlt extends ks{getMetrics(t){return[0,0]}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getCurrentPlayer(),o=Qce.toComparableObjectSet(r.getPlayerRemainingPieces());for(let c=0;c<3;c++)for(let u=0;u<3;u++){const h=new S(u,c);for(const g of o){const m=Mi.ofDrop(g,h);co.isLegal(m,r).isSuccess()&&e.push(m)}if(s[c][u].belongsTo(i))for(let g=0;g<3;g++)for(let m=0;m<3;m++){const E=new S(m,g);if(!E.equals(h)){const O=Mi.ofMove(h,E);co.isLegal(O,r).isSuccess()&&e.push(O)}}}return e}}const Wo=new Ji(ue.NONE,ue.NONE,ue.NONE),C3e=new Ji(B.ZERO,ue.NONE,ue.NONE),Ylt=new Ji(ue.NONE,B.ZERO,ue.NONE),Klt=new Ji(ue.NONE,ue.NONE,B.ZERO),y3e=new Ji(B.ONE,ue.NONE,ue.NONE),zP=new Ji(ue.NONE,ue.NONE,B.ONE),Xlt=new Ji(B.ONE,B.ZERO,ue.NONE),Qlt=new Ji(B.ZERO,B.ZERO,ue.NONE);class E3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new M8([[C3e,y3e,zP],[Wo,Ylt,Wo],[Wo,Wo,Klt]],0,[tt.SMALL_DARK,tt.MEDIUM_DARK,tt.BIG_DARK,tt.SMALL_LIGHT,tt.MEDIUM_LIGHT,tt.MEDIUM_LIGHT,tt.BIG_LIGHT])),te.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,M8.getInitialState(),Mi.ofDrop(tt.SMALL_DARK,new S(1,1)),$localize`Congratulations!`),te.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new M8([[C3e,zP,Wo],[Wo,Wo,Wo],[Wo,Wo,Wo]],0,[]),[Mi.ofMove(new S(0,0),new S(2,0)),Mi.ofMove(new S(0,0),new S(0,1)),Mi.ofMove(new S(0,0),new S(1,1)),Mi.ofMove(new S(0,0),new S(2,1)),Mi.ofMove(new S(0,0),new S(0,2)),Mi.ofMove(new S(0,0),new S(1,2)),Mi.ofMove(new S(0,0),new S(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),te.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new M8([[Xlt,Wo,y3e],[Qlt,zP,zP],[Wo,Wo,Wo]],0,[tt.MEDIUM_DARK,tt.BIG_DARK,tt.MEDIUM_LIGHT,tt.MEDIUM_LIGHT]),Mi.ofMove(new S(0,1),new S(0,2)),(t,e,r)=>{if(t.landingCoord.equals(new S(0,2))){if(t.isDropping())return R.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new S(0,1)))return R.SUCCESS}return R.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)]}}function Jlt(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"circle",5),ee("click",function(){const s=de(e),i=s.$implicit,o=s.index,c=C().$implicit;return le(C().onPieceClick(c.value,i,o))}),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().$implicit,i=C();T(1),J2("id","piece_",s.value,"_",e.toString(),"_",r,""),w("ngClass",i.getSidePieceClasses(e,r)),z("transform","rotate("+180*(i.role.value+s.value)+" "+i.CENTER+" "+i.CENTER+")")("r",i.getPieceRadius(e))("cx",i.getRemainingPieceCenterCoord(s,r).x)("cy",i.getRemainingPieceCenterCoord(s,r).y)}}function e6t(n,t){if(1&n&&(H(),b(0,"g",null,4),x(2,Jlt,2,8,"g",1),A()),2&n){const e=t.$implicit,r=C();T(2),w("ngForOf",r.getRemainingPieces(e))}}function t6t(n,t){if(1&n){const e=Ae();H(),b(0,"circle",8),ee("click",function(){de(e);const s=C().index,i=C().index;return le(C().onBoardClick(s,i))}),A()}if(2&n){const e=t.$implicit,r=C().index,s=C().index,i=C();w("ngClass",i.getPieceClasses(e)),z("r",i.getPieceRadius(e))("cx",i.getPieceCenter(r))("cy",i.getPieceCenter(s))}}function n6t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",6),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onBoardClick(i,o))}),A(),x(2,t6t,1,4,"circle",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Le("id","click_",r,"_",s,""),w("ngClass",i.getRectClasses(r,s)),z("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngForOf",i.getListPieces(e))}}function r6t(n,t){if(1&n&&(H(),b(0,"g"),x(1,n6t,3,8,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function s6t(n,t){if(1&n){const e=Ae();H(),b(0,"rect",9),ee("click",function(){de(e);const s=C();return le(s.onBoardClick(s.chosenCoord.get().x,s.chosenCoord.get().y))}),A()}if(2&n){const e=C();Le("id","chosenCoord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),z("x",e.SPACE_SIZE*e.chosenCoord.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.chosenCoord.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}let i6t=(()=>{class n extends ao{constructor(e){super(e),this.CENTER=this.getPieceCenter(1),this.UPLEFT=-(this.SPACE_SIZE+.5*this.STROKE_WIDTH),this.WIDTH=5*this.SPACE_SIZE+3*this.STROKE_WIDTH,this.lastLandingCoord=y.empty(),this.lastStartingCoord=y.empty(),this.chosenCoord=y.empty(),this.chosenPiece=y.empty(),this.remainingPieceCenterCoords=new jn,this.rules=co.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Zlt(this.rules,"EncapsuleMinimax")],this.encoder=Mi.encoder,this.tutorial=(new E3e).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard();const r=this.node.move;this.calculateLeftPieceCoords(),r.isPresent()?(this.lastLandingCoord=y.of(r.get().landingCoord),this.lastStartingCoord=r.get().startingCoord):(this.lastLandingCoord=y.empty(),this.lastStartingCoord=y.empty())}getListPieces(e){return e.toList()}getRemainingPieces(e){return this.getState().getRemainingPiecesOfPlayer(e)}onBoardClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=y.of(o),s.chosenPiece.isPresent()){const u=Mi.ofDrop(s.chosenPiece.get(),o);return s.chooseMove(u)}return!1===c.getPieceAt(o).belongsTo(c.getCurrentPlayer())?s.cancelMove(s_.INVALID_PIECE_SELECTED()):R.SUCCESS}if(s.chosenCoord.equalsValue(o))return s.cancelMoveAttempt(),R.SUCCESS;{const u=Mi.ofMove(s.chosenCoord.get(),o);return s.chooseMove(u)}})()}cancelMoveAttempt(){this.chosenCoord=y.empty(),this.chosenPiece=y.empty(),this.chosenPieceIndex=y.empty()}onPieceClick(e,r,s){var i=this;return I(function*(){const o="#piece_"+e+"_"+r.toString()+"_"+s,c=i.canUserPlay(o);return c.isFailure()?i.cancelMove(c.getReason()):!1===i.getState().isDroppable(r)?i.cancelMove(s_.NOT_DROPPABLE()):i.chosenCoord.isAbsent()?(i.chosenPiece.equalsValue(r)&&i.chosenPieceIndex.equalsValue(s)?(i.chosenPiece=y.empty(),i.chosenPieceIndex=y.empty()):(i.chosenPiece=y.of(r),i.chosenPieceIndex=y.of(s)),R.SUCCESS):i.cancelMove(s_.END_YOUR_MOVE())})()}getRectClasses(e,r){return this.isSelected(e,r)?"moved-fill":""}isSelected(e,r){const s=new S(e,r);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(e){return[this.getPieceStrokeClass(e)]}getPieceCenter(e){return this.SPACE_SIZE*e+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(e){const r=e.getPlayer();return We(r.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+r.value+"-stroke"}getPieceRadius(e){switch(e.getSize()){case nr.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case nr.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return ge.expectToBe(e.getSize(),nr.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(e,r){const s=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(r)&&s.push("selected-stroke"),s}isSelectedPiece(e){return this.chosenPiece.equalsValue(e)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new jn;for(const e of B.PLAYERS){const r=[],s=this.getRemainingPieces(e);for(let i=0;i<s.length;i++){let o,c=0,u=0;i<=2?(o=new S(2-i,3),u=this.STROKE_WIDTH):(o=new S(-1,5-i),c=-this.STROKE_WIDTH);const h=this.getPieceCenter(o.x),g=this.getPieceCenter(o.y);r.push(new S(h+c,g+u))}this.remainingPieceCenterCoords.set(e,r)}}getRemainingPieceCenterCoord(e,r){return this.remainingPieceCenterCoords.get(e).get()[r]}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-encapsule"]],features:[l],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,e6t,3,1,"g",1),b(2,"g",null,2),x(4,r6t,2,1,"g",1),x(5,s6t,1,6,"rect",3),A()()),2&e&&(z("viewBox",r.UPLEFT+" "+r.UPLEFT+" "+r.WIDTH+" "+r.WIDTH),T(1),w("ngForOf",r.Player.PLAYERS),T(3),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Gc extends ms{constructor(t,e,r,s,i){super(t,e),this.movedPieces=r,this.stepSize=s,this.direction=i,ge.assert(this.coord.isInRange(14,12),"Illegal coord outside of board "+this.coord.toString()+"."),ge.assert(r>0,"Must select minimum one piece (got "+r+")."),ge.assert(s>0,"Step size must be minimum one (got "+s+")."),ge.assert(s<=r,"Cannot move a phalanx further than its size (got step size "+s+" for "+r+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(t){return this===t||!(!this.coord.equals(t.coord)||this.movedPieces!==t.movedPieces||this.stepSize!==t.stepSize)&&this.direction.equals(t.direction)}}Gc.encoder=Ye.tuple([S.encoder,Ye.identity(),Ye.identity(),be.encoder],n=>[n.coord,n.movedPieces,n.stepSize,n.direction],n=>new Gc(n[0].x,n[0].y,n[1],n[2],n[3]));class W4 extends xr{static getInitialState(){const t=ue.NONE,e=ue.ZERO,r=ue.ONE;return new W4([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e]],0)}count(t,e){let r=0;for(let s=0;s<14;s++)this.board[e][s]===t&&r++;return r}doesOwnPiece(t){for(let e=0;e<12;e++)for(let r=0;r<14;r++)if(this.board[e][r]===t)return!0;return!1}}let qc=(()=>{class n{}return n.PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`,n.SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`,n.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`,n.SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`,n.SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`,n.SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`,n.SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`,n.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`,n.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`,n.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`,n})();class lo extends I1{constructor(){super(W4)}static get(){return lo.singleton.isAbsent()&&(lo.singleton=y.of(new lo)),lo.singleton.get()}static isLegal(t,e){const r=this.getPhalanxValidity(e,t);if(r.isFailure())return ve.failure(r.getReason());const s=this.getLandingStatus(e,t);if(s.isFailure())return s;const i=Je.copyBiArray(s.get()),o=e.getCurrentOpponent(),c=lo.getCaptureValidity(e,i,t,o);return c.isFailure()?c:ve.success(c.get())}static getPhalanxValidity(t,e){let r=e.coord,s=0;const i=t.getCurrentOpponent();for(;s<e.movedPieces;){if(r.isNotInRange(14,12))return R.failure(qc.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=t.getPieceAt(r);if(o===ue.NONE)return R.failure(qc.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===i)return R.failure(qc.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());r=r.getNext(e.direction,1),s++}return R.SUCCESS}static getLandingStatus(t,e){const r=t.getCopiedBoard(),s=t.getCurrentPlayer();let i=e.coord,o=e.coord.getNext(e.direction,e.movedPieces),c=0;for(;c+1<e.stepSize;){if(r[i.y][i.x]=ue.NONE,r[o.y][o.x]=s,o.isNotInRange(14,12))return ve.failure(qc.PHALANX_IS_LEAVING_BOARD());if(t.getPieceAt(o).isPlayer())return ve.failure(qc.SOMETHING_IN_PHALANX_WAY());c++,o=o.getNext(e.direction,1),i=i.getNext(e.direction,1)}return o.isNotInRange(14,12)?ve.failure(qc.PHALANX_IS_LEAVING_BOARD()):t.getPieceAt(o)===s?ve.failure(Xe.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(r[i.y][i.x]=ue.NONE,r[o.y][o.x]=s,ve.success(r))}static getCaptureValidity(t,e,r,s){let i=r.coord.getNext(r.direction,r.movedPieces+r.stepSize-1),o=0;for(;i.isInRange(14,12)&&t.getPieceAt(i)===s;){if(o>0&&(e[i.y][i.x]=ue.NONE),o++,o>=r.movedPieces)return ve.failure(qc.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(r.direction,1)}return ve.success(e)}isLegal(t,e){return lo.isLegal(t,e)}applyLegalMove(t,e,r){return new W4(r,e.turn+1)}getGameStatus(t){const e=t.gameState,r=e.count(B.ZERO,0),s=e.count(B.ONE,11);if(e.turn%2==0){if(r>s)return Ie.ZERO_WON}else if(s>r)return Ie.ONE_WON;return!1===e.doesOwnPiece(B.ZERO)?Ie.ONE_WON:!1===e.doesOwnPiece(B.ONE)?Ie.ZERO_WON:Ie.ONGOING}}lo.singleton=y.empty();class i_ extends ic{static getListMoves(t){const e=t.gameState.getCurrentPlayer(),r=t.gameState.getCurrentOpponent(),s=ue.NONE;let i=[];const o=t.gameState;let c;for(let u=0;u<12;u++)for(let h=0;h<14;h++){const g=new S(h,u);if(o.getPieceAt(g)===e)for(const m of be.DIRECTIONS){let E=1,O=g.getNext(m,1);for(;O.isInRange(14,12)&&o.getPieceAt(O)===e;)E+=1,O=O.getNext(m,1);let k=1;for(;O.isInRange(14,12)&&k<=E&&o.getPieceAt(O)===s;)c=new Gc(h,u,E,k,m),i=this.addMove(i,c,o),k++,O=O.getNext(m,1);O.isInRange(14,12)&&k<=E&&o.getPieceAt(O)===r&&(c=new Gc(h,u,E,k,m),i=this.addMove(i,c,o))}}return i}static addMove(t,e,r){return lo.isLegal(e,r).isSuccess()&&t.push(e),t}getListMoves(t){const e=i_.getListMoves(t);return Je.sortByDescending(e,r=>r.stepSize),e}getBoardValue(t){const e=lo.get().getGameStatus(t);return e.isEndGame?e.toBoardValue():new Fn(this.getPieceCountPlusRowDomination(t.gameState))}getPieceCountPlusRowDomination(t){let o=0;for(let c=0;c<12;c++){let u=0;const h=[0,0];for(let g=0;g<14;g++){const m=new S(g,c),E=t.getPieceAt(m);if(E.isPlayer()){const O=E.getScoreModifier();o+=2002*O,h[E.value]=O,u+=O;for(const k of[be.UP_LEFT,be.UP,be.UP_RIGHT]){let U=m.getNext(k,1);for(;U.isInRange(14,12)&&t.getPieceAt(U)===E;)o+=1*O,U=U.getNext(k,1)}}}0!==u&&(o+=Math.abs(u)/u*2),o+=1*h.reduce((g,m)=>g+m)}return o}}class o6t extends ic{getListMoves(t){const e=i_.getListMoves(t);return this.orderMovesByPhalanxSizeAndFilter(e,t.gameState)}orderMovesByPhalanxSizeAndFilter(t,e){return Je.sortByDescending(t,r=>r.movedPieces),t.length>40?t.filter(s=>!!this.moveIsCapture(s,e)||s.movedPieces*Math.random()>1):t}moveIsCapture(t,e){const r=t.coord.getNext(t.direction,t.movedPieces+t.stepSize-1);return e.board[r.y][r.x]===e.getCurrentOpponent()}getBoardValue(t){const e=lo.get().getGameStatus(t);return e.isEndGame?e.toBoardValue():new Fn(this.getPieceCountThenSupportThenAdvancement(t.gameState))}getPieceCountThenSupportThenAdvancement(t){let o=0;for(let c=0;c<12;c++)for(let u=0;u<14;u++){const h=new S(u,c),g=t.getPieceAt(h);if(g.isPlayer()){let m,E;g===B.ZERO?(m=12-c,E=[be.UP_LEFT,be.UP,be.UP_RIGHT]):(m=c+1,E=[be.DOWN_LEFT,be.DOWN,be.DOWN_RIGHT]);const O=g.getScoreModifier();o+=m*O,o+=149629*O;for(const k of E){let U=h.getNext(k,1);for(;U.isInRange(14,12)&&t.getPieceAt(U)===g;)o+=337*O,U=U.getNext(k,1)}}}return o}}class a6t extends i_{constructor(){super(...arguments),this.DOMINANCE_FACTOR=20,this.DEFENSE_FACTOR=5,this.TERRITORY_FACTOR=2,this.OFFENSE_FACTOR=10,this.CENTER_FACTOR=5,this.MOBILITY_FACTOR=.12}getDominance(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new S(s,r));i.isPlayer()&&(e+=i.getScoreModifier())}return e*this.DOMINANCE_FACTOR}getDefense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new S(r,11))===B.ZERO&&(e+=B.ZERO.getScoreModifier()),t.getPieceAt(new S(r,0))===B.ONE&&(e+=B.ONE.getScoreModifier());return e*this.DEFENSE_FACTOR}getTerritory(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new S(s,r));if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let c=-1;c<=1;c++){const u=new S(s+o,r+c);if(u.isInRange(14,12)){const h=t.getPieceAt(u);(h===i||h===ue.NONE)&&(e+=1*i.getScoreModifier())}}e-=i.getScoreModifier()}}return e*this.TERRITORY_FACTOR}getOffense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new S(r,0))===B.ZERO&&(e+=B.ZERO.getScoreModifier()),t.getPieceAt(new S(r,11))===B.ONE&&(e+=B.ONE.getScoreModifier());return e*this.OFFENSE_FACTOR}getCenter(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new S(s,r));i.isPlayer()&&(e+=i.getScoreModifier()*Math.sqrt((s-6.5)*(s-6.5)))}return e*this.CENTER_FACTOR}getMobility(t){let e=0,r=0,s=0;for(let i=0;i<12;i++)for(let o=0;o<14;o++){const c=new S(o,i),u=t.getPieceAt(c);if(u.isPlayer())for(const h of be.DIRECTIONS){let g=1,m=c.getNext(h,1);for(;m.isInRange(14,12)&&t.getPieceAt(m)===u;)g+=1,m=m.getNext(h,1);let E=1;for(;m.isInRange(14,12)&&E<=g&&t.getPieceAt(m)===ue.NONE;)E++,m=m.getNext(h,1);e+=E*E*u.getScoreModifier(),u===B.ZERO?r=Math.max(r,E):u===B.ONE&&(s=Math.max(s,E))}}return(e+r*B.ZERO.getScoreModifier()+s*B.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(t){const e=t.gameState,r=lo.get().getGameStatus(t);if(r.isEndGame)return r.toBoardValue();const s=this.getDominance(e),i=this.getDefense(e),o=this.getTerritory(e),c=this.getCenter(e),u=this.getOffense(e),h=this.getMobility(e);return new Fn(s+i+o+c+u+h)}}const L=ue.NONE,Lr=ue.ZERO,j1=ue.ONE;class M3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,W4.getInitialState()),te.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new W4([[L,L,L,L,L,Lr,L,L,j1,j1,j1,j1,j1,j1],[L,L,L,L,L,Lr,L,L,L,L,L,L,j1,j1],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,j1,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,Lr,Lr,Lr,Lr,L,L,L]],0)),te.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new W4([[L,L,L,L,L,Lr,L,L,L,L,j1,j1,j1,j1],[L,L,L,L,L,Lr,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,j1,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,j1,j1,L,L,L,Lr,Lr,L,Lr,Lr,Lr,Lr]],1)),te.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,W4.getInitialState(),new Gc(0,10,1,1,be.UP),(t,e,r)=>1===t.movedPieces?R.SUCCESS:R.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),te.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,W4.getInitialState(),new Gc(0,11,2,1,be.UP),(t,e,r)=>t.movedPieces>1?R.SUCCESS:R.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),te.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new W4([[L,L,L,L,L,L,L,L,j1,j1,j1,j1,j1,j1],[L,L,L,L,L,L,j1,L,L,L,L,L,L,L],[L,L,L,L,L,j1,L,L,L,L,L,L,L,L],[L,L,j1,L,j1,L,L,L,L,L,L,L,L,L],[L,L,j1,j1,L,L,L,L,L,L,L,L,L,L],[L,L,j1,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,Lr,L,L,L,L,L,L,L,L,L,L,L],[L,L,Lr,L,L,L,L,j1,L,L,L,L,L,L],[L,L,Lr,L,L,L,L,L,L,L,L,L,L,L],[L,L,Lr,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,Lr,Lr,Lr,Lr,Lr,Lr,Lr]],0),[new Gc(2,10,4,2,be.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}}function c6t(n,t){if(1&n){const e=Ae();H(),b(0,"circle",4),ee("click",function(){de(e);const s=C().index,i=C().index;return le(C().onClick(s,i))}),A()}if(2&n){const e=C().index,r=C().index,s=C();w("ngClass",s.getPieceClasses(e,r)),z("cx",s.SPACE_SIZE*e+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.STROKE_WIDTH+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function l6t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",2),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),A(),x(2,c6t,1,4,"circle",3),A()}if(2&n){const e=t.index,r=C().index,s=C();T(1),Le("id","click_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),z("x",s.SPACE_SIZE*e+s.STROKE_WIDTH)("y",s.SPACE_SIZE*r+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][e]!==s.NONE)}}function u6t(n,t){if(1&n&&(H(),b(0,"g"),x(1,l6t,3,8,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function f6t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",5),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),z("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let h6t=(()=>{class n extends ao{constructor(e){super(e),this.NONE=ue.NONE,this.firstPiece=y.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=y.empty(),this.phalanxDirection=y.empty(),this.phalanxMiddles=[],this.moveds=[],this.capturedCoords=[],this.hasAsymmetricBoard=!0,this.rules=lo.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new i_(this.rules,"Normal"),new o6t(this.rules,"Positional"),new a6t(this.rules,"Attack")],this.encoder=Gc.encoder,this.tutorial=(new M3e).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=y.empty(),this.lastPiece=y.empty(),this.hidePreviousMove(),this.board=this.getState().getCopiedBoard()}showLastMove(e){let r=e.coord;this.moveds=[r];for(let o=1;o<e.stepSize+e.movedPieces;o++)r=r.getNext(e.direction,1),this.moveds.push(r);const s=this.node.mother.get(),i=s.gameState.getCurrentOpponent();for(;r.isInRange(14,12)&&s.gameState.getPieceAt(r)===i;)this.capturedCoords.push(r),r=r.getNext(e.direction,1)}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.firstPiece.isAbsent()?s.firstClick(e,r):s.lastPiece.isAbsent()?s.secondClick(e,r):s.thirdClick(e,r)})()}firstClick(e,r){var s=this;return I(function*(){const i=s.getState().getCurrentOpponent(),o=s.getState().getCurrentPlayer();switch(s.board[r][e]){case o:return s.firstPiece=y.of(new S(e,r)),s.validExtensions=s.getValidExtensions(o),s.phalanxValidLandings=s.getPhalanxValidLandings(),R.SUCCESS;case i:return s.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());default:return ge.expectToBe(s.board[r][e],ue.NONE),s.cancelMove(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}getFirstPieceExtensions(e){const r=[];for(const s of be.DIRECTIONS){let i=this.firstPiece.get().getNext(s,1);for(;i.isInRange(14,12)&&this.board[i.y][i.x]===e;)r.push(i),i=i.getNext(s,1)}return r}getPhalanxValidExtensions(e){let r=be.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(r,1),i=this.getExtensionsToward(s,r,e);r=r.getOpposite();const o=this.firstPiece.get().getNext(r,1),c=this.getExtensionsToward(o,r,e);return i.concat(c)}getExtensionsToward(e,r,s){const i=[];for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i.push(e),e=e.getNext(r,1);return i}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const e=this.firstPiece.get(),r=this.lastPiece.get(),s=Math.abs(e.x-r.x),i=Math.abs(e.y-r.y),o=Math.max(s,i)+1;let c=be.factory.fromMove(e,r).get();const u=r.getNext(c,1),h=this.getLandingsToward(u,c,o);c=c.getOpposite();const g=e.getNext(c,1);return this.getLandingsToward(g,c,o).concat(h)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const e=[];for(const r of be.DIRECTIONS){const s=this.firstPiece.get().getNext(r,1);s.isInRange(14,12)&&this.board[s.y][s.x]===ue.NONE&&e.push(s)}return e}getLandingsToward(e,r,s){const i=this.getState().getCurrentPlayer(),o=this.getState().getCurrentOpponent(),c=[];for(;e.isInRange(14,12)&&c.length<s&&this.board[e.y][e.x]!==i;){if(this.board[e.y][e.x]===o)return this.getPhalanxLength(e,r,o)<s&&c.push(e),c;c.push(e),e=e.getNext(r,1)}return c}getPhalanxLength(e,r,s){let i=0;for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i++,e=e.getNext(r,1);return i}cancelMoveAttempt(){this.firstPiece=y.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=y.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(e,r){var s=this;return I(function*(){const i=new S(e,r),o=s.firstPiece.get();if(i.equals(o))return s.cancelMoveAttempt(),R.SUCCESS;const c=s.getState().getCurrentOpponent(),u=s.getState().getCurrentPlayer();if(!i.isAlignedWith(o))return s.cancelMove(qc.SQUARE_NOT_ALIGNED_WITH_SELECTED());const h=i.getDistance(o),g=o.getDirectionToward(i).get();switch(s.board[r][e]){case ue.NONE:return 1===h?s.chooseMove(new Gc(o.x,o.y,1,1,g)):s.cancelMove(qc.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove(qc.SINGLE_PIECE_CANNOT_CAPTURE());default:ge.expectToBe(s.board[r][e],u);const m=new Gc(o.x,o.y,h,1,g),E=s.getState(),O=lo.getPhalanxValidity(E,m);return O.isFailure()?s.cancelMove(O.getReason()):(s.lastPiece=y.of(i),s.validExtensions=s.getValidExtensions(u),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=o.getCoordsToward(i),s.phalanxDirection=y.of(g),R.SUCCESS)}})()}thirdClick(e,r){var s=this;return I(function*(){const i=s.getState().getCurrentPlayer(),o=new S(e,r);if(s.firstPiece.equalsValue(o))return s.moveFirstPiece(i);if(s.lastPiece.equalsValue(o))return s.moveLastPiece(i);const c=s.firstPiece.get(),u=s.lastPiece.get();if(!o.isAlignedWith(c))return s.cancelMove(qc.SQUARE_NOT_ALIGNED_WITH_PHALANX());let h=be.factory.fromMove(c,u).get();const g=be.factory.fromMove(c,o).get();if(h===g.getOpposite()&&(s.firstPiece=y.of(u),s.lastPiece=y.of(c),h=g),h!==g)return s.cancelMove(qc.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[r][e]===i)return s.thirdClickOnPlayerPiece(o,h,i);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,E=s.lastPiece.get().getDistance(o),O=new Gc(s.firstPiece.get().x,s.firstPiece.get().y,m,E,h);return s.chooseMove(O)}})()}thirdClickOnPlayerPiece(e,r,s){var i=this;return I(function*(){i.lastPiece=y.of(e);const o=i.firstPiece.get().getDistance(e)+1,c=new Gc(i.firstPiece.get().x,i.firstPiece.get().y,o,1,r),u=lo.getPhalanxValidity(i.node.gameState,c);return u.isFailure()?i.cancelMove(u.getReason()):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getValidExtensions(s),i.phalanxValidLandings=i.getPhalanxValidLandings(),R.SUCCESS)})()}moveFirstPiece(e){var r=this;return I(function*(){return r.firstPiece=y.of(r.firstPiece.get().getNext(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?yield r.moveOnlyPiece(e):(r.phalanxMiddles=r.phalanxMiddles.slice(1),r.validExtensions=r.getPhalanxValidExtensions(e)),r.phalanxValidLandings=r.getPhalanxValidLandings(),R.SUCCESS})()}moveLastPiece(e){var r=this;return I(function*(){return r.lastPiece=y.of(r.lastPiece.get().getPrevious(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?r.moveOnlyPiece(e):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getPhalanxValidExtensions(e),r.phalanxValidLandings=r.getPhalanxValidLandings(),R.SUCCESS)})()}moveOnlyPiece(e){var r=this;return I(function*(){return r.lastPiece=y.empty(),r.validExtensions=r.getFirstPieceExtensions(e),r.phalanxDirection=y.empty(),r.phalanxMiddles=[],r.phalanxValidLandings=r.getPhalanxValidLandings(),R.SUCCESS})()}getPieceClasses(e,r){const s=this.getPlayerClass(this.board[r][e]);return this.getPieceStrokeClasses(e,r).concat([s])}getPieceStrokeClasses(e,r){const s=new S(e,r);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(i=>i.equals(s))?["selected-stroke"]:[]}getRectClasses(e,r){const s=new S(e,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:this.moveds.some(i=>i.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const e=[],s=this.getState().getCurrentPlayer();for(let i=0;i<this.board.length;i++)for(let o=0;o<this.board[i].length;o++)this.board[i][o]===s&&e.push(new S(o,i));return e}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-epaminondas"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,u6t,2,1,"g",1),x(2,f6t,2,4,"g",1),A()),2&e&&(z("transform",r.rotation),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getHighlightedCoords()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Si{constructor(t){ge.assert(t.length>=4,"Cannot create a GipfCapture with less than 4 captured pieces"),ge.assert(lc.areOnSameLine(t),"Cannot create a GipfCapture with pieces that are not on the same line"),this.capturedSpaces=Je.copyImmutableArray(t).sort((r,s)=>r.x===s.x?(ge.assert(r.y!==s.y,"Cannot create a GipfCapture with duplicate coords"),r.y>s.y?1:-1):r.x>s.x?1:-1);let e=y.empty();for(const r of this.capturedSpaces)ge.assert(e.isAbsent()||1===e.get().getDistance(r),"Cannot create a GipfCapture with non-consecutive coords"),e=y.of(r)}toString(){let t="";for(const e of this.capturedSpaces)""!==t&&(t+=","),t+=e.toString();return t}size(){return this.capturedSpaces.length}forEach(t){this.capturedSpaces.forEach(t)}contains(t){for(let e=0;e<this.capturedSpaces.length;e++)if(this.capturedSpaces[e].equals(t))return!0;return!1}intersectsWith(t){return this.capturedSpaces.some(e=>t.contains(e))}getLine(){return lc.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(t){if(this===t)return!0;if(this.capturedSpaces.length!==t.capturedSpaces.length)return!1;for(let e=0;e<this.capturedSpaces.length;e++)if(!this.capturedSpaces[e].equals(t.capturedSpaces[e]))return!1;return!0}}Si.encoder=Ye.tuple([Ye.list(S.encoder)],n=>[n.capturedSpaces],n=>new Si(n[0])),Si.listEncoder=Ye.list(Si.encoder);class Wc{constructor(t,e){this.coord=t,this.direction=e}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(t){return!!this.coord.equals(t.coord)&&this.direction.equals(t.direction)}}Wc.encoder=Ye.tuple([S.encoder,y.getEncoder(De.encoder)],n=>[n.coord,n.direction],n=>new Wc(n[0],n[1]));class $3 extends oo{constructor(t,e,r){super(),this.placement=t,this.initialCaptures=e,this.finalCaptures=r}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}equals(t){return this===t||!(!1===this.placement.equals(t.placement)||!1===Je.compareArray(this.initialCaptures,t.initialCaptures)||!1===Je.compareArray(this.finalCaptures,t.finalCaptures))}}$3.encoder=Ye.tuple([Wc.encoder,Si.listEncoder,Si.listEncoder],n=>[n.placement,n.initialCaptures,n.finalCaptures],n=>new $3(n[0],n[1],n[2]));class jc extends ZH{constructor(t,e,r,s){super(e,t,7,7,[3,2,1],xe.EMPTY),this.sidePieces=r,this.capturedPieces=s}static getInitialState(){const t=xe.EMPTY,e=xe.UNREACHABLE,r=xe.ZERO,s=xe.ONE;return new jc([[e,e,e,s,t,t,r],[e,e,t,t,t,t,t],[e,t,t,t,t,t,t],[r,t,t,t,t,t,s],[t,t,t,t,t,t,e],[t,t,t,t,t,e,e],[s,t,t,r,e,e,e]],0,[12,12],[0,0])}equals(t){return this.turn===t.turn&&this.sidePieces[0]===t.sidePieces[0]&&this.sidePieces[1]===t.sidePieces[1]&&this.capturedPieces[0]===t.capturedPieces[0]&&this.capturedPieces[1]===t.capturedPieces[1]&&Je.compareTable(this.board,t.board)}getNumberOfPiecesToPlace(t){return this.sidePieces[t.value]}getNumberOfPiecesCaptured(t){return this.capturedPieces[t.value]}setAtUnsafe(t,e){const r=Je.copyBiArray(this.board);return r[t.y][t.x]=e,new jc(r,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==xe.UNREACHABLE}}let Zc=(()=>{class n{}return n.CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`,n.INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`,n.MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`,n.PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`,n.INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`,n.PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`,n.PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`,n.AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`,n.NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`,n})();class An extends I1{constructor(){super(jc)}static get(){return An.singleton.isAbsent()&&(An.singleton=y.of(new An)),An.singleton.get()}applyLegalMove(t,e,r){return new jc(r.board,r.turn+1,r.sidePieces,r.capturedPieces)}static applyCaptures(t,e){let r=e;return t.forEach(s=>{r=An.applyCapture(s,r)}),r}static applyCapture(t,e){const r=e.getCurrentPlayer();let s=e;const i=[e.sidePieces[0],e.sidePieces[1]],o=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(c=>{const u=e.getPieceAt(c);s=s.setAt(c,xe.EMPTY),u.is(r)?i[r.value]+=1:o[r.value]+=1}),new jc(s.board,e.turn,i,o)}static getPlacements(t){const e=[];return xs.INSTANCE.getAllBorders(t).forEach(r=>{t.getPieceAt(r)===xe.EMPTY?e.push(new Wc(r,y.empty())):An.getAllDirectionsForEntrance(t,r).forEach(s=>{!1===An.isLineComplete(t,r,s)&&e.push(new Wc(r,y.of(s)))})}),e}static isLineComplete(t,e,r){return An.nextGapInLine(t,e,r).isAbsent()}static nextGapInLine(t,e,r){for(let s=e;t.isOnBoard(s);s=s.getNext(r))if(t.getPieceAt(s)===xe.EMPTY)return y.of(s);return y.empty()}static applyPlacement(t,e){const r=e.getCurrentPlayer();let s=e,i=xe.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){const c=t.coord;if(e.getPieceAt(c)!==xe.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");s=s.setAt(c,i)}else for(let c=t.coord;s.isOnBoard(c)&&i!==xe.EMPTY;c=c.getNext(t.direction.get())){const u=e.getPieceAt(c);s=s.setAt(c,i),i=u}const o=[e.sidePieces[0],e.sidePieces[1]];return o[r.value]-=1,new jc(s.board,e.turn,o,e.capturedPieces)}getPiecesMoved(t,e,r){const s=An.applyCaptures(e,t);if(r.direction.isAbsent())return[r.coord];{const i=r.direction.get(),o=[];o.push(r.coord);let c=r.coord.getNext(i);for(;s.isOnBoard(c)&&s.getPieceAt(c)!==xe.EMPTY;)o.push(c),c=c.getNext(i);return We(s.isOnBoard(c)&&s.getPieceAt(c)===xe.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(c),o}}static getAllDirectionsForEntrance(t,e){if(xs.INSTANCE.isTopLeftCorner(t,e))return[De.RIGHT,De.DOWN,De.UP_RIGHT];if(xs.INSTANCE.isTopCorner(t,e))return[De.DOWN,De.DOWN_LEFT,De.RIGHT];if(xs.INSTANCE.isTopRightCorner(t,e))return[De.DOWN_LEFT,De.DOWN,De.LEFT];if(xs.INSTANCE.isBottomLeftCorner(t,e))return[De.UP_RIGHT,De.UP,De.RIGHT];if(xs.INSTANCE.isBottomCorner(t,e))return[De.UP,De.LEFT,De.UP_RIGHT];if(xs.INSTANCE.isBottomRightCorner(t,e))return[De.LEFT,De.UP,De.DOWN_LEFT];if(xs.INSTANCE.isOnTopLeftBorder(t,e))return[De.RIGHT,De.DOWN];if(xs.INSTANCE.isOnLeftBorder(t,e))return[De.UP_RIGHT,De.RIGHT];if(xs.INSTANCE.isOnBottomLeftBorder(t,e))return[De.UP,De.UP_RIGHT];if(xs.INSTANCE.isOnBottomRightBorder(t,e))return[De.LEFT,De.UP];if(xs.INSTANCE.isOnRightBorder(t,e))return[De.LEFT,De.DOWN_LEFT];if(xs.INSTANCE.isOnTopRightBorder(t,e))return[De.DOWN_LEFT,De.DOWN];throw new Error("not a border")}isLegal(t,e){const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toOtherFallible();const s=An.applyCaptures(t.initialCaptures,e),i=this.noMoreCapturesValidity(s);if(i.isFailure())return i.toOtherFallible();const o=this.placementValidity(s,t.placement);if(o.isFailure())return o.toOtherFallible();const c=An.applyPlacement(t.placement,s),u=this.capturesValidity(c,t.finalCaptures);if(u.isFailure())return u.toOtherFallible();const h=An.applyCaptures(t.finalCaptures,c),g=this.noMoreCapturesValidity(h);return g.isFailure()?g.toOtherFallible():ve.success(h)}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=An.applyCapture(s,r)}return R.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer(),s=An.getLinePortionWithFourPiecesOfPlayer(t,r,e.getLine());if(s.isAbsent())return R.failure(Zc.CAPTURE_MUST_BE_ALIGNED());const i=s.get();return An.getCapturable(t,i).equals(e)?R.SUCCESS:R.failure(Zc.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=An.getLinePortionWithFourPiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}static getLinePortionWithFourPiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let c=i;for(let u=i;t.isOnBoard(u);u=u.getNext(o))if(t.getPieceAt(u).is(e)?(0===s&&(c=u),s+=1):s=0,4===s)return y.of({0:c,1:u,2:o});return y.empty()}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===An.getLinePortionsWithFourPiecesOfPlayer(t,e).length?R.SUCCESS:R.failure(Zc.MISSING_CAPTURES())}placementValidity(t,e){const r=this.placementCoordValidity(t,e.coord);if(r.isFailure())return r;if(t.getPieceAt(e.coord)!==xe.EMPTY){if(e.direction.isAbsent())return R.failure(Zc.PLACEMENT_WITHOUT_DIRECTION());if(An.isLineComplete(t,e.coord,e.direction.get()))return R.failure(Zc.PLACEMENT_ON_COMPLETE_LINE());for(const s of An.getAllDirectionsForEntrance(t,e.coord))if(s===e.direction.get())return R.SUCCESS;return R.failure(Zc.INVALID_PLACEMENT_DIRECTION())}return R.SUCCESS}placementCoordValidity(t,e){return xs.INSTANCE.isOnBorder(t,e)?R.SUCCESS:R.failure(Zc.PLACEMENT_NOT_ON_BORDER())}static getCapturable(t,e){const r=[],s=e[0],i=e[1],o=e[2],c=o.getOpposite();let u=s.getNext(c);for(;t.isOnBoard(u)&&t.getPieceAt(u)!==xe.EMPTY;)r.push(u),u=u.getNext(c);for(let h=s;!h.equals(i);h=h.getNext(o))r.push(h);for(let h=i;t.isOnBoard(h)&&t.getPieceAt(h)!==xe.EMPTY;h=h.getNext(o))r.push(h);return new Si(r)}static getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return An.getLinePortionsWithFourPiecesOfPlayer(t,e).forEach(s=>{r.push(An.getCapturable(t,s))}),r}static getPlayerScore(t,e){const r=t.getNumberOfPiecesToPlace(e);if(0===r&&0===An.getPossibleCaptures(t).length)return y.empty();const s=t.getNumberOfPiecesCaptured(e);return y.of(r+3*s)}static isGameOver(t){const e=An.getPlayerScore(t,B.ZERO),r=An.getPlayerScore(t,B.ONE);return e.isAbsent()||r.isAbsent()}getGameStatus(t){const e=t.gameState,r=An.getPlayerScore(e,B.ZERO),s=An.getPlayerScore(e,B.ONE);return r.isAbsent()?Ie.ONE_WON:s.isAbsent()?Ie.ZERO_WON:Ie.ONGOING}}An.singleton=y.empty();class o_ extends ks{static getPossibleCaptureCombinationsFromPossibleCaptures(t){const e=o_.computeIntersections(t);let r=[[]];return t.forEach((s,i)=>{if(0===e[i].length)r.forEach(o=>{o.push(i)});else{const o=[],c=e[i].some(u=>u>i);for(const u of r)!0===u.some(g=>e[i].some(m=>g===m))?o.push(Je.copyImmutableArray(u)):c?(o.push(Je.copyImmutableArray(u)),u.push(i),o.push(Je.copyImmutableArray(u))):(u.push(i),o.push(Je.copyImmutableArray(u)));r=o}}),r.map(s=>s.map(i=>t[i]))}static computeIntersections(t){const e=[];return t.forEach((r,s)=>{e.push([]),t.forEach((i,o)=>{s!==o&&r.intersectsWith(i)&&e[s].push(o)})}),e}getMetrics(t){const e=t.gameState;return[An.getPlayerScore(e,B.ZERO).get(),An.getPlayerScore(e,B.ONE).get()]}getListMoves(t){return this.getListMoveFromState(t.gameState)}getListMoveFromState(t){const e=[];return An.isGameOver(t)||this.getPossibleCaptureCombinations(t).forEach(r=>{const s=An.applyCaptures(r,t);An.getPlacements(s).forEach(i=>{const o=An.applyPlacement(i,s);this.getPossibleCaptureCombinations(o).forEach(c=>{const u=new $3(i,r,c);e.push(u)})})}),e}getPossibleCaptureCombinations(t){const e=An.getPossibleCaptures(t);return o_.getPossibleCaptureCombinationsFromPossibleCaptures(e)}}class S3e{constructor(t,e,r,s,i,o){this.source=t,this.destination=e,this.x1=r,this.y1=s,this.x2=i,this.y2=o}}const r1=xe.UNREACHABLE,gt=xe.EMPTY,Rr=xe.ZERO,j4=xe.ONE;class P3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,jc.getInitialState()),te.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,jc.getInitialState(),new $3(new Wc(new S(3,0),y.of(De.DOWN)),[],[]),$localize`Congratulations!`),te.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new jc([[r1,r1,r1,Rr,j4,gt,gt],[r1,r1,gt,gt,gt,gt,gt],[r1,gt,gt,gt,gt,gt,gt],[Rr,Rr,Rr,gt,gt,gt,gt],[j4,gt,gt,gt,gt,gt,r1],[gt,gt,gt,j4,gt,r1,r1],[gt,gt,gt,j4,r1,r1,r1]],42,[8,8],[0,0]),[new $3(new Wc(new S(0,3),y.of(De.RIGHT)),[],[new Si([new S(0,3),new S(1,3),new S(2,3),new S(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),te.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new jc([[r1,r1,r1,gt,gt,gt,gt],[r1,r1,gt,j4,gt,gt,gt],[r1,gt,gt,Rr,gt,gt,gt],[Rr,Rr,Rr,j4,gt,gt,gt],[gt,gt,gt,Rr,gt,gt,r1],[gt,gt,gt,Rr,gt,r1,r1],[gt,gt,gt,j4,r1,r1,r1]],42,[8,4],[2,3]),[new $3(new Wc(new S(0,3),y.of(De.RIGHT)),[],[new Si([new S(3,1),new S(3,2),new S(3,3),new S(3,4),new S(3,5),new S(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),te.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new jc([[r1,r1,r1,Rr,gt,gt,Rr],[r1,r1,gt,Rr,gt,gt,Rr],[r1,Rr,Rr,gt,Rr,j4,Rr],[gt,gt,gt,Rr,gt,gt,Rr],[gt,gt,gt,Rr,gt,gt,r1],[Rr,Rr,Rr,j4,j4,r1,r1],[gt,gt,gt,Rr,r1,r1,r1]],42,[3,4],[2,3]),[new $3(new Wc(new S(3,6),y.of(De.UP)),[new Si([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new Si([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)]),new Si([new S(1,2),new S(2,2),new S(3,2),new S(4,2),new S(5,2)])]),new $3(new Wc(new S(4,6),y.of(De.UP)),[new Si([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new Si([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)]),new Si([new S(3,0),new S(3,1),new S(3,2),new S(3,3),new S(3,4)])]),new $3(new Wc(new S(3,6),y.of(De.UP)),[new Si([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new Si([new S(1,2),new S(2,2),new S(3,2),new S(4,2),new S(5,2)]),new Si([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}}function d6t(n,t){if(1&n&&(H(),X(0,"circle",13)),2&n){const e=C().$implicit,r=C();w("ngClass",r.getPieceClass(e)),z("cx",r.getCenterAt(e).x)("cy",r.getCenterAt(e).y)("r",r.SPACE_SIZE)}}function p6t(n,t){if(1&n){const e=Ae();H(),b(0,"g",10),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i))}),X(1,"polygon",11),x(2,d6t,1,4,"circle",12),A()}if(2&n){const e=t.$implicit,r=C();Le("id","click_",e.x,"_",e.y,""),T(1),Le("id","space_",e.x,"_",e.y,""),w("ngClass",r.getSpaceClass(e)),z("points",r.getHexaPointsAt(e)),T(1),w("ngIf",r.isPiece(e))}}function g6t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",16),ee("click",function(){const i=de(e).$implicit;return le(C(2).onClick(i))}),A()}if(2&n){const e=t.$implicit;z("points",C(2).getHexaPointsAt(e))}}function m6t(n,t){if(1&n&&(H(),b(0,"g",14),x(1,g6t,1,1,"polygon",15),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e.capturedSpaces)}}function _6t(n,t){if(1&n){const e=Ae();H(),b(0,"line",17),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i.destination))}),A()}if(2&n){const e=t.$implicit;z("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function v6t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"circle",18),A()),2&n){const e=t.$implicit,r=C().$implicit,s=C();T(1),Le("id","piece_",r.value,"_",e,""),w("ngClass",s.getPlayerClass(r)),z("cx",s.getRemainingPieceCx(r,e))("cy",s.getRemainingPieceCy(r))("r",.5*s.SPACE_SIZE)}}function C6t(n,t){if(1&n&&(H(),b(0,"g"),x(1,v6t,2,6,"g",8),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",r.getPlayerSidePieces(e))}}function y6t(n,t){if(1&n&&(H(),X(0,"line",19)),2&n){const e=C();z("x1",e.inserted.get().x1)("y1",e.inserted.get().y1)("x2",e.inserted.get().x2)("y2",e.inserted.get().y2)}}let E6t=(()=>{class n extends Uh{constructor(e){super(e),this.inserted=y.empty(),this.arrows=[],this.captured=[],this.moved=[],this.hexagonWidth=this.SPACE_SIZE,this.sharedHexagonX=Math.cos(30)*this.hexagonWidth*.5,this.boardWidth=this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2,this.boardHeight=7*this.hexagonWidth+4.5*this.STROKE_WIDTH,this.movePhase=n.PHASE_PLACEMENT_COORD,this.possibleCaptures=[],this.initialCaptures=[],this.placement=y.empty(),this.placementEntrance=y.empty(),this.finalCaptures=[],this.hasAsymmetricBoard=!0,this.scores=y.of([0,0]),this.rules=An.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new o_(this.rules,"GipfMinimax")],this.encoder=$3.encoder,this.tutorial=(new P3e).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new Gh(1.5*this.SPACE_SIZE,new S(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),xs.INSTANCE)}updateBoard(){this.cancelMoveAttempt()}showLastMove(e){if(this.inserted=y.empty(),e.placement.direction.isPresent()){const r=e.placement;this.inserted=y.of(this.arrowTowards(r.coord,r.direction.get()))}this.cancelMoveAttempt()}arrowTowards(e,r){const s=e.getNext(r.getOpposite()),i=this.getCenterAt(e),o=this.getCenterAt(s);return new S3e(s,e,o.x,o.y,i.x,i.y)}markCapture(e){e.forEach(r=>{this.captured.push(r)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(e){const r=this.constructedState.getNumberOfPiecesToPlace(e),s=[];for(let i=0;i<r;i+=1)s.push(i);return s}isPiece(e){return this.getPiece(e)!==xe.EMPTY}getPiece(e){return this.constructedState.getPieceAt(e)}onClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());switch(r.movePhase){case n.PHASE_INITIAL_CAPTURE:case n.PHASE_FINAL_CAPTURE:return r.selectCapture(e);case n.PHASE_PLACEMENT_COORD:return r.selectPlacementCoord(e);default:return ge.expectToBe(r.movePhase,n.PHASE_PLACEMENT_DIRECTION),r.selectPlacementDirectionOrPlacementCoord(e)}})()}selectCapture(e){var r=this;return I(function*(){const s=[];if(r.possibleCaptures.forEach(o=>{o.contains(e)&&s.push(o)}),s.length>1)return r.cancelMove(Zc.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return r.cancelMove(Zc.MISSING_CAPTURES());const i=s[0];return r.constructedState=An.applyCapture(i,r.constructedState),r.markCapture(i),r.possibleCaptures=An.getPossibleCaptures(r.constructedState),r.movePhase===n.PHASE_INITIAL_CAPTURE?(r.initialCaptures.push(i),0===r.possibleCaptures.length?r.moveToPlacementPhase():R.SUCCESS):(ge.expectToBe(r.movePhase,n.PHASE_FINAL_CAPTURE),r.finalCaptures.push(i),0===r.possibleCaptures.length?r.tryMove(r.initialCaptures,r.placement.get(),r.finalCaptures):R.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=n.PHASE_PLACEMENT_COORD,R.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=An.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,R.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var e=this;return I(function*(){return e.possibleCaptures=An.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,R.SUCCESS)})()}computeArrows(e){this.arrows=[];for(const r of An.getAllDirectionsForEntrance(this.constructedState,e))if(!1===An.isLineComplete(this.constructedState,e,r)){const s=e.getNext(r),i=this.getCenterAt(e),o=this.getCenterAt(s);this.arrows.push(new S3e(e,s,i.x,i.y,o.x,o.y))}}selectPlacementCoord(e){var r=this;return I(function*(){const s=r.rules.placementCoordValidity(r.constructedState,e);return s.isFailure()?r.cancelMove(s.getReason()):r.placementEntrance.equalsValue(e)?(r.cancelMoveAttempt(),R.SUCCESS):(r.placementEntrance=y.of(e),r.constructedState.getPieceAt(e)===xe.EMPTY?r.selectPlacementDirection(y.empty()):(r.movePhase=n.PHASE_PLACEMENT_DIRECTION,r.computeArrows(e),0===r.arrows.length&&r.cancelMove(Zc.NO_DIRECTIONS_AVAILABLE()),R.SUCCESS))})()}selectPlacementDirection(e){var r=this;return I(function*(){r.placement=y.of(new Wc(r.placementEntrance.get(),e));const s=r.rules.placementValidity(r.constructedState,r.placement.get());return s.isFailure()?r.cancelMove(s.getReason()):(r.arrows=[],r.constructedState=An.applyPlacement(r.placement.get(),r.constructedState),r.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(e){var r=this;return I(function*(){const s=r.placementEntrance.get();if(!1===s.isAlignedWith(e)||1!==s.getDistance(e))return r.selectPlacementCoord(e);const i=De.factory.fromMove(s,e);return r.selectPlacementDirection(i.toOptional())})()}tryMove(e,r,s){const i=new $3(r,e,s);return this.chooseMove(i)}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const e=this.node.move;if(e.isPresent()){const r=e.get(),s=this.getPreviousState();r.initialCaptures.forEach(i=>this.markCapture(i)),r.finalCaptures.forEach(i=>this.markCapture(i)),this.moved=this.rules.getPiecesMoved(s,r.initialCaptures,r.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=y.empty(),this.placement=y.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(e){return this.captured.some(r=>r.equals(e))?"captured-fill":this.moved.some(r=>r.equals(e))?"moved-fill":""}getPieceClass(e){const r=this.getPiece(e);return this.getPlayerClass(B.of(r.value))}getRemainingPieceCy(e){return e===B.ONE?25:this.boardHeight-25}getRemainingPieceCx(e,r){const s=20+r*this.SPACE_SIZE*.5;return e===B.ONE?s:this.boardWidth-(15+s)}}return n.PHASE_INITIAL_CAPTURE=0,n.PHASE_PLACEMENT_COORD=1,n.PHASE_PLACEMENT_DIRECTION=2,n.PHASE_FINAL_CAPTURE=3,n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-gipf"]],features:[l],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,r){1&e&&(H(),b(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),A(),b(4,"marker",3),X(5,"polygon",4),A()(),x(6,p6t,3,7,"g",5),x(7,m6t,2,1,"g",6),x(8,_6t,1,4,"line",7),x(9,C6t,2,1,"g",8),x(10,y6t,1,4,"line",9),A()),2&e&&(z("viewBox",-r.STROKE_WIDTH+" 0 "+r.boardWidth+" "+r.boardHeight)("transform",r.rotation),T(6),w("ngForOf",r.getAllCoords()),T(1),w("ngForOf",r.possibleCaptures),T(1),w("ngForOf",r.arrows),T(1),w("ngForOf",r.Player.PLAYERS),T(1),w("ngIf",r.inserted.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class vr extends ms{static of(t){return new vr(t.x,t.y)}toString(){return this===vr.PASS?"GoMove.PASS":this===vr.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}vr.PASS=new vr(-1,0),vr.ACCEPT=new vr(-2,0),vr.encoder=ms.getEncoder(vr.of);class Ge{constructor(t,e){this.player=t,this.type=e}equals(t){return t===this}toString(){switch(this){case Ge.DARK:return"GoPiece.DARK";case Ge.LIGHT:return"GoPiece.LIGHT";case Ge.EMPTY:return"GoPiece.EMPTY";case Ge.DEAD_DARK:return"GoPiece.DEAD_DARK";case Ge.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case Ge.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return We(this===Ge.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(t,e){return e===t.player&&"territory"!==t.type}static ofPlayer(t){return t===B.ZERO?Ge.DARK:Ge.LIGHT}isOccupied(){return[Ge.DARK,Ge.LIGHT,Ge.DEAD_DARK,Ge.DEAD_LIGHT].includes(this)}isEmpty(){return[Ge.DARK_TERRITORY,Ge.LIGHT_TERRITORY,Ge.EMPTY].includes(this)}isDead(){return[Ge.DEAD_DARK,Ge.DEAD_LIGHT].includes(this)}isTerritory(){return[Ge.DARK_TERRITORY,Ge.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return We(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),Ge.EMPTY}}Ge.DARK=new Ge(B.ZERO,"alive"),Ge.LIGHT=new Ge(B.ONE,"alive"),Ge.EMPTY=new Ge(ue.NONE,"empty"),Ge.DEAD_DARK=new Ge(B.ZERO,"dead"),Ge.DEAD_LIGHT=new Ge(B.ONE,"dead"),Ge.DARK_TERRITORY=new Ge(ue.NONE,"territory"),Ge.LIGHT_TERRITORY=new Ge(ue.NONE,"territory");var Bn=(()=>(function(n){n.PLAYING="PLAYING",n.PASSED="PASSED",n.COUNTING="COUNTING",n.ACCEPT="ACCEPT",n.FINISHED="FINISHED"}(Bn||(Bn={})),Bn))();let vs=(()=>{class n extends xr{constructor(e,r,s,i,o){super(e,s),this.captured=r,this.koCoord=i,this.phase=o}static getInitialState(){const e=n.getStartingBoard();return new n(e,[0,0],0,y.empty(),Bn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return Je.createTable(n.WIDTH,n.HEIGHT,Ge.EMPTY)}copy(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}return n.WIDTH=19,n.HEIGHT=19,n})();const ut=Ge.LIGHT,rt=Ge.DARK,KH=Ge.DEAD_LIGHT,Kh=Ge.LIGHT_TERRITORY,Yc=Ge.DARK_TERRITORY,ye=Ge.EMPTY;class T3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,vs.getInitialState()),te.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new vs([[ye,rt,ye,ye,ut,ut],[ye,rt,ye,ye,ut,ye],[ye,rt,rt,ut,ut,ye],[ye,ye,rt,ut,ye,ye],[ye,ye,rt,ut,ye,ye],[ye,ye,rt,ut,ye,ye]],[0,0],0,y.empty(),Bn.PLAYING)),te.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new vs([[ye,ye,ye,ye,ye],[ye,ye,rt,ye,ye],[ye,rt,ut,ye,ye],[ye,ye,rt,ye,ye],[ye,ye,ye,ye,ye]],[0,0],0,y.empty(),Bn.PLAYING),[new vr(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),te.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new vs([[ye,rt,ye,ye,ye],[rt,ut,ye,ye,ye],[rt,ut,ut,rt,ye],[ye,rt,rt,ye,ye],[ye,ye,ye,ye,ye]],[0,0],0,y.empty(),Bn.PLAYING),[new vr(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),te.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new vs([[ye,rt,ye,ye,ye],[rt,ye,ye,ye,ye],[rt,ye,ye,ye,ut],[ut,rt,ye,ut,ye],[ye,ut,ye,ut,rt]],[0,0],0,y.empty(),Bn.PLAYING)),te.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new vs([[ye,ye,ye,ye,ye],[rt,rt,rt,ye,ye],[ut,ut,rt,ye,ye],[ye,ut,rt,ye,ye],[ut,ut,rt,ye,ye]],[0,0],0,y.empty(),Bn.PLAYING)),te.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new vs([[ye,rt,ut,ye,ye],[ut,rt,ut,ye,ye],[rt,rt,ut,ye,ye],[ut,rt,ut,ye,ye],[ye,rt,ut,ye,ye]],[0,0],0,y.empty(),Bn.PLAYING)),te.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new vs([[ye,ut,rt,ye,ut,rt,ye],[ye,ut,rt,rt,ut,rt,ye],[ye,ut,rt,rt,ut,rt,ye],[ye,ut,rt,rt,ut,rt,ye],[ye,ut,rt,ut,ut,rt,ye],[ye,ut,rt,ut,ut,rt,ye],[ye,ut,rt,ye,ut,rt,ye]],[0,0],0,y.empty(),Bn.PLAYING)),te.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new vs([[ye,ye,ye,ye,ye,ye,ye],[ye,ye,ye,ye,ye,ye,ye],[ye,ye,ye,rt,ut,ye,ye],[ye,ye,rt,ut,ye,ut,ye],[ye,ye,ye,rt,ut,ye,ye],[ye,ye,ye,ye,ye,ye,ye],[ye,ye,ye,ye,ye,ye,ye]],[0,0],0,y.empty(),Bn.PLAYING),[new vr(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),te.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new vs([[ut,rt,rt,rt,rt,rt,Yc,Yc,Yc],[ut,ut,ut,ut,rt,rt,rt,Yc,Yc],[ut,Kh,ut,ut,rt,KH,KH,rt,Yc],[rt,ut,ut,ut,ut,rt,Yc,Yc,Yc],[ye,ut,Kh,ut,rt,rt,KH,rt,Yc],[ut,Kh,ut,ut,rt,rt,rt,rt,rt],[ut,ut,rt,rt,rt,ut,ut,rt,ut],[rt,rt,rt,ut,ut,ut,Kh,ut,ut],[Yc,Yc,rt,rt,rt,ut,ut,Kh,Kh]],[0,0],0,y.empty(),Bn.COUNTING),[new vr(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)]}}let S8=(()=>{class n{constructor(e){this.color=e}selfContains(e){return this.getCoords().some(s=>s.equals(e))}static insertAsEntryPoint(e,r){return 0===e.length?[r]:r.compareTo(e[0])<0?[r].concat(e):e.concat([r])}}return n.VERBOSE=!1,n})();class P6t extends S8{constructor(t,e,r,s,i,o){super(t),this.emptyCoords=e,this.darkCoords=r,this.lightCoords=s,this.deadDarkCoords=i,this.deadLightCoords=o}getCoords(){return this.color===Ge.DARK?this.darkCoords:this.color===Ge.LIGHT?this.lightCoords:this.color===Ge.DEAD_DARK?this.deadDarkCoords:this.color===Ge.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(t){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(r=>r.equals(t))}addPawn(t,e){switch(We(!1===this.contains(t),"This group already contains "+t.toString()),e){case Ge.DARK:this.darkCoords=S8.insertAsEntryPoint(this.darkCoords,t);break;case Ge.LIGHT:this.lightCoords=S8.insertAsEntryPoint(this.lightCoords,t);break;case Ge.DEAD_DARK:this.deadDarkCoords=S8.insertAsEntryPoint(this.deadDarkCoords,t);break;case Ge.DEAD_LIGHT:this.deadLightCoords=S8.insertAsEntryPoint(this.deadLightCoords,t);break;default:ge.expectToBeMultiple(e,[Ge.EMPTY,Ge.DARK_TERRITORY,Ge.LIGHT_TERRITORY]),this.emptyCoords=S8.insertAsEntryPoint(this.emptyCoords,t)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const t=new jn;t.set(Ge.EMPTY,this.emptyCoords.length),t.set(Ge.DARK,this.darkCoords.length+this.deadLightCoords.length),t.set(Ge.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),t.put(this.color.nonTerritory(),0);const e=t.filter((r,s)=>s>0);if(1===e.size())return e.getAnyPair().get().key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const t=[];return this.color!==Ge.EMPTY&&this.emptyCoords.length>0&&t.push(this.emptyCoords[0]),this.color!==Ge.DARK&&this.darkCoords.length>0&&t.push(this.darkCoords[0]),this.color!==Ge.LIGHT&&this.lightCoords.length>0&&t.push(this.lightCoords[0]),this.color!==Ge.DEAD_DARK&&this.deadDarkCoords.length>0&&t.push(this.deadDarkCoords[0]),this.color!==Ge.DEAD_LIGHT&&this.deadLightCoords.length>0&&t.push(this.deadLightCoords[0]),t}}class a_ extends class S6t{getGroupDatas(t,e){J(S8.VERBOSE,"GroupDatas.getGroupDatas("+t+", "+e+")");const s=this.getNewInstance(e[t.y][t.x]);return this._getGroupDatas(t,e,s)}_getGroupDatas(t,e,r){J(S8.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:r,coord:t}});const s=e[t.y][t.x];if(r.addPawn(t,s),s===r.color)for(const i of this.getDirections()){const o=t.getNext(i);o.isInRange(e[0].length,e.length)&&(r.contains(o)||(r=this._getGroupDatas(o,e,r)))}return r}}{getNewInstance(t){return new P6t(t,[],[],[],[],[])}getDirections(){return Be.ORTHOGONALS}}let c_=(()=>{class n{}return n.ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`,n.CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`,n.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`,n.OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`,n.CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`,n})();class At extends I1{constructor(){super(vs)}static get(){return At.singleton.isAbsent()&&(At.singleton=y.of(new At)),At.singleton.get()}static isLegal(t,e){if(J(At.VERBOSE||!1,{isLegal:{move:t,state:e}}),At.isPass(t)){const s=e.phase===Bn.PLAYING,i=e.phase===Bn.PASSED;return J(At.VERBOSE||!1,"GoRules.isLegal at "+e.phase+(s||i?" forbid":" allowed")+" passing on "+e.getCopiedBoard()),s||i?ve.success([]):ve.failure(c_.CANNOT_PASS_AFTER_PASSED_PHASE())}if(At.isAccept(t)){const i=e.phase===Bn.ACCEPT;return e.phase===Bn.COUNTING||i?ve.success([]):ve.failure(c_.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return At.isOccupied(t.coord,e.getCopiedBoard())?(J(At.VERBOSE||!1,"GoRules.isLegal: move is marking"),At.isLegalDeadMarking(t,e)?ve.success([]):ve.failure(c_.OCCUPIED_INTERSECTION())):(J(At.VERBOSE||!1,"GoRules.isLegal: move is normal stuff: "+t.toString()),At.isLegalNormalMove(t,e))}static getNewKo(t,e,r){if(1===r.length){const s=r[0],i=t.coord,o=e[i.y][i.x],u=(new a_).getGroupDatas(i,e),h=u.emptyCoords,g=Ge.pieceBelongTo(o,B.ZERO)?u.darkCoords:u.lightCoords;if(1===h.length&&h[0].equals(s)&&1===g.length)return y.of(s)}return y.empty()}static markTerritoryAndCount(t){J(At.VERBOSE,{markTerritoryAndCount:{state:t}});const e=t.getCopiedBoard(),r=At.getTerritoryLikeGroup(t),s=t.getCapturedCopy();for(const i of r){const o=i.getWrapper();if(o===Ge.LIGHT){s[1]+=i.emptyCoords.length;for(const c of i.getCoords())e[c.y][c.x]=Ge.LIGHT_TERRITORY}else{We(o===Ge.DARK,"territory should be wrapped by dark or light, not by "+o.toString()),s[0]+=i.emptyCoords.length;for(const c of i.getCoords())e[c.y][c.x]=Ge.DARK_TERRITORY}}return new vs(e,s,t.turn,t.koCoord,t.phase)}static removeAndSubstractTerritory(t){const e=t.getCopiedBoard(),r=t.getCapturedCopy();let s;for(let i=0;i<t.board.length;i++)for(let o=0;o<t.board[0].length;o++)s=e[i][o],s===Ge.DARK_TERRITORY?(e[i][o]=Ge.EMPTY,r[0]=r[0]-1):s===Ge.LIGHT_TERRITORY&&(e[i][o]=Ge.EMPTY,r[1]=r[1]-1);return new vs(e,r,t.turn,t.koCoord,t.phase)}static getEmptyZones(t){return At.getGroupsDatasWhere(t.getCopiedBoard(),e=>e.isEmpty())}static getGroupsDatasWhere(t,e){const r=[];let s,i,o;const c=new a_;for(let u=0;u<t.length;u++)for(let h=0;h<t[0].length;h++)s=new S(h,u),o=t[u][h],e(o)&&(r.some(g=>g.selfContains(s))||(i=c.getGroupDatas(s,t),r.push(i)));return r}static addDeadToScore(t){const e=t.getCapturedCopy();let i,r=e[1],s=e[0];for(let o=0;o<t.board.length;o++)for(let c=0;c<t.board[0].length;c++)i=t.getPieceAtXY(c,o),i===Ge.DEAD_DARK?r++:i===Ge.DEAD_LIGHT&&s++;return[s,r]}static switchAliveness(t,e){const r=e.getCopiedBoard();We(r[t.y][t.x].isOccupied(),"Can't switch emptyness aliveness");const o=(new a_).getGroupDatas(t,r),c=e.getCapturedCopy();switch(o.color){case Ge.DEAD_DARK:c[1]-=2*o.deadDarkCoords.length;for(const u of o.deadDarkCoords)r[u.y][u.x]=Ge.DARK;break;case Ge.DEAD_LIGHT:c[0]-=2*o.deadLightCoords.length;for(const u of o.deadLightCoords)r[u.y][u.x]=Ge.LIGHT;break;case Ge.LIGHT:c[0]+=2*o.lightCoords.length;for(const u of o.lightCoords)r[u.y][u.x]=Ge.DEAD_LIGHT;break;default:ge.expectToBe(o.color,Ge.DARK),c[1]+=2*o.darkCoords.length;for(const u of o.darkCoords)r[u.y][u.x]=Ge.DEAD_DARK}return new vs(r,c,e.turn,e.koCoord,e.phase)}static getGameStatus(t){const e=t.gameState;return e.phase===Bn.FINISHED?e.captured[0]>e.captured[1]?Ie.ZERO_WON:e.captured[1]>e.captured[0]?Ie.ONE_WON:Ie.DRAW:Ie.ONGOING}static isPass(t){return t.equals(vr.PASS)}static isAccept(t){return t.equals(vr.ACCEPT)}static isLegalDeadMarking(t,e){return At.isOccupied(t.coord,e.getCopiedBoard())&&(e.phase===Bn.COUNTING||e.phase===Bn.ACCEPT)}static isLegalNormalMove(t,e){const r=e.getCopiedBoard();if(At.isKo(t,e))return ve.failure(c_.ILLEGAL_KO());[Bn.COUNTING,Bn.ACCEPT].includes(e.phase)&&(e=At.resurrectStones(e));const s=At.getCaptureState(t,e);if(O3e.isCapturing(s))return ve.success(s.capturedCoords);{r[t.coord.y][t.coord.x]=e.turn%2==0?Ge.DARK:Ge.LIGHT;const c=0===(new a_).getGroupDatas(t.coord,r).emptyCoords.length;return r[t.coord.y][t.coord.x]=Ge.EMPTY,c?ve.failure(c_.CANNOT_COMMIT_SUICIDE()):ve.success([])}}static isOccupied(t,e){return e[t.y][t.x].isOccupied()}static isKo(t,e){return!!e.koCoord.isPresent()&&t.coord.equals(e.koCoord.get())}static getCaptureState(t,e){J(At.VERBOSE||!1,{getCaptureState:{move:t,state:e}});const s=new O3e;let i;for(const o of Be.ORTHOGONALS)i=At.getCapturedInDirection(t.coord,o,e),i.length>0&&s.capturedCoords.every(c=>!i[0].equals(c))&&(s.capturedCoords=s.capturedCoords.concat(i));return s}static getCapturedInDirection(t,e,r){const i=r.getCopiedBoard(),o=t.getNext(e);if(o.isInRange(r.board[0].length,r.board.length)&&i[o.y][o.x]===(r.turn%2==0?Ge.LIGHT:Ge.DARK)){J(At.VERBOSE||!1,"a group could be captured");const h=(new a_).getGroupDatas(o,i);if(At.isCapturableGroup(h,r.koCoord))return J(At.VERBOSE||!1,{neightbooringGroupCoord:h.getCoords(),message:"is capturable"}),h.getCoords()}return[]}static isCapturableGroup(t,e){return!(!t.color.isOccupied()||1!==t.emptyCoords.length)&&!1===e.equalsValue(t.emptyCoords[0])}static getTerritoryLikeGroup(t){return At.getEmptyZones(t).filter(r=>r.isMonoWrapped())}static applyPass(t){const e=t.getCopiedBoard(),r=t.getCapturedCopy(),s=t.turn;let i,o;return t.phase===Bn.PASSED?(i=Bn.COUNTING,o=new vs(e,r,s+1,y.empty(),i),o=At.markTerritoryAndCount(o)):(We(t.phase===Bn.PLAYING,"Cannot pass in counting phase!"),i=Bn.PASSED,o=new vs(e,r,s+1,y.empty(),i)),o}static applyLegalAccept(t){const e=t.getCopiedBoard();let r;return r=t.phase===Bn.COUNTING?Bn.ACCEPT:Bn.FINISHED,new vs(e,t.getCapturedCopy(),t.turn+1,y.empty(),r)}static applyNormalLegalMove(t,e,r){let s;J(At.VERBOSE,{applyNormalLegal:{currentState:e,legalMove:t,status}}),s=[Bn.COUNTING,Bn.ACCEPT].includes(e.phase)?At.resurrectStones(e):e.copy();const i=t.coord.x,o=t.coord.y,c=s.getCopiedBoard(),u=s.turn,h=Ge.ofPlayer(s.getCurrentPlayer()),g=u+1;c[o][i]=h;for(const O of r)c[O.y][O.x]=Ge.EMPTY;const m=At.getNewKo(t,c,r),E=s.getCapturedCopy();return E[h.player.value]+=r.length,new vs(c,E,g,m,Bn.PLAYING)}static resurrectStones(t){for(let e=0;e<t.board.length;e++)for(let r=0;r<t.board[0].length;r++)t.getPieceAtXY(r,e).isDead()&&(t=At.switchAliveness(new S(r,e),t));return At.removeAndSubstractTerritory(t)}static applyDeadMarkingMove(t,e){J(At.VERBOSE,{applyDeadMarkingMove:{legalMove:t,state:e}});const r=At.removeAndSubstractTerritory(e),s=At.switchAliveness(t.coord,r),i=new vs(s.getCopiedBoard(),s.getCapturedCopy(),s.turn+1,y.empty(),Bn.COUNTING);return At.markTerritoryAndCount(i)}isLegal(t,e){return At.isLegal(t,e)}applyLegalMove(t,e,r){return J(At.VERBOSE,{applyLegalMove:{legalMove:t,state:e,status}}),At.isPass(t)?(J(At.VERBOSE,"GoRules.applyLegalMove: isPass"),At.applyPass(e)):At.isAccept(t)?(J(At.VERBOSE,"GoRules.applyLegalMove: isAccept"),At.applyLegalAccept(e)):At.isLegalDeadMarking(t,e)?(J(At.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),At.applyDeadMarkingMove(t,e)):(J(At.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),At.applyNormalLegalMove(t,e,r))}getGameStatus(t){return At.getGameStatus(t)}}At.VERBOSE=!1,At.singleton=y.empty();class O3e{constructor(){this.capturedCoords=[]}static isCapturing(t){return t.capturedCoords.length>0}}class T6t extends ks{getListMoves(t){J(At.VERBOSE||!1,"GoRules.getListMoves");const r=t.gameState,s=this.getPlayingMovesList(r);if(r.phase===Bn.PLAYING||r.phase===Bn.PASSED)return s.push(vr.PASS),s;{J(At.VERBOSE||!1,"GoRules.getListMoves in counting phase");const i=this.getCountingMovesList(r);return 0===i.length?[vr.ACCEPT]:i}}getPlayingMovesList(t){const e=[];let r;for(let s=0;s<t.board.length;s++)for(let i=0;i<t.board[0].length;i++)r=new vr(i,s),t.getPieceAt(r.coord)===Ge.EMPTY&&At.isLegal(r,t).isSuccess()&&e.push(r);return e}getCountingMovesList(t){const e=[],r=this.getCorrectBoard(t).getCopiedBoard(),s=At.getGroupsDatasWhere(r,i=>i!==Ge.EMPTY);for(const i of s){const o=i.getCoords()[0],c=r[o.y][o.x];if(t.getPieceAt(o)!==c){const h=new vr(o.x,o.y);return e.push(h),e}}return e}getCorrectBoard(t){const r=this.mapBoard(t.getCopiedBoard(),o=>o===Ge.DARK?Ge.DEAD_DARK:o===Ge.LIGHT?Ge.DEAD_LIGHT:o.isTerritory()?Ge.EMPTY:o),s=new vs(r,t.getCapturedCopy(),t.turn,t.koCoord,t.phase),i=At.getTerritoryLikeGroup(s);return this.setAliveUniqueWrapper(s,i)}mapBoard(t,e){const r=[];for(let s=0;s<t.length;s++){r[s]=[];for(let i=0;i<t[0].length;i++)r[s][i]=e(t[s][i])}return r}setAliveUniqueWrapper(t,e){let s,r=t.copy();for(const i of e){s=i.deadDarkCoords.concat(i.deadLightCoords);for(const o of s)r.isDead(o)&&(r=At.switchAliveness(o,r))}return r}getMetrics(t){const e=At.markTerritoryAndCount(t.gameState),r=e.getCapturedCopy(),s=this.getDeadStones(e);return[r[0]+2*s[1],r[1]+2*s[0]]}getDeadStones(t){const e=[0,0];for(let r=0;r<t.board.length;r++)for(let s=0;s<t.board[0].length;s++){const i=t.getPieceAtXY(s,r);"dead"===i.type&&(e[i.player.value]=e[i.player.value]+1)}return e}}function w6t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",8),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),A(),b(2,"line",9),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),A(),b(3,"line",9),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),A()()}if(2&n){const e=t.index,r=C().index,s=C();T(1),Le("id","click_",e,"_",r,""),z("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*e)("y",.5*s.SPACE_SIZE*r),T(1),z("x1",.5*s.SPACE_SIZE*e)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),z("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)}}function O6t(n,t){if(1&n&&(H(),b(0,"g"),x(1,w6t,4,14,"g",3),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function b6t(n,t){if(1&n){const e=Ae();H(),b(0,"circle",10),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();Le("id","hoshi_",e.x,"_",e.y,""),z("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.y)("r",.1*r.SPACE_SIZE)}}function A6t(n,t){if(1&n&&(H(),X(0,"circle",16)),2&n){const e=C(2).index,r=C().index,s=C();z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function N6t(n,t){if(1&n){const e=Ae();H(),b(0,"line",17),ee("click",function(){de(e);const s=C(2).index,i=C().index;return le(C().onClick(s,i))}),A()}if(2&n){const e=C(2).index,r=C().index,s=C();z("x1",.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)}}function I6t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"circle",13),ee("click",function(){de(e);const s=C().index,i=C().index;return le(C().onClick(s,i))}),A(),x(2,A6t,1,3,"circle",14),x(3,N6t,1,4,"line",15),A()}if(2&n){const e=C().index,r=C().index,s=C();T(1),w("ngClass",s.getSpaceClass(e,r)),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE),T(1),w("ngIf",s.isLastSpace(e,r)),T(1),w("ngIf",s.isDead(e,r))}}function x6t(n,t){if(1&n){const e=Ae();H(),b(0,"circle",19),ee("click",function(){de(e);const s=C(2).index,i=C().index;return le(C().onClick(s,i))}),A()}if(2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();z("cx",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*r)("cy",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*i)("r",.1*o.SPACE_SIZE)("class",s===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function k6t(n,t){if(1&n&&(H(),x(0,x6t,1,4,"circle",18)),2&n){const e=C().index,r=C().index;w("ngIf",C().isTerritory(e,r))}}function L6t(n,t){if(1&n&&(H(),b(0,"g"),x(1,I6t,4,6,"g",11),x(2,k6t,1,1,"ng-template",null,12,qn),A()),2&n){const e=t.index,r=Hn(3),s=C().index,i=C();T(1),w("ngIf",i.spaceIsFull(e,s))("ngIfElse",r)}}function R6t(n,t){if(1&n&&(H(),b(0,"g"),x(1,L6t,4,2,"g",3),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function D6t(n,t){if(1&n&&(H(),X(0,"rect",20)),2&n){const e=C();z("width",.25*e.SPACE_SIZE)("height",.25*e.SPACE_SIZE)("x",.125*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.ko.get().x)("y",.125*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.ko.get().y)}}function z6t(n,t){if(1&n){const e=Ae();H(),b(0,"circle",21),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();z("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.y)("r",.07*r.SPACE_SIZE)}}let V6t=(()=>{class n extends WH{constructor(e){super(e),this.ko=y.empty(),this.last=y.empty(),this.captures=[],this.GoPiece=Ge,this.boardHeight=vs.HEIGHT,this.boardWidth=vs.WIDTH,this.scores=y.of([0,0]),this.rules=At.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new T6t(this.rules,"GoMinimax")],this.encoder=vr.encoder,this.tutorial=(new T3e).tutorial,this.canPass=!0,this.boardHeight=this.getState().board.length,this.boardWidth=this.getState().board[0].length,this.updateBoard()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());s.last=y.empty();const o=new vr(e,r);return s.chooseMove(o)})()}updateBoard(){J(n.VERBOSE,"updateBoard");const e=this.getState(),r=this.node.move,s=e.phase;this.board=e.getCopiedBoard(),this.scores=y.of(e.getCapturedCopy()),this.ko=e.koCoord,r.isPresent()?this.showCaptures():this.captures=[],this.last=r.map(i=>i.coord),this.canPass=s!==Bn.FINISHED,this.createHoshis()}showCaptures(){const e=this.getPreviousState();this.captures=[];for(let r=0;r<this.board.length;r++)for(let s=0;s<this.board[0].length;s++){const i=new S(s,r),o=e.getPieceAt(i).isOccupied(),c=this.board[r][s]===Ge.EMPTY,u=!1===this.ko.equalsValue(i);o&&c&&u&&this.captures.push(i)}}pass(){var e=this;return I(function*(){const r=e.getState().phase;return r===Bn.PLAYING||r===Bn.PASSED?e.onClick(vr.PASS.coord.x,vr.PASS.coord.y):(We(r===Bn.COUNTING||r===Bn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(vr.ACCEPT.coord.x,vr.ACCEPT.coord.y))})()}getSpaceClass(e,r){const s=this.getState().getPieceAtXY(e,r);return this.getPlayerClass(s.getOwner())}spaceIsFull(e,r){return this.getState().getPieceAtXY(e,r)!==Ge.EMPTY&&!this.isTerritory(e,r)}isLastSpace(e,r){if(this.last.isPresent()){const s=this.last.get();return e===s.x&&r===s.y}return!1}isDead(e,r){return this.getState().isDead(new S(e,r))}isTerritory(e,r){return this.getState().isTerritory(new S(e,r))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-go"]],features:[l],decls:9,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],["id","blank_board"],[4,"ngFor","ngForOf"],["class","base-no-stroke",3,"id","click",4,"ngFor","ngForOf"],["id","piece_ko_territory_markers_and_dead_stones"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],["fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[1,"base-no-stroke",3,"id","click"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),X(1,"rect",1),b(2,"g",2),x(3,O6t,2,1,"g",3),x(4,b6t,1,5,"circle",4),A(),b(5,"g",5),x(6,R6t,2,1,"g",3),A(),x(7,D6t,1,4,"rect",6),x(8,z6t,1,3,"circle",7),A()),2&e&&(z("viewBox","0 -3 "+r.boardWidth*r.SPACE_SIZE*.5+" "+(6+r.boardHeight*r.SPACE_SIZE*.5)),T(1),z("width",r.boardWidth*r.SPACE_SIZE*.5)("height",r.boardHeight*r.SPACE_SIZE*.5),T(2),w("ngForOf",r.board),T(1),w("ngForOf",r.hoshis),T(2),w("ngForOf",r.board),T(1),w("ngIf",r.ko.isPresent()),T(1),w("ngForOf",r.captures))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class T6{constructor(t,e,r,s){this.left=t,this.up=e,this.width=r,this.height=s}static fromLimits(t,e,r,s){return new T6(t,r,e-t,s-r)}static fromHexa(t,e,r){const s=t.flatMap(g=>e.getHexaPointsListAt(g)),i=T6.getLimits(s);return new T6(i.minX-r/2,i.minY-r/2,r+i.maxX-i.minX,r+i.maxY-i.minY)}static getLimits(t){let e=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;for(const o of t)s=Math.min(s,o.x),i=Math.min(i,o.y),e=Math.max(e,o.x),r=Math.max(r,o.y);return{minX:s,minY:i,maxX:e,maxY:r}}center(){return new S(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(t,e,r,s){return new T6(this.left-t,this.up-r,this.width+t+e,this.height+r+s)}containingAtLeast(t){const e=Math.min(this.left,t.left),r=Math.max(this.right(),t.right()),s=Math.min(this.up,t.up),i=Math.max(this.bottom(),t.bottom());return T6.fromLimits(e,r,s,i)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}let ts=(()=>{class n{}return n.CANNOT_DROP_PIECE_YOU_DONT_HAVE=()=>"You cannot drop a piece that you do not have in your reserve.",n.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The queen bee can only move to one of its direct neighbors.`,n.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The beetle can only move to one of its direct neighbors.`,n.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`The grasshopper must move in a straight line.`,n.GRASSHOPPER_MUST_JUMP_OVER_PIECES=()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`,n.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES=()=>$localize`The spider must move on neighboring spaces.`,n.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT=()=>$localize`The spider can only move around pieces that are in direct contact with it.`,n.SPIDER_CANNOT_BACKTRACK=()=>$localize`The spider cannot go twice through the same space in the same move.`,n.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE=()=>$localize`The queen bee must be placed on the board before moving a piece.`,n.THIS_PIECE_CANNOT_CLIMB=()=>$localize`Only the beetle is allowed to climb over other pieces.`,n.CANNOT_DISCONNECT_HIVE=()=>$localize`You are not allowed to split the hive.`,n.MUST_BE_ABLE_TO_SLIDE=()=>$localize`This piece must be able to slide to its destination.`,n.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN=()=>$localize`You must place your queen bee at this turn!`,n.CANNOT_DROP_NEXT_TO_OPPONENT=()=>$localize`You cannot drop a piece next to one of your opponent's stack.`,n.MUST_DROP_ON_EMPTY_SPACE=()=>$localize`You must always drop your piece on an empty space.`,n.MUST_BE_CONNECTED_TO_HIVE=()=>$localize`The piece you are dropping must be connected to the hive.`,n})();const F6t=Ye.fromFunctions(n=>n,n=>n);class Js{constructor(t,e){this.owner=t,this.kind=e}toString(){return`${this.kind}_${this.owner.toString()}`}equals(t){return this.owner===t.owner&&this.kind===t.kind}}Js.encoder=Ye.tuple([B.encoder,F6t],n=>[n.owner,n.kind],n=>new Js(n[0],n[1]));class Z4{constructor(t){this.pieces=t}equals(t){return this.size()===t.size()&&Je.compareArray(this.pieces,t.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(t){return new Z4([t,...this.pieces])}topPiece(){return ge.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const t=[...this.pieces];return t.shift(),new Z4(t)}size(){return this.pieces.length}}Z4.EMPTY=new Z4([]);class Kc extends ms{constructor(t,e,r){super(e,r),this.piece=t}static of(t,e){return new Kc(t,e.x,e.y)}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(t){return t instanceof Kc&&this.piece.equals(t.piece)&&this.coord.equals(t.coord)}}Kc.encoder=Ye.tuple([Js.encoder,S.encoder],n=>[n.piece,n.coord],n=>new Kc(n[0],n[1].x,n[1].y));class uo extends Hc{constructor(t,e){super(t,e)}static from(t,e){return t.equals(e)?ve.failure(Xe.MOVE_CANNOT_BE_STATIC()):ve.success(new uo(t,e))}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(t instanceof U3)&&t instanceof uo&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}uo.encoder=Pa.getFallibleEncoder(uo.from);class U3 extends uo{constructor(t){super(t[0],t[3]),this.coords=t}static ofCoords(t){return new U3(t)}toString(){return`HiveMoveSpider(${this.coords.map(e=>e.toString()).join(", ")})`}equals(t){return t instanceof U3&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}U3.encoder=Ye.tuple([S.encoder,S.encoder,S.encoder,S.encoder],n=>n.coords,n=>new U3(n));class U5 extends oo{toString(){return"HiveMovePass"}equals(t){return t instanceof U5}}function B6t(n){return n instanceof Kc}function $6t(n){return n instanceof U3}function U6t(n){return n instanceof uo}function G6t(n){return n instanceof U5}var Pi;U5.encoder=Ye.constant("HiveMovePass",new U5),function(n){n.PASS=new U5,n.drop=function t(s,i){return Kc.of(s,i)},n.move=function e(s,i){return uo.from(s,i)},n.spiderMove=function r(s){return U3.ofCoords(s)},n.encoder=Ye.disjunction([B6t,$6t,U6t,G6t],[Kc.encoder,U3.encoder,uo.encoder,U5.encoder])}(Pi||(Pi={}));class Xc{static of(t){return Xc.INSTANCES.isAbsent()&&(Xc.INSTANCES=y.of({QueenBee:VP.get(),Beetle:HP.get(),Grasshopper:FP.get(),Spider:l_.get(),SoldierAnt:BP.get()})),Xc.INSTANCES.get()[t.kind]}checkEmptyDestination(t,e){return e.getAt(t.getEnd()).hasPieces()?R.failure(ts.THIS_PIECE_CANNOT_CLIMB()):R.SUCCESS}canSlideBetweenNeighbors(t,e,r){const s=new bt(Ei.getNeighbors(e)),i=new bt(Ei.getNeighbors(r)),o=s.intersection(i);for(const c of o)if(t.getAt(c).isEmpty())return!0;return!1}}Xc.INSTANCES=y.empty();class VP extends Xc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new VP)),this.INSTANCE.get()}moveValidity(t,e){return!1===Ei.areNeighbors(t.getStart(),t.getEnd())?R.failure(ts.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(e,t.getStart(),t.getEnd())?R.failure(ts.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of Ei.getNeighbors(t))e.getAt(s).isEmpty()&&r.push(uo.from(t,s).get());return r}}VP.INSTANCE=y.empty();class HP extends Xc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new HP)),this.INSTANCE.get()}moveValidity(t,e){return!1===Ei.areNeighbors(t.getStart(),t.getEnd())?R.failure(ts.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):R.SUCCESS}getPotentialMoves(t,e){const r=[];for(const s of Ei.getNeighbors(t))r.push(uo.from(t,s).get());return r}}HP.INSTANCE=y.empty();class FP extends Xc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new FP)),this.INSTANCE.get()}moveValidity(t,e){if(De.factory.fromMove(t.getStart(),t.getEnd()).isFailure())return R.failure(ts.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const s=t.getStart().getCoordsToward(t.getEnd());if(0===s.length)return R.failure(ts.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const i of s)if(e.getAt(i).isEmpty())return R.failure(ts.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of De.factory.all){const i=t.getNext(s);if(e.getAt(i).hasPieces()){let o=i;for(;e.getAt(o).hasPieces();)o=o.getNext(s);r.push(uo.from(t,o).get())}}return r}}FP.INSTANCE=y.empty();class l_ extends Xc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new l_)),this.INSTANCE.get()}prefixLegality(t,e){const r=new bt,s=e.update().setAt(t[0],Z4.EMPTY).increaseTurnAndFinalizeUpdate();for(let i=1;i<t.length;i++){if(s.getAt(t[i]).hasPieces())return R.failure(ts.THIS_PIECE_CANNOT_CLIMB());if(!1===Ei.areNeighbors(t[i-1],t[i]))return R.failure(ts.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===s.haveCommonNeighbor(t[i],t[i-1]))return R.failure(ts.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(s,t[i-1],t[i]))return R.failure(ts.MUST_BE_ABLE_TO_SLIDE());if(r.contains(t[i]))return R.failure(ts.SPIDER_CANNOT_BACKTRACK());r.add(t[i])}return R.SUCCESS}moveValidity(t,e){ge.assert(t instanceof U3,"HiveSpiderRules: move should be a spider move");const s=this.prefixLegality(t.coords,e);return s.isFailure()?s:this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=e.update().setAt(t,Z4.EMPTY).increaseTurnAndFinalizeUpdate();let s=[[t]];for(let c=0;c<3;c++)s=s.flatMap(u=>this.nextMoveStep(r,u));return new bt(s.map(function i(c){return U3.ofCoords(c)})).toList()}nextMoveStep(t,e){const r=e[e.length-1];return new bt(Ei.getNeighbors(r)).filter(function s(o){return!t.getAt(o).hasPieces()&&void 0===e.find(c=>o.equals(c))&&t.haveCommonNeighbor(o,r)}).toList().map(o=>[...e,o])}}l_.INSTANCE=y.empty();class BP extends Xc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new BP)),this.INSTANCE.get()}pathExists(t,e,r){const s=new bt,i=[e];for(;i.length>0;){const o=i.pop();if(!s.contains(o)){if(s.add(o),o.equals(r))return!0;for(const c of Ei.getNeighbors(o)){const u=t.getAt(c).isEmpty(),h=t.getOccupiedNeighbors(c).size()>0,g=this.canSlideBetweenNeighbors(t,o,c);u&&h&&g&&i.push(c)}}}return!1}moveValidity(t,e){return!1===this.pathExists(e,t.getStart(),t.getEnd())?R.failure(ts.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=new bt;for(const s of e.occupiedSpaces())if(!s.equals(t))for(const i of e.emptyNeighbors(s))r.add(uo.from(t,i).get());return r.toList()}}BP.INSTANCE=y.empty();class b3e extends OP{constructor(t,e){super(e),this.pieces=t;const r=this.computeScale();this.width=r.width,this.height=r.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const i of this.pieces.listKeys())t=Math.min(i.x,t),e=Math.max(i.x,e),r=Math.min(i.y,r),s=Math.max(i.y,s);return{width:e+1-t,height:s+1-r}}isOnBoard(t){return this.pieces.containsKey(t)}getOccupiedNeighbors(t){return new bt(Ei.getNeighbors(t)).filter(r=>this.pieces.get(r).isPresent())}getGroups(){const t=new bt,e=new bt;return this.pieces.forEach(r=>{if(!1===t.contains(r.key)){const s=new bt,i=new bt([r.key]);for(;i.hasElements();){const o=i.getAnyElement().get();i.remove(o),t.add(o),s.add(o),i.addAll(this.getOccupiedNeighbors(o).filter(c=>!1===t.contains(c)))}e.add(s)}}),e}}class $P{constructor(t){this.pieces=t}static getInitial(){const t=new jn;for(const e of B.PLAYERS)t.set(new Js(e,"QueenBee"),1),t.set(new Js(e,"Beetle"),2),t.set(new Js(e,"Spider"),2),t.set(new Js(e,"Grasshopper"),3),t.set(new Js(e,"SoldierAnt"),3);return t.makeImmutable(),new $P(t)}equals(t){return this.pieces.equals(t.pieces)}getQuantity(t){return this.pieces.get(t).get()}hasRemaining(t){return this.getQuantity(t)>0}getAny(t){for(const e of this.pieces.listKeys())if(e.owner===t&&this.hasRemaining(e))return y.of(e);return y.empty()}remove(t){const e=this.pieces.get(t).get();ge.assert(e>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const r=this.pieces.getCopy();return r.replace(t,e-1),new $P(r)}toListOfStacks(){const t=[];return this.pieces.forEach(e=>{const r=[];for(let s=0;s<e.value;s++)r.push(e.key);t.push(new Z4(r))}),t}getPlayerPieces(t){const e=[];return this.pieces.forEach(r=>{r.key.owner===t&&r.value>0&&e.push(r.key)}),e}}class u_{constructor(t,e,r,s){this.pieces=t,this.remainingPieces=e,this.queenBees=r,this.turn=s}static of(t){return new u_(t.pieces,t.remainingPieces,t.queenBees,t.turn)}setAt(t,e){const r=this.queenBees.getCopy();for(const i of B.PLAYERS)r.get(i).equalsValue(t)&&r.delete(i);for(const i of e.pieces)"QueenBee"===i.kind&&r.put(i.owner,t);const s=this.pieces.getCopy();return e.isEmpty()?s.delete(t):s.put(t,e),new u_(s,this.remainingPieces,r,this.turn)}removeRemainingPiece(t){return new u_(this.pieces,this.remainingPieces.remove(t),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new V2(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class V2 extends b3e{constructor(t,e,r,s){super(t,s),this.remainingPieces=e,this.queenBees=r,this.queenBees=r.getCopy();for(const i of r.listKeys()){const o=r.get(i).get();this.queenBees.replace(i,o)}this.queenBees.makeImmutable()}static getInitialState(){return V2.fromRepresentation([],0)}static fromRepresentation(t,e,r=new $t(0,0)){const s=new Jm;let i=$P.getInitial();const o=new jn;for(let c=0;c<t.length;c++)for(let u=0;u<t[0].length;u++)if(t[c][u].length>0){const h=new S(u,c).getNext(r,1);s.set(h,new Z4(t[c][u]));const g=y.ofNullable(t[c][u].find(m=>"QueenBee"===m.kind));g.isPresent()&&o.set(g.get().owner,h);for(const m of t[c][u])i=i.remove(m)}return new V2(s,i,o,e)}update(){return u_.of(this)}equals(t){return this.pieces.equals(t.pieces)&&this.remainingPieces.equals(t.remainingPieces)&&this.queenBees.equals(t.queenBees)&&this.turn===t.turn}getAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():Z4.EMPTY}queenBeeLocation(t){return this.queenBees.get(t)}hasQueenBeeOnBoard(t){return this.queenBeeLocation(t).isPresent()}numberOfNeighbors(t){let e=0;for(const r of Ei.getNeighbors(t))this.getAt(r).hasPieces()&&(e+=1);return e}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(t){const e=[];for(const r of Ei.getNeighbors(t))this.getAt(r).isEmpty()&&e.push(r);return e}haveCommonNeighbor(t,e){const r=this.getOccupiedNeighbors(t),s=this.getOccupiedNeighbors(e);return r.findAnyCommonElement(s).isPresent()}}class e2 extends I1{constructor(){super(V2)}static get(){return e2.singleton.isAbsent()&&(e2.singleton=y.of(new e2)),e2.singleton.get()}applyLegalMove(t,e,r){return t instanceof Kc?this.applyLegalDrop(t,e):t instanceof uo?this.applyLegalMoveCoordToCoord(t,e):e.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(t,e){const r=e.getAt(t.coord);return e.update().setAt(t.coord,r.add(t.piece)).removeRemainingPiece(t.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(t,e){const r=e.getAt(t.getStart()),s=e.getAt(t.getEnd());return e.update().setAt(t.getStart(),r.removeTopPiece()).setAt(t.getEnd(),s.add(r.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(t,e){return t instanceof Kc?this.isLegalDrop(t,e):t instanceof uo?this.isLegalMoveCoordToCoord(t,e):this.shouldPass(e)?R.SUCCESS:R.failure(Xe.CANNOT_PASS())}isLegalMoveCoordToCoord(t,e){if(!1===e.queenBeeLocation(e.getCurrentPlayer()).isPresent())return R.failure(ts.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const r=e.getAt(t.getStart());if(r.isEmpty())return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());const s=r.topPiece();if(s.owner===e.getCurrentOpponent())return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());const i=Xc.of(s).moveValidity(t,e);if(i.isFailure())return i;const o=e.update().setAt(t.getStart(),r.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(o.isDisconnected())return R.failure(ts.CANNOT_DISCONNECT_HIVE());const c=t.getEnd();return 0===o.numberOfNeighbors(c)?R.failure(ts.CANNOT_DISCONNECT_HIVE()):R.SUCCESS}mustPlaceQueenBee(t){return t.turn>=6&&!1===t.hasQueenBeeOnBoard(t.getCurrentPlayer())}isLegalDrop(t,e){const r=e.getCurrentPlayer();if(t.piece.owner===r.getOpponent())return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.remainingPieces.hasRemaining(t.piece))return R.failure(ts.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==t.piece.kind&&this.mustPlaceQueenBee(e))return R.failure(ts.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const s=this.checkNeighborValidity(t,e);return s.isFailure()?s:e.getAt(t.coord).hasPieces()?R.failure(ts.MUST_DROP_ON_EMPTY_SPACE()):R.SUCCESS}checkNeighborValidity(t,e){const r=e.getCurrentPlayer();let s=!1;for(const i of Ei.getNeighbors(t.coord)){const o=e.getAt(i);if(o.hasPieces()&&(s=!0,1!==e.turn&&o.topPiece().owner===r.getOpponent()))return R.failure(ts.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==e.turn&&!1===s?R.failure(ts.MUST_BE_CONNECTED_TO_HIVE()):R.SUCCESS}getPossibleDropLocations(t){const e=t.getCurrentPlayer();if(0===t.turn)return new bt([new S(0,0)]);if(1===t.turn)return new bt(Ei.getNeighbors(new S(0,0)));const r=t.remainingPieces.getAny(e);if(r.isAbsent())return new bt;const s=r.get(),i=new bt;for(const o of t.occupiedSpaces())if(t.getAt(o).topPiece().owner===e)for(const c of t.emptyNeighbors(o)){const u=Kc.of(s,c);this.isLegalDrop(u,t).isSuccess()&&i.add(c)}return i}getPossibleMovesFrom(t,e){const r=t.getCurrentPlayer(),s=new bt,i=t.getAt(e).topPiece();if(i.owner===r)for(const o of Xc.of(i).getPotentialMoves(e,t))this.isLegalMoveCoordToCoord(o,t).isSuccess()&&s.add(o);return s}getPossibleMovesOnBoard(t){const e=new bt;for(const r of t.occupiedSpaces())e.addAll(this.getPossibleMovesFrom(t,r));return e}shouldPass(t){return 0===this.getPossibleDropLocations(t).size()&&0===this.getPossibleMovesOnBoard(t).size()}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of B.PLAYERS){const i=e.queenBeeLocation(s);i.isPresent()&&(r[s.value]=e.numberOfNeighbors(i.get()))}return 6===r[0]&&6===r[1]?Ie.DRAW:6===r[0]?Ie.getVictory(B.ONE):6===r[1]?Ie.getVictory(B.ZERO):Ie.ONGOING}}e2.singleton=y.empty();class q6t extends ks{getListMoves(t){const e=this.getListDrops(t.gameState),r=this.getListOfOnBoardMoves(t.gameState),s=e.concat(r);return 0===s.length?[Pi.PASS]:s}getListOfOnBoardMoves(t){return e2.get().getPossibleMovesOnBoard(t).toList()}getListDrops(t){const e=[],r=t.getCurrentPlayer(),s=new Js(r,"QueenBee");for(const i of e2.get().getPossibleDropLocations(t))if(e2.get().mustPlaceQueenBee(t))e.push(Pi.drop(s,i));else for(const o of t.remainingPieces.getPlayerPieces(t.getCurrentPlayer()))e.push(Pi.drop(o,i));return e}getMetrics(t){return[this.queenBeeMobility(t.gameState,B.ZERO),this.queenBeeMobility(t.gameState,B.ONE)]}queenBeeMobility(t,e){const r=t.queenBeeLocation(e);return r.isPresent()?e2.get().getPossibleMovesFrom(t,r.get()).size():0}}const Y4=new Js(B.ZERO,"QueenBee"),G5=new Js(B.ZERO,"Beetle"),Xh=new Js(B.ZERO,"Grasshopper"),UP=new Js(B.ZERO,"Spider"),GP=new Js(B.ZERO,"SoldierAnt"),q5=new Js(B.ONE,"QueenBee"),uc=new Js(B.ONE,"Beetle"),XH=new Js(B.ONE,"Grasshopper"),QH=new Js(B.ONE,"Spider"),f_=new Js(B.ONE,"SoldierAnt");class A3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,V2.fromRepresentation([[[q5],[uc],[QH],[Xh]],[[Xh],[],[GP],[]],[[GP],[],[],[]]],8)),te.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,V2.fromRepresentation([[[],[uc],[UP]],[[f_],[q5],[Y4]],[[Xh],[G5],[]]],7)),te.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,V2.getInitialState(),Pi.drop(G5,new S(0,0)),$localize`Congratulations!`),te.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,V2.fromRepresentation([[[uc],[Xh]]],2),Pi.drop(Y4,new S(2,0)),$localize`Congratulations!`),te.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,V2.fromRepresentation([[[],[UP],[XH],[q5],[uc]],[[uc],[Y4],[G5],[],[]]],4),[Pi.move(new S(1,1),new S(0,2)).get(),Pi.move(new S(1,1),new S(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),te.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,V2.fromRepresentation([[[Y4],[q5],[G5]],[[uc],[],[]]],6),[Pi.move(new S(2,0),new S(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),te.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,V2.fromRepresentation([[[uc,Y4],[q5],[G5]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),te.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,V2.fromRepresentation([[[Xh],[Y4],[uc],[f_]],[[XH],[],[],[]]],6),[Pi.move(new S(0,0),new S(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),te.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,V2.fromRepresentation([[[],[GP],[q5]],[[],[Y4],[uc]],[[f_],[QH],[]]],6),Pi.move(new S(1,0),new S(3,1)).get(),(t,e,r)=>t.equals(Pi.move(new S(1,0),new S(0,1)).get())?R.failure($localize`You have not freed your queen, try again!`):R.SUCCESS,$localize`Congratulations!`),te.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,V2.fromRepresentation([[[],[UP],[QH],[uc]],[[],[],[],[G5]],[[uc],[],[],[f_]],[[GP],[],[Xh],[]],[[Y4],[XH],[],[]]],6),Pi.spiderMove([new S(1,0),new S(1,1),new S(2,1),new S(2,2)]),$localize`Congratulations!`),te.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,V2.fromRepresentation([[[],[UP],[]],[[],[Y4],[uc]],[[f_],[],[]]],6)),te.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,V2.fromRepresentation([[[uc,G5],[Y4],[q5]]],4))]}}const W6t=["app-hive-piece",""];function j6t(n,t){1&n&&(H(),X(0,"path",9))}function Z6t(n,t){1&n&&(H(),X(0,"path",10))}function Y6t(n,t){1&n&&(H(),X(0,"path",11))}function K6t(n,t){1&n&&(H(),X(0,"path",12))}function X6t(n,t){1&n&&(H(),X(0,"path",13))}let Q6t=(()=>{class n extends n3e{constructor(){super(...arguments),this.hexaPoints="",this.pieceClass="",this.isoPointsLight="",this.isoPointsDark="",this.isoPointsStroke="",this.layerTransform="",this.hexaCenter=new S(0,0)}ngAfterContentChecked(){const e=new S(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(e),this.hexaCenter=this.hexaLayout.getCenterAt(e);const s=this.hexaLayout.getIsoPoints(e,this.pieceHeight).map(i=>i.map(o=>o.toSVGPoint()).join(" "));this.isoPointsLight=s[0],this.isoPointsDark=s[1],this.isoPointsStroke=s[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[l],attrs:W6t,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(e,r){1&e&&(H(),b(0,"g"),X(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),b(5,"g"),x(6,j6t,1,0,"path",4),x(7,Z6t,1,0,"path",5),x(8,Y6t,1,0,"path",6),x(9,K6t,1,0,"path",7),x(10,X6t,1,0,"path",8),A()()),2&e&&(z("transform",r.layerTransform),T(1),w("ngClass",r.pieceClass),z("points",r.isoPointsLight),T(1),w("ngClass",r.pieceClass),z("points",r.isoPointsDark),T(1),z("points",r.isoPointsStroke),T(1),w("ngClass",r.pieceClass),z("points",r.hexaPoints),T(1),z("transform","translate("+r.hexaCenter.x+" "+r.hexaCenter.y+")"),T(1),w("ngIf","QueenBee"===r.piece.kind),T(1),w("ngIf","Beetle"===r.piece.kind),T(1),w("ngIf","Grasshopper"===r.piece.kind),T(1),w("ngIf","Spider"===r.piece.kind),T(1),w("ngIf","SoldierAnt"===r.piece.kind))},dependencies:[hn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();function J6t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"polygon",4),ee("click",function(){const i=de(e).$implicit;return le(C().selectSpace(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),Le("id","space_",e.x,"_",e.y,""),w("ngClass",e.content.spaceClasses),z("points",r.getHexaPointsAtXY(e.x,e.y))}}function e0t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",6),ee("click",function(){de(e);const s=C().$implicit;return le(C().selectSpace(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C();Le("id","stroke_",e.x,"_",e.y,""),w("ngClass",e.content.strokeClasses),z("points",r.getHexaPointsAtXY(e.x,e.y))}}function t0t(n,t){if(1&n&&(H(),b(0,"g"),x(1,e0t,1,4,"polygon",5),A()),2&n){const e=t.$implicit;T(1),w("ngIf",e.content.strokeClasses.length>0)}}function n0t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",8),ee("click",function(){de(e);const s=C().$implicit;return le(C().selectSpace(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C();Le("id","stroke_",e.x,"_",e.y,""),z("points",r.getHexaPointsAtXY(e.x,e.y))}}function r0t(n,t){if(1&n&&(H(),b(0,"g"),x(1,n0t,1,3,"polygon",7),A()),2&n){const e=t.$implicit;T(1),w("ngIf",e.content.selected)}}function s0t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"g",9),ee("click",function(){const i=de(e).$implicit;return le(C(2).selectStack(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C().index,s=C();T(1),Le("id","piece_",e.x,"_",e.y,""),w("piece",e.content.piece)("x",e.x)("y",e.y)("pieceHeight",s.PIECE_HEIGHT)("hexaLayout",s.hexaLayout)("layer",r)}}function i0t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",6),ee("click",function(){de(e);const s=C().$implicit;return le(C(2).selectStack(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C().index,s=C();Le("id","stroke_",e.x,"_",e.y,""),w("ngClass",e.content.strokeClasses),z("transform","translate(0 "+-(r+1)*s.PIECE_HEIGHT+")")("points",s.getHexaPointsAtXY(e.x,e.y))}}function o0t(n,t){if(1&n&&(H(),b(0,"g"),x(1,i0t,1,5,"polygon",5),A()),2&n){const e=t.$implicit;T(1),w("ngIf",e.content.strokeClasses.length>0)}}function a0t(n,t){if(1&n&&(H(),b(0,"g"),x(1,s0t,2,8,"g",1),x(2,o0t,2,1,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e),T(1),w("ngForOf",e)}}function c0t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"g",10),ee("click",function(){const i=de(e).$implicit;return le(C(2).selectRemaining(i))}),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C(2);T(1),p1("id","remainingPiece_",e.toString(),""),w("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("layer",r)("hexaLayout",s.hexaLayout),z("transform",s.getRemainingPieceTransform(e))}}function l0t(n,t){if(1&n&&(H(),b(0,"g"),x(1,c0t,2,8,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e.pieces)}}function u0t(n,t){if(1&n&&(H(),X(0,"polygon",11)),2&n){const e=C();z("transform",e.getRemainingPieceHighlightTransform(e.selectedRemaining.get()))("points",e.getHexaPointsAt(e.ORIGIN))}}function f0t(n,t){if(1&n&&(H(),X(0,"g",13)),2&n){const e=t.$implicit,r=t.index,s=C(2);p1("id","inspectedStack_",r,""),w("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",s.hexaLayout)("layer",6*r),z("transform",s.inspectedStackTransform)}}function h0t(n,t){if(1&n&&(H(),b(0,"g"),x(1,f0t,1,8,"g",12),A()),2&n){const e=C();T(1),w("ngForOf",e.inspectedStack.get().pieces.slice().reverse())}}class N3e extends e3e{constructor(){super(...arguments),this.highlighted=[]}initialize(t){this.set(t,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(t,e){this.highlighted.push(t),this.get(t).map(r=>r.spaceClasses.push(e))}highlightStroke(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}select(t){this.highlighted.push(t),this.get(t).map(e=>e.selected=!0)}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[],e.spaceClasses=[],e.selected=!1});this.highlighted=[]}}class d0t extends e3e{constructor(){super(...arguments),this.highlighted=[]}initialize(t,e){this.set(t,{piece:e,strokeClasses:[]})}highlight(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[]});this.highlighted=[]}}let p0t=(()=>{class n extends Uh{constructor(e){super(e),this.ORIGIN=new S(0,0),this.remainingStacks=[],this.layers=[],this.ground=new N3e,this.inspectedStack=y.empty(),this.inspectedStackCoord=y.empty(),this.selectedRemaining=y.empty(),this.selectedStart=y.empty(),this.selectedSpiderCoords=[],this.rules=e2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new q6t(this.rules,"HiveMinimax")],this.encoder=Pi.encoder,this.tutorial=(new A3e).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new Gh(1.5*this.SPACE_SIZE,new S(2*this.SPACE_SIZE,0),xs.INSTANCE),this.canPass=!1,this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.layers=[];for(const r of this.getState().occupiedSpaces()){const s=this.getState().getAt(r),i=r.x,o=r.y;for(let c=0;c<s.size();c++){c in this.layers||(this.layers[c]=new d0t);const u=s.pieces[s.size()-1-c];this.layers[c].initialize(new S(i,o),u)}}this.ground=this.getGround(),this.computeViewBox(),this.remainingStacks=this.getState().remainingPieces.toListOfStacks(),this.canPass=e2.get().shouldPass(this.getState());const e=e2.get().getGameStatus(this.node);switch(e){case Ie.ONGOING:break;case Ie.DRAW:this.highlight(this.getState().queenBeeLocation(B.ZERO).get(),"victory-stroke"),this.highlight(this.getState().queenBeeLocation(B.ONE).get(),"victory-stroke");break;default:const s=e.winner.getOpponent();this.highlight(this.getState().queenBeeLocation(s).get(),"victory-stroke")}}highlight(e,r){const s=this.getState().getAt(e).size();s-1 in this.layers&&this.layers[s-1].highlight(e,r)}pass(){var e=this;return I(function*(){return ge.assert(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Pi.PASS)})()}computeViewBox(){const e=this.getPieceCoords().union(this.getAllNeighbors()).toList();e.push(new S(0,0)),this.boardViewBox=T6.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH);const r=new T6(this.getRemainingPieceTransformAsCoord(new Js(B.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),s=5*this.SPACE_SIZE;let i=0;this.getState().remainingPieces.getAny(B.ZERO).isPresent()&&(i=s);let o=0;this.getState().remainingPieces.getAny(B.ONE).isPresent()&&(o=s);const c=this.boardViewBox.containingAtLeast(r).expand(0,0,i,o);if(this.inspectedStack.isPresent()){const u=new S(c.right()+this.SPACE_SIZE,c.center().y),h=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${u.x} ${u.y+3*(h-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const e=new N3e;for(const r of this.getAllNeighbors())e.initialize(r);return e}getAllNeighbors(){const e=new bt;for(const r of this.getPieceCoords())e.addAll(new bt(this.getState().emptyNeighbors(r)));return e.isEmpty()&&e.add(new S(0,0)),e}clearHighlights(){for(const e of this.layers)e.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=y.empty(),this.selectedRemaining=y.empty(),this.selectedSpiderCoords=[],this.inspectedStack=y.empty(),this.computeViewBox()}showLastMove(e){for(const r of this.getLastMoveCoords(e))this.highlight(r,"last-move-stroke"),this.ground.highlightStroke(r,"last-move-stroke"),this.ground.highlightFill(r,"moved-fill")}getLastMoveCoords(e){let r=[];return e instanceof Kc?r=[e.coord]:e instanceof uo&&(r=[e.getStart(),e.getEnd()]),r}getRemainingPieceTransformAsCoord(e){const r=this.getRemainingPieceShift(e),s=this.boardViewBox.center().x+r*this.SPACE_SIZE*4;let i;return i=e.owner===this.role?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new S(s,i)}getRemainingPieceTransform(e){const r=this.getRemainingPieceTransformAsCoord(e);return`translate(${r.x} ${r.y})`}getRemainingPieceHighlightTransform(e){const r=this.getRemainingPieceTransformAsCoord(e),s=this.getState().remainingPieces.getQuantity(e);return`translate(${r.x} ${r.y-this.PIECE_HEIGHT*s})`}getRemainingPieceShift(e){switch(e.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return ge.expectToBe(e.kind,"SoldierAnt"),1.5}}selectRemaining(e){var r=this;return I(function*(){const s=r.canUserPlay(`#remainingPiece_${e.toString()}`);if(s.isFailure())return r.cancelMove(s.getReason());if(e.owner===r.getCurrentPlayer().getOpponent())return r.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE());if("QueenBee"!==e.kind&&e2.get().mustPlaceQueenBee(r.getState()))return r.cancelMove(ts.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(r.selectedRemaining.equalsValue(e))r.cancelMoveAttempt();else{r.cancelMoveAttempt(),r.selectedRemaining=y.of(e),r.clearHighlights();const i=e2.get().getPossibleDropLocations(r.getState()).toList();for(const o of i)r.ground.highlightStroke(o,"clickable-stroke")}return R.SUCCESS})()}selectStack(e,r){return this.select(new S(e,r),"piece")}selectSpace(e,r){return this.select(new S(e,r),"space")}select(e,r){var s=this;return I(function*(){const i=s.canUserPlay(`#${r}_${e.x}_${e.y}`);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState(),c=o.getAt(e);if(s.selectedRemaining.isPresent()){const u=Pi.drop(s.selectedRemaining.get(),e);return s.chooseMove(u)}if(s.selectedStart.isPresent()){const u=o.getAt(s.selectedStart.get()).topPiece();return s.selectedStart.equalsValue(e)?s.cancelMove():s.selectTarget(e,u)}return 0===c.size()?s.cancelMove():s.selectStart(e,c)})()}selectTarget(e,r){var s=this;return I(function*(){if("Spider"===r.kind)return s.selectNextSpiderSpace(e);{const i=Pi.move(s.selectedStart.get(),e);return We(i.isSuccess(),"Hive: the only forbidden moves are static moves"),s.chooseMove(i.get())}})()}selectStart(e,r){var s=this;return I(function*(){const i=s.getState(),o=r.topPiece();return o.owner===i.getCurrentPlayer().getOpponent()?1===r.size()?s.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE()):s.inspectedStack.isPresent()?(s.cancelMoveAttempt(),s.clearHighlights(),R.SUCCESS):(s.highlight(e,"selected-stroke"),s.inspectedStack=y.of(r),s.inspectedStackCoord=y.of(e),s.computeViewBox(),R.SUCCESS):(s.cancelMoveAttempt(),s.clearHighlights(),"QueenBee"!==o.kind&&e2.get().mustPlaceQueenBee(i)?s.cancelMove(ts.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(s.selectedStart=y.of(e),s.highlight(e,"selected-stroke"),"Spider"===o.kind&&s.selectedSpiderCoords.push(s.selectedStart.get()),r.size()>1&&(s.inspectedStack=y.of(r),s.inspectedStackCoord=y.of(e),s.computeViewBox()),s.highlightNextPossibleCoords(e),R.SUCCESS))})()}highlightNextPossibleCoords(e){for(const r of this.getNextPossibleCoords(e))this.highlight(r,"clickable-stroke"),this.ground.highlightStroke(r,"clickable-stroke")}getNextPossibleCoords(e){const r=this.getState(),s=r.getAt(e).topPiece(),i=e2.get().getPossibleMovesFrom(r,e);return"Spider"===s.kind?i.filter(c=>Je.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():i.map(o=>o.getEnd()).toList()}selectNextSpiderSpace(e){var r=this;return I(function*(){if(r.selectedSpiderCoords.push(e),4===r.selectedSpiderCoords.length){const i=Pi.spiderMove(r.selectedSpiderCoords);return r.chooseMove(i)}const s=l_.get().prefixLegality(r.selectedSpiderCoords,r.getState());if(s.isFailure())return r.cancelMove(s.getReason());r.clearHighlights(),r.highlight(r.selectedStart.get(),"selected-stroke");for(const i of r.selectedSpiderCoords)r.ground.select(i);return r.highlightNextPossibleCoords(r.selectedStart.get()),R.SUCCESS})()}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-hive"]],features:[l],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,J6t,2,4,"g",1),x(2,t0t,2,1,"g",1),x(3,r0t,2,1,"g",1),x(4,a0t,3,2,"g",1),x(5,l0t,2,1,"g",1),x(6,u0t,1,2,"polygon",2),x(7,h0t,2,1,"g",3),A()),2&e&&(z("viewBox",r.viewBox),T(1),w("ngForOf",r.ground),T(1),w("ngForOf",r.ground),T(1),w("ngForOf",r.ground),T(1),w("ngForOf",r.layers),T(1),w("ngForOf",r.remainingStacks),T(1),w("ngIf",r.selectedRemaining.isPresent()),T(1),w("ngIf",r.inspectedStack.isPresent()))},dependencies:[hn,En,Kt,Q6t],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();const g0t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:B.ZERO};class K4 extends BH{static getInitialState(){const t=Tn.UNOCCUPIED,e=Tn.INVADERS,r=Tn.DEFENDERS;return new K4([[t,t,t,e,e,e,e,e,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,r,t,t,t,t,e],[e,t,t,t,r,r,r,t,t,t,e],[e,e,t,r,r,Tn.PLAYER_ONE_KING,r,r,t,e,e],[e,t,t,t,r,r,r,t,t,t,e],[e,t,t,t,t,r,t,t,t,t,e],[t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,e,e,e,e,e,t,t,t]],0)}of(t,e){return new K4(t,e)}}class jo extends FH{static of(t,e){return new jo(t,e)}static from(t,e){try{const r=new jo(t,e);return ve.success(r)}catch(r){return ve.failure(r.message)}}getMaximalDistance(){return 11}}jo.encoder=Pa.getFallibleEncoder(jo.from);class P8 extends $H{constructor(){super(K4,g0t,jo.from)}static get(){return P8.singleton.isAbsent()&&(P8.singleton=y.of(new P8)),P8.singleton.get()}}P8.singleton=y.empty();const V=Tn.UNOCCUPIED,Qt=Tn.INVADERS,ns=Tn.DEFENDERS,qP=Tn.PLAYER_ONE_KING;class I3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,K4.getInitialState()),te.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,K4.getInitialState(),jo.of(new S(5,1),new S(1,1)),$localize`Congratulations!`),te.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new K4([[V,V,V,V,Qt,Qt,Qt,Qt,V,V,V],[V,V,V,V,V,Qt,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[Qt,V,V,V,V,ns,V,V,V,V,Qt],[Qt,V,V,Qt,ns,ns,ns,V,V,V,Qt],[Qt,Qt,V,ns,ns,qP,ns,ns,V,Qt,Qt],[Qt,V,V,V,ns,ns,ns,V,V,V,Qt],[Qt,V,V,V,V,ns,V,V,V,V,Qt],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,Qt,V,V,V,V,V],[V,V,V,Qt,Qt,Qt,Qt,Qt,V,V,V]],1),[jo.of(new S(5,3),new S(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(jo.of(new S(3,0),new S(3,4))),te.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new K4([[V,V,V,Qt,Qt,Qt,Qt,Qt,V,V,V],[V,ns,V,V,V,Qt,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,ns,V,V,V,V,Qt],[Qt,V,V,V,V,ns,ns,V,V,V,Qt],[Qt,Qt,qP,V,ns,V,ns,ns,V,V,Qt],[V,V,Qt,V,V,ns,ns,V,V,V,Qt],[Qt,V,V,V,V,ns,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,Qt,V,V,V,V,V,V,V,V,V],[V,V,V,Qt,Qt,Qt,Qt,V,Qt,V,V]],12),[jo.of(new S(3,0),new S(3,5)),jo.of(new S(3,10),new S(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),te.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new K4([[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,Qt,V,V,V,V,V,V,V,V,V],[Qt,qP,V,Qt,V,V,V,V,V,V,V],[V,Qt,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V]],72),[jo.of(new S(3,4),new S(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),te.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new K4([[V,V,Qt,qP,Qt,V,V,V,V,V,V],[V,V,V,V,V,V,ns,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,Qt,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V]],72),[jo.of(new S(3,3),new S(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function m0t(n,t){1&n&&(H(),X(0,"polygon",8))}function _0t(n,t){1&n&&(H(),X(0,"rect",9))}function v0t(n,t){if(1&n&&(H(),b(0,"g"),x(1,m0t,1,0,"polygon",6),x(2,_0t,1,0,"ng-template",null,7,qn),A()),2&n){const e=Hn(3),r=C().index,s=C().index,i=C();T(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function C0t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=C(2).index,r=C().index,s=C();T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function y0t(n,t){if(1&n&&(H(),X(0,"polyline",16)),2&n){const e=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][e])}}function E0t(n,t){if(1&n&&(H(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function M0t(n,t){if(1&n&&(H(),x(0,y0t,1,1,"polyline",14),x(1,E0t,4,20,"ng-template",null,15,qn)),2&n){const e=Hn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",e)}}function S0t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"circle",10),x(2,C0t,6,25,"g",11),x(3,M0t,3,2,"ng-template",null,12,qn),A()),2&n){const e=Hn(4),r=C().index,s=C().index,i=C();T(1),Le("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),z("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),T(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function P0t(n,t){if(1&n){const e=Ae();H(),b(0,"g",3),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),X(1,"rect",4),x(2,v0t,4,2,"g",5),x(3,S0t,5,8,"g",5),A()}if(2&n){const e=t.index,r=C().index,s=C();Le("id","click_",e,"_",r,""),z("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),T(1),Le("id","space_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),T(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function T0t(n,t){if(1&n&&(H(),b(0,"g"),x(1,P0t,4,10,"g",2),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function w0t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",17),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),Le("id","click_",e.x,"_",e.y,""),z("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let O0t=(()=>{class n extends UH{constructor(e){super(e,!1,jo.from),this.rules=P8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new xP(this.rules,"DummyBot"),new LP(this.rules,"Piece > Influence"),new RP(this.rules,"Piece > Control"),new GH(this.rules,"Escape > Piece > Control")],this.encoder=jo.encoder,this.tutorial=(new I3e).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-hnefatafl"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,T0t,2,1,"g",1),x(2,w0t,2,6,"g",1),A()),2&e&&(z("viewBox",r.getViewBox()),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getClickables()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class On{constructor(t,e,r){this.value=t,this.name=e,this.rgb=r}static of(t){switch(t){case 0:return On.ANY;case 1:return On.ORANGE;case 2:return On.BLUE;case 3:return On.PURPLE;case 4:return On.PINK;case 5:return On.YELLOW;case 6:return On.RED;case 7:return On.GREEN;default:return ge.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),On.BROWN}}}On.ANY=new On(0,"any","#000"),On.ORANGE=new On(1,"orange","#d67421"),On.BLUE=new On(2,"blue","#006bac"),On.PURPLE=new On(3,"purple","#6f3787"),On.PINK=new On(4,"pink","#d2719e"),On.YELLOW=new On(5,"yellow","#e2c200"),On.RED=new On(6,"red","#d23339"),On.GREEN=new On(7,"green","#009157"),On.BROWN=new On(8,"brown","#562500");class $n{constructor(t,e){this.player=t,this.color=e}static of(t,e){return new $n(t,On.of(e))}static createPlayerColors(t){return{ORANGE:new $n(t,On.ORANGE),BLUE:new $n(t,On.BLUE),PURPLE:new $n(t,On.PURPLE),PINK:new $n(t,On.PINK),YELLOW:new $n(t,On.YELLOW),RED:new $n(t,On.RED),GREEN:new $n(t,On.GREEN),BROWN:new $n(t,On.BROWN)}}equals(t){return t.player===this.player&&t.color===this.color}isEmpty(){return this.player.equals(ue.NONE)}belongsTo(t){return this.player===t}}$n.EMPTY=new $n(ue.NONE,On.ANY),$n.ZERO=$n.createPlayerColors(B.ZERO),$n.ONE=$n.createPlayerColors(B.ONE);class Ti{static getColorAt(t,e){return Ti.COLORS[e][t]}static getInitialBoard(){const t=$n.EMPTY;return[[1,2,3,4,5,6,7,8].map(e=>$n.of(B.ONE,e)),[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[8,7,6,5,4,3,2,1].map(e=>$n.of(B.ZERO,e))]}static isEmptyAt(t,e){return t[e.y][e.x].equals($n.EMPTY)}static allPieceCoords(t){const e=[];for(let r=0;r<t.length;r++)for(let s=0;s<t[r].length;s++){const i=new S(s,r);Ti.isEmptyAt(t,i)||e.push(i)}return e}}Ti.INITIAL=Ti.getInitialBoard(),Ti.SIZE=8,Ti.COLORS=Je.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],On.of);class W5 extends oo{constructor(){super()}length(){return 0}equals(t){return this===t}toString(){return"KamisadoMove(PASS)"}}W5.PASS=new W5,W5.encoder=Ye.constant("PASS",W5.PASS);class j5 extends Hc{constructor(t,e){super(t,e)}static of(t,e){return ge.assert(t.isInRange(Ti.SIZE,Ti.SIZE),"Starting coord of KamisadoMove must be on the board, not at "+t.toString()),ge.assert(e.isInRange(Ti.SIZE,Ti.SIZE),"End coord of KamisadoMove must be on the board, not at "+e.toString()),new j5(t,e)}equals(t){return t===this||!!wi.isPiece(t)&&!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}function b0t(n){return n instanceof W5}var wi;j5.encoder=Pa.getEncoder(j5.of),function(n){n.PASS=W5.PASS,n.of=function t(r,s){return j5.of(r,s)},n.isPiece=function e(r){return r instanceof j5},n.encoder=Ye.disjunction([n.isPiece,b0t],[j5.encoder,W5.encoder])}(wi||(wi={}));class X4 extends xr{constructor(t,e,r,s,i){super(Je.copyBiArray(i),t),this.colorToPlay=e,this.coordToPlay=r,this.alreadyPassed=s}static getInitialState(){return new X4(0,On.ANY,y.empty(),!1,Ti.INITIAL)}}let h_=(()=>{class n{}return n.NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`,n.DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`,n.MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`,n.PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`,n})();class Oi extends I1{constructor(){super(X4)}static get(){return Oi.singleton.isAbsent()&&(Oi.singleton=y.of(new Oi)),Oi.singleton.get()}static getColorMatchingPiece(t){return t.coordToPlay.isPresent()?[t.coordToPlay.get()]:[new S(0,7),new S(1,7),new S(2,7),new S(3,7),new S(4,7),new S(5,7),new S(6,7),new S(7,7)]}static getMovablePieces(t){return Oi.getColorMatchingPiece(t).filter(e=>{for(const r of this.playerDirections(t.getCurrentPlayer())){const s=e.getNext(r);if(t.isOnBoard(s)&&Ti.isEmptyAt(t.board,s))return!0}return!1})}static playerDirections(t){return t===B.ONE?[be.DOWN,be.DOWN_LEFT,be.DOWN_RIGHT]:[be.UP,be.UP_LEFT,be.UP_RIGHT]}static directionAllowedForPlayer(t,e){return e===B.ZERO?t.y<0:t.y>0}static getListMovesFromState(t){const e=Oi.getMovablePieces(t);return 0===e.length?(We(!1===t.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[wi.PASS]):Oi.getListMovesFromNonBlockedState(t,e)}static getListMovesFromNonBlockedState(t,e){const r=[],s=t.getCurrentPlayer();for(const i of e)for(const o of Oi.playerDirections(s))for(let c=1;c<Ti.SIZE;c++){const u=i.getNext(o,c);if(!t.isOnBoard(u)||!Ti.isEmptyAt(t.board,u))break;{const h=wi.of(i,u);r.push(h)}}return r}static mustPass(t){return 0===this.getMovablePieces(t).length}static getFurthestPiecePositions(t){let e=7,r=0;return Ti.allPieceCoords(t.board).forEach(s=>{const i=t.getPieceAt(s);We(i!==$n.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===B.ONE?r=Math.max(r,s.y):e=Math.min(e,s.y)}),[e,r]}static isLegal(t,e){if(wi.isPiece(t)){const r=t.getStart(),s=t.getEnd(),i=e.colorToPlay,o=e.getPieceAt(r);if(!o.belongsTo(e.getCurrentPlayer()))return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());if(i!==On.ANY&&o.color!==i)return R.failure(h_.NOT_RIGHT_COLOR());if(!e.getPieceAt(s).isEmpty())return R.failure(Xe.MUST_CLICK_ON_EMPTY_SPACE());const u=be.factory.fromMove(r,s);if(u.isFailure())return R.failure(h_.DIRECTION_NOT_ALLOWED());const h=u.get();if(!Oi.directionAllowedForPlayer(h,e.getCurrentPlayer()))return R.failure(h_.DIRECTION_NOT_ALLOWED());let g=r;for(;!g.equals(s);)if(g=g.getNext(h),!e.getPieceAt(g).isEmpty())return R.failure(h_.MOVE_BLOCKED());return R.SUCCESS}return this.isLegalPass(e)}static isLegalPass(t){return this.mustPass(t)&&!t.alreadyPassed?R.SUCCESS:R.failure(Xe.CANNOT_PASS())}nextCoordToPlay(t,e){return y.ofNullable(Ti.allPieceCoords(t.board).find(r=>{const s=t.getPieceAt(r);return s.player===t.getCurrentOpponent()&&s.color===e}))}applyLegalMove(t,e,r){if(wi.isPiece(t)){const s=t.getStart(),i=t.getEnd(),o=e.getCopiedBoard();o[i.y][i.x]=o[s.y][s.x],o[s.y][s.x]=$n.EMPTY;const c=Ti.getColorAt(i.x,i.y),u=this.nextCoordToPlay(e,c);return new X4(e.turn+1,c,u,!1,o)}{const s=this.nextCoordToPlay(e,e.colorToPlay);return new X4(e.turn+1,e.colorToPlay,s,!0,e.board)}}isLegal(t,e){return Oi.isLegal(t,e)}getGameStatus(t){const e=t.gameState,r=e.getCurrentPlayer();if(Oi.mustPass(e)&&e.alreadyPassed)return Ie.getDefeat(r);const[s,i]=Oi.getFurthestPiecePositions(e);return 7===i?Ie.ONE_WON:0===s?Ie.ZERO_WON:Ie.ONGOING}}Oi.singleton=y.empty();class A0t extends ks{getListMoves(t){const e=Oi.getListMovesFromState(t.gameState);return Je.sortByDescending(e,r=>r.length()),e}getMetrics(t){const e=t.gameState,[r,s]=Oi.getFurthestPiecePositions(e);return[7-r,s]}}const ae=$n.EMPTY,WP=$n.ZERO.ORANGE,jP=$n.ONE.ORANGE,ZP=$n.ZERO.BLUE,YP=$n.ONE.BLUE,JH=$n.ZERO.PURPLE,d_=$n.ONE.PURPLE,KP=$n.ZERO.PINK,XP=$n.ONE.PINK,QP=$n.ZERO.YELLOW,JP=$n.ONE.YELLOW,eT=$n.ZERO.RED,tT=$n.ONE.RED,nT=$n.ZERO.GREEN,rT=$n.ONE.GREEN,sT=$n.ZERO.BROWN,iT=$n.ONE.BROWN;class x3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new X4(5,On.ORANGE,y.empty(),!1,[[sT,YP,d_,XP,JP,tT,rT,iT],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,jP,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,nT,eT,QP,KP,JH,ZP,WP]])).withPreviousMove(wi.of(new S(0,7),new S(0,0))),te.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,X4.getInitialState(),wi.of(new S(7,7),new S(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),te.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new X4(1,On.PINK,y.of(new S(3,0)),!1,[[jP,YP,d_,XP,JP,tT,rT,iT],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ZP,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[sT,nT,eT,QP,KP,JH,ae,WP]]),[wi.of(new S(3,0),new S(3,6)),wi.of(new S(3,0),new S(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(wi.of(new S(6,7),new S(6,5))),te.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new X4(1,On.PINK,y.of(new S(3,6)),!1,[[jP,YP,d_,ae,JP,tT,rT,iT],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ZP],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,XP,ae,ae,ae,ae],[sT,nT,eT,QP,KP,JH,ae,WP]])).withPreviousMove(wi.of(new S(6,5),new S(7,4))),te.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new X4(2,On.RED,y.of(new S(2,4)),!1,[[ae,YP,d_,ae,ae,tT,ae,ae],[ae,ae,ae,JP,ae,ae,ae,ae],[ae,ae,ae,XP,ae,d_,ae,ae],[ae,ae,ae,QP,ae,ae,ae,ae],[ae,ae,eT,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,rT,ae],[jP,ae,ae,ae,ae,KP,ae,iT],[sT,nT,ae,ae,ae,ae,ZP,WP]]),[wi.of(new S(2,4),new S(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(wi.of(new S(4,0),new S(3,1)))]}}function N0t(n,t){if(1&n&&(H(),X(0,"circle",8)),2&n){const e=C(),r=e.$implicit,s=e.index,i=C().index,o=C();w("ngClass",o.piecePlayerClass(r)),z("cx",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function I0t(n,t){if(1&n&&(H(),X(0,"rect",9)),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();z("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(s)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(s)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(s))}}function x0t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"g",4),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),X(2,"rect",5),x(3,N0t,1,4,"circle",6),x(4,I0t,1,7,"rect",7),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Le("id","click_",r,"_",s,""),T(1),z("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("fill",i.backgroundColor(r,s)),T(1),w("ngIf",e!==i.UNOCCUPIED),T(1),w("ngIf",e!==i.UNOCCUPIED)}}function k0t(n,t){if(1&n&&(H(),b(0,"g"),x(1,x0t,5,9,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function L0t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"rect",10)(2,"rect",10),A()),2&n){const e=C();T(1),Le("id","last_move_start_",e.lastPieceMove.get().getStart().x,"_",e.lastPieceMove.get().getStart().y,""),z("x",e.lastPieceMove.get().getStart().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getStart().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),T(1),Le("id","last_move_start_",e.lastPieceMove.get().getEnd().x,"_",e.lastPieceMove.get().getEnd().y,""),z("x",e.lastPieceMove.get().getEnd().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getEnd().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function R0t(n,t){if(1&n&&(H(),X(0,"circle",11)),2&n){const e=C();z("cx",e.SPACE_SIZE/2+e.chosen.get().x*e.SPACE_SIZE)("cy",e.SPACE_SIZE/2+e.chosen.get().y*e.SPACE_SIZE)("r",e.SPACE_SIZE/2-e.STROKE_WIDTH)}}let D0t=(()=>{class n extends ao{constructor(e){super(e),this.UNOCCUPIED=$n.EMPTY,this.lastMove=y.empty(),this.lastPieceMove=y.empty(),this.chosen=y.empty(),this.chosenAutomatically=!1,this.hasAsymmetricBoard=!0,this.rules=Oi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new A0t(this.rules,"KamisadoMinimax")],this.encoder=wi.encoder,this.tutorial=(new x3e).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(e,r){return Ti.getColorAt(e,r).rgb}isPlayerZero(e){return e.player===B.ZERO}pieceColor(e){return e.color.rgb}piecePlayerClass(e){return this.getPlayerClass(e.player)}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.lastPieceMove=y.empty(),this.canPass=Oi.mustPass(e);const r=this.rules.getGameStatus(this.node)!==Ie.ONGOING;this.canPass||e.coordToPlay.isAbsent()||r?(this.chosenAutomatically=!1,this.chosen=y.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}showLastMove(e){wi.isPiece(e)&&(this.lastPieceMove=y.of(e))}pass(){var e=this;return I(function*(){return We(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(wi.PASS)})()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);if(s.canPass)return s.cancelMove(Xe.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(e,r);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(o))return s.cancelMoveAttempt(),R.SUCCESS;{const c=s.getState().getPieceAtXY(e,r),u=s.getState().getCurrentPlayer();return c.belongsTo(u)?s.chosenAutomatically?s.cancelMove(h_.PLAY_WITH_SELECTED_PIECE()):(s.chosen=y.of(o),R.SUCCESS):yield s.chooseDestination(e,r)}})()}choosePiece(e,r){const s=this.getState().getPieceAtXY(e,r),i=this.getState().getCurrentOpponent();return s.belongsTo(i)?this.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=y.of(new S(e,r)),R.SUCCESS)}chooseDestination(e,r){var s=this;return I(function*(){const i=s.chosen.get(),o=new S(e,r),c=wi.of(i,o);return s.chooseMove(c)})()}cancelMoveAttempt(){this.chosenAutomatically||(this.chosen=y.empty())}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-kamisado"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,k0t,2,1,"g",1),x(2,L0t,3,12,"g",2),x(3,R0t,1,3,"circle",3),A()),2&e&&(z("viewBox",r.getViewBox())("transform",r.rotation),T(1),w("ngForOf",r.board),T(1),w("ngIf",r.lastPieceMove.isPresent()),T(1),w("ngIf",r.chosen.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),k3e=(()=>{class n extends ao{getParallelogramCoords(e){const r=e.parallelogramHeight,s=r*e.horizontalWidthRatio,i=r*e.offsetRatio,o=s,u=s-i,h=r,g=-i,m=r;return[new S(0,0),new S(o,0),new S(u,h),new S(g,m)]}getCoordTranslate(e,r,s,i){const o=i.parallelogramHeight;return new S(e*(o*i.horizontalWidthRatio)+i.offsetRatio*o*(i.abstractBoardSize-r),r*o-i.pieceHeightRatio*o*s)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Tr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),w6=(()=>{class n{}return n.CANNOT_GO_BACKWARD=()=>$localize`You cannot go backward with normal pieces!`,n.CANNOT_CAPTURE_EMPTY_SPACE=()=>$localize`You cannot capture an empty square, nor jump over it!`,n.CANNOT_SKIP_CAPTURE=()=>$localize`You must capture when it is possible!`,n.MUST_FINISH_CAPTURING=()=>$localize`You must finish this capture!`,n.THIS_PIECE_CANNOT_MOVE=()=>$localize`This piece cannot move!`,n.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL=()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`,n.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL=()=>$localize`You must move in a single diagonal step!`,n.CANNOT_CAPTURE_TWICE_THE_SAME_COORD=()=>$localize`You cannot jump over the same square several times!`,n})();class Ls{constructor(t,e){this.player=t,this.isOfficer=e}static getPlayerOfficer(t){return t===B.ZERO?Ls.ZERO_OFFICER:Ls.ONE_OFFICER}toString(){switch(this){case Ls.ZERO:return"u";case Ls.ONE:return"v";case Ls.ZERO_OFFICER:return"O";default:return ge.expectToBe(this,Ls.ONE_OFFICER),"X"}}equals(t){return this===t}}Ls.ZERO=new Ls(B.ZERO,!1),Ls.ONE=new Ls(B.ONE,!1),Ls.ZERO_OFFICER=new Ls(B.ZERO,!0),Ls.ONE_OFFICER=new Ls(B.ONE,!0);class Zo{constructor(t){this.pieces=t}isEmpty(){return 0===this.pieces.length}isCommandedBy(t){return!this.isEmpty()&&this.getCommander().player===t}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new Zo(this.pieces.slice(1))}capturePiece(t){return new Zo(this.pieces.concat(t))}addStackBelow(t){let e=this;for(const r of t.pieces)e=e.capturePiece(r);return e}getStackSize(){return this.pieces.length}promoteCommander(){let t=this.getCommander();if(t.isOfficer)return this;{t=Ls.getPlayerOfficer(t.player);const e=this.getPiecesUnderCommander();return new Zo([t]).addStackBelow(e)}}get(t){return this.pieces[t]}toString(t){let e=t-this.getStackSize(),r="";for(;e>0;)r+="_",e--;for(const s of this.pieces)r+=s.toString();return r}}Zo.EMPTY=new Zo([]);let rr=(()=>{class n extends xr{static getInitialState(){const e=new Zo([Ls.ZERO]),r=new Zo([Ls.ONE]),s=Zo.EMPTY;return new n([[r,s,r,s,r,s,r],[s,r,s,r,s,r,s],[r,s,r,s,r,s,r],[s,s,s,s,s,s,s],[e,s,e,s,e,s,e],[s,e,s,e,s,e,s],[e,s,e,s,e,s,e]],0)}static of(e,r){return new n(e,r)}static isNotOnBoard(e){return e.isNotInRange(n.SIZE,n.SIZE)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}getStacksOf(e){const r=[];for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++)this.getPieceAtXY(i,s).isCommandedBy(e)&&r.push(new S(i,s));return r}set(e,r){const s=this.getCopiedBoard();return s[e.y][e.x]=r,new n(s,this.turn)}remove(e){return this.set(e,Zo.EMPTY)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(e){return e===B.ZERO?0:n.SIZE-1}toString(){let e=1;for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++){const o=this.getPieceAtXY(i,s).getStackSize();e=Math.max(e,o)}const r=[];for(let s=0;s<n.SIZE;s++){const i=[];for(let o=0;o<n.SIZE;o++)i.push(this.getPieceAtXY(o,s).toString(e));r.push(i.join(" "))}return r.join("\n")}}return n.SIZE=7,n})();class z0t extends bt{equals(t){if(t.size()!==this.size())return!1;for(let e=0;e<this.size();e++)if(!1===tc(t.get(e),this.get(e)))return!1;return!0}get(t){return ge.assert(t<this.values.length,"MGPUniqueList: index out of bounds: "+t),this.values[t]}getFromEnd(t){return ge.assert(t<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+t),this.get(this.values.length-1-t)}}class Rs extends oo{constructor(t,e){super(),this.isStep=e,this.coords=new z0t(t)}static of(t,e){return new Rs(t,e)}static fromCapture(t){const e=Rs.getSteppedOverCoords(t);return e.isSuccess()?ve.success(new Rs(t,!1)):ve.failure(e.getReason())}static getSteppedOverCoords(t){let e=y.empty();const r=new bt;for(const s of t){if(rr.isNotOnBoard(s))return ve.failure($h.OUT_OF_RANGE(s));if(e.isPresent()){const i=e.get();if(!1===i.getVectorToward(s).isDiagonalOfLength(2))return ve.failure(w6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const c=i.getCoordsToward(s)[0];if(r.contains(c))return ve.failure(w6.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());r.add(c)}e=y.of(s)}return ve.success(r)}static fromStep(t,e){return rr.isNotOnBoard(t)?ve.failure($h.OUT_OF_RANGE(t)):rr.isNotOnBoard(e)?ve.failure($h.OUT_OF_RANGE(e)):!1===t.getVectorToward(e).isDiagonalOfLength(1)?ve.failure(w6.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):ve.success(new Rs([t,e],!0))}toString(){return"LascaMove("+this.coords.toList().map(r=>r.toString()).join(", ")+")"}getRelation(t){const e=this.coords.size(),r=t.coords.size(),s=Math.min(e,r);for(let i=0;i<s;i++)if(!1===this.coords.toList()[i].equals(t.coords.toList()[i]))return"INEQUALITY";return e===r?"EQUALITY":"PREFIX"}equals(t){return"EQUALITY"===this.getRelation(t)}isPrefix(t){return"PREFIX"===this.getRelation(t)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return Rs.getSteppedOverCoords(this.coords.toList())}concatenate(t){const e=this.getEndingCoord(),r=t.coords.toList()[0];We(e.equals(r),"should not concatenate non-touching move");const s=this.coords.toList(),i=Je.copyImmutableArray(s),o=t.coords.toList(),c=Je.copyImmutableArray(o).slice(1);return Rs.fromCapture(i.concat(c)).get()}}Rs.encoder=Ye.tuple([Ye.list(S.encoder),Ye.identity()],n=>[n.coords.toList(),n.isStep],n=>Rs.of(n[0],n[1]));class Yo extends I1{constructor(){super(rr)}static get(){return Yo.singleton.isAbsent()&&(Yo.singleton=y.of(new Yo)),Yo.singleton.get()}getCaptures(t){const e=t.getCurrentPlayer();return this.getCapturesOf(t,e)}getCapturesOf(t,e){const r=[],s=t.getStacksOf(e);for(const i of s)r.push(...this.getPieceCaptures(t,i));return r}getPieceCaptures(t,e){let r=[];const o=t.getPieceAt(e).getCommander().player.getOpponent(),c=this.getPieceDirections(t,e),u=t.getPieceAt(e);for(const h of c){const g=e.getNext(h,1);if(rr.isOnBoard(g)&&t.getPieceAt(g).isCommandedBy(o)){const m=g.getNext(h,1);if(rr.isOnBoard(m)&&t.getPieceAt(m).isEmpty()){const E=t.remove(e).remove(g).set(m,u),O=Rs.fromCapture([e,m]).get(),k=this.getPieceCaptures(E,m);if(0===k.length)r=r.concat(O);else{const U=k.map(j=>O.concatenate(j));r=r.concat(U)}}}}return r}getPieceDirections(t,e){const i=t.getPieceAt(e).getCommander().player.getScoreModifier(),o=[be.factory.fromDelta(-1,i).get(),be.factory.fromDelta(1,i).get()];return t.getPieceAt(e).getCommander().isOfficer&&o.push(be.factory.fromDelta(-1,-i).get(),be.factory.fromDelta(1,-i).get()),o}getSteps(t){const e=t.getCurrentPlayer();return this.getStepsOf(t,e)}getStepsOf(t,e){const r=[],s=t.getStacksOf(e);for(const i of s)r.push(...this.getPieceSteps(t,i));return r}getPieceSteps(t,e){const r=[],s=this.getPieceDirections(t,e);for(const i of s){const o=e.getNext(i,1);if(rr.isOnBoard(o)&&t.getPieceAt(o).isEmpty()){const c=Rs.fromStep(e,o).get();r.push(c)}}return r}applyLegalMove(t,e,r){const s=t.getStartingCoord(),i=t.getEndingCoord();let o=e.getPieceAt(s),c=e.remove(s);if(!1===t.isStep)for(const u of t.getCapturedCoords().get()){const h=e.getPieceAt(u),g=h.getCommander();o=o.capturePiece(g);const m=h.getPiecesUnderCommander();c=c.set(u,m)}if(c=c.set(i,o),i.y===e.getFinishLineOf(e.getCurrentPlayer())){const u=o.promoteCommander();c=c.set(i,u)}return c.incrementTurn()}isLegal(t,e){const r=t.getStartingCoord();if(e.getPieceAt(r).isEmpty())return R.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const s=e.getPieceAt(r),i=e.getCurrentOpponent();if(s.isCommandedBy(i))return R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());const o=t.coords.get(1);if(!1===s.getCommander().isOfficer&&r.getDirectionToward(o).get().y===i.getScoreModifier())return R.failure(w6.CANNOT_GO_BACKWARD());if(!1===e.getPieceAt(o).isEmpty())return R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE());const c=this.getCaptures(e);return t.isStep?c.length>0?R.failure(w6.CANNOT_SKIP_CAPTURE()):R.SUCCESS:this.isLegalCapture(t,e,c)}isLegalCapture(t,e,r){const s=e.getCurrentPlayer(),i=t.getCapturedCoords().get();for(const o of i){const c=e.getPieceAt(o);if(c.isCommandedBy(s))return R.failure(Xe.CANNOT_SELF_CAPTURE());if(c.isEmpty())return R.failure(w6.CANNOT_CAPTURE_EMPTY_SPACE())}return r.some(o=>o.equals(t))?R.SUCCESS:R.failure(w6.MUST_FINISH_CAPTURING())}getGameStatus(t){const e=t.gameState;return this.getCaptures(e).length>0||this.getSteps(e).length>0?Ie.ONGOING:Ie.getVictory(e.getCurrentOpponent())}}Yo.singleton=y.empty();class p_ extends ic{constructor(t){super(Yo.get(),t)}static getListMoves(t){const e=Yo.get().getCaptures(t.gameState);return e.length>0?e:Yo.get().getSteps(t.gameState)}getListMoves(t){return p_.getListMoves(t)}getBoardValue(t){const e=Yo.get().getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=this.getNumberOfMobileCoords(r,B.ZERO),i=this.getNumberOfMobileCoords(r,B.ONE);return Fn.of(s,i)}getNumberOfMobileCoords(t,e){const s=this.getCapturesAndSteps(t,e).map(o=>o.getStartingCoord());return new bt(s).size()}getCapturesAndSteps(t,e){const r=Yo.get().getCapturesOf(t,e),s=Yo.get().getStepsOf(t,e);return r.concat(s)}}class V0t extends p_{constructor(){super("Lasca Control And Domination Minimax")}getBoardValue(t){const e=Yo.get().getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=12*super.getBoardValue(t).value;let s=0;for(let i=0;i<rr.SIZE;i++)for(let o=0;o<rr.SIZE;o++){const c=t.gameState.getPieceAtXY(o,i);if(c.getStackSize()>0){const u=c.getStackSize();let h=0;const g=c.getCommander().player;for(;h<u&&c.get(h).player===g;)h++;s+=h*g.getScoreModifier()}}return new Fn(r+s)}}const L3e=Ls.ZERO,eF=Ls.ONE,Ds=new Zo([L3e]),Cr=new Zo([eF]),H0t=new Zo([L3e,eF]),F0t=new Zo([Ls.ZERO_OFFICER,eF]),se=Zo.EMPTY;class R3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,rr.getInitialState()),te.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,rr.getInitialState()),te.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,rr.getInitialState(),Rs.fromStep(new S(4,4),new S(3,3)).get(),$localize`Congratulations!`),te.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,rr.of([[Cr,se,se,se,Cr,se,Cr],[se,se,se,Cr,se,Cr,se],[se,se,Cr,se,Cr,se,Cr],[se,Cr,se,se,se,se,se],[Ds,se,Ds,se,Ds,se,Ds],[se,Ds,se,Ds,se,Ds,se],[Ds,se,Ds,se,Ds,se,Ds]],2),Rs.fromCapture([new S(2,4),new S(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),te.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,rr.of([[se,se,se,se,se,se,se],[se,se,se,se,se,se,se],[Cr,se,se,se,Cr,se,Cr],[se,Cr,se,Cr,se,Cr,se],[se,se,Cr,se,Cr,se,Cr],[se,Cr,se,se,se,se,se],[se,se,Ds,se,Ds,se,Ds]],2),Rs.fromCapture([new S(2,6),new S(0,4),new S(2,2)]).get(),$localize`Congratulations!`),te.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,rr.of([[se,se,se,se,se,se,se],[se,se,se,se,se,Cr,se],[se,se,se,se,se,se,se],[se,Cr,se,Cr,se,se,se],[se,se,Ds,se,se,se,se],[se,se,se,se,se,se,se],[se,se,se,se,se,se,se]],2)),te.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,rr.of([[se,se,se,se,se,se,Cr],[se,se,se,H0t,se,Cr,se],[se,se,se,se,se,se,se],[se,se,se,se,se,se,se],[se,se,se,se,se,se,se],[se,se,se,se,se,se,se],[se,se,Ds,se,Ds,se,Ds]],2),[Rs.fromStep(new S(3,1),new S(2,0)).get(),Rs.fromStep(new S(3,1),new S(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),te.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,rr.of([[se,se,se,se,F0t,se,Cr],[se,se,se,se,se,se,se],[se,se,se,se,Cr,se,se],[se,se,se,se,se,se,se],[se,se,se,se,se,se,se],[se,se,se,se,se,se,se],[se,se,Ds,se,Ds,se,Ds]],2),[Rs.fromStep(new S(4,0),new S(3,1)).get(),Rs.fromStep(new S(4,0),new S(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)]}}function B0t(n,t){if(1&n&&(H(),X(0,"circle",13)),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C().index,c=C();J2("id","square_",i,"_",o,"_piece_",r,"_officer_symbol"),w("ngClass",s.classes),z("cx",.4*c.SPACE_SIZE)("cy",.575*c.SPACE_SIZE)("r",.045*c.SPACE_SIZE)}}function $0t(n,t){if(1&n&&(H(),b(0,"g",10),X(1,"use",11),x(2,B0t,1,7,"circle",12),A()),2&n){const e=t.$implicit,r=t.index,s=C().index,i=C().index;z("transform",C().getPieceTranslate(r)),T(1),J2("id","square_",s,"_",i,"_piece_",r,""),w("ngClass",e.classes),T(1),w("ngIf",e.isOfficer)}}function U0t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"g",7),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),X(2,"polygon",8),x(3,$0t,3,6,"g",9),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Le("id","coord_",r,"_",s,""),z("transform",i.getTranslate(r,s,0)),T(1),Le("id","square_",r,"_",s,""),w("ngClass",e.squareClasses),z("points",i.getParallelogramPoints()),T(1),w("ngForOf",e.pieceInfos)}}function G0t(n,t){if(1&n&&(H(),b(0,"g"),x(1,U0t,4,8,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let q0t=(()=>{class n extends k3e{constructor(e){super(e),this.THICKNESS=40,this.mode={horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:rr.SIZE},this.LEFT=0,this.UP=-this.SPACE_SIZE,this.basicWidth=this.mode.abstractBoardSize*this.mode.parallelogramHeight,this.WIDTH=this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio),this.HEIGHT=this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP,this.CX=this.WIDTH/2,this.CY=(this.HEIGHT+this.UP)/2,this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]},this.lastMove=y.empty(),this.currentMoveClicks=[],this.capturedCoords=[],this.legalMoves=[],this.hasAsymmetricBoard=!0,this.rules=Yo.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new p_("Lasca Control Minimax"),new V0t],this.encoder=Rs.encoder,this.tutorial=(new R3e).tutorial,this.canPass=!1,this.updateBoard()}updateBoard(){this.lastMove=this.node.move;const e=this.getState();this.board=e.getCopiedBoard(),this.legalMoves=p_.getListMoves(this.node),this.createAdaptedBoardFrom(e),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}createAdaptedBoardFrom(e){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let i=0;i<rr.SIZE;i++){const o=[];for(let c=0;c<rr.SIZE;c++){const u=this.getSpaceInfo(e,c,i);o.push(u)}this.adaptedBoard.spaceInfo.push(o)}const s=y.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(s.isPresent()){const i=s.get();for(const o of this.getSpaceInfoAt(i).pieceInfos)o.classes.push("selected-stroke");this.showPossibleLandings(i,e)}for(const i of this.capturedCoords)this.getSpaceInfoAt(i).squareClasses.push("captured-fill");for(const i of this.currentMoveClicks)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}getSpaceInfo(e,r,s){const i=e.getPieceAtXY(r,s),o=[];for(let c=i.getStackSize()-1;c>=0;c--){const u=i.get(c);o.push({classes:[this.getPlayerClass(u.player)],isOfficer:u.isOfficer})}return{pieceInfos:o,squareClasses:[]}}showLastMove(e){this.showLastCapture(e),this.showSteppedOnCoord(e)}showLastCapture(e){if(!1===e.isStep){const r=e.getCapturedCoords();ge.assert(r.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const s of r.get())this.getSpaceInfoAt(s).squareClasses.push("captured-fill")}}showSteppedOnCoord(e){for(const r of e.coords)this.getSpaceInfoAt(r).squareClasses.push("moved-fill")}showPossibleMoves(){for(const e of this.legalMoves){const r=e.getStartingCoord();this.getSpaceInfoAt(r).squareClasses.push("selectable-fill")}}getSpaceInfoAt(e){if(this.role===B.ONE&&this.adaptedBoard.isAlreadySwitched){const r=rr.SIZE-1,s=new S(r-e.x,r-e.y);return this.adaptedBoard.spaceInfo[s.y][s.x]}return this.adaptedBoard.spaceInfo[e.y][e.x]}rotateAdaptedBoardIfNeeded(){if(this.role===B.ONE){const e=[];for(let r=0;r<rr.SIZE;r++){e[rr.SIZE-1-r]=[];for(let s=0;s<rr.SIZE;s++)e[rr.SIZE-1-r][rr.SIZE-1-s]=this.getSpaceInfoAt(new S(s,r))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:e}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(e,r){var s=this;return I(function*(){s.role===B.ONE&&(e=rr.SIZE-1-e,r=rr.SIZE-1-r);const i=s.canUserPlay("#coord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r),c=s.getState().getPieceAt(o),u=s.getState().getCurrentOpponent();return c.isCommandedBy(u)?s.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):0===s.currentMoveClicks.length?s.trySelectingPiece(o):s.moveClick(o)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(e){var r=this;return I(function*(){if(e.equals(r.currentMoveClicks[0]))return r.cancelMoveAttempt(),R.SUCCESS;const s=r.getState().getPieceAt(e),i=r.getState().getCurrentPlayer();if(s.isCommandedBy(i))return r.cancelMoveAttempt(),r.trySelectingPiece(e);if(1===r.currentMoveClicks.length&&r.currentMoveClicks[0].getVectorToward(e).isDiagonalOfLength(1)){const c=Rs.fromStep(r.currentMoveClicks[0],e).get();return r.chooseMove(c)}return r.capture(e)})()}capture(e){var r=this;return I(function*(){const i=r.currentMoveClicks[r.currentMoveClicks.length-1],o=i.getVectorToward(e);if(o.isDiagonalOfLength(2)){const c=new S(i.x+o.x/2,i.y+o.y/2);r.capturedCoords.push(c),r.currentMoveClicks.push(e);const u=Rs.fromCapture(r.currentMoveClicks).get();return r.legalMoves.some(h=>h.isPrefix(u))?r.applyPartialCapture():r.chooseMove(u)}return r.cancelMove(w6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let e=this.getState().remove(this.currentMoveClicks[0]),r=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const i of this.capturedCoords){const o=this.getState().getPieceAt(i),c=o.getCommander(),u=o.getPiecesUnderCommander();e=e.set(i,u),r=r.capturePiece(c)}return e=e.set(this.currentMoveClicks[this.currentMoveClicks.length-1],r),this.createAdaptedBoardFrom(e),this.rotateAdaptedBoardIfNeeded(),R.SUCCESS}trySelectingPiece(e){var r=this;return I(function*(){return r.getState().getPieceAt(e).isEmpty()?r.cancelMove(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r.selectPiece(e)})()}selectPiece(e){return this.capturedCoords=[],this.legalMoves.some(r=>r.getStartingCoord().equals(e))?(this.currentMoveClicks=[e],this.hideLastMove(),R.SUCCESS):this.cancelMove(w6.THIS_PIECE_CANNOT_MOVE())}showPossibleLandings(e,r){const s=this.rules.getPieceCaptures(r,e);if(0===s.length){const i=this.rules.getPieceSteps(r,e);for(const o of i)this.getSpaceInfoAt(o.getEndingCoord()).squareClasses.push("selectable-fill")}else{const i=s.map(o=>o.coords.get(1));for(const o of i)this.getSpaceInfoAt(o).squareClasses.push("capturable-fill")}}getTranslate(e,r,s){const i=this.getCoordTranslate(e,r,s,this.mode);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(r=>r.x+", "+r.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const e=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(e[0],e[1],e[2],e[3])}getParallelogramCenterOf(e,r,s,i){const o=Math.max(e.x,r.x,s.x,i.x),c=Math.max(e.y,r.y,s.y,i.y),u=Math.min(e.x,r.x,s.x,i.x),h=Math.min(e.y,r.y,s.y,i.y);return new S((o-u)/2,(c-h)/2)}getRightEdge(){const e=this.basicWidth*this.mode.horizontalWidthRatio,r=this.basicWidth*this.mode.offsetRatio;return[r+e,0,r+e,this.THICKNESS,e,this.basicWidth+this.THICKNESS,e,this.basicWidth].join(" ")}getPieceTranslate(e){return"translate(0 "+(this.getParallelogramCenter().y-32.5-e*(.15*this.SPACE_SIZE))+")"}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-lasca"]],features:[l],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(e,r){1&e&&(H(),b(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),A()(),x(5,G0t,2,1,"g",4),X(6,"rect",5)(7,"polygon",6),A()),2&e&&(z("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),T(5),w("ngForOf",r.adaptedBoard.spaceInfo),T(1),z("y",r.basicWidth)("width",r.basicWidth*r.mode.horizontalWidthRatio)("height",r.THICKNESS),T(1),z("points",r.getRightEdge()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),bi=(()=>{class n extends xr{static getInitialState(){const e=ue.NONE,r=ue.ZERO,s=ue.ONE;return new n([[e,r,r,r,r,r,r,e],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[e,r,r,r,r,r,r,e]],0)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}}return n.SIZE=8,n})();class fo extends Hc{constructor(t,e,r){super(t,e),this.direction=r,this.direction=be.factory.fromMove(t,e).get()}static from(t,e){const r=be.factory.fromMove(t,e);return r.isFailure()?ve.failure(r.getReason()):t.isNotInRange(bi.SIZE,bi.SIZE)?ve.failure("start coord is not in range"):e.isNotInRange(bi.SIZE,bi.SIZE)?ve.failure("end coord is not in range"):ve.success(new fo(t,e,r.get()))}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}}fo.encoder=Pa.getFallibleEncoder(fo.from);let tF=(()=>{class n{}return n.INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`,n.CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`,n.PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`,n})();class zs extends I1{constructor(){super(bi)}static get(){return zs.singleton.isAbsent()&&(zs.singleton=y.of(new zs)),zs.singleton.get()}static getListMovesFromState(t){const e=[];if(zs.getVictory(t).isPresent())return e;for(let r=0;r<bi.SIZE;r++)for(let s=0;s<bi.SIZE;s++){const i=new S(s,r);if(t.getPieceAt(i).isPlayer())for(const c of zs.possibleTargets(t,i)){const u=fo.from(i,c).get();e.push(u)}}return e}static getNumberOfGroups(t){const e=Je.createTable(bi.SIZE,bi.SIZE,-1),r=[0,0];let s=0;for(let i=0;i<bi.SIZE;i++)for(let o=0;o<bi.SIZE;o++)if(-1===e[i][o]){const c=t.getPieceAt(new S(o,i));c.isPlayer()&&(s+=1,zs.markGroupStartingAt(t,e,new S(o,i),s),r[c.value]+=1)}return r}static markGroupStartingAt(t,e,r,s){const i=[r],o=t.getPieceAt(r);for(;i.length>0;){const c=ge.getNonNullable(i.pop());if(-1===e[c.y][c.x]){const u=t.getPieceAt(c);if(u===o){e[c.y][c.x]=s;for(const h of be.DIRECTIONS){const g=c.getNext(h);t.isOnBoard(g)&&i.push(g)}}else u===ue.NONE&&(e[c.y][c.x]=0)}}}applyLegalMove(t,e,r){const s=e.getCopiedBoard();return s[t.getStart().y][t.getStart().x]=ue.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer(),new bi(s,e.turn+1)}static isLegal(t,e){return e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE()):t.length()!==this.numberOfPiecesOnLine(e,t.getStart(),t.direction)?R.failure(tF.INVALID_MOVE_LENGTH()):t.getStart().getCoordsToward(t.getEnd()).some(r=>e.getPieceAt(r)===e.getCurrentOpponent())?R.failure(tF.CANNOT_JUMP_OVER_OPPONENT()):e.getPieceAt(t.getEnd())===e.getCurrentPlayer()?R.failure(Xe.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):R.SUCCESS}isLegal(t,e){return zs.isLegal(t,e)}static numberOfPiecesOnLine(t,e,r){let s=0;for(const i of zs.getLineCoords(e,r))t.getPieceAt(i).isPlayer()&&(s+=1);return s}static getLineCoords(t,e){const r=zs.getEntranceAndForwardDirection(t,e);let s=r[0];const i=r[1],o=[];for(;bi.isOnBoard(s);)o.push(s),s=s.getNext(i);return o}static getEntranceAndForwardDirection(t,e){switch(e){case be.UP:case be.DOWN:return[new S(t.x,0),be.DOWN];case be.LEFT:case be.RIGHT:return[new S(0,t.y),be.RIGHT];case be.UP_RIGHT:case be.DOWN_LEFT:return[new S(Math.max(0,t.x+t.y-7),Math.min(7,t.x+t.y)),be.UP_RIGHT];default:return ge.expectToBeMultiple(e,[be.UP_LEFT,be.DOWN_RIGHT]),[new S(t.x-Math.min(t.x,t.y),t.y-Math.min(t.x,t.y)),be.DOWN_RIGHT]}}static getVictory(t){const[e,r]=zs.getNumberOfGroups(t);return 1===e&&1===r?y.of(ue.NONE):1===e?y.of(B.ZERO):1===r?y.of(B.ONE):y.empty()}static possibleTargets(t,e){const r=[];for(const s of be.DIRECTIONS){const i=zs.numberOfPiecesOnLine(t,e,s),o=e.getNext(s,i);if(t.isOnBoard(o)){const c=fo.from(e,o).get();zs.isLegal(c,t).isSuccess()&&r.push(o)}}return r}getGameStatus(t){const e=t.gameState,[r,s]=zs.getNumberOfGroups(e);return 1===r&&s>1?Ie.ZERO_WON:r>1&&1===s?Ie.ONE_WON:Ie.ONGOING}}zs.singleton=y.empty();class W0t extends ks{getListMoves(t){return zs.getListMovesFromState(t.gameState)}getMetrics(t){const e=t.gameState,[r,s]=zs.getNumberOfGroups(e);return[100/r,100/s]}}const Y=ue.NONE,ur=ue.ZERO,sr=ue.ONE;class D3e{constructor(){this.tutorial=[te.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new bi([[Y,Y,Y,Y,Y,Y,Y,Y],[sr,Y,Y,Y,ur,Y,Y,sr],[Y,Y,ur,ur,sr,Y,Y,Y],[Y,Y,Y,ur,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y]],0)),te.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,bi.getInitialState(),fo.from(new S(1,7),new S(1,5)).get(),$localize`Congratulations!`),te.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new bi([[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,sr,ur,ur,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,sr],[Y,Y,Y,Y,Y,Y,Y,ur]],0),[fo.from(new S(3,1),new S(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),te.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new bi([[Y,Y,Y,Y,Y,Y,sr,Y],[Y,Y,Y,Y,Y,ur,Y,Y],[Y,Y,Y,Y,sr,Y,Y,Y],[Y,Y,Y,ur,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,sr],[Y,Y,Y,Y,Y,sr,Y,sr],[Y,Y,Y,ur,Y,Y,sr,sr],[Y,Y,Y,ur,Y,Y,Y,Y]],0),[fo.from(new S(3,3),new S(3,0)).get(),fo.from(new S(3,3),new S(0,0)).get(),fo.from(new S(3,3),new S(2,3)).get(),fo.from(new S(3,3),new S(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),te.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new bi([[Y,ur,Y,ur,ur,ur,ur,Y],[sr,Y,Y,Y,Y,Y,Y,sr],[Y,Y,ur,Y,sr,Y,Y,Y],[sr,Y,Y,Y,Y,Y,Y,sr],[sr,Y,Y,Y,Y,Y,Y,sr],[sr,Y,Y,Y,Y,Y,Y,sr],[sr,Y,Y,Y,Y,Y,Y,sr],[Y,ur,ur,ur,ur,ur,ur,Y]],0),fo.from(new S(2,2),new S(4,2)).get(),(t,e,r)=>e.getPieceAt(t.getEnd())===ue.ONE?R.SUCCESS:R.failure($localize`Failed. Try again.`),$localize`Congratulations!`),te.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new bi([[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[ur,Y,Y,ur,sr,ur,Y,Y],[Y,Y,Y,ur,Y,Y,Y,sr],[Y,Y,Y,Y,Y,Y,Y,sr],[Y,Y,Y,Y,Y,Y,Y,sr],[Y,Y,Y,Y,Y,Y,Y,sr],[Y,Y,Y,Y,Y,Y,Y,Y]],0),[fo.from(new S(0,2),new S(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)]}}function j0t(n,t){if(1&n&&(H(),X(0,"circle",4)),2&n){const e=C().index,r=C().index,s=C();Le("id","piece_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),z("cx",s.SPACE_SIZE/2+e*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+r*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function Z0t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"g",3),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),X(2,"rect",4),x(3,j0t,1,6,"circle",5),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Le("id","click_",r,"_",s,""),T(1),Le("id","space_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e!==i.EMPTY)}}function Y0t(n,t){if(1&n&&(H(),b(0,"g"),x(1,Z0t,4,10,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function K0t(n,t){if(1&n){const e=Ae();H(),b(0,"rect",6),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();z("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}let X0t=(()=>{class n extends ao{constructor(e){super(e),this.INDICATOR_SIZE=20,this.EMPTY=ue.NONE,this.targets=[],this.selected=y.empty(),this.lastMove=y.empty(),this.captured=y.empty(),this.rules=zs.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new W0t(this.rules,"LinesOfActionMinimax")],this.encoder=fo.encoder,this.tutorial=(new D3e).tutorial,this.updateBoard()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);if(s.selected.equalsValue(o))return s.cancelMoveAttempt(),R.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(o)===c?s.select(o):s.concludeMove(o)})()}concludeMove(e){var r=this;return I(function*(){const s=fo.from(r.selected.get(),e);return s.isSuccess()?r.chooseMove(s.get()):r.cancelMove(s.getReason())})()}select(e){var r=this;return I(function*(){return r.getState().getPieceAt(e)!==r.getState().getCurrentPlayer()?r.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE()):(r.selected=y.of(e),r.targets=zs.possibleTargets(r.getState(),r.selected.get()),0===r.targets.length?r.cancelMove(tF.PIECE_CANNOT_MOVE()):R.SUCCESS)})()}updateBoard(){this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.node.move}showLastMove(e){this.captured=this.getPreviousState().getPieceAt(e.getEnd()).isPlayer()?y.of(e.getEnd()):y.empty()}cancelMoveAttempt(){this.selected=y.empty(),this.targets=[]}getSquareClasses(e,r){const s=new S(e,r);if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(i)||s.equals(o))return["moved-fill"]}return[]}getPieceClasses(e,r){const s=this.board[r][e],i=new S(e,r),o=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(i)&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-linesofaction"]],features:[l],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,Y0t,2,1,"g",1),x(2,K0t,1,4,"rect",2),A()),2&e&&(T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.targets))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Q4 extends ms{constructor(t,e,r,s={top:0,bottom:0,left:0,right:0}){super(t.x,t.y),this.direction=e,this.orientation=r,this.captures=s}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(t){return this===t||!(!1===this.coord.equals(t.coord)||this.orientation!==t.orientation||this.direction!==t.direction||this.captures.top!==t.captures.top||this.captures.bottom!==t.captures.bottom||this.captures.left!==t.captures.left||this.captures.right!==t.captures.right)}}Q4.encoder=new class extends Ye{encode(n){return{coord:S.encoder.encode(n.coord),direction:n.direction,orientation:n.orientation,captures:n.captures}}decode(n){const t=n;return We(null!=t.coord,"Invalid encoded LodestoneMove"),We(null!=t.direction,"Invalid encoded LodestoneMove"),We(null!=t.orientation,"Invalid encoded LodestoneMove"),We(null!=t.captures,"Invalid encoded LodestoneMove"),new Q4(S.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}};class ho{constructor(t){this.unreachable=t}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(t){return this===t}}ho.UNREACHABLE=new ho(!0),ho.EMPTY=new ho(!1);class Qc{constructor(t){this.owner=t}static of(t){return t===B.ZERO?Qc.ZERO:Qc.ONE}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}Qc.ZERO=new Qc(B.ZERO),Qc.ONE=new Qc(B.ONE);class Ko{constructor(t,e,r){this.owner=t,this.direction=e,this.orientation=r}static of(t,e){return Ko.LODESTONES[t.value][e.direction][e.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}Ko.LODESTONES={0:{push:{diagonal:new Ko(B.ZERO,"push","diagonal"),orthogonal:new Ko(B.ZERO,"push","orthogonal")},pull:{diagonal:new Ko(B.ZERO,"pull","diagonal"),orthogonal:new Ko(B.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new Ko(B.ONE,"push","diagonal"),orthogonal:new Ko(B.ONE,"push","orthogonal")},pull:{diagonal:new Ko(B.ONE,"pull","diagonal"),orthogonal:new Ko(B.ONE,"pull","orthogonal")}}};class yr{constructor(t,e){this.width=t,this.pieces=e}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(t,e){if(this.pieces.length+e>=this.width)return 5===this.width?yr.EMPTY_3.addCaptured(t,e+this.pieces.length-5):(We(this.pieces.length+e===3,"should never put more pieces than the plate can support"),y.empty());{const r=Je.copyImmutableArray(this.pieces);for(let s=0;s<e;s++)r.push(Qc.of(t));return y.of(new yr(this.width,r))}}getPieceAt(t){return t<this.pieces.length?this.pieces[t]:ho.EMPTY}}yr.POSITIONS=["top","bottom","left","right"],yr.EMPTY_5=new yr(5,[]),yr.EMPTY_3=new yr(3,[]);let ir=(()=>{class n extends xr{constructor(e,r,s,i){super(e,r),this.lodestones=s,this.pressurePlates=i}static getInitialState(){const e=ho.EMPTY,r=Qc.ZERO,s=Qc.ONE;return new n([[e,e,r,s,r,s,e,e],[e,r,s,r,s,r,s,e],[r,s,r,s,r,s,r,s],[s,r,s,e,e,r,s,r],[r,s,r,e,e,s,r,s],[s,r,s,r,s,r,s,r],[e,s,r,s,r,s,r,e],[e,e,s,r,s,r,e,e]],0,new jn,{top:y.of(yr.EMPTY_5),bottom:y.of(yr.EMPTY_5),left:y.of(yr.EMPTY_5),right:y.of(yr.EMPTY_5)})}withBoard(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}remainingSpacesDetails(){const e={top:0,bottom:0,left:0,right:0};for(const r of yr.POSITIONS){const s=this.pressurePlates[r];s.isPresent()&&(e[r]=s.get().remainingSpaces())}return e}numberOfPieces(){const e=[0,0];for(let r=0;r<n.SIZE;r++)for(let s=0;s<n.SIZE;s++){const i=this.getPieceAtXY(s,r);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}getScores(){const e=this.numberOfPieces();return[24-e[1],24-e[0]]}nextLodestoneDirection(){const e=this.getCurrentPlayer(),r=this.lodestones.get(e);if(!r.isPresent())return y.empty();{const s=this.getPieceAt(r.get());switch(We(s.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+r.get()),s.direction){case"push":return y.of("pull");case"pull":return y.of("push")}}}}return n.SIZE=8,n})();const je=ho.UNREACHABLE,he=ho.EMPTY,Cs=Qc.ZERO,po=Qc.ONE,g_=Ko.of(B.ONE,{direction:"push",orientation:"orthogonal"}),nF={top:y.of(yr.EMPTY_5),bottom:y.of(yr.EMPTY_5),left:y.of(yr.EMPTY_5),right:y.of(yr.EMPTY_5)};class z3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,ir.getInitialState()),te.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,ir.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),te.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,ir.getInitialState()),te.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,ir.getInitialState()),te.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,ir.getInitialState()),te.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,ir.getInitialState(),new Q4(new S(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,e,r)=>32===r.remainingSpaces()?R.failure($localize`You have not captured any of the opponent's pieces, try again!`):R.SUCCESS,$localize`Congratulations!`),te.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new ir([[he,he,he,he,po,he,he,he],[he,he,Cs,he,he,po,he,he],[he,he,g_,he,he,he,he,Cs],[he,he,he,he,po,he,he,Cs],[he,he,he,he,he,Cs,he,he],[he,he,he,he,he,he,he,he],[he,he,he,he,he,he,he,he],[he,he,he,he,he,he,he,he]],0,new jn([{key:B.ONE,value:new S(2,2)}]),{...nF,top:yr.EMPTY_5.addCaptured(B.ONE,4)}),new Q4(new S(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>5===r.pressurePlates.top.get().width?R.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):R.SUCCESS,$localize`Congratulations!`),te.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new ir([[je,je,je,je,je,je,je,je],[he,he,he,he,he,he,he,he],[he,he,he,he,he,he,he,Cs],[he,he,he,he,he,Cs,he,Cs],[he,g_,he,he,po,he,he,he],[he,he,he,he,he,he,he,he],[he,he,he,he,po,he,he,he],[he,he,he,he,he,he,he,he]],0,new jn([{key:B.ONE,value:new S(1,4)}]),{...nF,top:yr.EMPTY_3.addCaptured(B.ONE,2)}),new Q4(new S(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>r.pressurePlates.top.isPresent()?R.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):R.SUCCESS,$localize`Congratulations!`),te.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new ir([[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je],[je,je,Cs,po,he,he,je,je],[je,je,g_,po,he,he,je,je],[je,je,he,Cs,Cs,he,je,je],[je,je,Cs,he,he,he,je,je],[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je]],0,new jn([{key:B.ONE,value:new S(2,3)}]),{top:y.empty(),bottom:y.empty(),left:y.empty(),right:y.empty()})),te.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new ir([[he,he,he,he,he,he,he,he],[he,he,he,he,he,po,he,he],[he,he,he,g_,he,he,Cs,he],[he,he,Cs,Cs,po,he,he,Cs],[he,he,he,he,he,Cs,he,he],[he,he,Cs,he,he,he,he,he],[he,he,po,he,he,he,he,he],[he,he,he,he,he,he,he,he]],0,new jn([{key:B.ONE,value:new S(3,2)}]),{...nF,top:yr.EMPTY_5.addCaptured(B.ONE,4)}),[new Q4(new S(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),te.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new ir([[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je],[je,po,Cs,po,he,he,je,je],[je,po,g_,he,po,he,je,je],[je,he,he,Cs,Cs,he,je,je],[je,po,Cs,he,po,he,je,je],[je,he,he,he,Cs,he,je,je],[je,je,je,je,je,je,je,je]],0,new jn([{key:B.ONE,value:new S(2,3)}]),{top:y.empty(),bottom:yr.EMPTY_3.addCaptured(B.ZERO,2),left:y.of(yr.EMPTY_3),right:y.empty()}),[new Q4(new S(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)]}}let Qh=(()=>{class n{}return n.MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`,n.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`,n.TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`,n.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`,n.MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`,n.NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`,n})();class H2 extends I1{constructor(){super(ir)}static get(){return H2.singleton.isAbsent()&&(H2.singleton=y.of(new H2)),H2.singleton.get()}applyLegalMove(t,e,r){const s=e.getCurrentPlayer(),i=s.getOpponent(),o=Je.copyBiArray(r.board),c=e.lodestones.getCopy();c.put(s,t.coord);const u={...e.pressurePlates};return this.updatePressurePlates(o,u,c,i,t.captures),new ir(o,e.turn+1,c,u)}updatePressurePlates(t,e,r,s,i){for(const o of yr.POSITIONS)e[o]=this.updatePressurePlate(t,o,e[o],r,s,i[o])}updatePressurePlate(t,e,r,s,i,o){if(r.isPresent()){const c=r.get().addCaptured(i,o),u=H2.THREATENED_COORD_RANGE.get(e).get();return c.isAbsent()?(this.removePressurePlate(t,u.startForBigPlate,u.direction,s),this.removePressurePlate(t,u.startForSmallPlate,u.direction,s)):c.get().width<r.get().width&&this.removePressurePlate(t,u.startForBigPlate,u.direction,s),c}return r}removePressurePlate(t,e,r,s){for(let i=e;i.isInRange(ir.SIZE,ir.SIZE);i=i.getNext(r)){for(const o of B.PLAYERS)s.get(o).equalsValue(i)&&s.delete(o);t[i.y][i.x]=ho.UNREACHABLE}}isLegal(t,e){const r=this.isLegalWithoutCaptures(e,t.coord,t.direction);if(r.isFailure())return ve.failure(r.getReason());const s=this.applyMoveWithoutPlacingCaptures(e,t.coord,t);if(t.captures.top+t.captures.bottom+t.captures.left+t.captures.right!==Math.min(s.captures.length,e.remainingSpaces()))return ve.failure(Qh.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const c of yr.POSITIONS){const u=e.pressurePlates[c];if(u.isPresent()&&u.get().remainingSpaces()<t.captures[c])return ve.failure(Qh.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return ve.success(s)}applyMoveWithoutPlacingCaptures(t,e,r){let s;const i=Je.copyBiArray(t.board),o=t.lodestones.get(t.getCurrentPlayer());if(o.isPresent()){const c=o.get();i[c.y][c.x]=ho.EMPTY}return s="pull"===r.direction?this.applyPull(t,i,e,r.orientation):this.applyPush(t,i,e,r.orientation),s.board[e.y][e.x]=Ko.of(t.getCurrentPlayer(),r),s.moved.push(e),s}applyPull(t,e,r,s){const i=t.getCurrentPlayer(),o=i.getOpponent(),c=[],u=[],h="diagonal"===s?be.DIAGONALS:be.ORTHOGONALS;for(const g of h)for(let m=r.getNext(g);t.isOnBoard(m);m=m.getNext(g)){const E=e[m.y][m.x],O=m.getNext(g);if(t.isOnBoard(O)){const k=e[O.y][O.x];k.isPlayerPiece()&&k.owner===i&&(E.isEmpty()?(u.push(m),e[m.y][m.x]=k,u.push(O),e[O.y][O.x]=ho.EMPTY):E.isPlayerPiece()&&E.owner===o&&(c.push(m),e[m.y][m.x]=k,u.push(O),e[O.y][O.x]=ho.EMPTY))}}return{board:e,captures:c,moved:u}}applyPush(t,e,r,s){const o=t.getCurrentPlayer().getOpponent(),c=[],u=[],h="diagonal"===s?be.DIAGONALS:be.ORTHOGONALS;for(const g of h)for(let E=r.getNext(g,ir.SIZE);!1===E.equals(r);E=E.getPrevious(g))if(t.isOnBoard(E)){const O=e[E.y][E.x];if(O.isPlayerPiece()&&O.owner===o){const k=E.getNext(g);if(t.isOnBoard(k)){const U=e[k.y][k.x];U.isUnreachable()?(c.push(E),e[E.y][E.x]=ho.EMPTY):U.isEmpty()&&(u.push(k),e[k.y][k.x]=O,u.push(E),e[E.y][E.x]=ho.EMPTY)}else c.push(E),e[E.y][E.x]=ho.EMPTY}}return{board:e,captures:c,moved:u}}isLegalWithoutCaptures(t,e,r){const s=this.isTargetLegal(t,e);if(s.isFailure())return s;const i=t.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(r))?R.failure(Qh.MUST_FLIP_LODESTONE()):R.SUCCESS}isTargetLegal(t,e){const r=t.getPieceAt(e);if(r.isUnreachable())return R.failure(Qh.TARGET_IS_CRUMBLED());if(r.isPlayerPiece())return R.failure(Xe.MUST_CLICK_ON_EMPTY_SQUARE());const s=t.getCurrentPlayer();return r.isLodestone()&&r.owner!==s?R.failure(Xe.MUST_CLICK_ON_EMPTY_SQUARE()):R.SUCCESS}getGameStatus(t){const r=t.gameState.numberOfPieces();return 0===r[0]&&0===r[1]?Ie.DRAW:0===r[0]?Ie.ONE_WON:0===r[1]?Ie.ZERO_WON:Ie.ONGOING}}H2.THREATENED_COORD_RANGE=jn.from({top:{startForBigPlate:new S(0,0),startForSmallPlate:new S(0,1),direction:be.RIGHT},bottom:{startForBigPlate:new S(0,ir.SIZE-1),startForSmallPlate:new S(0,ir.SIZE-2),direction:be.RIGHT},left:{startForBigPlate:new S(0,0),startForSmallPlate:new S(1,0),direction:be.DOWN},right:{startForBigPlate:new S(ir.SIZE-1,0),startForSmallPlate:new S(ir.SIZE-2,0),direction:be.DOWN}}),H2.singleton=y.empty();class Q0t extends ic{getListMoves(t){const e=t.gameState;return this.flatMapEmptyCoords(e,r=>{const s=[];for(const i of this.nextDirection(e)){const o=["diagonal","orthogonal"];for(const c of o){const g=H2.get().applyMoveWithoutPlacingCaptures(e,r,{direction:i,orientation:c}).captures.length;for(const m of this.captureCombinations(e,g))s.push(new Q4(r,i,c,m))}}return s})}captureCombinations(t,e){if(0===e)return new bt([{top:0,bottom:0,left:0,right:0}]);{const r=new bt,s=t.remainingSpacesDetails(),i=this.captureCombinations(t,e-1);for(const o of i)o.top+1<=s.top&&r.add({...o,top:o.top+1}),o.bottom+1<=s.bottom&&r.add({...o,bottom:o.bottom+1}),o.left+1<=s.left&&r.add({...o,left:o.left+1}),o.right+1<=s.right&&r.add({...o,right:o.right+1});return 0===r.size()?i:r}}flatMapEmptyCoords(t,e){let r=[];for(let s=0;s<ir.SIZE;s++)for(let i=0;i<ir.SIZE;i++){const o=new S(i,s),c=t.getPieceAt(o);(c.isEmpty()&&!1===c.isUnreachable()||c.isLodestone()&&c.owner===t.getCurrentPlayer())&&(r=r.concat(e(o)))}return r}nextDirection(t){const e=t.nextLodestoneDirection();return e.isPresent()?[e.get()]:["push","pull"]}getBoardValue(t){const e=t.gameState.getScores();let r;return r=24===e[0]&&24!==e[1]?B.ZERO.getVictoryValue():24!==e[0]&&24===e[1]?B.ONE.getVictoryValue():Fn.of(e[0],e[1]).value,new Fn(r)}}function J0t(n,t){if(1&n&&(H(),X(0,"circle",10)),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();Le("id","piece_",r,"_",i,""),w("ngClass",s.pieceClasses),z("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function e8t(n,t){if(1&n&&(H(),X(0,"polygon",15)),2&n){const e=C().$implicit,r=C(3).$implicit,s=C(2);xu("transform","rotate(",90*e,")"),w("ngClass",r.lodestone.movingClass),z("points",s.TRIANGLE_OUT)}}function t8t(n,t){if(1&n&&(H(),X(0,"polygon",15)),2&n){const e=C().$implicit,r=C(3).$implicit,s=C(2);xu("transform","rotate(",90*e,")"),w("ngClass",r.lodestone.movingClass),z("points",s.TRIANGLE_IN)}}function n8t(n,t){if(1&n&&(H(),b(0,"g"),x(1,e8t,1,3,"polygon",14),x(2,t8t,1,3,"polygon",14),A()),2&n){const e=C(3).$implicit;T(1),w("ngIf","push"===e.lodestone.direction),T(1),w("ngIf","pull"===e.lodestone.direction)}}const V3e=function(){return[0,1,2,3]};function r8t(n,t){if(1&n&&(H(),b(0,"g",11),X(1,"circle",12)(2,"circle",13),b(3,"g"),x(4,n8t,3,2,"g",1),A()()),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();z("transform",o.getSquareTransform(r,i)),T(1),w("ngClass",s.lodestone.selectedClass),z("r",o.PIECE_RADIUS),T(1),w("ngClass",s.lodestone.pieceClasses),z("r",o.PIECE_RADIUS/4),T(1),xu("transform","rotate(","diagonal"===s.lodestone.orientation?45:0,")"),T(1),w("ngForOf",er(7,V3e))}}function s8t(n,t){if(1&n){const e=Ae();H(),b(0,"g",6),ee("click",function(){de(e);const s=C().$implicit;return le(C(2).selectCoord(s.coord))}),X(1,"rect",7),x(2,J0t,1,6,"circle",8),x(3,r8t,5,8,"g",9),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();Le("id","square_",r,"_",i,""),T(1),w("ngClass",s.squareClasses),z("x",o.SPACE_SIZE*r+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),T(1),w("ngIf",s.hasPiece),T(1),w("ngIf",s.lodestone)}}function i8t(n,t){if(1&n&&(H(),b(0,"g"),x(1,s8t,4,9,"g",5),A()),2&n){const e=t.$implicit;T(1),w("ngIf",!1===e.crumbled)}}function o8t(n,t){if(1&n&&(H(),b(0,"g"),x(1,i8t,2,1,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function a8t(n,t){if(1&n&&(H(),b(0,"g",16),X(1,"circle",17),A()),2&n){const e=t.$implicit,r=t.index,s=C();p1("id","capture_",r,""),z("transform",s.getCaptureTransform(r)),T(1),w("ngClass",e.pieceClasses),z("r",s.PIECE_RADIUS)}}function c8t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"polygon",15),A()),2&n){const e=t.$implicit,r=C().$implicit,s=C();T(1),xu("transform","rotate(",90*e,")"),w("ngClass",r.movingClass),z("points","push"===r.direction?s.TRIANGLE_OUT:s.TRIANGLE_IN)}}function l8t(n,t){if(1&n){const e=Ae();H(),b(0,"g",6),ee("click",function(){const i=de(e).$implicit;return le(C().selectLodestone(i))}),X(1,"circle",12)(2,"circle",13),b(3,"g"),x(4,c8t,2,3,"g",1),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C();Le("id","lodestone_",e.direction,"_",e.orientation,""),z("transform",s.getAvailableLodestoneTransform(r)),T(1),w("ngClass",e.selectedClass),z("r",s.PIECE_RADIUS),T(1),w("ngClass",e.pieceClasses),z("r",s.PIECE_RADIUS/4),T(1),xu("transform","rotate(","diagonal"===e.orientation?45:0,")"),T(1),w("ngForOf",er(9,V3e))}}function u8t(n,t){if(1&n&&(H(),X(0,"circle",10)),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().$implicit,o=C();Le("id","platePiece_",i.position,"_",r,""),w("ngClass",s.pieceClasses),z("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*s.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function f8t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"g",6),ee("click",function(){const s=de(e),i=s.$implicit,o=s.index,c=C().$implicit;return le(C().onPressurePlateClick(i.temporary,c.position,o))}),X(2,"rect",18),x(3,u8t,1,6,"circle",8),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().$implicit,i=C();z("transform",i.getPressurePlateTransform(s.position)),T(1),Le("id","plate_",s.position,"_",r,""),T(1),Le("id","plateSquare_",s.position,"_",r,""),w("ngClass",e.squareClasses),z("x",i.SPACE_SIZE*e.coord.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*e.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e.hasPiece)}}function h8t(n,t){if(1&n&&(H(),b(0,"g",16),x(1,f8t,4,11,"g",1),A()),2&n){const e=t.$implicit;p1("id","pressurePlate_",e.position,""),T(1),w("ngForOf",e.coords)}}function d8t(n,t){if(1&n&&(H(),X(0,"rect",19)),2&n){const e=C();Le("id","selection_",e.viewInfo.selected.get().x,"_",e.viewInfo.selected.get().y,""),z("x",e.SPACE_SIZE*e.viewInfo.selected.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.viewInfo.selected.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}class F2 extends m8{constructor(t){super(t),this.viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:y.empty(),pressurePlateShift:{top:new $t(0,0),left:new $t(0,0),right:new $t(0,0),bottom:new $t(0,0)}},this.stateAfterPlacingLodestone=y.empty(),this.lastInfos=y.empty(),this.capturesToPlace=0,this.selectedCoord=y.empty(),this.selectedLodestone=y.empty(),this.captures={top:0,bottom:0,left:0,right:0},this.rules=H2.get(),this.node=this.rules.getInitialNode(),this.tutorial=(new z3e).tutorial,this.availableMinimaxes=[new Q0t(this.rules,"LodestoneDummyMinimax")],this.encoder=Q4.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const e=.8*this.PIECE_RADIUS,r=.3*this.PIECE_RADIUS,s=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${e},0 ${r},${s} ${r},-${s}`,this.TRIANGLE_IN=`${r},0 ${e},${r} ${e},-${r}`,this.displayedState=this.getState(),this.scores=y.of([0,0])}ngOnInit(){this.updateBoard()}selectCoord(t){var e=this;return I(function*(){const r=e.canUserPlay("#square_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());if(e.capturesToPlace>0)return e.cancelMove(Qh.MUST_PLACE_CAPTURES());const s=H2.get().isTargetLegal(e.getState(),t);return s.isFailure()?e.cancelMove(s.getReason()):e.selectedCoord.equalsValue(t)?(e.cancelMoveAttempt(),R.SUCCESS):(e.selectedCoord=y.of(t),e.selectedLodestone.isPresent()?e.putLodestone():(e.updateViewInfo(),R.SUCCESS))})()}selectLodestone(t){var e=this;return I(function*(){const r=e.canUserPlay("#lodestone_"+t.direction+"_"+t.orientation);if(r.isFailure())return e.cancelMove(r.getReason());We(0===e.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const s=e.getCurrentPlayer(),i=Ko.of(s,t);return e.selectedLodestone.equalsValue(i)?(e.cancelMoveAttempt(),R.SUCCESS):(e.selectedLodestone=y.of(i),e.selectedCoord.isPresent()?e.putLodestone():(e.updateViewInfo(),R.SUCCESS))})()}putLodestone(){var t=this;return I(function*(){We(t.selectedCoord.isPresent(),"coord should have been selected"),We(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=t.getState();We(H2.get().isLegalWithoutCaptures(s,e,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=H2.get().applyMoveWithoutPlacingCaptures(s,e,r);return t.lastInfos=y.of(o),t.capturesToPlace=Math.min(o.captures.length,s.remainingSpaces()),0===t.capturesToPlace?t.applyMove():(t.displayedState=t.displayedState.withBoard(o.board),t.stateAfterPlacingLodestone=y.of(t.displayedState),t.updateViewInfo(),R.SUCCESS)})()}applyMove(){var t=this;return I(function*(){We(t.selectedCoord.isPresent(),"coord should have been selected"),We(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=new Q4(e,r.direction,r.orientation,t.captures);return t.chooseMove(s)})()}onPressurePlateClick(t,e,r){return t?this.deselectPressurePlate(e,r):this.selectPressurePlate(e,r)}selectPressurePlate(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(0===r.capturesToPlace)return r.cancelMove(Qh.NO_CAPTURES_TO_PLACE_YET());r.capturesToPlace--,r.captures[t]++;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Je.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return H2.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new ir(c,i.turn,h,u),0===r.capturesToPlace?r.applyMove():(r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),R.SUCCESS)})()}deselectPressurePlate(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());r.capturesToPlace++,r.captures[t]--;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Je.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return H2.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new ir(c,i.turn,h,u),r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),R.SUCCESS})()}updateBoard(){this.cancelMoveAttempt(),this.scores=y.of(this.getState().getScores())}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=y.empty(),this.lastInfos=y.empty();const t=this.displayedState.lodestones.get(this.getCurrentPlayer());if(t.isPresent()){const e=Je.copyBiArray(this.displayedState.board);e[t.get().y][t.get().x]=ho.EMPTY,this.displayedState=this.displayedState.withBoard(e)}this.selectedCoord=y.empty(),this.selectedLodestone=y.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let t=0;t<ir.SIZE;t++){this.viewInfo.boardInfo.push([]);for(let e=0;e<ir.SIZE;e++){const r=new S(e,t);this.viewInfo.boardInfo[t].push(this.getSquareInfo(r))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:y.empty()}getSquareInfo(t){const e=this.displayedState.getPieceAt(t),r={coord:t,squareClasses:[],crumbled:e.isUnreachable(),hasPiece:e.isPlayerPiece(),pieceClasses:[]};return e.isPlayerPiece()&&(r.pieceClasses=[this.getPlayerClass(e.owner)]),e.isLodestone()&&(r.lodestone={direction:e.direction,pieceClasses:[this.getPlayerClass(e.owner)],selectedClass:"",movingClass:"",orientation:e.orientation},r.lodestone.movingClass=this.getPlayerClass("push"===e.direction?e.owner.getOpponent():e.owner)),r}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const t=this.getState().getCurrentPlayer(),e=this.getState().nextLodestoneDirection();if(e.isPresent()){const r=e.get();this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:r,orientation:"orthogonal"}),this.nextLodestone(t,{direction:r,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"push",orientation:"diagonal"}),this.nextLodestone(t,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const t=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(let e=0;e<this.capturesToPlace;e++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(t)]})}nextLodestone(t,e){const r=Ko.of(t,e),s={direction:r.direction,orientation:r.orientation,pieceClasses:[this.getPlayerClass(r.owner)],movingClass:"",selectedClass:""};return s.movingClass=this.getPlayerClass("push"===r.direction?r.owner.getOpponent():r.owner),this.selectedLodestone.equalsValue(r)&&(s.selectedClass="selected-stroke"),s}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const t of yr.POSITIONS){const e=[],r=this.displayedState.pressurePlates[t];if(r.isPresent()){const s=F2.PRESSURE_PLATES_POSITIONS.get(t).get(),i=r.get().width;let o=5===i?s.startForBigPlate:s.startForSmallPlate;for(let c=0;c<i;c++){o=o.getNext(s.direction);const u=r.get().getPieceAt(c);let h="";u.isPlayerPiece()&&(h=this.getPlayerClass(u.owner)),e.push({coord:o,hasPiece:u.isPlayerPiece(),pieceClasses:[h],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:t,coords:e})}}showLastMove(t){const e=this.getPreviousState();this.lastInfos=y.of(H2.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();const r=this.getState();this.showPressurePlateDifferences(e,r,!1)}showPressurePlateDifferences(t,e,r){for(const s of yr.POSITIONS)this.showPressurePlateDifference(t.pressurePlates[s],e.pressurePlates[s],s,r)}showPressurePlateDifference(t,e,r,s){if(t.isPresent()&&e.isPresent()){const i=t.get(),o=e.get(),c=ge.getNonNullable(this.viewInfo.pressurePlates.find(u=>u.position===r));if(i.width===o.width)for(let u=0;u<o.width;u++){const h=i.getPieceAt(u),g=o.getPieceAt(u);!1===h.equals(g)&&(c.coords[u].squareClasses.push("moved-fill"),c.coords[u].temporary=s,s&&c.coords[u].pieceClasses.push("semi-transparent"))}else for(const u of c.coords)u.squareClasses.push("moved-fill")}}showMovedAndCaptured(t){for(const e of t.moved)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("moved-fill");for(const e of t.captures)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const t=this.displayedState,e=this.getPressurePlateShift(t.pressurePlates.left),r=this.getPressurePlateShift(t.pressurePlates.right),s=this.getPressurePlateShift(t.pressurePlates.top),i=this.getPressurePlateShift(t.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new $t(.5*(e-r),0),this.viewInfo.pressurePlateShift.bottom=new $t(.5*(e-r),0),this.viewInfo.pressurePlateShift.left=new $t(0,.5*(s-i)),this.viewInfo.pressurePlateShift.right=new $t(0,.5*(s-i))}getPressurePlateShift(t){return t.isAbsent()?2:3===t.get().width?1:0}getSquareTransform(t,e){return`translate(${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(t){return`translate(${(t+(ir.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(t){return`translate(${(t+(ir.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(t){return`translate(${this.viewInfo.pressurePlateShift[t].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[t].y*this.SPACE_SIZE})`}}F2.PRESSURE_PLATE_EXTRA_SHIFT=.2,F2.PRESSURE_PLATES_POSITIONS=jn.from({top:{startForBigPlate:new S(.5,-1-F2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new S(1.5,0-F2.PRESSURE_PLATE_EXTRA_SHIFT),direction:be.RIGHT},bottom:{startForBigPlate:new S(.5,8+F2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new S(1.5,7+F2.PRESSURE_PLATE_EXTRA_SHIFT),direction:be.RIGHT},left:{startForBigPlate:new S(-1-F2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new S(0-F2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:be.DOWN},right:{startForBigPlate:new S(8+F2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new S(7+F2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:be.DOWN}}),F2.\u0275fac=function(t){return new(t||F2)(Q(_n))},F2.\u0275cmp=ct({type:F2,selectors:[["app-lodestone"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(t,e){1&t&&(H(),b(0,"svg",0),x(1,o8t,2,1,"g",1),x(2,a8t,2,4,"g",2),x(3,l8t,5,10,"g",3),x(4,h8t,2,2,"g",2),x(5,d8t,1,6,"rect",4),A()),2&t&&(T(1),w("ngForOf",e.viewInfo.boardInfo),T(1),w("ngForOf",e.viewInfo.capturesToPlace),T(1),w("ngForOf",e.viewInfo.availableLodestones),T(1),w("ngForOf",e.viewInfo.pressurePlates),T(1),w("ngIf",e.viewInfo.selected.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let oT=(()=>{class n{}return n.START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`,n.END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`,n.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`,n.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`,n})();class ys extends Hc{constructor(t,e,r){super(t,e),this.calledTheClock=r}static from(t,e,r=!1){if(t.isNotInRange(4,8))return ve.failure(oT.START_COORD_OUT_OF_RANGE());if(e.isNotInRange(4,8))return ve.failure(oT.END_COORD_OUT_OF_RANGE());if(e.equals(t))return ve.failure(Xe.MOVE_CANNOT_BE_STATIC());const s=be.factory.fromDelta(e.x-t.x,e.y-t.y);return s.isFailure()?ve.failure(s.getReason()):ve.success(new ys(t,e,r))}toString(){const t=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+t+")"}equals(t){return!1!==super.equals(t)&&this.calledTheClock===t.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(t){if(t.isAbsent())return!1;const e=t.get();return e.getEnd().equals(this.getStart())&&e.getStart().equals(this.getEnd())}}ys.encoder=Ye.tuple([S.encoder,S.encoder,Ye.identity()],n=>[n.getStart(),n.getEnd(),n.calledTheClock],n=>ys.from(n[0],n[1],n[2]).get());class Ht{constructor(t){this.value=t}static tryMerge(t,e){We(t!==Ht.EMPTY&&e!==Ht.EMPTY,"tryMerge cannot be called with empty pieces");const s=t.value+e.value;return 2===s||3===s?y.of(Ht.of(s)):y.empty()}static of(t){return t===Ht.DRONE.value?Ht.DRONE:(ge.expectToBe(t,Ht.QUEEN.value),Ht.QUEEN)}getValue(){return this.value}equals(t){return this.getValue()===t.getValue()}}Ht.EMPTY=new Ht(0),Ht.PAWN=new Ht(1),Ht.DRONE=new Ht(2),Ht.QUEEN=new Ht(3);class Z5{constructor(t){this.captures=t,t.makeImmutable()}static of(t){const e=new jn;for(const r of t)Z5.addToMap(e,r);return new Z5(e)}static addToMap(t,e){const r=t.get(e);r.isPresent()?t.replace(e,r.get()+1):t.set(e,1)}toValue(){let t=0;return this.captures.forEach(e=>{t+=e.key.getValue()*e.value}),t}add(t){const e=this.captures.getCopy();return Z5.addToMap(e,t),new Z5(e)}}class ei extends xr{constructor(t,e,r=y.empty(),s=y.empty(),i){super(t,e),this.lastMove=r,this.countDown=s,null==i&&(i=new jn([{key:B.ZERO,value:Z5.of([])},{key:B.ONE,value:Z5.of([])}])),i.makeImmutable(),this.captured=i}static getInitialState(){const t=Ht.EMPTY,e=Ht.PAWN,r=Ht.DRONE,s=Ht.QUEEN;return new ei([[s,s,r,t],[s,r,e,t],[r,e,e,t],[t,t,t,t],[t,t,t,t],[t,e,e,r],[t,e,r,s],[t,r,s,s]],0,y.empty())}getPlayerTerritory(t){return t===B.ZERO?ei.PLAYER_ZERO_TERRITORY:ei.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(t){const e=this.getCurrentPlayer(),r=this.getPlayerTerritory(e);for(const s of r)for(let i=0;i<4;i++)if(this.getPieceAtXY(i,s)===t)return!0;return!1}getScoreOf(t){return this.captured.get(t).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(B.ZERO)?y.of(B.ZERO):this.isTerritoryEmpty(B.ONE)?y.of(B.ONE):y.empty()}isTerritoryEmpty(t){const e=this.getPlayerTerritory(t);for(const r of e)for(let s=0;s<4;s++)if(this.getPieceAtXY(s,r)!==Ht.EMPTY)return!1;return!0}isInOpponentTerritory(t){const e=this.getCurrentOpponent();return this.getPlayerTerritory(e).contains(t.y)}isInPlayerTerritory(t){const e=this.getCurrentPlayer();return this.getPlayerTerritory(e).contains(t.y)}getCapturesOf(t){const e=this.captured.get(t).get();return[e.captures.get(Ht.PAWN).getOrElse(0),e.captures.get(Ht.DRONE).getOrElse(0),e.captures.get(Ht.QUEEN).getOrElse(0)]}}ei.PLAYER_ZERO_TERRITORY=new bt([4,5,6,7]),ei.PLAYER_ONE_TERRITORY=new bt([0,1,2,3]);let H3e=(()=>{class n{}return n.YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`,n})();const ce=Ht.EMPTY,B2=Ht.PAWN,O6=Ht.DRONE,T8=Ht.QUEEN,F3e=()=>$localize`This is not a field promotion!`;class B3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,ei.getInitialState()),te.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,ei.getInitialState()),te.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,ei.getInitialState(),ys.from(new S(2,5),new S(1,4)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Ht.PAWN?R.SUCCESS:R.failure($localize`This is not a pawn!`),$localize`Congratulations!`),te.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,ei.getInitialState(),ys.from(new S(1,7),new S(0,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Ht.DRONE?R.SUCCESS:R.failure($localize`This is not a drone!`),$localize`Congratulations!`),te.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new ei([[O6,B2,ce,ce],[T8,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,T8,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[T8,O6,B2,ce]],1),ys.from(new S(2,3),new S(2,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Ht.QUEEN?R.SUCCESS:R.failure($localize`This is not a queen!`),$localize`Congratulations!`),te.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new ei([[O6,B2,B2,ce],[ce,ce,ce,ce],[T8,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,B2,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,O6,B2,ce]],1),[ys.from(new S(0,2),new S(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,H3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),te.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new ei([[ce,ce,ce,T8],[ce,B2,ce,ce],[ce,ce,B2,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,T8],[ce,ce,O6,ce],[ce,B2,ce,ce]],1),[ys.from(new S(1,1),new S(2,2)).get(),ys.from(new S(2,2),new S(1,1)).get()],$localize`Congratulations!`,F3e()),te.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new ei([[B2,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,O6,ce],[ce,B2,ce,ce]],0),ys.from(new S(1,7),new S(2,6)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Ht.QUEEN?R.SUCCESS:R.failure(F3e()),$localize`Congratulations!`),te.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,ei.getInitialState(),ys.from(new S(1,5),new S(0,4),!0).get(),(t,e,r)=>t.calledTheClock?R.SUCCESS:R.failure($localize`You did not call the clock!`),$localize`Congratulations!`),te.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new ei([[ce,ce,ce,ce],[ce,B2,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,B2],[ce,ce,O6,ce],[ce,B2,ce,ce]],15,y.empty(),y.of(1)),[ys.from(new S(1,1),new S(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),te.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new ei([[ce,ce,ce,T8],[ce,B2,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[O6,ce,ce,ce],[ce,ce,ce,ce],[ce,O6,ce,ce]],15,y.empty(),y.of(1)),ys.from(new S(1,1),new S(2,2)).get(),$localize`Congratulations!`),te.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new ei([[ce,ce,ce,T8],[ce,B2,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,B2,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce]],0),ys.from(new S(2,4),new S(1,3)).get(),(t,e,r)=>3===t.getEnd().y?R.SUCCESS:R.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)]}}let aT=(()=>{class n{}return n.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`,n.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`,n.CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`,n})();class G3 extends I1{constructor(){super(ei)}static get(){return G3.singleton.isAbsent()&&(G3.singleton=y.of(new G3)),G3.singleton.get()}applyLegalMove(t,e,r){const s=e.getCopiedBoard();s[t.getStart().y][t.getStart().x]=Ht.EMPTY;const i=r.finalPiece;s[t.getEnd().y][t.getEnd().x]=i;const o=r.score;let c=e.countDown;if(c.isPresent())if(this.isCapture(t,e))c=G3.STARTING_COUNT_DOWN;else{const h=e.countDown.get();c=y.of(h-1)}return t.calledTheClock&&(c=G3.STARTING_COUNT_DOWN),new ei(s,e.turn+1,y.of(t),c,o)}isLegal(t,e){this.assertNonDoubleClockCall(t,e);const r=this.isLegalMove(t,e);if(r.isFailure())return r.toOtherFallible();if(t.isUndoneBy(e.lastMove))return ve.failure(aT.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(t,e))return this.isLegalFieldPromotion(t,e);const s=e.getPieceAt(t.getStart()),i=e.captured.getCopy();if(this.isCapture(t,e)){const c=e.getCurrentPlayer();let u=i.get(c).get();const h=e.getPieceAt(t.getEnd());u=u.add(h),i.replace(c,u),i.makeImmutable()}return ve.success({finalPiece:s,score:i})}assertNonDoubleClockCall(t,e){We(!1===(e.countDown.isPresent()&&t.calledTheClock),"Should not call the clock twice")}isCapture(t,e){const r=e.isInOpponentTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Ht.EMPTY;return r&&s}isFieldPromotion(t,e){const r=e.isInPlayerTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Ht.EMPTY;return r&&s}isLegalFieldPromotion(t,e){const r=this.getPromotedPiece(t,e);if(r.isAbsent())return ve.failure(aT.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const s=r.get();if(e.isTherePieceOnPlayerSide(s))return ve.failure(aT.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const i={finalPiece:s,score:e.captured.getCopy()};return ve.success(i)}}isLegalMove(t,e){if(!1===e.isInPlayerTerritory(t.getStart()))return R.failure(aT.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const s=e.getPieceAt(t.getStart());if(s===Ht.EMPTY)return R.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===Ht.PAWN)return t.isValidForPawn()?R.SUCCESS:R.failure(oT.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(s===Ht.DRONE&&!1===t.isValidForDrone())return R.failure(oT.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const i of t.getStart().getUntil(t.getEnd()))if(e.getPieceAt(i)!==Ht.EMPTY)return R.failure(Xe.SOMETHING_IN_THE_WAY());return R.SUCCESS}getPromotedPiece(t,e){const r=e.getPieceAt(t.getStart()),s=e.getPieceAt(t.getEnd());return Ht.tryMerge(r,s)}getGameStatus(t){const e=t.gameState;if(e.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(e,Ie.DRAW);if(e.getEmptyTerritory().isPresent()){const s=e.getCurrentOpponent(),i=Ie.getVictory(s);return this.getGameStatusScoreVictoryOr(e,i)}return Ie.ONGOING}getGameStatusScoreVictoryOr(t,e){const r=t.getScoreOf(B.ZERO),s=t.getScoreOf(B.ONE);return r>s?Ie.ZERO_WON:s>r?Ie.ONE_WON:e}}G3.STARTING_COUNT_DOWN=y.of(7),G3.singleton=y.empty();class p8t extends ks{constructor(t,e){super(t,e)}getListMoves(t){const e=t.gameState,r=e.getCurrentPlayer(),s=e.getPlayerTerritory(r);let i=[];for(const o of s)for(let c=0;c<4;c++)switch(e.getPieceAtXY(c,o)){case Ht.PAWN:i=i.concat(this.getMovesForPawnAt(e,c,o));break;case Ht.DRONE:i=i.concat(this.getMovesForDroneAt(e,c,o));break;case Ht.QUEEN:i=i.concat(this.getMovesForQueenAt(e,c,o))}return i}getMovesForPawnAt(t,e,r){const s=new S(e,r),i=[];for(const o of be.DIAGONALS){const c=s.getNext(o);c.isInRange(4,8)&&i.push(c)}return this.addLegalMoves(t,s,i)}addLegalMoves(t,e,r){const s=[],i=t.getPieceAt(e),o=!1===t.isTherePieceOnPlayerSide(Ht.DRONE),c=!1===t.isTherePieceOnPlayerSide(Ht.QUEEN),u=t.lastMove;for(const h of r){const g=t.getPieceAt(h);if(g===Ht.EMPTY)this.add(s,ys.from(e,h).get(),u);else if(t.isInPlayerTerritory(h)){const m=Ht.tryMerge(g,i);if(m.isPresent()){const E=m.get(),O=ys.from(e,h).get();(E===Ht.DRONE&&o||E===Ht.QUEEN&&c)&&this.add(s,O,u)}}else this.add(s,ys.from(e,h).get(),u)}return s}add(t,e,r){!1===e.isUndoneBy(r)&&t.push(e)}getMovesForDroneAt(t,e,r){const s=new S(e,r),i=this.getLandingCoordsForLinearMove(s,t,2);return this.addLegalMoves(t,s,i)}getLandingCoordsForLinearMove(t,e,r){const s=[];for(const i of be.DIRECTIONS){let o=1,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(Ht.EMPTY);for(;h;)s.push(c),o++,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(Ht.EMPTY)&&o<r;u.isPresent()&&s.push(c)}return s}getMovesForQueenAt(t,e,r){const s=new S(e,r),i=this.getLandingCoordsForQueen(s,t);return this.addLegalMoves(t,s,i)}getLandingCoordsForQueen(t,e){return this.getLandingCoordsForLinearMove(t,e,8)}getMetrics(t){return[t.gameState.getScoreOf(B.ZERO),t.gameState.getScoreOf(B.ONE)]}}function g8t(n,t){if(1&n&&(H(),X(0,"g",19)),2&n){const e=C(2).index,r=C().index,s=C();T2(s.style),Le("mainShapeId","pawn_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function m8t(n,t){if(1&n&&(H(),X(0,"g",20)),2&n){const e=C(2).index,r=C().index,s=C();T2(s.style),Le("mainShapeId","drone_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function _8t(n,t){if(1&n&&(H(),X(0,"g",21)),2&n){const e=C(2).index,r=C().index,s=C();T2(s.style),Le("mainShapeId","queen_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function v8t(n,t){if(1&n&&(H(),b(0,"g"),x(1,g8t,1,5,"g",16),x(2,m8t,1,5,"g",17),x(3,_8t,1,5,"g",18),A()),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();z("transform",o.getPieceLocation(r,i)),T(1),w("ngIf",s===o.pieces.PAWN),T(1),w("ngIf",s===o.pieces.DRONE),T(1),w("ngIf",s===o.pieces.QUEEN)}}function C8t(n,t){if(1&n){const e=Ae();H(),b(0,"g",14),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),X(1,"rect",15),x(2,v8t,4,4,"g",13),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();Le("id","click_",r,"_",s,""),z("transform",i.getPieceTranslation(s)),T(1),Le("id","square_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e!==i.pieces.EMPTY)}}function y8t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",22),ee("click",function(){const i=de(e).$implicit;return le(C(3).onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C(3);T(1),Le("id","indicator_",e.x,"_",e.y,""),z("transform",r.getPieceTranslation(e.y))("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}function E8t(n,t){if(1&n&&(H(),b(0,"g"),x(1,y8t,2,7,"g",1),A()),2&n){const e=C(2);T(1),w("ngForOf",e.selectedPieceInfo.get().legalLandings)}}function M8t(n,t){if(1&n&&(H(),b(0,"g"),x(1,C8t,3,11,"g",12),x(2,E8t,2,1,"g",13),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",e),T(1),w("ngIf",r.selectedPieceInfo.isPresent())}}function S8t(n,t){if(1&n&&(H(),b(0,"text",23),wt(1),A()),2&n){const e=C();w("ngClass","player"+e.getCurrentPlayer().value)("ngClass",e.getClockCircleClasses()),z("x",.5*e.SPACE_SIZE)("y",.5*e.SPACE_SIZE),T(1),c1(e.countDown.get())}}function P8t(n,t){if(1&n&&(H(),X(0,"polyline",24)),2&n){const e=C();w("ngClass",e.getClockCircleClasses()),z("points",e.clockNeedlesPoints)}}const cT=function(n){return[n]};function T8t(n,t){if(1&n){const e=Ae();H(),dn(0),b(1,"g",27),ee("click",function(){const i=de(e).index;return le(C(2).chooseStyle(i))}),A(),pn()}if(2&n){const e=t.$implicit,r=t.index,s=C(2);T(1),T2(e.style),w("id",e.name)("pieceClasses",I3(5,cT,"player"+s.getCurrentPlayer().value+"-fill")),z("transform","translate(0, "+-(r+1)*s.SPACE_SIZE+")")}}function w8t(n,t){if(1&n&&(H(),b(0,"g",25),X(1,"rect",26),x(2,T8t,2,7,"ng-container",1),A()),2&n){const e=C();T(1),z("x",0)("y",-e.listOfStyles.length*e.SPACE_SIZE)("width",1*e.SPACE_SIZE)("height",e.listOfStyles.length*e.SPACE_SIZE),T(1),w("ngForOf",e.listOfStyles)}}function O8t(n,t){if(1&n&&(H(),b(0,"text",33),wt(1),A()),2&n){const e=C(2).$implicit,r=C().$implicit,s=C();w("ngClass",s.getPlayerClass(r)),z("x",s.SPACE_SIZE/2)("y",s.SPACE_SIZE/2),T(1),c1(e+" x ")}}function b8t(n,t){if(1&n&&(H(),X(0,"g",34)),2&n){const e=C(3).$implicit,r=C();T2(r.style),w("pieceClasses",I3(3,cT,r.getPlayerClass(e)))}}function A8t(n,t){if(1&n&&(H(),X(0,"g",35)),2&n){const e=C(3).$implicit,r=C();T2(r.style),w("pieceClasses",I3(3,cT,r.getPlayerClass(e)))}}function N8t(n,t){if(1&n&&(H(),X(0,"g",36)),2&n){const e=C(3).$implicit,r=C();T2(r.style),w("pieceClasses",I3(3,cT,r.getPlayerClass(e)))}}function I8t(n,t){if(1&n&&(H(),b(0,"g"),x(1,O8t,2,4,"text",29),b(2,"g",28),x(3,b8t,1,5,"g",30),x(4,A8t,1,5,"g",31),x(5,N8t,1,5,"g",32),A()()),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().$implicit,o=C();z("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),T(1),w("ngIf",s>1),T(1),Le("id","piece_",r,"_player_",i.value,""),z("transform","translate("+o.SPACE_SIZE+", 0)"),T(1),w("ngIf",0===r),T(1),w("ngIf",1===r),T(1),w("ngIf",2===r)}}function x8t(n,t){if(1&n&&(H(),b(0,"g"),x(1,I8t,6,8,"g",13),A()),2&n){const e=t.$implicit;T(1),w("ngIf",e>0)}}function k8t(n,t){if(1&n&&(H(),b(0,"g")(1,"g",28),x(2,x8t,2,1,"g",1),A()()),2&n){const e=t.$implicit,r=C();T(1),p1("id","capture_of_player_",e.value,""),z("transform",r.getCapturesTransformation(e)),T(1),w("ngForOf",r.state.getCapturesOf(e))}}let Xo=(()=>{class n extends ao{constructor(e){super(e),this.INDICATOR_SIZE=20,this.HORIZONTAL_CENTER=2*n.SPACE_SIZE,this.VERTICAL_CENTER=4*n.SPACE_SIZE+n.STROKE_WIDTH,this.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,this.UP=-n.STROKE_WIDTH/2,this.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,this.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,this.MartianChessComponent=n,this.style={shape:"Circle",points:"Horizontal Points"},this.pieces=Ht,this.selectedPieceInfo=y.empty(),this.countDown=y.empty(),this.callTheClock=!1,this.displayModePanel=!1,this.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],this.hasAsymmetricBoard=!0,this.rules=G3.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new p8t(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=n.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=ys.encoder,this.tutorial=(new B3e).tutorial,this.scores=y.of([0,0]),this.updateBoard()}static getRegularPolygon(e,r=0){const s=n.getRegularPolygonCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStar(e,r){const s=this.getNPointedStarCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStarCoords(e,r){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;e*=2;for(let c=0;c<e;c++){const h=(c*(360/e)+r)/180*Math.PI,g=c%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,m=i+.8*g*Math.cos(h),E=o+.8*g*Math.sin(h);s.push(new S(m,E))}return s}static getRegularPolygonCoords(e,r=0){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;for(let c=0;c<e;c++){const h=(c*(360/e)-90)/180*Math.PI,g=.5*n.SPACE_SIZE,m=i+.8*g*Math.cos(h),E=o+.8*g*Math.sin(h)+r;s.push(new S(m,E))}return s}static mapCoordsToString(e){let r="";for(const s of e)r+=s.x+", "+s.y+" ";return r}static getRadius(e){return this.SPACE_SIZE*e/10}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const e=this.STROKE_WIDTH,s=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}updateBoard(){this.state=this.getState(),this.board=this.state.board;const e=this.state.getScoreOf(B.ZERO),r=this.state.getScoreOf(B.ONE);this.countDown=this.state.countDown,this.scores=y.of([e,r])}getPieceLocation(e,r){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*r+")"}getPieceClasses(e,r){const s=new S(e,r),i=[];return i.push(r>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&i.push("selected-stroke"),this.node.move.isPresent()&&this.node.move.get().getEnd().equals(s)&&this.getPreviousState().getPieceAt(s)!==Ht.EMPTY&&this.getState().isInOpponentTerritory(new S(0,r))&&i.push("last-move-stroke"),i}onClick(e,r){var s=this;return I(function*(){s.displayModePanel=!1;const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);return s.selectedPieceInfo.isPresent()?s.secondClick(o):s.firstClick(o)})()}firstClick(e){var r=this;return I(function*(){return r.isOneOfUsersPieces(e)?r.selectAsFirstPiece(e):(r.cancelMoveAttempt(),R.SUCCESS)})()}selectAsFirstPiece(e){var r=this;return I(function*(){const s=r.getLegalLandings(e);return r.selectedPieceInfo=y.of({selectedPiece:e,legalLandings:s}),R.SUCCESS})()}getLegalLandings(e){const r=this.state.getPieceAt(e);let s;return s=r===Ht.PAWN?be.DIAGONALS.map(i=>e.getNext(i)):this.getValidLinearLandingSquareUntil(e,r===Ht.DRONE?2:8),s.filter(i=>{const o=ys.from(e,i);return!!o.isSuccess()&&this.rules.isLegal(o.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(e,r){return be.DIRECTIONS.flatMap(s=>{const i=[];let o=e.getNext(s),c=1;for(;o.isInRange(4,8)&&c<=r&&(i.push(o),this.getState().getPieceAt(o)===Ht.EMPTY);)o=o.getNext(s),c++;return i})}secondClick(e){var r=this;return I(function*(){const s=r.selectedPieceInfo.get();if(s.selectedPiece.equals(e))return r.cancelMoveAttempt(),R.SUCCESS;if(s.legalLandings.some(i=>i.equals(e))){const i=ys.from(s.selectedPiece,e,r.callTheClock);return We(i.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),r.chooseMove(i.get())}if(r.isOneOfUsersPieces(e))return r.selectAsFirstPiece(e);{const i=ys.from(s.selectedPiece,e,r.callTheClock);return i.isSuccess()?r.chooseMove(i.get()):r.cancelMove(i.getReason())}})()}isOneOfUsersPieces(e){return this.state.getPieceAt(e)!==Ht.EMPTY&&this.state.isInPlayerTerritory(e)}cancelMoveAttempt(){this.selectedPieceInfo=y.empty(),this.callTheClock=!1}onClockClick(){var e=this;return I(function*(){const r=e.canUserPlay("#clockOrCountDownView");return r.isFailure()?e.cancelMove(r.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),R.SUCCESS)})()}getClockCircleClasses(){const e=["base"];return this.callTheClock&&e.push("selected-stroke"),this.getCurrentPlayer()===B.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}getSquareClasses(e,r){const s=new S(e,r),i=["base"];if(this.node.move.isPresent()){const o=this.node,c=o.move.get();c.getStart().equals(s)?i.push("moved-fill"):c.getEnd().equals(s)&&(o.mother.get().gameState.getPieceAt(s)===Ht.EMPTY||o.gameState.isInOpponentTerritory(new S(0,r))?i.push("moved-fill"):i.push("captured-fill"))}return i}onModeCogClick(){this.displayModePanel=!this.displayModePanel}chooseStyle(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}getPieceTranslation(e){return"translate(0, "+(e<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.role.value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(e){let i=this.SPACE_SIZE/2;return e===this.role&&(i+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+-this.SPACE_SIZE/2+", "+i+")"}}return n.SPACE_SIZE=100,n.STROKE_WIDTH=8,n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-martian-chess"]],features:[l],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,r){1&e&&(H(),b(0,"svg",0)(1,"g"),x(2,M8t,3,2,"g",1),A(),b(3,"g",2),ee("click",function(){return r.onClockClick()}),X(4,"rect",3)(5,"circle",4),x(6,S8t,2,5,"text",5),x(7,P8t,1,2,"polyline",6),A(),b(8,"g",7)(9,"g",8),ee("click",function(){return r.onModeCogClick()}),X(10,"rect",3)(11,"path",9),A(),x(12,w8t,3,5,"g",10),A(),b(13,"g",11),x(14,k8t,3,3,"g",1),A()()),2&e&&(z("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),T(1),z("transform",r.getBoardTransformation()),T(1),w("ngForOf",r.board),T(1),z("transform","translate("+5.25*r.SPACE_SIZE+", 0)"),T(1),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),T(1),w("ngClass",r.getClockCircleClasses()),z("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE)("r",.4*r.SPACE_SIZE),T(1),w("ngIf",r.countDown.isPresent()),T(1),w("ngIf",r.countDown.isAbsent()),T(1),z("transform",r.configViewTranslation),T(2),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),T(1),w("ngClass",r.getPlayerClass(r.getCurrentPlayer())),z("transform",r.configCogTransformation),T(1),w("ngIf",r.displayModePanel),T(2),w("ngForOf",r.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class w8 extends xr{static getInitialState(){const t=Je.createTable(7,6,ue.NONE);return new w8(t,0)}}class H1 extends oo{constructor(t){super(),this.x=t}static of(t){switch(t){case 0:return H1.ZERO;case 1:return H1.ONE;case 2:return H1.TWO;case 3:return H1.THREE;case 4:return H1.FOUR;case 5:return H1.FIVE;case 6:return H1.SIX;default:throw new Error("Invalid P4Move")}}equals(t){return this===t}toString(){return"P4Move("+this.x+")"}}H1.ZERO=new H1(0),H1.ONE=new H1(1),H1.TWO=new H1(2),H1.THREE=new H1(3),H1.FOUR=new H1(4),H1.FIVE=new H1(5),H1.SIX=new H1(6),H1.encoder=Ye.tuple([Ye.identity()],n=>[n.x],n=>H1.of(n[0]));let L8t=(()=>{class n{}return n.COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`,n})();class ti extends I1{constructor(){super(w8)}static get(){return ti.singleton.isAbsent()&&(ti.singleton=y.of(new ti)),ti.singleton.get()}static isInRange(t){return t.isInRange(7,6)}static getVictoriousCoords(t){return ti.P4_HELPER.getVictoriousCoord(t)}static getLowestUnoccupiedSpace(t,e){let r=0;for(;r<6&&t[r][e]===ue.NONE;)r++;return r-1}static getListMoves(t){J(ti.VERBOSE,{context:"P4Rules.getListMoves",node:t});const e=t.gameState,r=[];for(let s=0;s<7;s++)if(e.getPieceAtXY(s,0)===ue.NONE){const i=H1.of(s);r.push(i)}return r}applyLegalMove(t,e,r){const s=t.x,i=e.getCopiedBoard(),o=ti.getLowestUnoccupiedSpace(i,s),c=e.turn;return i[o][s]=e.getCurrentPlayer(),new w8(i,c+1)}isLegal(t,e){return J(ti.VERBOSE,{context:"P4Rules.isLegal",move:t.toString(),state:e}),e.getPieceAtXY(t.x,0).isPlayer()?R.failure(L8t.COLUMN_IS_FULL()):R.SUCCESS}getGameStatus(t){const e=t.gameState;return ti.P4_HELPER.getVictoriousCoord(e).length>0?Ie.getVictory(e.getCurrentOpponent()):42===e.turn?Ie.DRAW:Ie.ONGOING}}ti.VERBOSE=!1,ti.singleton=y.empty(),ti.P4_HELPER=new Wh(ti.isInRange,ge.identity,4);class R8t extends ic{getListMoves(t){return ti.getListMoves(t).sort((e,r)=>Math.abs(e.x-3)-Math.abs(r.x-3))}getBoardValue(t){const e=t.gameState;let r=0;for(let s=0;s<7;s++)for(let i=5;-1!==i&&e.board[i][s].isPlayer();i--){const o=ti.P4_HELPER.getSquareScore(e,new S(s,i));if(mr.getScoreStatus(o)===Pn.VICTORY)return new Fn(o);r+=o}return new Fn(r)}}const Mt=ue.NONE,b6=ue.ZERO,Jh=ue.ONE;class $3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,w8.getInitialState()),te.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,w8.getInitialState(),H1.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),te.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new w8([[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Jh,Mt,Mt,Mt],[Mt,Mt,Mt,Jh,Mt,Mt,Mt],[Mt,Mt,b6,b6,b6,Jh,Mt]],0),[H1.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),te.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new w8([[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,b6,Jh,Mt,Mt],[Mt,Mt,b6,b6,Jh,Mt,Mt],[Mt,b6,Jh,b6,b6,Mt,Mt]],0),[H1.of(3),H1.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}}function D8t(n,t){if(1&n&&(H(),X(0,"circle",8)),2&n){const e=C().index,r=C().index,s=C();w("ngClass",s.getSquareFillClass(e,r)),z("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function z8t(n,t){if(1&n){const e=Ae();H(),b(0,"g",5),ee("click",function(){const i=de(e).index;return le(C(2).onClick(i))}),X(1,"rect",6),x(2,D8t,1,4,"circle",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();p1("id","click_",r,""),T(1),z("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e!==i.EMPTY)}}function V8t(n,t){if(1&n&&(H(),b(0,"g"),x(1,z8t,3,6,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function H8t(n,t){if(1&n&&(H(),X(0,"rect",9)),2&n){const e=C();z("x",e.SPACE_SIZE*e.last.get().x)("y",e.SPACE_SIZE*e.last.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function F8t(n,t){if(1&n&&(H(),X(0,"rect",10)),2&n){const e=t.$implicit,r=C();Le("id","victory_coord_",e.x,"_",e.y,""),z("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let B8t=(()=>{class n extends ao{constructor(e){super(e),this.EMPTY=ue.NONE,this.victoryCoords=[],this.rules=ti.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new R8t(this.rules,"P4Minimax")],this.encoder=H1.encoder,this.tutorial=(new $3e).tutorial,this.updateBoard()}onClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=H1.of(e);return yield r.chooseMove(i)})()}updateBoard(){const e=this.getState();this.victoryCoords=ti.getVictoriousCoords(e),this.board=e.board,this.hideLastMove()}showLastMove(e){const r=this.getState(),s=ti.getLowestUnoccupiedSpace(r.board,e.x)+1;this.last=y.of(new S(e.x,s))}hideLastMove(){this.last=y.empty()}getSquareFillClass(e,r){return[this.getPlayerClass(this.board[r][e])]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-p4"]],features:[l],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,V8t,2,1,"g",1),x(2,H8t,1,4,"rect",2),x(3,F8t,1,6,"rect",3),A()),2&e&&(T(1),w("ngForOf",r.board),T(1),w("ngIf",r.last.isPresent()),T(1),w("ngForOf",r.victoryCoords))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Vs extends ms{constructor(t,e,r,s=!1){super(t,e),this.blockTurned=r,this.turnedClockwise=s,ge.assert(this.coord.isInRange(6,6),"The board is a 6 space wide square, invalid coord: "+this.coord.toString())}static of(t,e,r){return new Vs(t.x,t.y,e,r)}static withRotation(t,e,r,s){return ge.assert(0<=r&&r<=3,"This block does not exist: "+r),new Vs(t,e,y.of(r),s)}static rotationless(t,e){return new Vs(t,e,y.empty())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(t){return!1!==this.coord.equals(t.coord)&&!1!==this.blockTurned.equals(t.blockTurned)&&this.turnedClockwise===t.turnedClockwise}}Vs.encoder=Ye.tuple([S.encoder,y.getEncoder(Ye.identity()),Ye.identity()],n=>[n.coord,n.blockTurned,n.turnedClockwise],n=>Vs.of(n[0],n[1],n[2]));class lT extends ks{getListMoves(t){const e=[],r=t.gameState.neutralBlocks;if(0===t.gameState.turn)return lT.FIRST_TURN_MOVES;const s=this.getLegalDrops(t.gameState);for(const i of s){const o=Vs.rotationless(i.x,i.y),c=t.gameState.applyLegalDrop(o),u=this.getLegalRotations(c,r);for(const g of u)e.push(Vs.withRotation(i.x,i.y,g[0],g[1]));0===c.neutralBlocks.length==0&&e.push(o)}return e}getLegalDrops(t){const e=[];for(let r=0;r<6;r++)for(let s=0;s<6;s++){const i=new S(s,r);t.getPieceAt(i)===ue.NONE&&e.push(i)}return e}getLegalRotations(t,e){const r=0===t.neutralBlocks.length,s=[];for(let i=0;i<4;i++)!1===t.blockIsNeutral(i)&&(e.includes(i)?r&&s.push([i,!0]):s.push([i,!0],[i,!1]));return s}getMetrics(t){return[0,0]}}lT.FIRST_TURN_MOVES=[Vs.rotationless(0,0),Vs.rotationless(1,0),Vs.rotationless(2,0),Vs.rotationless(0,1),Vs.rotationless(1,1),Vs.rotationless(0,2)];let U3e=(()=>{class n{}return n.CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`,n.MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`,n})();class go extends xr{constructor(t,e){super(t,e),this.neutralBlocks=this.getBlocksNeutralities()}static getInitialState(){const t=Je.createTable(6,6,ue.NONE);return new go(t,0)}getBlocksNeutralities(){const t=[];for(let e=0;e<4;e++)this.getBlockNeutrality(e)&&t.push(e);return t}getBlockNeutrality(t){const e=go.getBlockCenter(t),r=this.getPieceAt(e.getNext(be.UP,1)),s=this.getPieceAt(e.getNext(be.UP_LEFT,1));return this.getPieceAt(e.getNext(be.RIGHT,1))===r&&this.getPieceAt(e.getNext(be.DOWN,1))===r&&this.getPieceAt(e.getNext(be.LEFT,1))===r&&this.getPieceAt(e.getNext(be.UP_RIGHT,1))===s&&this.getPieceAt(e.getNext(be.DOWN_RIGHT,1))===s&&this.getPieceAt(e.getNext(be.DOWN_LEFT,1))===s}static getBlockCenter(t){return new S(1+(t%2==0?0:3),1+(t<2?0:3))}applyLegalDrop(t){const e=this.getCopiedBoard();return e[t.coord.y][t.coord.x]=this.getCurrentPlayer(),new go(e,this.turn)}applyLegalMove(t){const e=this.applyLegalDrop(t),r=e.getCopiedBoard();if(t.blockTurned.isPresent()){const i=go.getBlockCenter(t.blockTurned.get()).toVector();if(t.turnedClockwise)for(const o of go.ROTATION_MAP){const c=o[0].getNext(i),u=o[1].getNext(i),h=e.getPieceAt(c);r[u.y][u.x]=h}else for(const o of go.ROTATION_MAP){const c=o[1].getNext(i),u=o[0].getNext(i),h=e.getPieceAt(c);r[u.y][u.x]=h}}return new go(r,this.turn+1)}blockIsNeutral(t){return this.neutralBlocks.includes(t)}}go.ROTATION_MAP=[[new S(-1,-1),new S(1,-1)],[new S(0,-1),new S(1,0)],[new S(1,-1),new S(1,1)],[new S(1,0),new S(0,1)],[new S(1,1),new S(-1,1)],[new S(0,1),new S(-1,0)],[new S(-1,1),new S(-1,-1)],[new S(-1,0),new S(0,-1)]];class J4 extends I1{constructor(){super(go)}static get(){return J4.singleton.isAbsent()&&(J4.singleton=y.of(new J4)),J4.singleton.get()}applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){if(e.getPieceAt(t.coord).isPlayer())return R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE());const r=e.applyLegalDrop(t);if(0===r.neutralBlocks.length){if(t.blockTurned.isAbsent())return R.failure(U3e.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(t.blockTurned.isPresent()){const s=t.blockTurned.get();if(r.neutralBlocks.includes(s))return R.failure(U3e.CANNOT_ROTATE_NEUTRAL_BLOCK())}return R.SUCCESS}getVictoryCoords(t){let e=[];for(const r of J4.VICTORY_SOURCE){const s=t.getPieceAt(r[0]),i=[r[0]];if(s.isPlayer()){let o=r[0].getNext(r[1]),c=!0;for(let u=0;u<3&&c;u++)t.getPieceAt(o)!==s?c=!1:(i.push(o),o=o.getNext(r[1]));if(c&&(t.getPieceAt(o)===s&&(i.push(o),e=e.concat(i)),r[2])){const u=r[0].getPrevious(r[1],1);t.getPieceAt(u)===s&&(i.push(u),e=e.concat(i))}}}return e}getGameStatus(t){const e=t.gameState,r=this.getVictoryCoords(e),s=[!1,!1];for(let i=0;i<r.length;i+=5)s[e.getPieceAt(r[i]).value]=!0;return!0===s[0]?!0===s[1]?Ie.DRAW:Ie.ZERO_WON:!0===s[1]?Ie.ONE_WON:36===e.turn?Ie.DRAW:Ie.ONGOING}}J4.singleton=y.empty(),J4.VICTORY_SOURCE=[[new S(1,0),new $t(1,1),!1],[new S(0,1),new $t(1,1),!1],[new S(4,0),new $t(-1,1),!1],[new S(5,1),new $t(-1,1),!1],[new S(1,1),new $t(1,1),!0],[new S(4,1),new $t(-1,1),!0],[new S(0,1),new $t(0,1),!0],[new S(1,1),new $t(0,1),!0],[new S(2,1),new $t(0,1),!0],[new S(3,1),new $t(0,1),!0],[new S(4,1),new $t(0,1),!0],[new S(5,1),new $t(0,1),!0],[new S(1,0),new $t(1,0),!0],[new S(1,1),new $t(1,0),!0],[new S(1,2),new $t(1,0),!0],[new S(1,3),new $t(1,0),!0],[new S(1,4),new $t(1,0),!0],[new S(1,5),new $t(1,0),!0]];const Qe=ue.NONE,el=ue.ZERO,A6=ue.ONE;class G3e{constructor(){this.tutorial=[te.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,go.getInitialState()),te.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new go([[el,Qe,Qe,el,A6,Qe],[el,A6,Qe,Qe,Qe,Qe],[el,Qe,A6,Qe,Qe,Qe],[el,Qe,Qe,Qe,Qe,A6],[el,Qe,Qe,Qe,A6,Qe],[Qe,Qe,Qe,Qe,Qe,Qe]],10)).withPreviousMove(Vs.withRotation(0,0,0,!1)),te.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new go([[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,el,Qe,Qe,A6,Qe],[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,A6,Qe,Qe,el,Qe],[Qe,Qe,Qe,Qe,Qe,Qe]],10),Vs.rotationless(2,2),(t,e,r)=>t.blockTurned.isPresent()?R.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):R.SUCCESS,$localize`Congratulations!`),te.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new go([[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,el,Qe,Qe,A6,Qe],[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,A6,Qe,Qe,el,Qe],[Qe,Qe,Qe,Qe,Qe,Qe]],10),Vs.withRotation(0,0,0,!0),(t,e,r)=>t.blockTurned.isPresent()?R.SUCCESS:R.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}}function $8t(n,t){if(1&n){const e=Ae();H(),b(0,"circle",12),ee("click",function(){const i=de(e).$implicit,o=C().$implicit,c=C().index,u=C().index;return le(C().onClick(3*c+i,3*u+o))}),A()}if(2&n){const e=t.$implicit,r=C().$implicit,s=C(),i=s.index,o=s.$implicit,c=C(),u=c.index,h=c.$implicit,g=C();Le("id","click_",3*i+e,"_",3*u+r,""),w("ngClass",g.getSquareClasses(3*i+e,3*u+r)),z("cx",o+2*g.STROKE_WIDTH+(e+.5)*g.SPACE_SIZE)("cy",h+2*g.STROKE_WIDTH+(r+.5)*g.SPACE_SIZE)("r",(g.SPACE_SIZE-g.STROKE_WIDTH)/2)}}const q3e=function(){return[0,1,2]};function U8t(n,t){1&n&&(H(),dn(0),x(1,$8t,1,6,"circle",11),pn()),2&n&&(T(1),w("ngForOf",er(1,q3e)))}function G8t(n,t){if(1&n&&(H(),dn(0),X(1,"rect",10),x(2,U8t,2,2,"ng-container",4),pn()),2&n){const e=t.$implicit,r=t.index,s=C(),i=s.index,o=s.$implicit,c=C();T(1),w("ngClass",c.getBlockClasses(r,i)),z("x",c.STROKE_WIDTH+e)("y",c.STROKE_WIDTH+o)("rx",3*c.STROKE_WIDTH)("ry",3*c.STROKE_WIDTH)("width",c.BLOCK_WIDTH)("height",c.BLOCK_WIDTH),T(1),w("ngForOf",er(8,q3e))}}const W3e=function(n){return[0,n]};function q8t(n,t){if(1&n&&(H(),dn(0),x(1,G8t,3,9,"ng-container",4),pn()),2&n){const e=C();T(1),w("ngForOf",I3(1,W3e,e.BLOCK_SEPARATION))}}function W8t(n,t){if(1&n&&(H(),X(0,"circle",13)),2&n){const e=C();Le("id","currentDrop_",e.currentDrop.get().x,"_",e.currentDrop.get().y,""),w("ngClass",e.getPlayerClass(e.getCurrentPlayer())),z("cx",e.getCenter(e.currentDrop.get().x))("cy",e.getCenter(e.currentDrop.get().y))("r",(e.SPACE_SIZE-e.STROKE_WIDTH)/2)}}function j8t(n,t){if(1&n){const e=Ae();H(),b(0,"path",14),ee("click",function(){const i=de(e).$implicit;return le(C().rotate(i))}),A()}if(2&n){const e=t.$implicit,r=C();Le("id","rotate_",e.blockIndex,"_",e.clockwise?"clockwise":"counterclockwise",""),z("d",e.path)("stroke-width",2*r.STROKE_WIDTH)}}function Z8t(n,t){if(1&n&&(H(),X(0,"path",15)),2&n){const e=C();Le("id","last_rotation_",e.lastRotation.get().blockIndex,"_",e.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),z("d",e.lastRotation.get().path)("stroke-width",2*e.STROKE_WIDTH)}}function Y8t(n,t){if(1&n&&(H(),X(0,"circle",16)),2&n){const e=t.$implicit,r=C();Le("id","victoryCoord_",e.x,"_",e.y,""),w("ngClass",r.getSquareClasses(e.x,e.y)),z("cx",r.getCenter(e.x))("cy",r.getCenter(e.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function K8t(n,t){if(1&n){const e=Ae();H(),b(0,"g",17),ee("click",function(){return de(e),le(C().skipRotation())}),X(1,"circle",18)(2,"line",19),A()}if(2&n){const e=C();T(1),z("cx",e.BLOCK_SEPARATION)("cy",e.BLOCK_SEPARATION)("r",.75*e.SPACE_SIZE)("stroke-width",2*e.STROKE_WIDTH),T(1),z("x1",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("y1",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("x2",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("y2",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("stroke-width",2*e.STROKE_WIDTH)}}let X8t=(()=>{class n extends ao{constructor(e){super(e),this.arrows=[],this.victoryCoords=[],this.currentDrop=y.empty(),this.movedBlock=y.empty(),this.lastDrop=y.empty(),this.lastRotation=y.empty(),this.rules=J4.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new lT(this.rules,"PentagoMinimax")],this.encoder=Vs.encoder,this.tutorial=(new G3e).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.lastDrop=y.empty(),this.lastRotation=y.empty()}showLastMove(e){this.cancelMoveAttempt(),this.movedBlock=e.blockTurned;const r=new S(e.coord.x%3-1,e.coord.y%3-1);if(e.blockTurned.isPresent()&&(this.showLastRotation(e),!1===r.equals(new S(0,0))&&this.coordBelongToBlock(e)))return this.showLastDrop(e,r);this.lastDrop=y.of(e.coord)}showLastRotation(e){if(e.blockTurned.isPresent()){const r=e.blockTurned.get(),s=this.ARROWS.filter(i=>i.blockIndex===r&&i.clockwise===e.turnedClockwise)[0];this.lastRotation=y.of(s)}}showLastDrop(e,r){let s;s=e.turnedClockwise?ge.getNonNullable(go.ROTATION_MAP.find(h=>h[0].equals(r)))[1]:ge.getNonNullable(go.ROTATION_MAP.find(h=>h[1].equals(r)))[0];const i=e.blockTurned.get(),u=new S(i%2==0?1:4,i<2?1:4);s=s.getNext(u,1),this.lastDrop=y.of(s)}coordBelongToBlock(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=y.empty(),this.movedBlock=y.empty(),this.lastRotation=y.empty(),this.victoryCoords=[]}generateArrowsCoord(){const e=2*this.BLOCK_SEPARATION,s=this.SPACE_SIZE,i=e-s,o=2*s,c=.5*this.SPACE_SIZE;return[{path:"M "+c+" 0 q  "+s+" -"+s+"  "+o+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+c+" q -"+s+"  "+s+"  0  "+o,blockIndex:0,clockwise:!1},{path:"M "+e+" "+c+" q  "+s+"  "+s+"  0  "+o,blockIndex:1,clockwise:!0},{path:"M "+i+" 0 q -"+s+" -"+s+" -"+o+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+i+" q -"+s+" -"+s+"  0 -"+o,blockIndex:2,clockwise:!0},{path:"M "+c+" "+e+" q  "+s+"  "+s+"  "+o+"  0",blockIndex:2,clockwise:!1},{path:"M "+i+" "+e+" q -"+s+"  "+s+" -"+o+"  0",blockIndex:3,clockwise:!0},{path:"M "+e+" "+i+" q  "+s+" -"+s+"  0 -"+o,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=y.empty(),this.canSkipRotation=!1}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hidePreviousMove(),s.board[r][e].isPlayer())return s.cancelMove(Xe.MUST_LAND_ON_EMPTY_SPACE());const o=Vs.rotationless(e,r),u=s.getState().applyLegalDrop(o);if(4===u.neutralBlocks.length)return s.chooseMove(o);const h=s.rules.getGameStatus(s.node);return s.canSkipRotation=u.neutralBlocks.length>0&&!1===h.isEndGame,s.currentDrop=y.of(new S(e,r)),s.displayArrows(u.neutralBlocks),R.SUCCESS})()}getCenter(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}displayArrows(e){this.arrows=[];for(let r=0;r<4;r++)if(!1===e.includes(r)){const s=this.ARROWS.filter(i=>i.blockIndex===r);this.arrows=this.arrows.concat(s)}}getBlockClasses(e,r){return this.movedBlock.equalsValue(e+2*r)?["last-move-stroke"]:[]}getSquareClasses(e,r){const s=[],i=this.getPlayerClass(this.board[r][e]);return s.push(i),this.lastDrop.equalsValue(new S(e,r))&&s.push("last-move-stroke"),s}rotate(e){var r=this;return I(function*(){const i=r.canUserPlay("#rotate_"+e.blockIndex+"_"+(e.clockwise?"clockwise":"counterclockwise"));if(i.isFailure())return r.cancelMove(i.getReason());const o=r.currentDrop.get(),c=Vs.withRotation(o.x,o.y,e.blockIndex,e.clockwise);return r.chooseMove(c)})()}skipRotation(){var e=this;return I(function*(){const r=e.canUserPlay("#skipRotation");if(r.isFailure())return e.cancelMove(r.getReason());const s=e.currentDrop.get(),i=Vs.rotationless(s.x,s.y);return e.chooseMove(i)})()}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-pentago"]],features:[l],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,r){1&e&&(H(),b(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),A()(),b(4,"defs")(5,"marker",3),X(6,"polygon",2),A()(),x(7,q8t,2,3,"ng-container",4),x(8,W8t,1,6,"circle",5),x(9,j8t,1,4,"path",6),x(10,Z8t,1,4,"path",7),x(11,Y8t,1,7,"circle",8),x(12,K8t,3,9,"g",9),A()),2&e&&(T(7),w("ngForOf",I3(6,W3e,r.BLOCK_SEPARATION)),T(1),w("ngIf",r.currentDrop.isPresent()),T(1),w("ngForOf",r.arrows),T(1),w("ngIf",r.lastRotation.isPresent()),T(1),w("ngForOf",r.victoryCoords),T(1),w("ngIf",r.canSkipRotation))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),q3=(()=>{class n extends xr{constructor(e,r,s){super(e,s),this.captures=r}static getInitialState(){const e=Je.createTable(n.SIZE,n.SIZE,ue.NONE);return e[9][9]=ue.ONE,new n(e,[0,0],0)}}return n.SIZE=19,n})();class t2 extends ms{constructor(t,e){super(t,e)}static isOnBoard(t){return t.isInRange(q3.SIZE,q3.SIZE)}static of(t){return ge.assert(t2.isOnBoard(t),"PenteMove: coord is out of the board"),new t2(t.x,t.y)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}t2.encoder=ms.getEncoder(t2.of);class wa extends I1{constructor(){super(q3)}static get(){return wa.singleton.isAbsent()&&(wa.singleton=y.of(new wa)),wa.singleton.get()}isLegal(t,e){return e.getPieceAt(t.coord).isPlayer()?R.failure(Xe.MUST_CLICK_ON_EMPTY_SQUARE()):R.SUCCESS}applyLegalMove(t,e,r){const s=e.getCurrentPlayer(),i=e.getCopiedBoard();i[t.coord.y][t.coord.x]=s;const o=this.getCaptures(t.coord,e,s);for(const u of o)i[u.y][u.x]=ue.NONE;const c=[e.captures[0],e.captures[1]];return c[s.value]+=o.length,new q3(i,c,e.turn+1)}getCaptures(t,e,r){const s=r.getOpponent(),i=[];for(const o of be.factory.all){const c=t.getNext(o,1),u=t.getNext(o,2),h=t.getNext(o,3);t2.isOnBoard(c)&&e.getPieceAt(c)===s&&t2.isOnBoard(u)&&e.getPieceAt(u)===s&&t2.isOnBoard(h)&&e.getPieceAt(h)===r&&(i.push(c),i.push(u))}return i}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();return e.captures[r.value]>=10||wa.PENTE_HELPER.getVictoriousCoord(e).length>0?Ie.getVictory(r):this.stillHaveEmptySquare(e)?Ie.ONGOING:Ie.DRAW}stillHaveEmptySquare(t){for(let e=0;e<q3.SIZE;e++)for(let r=0;r<q3.SIZE;r++)if(t.board[e][r]===ue.NONE)return!0;return!1}}wa.PENTE_HELPER=new Wh(t2.isOnBoard,ge.identity,5),wa.singleton=y.empty();class Q8t extends ic{getListMoves(t){const r=[];return t.gameState.forEachCoord((s,i)=>{!1===i.isPlayer()&&r.push(t2.of(s))}),r}getBoardValue(t){const e=wa.get().getGameStatus(t);return e.isEndGame?Fn.fromWinner(e.winner):wa.PENTE_HELPER.getBoardValue(t.gameState)}}const v=ue.NONE,tl=ue.ZERO,W3=ue.ONE;class j3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the pieces are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a piece of the second player is in the center location of the board.`,q3.getInitialState()),te.anyMove($localize`Dropping a piece`,$localize`At your turn, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,q3.getInitialState(),t2.of(new S(9,8)),$localize`Congratulations!`),te.fromMove($localize`Capturing`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new q3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,tl,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,W3,tl,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,W3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[0,0],3),[t2.of(new S(9,6))],$localize`Congratulations!`,$localize`Failed. Try again.`),te.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new q3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,W3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,W3,tl,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,W3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[0,0],4),[t2.of(new S(9,7))],$localize`Congratulations!`,$localize`Failed. Try again.`),te.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new q3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,W3,v,v,tl,tl,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,tl,v,tl,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,W3,tl,tl,tl,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,W3,W3,W3,W3,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[8,8],7),[t2.of(new S(9,6)),t2.of(new S(8,9)),t2.of(new S(13,9))],$localize`Congratulations!`,$localize`Failed. Try again.`)]}}function J8t(n,t){if(1&n&&(H(),X(0,"circle",8)),2&n){const e=C().index,r=C().index,s=C();Le("id","piece_",e,"_",r,""),w("ngClass",s.getSpaceClass(e,r)),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function eut(n,t){if(1&n&&(H(),X(0,"circle",12)),2&n){const e=C(2).index,r=C().index,s=C();Le("id","hoshi_",e,"_",r,""),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.1*s.SPACE_SIZE)}}function tut(n,t){if(1&n&&(H(),X(0,"rect",9)(1,"line",10)(2,"line",10),x(3,eut,1,5,"circle",11)),2&n){const e=C().index,r=C().index,s=C();z("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*e)("y",.5*s.SPACE_SIZE*r),T(1),z("x1",.5*s.SPACE_SIZE*e)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),z("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),w("ngIf",s.isHoshi(e,r))}}function nut(n,t){if(1&n){const e=Ae();H(),b(0,"g",5),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),x(1,J8t,1,6,"circle",6),x(2,tut,4,13,"ng-template",null,7,qn),A()}if(2&n){const e=t.$implicit,r=t.index,s=Hn(3);Le("id","click_",r,"_",C().index,""),T(1),w("ngIf",e.isPlayer())("ngIfElse",s)}}function rut(n,t){if(1&n&&(H(),b(0,"g"),x(1,nut,4,4,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function sut(n,t){if(1&n){const e=Ae();H(),b(0,"circle",13),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();Le("id","capture_",e.x,"_",e.y,""),z("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.y)("r",.07*r.SPACE_SIZE)}}let iut=(()=>{class n extends WH{constructor(e){super(e),this.lastMoved=y.empty(),this.victoryCoords=[],this.captured=[],this.scores=y.of([0,0]),this.rules=wa.get(),this.node=this.rules.getInitialNode(),this.encoder=t2.encoder,this.tutorial=(new j3e).tutorial,this.availableMinimaxes=[new Q8t(this.rules,"Alignment")]}updateBoard(){const e=this.getState();this.board=e.board,this.scores=y.of(this.getState().captures),this.victoryCoords=wa.PENTE_HELPER.getVictoriousCoord(e),this.createHoshis(),this.cancelMoveAttempt()}showLastMove(){const e=this.node.move.get();this.lastMoved=y.of(e.coord);const r=this.getCurrentPlayer().getOpponent();this.captured=wa.get().getCaptures(e.coord,this.getPreviousState(),r)}cancelMoveAttempt(){this.lastMoved=y.empty(),this.captured=[]}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);return s.chooseMove(t2.of(o))})()}getSpaceClass(e,r){const s=new S(e,r),i=this.getState().getPieceAt(s),o=[];return o.push(this.getPlayerClass(i)),this.victoryCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),this.lastMoved.equalsValue(s)&&o.push("last-move-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-new-game"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],[1,"captured-fill",3,"id","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),X(1,"rect",1),x(2,rut,2,1,"g",2),x(3,sut,1,5,"circle",3),A()),2&e&&(z("viewBox","0 -3 "+r.board.length*r.SPACE_SIZE*.5+" "+(6+r.board.length*r.SPACE_SIZE*.5)),T(1),z("width",r.board.length*r.SPACE_SIZE*.5)("height",r.board.length*r.SPACE_SIZE*.5),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.captured))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class m_ extends S{constructor(t,e,r){super(t,e),this.z=r}static getCoord3DEncoder(t){return Ye.tuple([Ye.identity(),Ye.identity(),Ye.identity()],e=>[e.x,e.y,e.z],e=>t(e[0],e[1],e[2]))}static of(t,e,r){return new m_(t,e,r)}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(t){return this===t||t.x===this.x&&t.y===this.y&&t.z===this.z}isHigherThan(t){return this.z>t.z}}class Un extends m_{constructor(t,e,r){super(t,e,r),ge.assert(0<=t&&t<=3,`PylosCoord: Invalid X: ${t}.`),ge.assert(0<=e&&e<=3,`PylosCoord: Invalid Y: ${e}.`),ge.assert(0<=r&&r<=3,`PylosCoord: Invalid Z: ${r}.`);const s=4-r;ge.assert(this.isInRange(s,s),this.toString()+" is not in range.")}static of(t,e,r){return new Un(t,e,r)}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const t=this.z-1;return[new Un(this.x,this.y,t),new Un(this.x+1,this.y,t),new Un(this.x,this.y+1,t),new Un(this.x+1,this.y+1,t)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const t=this.z+1,e=new S(this.x-1,this.y-1),r=new S(this.x,this.y-1),s=new S(this.x-1,this.y),i=new S(this.x,this.y),o=4-t;return[e,r,s,i].filter(c=>c.isInRange(o,o)).map(c=>new Un(c.x,c.y,t))}getNextValid(t){const e=new S(this.x,this.y).getNext(t),r=4-this.z;return e.isNotInRange(r,r)?y.empty():y.of(new Un(e.x,e.y,this.z))}}Un.coordEncoder=m_.getCoord3DEncoder(Un.of),Un.optionalEncoder=y.getEncoder(Un.coordEncoder);let O8=(()=>{class n{}return n.MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`,n.SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`,n.CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`,n.CANNOT_CAPTURE=()=>$localize`You cannot capture.`,n.INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`,n.INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`,n})(),Z3e=(()=>{class n{}return n.MUST_CAPTURE_MAXIMUM_TWO_PIECES=()=>$localize`You must capture one or two pieces, not more.`,n})();class rs extends oo{constructor(t,e,r,s){super(),this.startingCoord=t,this.landingCoord=e,this.firstCapture=r,this.secondCapture=s}static ofClimb(t,e,r){const s=y.of(t),i=rs.checkCaptures(r),o=new rs(s,e,i.firstCapture,i.secondCapture);return ge.assert(e.isHigherThan(t),O8.MUST_MOVE_UPWARD()),o}static checkCaptures(t){let e=y.empty(),r=y.empty();if(t.length>0&&(e=y.of(t[0]),t.length>1)){if(t[1].equals(t[0]))throw new Error("PylosMove: should not capture twice same piece.");if(r=y.of(t[1]),t[1].isHigherThan(t[0])&&(e=y.of(t[1]),r=y.of(t[0])),t.length>2)throw new Error(Z3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:e,secondCapture:r}}static ofDrop(t,e){const r=y.empty(),s=rs.checkCaptures(e);return new rs(r,t,s.firstCapture,s.secondCapture)}static changeCapture(t,e){const r=rs.checkCaptures(e);return new rs(t.startingCoord,t.landingCoord,r.firstCapture,r.secondCapture)}static of(t,e,r,s){return new rs(t,e,r,s)}isClimb(){return this.startingCoord.isPresent()}toString(){const t=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),e=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),r=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+t+", "+this.landingCoord.toShortString()+", "+e+", "+r+")"}equals(t){return t===this||!!(this.startingCoord.equals(t.startingCoord)&&this.landingCoord.equals(t.landingCoord)&&this.firstCapture.equals(t.firstCapture)&&this.secondCapture.equals(t.secondCapture))}}rs.encoder=Ye.tuple([Un.optionalEncoder,Un.coordEncoder,Un.optionalEncoder,Un.optionalEncoder],n=>[n.startingCoord,n.landingCoord,n.firstCapture,n.secondCapture],n=>rs.of(n[0],n[1],n[2],n[3]));class j3 extends OP{constructor(t,e){super(e),this.boards=t}static getInitialState(){const t=Je.createTable(4,4,ue.NONE),e=Je.createTable(3,3,ue.NONE),r=Je.createTable(2,2,ue.NONE);return new j3([t,e,r,[[ue.NONE]]],0)}static getLevelRange(t){switch(t){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return ge.expectToBe(t,2),[0,1]}}getPieceAt(t){return this.boards[t.z][t.y][t.x]}applyLegalMove(t,e=!0){const r=[];let s;return r.push({coord:t.landingCoord,value:this.getCurrentPlayer()}),t.startingCoord.isPresent()&&r.push({coord:t.startingCoord.get(),value:ue.NONE}),t.firstCapture.isPresent()&&r.push({coord:t.firstCapture.get(),value:ue.NONE}),t.secondCapture.isPresent()&&r.push({coord:t.secondCapture.get(),value:ue.NONE}),s=e?this.turn+1:this.turn,this.setBoardAtCoords(r,s)}setBoardAtCoords(t,e){const r=[Je.copyBiArray(this.boards[0]),Je.copyBiArray(this.boards[1]),Je.copyBiArray(this.boards[2]),Je.copyBiArray(this.boards[3])];for(const s of t){const i=s.coord;r[i.z][i.y][i.x]=s.value}return new j3(r,e)}isLandable(t){if(this.getPieceAt(t).isPlayer())return!1;if(0===t.z)return!0;const e=t.getLowerPieces();for(const r of e)if(this.getPieceAt(r)===ue.NONE)return!1;return!0}isSupporting(t){if(3===t.z)return!1;const e=t.getHigherCoords();for(const r of e)if(this.getPieceAt(r).isPlayer())return!0;return!1}getPiecesRepartition(){const t={};t[ue.NONE.value]=0,t[B.ZERO.value]=0,t[B.ONE.value]=0;for(let e=0;e<3;e++)for(let r=0;r<4-e;r++)for(let s=0;s<4-e;s++){const i=new Un(s,r,e),o=this.getPieceAt(i);t[o.value]=1+t[o.value]}return t}removePieceAt(t){return this.setBoardAtCoords([{coord:t,value:ue.NONE}],this.turn)}dropCurrentPlayersPieceAt(t){const e={coord:t,value:this.getCurrentPlayer()};return this.setBoardAtCoords([e],this.turn)}getFreeToMoves(){const t=[],e=this.getCurrentPlayer();for(let r=0;r<=2;r++){const s=j3.getLevelRange(r);for(const i of s)for(const o of s){const c=new Un(o,i,r);this.getPieceAt(c).equals(e)&&!1===this.isSupporting(c)&&t.push(c)}}return t}}class Ai extends I1{constructor(){super(j3)}static get(){return Ai.singleton.isAbsent()&&(Ai.singleton=y.of(new Ai)),Ai.singleton.get()}static getStateInfo(t){const e=[],r=[];for(let s=0;s<3;s++)for(let i=0;i<4-s;i++)for(let o=0;o<4-s;o++){const c=new Un(o,i,s);t.getPieceAt(c)===t.getCurrentPlayer()&&!1===t.isSupporting(c)&&e.push(c),t.isLandable(c)&&r.push(c)}return{freeToMove:e,landable:r}}static getClimbingMoves(t){const e=[];for(const r of t.freeToMove)for(const s of t.landable)if(s.isHigherThan(r)&&!1===s.getLowerPieces().some(i=>r.equals(i))){const i=rs.ofClimb(r,s,[]);e.push(i)}return e}static getDropMoves(t){const e=[];for(const r of t.landable){const s=rs.ofDrop(r,[]);e.push(s)}return e}static canCapture(t,e){const r=t.getCurrentPlayer();for(const s of[Be.UP,Be.DOWN]){const i=e.getNextValid(s);if(i.isPresent()&&t.getPieceAt(i.get())===r)for(const o of[Be.LEFT,Be.RIGHT]){const c=i.get().getNextValid(o);if(c.isPresent()&&t.getPieceAt(c.get())===r){const u=s.getOpposite(),h=c.get().getNextValid(u).get();if(t.getPieceAt(h)===r)return!0}}}return!1}static getPossibleCaptures(t){const e=new bt,r=t.getFreeToMoves();for(const s of r){e.add(new bt([s]));const o=t.removePieceAt(s).getFreeToMoves();for(const c of o){const u=new bt([s,c]);e.add(u)}}return e}static applyLegalMove(t,e,r){return e.applyLegalMove(t)}static isValidCapture(t,e,r){const s=t.getCurrentPlayer();return!(!r.equals(e.landingCoord)&&t.getPieceAt(r)!==s)&&0===r.getHigherCoords().filter(o=>t.getPieceAt(o).isPlayer()&&!1===o.equals(e.firstCapture.get())).length}static getGameStatus(t){const r=t.gameState.getPiecesRepartition();return 15===r[B.ZERO.value]?Ie.ONE_WON:15===r[B.ONE.value]?Ie.ZERO_WON:Ie.ONGOING}applyLegalMove(t,e,r){return Ai.applyLegalMove(t,e,r)}isLegal(t,e){const r=this.isLegalStartingCoord(t,e);if(r.isFailure())return r.toOtherFallible();const s=r.get(),i=this.isLegalLandingCoord(t,s);if(i.isFailure())return i.toOtherFallible();const o=i.get(),c=this.isLegalCaptures(t,o);return c.isFailure()?c:R.SUCCESS}isLegalStartingCoord(t,e){const r=e.getCurrentOpponent();if(t.startingCoord.isPresent()){const s=t.startingCoord.get(),i=e.getPieceAt(s);if(i===r)return ve.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===ue.NONE)return ve.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===s.getHigherCoords().filter(c=>e.getPieceAt(c).isPlayer()).length){const c=e.removePieceAt(t.startingCoord.get());return ve.success(c)}return ve.failure(O8.CANNOT_MOVE_SUPPORTING_PIECE())}return ve.success(e)}isLegalLandingCoord(t,e){return e.getPieceAt(t.landingCoord).isPlayer()?ve.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):e.isLandable(t.landingCoord)?ve.success(e.dropCurrentPlayersPieceAt(t.landingCoord)):ve.failure(O8.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(t,e){if(t.firstCapture.isAbsent())return R.SUCCESS;if(!1===Ai.canCapture(e,t.landingCoord))return R.failure(O8.CANNOT_CAPTURE());if(Ai.isValidCapture(e,t,t.firstCapture.get())){const r=e.removePieceAt(t.firstCapture.get());return t.secondCapture.isAbsent()||Ai.isValidCapture(r,t,t.secondCapture.get())?R.SUCCESS:R.failure(O8.INVALID_SECOND_CAPTURE())}return R.failure(O8.INVALID_FIRST_CAPTURE())}getGameStatus(t){return Ai.getGameStatus(t)}}Ai.singleton=y.empty();class __ extends ks{static getListMoves(t){const e=t.gameState,r=[],s=Ai.getStateInfo(e),i=Ai.getClimbingMoves(s),o=Ai.getDropMoves(s),c=i.concat(o);for(const u of c){const h=e.applyLegalMove(u,!1);let g=new bt;Ai.canCapture(h,u.landingCoord)?g=Ai.getPossibleCaptures(h):r.push(u);for(const m of g){const E=rs.changeCapture(u,m.toList());r.push(E)}}return r}getListMoves(t){return __.getListMoves(t)}getMetrics(t){const e=t.gameState.getPiecesRepartition();return[e[B.ZERO.value],e[B.ONE.value]]}}class e9 extends __{static countStoneUsed(t){let e=t.isClimb()?0:1;return t.firstCapture.isPresent()&&(e-=1,t.secondCapture.isPresent()&&(e-=1)),e}static sumMoveEmplacementByValue(t){let e=t.landingCoord.z;return t.startingCoord.isPresent()&&(e+=3-t.startingCoord.get().z),t.firstCapture.isPresent()&&(e+=3-t.firstCapture.get().z,t.secondCapture.isPresent()&&(e+=3-t.secondCapture.get().z)),e}getListMoves(t){const e=__.getListMoves(t);return this.orderMoves(e)}orderMoves(t){return t.sort((e,r)=>{const s=12*e9.countStoneUsed(e),i=12*e9.countStoneUsed(r);return s+e9.sumMoveEmplacementByValue(e)-(i+e9.sumMoveEmplacementByValue(r))})}}const at=ue.NONE,N6=ue.ZERO,Y3e=ue.ONE;class K3e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,j3.getInitialState()),te.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,j3.getInitialState(),rs.ofDrop(new Un(1,1,0),[]),$localize`There you go, as simple as that.`),te.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new j3([[[N6,Y3e,at,at],[Y3e,N6,at,at],[at,at,at,at],[at,at,at,N6]],[[at,at,at],[at,at,at],[at,at,at]],[[at,at],[at,at]],[[at]]],0),[rs.ofClimb(new Un(3,3,0),new Un(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),te.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new j3([[[N6,N6,at,at],[at,N6,at,at],[at,at,at,at],[at,at,at,at]],[[at,at,at],[at,at,at],[at,at,at]],[[at,at],[at,at]],[[at]]],0),[rs.ofDrop(new Un(0,1,0),[new Un(0,0,0)]),rs.ofDrop(new Un(0,1,0),[new Un(0,1,0)]),rs.ofDrop(new Un(0,1,0),[new Un(1,0,0)]),rs.ofDrop(new Un(0,1,0),[new Un(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),te.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new j3([[[N6,N6,at,at],[at,N6,at,at],[at,at,at,at],[at,at,at,at]],[[at,at,at],[at,at,at],[at,at,at]],[[at,at],[at,at]],[[at]]],0),rs.ofDrop(new Un(0,1,0),[new Un(0,0,0),new Un(1,0,0)]),(t,e,r)=>t.secondCapture.isPresent()?R.SUCCESS:t.firstCapture.isPresent()?R.failure($localize`Failed, you only captured one piece.`):R.failure(H3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}}function out(n,t){if(1&n&&(H(),X(0,"circle",8)),2&n){const e=t.$implicit,r=C().$implicit,s=C();Le("id","piece_",r.value,"_",e,""),w("ngClass",s.getPlayerClass(r)),z("cx",s.SPACE_SIZE/4+e/15*(s.boardWidth-s.SPACE_SIZE/4))("cy",s.getPiecesCyForPlayer(r))("r",s.SPACE_SIZE/4-s.STROKE_WIDTH)}}function aut(n,t){if(1&n&&(H(),b(0,"g"),x(1,out,1,6,"circle",7),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",r.getPlayerSidePieces(e))}}function cut(n,t){if(1&n){const e=Ae();H(),b(0,"circle",12),ee("click",function(){de(e);const s=C(2).$implicit,i=C().$implicit,o=C().$implicit;return le(C().onPieceClick(s,i,o))}),A()}if(2&n){const e=C(2).$implicit,r=C().$implicit,s=C().$implicit,i=C();J2("id","piece_",e,"_",r,"_",s,""),w("ngClass",i.getPieceClasses(e,r,s)),z("r",i.getPieceRadius(s)-i.STROKE_WIDTH)("cx",i.getPieceCx(e,r,s))("cy",i.getPieceCy(e,r,s))}}function lut(n,t){if(1&n){const e=Ae();H(),b(0,"rect",12),ee("click",function(){de(e);const s=C(3).$implicit,i=C().$implicit,o=C().$implicit;return le(C().onDrop(s,i,o))}),A()}if(2&n){const e=C(3).$implicit,r=C().$implicit,s=C().$implicit,i=C();J2("id","drop_",e,"_",r,"_",s,""),w("ngClass",i.getSquareClasses(e,r,s)),z("width",2*i.getPieceRadius(s))("height",2*i.getPieceRadius(s))("x",i.getPieceCx(e,r,s)-i.getPieceRadius(s))("y",i.getPieceCy(e,r,s)-i.getPieceRadius(s))}}function uut(n,t){if(1&n&&(H(),x(0,lut,1,8,"rect",13)),2&n){const e=C(2).$implicit,r=C().$implicit,s=C().$implicit;w("ngIf",C().mustDisplayLandingCoord(e,r,s))}}function fut(n,t){if(1&n&&(H(),dn(0),x(1,cut,1,7,"circle",10),x(2,uut,1,1,"ng-template",null,11,qn),pn()),2&n){const e=Hn(3),r=C().$implicit,s=C().$implicit,i=C().$implicit,o=C();T(1),w("ngIf",o.isOccupied(r,s,i))("ngIfElse",e)}}function hut(n,t){if(1&n&&(H(),b(0,"g"),x(1,fut,4,2,"ng-container",9),A()),2&n){const e=t.$implicit,r=C().$implicit,s=C().$implicit,i=C();T(1),w("ngIf",i.mustDraw(e,r,s))}}function dut(n,t){if(1&n&&(H(),b(0,"g"),x(1,hut,2,1,"g",1),A()),2&n){const e=C().$implicit,r=C();T(1),w("ngForOf",r.getLevelRange(e))}}function put(n,t){if(1&n&&(H(),b(0,"g"),x(1,dut,2,1,"g",1),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",r.getLevelRange(e))}}function gut(n,t){if(1&n&&(H(),X(0,"rect",14)),2&n){const e=C();J2("id","highCapture_",e.highCapture.get().x,"_",e.highCapture.get().y,"_",e.highCapture.get().z,""),z("width",2*e.getPieceRadius(e.highCapture.get().z))("height",2*e.getPieceRadius(e.highCapture.get().z))("x",e.getPieceCxByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))("y",e.getPieceCyByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))}}function mut(n,t){if(1&n){const e=Ae();H(),b(0,"g",15),ee("click",function(){return de(e),le(C().validateCapture())}),X(1,"circle",16)(2,"polygon",17),A()}if(2&n){const e=C();z("transform","translate("+4*e.SPACE_SIZE+" "+4*e.SPACE_SIZE+")"),T(1),w("ngClass",e.getCaptureValidationButtonClasses()),z("cx",e.STROKE_WIDTH/2)("cy",e.STROKE_WIDTH/2)("r",e.SPACE_SIZE/2)}}function _ut(n,t){if(1&n){const e=Ae();H(),b(0,"g",18),ee("click",function(){const i=de(e).$implicit;return le(C().onPieceClick(i.x,i.y,i.z))}),X(1,"line",19)(2,"line",19),A()}if(2&n){const e=t.$implicit,r=C();J2("id","capturable_",e.x,"_",e.y,"_",e.z,""),z("transform","translate("+r.getPieceCxByCoord(e)+" "+r.getPieceCyByCoord(e)+")"),T(1),z("x1",-.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z)),T(1),z("x1",.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",-.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z))}}const vut=function(){return[0,1,2]};let Cut=(()=>{class n extends m8{constructor(e){super(e),this.boardWidth=4*this.SPACE_SIZE+this.STROKE_WIDTH,this.pieceRowHeight=this.SPACE_SIZE/2,this.boardHeight=this.boardWidth+2*this.pieceRowHeight,this.lastLandingCoord=y.empty(),this.lastStartingCoord=y.empty(),this.lastFirstCapture=y.empty(),this.lastSecondCapture=y.empty(),this.highCapture=y.empty(),this.capturables=[],this.chosenStartingCoord=y.empty(),this.chosenLandingCoord=y.empty(),this.chosenFirstCapture=y.empty(),this.chosenSecondCapture=y.empty(),this.lastMove=y.empty(),this.remainingPieces={0:15,1:15},this.hasAsymmetricBoard=!0,this.rules=Ai.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new __(this.rules,"PylosMinimax"),new e9(this.rules,"PylosOrderedMinimax")],this.encoder=rs.encoder,this.tutorial=(new K3e).tutorial,this.updateBoard()}getPiecesCyForPlayer(e){return e===B.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(e){return j3.getLevelRange(e)}mustDraw(e,r,s){const i=new Un(e,r,s);return!!(this.constructedState.getPieceAt(i).isPlayer()||this.justClimbed(i)||this.isCaptured(i))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(i)}isCaptured(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}onPieceClick(e,r,s){var i=this;return I(function*(){const o=i.canUserPlay("#piece_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Un(e,r,s);return i.state.getPieceAt(c)===i.state.getCurrentOpponent()?i.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):i.chosenStartingCoord.equalsValue(c)?(i.cancelMoveAttempt(),R.SUCCESS):i.chosenLandingCoord.isPresent()?i.isSupporting(c,i.constructedState)?i.cancelMove(O8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onCaptureClick(c):i.isSupporting(c,i.getState())?i.cancelMove(O8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onClimbClick(c)})()}isSupporting(e,r){return r.isSupporting(e)}onClimbClick(e){var r=this;return I(function*(){return r.chosenStartingCoord=y.of(e),r.constructedState=r.constructedState.removePieceAt(e),R.SUCCESS})()}onCaptureClick(e){var r=this;return I(function*(){return r.chosenFirstCapture.equalsValue(e)?(r.chosenFirstCapture=y.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),R.SUCCESS):r.chosenSecondCapture.equalsValue(e)?(r.chosenSecondCapture=y.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),R.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=y.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),R.SUCCESS):r.chosenSecondCapture.isAbsent()?(r.chosenSecondCapture=y.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),R.SUCCESS):r.cancelMove(Z3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var e=this;return I(function*(){const r=e.canUserPlay("#capture_validation");return r.isFailure()?e.cancelMove(r.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?R.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()])})()}concludeMoveWithCapture(e){var r=this;return I(function*(){if(r.chosenStartingCoord.isAbsent()){const s=rs.ofDrop(r.chosenLandingCoord.get(),e);return r.chooseMove(s)}{const s=rs.ofClimb(r.chosenStartingCoord.get(),r.chosenLandingCoord.get(),e);return r.chooseMove(s)}})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=y.empty(),this.chosenLandingCoord=y.empty(),this.chosenFirstCapture=y.empty(),this.chosenSecondCapture=y.empty(),this.capturables=[]}onDrop(e,r,s){var i=this;return I(function*(){const o=i.canUserPlay("#drop_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Un(e,r,s);return Ai.canCapture(i.constructedState,c)?(i.chosenLandingCoord=y.of(c),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(c),i.updateCapturableList(),R.SUCCESS):(i.chosenLandingCoord=y.of(c),i.concludeMoveWithCapture([]))})()}getSquareClasses(e,r,s){const i=new Un(e,r,s);if(this.lastMove.isPresent()){const o=this.lastMove.get();if(o.firstCapture.equalsValue(i)||o.secondCapture.equalsValue(i))return["captured-fill"];if(i.equals(o.landingCoord)||o.startingCoord.equalsValue(i))return["moved-fill"]}else if(this.justClimbed(i))return["moved-fill"];return[]}justClimbed(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}getPieceRadius(e){return this.SPACE_SIZE*(.45+.025*e)}getPieceCx(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+e*this.SPACE_SIZE}getPieceCy(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+r*this.SPACE_SIZE}getPieceCxByCoord(e){return this.getPieceCx(e.x,e.y,e.z)}getPieceCyByCoord(e){return this.getPieceCy(e.x,e.y,e.z)}isOccupied(e,r,s){const i=new Un(e,r,s);if(this.justClimbed(i))return!1;const o=this.getState().getPieceAt(i).isPlayer(),c=this.chosenLandingCoord.equalsValue(i);return o||c}getPieceClasses(e,r,s){const i=new Un(e,r,s),o=[this.getPieceFillClass(i)];return(this.lastLandingCoord.equalsValue(i)||this.lastStartingCoord.equalsValue(i))&&o.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(i)||this.chosenLandingCoord.equalsValue(i))&&o.push("selected-stroke"),this.isCaptured(i)&&o.push("pre-captured-fill"),o}getPieceFillClass(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}getPlayerSidePieces(e){const r=this.remainingPieces[e.value],s=[];for(let i=0;i<r;i++)s.push(i);return s}updateBoard(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.node.move;const e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=y.empty(),this.cancelMoveAttempt(),this.hideLastMove()}showLastMove(e){this.lastLandingCoord=y.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}hideLastMove(){this.lastStartingCoord=y.empty(),this.lastLandingCoord=y.empty(),this.lastFirstCapture=y.empty(),this.lastSecondCapture=y.empty()}mustDrawCoord(e){return this.mustDraw(e.x,e.y,e.z)}mustDisplayLandingCoord(e,r,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new Un(e,r,s))||this.chosenStartingCoord.get().z<s}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-pylos"]],features:[l],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(e,r){1&e&&(H(),b(0,"svg",0)(1,"g"),x(2,aut,2,1,"g",1),A(),b(3,"g",null,2),X(5,"rect",3),x(6,put,2,1,"g",1),x(7,gut,1,7,"rect",4),x(8,mut,3,5,"g",5),x(9,_ut,3,12,"g",6),A()()),2&e&&(z("viewBox","0 0 "+r.boardWidth+" "+r.boardHeight),T(1),z("transform","rotate("+180*r.role.value+" "+r.boardWidth/2+" "+r.boardHeight/2+")"),T(1),w("ngForOf",r.Player.PLAYERS),T(1),z("transform","translate("+r.STROKE_WIDTH/2+" "+(r.STROKE_WIDTH/2+r.pieceRowHeight)+")"),T(2),z("width",4*r.SPACE_SIZE)("height",4*r.SPACE_SIZE),T(1),w("ngForOf",er(10,vut)),T(1),w("ngIf",r.highCapture.isPresent()),T(1),w("ngIf",r.chosenLandingCoord.isPresent()),T(1),w("ngForOf",r.capturables))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ke{constructor(t){this.value=t}static ofInt(t){if(0<=t&&t<=15)return Ke.pieces[t];if(16===t)return Ke.EMPTY;throw new Error("Invalid piece ("+t+")")}equals(t){return this===t}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}Ke.AAAA=new Ke(0),Ke.AAAB=new Ke(1),Ke.AABA=new Ke(2),Ke.AABB=new Ke(3),Ke.ABAA=new Ke(4),Ke.ABAB=new Ke(5),Ke.ABBA=new Ke(6),Ke.ABBB=new Ke(7),Ke.BAAA=new Ke(8),Ke.BAAB=new Ke(9),Ke.BABA=new Ke(10),Ke.BABB=new Ke(11),Ke.BBAA=new Ke(12),Ke.BBAB=new Ke(13),Ke.BBBA=new Ke(14),Ke.BBBB=new Ke(15),Ke.EMPTY=new Ke(16),Ke.pieces=[Ke.AAAA,Ke.AAAB,Ke.AABA,Ke.AABB,Ke.ABAA,Ke.ABAB,Ke.ABBA,Ke.ABBB,Ke.BAAA,Ke.BAAB,Ke.BABA,Ke.BABB,Ke.BBAA,Ke.BBAB,Ke.BBBA,Ke.BBBB],Ke.encoder=Ye.fromFunctions(n=>n.value,Ke.ofInt);class nl extends ms{constructor(t,e,r){super(t,e),this.piece=r}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(t){return this===t||!1!==t.coord.equals(this.coord)&&this.piece===t.piece}}nl.encoder=Ye.tuple([S.encoder,Ke.encoder],n=>[n.coord,n.piece],n=>new nl(n[0].x,n[0].y,n[1]));class Z3 extends xr{constructor(t,e,r){super(t,e),this.pieceInHand=r}static getInitialState(){const t=Je.createTable(4,4,Ke.EMPTY);return new Z3(t,0,Ke.AAAA)}static isGivable(t,e,r){return t!==r&&!1===Z3.isAlreadyOnBoard(t,e)}static isAlreadyOnBoard(t,e){for(let r=0;r<4;r++)for(let s=0;s<4;s++)if(e[r][s]===t)return!0;return!1}getRemainingPieces(){const t=Ke.pieces,e=[];for(const r of t)Z3.isGivable(r,this.board,this.pieceInHand)&&e.push(r);return e}}let rF=(()=>{class n{}return n.MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`,n.PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`,n.CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`,n})();class v_{constructor(t){this.subCriterion=[y.empty(),y.empty(),y.empty(),y.empty()],this.subCriterion[0]=y.of(8==(8&t.value)),this.subCriterion[1]=y.of(4==(4&t.value)),this.subCriterion[2]=y.of(2==(2&t.value)),this.subCriterion[3]=y.of(1==(1&t.value))}mergeWith(t){let e=4;for(let r=0;r<4;r++)!1===this.subCriterion[r].equals(t.subCriterion[r])&&(this.subCriterion[r]=y.empty()),this.subCriterion[r].isAbsent()&&e--;return e>0}mergeWithQuartoPiece(t){const e=new v_(t);return this.mergeWith(e)}areAllAbsent(){for(let t=0;t<4;t++)if(this.subCriterion[t].isPresent())return!1;return!0}match(t){for(let e=0;e<4;e++)if(this.subCriterion[e].equals(t.subCriterion[e]))return!0;return!1}matchPiece(t){return this.match(new v_(t))}toString(){return"Criterion{"+this.subCriterion.map(t=>t.isPresent()?t.get()?"1":"0":"x").join(" ")+"}"}}class rl{constructor(t,e){this.initialCoord=t,this.direction=e}allCoords(){const t=[];for(let e=0;e<4;e++)t.push(this.initialCoord.getNext(this.direction,e));return t}}class Dr extends I1{constructor(){super(Z3)}static get(){return Dr.singleton.isAbsent()&&(Dr.singleton=y.of(new Dr)),Dr.singleton.get()}static isOccupied(t){return t!==Ke.EMPTY}static isLegal(t,e){const r=t.coord.x,s=t.coord.y,i=t.piece,o=e.getCopiedBoard(),c=e.pieceInHand;return Dr.isOccupied(o[s][r])?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):i===Ke.EMPTY?15===e.turn?R.SUCCESS:R.failure(rF.MUST_GIVE_A_PIECE()):Z3.isAlreadyOnBoard(i,o)?R.failure(rF.PIECE_ALREADY_ON_BOARD()):c===i?R.failure(rF.CANNOT_GIVE_PIECE_IN_HAND()):R.SUCCESS}isLegal(t,e){return Dr.isLegal(t,e)}applyLegalMove(t,e,r){const s=e.getCopiedBoard();return s[t.coord.y][t.coord.x]=e.pieceInHand,new Z3(s,e.turn+1,t.piece)}static updateBoardStatus(t,e,r){return r.score===Pn.PRE_VICTORY?this.isThereAVictoriousLine(t,e)?{score:Pn.VICTORY,sensitiveSquares:new kr}:r:this.searchForVictoryOrPreVictoryInLine(t,e,r)}static isThereAVictoriousLine(t,e){let r=t.initialCoord,s=e.getPieceAt(r);const i=new v_(s);for(let o=0;o<3&&!1!==Dr.isOccupied(s)&&!i.areAllAbsent();o++)r=r.getNext(t.direction,1),s=e.getPieceAt(r),i.mergeWithQuartoPiece(s);return!(!Dr.isOccupied(s)||i.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(t,e,r){const s=Dr.getLineInfos(t,e,r);if(s.boardStatus.isPresent())return s.boardStatus.get();const i=s.commonCriterion,o=s.sensitiveCoord;if(i.isPresent()&&!1===i.get().areAllAbsent()){if(o.isAbsent())return{score:Pn.VICTORY,sensitiveSquares:new kr};{i.get().matchPiece(e.pieceInHand)&&(r.score=Pn.PRE_VICTORY);const c=o.get();r.sensitiveSquares.add(c)}}return r}static getLineInfos(t,e,r){let s=y.empty(),i=y.empty(),o=t.initialCoord;for(let c=0;c<4;c++){const u=e.getPieceAt(o);if(u===Ke.EMPTY){if(!s.isAbsent())return{sensitiveCoord:y.of(o),commonCriterion:i,boardStatus:y.of(r)};s=y.of(o)}else i.isAbsent()?(i=y.of(new v_(u)),J(Dr.VERBOSE,"set commonCrit to "+i.toString())):(i.get().mergeWithQuartoPiece(u),J(Dr.VERBOSE,"update commonCrit: "+i.toString()));o=o.getNext(t.direction,1)}return{commonCriterion:i,sensitiveCoord:s,boardStatus:y.empty()}}static scoreToGameStatus(t,e){const r=B.of(e%2);return t===Pn.VICTORY?Ie.getDefeat(r):16===e?Ie.DRAW:Ie.ONGOING}getGameStatus(t){const e=t.gameState;let r={score:Pn.DEFAULT,sensitiveSquares:new kr};for(const s of Dr.lines)if(r=Dr.updateBoardStatus(s,e,r),r.score===Pn.VICTORY)return Dr.scoreToGameStatus(r.score,e.turn);return Dr.scoreToGameStatus(r.score,e.turn)}getVictoriousCoords(t){for(const e of Dr.lines)if(Dr.isThereAVictoriousLine(e,t))return e.allCoords();return[]}}Dr.VERBOSE=!1,Dr.singleton=y.empty(),Dr.lines=[new rl(new S(0,0),be.DOWN),new rl(new S(1,0),be.DOWN),new rl(new S(2,0),be.DOWN),new rl(new S(3,0),be.DOWN),new rl(new S(0,0),be.RIGHT),new rl(new S(0,1),be.RIGHT),new rl(new S(0,2),be.RIGHT),new rl(new S(0,3),be.RIGHT),new rl(new S(0,0),be.DOWN_RIGHT),new rl(new S(0,3),be.UP_RIGHT)];class sF extends ic{static scoreToBoardValue(t,e){if(t===Pn.DEFAULT)return new Fn(0);{const r=B.of(e%2);return new Fn(t===Pn.PRE_VICTORY?r.getPreVictory():r.getDefeatValue())}}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getRemainingPieces(),o=r.pieceInHand;let c;for(let u=0;u<4;u++)for(let h=0;h<4;h++)if(s[u][h]===Ke.EMPTY){if(c=r.getCopiedBoard(),c[u][h]=o,15===r.turn){const g=new nl(h,u,Ke.EMPTY);return e.push(g),e}for(const g of i){const m=new nl(h,u,g);e.push(m)}}return e}getBoardValue(t){const e=t.gameState;let r={score:Pn.DEFAULT,sensitiveSquares:new kr};for(const s of Dr.lines)if(r=Dr.updateBoardStatus(s,e,r),r.score===Pn.VICTORY)break;return sF.scoreToBoardValue(r.score,e.turn)}}const yut=Ke.AABA,Eut=Ke.AABB,X3e=Ke.ABAA,Mut=Ke.ABAB,Sut=Ke.ABBA,Q3e=Ke.BAAA,Put=Ke.BAAB,Tut=Ke.BABB,J3e=Ke.BBAA,wut=Ke.BBAB,iF=Ke.BBBA,Out=Ke.BBBB,F1=Ke.EMPTY;class e4e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new Z3([[iF,J3e,X3e,yut],[F1,F1,F1,F1],[F1,F1,F1,F1],[F1,F1,F1,F1]],7,Ke.ABAB)),te.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new Z3([[iF,Eut,Sut,F1],[F1,F1,F1,F1],[F1,Q3e,F1,F1],[F1,F1,F1,F1]],7,Ke.ABAA),new nl(2,2,Ke.BAAB),$localize`Perfect!`),te.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new Z3([[Out,iF,wut,F1],[X3e,Tut,J3e,F1],[Mut,Q3e,Put,F1],[F1,F1,F1,F1]],7,Ke.AABA),[new nl(3,3,Ke.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)]}}function but(n,t){if(1&n&&(H(),X(0,"rect",12)),2&n){const e=C(2),r=e.$implicit,s=e.index,i=C().index,o=C();w("ngClass",o.getPieceClasses(r.value)),z("x",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function Aut(n,t){if(1&n&&(H(),X(0,"circle",12)),2&n){const e=C(2),r=e.$implicit,s=e.index,i=C().index,o=C();w("ngClass",o.getPieceClasses(r.value)),z("cx",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function Nut(n,t){if(1&n&&(H(),X(0,"circle")),2&n){const e=C(2).index,r=C().index,s=C();z("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function Iut(n,t){if(1&n&&(H(),b(0,"g"),x(1,but,1,5,"rect",10),x(2,Aut,1,4,"ng-template",null,11,qn),x(4,Nut,1,3,"circle",7),A()),2&n){const e=Hn(3),r=C().$implicit,s=C(2);T(1),w("ngIf",r.isRectangle())("ngIfElse",e),T(3),w("ngIf",s.pieceHasDot(r.value))}}function xut(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",9),ee("click",function(){const i=de(e).index,o=C().index;return le(C().chooseCoord(i,o))}),A(),x(2,Iut,5,3,"g",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Le("id","chooseCoord_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e!==i.EMPTY)}}function kut(n,t){if(1&n&&(H(),b(0,"g",null,8),x(2,xut,3,8,"g",2),A()),2&n){const e=t.$implicit;T(2),w("ngForOf",e)}}function Lut(n,t){if(1&n&&(H(),X(0,"rect",17)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),z("x",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("y",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function Rut(n,t){if(1&n&&(H(),X(0,"circle",12)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),z("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",e.getPieceSize(e.pieceInHand.value))}}function Dut(n,t){if(1&n&&(H(),X(0,"circle")),2&n){const e=C(2);z("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",10)}}function zut(n,t){if(1&n){const e=Ae();H(),b(0,"g",13,14),ee("click",function(){return de(e),le(C().deselectDroppedPiece())}),X(2,"rect",15),x(3,Lut,1,5,"rect",16),x(4,Rut,1,4,"ng-template",null,11,qn),x(6,Dut,1,3,"circle",7),A()}if(2&n){const e=Hn(5),r=C();Le("id","droppedPiece_",r.chosen.get().x,"_",r.chosen.get().y,""),z("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),T(2),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),T(1),w("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),T(3),w("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Vut(n,t){if(1&n&&(H(),b(0,"g",null,18),X(2,"rect",19),A()),2&n){const e=t.$implicit,r=C();T(2),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+e.x*r.SPACE_SIZE+" "+e.y*r.SPACE_SIZE+")")}}function Hut(n,t){if(1&n&&(H(),X(0,"rect",12)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),z("x",0)("y",.75*e.SPACE_SIZE)("transform","translate("+-e.getPieceSize(e.pieceInHand.value)+", "+-e.getPieceSize(e.pieceInHand.value)+")")("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function Fut(n,t){if(1&n&&(H(),X(0,"circle",21)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),z("cy",.75*e.SPACE_SIZE)("r",e.getPieceSize(e.pieceInHand.value))}}function But(n,t){1&n&&(H(),X(0,"circle",22)),2&n&&z("cy",.75*C(2).SPACE_SIZE)("r",10)}function $ut(n,t){if(1&n&&(H(),b(0,"g"),x(1,Hut,1,6,"rect",10),x(2,Fut,1,3,"ng-template",null,11,qn),x(4,But,1,2,"circle",20),A()),2&n){const e=Hn(3),r=C();T(1),w("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),T(3),w("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Uut(n,t){if(1&n&&(H(),X(0,"rect",27)),2&n){const e=C(2).index,r=C().index,s=C();p1("id","chosenPiece_",4*r+e,""),z("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)}}function Gut(n,t){if(1&n&&(H(),X(0,"rect",12)),2&n){const e=C(2).index,r=C().index,s=C();w("ngClass",s.getPieceClasses(4*r+e)),z("x",s.SPACE_SIZE*e+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("y",s.SPACE_SIZE*r+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("width",2*s.getPieceSize(4*r+e))("height",2*s.getPieceSize(4*r+e))}}function qut(n,t){if(1&n&&(H(),X(0,"circle",12)),2&n){const e=C(2).index,r=C().index,s=C();w("ngClass",s.getPieceClasses(4*r+e)),z("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.getPieceSize(4*r+e))}}function Wut(n,t){if(1&n&&(H(),X(0,"circle")),2&n){const e=C(2).index,r=C().index,s=C();z("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function jut(n,t){if(1&n){const e=Ae();H(),b(0,"g",13),ee("click",function(){de(e);const s=C().index,i=C().index;return le(C().choosePiece(4*i+s))}),x(1,Uut,1,5,"rect",26),x(2,Gut,1,5,"rect",10),x(3,qut,1,4,"ng-template",null,11,qn),x(5,Wut,1,3,"circle",7),A()}if(2&n){const e=Hn(4),r=C().index,s=C().index,i=C();p1("id","choosePiece_",4*s+r,""),T(1),w("ngIf",i.pieceToGive.equalsValue(i.QuartoPiece.ofInt(4*s+r))),T(1),w("ngIf",(4*s+r)%4<2)("ngIfElse",e),T(3),w("ngIf",i.pieceHasDot(4*s+r))}}function Zut(n,t){if(1&n&&(H(),b(0,"g"),x(1,jut,6,5,"g",3),A()),2&n){const e=t.index,r=C().index,s=C();T(1),w("ngIf",s.isRemaining(4*r+e))}}function Yut(n,t){if(1&n&&(H(),b(0,"g",null,23),X(2,"rect",24,25),x(4,Zut,2,1,"g",2),A()),2&n){const e=t.$implicit,r=C();z("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),T(2),z("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),T(2),w("ngForOf",e)}}let Kut=(()=>{class n extends ao{constructor(e){super(e),this.EMPTY=Ke.EMPTY,this.QuartoPiece=Ke,this.chosen=y.empty(),this.lastMove=y.empty(),this.pieceInHand=Ke.EMPTY,this.pieceToGive=y.empty(),this.victoriousCoords=[],this.rules=Dr.get(),this.node=this.rules.getInitialNode(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new sF(this.rules,"QuartoMinimax")],this.encoder=nl.encoder,this.tutorial=(new e4e).tutorial,this.pieceInHand=this.getState().pieceInHand,this.updateBoard()}updateBoard(){const e=this.getState(),r=this.node.move;this.board=e.getCopiedBoard(),this.chosen=y.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=r.map(s=>s.coord)}chooseCoord(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#chooseCoord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hideLastMove(),s.board[r][e]===Ke.EMPTY){if(s.showPieceInHandOnBoard(e,r),15===s.getState().turn){const o=new nl(e,r,Ke.EMPTY);return s.chooseMove(o)}if(s.pieceToGive.isAbsent())return R.SUCCESS;{const o=new nl(e,r,s.pieceToGive.get());return s.chooseMove(o)}}return s.cancelMove(Xe.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(e){var r=this;return I(function*(){const s=r.canUserPlay("#choosePiece_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.hideLastMove(),r.pieceToGive.equalsValue(Ke.ofInt(e)))return r.cancelMoveAttempt(),R.SUCCESS;if(r.pieceToGive=y.of(Ke.ofInt(e)),r.chosen.isAbsent())return R.SUCCESS;{const i=r.chosen.get(),o=new nl(i.x,i.y,r.pieceToGive.get());return r.chooseMove(o)}})()}hideLastMove(){this.lastMove=y.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=y.empty(),this.chosen=y.empty()}deselectDroppedPiece(){const e=this.chosen.getOrElse(new S(404,404)),s=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return s.isFailure()?this.cancelMove(s.getReason()):(this.cancelMoveAttempt(),R.SUCCESS)}showPieceInHandOnBoard(e,r){this.chosen=y.of(new S(e,r))}isRemaining(e){return Z3.isGivable(Ke.ofInt(e),this.board,this.pieceInHand)}getSquareClasses(e,r){const s=new S(e,r);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(e){const r=[];return r.push(e%2==0?"player0-fill":"player1-fill"),r}getPieceSize(e){return e<8?40:25}pieceHasDot(e){return e!==Ke.EMPTY.value&&e%8<4}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-quarto"]],features:[l],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(e,r){1&e&&(H(),b(0,"svg",0)(1,"g",1),x(2,kut,3,1,"g",2),x(3,zut,7,8,"g",3),x(4,Vut,3,3,"g",2),b(5,"g",null,4),X(7,"rect",5,6),x(9,$ut,5,3,"g",7),A(),x(10,Yut,5,6,"g",2),A()()),2&e&&(z("viewBox","0 0 "+4.25*r.SPACE_SIZE+" "+10.75*r.SPACE_SIZE),T(2),w("ngForOf",r.board),T(1),w("ngIf",r.chosen.isPresent()),T(1),w("ngForOf",r.victoriousCoords),T(1),z("transform","translate("+2*r.SPACE_SIZE+", "+4.5*r.SPACE_SIZE+")"),T(2),z("width",1.5*r.SPACE_SIZE)("height",1.5*r.SPACE_SIZE)("transform","translate("+-.75*r.SPACE_SIZE+", 0)"),T(2),w("ngIf",r.chosen.isAbsent()),T(1),w("ngForOf",r.board))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Xut=(()=>{class n{}return n.NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`,n})();class fc extends ms{constructor(t,e,r){super(t,e),this.direction=r;const s=fc.isValidCoord(this.coord);if(s.isFailure())throw new Error(s.getReason());if(0===t&&r===Be.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===t&&r===Be.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===e&&r===Be.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===e&&r===Be.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}static isInRange(t){return t.isInRange(5,5)}static isValidCoord(t){return!1===fc.isInRange(t)?R.failure("Invalid coord for QuixoMove: "+t.toString()+" is outside the board."):0!==t.x&&4!==t.x&&0!==t.y&&4!==t.y?R.failure(Xut.NO_INSIDE_CLICK()):R.SUCCESS}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(t){return t===this||!!t.coord.equals(this.coord)&&t.direction===this.direction}}fc.encoder=Ye.tuple([S.encoder,Be.encoder],n=>[n.coord,n.direction],n=>new fc(n[0].x,n[0].y,n[1]));class Y5 extends xr{static getInitialState(){const t=Je.createTable(5,5,ue.NONE);return new Y5(t,0)}applyLegalMove(t){const e=this.getCopiedBoard(),r=this.turn+1;let s=t.coord,i=t.coord.getNext(t.direction);for(;fc.isInRange(i);)e[s.y][s.x]=e[i.y][i.x],s=s.getNext(t.direction),i=i.getNext(t.direction);return e[s.y][s.x]=this.getCurrentPlayer(),new Y5(e,r)}}class n2 extends I1{constructor(){super(Y5)}static get(){return n2.singleton.isAbsent()&&(n2.singleton=y.of(new n2)),n2.singleton.get()}static getVerticalCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=0;s<5;s++)t.gameState.getPieceAtXY(0,s)!==e&&r.push(new S(0,s)),t.gameState.getPieceAtXY(4,s)!==e&&r.push(new S(4,s));return r}static getHorizontalCenterCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=1;s<4;s++)t.gameState.getPieceAtXY(s,0)!==e&&r.push(new S(s,0)),t.gameState.getPieceAtXY(s,4)!==e&&r.push(new S(s,4));return r}static getPossibleDirections(t){const e=[];return 0!==t.x&&e.push(Be.LEFT),0!==t.y&&e.push(Be.UP),4!==t.x&&e.push(Be.RIGHT),4!==t.y&&e.push(Be.DOWN),e}static getLinesSums(t){const e={};e[B.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},e[B.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(let r=0;r<5;r++)for(let s=0;s<5;s++){const i=t.getPieceAtXY(s,r);if(i.isPlayer()){const o=i.value;e[o].columns[s]=e[o].columns[s]+1,e[o].rows[r]=e[o].rows[r]+1,s===r&&(e[o].diagonals[0]=e[o].diagonals[0]+1),s+r===4&&(e[o].diagonals[1]=e[o].diagonals[1]+1)}}return e}static getVictoriousCoords(t){return n2.QUIXO_HELPER.getVictoriousCoord(t)}static getFullestLine(t){const e=t.columns.concat(t.rows.concat(t.diagonals));return Math.max(...e)}applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){return e.getPieceAt(t.coord)===e.getCurrentOpponent()?R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):R.SUCCESS}getGameStatus(t){const e=t.gameState,s=n2.QUIXO_HELPER.getVictoriousCoord(e).map(o=>e.getPieceAt(o)),i=new bt(s);return 0===i.size()?Ie.ONGOING:1===i.size()?Ie.getVictory(i.getAnyElement().get()):Ie.getVictory(e.getCurrentPlayer())}}n2.singleton=y.empty(),n2.QUIXO_HELPER=new Wh(fc.isInRange,ge.identity,5);class Qut extends ks{getListMoves(t){const e=[],r=n2.getVerticalCoords(t),i=n2.getHorizontalCenterCoords(t).concat(r);for(const o of i){const c=n2.getPossibleDirections(o);for(const u of c){const h=new fc(o.x,o.y,u);e.push(h)}}return e}getMetrics(t){const r=n2.getLinesSums(t.gameState);return[n2.getFullestLine(r[B.ZERO.value]),n2.getFullestLine(r[B.ONE.value])]}}const fr=ue.NONE,Jc=ue.ZERO,Y3=ue.ONE;class t4e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,Y5.getInitialState()),te.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new Y5([[fr,fr,fr,fr,fr],[fr,fr,fr,fr,fr],[fr,fr,fr,fr,fr],[fr,fr,fr,fr,fr],[Jc,Jc,Jc,Jc,fr]],1),[new fc(4,4,Be.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),te.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new Y5([[fr,Y3,fr,Y3,Y3],[fr,Jc,Jc,fr,Jc],[Y3,Y3,Y3,Jc,Y3],[Jc,fr,Jc,Y3,Y3],[Y3,Jc,fr,Y3,Jc]],31),[new fc(3,0,Be.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)]}}function Jut(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"circle",4),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onBoardClick(i,o))}),A()()}if(2&n){const e=t.index,r=C().index,s=C();T(1),Le("id","click_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),z("r",.45*s.SPACE_SIZE)("cx",(e+.5)*s.SPACE_SIZE)("cy",(r+.5)*s.SPACE_SIZE)}}function e5t(n,t){if(1&n&&(H(),b(0,"g"),x(1,Jut,2,6,"g",2),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function t5t(n,t){if(1&n){const e=Ae();H(),b(0,"use",6),ee("click",function(){const i=de(e).$implicit;return le(C(2).chooseDirection(i))}),A()}if(2&n){const e=t.$implicit,r=C(2);p1("id","chooseDirection_",e,""),z("transform",r.getArrowTransform(e))}}function n5t(n,t){if(1&n&&(H(),b(0,"g"),x(1,t5t,1,2,"use",5),A()),2&n){const e=C();T(1),w("ngForOf",e.getPossiblesDirections())}}let r5t=(()=>{class n extends ao{constructor(e){super(e),this.lastMoveCoord=y.empty(),this.chosenCoord=y.empty(),this.victoriousCoords=[],this.rules=n2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Qut(this.rules,"QuixoMinimax")],this.encoder=fc.encoder,this.tutorial=(new t4e).tutorial,this.updateBoard()}updateBoard(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.node.move.map(e=>e.coord),this.victoriousCoords=n2.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=y.empty()}getPieceClasses(e,r){const s=new S(e,r),o=[];return o.push(this.getPlayerClass(this.board[r][e])),this.chosenCoord.equalsValue(s)?o.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&o.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),o}onBoardClick(e,r){const s=this.canUserPlay("#click_"+e+"_"+r);if(s.isFailure())return this.cancelMove(s.getReason());const i=new S(e,r),o=fc.isValidCoord(i);return o.isFailure()?this.cancelMove(o.getReason()):this.board[r][e]===this.state.getCurrentOpponent()?this.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(i)?this.cancelMoveAttempt():this.chosenCoord=y.of(i),R.SUCCESS)}getPossiblesDirections(){const e=[],r=this.chosenCoord.get();return 4!==r.x&&e.push(Be.RIGHT),0!==r.x&&e.push(Be.LEFT),4!==r.y&&e.push(Be.DOWN),0!==r.y&&e.push(Be.UP),e}chooseDirection(e){var r=this;return I(function*(){const s=r.canUserPlay("#chooseDirection_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):(r.chosenDirection=e,yield r.tryMove())})()}tryMove(){var e=this;return I(function*(){const r=e.chosenCoord.get(),s=new fc(r.x,r.y,e.chosenDirection);return e.chooseMove(s)})()}getArrowTransform(e){return class H6t{static getArrowTransform(t,e,r){let s,i,o;switch(r){case Be.UP:s=1,i=0,o=-90;break;case Be.DOWN:s=1,i=2,o=90;break;case Be.LEFT:s=0,i=1,o=180;break;default:ge.expectToBe(r,Be.RIGHT),s=2,i=1,o=0}return["scale("+t/300+")",`translate(${100*s} ${100*i})`,"rotate("+o+" 50 50)"].join(" ")}}.getArrowTransform(5*this.SPACE_SIZE,new S(0,0),e)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-quixo"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0)(1,"defs"),X(2,"polygon",1),A(),x(3,e5t,2,1,"g",2),x(4,n5t,2,1,"g",3),A()),2&e&&(z("viewBox","0 0 "+5*r.SPACE_SIZE+" "+5*r.SPACE_SIZE),T(3),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),ss=(()=>{class n extends xr{static getInitialState(){const e=Je.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,ue.NONE);return e[3][3]=B.ZERO,e[4][4]=B.ZERO,e[3][4]=B.ONE,e[4][3]=B.ONE,new n(e,0)}static getNeighboringPawnLike(e,r,s,i){let o;const c=[];for(let u=-1;u<2;u++)for(let h=-1;h<2;h++)o=new S(s+h,i+u),o.isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[o.y][o.x]===r&&c.push(o);return c}countScore(){const e=[0,0];for(let r=0;r<n.BOARD_HEIGHT;r++)for(let s=0;s<n.BOARD_WIDTH;s++){const i=this.board[r][s];i.isPlayer()&&(e[i.value]+=1)}return e}}return n.BOARD_WIDTH=8,n.BOARD_HEIGHT=8,n})();class $2 extends ms{static of(t){return new $2(t.x,t.y)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}$2.encoder=ms.getEncoder($2.of),$2.PASS=new $2(-1,-1);let s5t=(()=>{class n{}return n.NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`,n})();class n4e{constructor(t,e){this.move=t,this.switched=e}}class Ni extends I1{constructor(){super(ss)}static get(){return Ni.singleton.isAbsent()&&(Ni.singleton=y.of(new Ni)),Ni.singleton.get()}static getGameStatus(t){const e=t.gameState;if(!1===Ni.isGameEnded(e))return Ie.ONGOING;const s=e.countScore(),i=s[1]-s[0];return i<0?Ie.ZERO_WON:i>0?Ie.ONE_WON:Ie.DRAW}applyLegalMove(t,e,r){const s=e.turn,i=e.getCurrentPlayer(),o=e.getCopiedBoard();if(t.equals($2.PASS))return new ss(o,s+1);for(const u of r)o[u.y][u.x]=i;return o[t.coord.y][t.coord.x]=i,new ss(o,s+1)}static getAllSwitcheds(t,e,r){const s=[],i=e.getOpponent();for(const o of be.DIRECTIONS){const c=t.coord.getNext(o);if(c.isInRange(ss.BOARD_WIDTH,ss.BOARD_HEIGHT)&&r[c.y][c.x]===i){const u=Ni.getSandwicheds(e,o,c,r);for(const h of u)s.push(h)}}return s}static getSandwicheds(t,e,r,s){const i=[r];let o=r.getNext(e);for(;o.isInRange(ss.BOARD_WIDTH,ss.BOARD_HEIGHT);){const c=s[o.y][o.x];if(c===t)return i;if(c===ue.NONE)return[];i.push(o),o=o.getNext(e)}return[]}static isGameEnded(t){return this.playerCanOnlyPass(t)&&this.nextPlayerCantOnlyPass(t)}getGameStatus(t){return Ni.getGameStatus(t)}static playerCanOnlyPass(t){const e=this.getListMoves(t);return 1===e.length&&e[0].move.equals($2.PASS)}static nextPlayerCantOnlyPass(t){const e=t.getCopiedBoard(),s=new ss(e,t.turn+1);return this.playerCanOnlyPass(s)}static getListMoves(t){const e=[];let r;const s=t.getCurrentPlayer(),i=t.getCurrentOpponent();for(let o=0;o<8;o++)for(let c=0;c<8;c++)if(t.getPieceAtXY(c,o)===ue.NONE&&(r=t.getCopiedBoard(),ss.getNeighboringPawnLike(r,i,c,o).length>0)){const h=new $2(c,o),g=Ni.getAllSwitcheds(h,s,r);if(g.length>0){for(const m of g)We(s!==t.getPieceAt(m),m+"was already switched!"),r[m.y][m.x]=s;r[o][c]=s,e.push(new n4e(h,g.length))}}return 0===e.length&&e.push(new n4e($2.PASS,0)),e}isLegal(t,e){if(t.equals($2.PASS))return Ni.playerCanOnlyPass(e)?ve.success([]):ve.failure(Xe.CANNOT_PASS());if(e.getPieceAt(t.coord).isPlayer())return J(Ni.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),ve.failure(Xe.MUST_CLICK_ON_EMPTY_SPACE());const r=e.getCopiedBoard(),s=Ni.getAllSwitcheds(t,e.getCurrentPlayer(),r);return J(Ni.VERBOSE,"ReversiRules.isLegal: "+s.length+" element(s) switched"),0===s.length?ve.failure(s5t.NO_ELEMENT_SWITCHED()):ve.success(s)}}Ni.VERBOSE=!1,Ni.singleton=y.empty();class uT extends ks{getMetrics(t){const r=t.gameState.getCopiedBoard();let s=0,i=0;for(let o=0;o<ss.BOARD_HEIGHT;o++)for(let c=0;c<ss.BOARD_WIDTH;c++){const g=(0===c||c===ss.BOARD_WIDTH-1?4:1)*(0===o||o===ss.BOARD_HEIGHT-1?4:1);r[o][c]===B.ZERO&&(s+=g),r[o][c]===B.ONE&&(i+=g)}return[s,i]}getListMoves(t){const e=Ni.getListMoves(t.gameState);return Je.sortByDescending(e,r=>uT.bestCoords.some(s=>r.move.coord.equals(s))?100:r.switched),e.map(r=>r.move)}}uT.bestCoords=[new S(0,0),new S(0,ss.BOARD_HEIGHT-1),new S(ss.BOARD_WIDTH-1,0),new S(ss.BOARD_WIDTH-1,ss.BOARD_HEIGHT-1)];const Ft=ue.NONE,Ut=ue.ZERO,dt=ue.ONE;class r4e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new ss([[Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut],[Ut,dt,dt,dt,dt,dt,dt,Ut],[Ut,dt,dt,dt,dt,dt,dt,Ut],[Ut,dt,dt,dt,dt,dt,dt,Ut],[Ut,dt,dt,dt,dt,dt,dt,Ut],[Ut,dt,dt,dt,dt,dt,dt,Ut],[Ut,dt,dt,dt,dt,dt,dt,Ut],[Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut]],60)),te.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,ss.getInitialState(),new $2(2,4),$localize`Congratulations!`),te.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new ss([[Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft],[Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft],[Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft],[Ft,Ft,Ft,Ft,dt,Ft,Ft,Ft],[Ft,Ft,Ft,Ut,Ft,Ft,Ft,Ft],[Ft,Ft,Ut,Ft,Ft,Ft,Ft,Ft],[Ut,Ut,Ft,Ft,Ft,Ft,Ft,Ft],[Ft,Ut,dt,Ut,dt,Ut,Ft,Ft]],1),[new $2(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),te.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new ss([[dt,Ut,Ut,Ut,Ut,Ut,dt,Ut],[Ut,dt,dt,dt,dt,dt,dt,Ut],[Ut,dt,dt,dt,dt,dt,dt,Ut],[Ut,dt,dt,dt,dt,dt,dt,Ut],[Ut,dt,dt,dt,dt,dt,dt,Ut],[Ut,dt,dt,dt,dt,dt,dt,Ut],[dt,dt,dt,dt,dt,dt,Ft,Ft],[Ut,Ut,Ut,Ut,Ut,Ut,Ft,Ft]],60))]}}function i5t(n,t){if(1&n&&(H(),X(0,"circle",4)),2&n){const e=C().index,r=C().index,s=C();w("ngClass",s.getPieceClass(e,r)),z("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)}}function o5t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",2),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),A(),x(2,i5t,1,4,"circle",3),A()}if(2&n){const e=t.index,r=C().index,s=C();T(1),Le("id","click_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),z("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function a5t(n,t){if(1&n&&(H(),b(0,"g"),x(1,o5t,3,8,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let c5t=(()=>{class n extends ao{constructor(e){super(e),this.EMPTY=ue.NONE,this.lastMove=new S(-2,-2),this.capturedCoords=[],this.scores=y.of([2,2]),this.rules=Ni.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new uT(this.rules,"ReversiMinimax")],this.encoder=$2.encoder,this.tutorial=(new r4e).tutorial,this.canPass=!1,this.updateBoard()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new $2(e,r);return yield s.chooseMove(o)})()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.capturedCoords=[],this.lastMove=new S(-2,-2),this.scores=y.of(e.countScore()),this.canPass=Ni.playerCanOnlyPass(e)}showLastMove(e){this.lastMove=e.coord;const r=this.getState().getCurrentPlayer(),s=this.getState().getCurrentOpponent();for(const i of be.DIRECTIONS){let o=this.lastMove.getNext(i,1);for(;o.isInRange(ss.BOARD_WIDTH,ss.BOARD_HEIGHT)&&this.getState().getPieceAt(o)===s&&this.getPreviousState().getPieceAt(o)===r;)this.capturedCoords.push(o),o=o.getNext(i,1)}}getRectClasses(e,r){const s=new S(e,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(e,r){return this.getPlayerClass(this.board[r][e])}pass(){var e=this;return I(function*(){return We(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick($2.PASS.coord.x,$2.PASS.coord.y)})()}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-reversi"]],features:[l],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,a5t,2,1,"g",1),A()),2&e&&(z("viewBox","0 -4 "+8*r.SPACE_SIZE+" "+(10+8*r.SPACE_SIZE)),T(1),w("ngForOf",r.board))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Oa=(()=>{class n extends B5{static getInitialState(){const e=xe.UNREACHABLE,r=xe.ZERO,s=xe.ONE,i=xe.EMPTY;return new n([[e,e,r,s,i,i,i,r,s,e,e],[e,i,i,i,i,i,i,i,i,i,e],[s,i,i,i,i,i,i,i,i,i,r],[r,i,i,i,i,i,i,i,i,i,s],[e,i,i,i,i,i,i,i,i,i,e],[e,e,s,r,i,i,i,s,r,e,e]],0)}}return n.HEIGHT=6,n.WIDTH=11,n})(),t9=(()=>{class n{}return n.CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`,n.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`,n.MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`,n.MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`,n.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`,n.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`,n})();class K3 extends Hc{constructor(t,e){super(t,e)}static checkDistanceAndLocation(t,e){const r=t.getOrthogonalDistance(e);if(0===r)return R.failure(Xe.MOVE_CANNOT_BE_STATIC());if(1===r){const s=Bc.getFakeNeighbors(t);if(e.equals(s))return R.failure(t9.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==r)return R.failure($localize`You can move one or two spaces, not ${r}.`);if(Bc.isSpaceDark(t))return R.failure(t9.CAN_ONLY_REBOUND_ON_BLACK());if(t.x===e.x)return R.failure(t9.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return R.SUCCESS}static from(t,e){ge.assert(t.isInRange(Oa.WIDTH,Oa.HEIGHT),"Move must start inside the board not at "+t.toString()+"."),ge.assert(e.isInRange(Oa.WIDTH,Oa.HEIGHT),"Move must end inside the board not at "+e.toString()+".");const r=K3.checkDistanceAndLocation(t,e);return r.isFailure()?r.toOtherFallible():ve.success(new K3(t,e))}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}K3.encoder=Pa.getFallibleEncoder(K3.from);class U2 extends I1{constructor(){super(Oa)}static get(){return U2.singleton.isAbsent()&&(U2.singleton=y.of(new U2)),U2.singleton.get()}static getStartingCoords(t,e){const r=[];for(let s=0;s<Oa.HEIGHT;s++)for(let i=0;i<Oa.WIDTH;i++)t[s][i].is(e)&&r.push(new S(i,s));return r}static getBoardValuesFor(t,e){const r=U2.getStartingCoords(t,e),s=[];for(const i of r){const o=B5.getEmptyNeighbors(t,i,xe.EMPTY).length;if(0===o)return[0];s.push(o)}return s.sort((i,o)=>i-o)}applyLegalMove(t,e,r){J(U2.VERBOSE,"Legal move "+t.toString()+" applied");const s=e.getCopiedBoard();return s[t.getEnd().y][t.getEnd().x]=s[t.getStart().y][t.getStart().x],s[t.getStart().y][t.getStart().x]=xe.EMPTY,new Oa(s,e.turn+1)}isLegal(t,e){if(e.getPieceAt(t.getStart()).value!==e.getCurrentPlayer().value)return R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());if(e.getPieceAt(t.getEnd())!==xe.EMPTY)return R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE());const i=Bc.getCommonNeighbor(t.getStart(),t.getEnd());return i.isPresent()?e.getPieceAt(i.get())===xe.EMPTY?R.SUCCESS:R.failure(t9.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):R.SUCCESS}getGameStatus(t){const e=t.gameState.getCopiedBoard(),r=U2.getBoardValuesFor(e,B.ZERO),s=U2.getBoardValuesFor(e,B.ONE);return U2.getGameStatusFromFreedoms(r,s)}getLandingCoords(t,e){const r=i=>i.isInRange(Oa.WIDTH,Oa.HEIGHT)&&t[i.y][i.x]===xe.EMPTY,s=new bt(Bc.getNeighbors(e).filter(r));if(!0===Bc.isSpaceDark(e))return s.toList();{const i=new bt(s.toList());for(const o of s){const c=Bc.getNeighbors(o).filter(r);for(const u of c)i.add(u)}return i.toList()}}static getGameStatusFromFreedoms(t,e){return 0===t[0]?Ie.ONE_WON:0===e[0]?Ie.ZERO_WON:Ie.ONGOING}}U2.VERBOSE=!1,U2.singleton=y.empty();class l5t extends ks{getListMoves(t){const e=[],r=t.gameState.getCopiedBoard(),s=t.gameState.getCurrentPlayer(),i=U2.getStartingCoords(r,s);for(const o of i){const c=B5.getEmptyNeighbors(r,o,xe.EMPTY);for(const u of c){const h=K3.from(o,u).get();if(r[u.y][u.x]=r[o.y][o.x],r[o.y][o.x]=xe.EMPTY,e.push(h),(u.y+u.x)%2==0){const m=B5.getEmptyNeighbors(r,u,xe.EMPTY);for(const E of m)if(!E.equals(o)){const O=K3.from(o,E).get();r[E.y][E.x]=r[u.y][u.x],r[u.y][u.x]=xe.EMPTY,e.push(O),r[u.y][u.x]=r[E.y][E.x],r[E.y][E.x]=xe.EMPTY}}r[o.y][o.x]=r[u.y][u.x],r[u.y][u.x]=xe.EMPTY}}return e}getMetrics(t){const e=t.gameState.board,r=U2.getBoardValuesFor(e,B.ZERO),s=U2.getBoardValuesFor(e,B.ONE);let i=0;for(;i<6&&r[i]===s[i];)i++;return[r[i%6],s[i%6]]}}const e3=xe.UNREACHABLE,n9=xe.ZERO,r9=xe.ONE,Ln=xe.EMPTY;class s4e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Initial board`,$localize`Shr is played on a board where each space is a triangle.
        Each player has six pyramids.`,Oa.getInitialState()),te.informational($localize`Goal of the game`,$localize`At Shr, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new Oa([[e3,e3,Ln,Ln,r9,Ln,Ln,n9,r9,e3,e3],[e3,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,e3],[r9,n9,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,n9],[n9,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,r9],[e3,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,e3],[e3,e3,r9,n9,Ln,Ln,Ln,r9,n9,e3,e3]],3)),te.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,Oa.getInitialState(),K3.from(new S(2,0),new S(2,1)).get(),(t,e,r)=>t.isSimpleStep()?R.SUCCESS:R.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),te.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,Oa.getInitialState(),K3.from(new S(7,0),new S(5,0)).get(),(t,e,r)=>t.isSimpleStep()?R.failure($localize`Failed! You have made a single step.`):R.SUCCESS,$localize`Congratulations!`)]}}function u5t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"polygon",7),A()),2&n){const e=C().index,r=C().index,s=C();T(1),w("ngClass",s.getPlayerClassFor(e,r)),z("points",s.getPyramidCoordinate(e,r))}}function f5t(n,t){if(1&n&&(H(),X(0,"polygon",10)),2&n){const e=C(2).index,r=C().index;z("points",C().getTriangleCoordinate(e,r))}}function h5t(n,t){if(1&n&&(H(),X(0,"polygon",11)),2&n){const e=C(2).index,r=C().index;z("points",C().getTriangleCoordinate(e,r))}}function d5t(n,t){if(1&n&&(H(),b(0,"g"),x(1,f5t,1,1,"polygon",8),x(2,h5t,1,1,"polygon",9),A()),2&n){const e=C().index,r=C().index;T(1),w("ngIf",(e+r)%2==1),T(1),w("ngIf",(e+r)%2==0)}}function p5t(n,t){if(1&n){const e=Ae();H(),b(0,"g",5),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),x(1,u5t,2,2,"g",6),x(2,d5t,3,2,"g",6),A()}if(2&n){const e=t.$implicit;Le("id","click_",t.index,"_",C().index,""),T(1),w("ngIf",e.isPlayer()),T(1),w("ngIf",2===e.value)}}function g5t(n,t){if(1&n&&(H(),b(0,"g"),x(1,p5t,3,4,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function m5t(n,t){if(1&n&&(H(),X(0,"polygon",14)),2&n){const e=t.$implicit,r=C(2);Le("id","possible_landing_",e.x,"_",e.y,""),z("points",r.getTriangleCoordinate(e.x,e.y))}}function _5t(n,t){if(1&n&&(H(),X(0,"polygon",14)),2&n){const e=C(2);Le("id","chosen_coord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),z("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function v5t(n,t){if(1&n&&(H(),dn(0),x(1,m5t,1,3,"polygon",12),x(2,_5t,1,3,"polygon",13),pn()),2&n){const e=C();T(1),w("ngForOf",e.possibleLandings),T(1),w("ngIf",e.chosenCoord.isPresent())}}function C5t(n,t){if(1&n&&(H(),dn(0),X(1,"polygon",15)(2,"polygon",15),pn()),2&n){const e=C(2);T(1),z("points",e.getTriangleCoordinate(e.lastCoord.get().x,e.lastCoord.get().y)),T(1),z("points",e.getTriangleCoordinate(e.lastMoved.get().x,e.lastMoved.get().y))}}function y5t(n,t){1&n&&(H(),x(0,C5t,3,2,"ng-container",6)),2&n&&w("ngIf",C().lastMoved.isPresent())}let E5t=(()=>{class n extends d3e{constructor(e){super(e),this.lastCoord=y.empty(),this.lastMoved=y.empty(),this.chosenCoord=y.empty(),this.possibleLandings=[],this.rules=U2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new l5t(this.rules,"SaharaMinimax")],this.encoder=K3.encoder,this.tutorial=(new s4e).tutorial,this.updateBoard()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=y.empty()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentPlayer(),c=xe.ofPlayer(o);return s.chosenCoord.equalsValue(new S(e,r))?(s.cancelMoveAttempt(),R.SUCCESS):s.chosenCoord.isAbsent()||s.board[r][e]===c?s.choosePiece(e,r):s.chooseLandingCoord(e,r)})()}choosePiece(e,r){if(this.board[r][e]===xe.EMPTY)return this.cancelMove(t9.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[r][e].is(B.ofTurn(this.getTurn()))){const s=new S(e,r);return this.selectPiece(s),R.SUCCESS}return this.cancelMove(t9.MUST_CHOOSE_OWN_PYRAMID())}selectPiece(e){this.chosenCoord=y.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}chooseLandingCoord(e,r){var s=this;return I(function*(){const i=new S(e,r),o=K3.from(s.chosenCoord.get(),i);return o.isFailure()?s.cancelMove(o.getReason()):yield s.chooseMove(o.get())})()}updateBoard(){const e=this.node.move;this.lastCoord=e.map(r=>r.getStart()),this.lastMoved=e.map(r=>r.getEnd()),this.board=this.getState().board}getPlayerClassFor(e,r){return this.getPlayerClass(B.of(this.board[r][e].value))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-sahara"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","selected-stroke",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,r){if(1&e&&(H(),b(0,"svg",0),x(1,g5t,2,1,"g",1),x(2,v5t,3,2,"ng-container",2),x(3,y5t,1,1,"ng-template",null,3,qn),A()),2&e){const s=Hn(4);T(1),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class ba extends ms{constructor(t,e,r,s){super(t,e),this.x=t,this.y=e,this.direction=r,this.landingOrientation=s}static from(t,e,r,s){const i=new ba(t,e,r,s),o=i.coord.isNotInRange(5,5);if(i.isRotation()){if(o)return ve.failure("Cannot rotate piece outside the board: "+i.toString())}else if(i.coord.getNext(i.direction.get()).isNotInRange(5,5)){if(o)return ve.failure("SiamMove should end or start on the board: "+i.toString());if(i.direction.get()!==i.landingOrientation)return ve.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+i.toString())}return ve.success(i)}isRotation(){return this.direction.isAbsent()}equals(t){return this===t||!(!this.coord.equals(t.coord)||!1===this.direction.equals(t.direction))&&this.landingOrientation===t.landingOrientation}toString(){const t=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+t+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}ba.encoder=Ye.tuple([Ye.identity(),Ye.identity(),y.getEncoder(Be.encoder),Be.encoder],n=>[n.x,n.y,n.direction,n.landingOrientation],n=>ba.from(n[0],n[1],n[2],n[3]).get());class vt{constructor(t){this.value=t}static decode(t){switch(t){case 0:return vt.EMPTY;case 1:return vt.LIGHT_UP;case 2:return vt.LIGHT_RIGHT;case 3:return vt.LIGHT_DOWN;case 4:return vt.LIGHT_LEFT;case 5:return vt.DARK_UP;case 6:return vt.DARK_RIGHT;case 7:return vt.DARK_DOWN;case 8:return vt.DARK_LEFT;case 9:return vt.MOUNTAIN}}belongTo(t){return t===B.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?B.ZERO:5<=this.value&&this.value<=8?B.ONE:ue.NONE}getOptionalDirection(){switch(this.value){case 0:return y.empty();case 1:case 5:return y.of(Be.UP);case 2:case 6:return y.of(Be.RIGHT);case 3:case 7:return y.of(Be.DOWN);case 4:case 8:return y.of(Be.LEFT);default:return ge.expectToBe(this.value,9),y.empty()}}static of(t,e){return e===B.ZERO?t===Be.UP?vt.LIGHT_UP:t===Be.RIGHT?vt.LIGHT_RIGHT:t===Be.DOWN?vt.LIGHT_DOWN:vt.LIGHT_LEFT:t===Be.UP?vt.DARK_UP:t===Be.RIGHT?vt.DARK_RIGHT:t===Be.DOWN?vt.DARK_DOWN:vt.DARK_LEFT}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return ge.expectToBe(this.value,9),"MOUNTAIN"}}}vt.EMPTY=new vt(0),vt.LIGHT_UP=new vt(1),vt.LIGHT_RIGHT=new vt(2),vt.LIGHT_DOWN=new vt(3),vt.LIGHT_LEFT=new vt(4),vt.DARK_UP=new vt(5),vt.DARK_RIGHT=new vt(6),vt.DARK_DOWN=new vt(7),vt.DARK_LEFT=new vt(8),vt.MOUNTAIN=new vt(9);class X3 extends xr{static getInitialState(){const t=Je.createTable(5,5,vt.EMPTY);return t[2][1]=vt.MOUNTAIN,t[2][2]=vt.MOUNTAIN,t[2][3]=vt.MOUNTAIN,new X3(t,0)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(let e=0;e<5;e++)for(let r=0;r<5;r++)this.board[e][r]!==vt.EMPTY&&t[this.getPieceAtXY(r,e).getOwner().value]++;return t}}let s9=(()=>{class n{}return n.NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`,n.NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`,n.MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`,n.ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`,n.MUST_SELECT_VALID_DESTINATION=()=>$localize`You must select a valid destination (highlighted on the board) for your piece`,n.MUST_SELECT_ORIENTATION=()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`,n})();class i4e{constructor(t,e){this.resultingBoard=t,this.moved=e}}class Er extends I1{constructor(){super(X3)}static get(){return Er.singleton.isAbsent()&&(Er.singleton=y.of(new Er)),Er.singleton.get()}isLegal(t,e){if(J(Er.VERBOSE,{SiamRules_isLegal:{move:t,state:e}}),!t.isInsertion()&&!e.getPieceAt(t.coord).belongTo(e.getCurrentPlayer()))return ve.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());if(t.isRotation())return J(Er.VERBOSE,"Move is rotation"),this.isLegalRotation(t,e);{let r;if(t.isInsertion()){J(Er.VERBOSE,"Move is insertion");const s=this.isLegalInsertion(t.coord,e);if(s.legal.isFailure())return ve.failure(s.legal.getReason());r=s.insertedPiece}else J(Er.VERBOSE,"Move is forward"),r=e.getPieceAt(t.coord);return this.isLegalForwarding(t,e,r)}}isLegalInsertion(t,e){const r=e.countCurrentPlayerPawn(),s=e.getCurrentPlayer(),i=r<5?R.SUCCESS:R.failure(s9.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(t,s),legal:i}}getInsertedPiece(t,e){return vt.of(-1===t.x?Be.RIGHT:-1===t.y?Be.DOWN:5===t.x?Be.LEFT:Be.UP,e)}isLegalForwarding(t,e,r){We(r!==vt.MOUNTAIN&&r!==vt.EMPTY,"forwarding must be done with player piece");const s=[];let i=vt.of(t.landingOrientation,e.getCurrentPlayer());const o=t.direction.get();let c=t.coord.getNext(o);if(c.isInRange(5,5)&&e.getPieceAt(c)!==vt.EMPTY&&!1===this.isStraight(r,t))return ve.failure(s9.ILLEGAL_PUSH());let u=y.of(o);const h=o.getOpposite();let g=0;const m=e.getCopiedBoard();t.coord.isInRange(5,5)&&(m[t.coord.y][t.coord.x]=vt.EMPTY,s.push(t.coord));let E=c.isInRange(5,5)&&i!==vt.EMPTY;for(;E;){u.equalsValue(o)?g++:u.equalsValue(h)&&g--;const O=m[c.y][c.x];O===vt.MOUNTAIN&&(g-=.9),m[c.y][c.x]=i,s.push(c),i=O,c=c.getNext(o),u=i.getOptionalDirection(),E=c.isInRange(5,5)&&i!==vt.EMPTY&&g>0}return c.isNotInRange(5,5)&&(u.equalsValue(o)?g++:u.equalsValue(h)&&g--),g<=0?ve.failure(s9.NOT_ENOUGH_FORCE_TO_PUSH()):ve.success(new i4e(m,s))}isStraight(t,e){const r=t.getDirection();return e.direction.equalsValue(r)&&r===e.landingOrientation}isLegalRotation(t,e){J(Er.VERBOSE,{isLegalRotation:{rotation:t,state:e}});const r=t.coord,s=e.getPieceAt(r),i=e.getCurrentPlayer();if(s.getDirection()===t.landingOrientation)return ve.failure(s9.MUST_MOVE_OR_ROTATE());const o=e.getCopiedBoard();return o[r.y][r.x]=vt.of(t.landingOrientation,i),ve.success(new i4e(o,[r]))}applyLegalMove(t,e,r){const s=Je.copyBiArray(r.resultingBoard);return new X3(s,e.turn+1)}getBoardValueInfo(t,e){const r=this.getMountainsRowsAndColumns(e),s=r.rows,i=r.columns,o=this.getWinner(e,t,r.nbMountain);if(o.isPlayer())return o===B.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const c=this.getPushers(e,i,s);let u=Number.MAX_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER;const g=e.getCurrentPlayer();for(const E of c)E.coord.isInRange(5,5)?e.getPieceAt(E.coord).belongTo(B.ZERO)?u=Math.min(u,E.distance):h=Math.min(h,E.distance):g===B.ZERO?u=Math.min(u,E.distance):h=Math.min(h,E.distance);return{shortestZero:u,shortestOne:h,boardValue:this.getScoreFromShortestDistances(u,h,g)}}}getScoreFromShortestDistances(t,e,r){t===Number.MAX_SAFE_INTEGER&&(t=6),e===Number.MAX_SAFE_INTEGER&&(e=6);const s=6-t,i=6-e;return s===i?r.getScoreModifier():s>i?-10*(s+1)+(i+1):10*(i+1)-(s+1)}getMountainsRowsAndColumns(t){const e=[],r=[];let s=0;for(let i=0;i<5;i++)for(let o=0;o<5;o++)t.getPieceAtXY(o,i)===vt.MOUNTAIN&&(e.includes(i)||e.push(i),r.includes(o)||r.push(o),s++);return{rows:e,columns:r,nbMountain:s}}getWinner(t,e,r){return 2===r?this.getPusher(t,e.get()):ue.NONE}getPusher(t,e){const r=e.coord;let s;s=r.isInRange(5,5)?t.getPieceAt(r.getNext(e.landingOrientation)):this.getInsertedPiece(r,t.getCurrentOpponent());const i=s.getDirection(),o=this.getPusherCoord(t,i,r),c=t.getPieceAt(o).getOwner();return J(Er.VERBOSE,r.toString()+" belong to "+t.getCurrentOpponent().value+", "+o.toString()+" belong to "+c.value+", "+c.value+" win"),c}getPusherCoord(t,e,r){let s=r.getNext(e),i=r;for(;s.isInRange(5,5);){r=s,s=s.getNext(e);const o=t.getPieceAt(r);o!==vt.MOUNTAIN&&o.getDirection()===e&&(i=r)}return i}getPushers(t,e,r){J(Er.VERBOSE,{getPushers:{state:t,mountainsColumn:e,mountainsRow:r}});let s=[];const i=[];for(const o of e){let c=Be.DOWN,u=new S(o,4);i.push({direction:c,fallingCoord:u}),c=Be.UP,u=new S(o,0),i.push({direction:c,fallingCoord:u})}for(const o of r){let c=Be.LEFT,u=new S(0,o);i.push({direction:c,fallingCoord:u}),c=Be.RIGHT,u=new S(4,o),i.push({direction:c,fallingCoord:u})}for(const o of i)s=this.addPotentialDirectionPusher(t,o.fallingCoord,o.direction,s);return s}addPotentialDirectionPusher(t,e,r,s){const i=this.getLineClosestPusher(t,e,r);if(i.isAbsent())return s;const o=i.get(),c=o.distance;return J(Er.VERBOSE,"new closest challenger"),s.push({coord:o.coord,distance:c}),s}getLineClosestPusher(t,e,r){J(Er.VERBOSE,{getDirectionClosestPusher:{state:t,fallingCoord:e,direction:r.toString()}});const s=r.getOpposite();let i=1,o=t.getPieceAt(e),c=e,u=y.empty(),h=!1,g=!1,m=0;for(;c.isInRange(5,5)&&!1===h;){const E=t.getPieceAt(c);if(E.isEmptyOrMountain())E===vt.MOUNTAIN?(m+=.9,g=!0):i++;else{const O=E.getDirection();O===r?g&&(m-=1,m<=0&&(h=!0,c=c.getNext(r))):O===s?(m+=1,g||i++):g?(u=y.of(c),o!==vt.EMPTY&&i++):i++}o=E,c=c.getPrevious(r)}if(!1===h&&u.isPresent())for(i++,m-=1;!1===c.equals(u.get());)c=c.getNext(r),i--;return c.isNotInRange(5,5)&&(m-=1,5===t.countCurrentPlayerPawn())||m>0?y.empty():y.of({distance:i,coord:c})}getInsertions(t){let e=[];for(let r=1;r<4;r++)e=e.concat(this.getInsertionsAt(t,0,r)),e=e.concat(this.getInsertionsAt(t,4,r)),e=e.concat(this.getInsertionsAt(t,r,0)),e=e.concat(this.getInsertionsAt(t,r,4));return e=e.concat(this.getInsertionsAt(t,0,0)),e=e.concat(this.getInsertionsAt(t,0,4)),e=e.concat(this.getInsertionsAt(t,4,0)),e=e.concat(this.getInsertionsAt(t,4,4)),e}getInsertionsAt(t,e,r){const s=[];for(const i of Be.ORTHOGONALS){const o=new S(e,r).getPrevious(i);if(o.isNotInRange(5,5))for(const c of Be.ORTHOGONALS){const u=ba.from(o.x,o.y,y.of(i),c);We(u.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(u.get(),t).isSuccess()&&s.push(u.get())}}return s}getMovesFrom(t,e,r,s){const i=new S(r,s);let o=this.getRotationMovesAt(i,e);for(const c of Be.ORTHOGONALS){const u=i.getNext(c);o=o.concat(this.getForwardMovesBetween(t,i,u))}return o}getMovesBetween(t,e,r,s){return r.equals(s)?this.getRotationMovesAt(r,e):Be.factory.fromMove(r,s).isSuccess()&&1===r.getDistance(s)?this.getForwardMovesBetween(t,r,s):[]}getRotationMovesAt(t,e){const r=[],s=e.getDirection();for(const i of Be.ORTHOGONALS)if(i!==s){const o=ba.from(t.x,t.y,y.empty(),i).get();r.push(o)}return r}getForwardMovesBetween(t,e,r){const s=[];let i;const o=Be.factory.fromMove(e,r).get(),c=t.getPieceAt(e);i=r.isInRange(5,5)?Be.ORTHOGONALS:[o];for(const u of i){const h=ba.from(e.x,e.y,y.of(o),u).get();this.isLegalForwarding(h,t,c).isSuccess()&&s.push(h)}return s}getGameStatus(t){const e=this.getMountainsRowsAndColumns(t.gameState),r=this.getWinner(t.gameState,t.move,e.nbMountain);return r.isPlayer()?Ie.getVictory(r):Ie.ONGOING}}Er.singleton=y.empty(),Er.VERBOSE=!1;class M5t extends ic{getBoardValue(t){return new Fn(Er.get().getBoardValueInfo(t.move,t.gameState).boardValue)}getListMoves(t){let e=[];const r=t.gameState.getCurrentPlayer();for(let s=0;s<5;s++)for(let i=0;i<5;i++){const o=t.gameState.getPieceAtXY(i,s);o.belongTo(r)&&(e=e.concat(Er.get().getMovesFrom(t.gameState,o,i,s)))}if(t.gameState.countCurrentPlayerPawn()<5)for(const s of Er.get().getInsertions(t.gameState))if(s.direction.get().getOpposite()!==s.landingOrientation){if(this.isOnBorder(s)&&s.direction.get()!==s.landingOrientation)continue;e.push(s)}return J(Er.VERBOSE,{getListMovesResult:e}),e}isOnBorder(t){return 0===t.coord.x||4===t.coord.x||0===t.coord.y||4===t.coord.y}}const Ze=vt.EMPTY,hc=vt.MOUNTAIN,oF=vt.LIGHT_UP,aF=vt.LIGHT_LEFT,i9=vt.LIGHT_RIGHT,S5t=vt.LIGHT_DOWN,P5t=vt.DARK_UP,o4e=vt.DARK_LEFT,a4e=vt.DARK_RIGHT,T5t=vt.DARK_DOWN;class c4e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,X3.getInitialState()),te.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,X3.getInitialState(),ba.from(2,-1,y.of(Be.DOWN),Be.DOWN).get(),$localize`Congratulations!`),te.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new X3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,hc,hc,hc,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,oF,Ze,Ze]],0),[ba.from(2,4,y.of(Be.UP),Be.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),te.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new X3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,hc,hc,hc,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,oF,Ze,Ze]],0),[ba.from(2,4,y.of(Be.DOWN),Be.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),te.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new X3([[Ze,i9,o4e,Ze,Ze],[i9,a4e,aF,Ze,Ze],[Ze,Ze,oF,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze]],0),[ba.from(2,2,y.of(Be.UP),Be.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),te.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new X3([[Ze,Ze,i9,hc,Ze],[Ze,Ze,i9,hc,aF],[Ze,i9,hc,hc,Ze],[Ze,i9,a4e,o4e,hc],[Ze,Ze,Ze,Ze,Ze]],0),[ba.from(1,3,y.of(Be.RIGHT),Be.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),te.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new X3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[hc,P5t,aF,Ze,S5t],[Ze,Ze,Ze,Ze,T5t],[Ze,Ze,Ze,Ze,hc]],0),[ba.from(2,2,y.of(Be.LEFT),Be.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)]}}function w5t(n,t){if(1&n){const e=Ae();H(),b(0,"use",11),ee("click",function(){de(e);const s=C().index,i=C().index;return le(C().clickSquare(s,i))}),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();Le("id","piece_",r,"_",i,""),w("ngClass",o.getPieceClasses(r,i,s)),z("transform",o.getPieceTransform(r,i))}}function O5t(n,t){if(1&n){const e=Ae();H(),b(0,"use",12),ee("click",function(){de(e);const s=C().index,i=C().index;return le(C().clickSquare(s,i))}),A()}if(2&n){const e=C().index,r=C().index,s=C();z("transform","translate("+(e+1)*s.SPACE_SIZE+" "+(r+1)*s.SPACE_SIZE+")")}}function b5t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",8),ee("click",function(){const i=de(e).index,o=C().index;return le(C().clickSquare(i,o))}),A(),x(2,w5t,1,4,"use",9),x(3,O5t,1,1,"use",10),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Le("id","square_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",i.SPACE_SIZE*(r+1))("y",i.SPACE_SIZE*(s+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e.isPiece()),T(1),w("ngIf",i.isMountain(e))}}function A5t(n,t){if(1&n&&(H(),b(0,"g"),x(1,b5t,4,9,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function N5t(n,t){if(1&n){const e=Ae();H(),b(0,"rect",15),ee("click",function(){de(e);const s=C().$implicit;return le(C().clickSquare(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C();Le("id","square_",e.x,"_",e.y,""),w("ngClass",r.getSquareClasses(e.x,e.y)),z("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function I5t(n,t){if(1&n){const e=Ae();H(),b(0,"g"),x(1,N5t,1,7,"rect",13),b(2,"rect",14),ee("click",function(){const i=de(e).$implicit;return le(C().clickSquare(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),w("ngIf",!1===e.isInRange(5,5)),T(1),z("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function x5t(n,t){if(1&n){const e=Ae();H(),b(0,"rect",16),ee("click",function(){de(e);const s=C();return le(s.clickSquare(s.selectedLanding.get().x,s.selectedLanding.get().y))}),A()}if(2&n){const e=C();z("x",e.SPACE_SIZE*(e.selectedLanding.get().x+1))("y",e.SPACE_SIZE*(e.selectedLanding.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function k5t(n,t){if(1&n){const e=Ae();H(),b(0,"rect",16),ee("click",function(){de(e);const s=C();return le(s.clickSquare(s.selectedPiece.get().x,s.selectedPiece.get().y))}),A()}if(2&n){const e=C();z("x",e.SPACE_SIZE*(e.selectedPiece.get().x+1))("y",e.SPACE_SIZE*(e.selectedPiece.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function L5t(n,t){if(1&n&&(H(),X(0,"use",19)),2&n){const e=t.$implicit,r=C().$implicit,s=C();Le("id","remainingPieces_",r.value,"_",e,""),w("ngClass",s.getRemainingPieceClasses(r,e)),z("transform",s.getRemainingPieceTransform(e,r))}}function R5t(n,t){if(1&n){const e=Ae();H(),b(0,"g",17),ee("click",function(){const i=de(e).$implicit;return le(C().selectPieceForInsertion(i))}),x(1,L5t,1,4,"use",18),A()}if(2&n){const e=t.$implicit,r=C();p1("id","remainingPieces_",e.value,""),T(1),w("ngForOf",r.ArrayUtils.range(r.playerPieces(e)))}}function D5t(n,t){if(1&n){const e=Ae();H(),b(0,"use",22),ee("click",function(){de(e);const s=C().$implicit;return le(C().clickSquare(s.source.get().coord.x,s.source.get().coord.y))}),A()}if(2&n){const e=C().$implicit,r=C();w("ngClass",r.getPieceClasses(e.source.get().coord.x,e.source.get().coord.y,e.source.get().piece)),z("transform",r.getPieceTransform(e.source.get().coord.x,e.source.get().coord.y))}}function z5t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"use",20),ee("click",function(){const i=de(e).$implicit;return le(C().clickArrow(i))}),A(),x(2,D5t,1,2,"use",21),A()}if(2&n){const e=t.$implicit,r=C();T(1),J2("id","indicator_",e.target.x,"_",e.target.y,"_",e.direction.toString(),""),z("transform",r.getIndicatorTransform(e)),T(1),w("ngIf",e.source.isPresent())}}function V5t(n,t){if(1&n){const e=Ae();H(),b(0,"use",23),ee("click",function(){const i=de(e).$implicit;return le(C().selectOrientation(i))}),A()}if(2&n){const e=t.$implicit,r=C();p1("id","orientation_",e.landingOrientation,""),w("ngClass",r.getCurrentPlayerClass()),z("transform",r.getOrientationTransform(e.landingOrientation))}}let H5t=(()=>{class n extends ao{constructor(e){super(e),this.lastMove=y.empty(),this.movedPieces=[],this.selectedPiece=y.empty(),this.selectedLanding=y.empty(),this.orientations=[],this.clickableCoords=new bt,this.indicatorArrows=[],this.insertingPiece=!1,this.rules=Er.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new M5t(this.rules,"SiamMinimax")],this.encoder=ba.encoder,this.tutorial=(new c4e).tutorial,this.updateBoard()}updateBoard(){J(n.VERBOSE,"updateBoard");const e=this.getState();this.board=e.board,this.movedPieces=[]}showLastMove(e){this.lastMove=y.of(e);const r=this.getPreviousState();this.movedPieces=this.rules.isLegal(this.lastMove.get(),r).get().moved}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=y.empty(),this.selectedLanding=y.empty(),this.orientations=[],this.clickableCoords=new bt,this.indicatorArrows=[]}selectPieceForInsertion(e){var r=this;return I(function*(){const s=r.canUserPlay("#remainingPieces_"+e.value);if(s.isFailure())return r.cancelMove(s.getReason());if(e!==r.getCurrentPlayer())return r.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE());if(r.insertingPiece)return r.cancelMoveAttempt(),R.SUCCESS;r.cancelMoveAttempt();for(const i of Er.get().getInsertions(r.getState())){const o=i.coord.getNext(i.direction.get());if(r.board[o.y][o.x]!==vt.EMPTY){const c={source:y.empty(),target:o,direction:i.direction.get(),move:i};r.indicatorArrows.push(c)}r.clickableCoords.add(o)}return r.insertingPiece=!0,R.SUCCESS})()}selectOrientation(e){var r=this;return I(function*(){const s=r.canUserPlay("#orientation_"+e.landingOrientation.toString());return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e)})()}clickSquare(e,r,s=!1){var i=this;return I(function*(){if(J(n.VERBOSE,"SiamComponent.clickSquare("+e+", "+r+")"),!1===s){const c=i.canUserPlay("#square_"+e+"_"+r);if(c.isFailure())return i.cancelMove(c.getReason())}const o=new S(e,r);if(i.insertingPiece)return i.insertPiece(o);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),R.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=y.of(o);const c=Er.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),o);return 0===c.length?i.changeMoveDestinationClick(o):i.performMoveOrShowOrientationArrows(c)}{We(i.getState().isOnBoard(o),"SiamComponent: user clicked outside of board when it should not be possible");const c=i.board[r][e];return c.getOwner()!==i.getCurrentPlayer()?i.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(o,c)}})()}insertPiece(e){var r=this;return I(function*(){if(r.selectedLanding.isPresent())return r.cancelMove(s9.MUST_SELECT_ORIENTATION()),R.SUCCESS;r.selectedLanding=y.of(e);const s=Er.get().getInsertionsAt(r.getState(),e.x,e.y);return 0===s.length?r.changeMoveDestinationClick(e):r.performMoveOrShowOrientationArrows(s)})()}changeMoveDestinationClick(e){var r=this;return I(function*(){return r.cancelMoveAttempt(),r.getState().getPieceAt(e).getOwner()===r.getCurrentPlayer()?r.clickSquare(e.x,e.y,!0):r.cancelMove(s9.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var r=this;return I(function*(){return We(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(r.cancelMove(),r.chooseMove(e[0])):(r.clickableCoords=new bt,r.indicatorArrows=[],r.orientations=e,R.SUCCESS)})()}selectPiece(e,r){this.cancelMoveAttempt();const s=this.getState();this.selectedPiece=y.of(e);const i=Er.get().getMovesFrom(s,r,e.x,e.y);for(const o of i)if(o.direction.isPresent()){const c=o.coord.getNext(o.direction.get());if(this.clickableCoords.add(c),s.isOnBoard(c)&&s.getPieceAt(c)!==vt.EMPTY){const u={source:y.of({coord:e,piece:r}),target:c,direction:o.direction.get(),move:o};this.indicatorArrows.push(u)}}else this.clickableCoords.add(o.coord);return R.SUCCESS}clickArrow(e){var r=this;return I(function*(){const s=r.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e.move)})()}isMountain(e){return e===vt.MOUNTAIN}getArrowTransform(e,r,s){const o=`rotate(${90*(s.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+r*this.SPACE_SIZE+")",o].join(" ")}getPieceTransform(e,r){return this.getArrowTransform(e+1,r+1,this.board[r][e].getDirection())}getIndicatorTransform(e){const r=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(r.x+1,r.y+1,e.direction)}getRemainingPieceTransform(e,r){const s=this.playerPieces(r);let u,h,c=2;return r===B.ONE?(c+=(s-e+(5-s)/2)/3,u=-1,h=Be.RIGHT):(c+=(e+1+(5-s)/2)/3,u=7,h=Be.LEFT),this.getArrowTransform(c,u,h)}getOrientationTransform(e){const r=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,r].join(" ")}getPieceClasses(e,r,s){const i=new S(e,r),o=[this.getPlayerClass(s.getOwner())];return this.selectedPiece.equalsValue(i)&&o.push("selected-stroke"),o}getSquareClasses(e,r){const s=new S(e,r);return this.movedPieces.some(i=>i.equals(s))?["moved-fill"]:[]}getRemainingPieceClasses(e,r){const s=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&r===this.playerPieces(e)-1&&s.push("selected-stroke"),s}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-siam"]],features:[l],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0)(1,"defs"),X(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),A(),x(5,A5t,2,1,"g",4),x(6,I5t,3,5,"g",4),x(7,x5t,1,4,"rect",5),x(8,k5t,1,4,"rect",5),x(9,R5t,2,2,"g",6),x(10,z5t,3,5,"g",4),x(11,V5t,1,3,"use",7),A()),2&e&&(T(5),w("ngForOf",r.board),T(1),w("ngForOf",r.clickableCoords),T(1),w("ngIf",r.selectedLanding.isPresent()),T(1),w("ngIf",r.selectedPiece.isPresent()),T(1),w("ngForOf",r.Player.PLAYERS),T(1),w("ngForOf",r.indicatorArrows),T(1),w("ngForOf",r.orientations))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Wr extends oo{constructor(t,e,r){super(),this.start=t,this.landing=e,this.keep=r,ge.assert(!1===t.equalsValue(e),"Deplacement cannot be static!"),ge.assert(t.isAbsent()||!1===t.equals(r),"Cannot keep starting coord, since it will always be empty after move!")}static of(t,e,r){return new Wr(t,e,r)}static ofDrop(t){return new Wr(y.empty(),t,y.empty())}static ofMovement(t,e){return new Wr(y.of(t),e,y.empty())}static ofCut(t,e,r){return new Wr(y.of(t),e,y.of(r))}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(t){return!1!==this.landing.equals(t.landing)&&!1!==this.start.equals(t.start)&&this.keep.equals(t.keep)}}Wr.encoder=Ye.tuple([y.getEncoder(S.encoder),S.encoder,y.getEncoder(S.encoder)],n=>[n.start,n.landing,n.keep],n=>Wr.of(n[0],n[1],n[2]));let Q3=(()=>{class n{}return n.NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`,n.MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`,n.CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`,n.CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`,n.MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`,n.CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`,n.MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`,n})();class mo extends b3e{static getInitialState(){return mo.ofRepresentation([[B.ZERO],[B.ONE]],0)}static ofRepresentation(t,e,r=new $t(0,0)){const s=new Jm;for(let i=0;i<t.length;i++)for(let o=0;o<t[0].length;o++)if(t[i][o]!==ue.NONE){const c=new S(o,i).getNext(r);s.set(c,t[i][o])}return new mo(s,e)}movePiece(t){const e=this.pieces.getCopy();return e.delete(t.start.get()),e.set(t.landing,this.getCurrentPlayer()),new mo(e,this.turn)}toRepresentation(){const t=Je.createTable(this.width,this.height,ue.NONE);for(const e of this.pieces.listKeys()){const r=this.getPieceAt(e);t[e.y][e.x]=r}return t}isIllegalLandingZone(t,e){return this.pieces.containsKey(t)?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(t,e)?R.SUCCESS:R.failure(Q3.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(t,e){for(const r of Ei.getNeighbors(t))if(this.pieces.containsKey(r)&&!1===e.equalsValue(r))return!0;return!1}getPieceAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():ue.NONE}applyLegalDrop(t){const e=this.pieces.getCopy();return e.put(t,this.getCurrentPlayer()),new mo(e,this.turn+1)}applyLegalDeplacement(t,e){const r=this.movePiece(t);if(e.size()>0){const s=new Jm;for(const i of e)s.set(i,r.getPieceAt(i));return new mo(s,this.turn+1)}return new mo(r.pieces,this.turn+1)}countPieces(){const t=this.pieces.reverse(),e=t.get(B.ZERO).getOrElse(new kr),r=t.get(B.ONE).getOrElse(new kr);return[e.size(),r.size()]}switchPiece(t){const e=this.pieces.getCopy(),r=this.getPieceAt(t);if(r.isPlayer())return e.replace(t,r.getOpponent()),new mo(e,this.turn);Ns.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:t.toString()})}equals(t){return this.turn===t.turn&&this.pieces.equals(t.pieces)}}class G2 extends I1{constructor(){super(mo),this.VERBOSE=!1}static get(){return G2.singleton.isAbsent()&&(G2.singleton=y.of(new G2)),G2.singleton.get()}applyLegalMove(t,e,r){return e.turn<40?e.applyLegalDrop(t.landing):e.applyLegalDeplacement(t,r)}isLegal(t,e){J(this.VERBOSE,{called:"SixRules.isLegal",move:t,state:e});const r=e.isIllegalLandingZone(t.landing,t.start);return r.isFailure()?r.toOtherFallible():e.turn<40?this.isLegalDrop(t,e):G2.isLegalPhaseTwoMove(t,e)}static getLegalLandings(t){const e=new kr;for(const r of t.getPieceCoords())for(const s of De.factory.all){const i=r.getNext(s,1);t.getPieceAt(i)===ue.NONE&&e.add(i)}return e.toList()}isLegalDrop(t,e){return!1===t.isDrop()?ve.failure(Q3.NO_MOVEMENT_BEFORE_TURN_40()):ve.success(new bt(e.getPieceCoords()))}static isLegalPhaseTwoMove(t,e){if(t.isDrop())return ve.failure(Q3.CAN_NO_LONGER_DROP());const r=e.getPieceAt(t.start.get());if(r===ue.NONE)return ve.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(r===e.getCurrentOpponent())return ve.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());const s=e.movePiece(t),i=s.getGroups();if(G2.isSplit(i)){const o=this.getLargestGroups(i);return 1===o.size()?t.keep.isPresent()?ve.failure(Q3.CANNOT_CHOOSE_TO_KEEP()):ve.success(o.getAnyElement().get()):this.moveKeepBiggerGroup(t.keep,o,s)}return ve.success(new kr)}static isSplit(t){return t.size()>1}static getLargestGroups(t){let e=0,r=new bt;for(const s of t){const i=s.size();i>e?(e=i,r=new bt([s])):i===e&&r.add(s)}return r}static moveKeepBiggerGroup(t,e,r){if(t.isAbsent())return ve.failure(Q3.MUST_CUT());if(r.getPieces().get(t.get()).isAbsent())return ve.failure(Q3.CANNOT_KEEP_EMPTY_COORD());const s=t.get();for(const i of e)if(i.contains(s))return ve.success(i);return ve.failure(Q3.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=[];if(t.move.isPresent()&&(s=this.getShapeVictory(t.move.get(),e)),6===s.length)return Ie.getVictory(r);if(e.turn>39){const i=e.countPieces(),o=i[0],c=i[1];return o<6&&c<6?o<c?Ie.ONE_WON:c<o?Ie.ZERO_WON:Ie.DRAW:o<6?Ie.getDefeat(B.ZERO):c<6?Ie.getDefeat(B.ONE):Ie.ONGOING}return Ie.ONGOING}startSearchingVictorySources(){J(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(t,e){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const r=this.searchVictoryOnly(this.currentVictorySource,t,e);if(6===r.length)return r}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing;switch(J(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(De.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];const h=(t+o.length)%6;o.push(c),c=c.getNext(De.factory.all[h],1)}return o}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=De.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return[];u=!0,i=i.getOpposite(),o=o.getNext(i,c.length)}o=o.getNext(i,1)}return c}searchVictoryOnlyForTriangleCorner(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=De.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.length%2==0&&(i=De.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return o}searchVictoryOnlyForTriangleEdge(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=De.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.push(c),o.length%2==0&&(i=De.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return o}}G2.singleton=y.empty();class F5t extends ic{calculateBoardValue(t,e){this.startSearchingVictorySources();const r={status:Pn.DEFAULT,victory:y.empty(),preVictory:y.empty(),sum:0};for(;this.hasNextVictorySource();){const s=this.getNextVictorySource();let i;if(i=r.status===Pn.PRE_VICTORY?this.searchVictoryOnly(s,t,e):this.getBoardInfo(s,t,e,r),i.status===Pn.VICTORY)return i;r.status=i.status,r.sum=r.sum+i.sum,r.preVictory.isAbsent()&&(r.preVictory=i.preVictory)}return r}}class I6 extends Fn{constructor(t,e){super(t),this.preVictory=e}}class b8 extends F5t{constructor(){super(...arguments),this.VERBOSE=!1}static get(){if(b8.singleton.isAbsent()){const t=G2.get();b8.singleton=y.of(new b8(t,"SixMinimax"))}return b8.singleton.get()}getListMoves(t){const e=b8.get(),r=t.getOwnValue(e);if(r.preVictory.isPresent())return t.gameState.turn<40?this.createForcedDrop(r):this.createForcedMovement(t,r);const s=G2.getLegalLandings(t.gameState);return t.gameState.turn<40?this.getListDrop(s):this.getMovement(t.gameState,s)}getMovement(t,e){const r=this.getSafelyMovablePieceOrFirstOne(t);return this.getMovementFrom(t,r,e)}createForcedDrop(t){J(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:t});const e=[],r=Wr.ofDrop(t.preVictory.get());return e.push(r),e}createForcedMovement(t,e){J(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:t});const r=this.getSafelyMovablePieceOrFirstOne(t.gameState),s=[e.preVictory.get()];return this.getMovementFrom(t.gameState,r,s)}getMovementFrom(t,e,r){const s=[];for(const i of e)for(const o of r){const c=Wr.ofMovement(i,o);if(t.isCoordConnected(o,y.of(i))){const h=t.movePiece(c).getGroups();if(G2.isSplit(h)){const g=G2.getLargestGroups(h);if(1===g.size())s.push(Wr.ofMovement(i,o));else for(const m of g){const E=m.getAnyElement().get(),O=Wr.ofCut(i,o,E);s.push(O)}}else s.push(c)}}return s}getSafelyMovablePieceOrFirstOne(t){const e=t.getPieces().reverse(),r=t.getCurrentPlayer(),s=e.get(r).get(),i=s.getAnyElement().get(),o=[];for(const c of s)!1===this.isPieceBlockingAVictory(t,c)&&o.push(c);return new kr(0===o.length?[i]:o)}isPieceBlockingAVictory(t,e){const r=t.switchPiece(e),s=Wr.ofDrop(e);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,s,r).status===Pn.VICTORY)return!0;return!1}getListDrop(t){const e=[];for(const r of t){const s=Wr.ofDrop(r);e.push(s)}return e}getBoardValue(t){const e=t.move,r=t.gameState,s=r.getCurrentOpponent(),i=s.getVictoryValue();let o={status:Pn.DEFAULT,victory:y.empty(),preVictory:y.empty(),sum:0};if(e.isPresent()&&(o=this.calculateBoardValue(e.get(),r)),o.status===Pn.VICTORY)return new I6(i,y.empty());if(r.turn>39){const c=r.countPieces(),u=c[0],h=c[1];return u<6&&h<6?new I6(u<h?B.ONE.getVictoryValue():h<u?B.ZERO.getVictoryValue():0,y.empty()):u<6?new I6(B.ZERO.getDefeatValue(),y.empty()):h<6?new I6(B.ONE.getDefeatValue(),y.empty()):new I6(u-h,o.preVictory)}return new I6(o.status===Pn.PRE_VICTORY?s.getPreVictory():o.sum*s.getScoreModifier(),o.preVictory)}startSearchingVictorySources(){J(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing;switch(J(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(De.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Pn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};const h=(t+o.length)%6;o.push(c),c=c.getNext(De.factory.all[h],1)}return{status:Pn.VICTORY,victory:y.of(o),preVictory:y.empty(),sum:0}}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=De.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return{status:Pn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};u=!0,i=i.getOpposite(),o=o.getNext(i,c.length-1)}o=o.getNext(i,1)}return{status:Pn.VICTORY,victory:y.of(c),preVictory:y.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=De.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Pn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};o.length%2==0&&(i=De.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return{status:Pn.VICTORY,victory:y.of(o),preVictory:y.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=De.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Pn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};o.push(c),o.length%2==0&&(i=De.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return{status:Pn.VICTORY,victory:y.of(o),preVictory:y.empty(),sum:0}}getBoardInfo(t,e,r,s){J(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:t,move:e,state:r,boardInfo:s});const i=e.landing;switch(t.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(t.index,i,r,s);case"LINE":return this.getBoardInfoForLine(t.index,i,r,s);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(t.index,i,r,s);default:return this.getBoardInfoForTriangleEdge(t.index,i,r,s)}}getBoardInfoForCircle(t,e,r,s){J(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer(),c=[e];let u=e.getNext(De.factory.all[t],1),h=0,g=y.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;const E=(t+c.length)%6;c.push(u);const O=De.factory.all[E];m===ue.NONE?(h+=.16,g=y.of(u)):h++,u=u.getNext(O,1)}return this.getBoardInfoResult(h,g,c,s)}getBoardInfoResult(t,e,r,s){let i=s.preVictory;if(4.16===t){if(J(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(e))return{status:Pn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};i=e}else if(5===t)return{status:Pn.VICTORY,victory:y.of(r),preVictory:y.empty(),sum:0};return{status:s.status,victory:y.empty(),preVictory:i,sum:s.sum+t}}getBoardInfoForLine(t,e,r,s){J(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:t,lastDrop:e,state:r,boardInfo:s});const i=De.factory.all[t];let o=e.getPrevious(i,5),c=[],u=[],h=y.empty();for(let U=0;U<6;U++){const j=this.updateEncounterAndReturnLastEmpty(r,o,u);j.isPresent()&&(h=j),c.push(o),o=o.getNext(i,1)}let g=s.status,m=s.preVictory,E=0,O=0;for(;E<6;){const U=u.reduce((oe,Ee)=>oe+Ee);if(6===U)return{status:Pn.VICTORY,victory:y.of(c),preVictory:y.empty(),sum:0};5.16===U&&g===Pn.DEFAULT&&(m.isPresent()?(We(!1===m.equals(h),"Impossible to have point aligned with differents line to a same point"),g=Pn.PRE_VICTORY):m=h),O=Math.max(O,U),c=c.slice(1,6),c.push(o),u=u.slice(1,6);const j=this.updateEncounterAndReturnLastEmpty(r,o,u);j.isPresent()&&(h=j),E++,o=o.getNext(i,1)}const k={status:g,victory:y.of(c),preVictory:m,sum:O};return this.getBoardInfoResult(O,h,c,k)}updateEncounterAndReturnLastEmpty(t,e,r){const s=t.getCurrentPlayer();switch(t.getPieceAt(e)){case s:return r.push(-7),y.empty();case ue.NONE:return r.push(.16),y.of(e);default:return r.push(1),y.empty()}}getBoardInfoForTriangleCorner(t,e,r,s){J(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=De.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,g=y.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===ue.NONE?(h+=.16,g=y.of(u)):h++,c.length%2==0&&(o=De.factory.all[(t+c.length)%6]),c.push(u),u=u.getNext(o,1)}return this.getBoardInfoResult(h,g,c,s)}getBoardInfoForTriangleEdge(t,e,r,s){J(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=De.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,g=y.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===ue.NONE?(h+=.16,g=y.of(u)):h++,c.push(u),c.length%2==0&&(o=De.factory.all[(t+c.length)%6]),u=u.getNext(o,1)}return this.getBoardInfoResult(h,g,c,s)}}b8.singleton=y.empty();const Pe=ue.NONE,Gt=B.ZERO,Jt=B.ONE;let cF=(()=>{class n{}return n.MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`,n.MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`,n})();class l4e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,mo.getInitialState()),te.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,mo.ofRepresentation([[Gt,Jt,Jt,Jt,Jt,Gt],[Pe,Gt,Jt,Pe,Gt,Pe],[Jt,Jt,Gt,Pe,Pe,Pe],[Pe,Pe,Gt,Pe,Pe,Pe],[Pe,Gt,Pe,Pe,Pe,Pe],[Gt,Pe,Pe,Pe,Pe,Pe]],0),[Wr.ofDrop(new S(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),te.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,mo.ofRepresentation([[Pe,Pe,Pe,Jt,Pe,Pe],[Pe,Pe,Jt,Jt,Gt,Gt],[Pe,Jt,Pe,Gt,Jt,Pe],[Jt,Gt,Gt,Gt,Gt,Jt]],0),[Wr.ofDrop(new S(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),te.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,mo.ofRepresentation([[Pe,Pe,Pe,Jt,Pe,Pe],[Pe,Gt,Jt,Gt,Gt,Gt],[Pe,Gt,Pe,Gt,Gt,Pe],[Jt,Jt,Jt,Pe,Jt,Pe]],0),[Wr.ofDrop(new S(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),te.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,mo.ofRepresentation([[Pe,Pe,Pe,Pe,Pe,Pe,Pe,Jt,Pe],[Pe,Pe,Pe,Pe,Pe,Pe,Gt,Pe,Pe],[Pe,Pe,Pe,Pe,Gt,Gt,Gt,Pe,Pe],[Pe,Pe,Pe,Pe,Jt,Jt,Pe,Jt,Gt],[Pe,Gt,Jt,Jt,Gt,Gt,Jt,Pe,Pe],[Gt,Gt,Gt,Gt,Jt,Jt,Jt,Gt,Pe],[Jt,Jt,Gt,Pe,Jt,Jt,Gt,Pe,Pe],[Pe,Gt,Pe,Gt,Gt,Pe,Pe,Pe,Pe],[Jt,Jt,Jt,Jt,Pe,Pe,Pe,Pe,Pe],[Pe,Gt,Pe,Jt,Pe,Pe,Pe,Pe,Pe]],40),Wr.ofMovement(new S(6,1),new S(5,1)),(t,e,r)=>{const s=r.countPieces();return 19===s[0]?18===s[1]?R.SUCCESS:R.failure(cF.MOVEMENT_NOT_DISCONNECTING()):R.failure(cF.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),te.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,mo.ofRepresentation([[Pe,Pe,Pe,Pe,Pe,Jt],[Pe,Pe,Pe,Pe,Gt,Jt],[Pe,Pe,Pe,Jt,Gt,Gt],[Pe,Pe,Gt,Pe,Jt,Gt],[Jt,Jt,Pe,Pe,Pe,Gt],[Gt,Jt,Pe,Pe,Pe,Pe],[Gt,Pe,Pe,Pe,Pe,Pe]],40),Wr.ofMovement(new S(2,3),new S(3,3)),(t,e,r)=>t.start.equalsValue(new S(2,3))?R.SUCCESS:R.failure(cF.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),te.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,mo.ofRepresentation([[Pe,Pe,Pe,Pe,Pe,Jt],[Pe,Pe,Pe,Pe,Gt,Jt],[Pe,Pe,Pe,Jt,Gt,Gt],[Gt,Pe,Gt,Pe,Pe,Jt],[Jt,Jt,Pe,Pe,Pe,Pe],[Gt,Gt,Pe,Pe,Pe,Pe],[Gt,Pe,Pe,Pe,Pe,Pe]],40),Wr.ofCut(new S(2,3),new S(2,5),new S(2,5)),(t,e,r)=>t.keep.isAbsent()?R.failure($localize`This move has not cut the board in two equal halves.`):r.getPieceAt(t.landing)===ue.NONE?R.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):R.SUCCESS,$localize`Congratulations, you won!`)]}}function B5t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",10),ee("click",function(){const i=de(e).$implicit;return le(C().onPieceClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();Le("id","piece_",e.x,"_",e.y,""),w("ngClass",r.getPieceClass(e)),z("points",r.getHexaPointsAt(e))}}function $5t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",11),ee("click",function(){const i=de(e).$implicit;return le(C().onNeighborClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();Le("id","neighbor_",e.x,"_",e.y,""),z("points",r.getHexaPointsAt(e))}}function U5t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",10),ee("click",function(){de(e);const s=C();return le(s.onPieceClick(s.chosenLanding.get()))}),A()}if(2&n){const e=C();Le("id","chosenLanding_",e.chosenLanding.get().x,"_",e.chosenLanding.get().y,""),w("ngClass",e.getPlayerClass(e.state.getCurrentPlayer())),z("points",e.getHexaPointsAt(e.chosenLanding.get()))}}function G5t(n,t){if(1&n&&(H(),X(0,"polygon",12)),2&n){const e=t.$implicit,r=C();Le("id","disconnected_",e.x,"_",e.y,""),z("points",r.getHexaPointsAt(e))}}function q5t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",13),ee("click",function(){de(e);const s=C();return le(s.onNeighborClick(s.leftCoord.get()))}),A()}if(2&n){const e=C();Le("id","leftCoord_",e.leftCoord.get().x,"_",e.leftCoord.get().y,""),z("points",e.getHexaPointsAt(e.leftCoord.get()))}}function W5t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",14),ee("click",function(){de(e);const s=C();return le(s.onPieceClick(s.lastDrop.get()))}),A()}if(2&n){const e=C();Le("id","lastDrop_",e.lastDrop.get().x,"_",e.lastDrop.get().y,""),z("points",e.getHexaPointsAt(e.lastDrop.get()))}}function j5t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",15),ee("click",function(){de(e);const s=C();return le(s.onPieceClick(s.selectedPiece.get()))}),A()}if(2&n){const e=C();Le("id","selectedPiece_",e.selectedPiece.get().x,"_",e.selectedPiece.get().y,""),w("ngClass",e.getSelectedPieceClass()),z("points",e.getHexaPointsAt(e.selectedPiece.get()))}}function Z5t(n,t){if(1&n&&(H(),X(0,"polygon",16)),2&n){const e=t.$implicit,r=C();Le("id","victoryCoord_",e.x,"_",e.y,""),z("points",r.getHexaPointsAt(e))}}function Y5t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",19),ee("click",function(){const i=de(e).$implicit;return le(C(2).onPieceClick(i))}),A()}if(2&n){const e=t.$implicit,r=C(2);Le("id","cuttable_",e.x,"_",e.y,""),z("points",r.getHexaPointsAt(e))}}function K5t(n,t){if(1&n&&(H(),b(0,"g",17),x(1,Y5t,1,3,"polygon",18),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let X5t=(()=>{class n extends Uh{constructor(e){super(e),this.disconnecteds=[],this.cuttableGroups=[],this.leftCoord=y.empty(),this.lastDrop=y.empty(),this.selectedPiece=y.empty(),this.chosenLanding=y.empty(),this.nextClickShouldSelectGroup=!1,this.rules=G2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new b8(this.rules,"SixMinimax")],this.encoder=Wr.encoder,this.tutorial=(new l4e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new Gh(1.5*this.SPACE_SIZE,new S(2*this.SPACE_SIZE,0),xs.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=y.empty(),this.chosenLanding=y.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.node.gameState,this.node.move.isAbsent()&&this.hideLastMove(),this.pieces=this.state.getPieceCoords(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}hideLastMove(){this.leftCoord=y.empty(),this.lastDrop=y.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const e=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return T6.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH).toSVGString()}showLastMove(e){this.lastDrop=y.of(e.landing),this.leftCoord=!1===e.isDrop()?y.of(e.start.get()):y.empty();const r=this.getState();this.rules.getGameStatus(this.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,r)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const e=this.getPreviousState().getPieceCoords(),r=this.getState().getPieceCoords(),s=[];for(const o of e)!1===this.node.move.get().start.equalsValue(o)&&!1===r.some(u=>u.equals(o))&&s.push(o);const i=this.lastDrop.get();return!1===this.pieces.some(o=>o.equals(i))&&!1===r.some(o=>o.equals(i))&&s.push(i),s}getEmptyNeighbors(){let e=G2.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const r=this.chosenLanding.get();e=e.filter(s=>!1===s.equals(r))}return e}getPieceClass(e){const r=this.getState().getPieceAt(e);return this.getPlayerClass(r)}onPieceClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#piece_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.state.turn<40)return r.cancelMove(Q3.NO_MOVEMENT_BEFORE_TURN_40());if(r.chosenLanding.isAbsent())return r.state.getPieceAt(e)===r.state.getCurrentOpponent()?r.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):(r.selectedPiece=r.selectedPiece.equalsValue(e)?y.empty():y.of(e),R.SUCCESS);{const i=Wr.ofCut(r.selectedPiece.get(),r.chosenLanding.get(),e);return r.chooseMove(i)}})()}onNeighborClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#neighbor_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.nextClickShouldSelectGroup)return r.cancelMove(Q3.MUST_CUT());if(r.state.turn<40)return r.chooseMove(Wr.ofDrop(e));if(r.selectedPiece.isAbsent())return r.cancelMove(Q3.CAN_NO_LONGER_DROP());{const i=Wr.ofMovement(r.selectedPiece.get(),e),o=G2.isLegalPhaseTwoMove(i,r.state);return r.neededCutting(o)?(r.chosenLanding=y.of(e),r.moveVirtuallyPiece(),r.showCuttable(),r.nextClickShouldSelectGroup=!0,R.SUCCESS):r.chooseMove(i)}})()}neededCutting(e){return e.isFailure()&&e.getReason()===Q3.MUST_CUT()}moveVirtuallyPiece(){const e=this.selectedPiece.get();this.pieces=this.pieces.filter(r=>!1===r.equals(e)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const e=Wr.ofMovement(this.selectedPiece.get(),this.chosenLanding.get()),s=this.state.movePiece(e).getGroups(),i=G2.getLargestGroups(s);this.cuttableGroups=[];for(const o of i)this.cuttableGroups.push(o.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-six"]],features:[l],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,B5t,1,4,"polygon",1),x(2,$5t,1,3,"polygon",2),x(3,U5t,1,4,"polygon",3),x(4,G5t,1,3,"polygon",4),x(5,q5t,1,3,"polygon",5),x(6,W5t,1,3,"polygon",6),x(7,j5t,1,4,"polygon",7),x(8,Z5t,1,3,"polygon",8),x(9,K5t,2,1,"g",9),A()),2&e&&(z("viewBox",r.viewBox),T(1),w("ngForOf",r.pieces),T(1),w("ngForOf",r.neighbors),T(1),w("ngIf",r.chosenLanding.isPresent()),T(1),w("ngForOf",r.disconnecteds),T(1),w("ngIf",r.leftCoord.isPresent()),T(1),w("ngIf",r.lastDrop.isPresent()),T(1),w("ngIf",r.selectedPiece.isPresent()),T(1),w("ngForOf",r.victoryCoords),T(1),w("ngForOf",r.cuttableGroups))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Aa extends FH{static of(t,e){return new Aa(t,e)}static from(t,e){try{const r=new Aa(t,e);return ve.success(r)}catch(r){return ve.failure(r.message)}}getMaximalDistance(){return 9}}Aa.encoder=Pa.getFallibleEncoder(Aa.from);const Q5t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:B.ZERO};class sl extends BH{static getInitialState(){const t=Tn.UNOCCUPIED,e=Tn.INVADERS,r=Tn.DEFENDERS;return new sl([[t,t,t,e,e,e,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,t,r,t,t,t,t],[e,t,t,t,r,t,t,t,e],[e,e,r,r,Tn.PLAYER_ONE_KING,r,r,e,e],[e,t,t,t,r,t,t,t,e],[t,t,t,t,r,t,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,e,e,e,t,t,t]],0)}of(t,e){return new sl(t,e)}}class A8 extends $H{constructor(){super(sl,Q5t,Aa.from)}static get(){return A8.singleton.isAbsent()&&(A8.singleton=y.of(new A8)),A8.singleton.get()}}A8.singleton=y.empty();const Z=Tn.UNOCCUPIED,s1=Tn.INVADERS,_o=Tn.DEFENDERS,fT=Tn.PLAYER_ONE_KING;class u4e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,sl.getInitialState()),te.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,sl.getInitialState(),Aa.of(new S(4,1),new S(1,1)),$localize`Congratulations!`),te.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new sl([[Z,Z,Z,s1,s1,s1,Z,Z,Z],[Z,Z,Z,Z,s1,Z,Z,Z,Z],[Z,Z,Z,Z,_o,Z,Z,Z,Z],[Z,Z,Z,s1,_o,Z,Z,Z,s1],[s1,s1,_o,_o,fT,_o,_o,s1,s1],[Z,Z,Z,Z,_o,Z,Z,Z,s1],[Z,Z,Z,Z,_o,Z,Z,Z,Z],[Z,Z,Z,Z,s1,Z,Z,Z,Z],[Z,Z,Z,s1,s1,s1,Z,Z,Z]],1),[Aa.of(new S(2,4),new S(2,3)),Aa.of(new S(4,2),new S(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),te.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new sl([[Z,Z,Z,s1,s1,s1,Z,Z,Z],[Z,Z,Z,Z,s1,Z,Z,Z,Z],[Z,Z,Z,Z,_o,Z,Z,Z,Z],[Z,Z,_o,Z,fT,Z,_o,Z,s1],[s1,s1,Z,_o,Z,_o,_o,s1,s1],[Z,Z,Z,Z,_o,Z,Z,Z,s1],[Z,Z,Z,Z,_o,Z,Z,Z,Z],[Z,Z,Z,Z,s1,Z,Z,Z,Z],[Z,Z,Z,s1,s1,s1,Z,Z,Z]],12),[Aa.of(new S(1,4),new S(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),te.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new sl([[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,s1,Z,Z,Z,Z,Z,Z,Z],[s1,fT,Z,s1,Z,Z,Z,Z,Z],[Z,s1,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z]],72),[Aa.of(new S(3,4),new S(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),te.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new sl([[Z,Z,s1,fT,s1,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,s1,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z]],72),[Aa.of(new S(3,3),new S(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function J5t(n,t){1&n&&(H(),X(0,"polygon",8))}function e7t(n,t){1&n&&(H(),X(0,"rect",9))}function t7t(n,t){if(1&n&&(H(),b(0,"g"),x(1,J5t,1,0,"polygon",6),x(2,e7t,1,0,"ng-template",null,7,qn),A()),2&n){const e=Hn(3),r=C().index,s=C().index,i=C();T(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function n7t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=C(2).index,r=C().index,s=C();T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function r7t(n,t){if(1&n&&(H(),X(0,"polyline",16)),2&n){const e=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][e])}}function s7t(n,t){if(1&n&&(H(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function i7t(n,t){if(1&n&&(H(),x(0,r7t,1,1,"polyline",14),x(1,s7t,4,20,"ng-template",null,15,qn)),2&n){const e=Hn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",e)}}function o7t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"circle",10),x(2,n7t,6,25,"g",11),x(3,i7t,3,2,"ng-template",null,12,qn),A()),2&n){const e=Hn(4),r=C().index,s=C().index,i=C();T(1),Le("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),z("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),T(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function a7t(n,t){if(1&n){const e=Ae();H(),b(0,"g",3),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),X(1,"rect",4),x(2,t7t,4,2,"g",5),x(3,o7t,5,8,"g",5),A()}if(2&n){const e=t.index,r=C().index,s=C();Le("id","click_",e,"_",r,""),z("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),T(1),Le("id","space_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),T(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function c7t(n,t){if(1&n&&(H(),b(0,"g"),x(1,a7t,4,10,"g",2),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function l7t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"rect",17),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),Le("id","click_",e.x,"_",e.y,""),z("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let u7t=(()=>{class n extends UH{constructor(e){super(e,!1,Aa.from),this.rules=A8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new xP(this.rules,"DummyBot"),new LP(this.rules,"Piece > Influence"),new RP(this.rules,"Piece > Control"),new GH(this.rules,"Escape > Piece > Control")],this.encoder=Aa.encoder,this.tutorial=(new u4e).tutorial,this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-tablut"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,c7t,2,1,"g",1),x(2,l7t,2,6,"g",1),A()),2&e&&(z("viewBox",r.getViewBox()),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getClickables()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),dc=(()=>{class n extends xr{static isOnBoard(e){return e.isInRange(n.WIDTH,n.WIDTH)}static getInitialState(){const e=Je.createTable(n.WIDTH,n.WIDTH,ue.NONE);return new n(e,0)}isInDropPhase(){return this.turn<8}}return n.WIDTH=5,n})();class pc extends ms{static from(t){return dc.isOnBoard(t)?ve.success(new pc(t.x,t.y)):ve.failure($h.OUT_OF_RANGE(t))}toString(){return"TeekoMove"+this.coord.toString()}equals(t){return t instanceof pc&&super.equals(t)}}pc.encoder=ms.getFallibleEncoder(pc.from);class Na extends Hc{static from(t,e){return!1===dc.isOnBoard(t)?ve.failure($h.OUT_OF_RANGE(t)):!1===dc.isOnBoard(e)?ve.failure($h.OUT_OF_RANGE(e)):t.equals(e)?ve.failure(Xe.MOVE_CANNOT_BE_STATIC()):ve.success(new Na(t,e))}toString(){return"TeekoMove("+this.getStart().toString()+" -> "+this.getEnd().toString()+")"}equals(t){return t instanceof Na&&super.equals(t)}}var lF;Na.encoder=Hc.getFallibleEncoder(Na.from),function(n){n.encoder=Ye.disjunction([t=>t instanceof pc,t=>t instanceof Na],[pc.encoder,Na.encoder])}(lF||(lF={}));class gc extends I1{constructor(){super(dc)}static get(){return gc.singleton.isAbsent()&&(gc.singleton=y.of(new gc)),gc.singleton.get()}isLegal(t,e){return e.isInDropPhase()?this.isLegalDrop(t,e):this.isLegalTranslation(t,e)}isLegalDrop(t,e){return ge.assert(t instanceof pc,"Cannot translate in dropping phase !"),e.getPieceAt(t.coord).isPlayer()?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):R.SUCCESS}isLegalTranslation(t,e){ge.assert(t instanceof Na,"Cannot drop in translation phase !");const r=t,s=e.getCurrentOpponent();return e.getPieceAt(r.getStart())===s?R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):e.getPieceAt(r.getStart())===ue.NONE?R.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):e.getPieceAt(r.getEnd()).isPlayer()?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):R.SUCCESS}applyLegalMove(t,e){return t instanceof pc?this.applyLegalDrop(t,e):this.applyLegalTranslate(t,e)}applyLegalDrop(t,e){const r=e.getCopiedBoard();return r[t.coord.y][t.coord.x]=e.getCurrentPlayer(),new dc(r,e.turn+1)}applyLegalTranslate(t,e){const r=e.getCopiedBoard();return r[t.getStart().y][t.getStart().x]=ue.NONE,r[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer(),new dc(r,e.turn+1)}getGameStatus(t){const e=t.gameState;return this.getVictoryCoord(e).length>0?Ie.getVictory(e.getCurrentOpponent()):Ie.ONGOING}getLastCoord(t){return t instanceof pc?t.coord:t.getEnd()}getSquareInfo(t){const e=[],r=[0,0];for(let s=0;s<dc.WIDTH-1;s++)for(let i=0;i<dc.WIDTH-1;i++){const o=new S(s,i),c=new S(s+1,i),u=new S(s,i+1),h=new S(s+1,i+1),g=[t.getPieceAt(o),t.getPieceAt(c),t.getPieceAt(u),t.getPieceAt(h)],m=this.count(g,ue.NONE),E=this.count(g,ue.ZERO),O=this.count(g,ue.ONE);m<4&&(4===E||4===O?e.push(o,c,u,h):E>0?r[0]=r[0]+1:r[1]=r[1]+1)}return{score:r[1]-r[0],victoriousCoords:e}}count(t,e){let r=0;for(const s of t)s===e&&r++;return r}getVictoryCoord(t){const e=gc.TEEKO_HELPER.getVictoriousCoord(t);return e.push(...this.getSquareInfo(t).victoriousCoords),e}}gc.singleton=y.empty(),gc.TEEKO_HELPER=new Wh(dc.isOnBoard,ge.identity,4);class f7t extends ic{constructor(){super(gc.get(),"Teeko Minimax")}getListMoves(t){return t.gameState.isInDropPhase()?this.getListDrops(t.gameState):this.getListTranslations(t.gameState)}getListDrops(t){const e=[];for(const r of t.getCoordsAndContents()){const s=r.coord;if(!1===t.getPieceAt(s).isPlayer()){const i=pc.from(s).get();e.push(i)}}return e}getListTranslations(t){const e=[],r=t.getCurrentPlayer(),s=this.getCoordsContaining(t,r),i=this.getCoordsContaining(t,ue.NONE);for(const o of s)for(const c of i){const u=Na.from(o,c).get();e.push(u)}return e}getCoordsContaining(t,e){const r=[];for(const s of t.getCoordsAndContents())s.content===e&&r.push(s.coord);return r}getBoardValue(t){const e=gc.TEEKO_HELPER.getBoardValue(t.gameState).value;if(Fn.VICTORIES.some(r=>r===e))return new Fn(e);{const r=gc.get().getSquareInfo(t.gameState);return r.victoriousCoords.length>0?Fn.fromWinner(t.gameState.getCurrentOpponent()):new Fn(r.score+e)}}}const y1=ue.NONE,N8=ue.ZERO,I8=ue.ONE;class f4e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`The goal of the game is to align your 4 pieces, or to form a square with them.`,dc.getInitialState()),te.anyMove($localize`Dropping a piece`,$localize`During your first four turns, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,dc.getInitialState(),pc.from(new S(2,2)).get(),$localize`Congratulations!`),te.anyMove($localize`Moving a piece`,$localize`Once all of your four pieces are placed on the board, you must now move one of your piece to another empty space. The goal remain to be the first to create a line or a square.<br/><br/>You're playing Dark, move a piece.`,new dc([[N8,I8,y1,y1,y1],[N8,N8,y1,y1,y1],[I8,I8,y1,y1,y1],[I8,N8,y1,y1,y1],[y1,y1,y1,y1,y1]],8),Na.from(new S(1,3),new S(2,1)).get(),$localize`Congratulations!`),te.fromMove($localize`Victory`,$localize`In this board, you can win either by creating a line, or a square.<br/><br/>You are playing Dark, win.`,new dc([[I8,y1,y1,y1,y1],[I8,N8,y1,y1,y1],[y1,N8,N8,I8,y1],[y1,I8,y1,N8,y1],[y1,y1,y1,y1,y1]],8),[Na.from(new S(1,2),new S(4,4)).get(),Na.from(new S(3,3),new S(2,1)).get()],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)]}}function h7t(n,t){if(1&n&&(H(),X(0,"circle",4)),2&n){const e=C().index,r=C().index,s=C();Le("id","piece_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),z("r",42)("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)}}function d7t(n,t){if(1&n){const e=Ae();H(),b(0,"g",3),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),X(1,"rect",4),x(2,h7t,1,6,"circle",5),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();Le("id","click_",r,"_",s,""),T(1),Le("id","space_",r,"_",s,""),w("ngClass",i.getSpaceClasses(r,s)),z("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e.isPlayer())}}function p7t(n,t){if(1&n&&(H(),b(0,"g"),x(1,d7t,3,10,"g",2),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let g7t=(()=>{class n extends ao{constructor(e){super(e),this.selected=y.empty(),this.last=y.empty(),this.moved=[],this.victory=[],this.rules=gc.get(),this.node=this.rules.getInitialNode(),this.encoder=lF.encoder,this.tutorial=(new f4e).tutorial,this.availableMinimaxes=[new f7t]}updateBoard(){this.board=this.node.gameState.board}showLastMove(e){this.hideLastMove(),this.last=y.of(this.rules.getLastCoord(e)),this.moved=e instanceof Na?[e.getStart(),e.getEnd()]:[],this.victory=this.rules.getVictoryCoord(this.getState())}hideLastMove(){this.last=y.empty(),this.moved=[],this.victory=[]}cancelMoveAttempt(){this.selected=y.empty()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);if(s.getState().isInDropPhase()){const c=pc.from(o).get();return s.chooseMove(c)}if(s.selected.isPresent()){if(s.selected.equalsValue(o))return s.selected=y.empty(),R.SUCCESS;{const c=Na.from(s.selected.get(),o).get();return s.chooseMove(c)}}{const c=s.getState().getCurrentPlayer(),u=s.getState().getPieceAt(o);return u===c?(s.selected=y.of(o),R.SUCCESS):s.cancelMove(u===ue.NONE?Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Xe.CANNOT_CHOOSE_OPPONENT_PIECE())}})()}getPieceClasses(e,r){const s=new S(e,r),o=[this.getPlayerClass(this.getState().getPieceAt(s))];return this.victory.some(c=>c.equals(s))?o.push("victory-stroke"):this.last.equalsValue(s)?o.push("last-move-stroke"):this.selected.equalsValue(s)&&o.push("selected-stroke"),o}getSpaceClasses(e,r){const s=new S(e,r);return this.moved.some(i=>i.equals(s))?["moved-fill"]:[]}}return n.\u0275fac=function(e){return new(e||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-teeko"]],features:[l],decls:2,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 510 510","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"]],template:function(e,r){1&e&&(H(),b(0,"svg",0),x(1,p7t,2,1,"g",1),A()),2&e&&(T(1),w("ngForOf",r.board))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class q2{constructor(t,e){this.owner=t,this.tileId=e}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class Hs{constructor(t){this.pieces=t}static of(t){let e=-1;for(const r of t)We(e<r.tileId,"TrexoPieceStack: dropped turn should be ascending"),e=r.tileId;return new Hs(t)}getHeight(){return this.pieces.length}getOwner(){const t=this.pieces.length;return 0===t?ue.NONE:this.pieces[t-1].owner}getUpperTileId(){const t=this.pieces.length;return 0===t?-1:this.pieces[t-1].tileId}add(t){return Hs.of(this.pieces.concat(t))}getPieceAt(t){return We(t<this.pieces.length,"no element "+t+"in piece!"),this.pieces[t]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(t=>"("+t.toString()+")").join(" ")+"]"}}Hs.EMPTY=Hs.of([]);let is=(()=>{class n extends xr{static getInitialState(){const e=Je.createTable(n.SIZE,n.SIZE,Hs.EMPTY);return new n(e,0)}static of(e,r){ge.assert(e.length===n.SIZE,"Invalid board dimensions");for(const s of e)ge.assert(s.length===n.SIZE,"Invalid board dimensions");return new n(e,r)}drop(e,r){const s=this.getCopiedBoard(),i=new q2(r,this.turn);return s[e.y][e.x]=s[e.y][e.x].add(i),new n(s,this.turn)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(e=>"["+e.map(r=>"TrexoPieceStack.of("+r.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(e,r,s){return this.getPieceAtXY(e,r).getPieceAt(s)}}return n.SIZE=10,n})(),hT=(()=>{class n{}return n.NON_NEIGHBORING_SPACES=()=>$localize`Those two spaces are not neighbors!`,n.NO_WAY_TO_DROP_IT_HERE=()=>$localize`There is no way to put a piece there!`,n.CANNOT_DROP_ON_ONLY_ONE_PIECE=()=>$localize`You cannot drop on only one piece!`,n.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS=()=>$localize`You cannot drop a piece on uneven grounds!`,n})();class Ia extends Pa{constructor(t,e){super(t,e)}static from(t,e){return ge.assert(t.isInRange(is.SIZE,is.SIZE),`${t.toString()} is out of the TrexoBoard!`),ge.assert(e.isInRange(is.SIZE,is.SIZE),`${e.toString()} is out of the TrexoBoard!`),1===t.getOrthogonalDistance(e)?ve.success(new Ia(t,e)):ve.failure(hT.NON_NEIGHBORING_SPACES())}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(t){return this.getFirst().equals(t.getFirst())&&this.getSecond().equals(t.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}Ia.encoder=Pa.getFallibleEncoder(Ia.from);class r2 extends I1{constructor(){super(is)}static get(){return r2.instance.isAbsent()&&(r2.instance=y.of(new r2)),r2.instance.get()}static getOwner(t){return t.getOwner()}static isInRange(t){return t.isInRange(is.SIZE,is.SIZE)}applyLegalMove(t,e,r){return e.drop(t.getZero(),B.ZERO).drop(t.getOne(),B.ONE).incrementTurn()}isLegal(t,e){return this.isUnevenGround(t,e)?R.failure(hT.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(t,e)?R.failure(hT.CANNOT_DROP_ON_ONLY_ONE_PIECE()):R.SUCCESS}isUnevenGround(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return r.getHeight()!==s.getHeight()}landsOnOnlyOnePiece(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return(-1!==r.getUpperTileId()||-1!==s.getUpperTileId())&&r.getUpperTileId()===s.getUpperTileId()}static getSquareScore(t,e){return r2.TREXO_HELPER.getSquareScore(t,e)}static getVictoriousCoords(t){const e=[],r=[],s=t.getCurrentOpponent();for(const i of t.toMap()){const o=i.key,c=t.getPieceAt(o).getOwner();if(c.isPlayer()){const u=r2.getSquareScore(t,o);mr.getScoreStatus(u)===Pn.VICTORY&&(c===s?e.push(o):r.push(o))}}return r.length>0?r:e}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=!1;for(const i of e.toMap()){const o=i.key,c=e.getPieceAt(o).getOwner();if(c.isPlayer()){const u=r2.getSquareScore(e,o);if(mr.getScoreStatus(u)===Pn.VICTORY){if(c!==r)return Ie.getDefeat(r);s=!0}}}return s?Ie.getVictory(r):Ie.ONGOING}getLegalMoves(t){const e=[];for(const r of t.toMap()){const s=r.key;if(s.x+1<is.SIZE){const i=new S(s.x+1,s.y);e.push(...this.getPossiblesMoves(t,s,i))}if(s.y+1<is.SIZE){const i=new S(s.x,s.y+1);e.push(...this.getPossiblesMoves(t,s,i))}}return e}getPossiblesMoves(t,e,r){const s=t.getPieceAt(e),i=t.getPieceAt(r);let o;o=!s.isGround()&&s.getUpperTileId()===i.getUpperTileId();const c=s.getHeight()!==i.getHeight();return o||c?[]:[Ia.from(e,r).get(),Ia.from(r,e).get()]}}r2.instance=y.empty(),r2.TREXO_HELPER=new Wh(r2.isInRange,r2.getOwner,5);class m7t extends ic{getListMoves(t){return r2.get().getLegalMoves(t.gameState)}getBoardValue(t){let e=0;const r=t.gameState,s=r.getCurrentOpponent();let i=!1;for(const o of r.toMap()){const c=r.getPieceAt(o.key).getOwner();if(c.isPlayer()){const u=r2.getSquareScore(r,o.key);if(mr.getScoreStatus(u)===Pn.VICTORY){if(c!==s)return new Fn(s.getDefeatValue());i=!0}else e+=u}}return new Fn(i?s.getVictoryValue():e)}}const fe=Hs.EMPTY,h4e=Hs.of([new q2(B.ONE,0)]),_7t=Hs.of([new q2(B.ZERO,0)]),v7t=Hs.of([new q2(B.ONE,1)]),d4e=Hs.of([new q2(B.ZERO,1)]),C7t=Hs.of([new q2(B.ZERO,2)]),y7t=Hs.of([new q2(B.ONE,2)]),E7t=Hs.of([new q2(B.ZERO,0),new q2(B.ZERO,3)]),M7t=Hs.of([new q2(B.ONE,1),new q2(B.ONE,3)]),S7t=Hs.of([new q2(B.ZERO,4)]),P7t=Hs.of([new q2(B.ONE,4)]),T7t=Hs.of([new q2(B.ZERO,5)]),w7t=Hs.of([new q2(B.ONE,5)]),O7t=Hs.of([new q2(B.ONE,6)]),b7t=Hs.of([new q2(B.ZERO,6)]);class p4e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,is.getInitialState()),te.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,is.getInitialState(),Ia.from(new S(4,4),new S(3,4)).get(),$localize`Congratulations!`),te.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new is([[fe,fe,fe,h4e,_7t,d4e,v7t,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe]],7),[Ia.from(new S(4,0),new S(5,0)).get(),Ia.from(new S(5,0),new S(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),te.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new is([[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,T7t,fe,fe,fe,fe,fe,fe],[fe,fe,fe,w7t,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,h4e,fe,fe,S7t,P7t,fe],[fe,fe,fe,fe,E7t,M7t,d4e,fe,fe,fe],[fe,fe,fe,fe,fe,C7t,O7t,b7t,fe,fe],[fe,fe,fe,fe,fe,y7t,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe]],7),Ia.from(new S(2,0),new S(2,1)).get(),(t,e,r)=>r2.TREXO_HELPER.getSquareScore(r,t.getOne())===Number.MAX_SAFE_INTEGER?R.SUCCESS:R.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)]}}function A7t(n,t){if(1&n){const e=Ae();H(),b(0,"g")(1,"polygon",5),ee("click",function(){const i=de(e).index,o=C().index;return le(C().onClick(i,o))}),A()()}if(2&n){const e=t.index,r=C().index,s=C();T(1),Le("id","space_",e,"_",r,""),w("ngClass",s.getSpaceClasses(e,r)),z("points",s.getParallelogramPoints())("transform",s.getTranslate(e,r,0))}}function N7t(n,t){if(1&n&&(H(),b(0,"g"),x(1,A7t,2,5,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function I7t(n,t){if(1&n){const e=Ae();H(),b(0,"g",8),ee("click",function(){de(e);const s=C().index,i=C().index;return le(C(2).onClick(s,i))}),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C().index,c=C();J2("id","half_tile_",r,"_",i,"_",o,""),w("mode",c.mode)("coord",c.Coord3D.of(r,i,o))("mustDisplayHeight","2D"===c.chosenMode)("move",s.move.get())("pieceClasses",c.getPieceClasses(r,i,o)),z("transform",c.getTranslate(r,i,o+1))}}const g4e=function(n){return[n]};function x7t(n,t){if(1&n){const e=Ae();H(),b(0,"g",9),ee("click",function(){de(e);const s=C().index,i=C().index;return le(C(2).onClick(s,i))}),A()}if(2&n){const e=C().index,r=C().index,s=C().index,i=C();J2("id","dropped_piece_",e,"_",r,"_",s,""),w("mode",i.mode)("coord",i.Coord3D.of(e,r,s))("pieceClasses",I3(7,g4e,i.currentOpponentClass)),z("transform",i.getTranslate(e,r,s+1))}}function k7t(n,t){if(1&n&&(H(),b(0,"g"),x(1,I7t,1,9,"g",6),x(2,x7t,1,9,"g",7),A()),2&n){const e=t.$implicit;T(1),w("ngIf",e.move.isPresent()),T(1),w("ngIf",e.isDroppedPiece)}}function L7t(n,t){if(1&n&&(H(),b(0,"g"),x(1,k7t,3,2,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function R7t(n,t){if(1&n&&(H(),b(0,"g"),x(1,L7t,2,1,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}const D7t=function(){return["player0-fill"]};function z7t(n,t){if(1&n){const e=Ae();H(),b(0,"g",10),ee("click",function(){return de(e),le(C().switchToMode("3D"))}),A()}if(2&n){const e=C();w("mode",e.TrexoComponent.modeMap["3D"])("coord",e.Coord3D.of(10.5,8.5,0))("pieceClasses",er(4,D7t)),z("transform",e.get3DSwitcherTransform())}}function V7t(n,t){if(1&n){const e=Ae();H(),b(0,"g",11),ee("click",function(){return de(e),le(C().switchToMode("2D"))}),A()}if(2&n){const e=C();w("mode",e.TrexoComponent.modeMap["2D"])("coord",e.Coord3D.of(12,9,0))("pieceClasses",I3(4,g4e,e.currentPlayerClass)),z("transform",e.getTranslate(12,9,0))}}class u1 extends k3e{constructor(t){super(t),this.TrexoComponent=u1,this.left=-this.STROKE_WIDTH/2,this.Coord3D=m_,this.up=0,this.chosenMode="3D",this.victoryCoords=[],this.droppedPiece=y.empty(),this.possibleNextClicks=[],this.possibleMoves=[],this.pieceOnBoard=[],this.currentOpponentClass="player1",this.currentPlayerClass="player0",this.rules=r2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new m7t(this.rules,"TrexoMinimax")],this.encoder=Ia.encoder,this.tutorial=(new p4e).tutorial,u1.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D"),this.updateBoard()}switchToMode(t){this.chosenMode=t,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=u1.modeMap[t]}getViewBoxWidth(){const t=u1.modeMap["3D"],e=is.SIZE;return"2D"===this.chosenMode?(e+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:e*(this.SPACE_SIZE*(t.horizontalWidthRatio+t.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const e=is.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?e:this.STROKE_WIDTH+e+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const t=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+t)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*u1.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(){const t=this.getState();this.board=t.getCopiedBoard(),this.currentOpponentClass=this.getPlayerClass(t.getCurrentOpponent()),this.currentPlayerClass=this.getPlayerClass(t.getCurrentPlayer()),this.possibleMoves=this.rules.getLegalMoves(t),this.victoryCoords=r2.getVictoriousCoords(t),this.pieceOnBoard=this.get3DBoard(),this.height=this.getViewBoxHeight(),this.up=this.getViewBoxUp()}get3DBoard(){const t=Je.create3DTable(1,is.SIZE,is.SIZE,u1.INITIAL_PIECE_ON_BOARD);let e=1;for(let r=0;r<=e;r++)for(const s of this.getState().toMap()){const i=s.key,o=s.value.getHeight();if(e=Math.max(e,o),r<o){const c=this.extractMoveFromState(i.x,i.y,r);this.addMoveToArray(r,c,t)}}return t}extractMoveFromState(t,e,r){const s=this.getState().getPieceAtXYZ(t,e,r),i=new S(t,e);let o=new S(-2,-2);for(const c of be.ORTHOGONALS){const u=i.getNext(c);if(u.isInRange(is.SIZE,is.SIZE)){const h=this.getState().getPieceAt(u);h.getHeight()>r&&h.getPieceAt(r).tileId===s.tileId&&(o=u)}}return s.owner===B.ZERO?Ia.from(i,o).get():Ia.from(o,i).get()}addMoveToArray(t,e,r){for(;r.length<=t;)r.push(Je.createTable(is.SIZE,is.SIZE,u1.INITIAL_PIECE_ON_BOARD));r[t][e.getZero().y][e.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:y.of(e)},r[t][e.getOne().y][e.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:y.of(e)}}onClick(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#space_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(t,e);if(r.droppedPiece.isPresent()){const o=r.droppedPiece.get();if(r.droppedPiece.equalsValue(i))return r.cancelMoveAttempt(),R.SUCCESS;if(r.possibleNextClicks.some(c=>c.equals(i))){const c=r.getState().getCurrentPlayer()===B.ZERO,g=Ia.from(c?i:o,c?o:i).get();return r.chooseMove(g)}r.deselectPiece()}return r.selectPiece(i)})()}deselectPiece(){const t=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),e=this.droppedPiece.get().y,r=this.droppedPiece.get().x;this.pieceOnBoard[t][e][r]=u1.INITIAL_PIECE_ON_BOARD;for(const s of this.possibleNextClicks)this.pieceOnBoard[t][s.y][s.x].isPossibleClick=!1}selectPiece(t){if(this.possibleMoves.some(e=>e.getZero().equals(t))){const e=this.getState().getPieceAt(t).getHeight();return e>=this.pieceOnBoard.length&&this.pieceOnBoard.push(Je.createTable(is.SIZE,is.SIZE,u1.INITIAL_PIECE_ON_BOARD)),this.showDroppedPieceAndIndicators(t,e),R.SUCCESS}return this.cancelMove(hT.NO_WAY_TO_DROP_IT_HERE())}showDroppedPieceAndIndicators(t,e){this.droppedPiece=y.of(t),this.possibleNextClicks=this.getPossibleNextClicks(t);for(const r of this.possibleNextClicks)this.pieceOnBoard[e][r.y][r.x]={isDroppedPiece:!1,isPossibleClick:!0,move:y.empty()};this.pieceOnBoard[e][t.y][t.x]={isDroppedPiece:!0,isPossibleClick:!1,move:y.empty()}}getPossibleNextClicks(t){return this.possibleMoves.filter(r=>r.getZero().equals(t)).map(r=>r.getOne())}cancelMoveAttempt(){this.droppedPiece=y.empty(),this.possibleNextClicks=[],this.updateBoard()}getPieceClasses(t,e,r){const s=new S(t,e),i=this.getState().getPieceAtXYZ(t,e,r).owner;let o=[this.getPlayerClass(i)];o=o.concat(this.getSpaceClasses(t,e));for(const c of this.victoryCoords)if(c.equals(s)){o.push("victory-stroke");break}if(this.node.move.isPresent()){const c=this.node.move.get();(c.getZero().equals(s)||c.getOne().equals(s))&&o.push("last-move-stroke")}return o}getSpaceClasses(t,e){for(const r of this.pieceOnBoard)if(r[e][t].isPossibleClick)return["darker"];return[]}getTranslate(t,e,r){const i=this.getCoordTranslate(t,e,r,u1.modeMap[this.chosenMode]);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(e=>e.x+" "+e.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(u1.modeMap[this.chosenMode])}get3DSwitcherTransform(){const t=u1.modeMap["3D"],e=t.horizontalWidthRatio+t.offsetRatio;return"translate("+(10+t.offsetRatio)*t.parallelogramHeight+", "+(9+(1-1/e)/2)*t.parallelogramHeight+") scale("+1/e+")"}}u1.VERBOSE=!1,u1.INITIAL_PIECE_ON_BOARD={isDroppedPiece:!1,isPossibleClick:!1,move:y.empty()},u1.modeMap={"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}},u1.\u0275fac=function(t){return new(t||u1)(Q(_n))},u1.\u0275cmp=ct({type:u1,selectors:[["app-trexo"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(t,e){if(1&t&&(H(),b(0,"svg",0),x(1,N7t,2,1,"g",1),x(2,R7t,2,1,"g",1),b(3,"g",null,2),x(5,z7t,1,5,"g",3),x(6,V7t,1,6,"ng-template",null,4,qn),A()()),2&t){const r=Hn(7);z("viewBox",e.left+" "+e.up+" "+e.width+" "+e.height),T(1),w("ngForOf",e.board),T(1),w("ngForOf",e.pieceOnBoard),T(3),w("ngIf","2D"===e.chosenMode)("ngIfElse",r)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class zr{}zr.PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`,zr.NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`,zr.MISSING_CAPTURES=Zc.MISSING_CAPTURES,zr.MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`,zr.CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`,zr.SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`,zr.SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`,zr.MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`,zr.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`,zr.AMBIGUOUS_CAPTURE_COORD=Zc.AMBIGUOUS_CAPTURE_COORD,zr.CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`;class Nt{constructor(t,e){this.player=t,this.isRing=e}static of(t,e){return t===ue.NONE?Nt.EMPTY:e?Nt.RINGS[t.value]:Nt.MARKERS[t.value]}equals(t){return this===t}flip(){return We(!1===this.isRing,"cannot flip a ring (it should never happen)"),We(this.player.isPlayer(),"cannot flip a non-player piece"),Nt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case Nt.UNREACHABLE:return"NONE";case Nt.EMPTY:return"EMPTY";case Nt.MARKER_ZERO:return"MARKER_ZERO";case Nt.MARKER_ONE:return"MARKER_ONE";case Nt.RING_ZERO:return"RING_ZERO";default:return ge.expectToBe(this,Nt.RING_ONE),"RING_ONE"}}}Nt.encoder=Ye.tuple([ue.encoder,Ye.identity()],n=>[n.player,n.isRing],n=>Nt.of(n[0],n[1])),Nt.UNREACHABLE=new Nt(ue.NONE,!1),Nt.EMPTY=new Nt(ue.NONE,!1),Nt.MARKER_ZERO=new Nt(B.ZERO,!1),Nt.MARKER_ONE=new Nt(B.ONE,!1),Nt.MARKERS=[Nt.MARKER_ZERO,Nt.MARKER_ONE],Nt.RING_ZERO=new Nt(B.ZERO,!0),Nt.RING_ONE=new Nt(B.ONE,!0),Nt.RINGS=[Nt.RING_ZERO,Nt.RING_ONE];let t3=(()=>{class n extends ZH{constructor(e,r,s){super(s,e,n.SIZE,n.SIZE,[6,4,3,2,1],Nt.EMPTY),this.sideRings=r}static getInitialState(){const e=Nt.EMPTY,r=Nt.UNREACHABLE;return new n([[r,r,r,r,r,r,e,e,e,e,r],[r,r,r,r,e,e,e,e,e,e,e],[r,r,r,e,e,e,e,e,e,e,e],[r,r,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,r,r],[e,e,e,e,e,e,e,e,r,r,r],[e,e,e,e,e,e,e,r,r,r,r],[r,e,e,e,e,r,r,r,r,r,r]],[5,5],0)}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&Je.compareTable(this.board,e.board)}getRingCoords(e){const r=[];return this.forEachCoord((s,i)=>{i.isRing&&i.player===e&&r.push(s)}),r}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Nt.UNREACHABLE}setAtUnsafe(e,r){const s=Je.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.sideRings,this.turn)}}return n.SIZE=11,n})();class n3 extends Si{constructor(t,e=y.empty()){if(super(t),5!==t.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=e}static of(t,e,r){const s=[],i=De.factory.fromMove(t,e).get();for(let o=t;!1===o.equals(e);o=o.getNext(i))s.push(o);return s.push(e),new n3(s,r)}setRingTaken(t){return new n3(this.capturedSpaces,y.of(t))}equals(t){return!(!1===super.equals(t)||!1===this.ringTaken.equals(t.ringTaken))}}n3.encoder=Ye.tuple([Ye.list(S.encoder),y.getEncoder(S.encoder)],n=>[n.capturedSpaces,n.ringTaken],n=>new n3(n[0],n[1]));class il extends oo{constructor(t,e,r,s){super(),this.initialCaptures=t,this.start=e,this.end=r,this.finalCaptures=s}isInitialPlacement(){return this.end.isAbsent()}equals(t){return this===t||!(!1===this.start.equals(t.start)||!1===this.end.equals(t.end)||!1===Je.compareArray(this.initialCaptures,t.initialCaptures)||!1===Je.compareArray(this.finalCaptures,t.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}}il.encoder=Ye.tuple([Ye.list(n3.encoder),S.encoder,y.getEncoder(S.encoder),Ye.list(n3.encoder)],n=>[n.initialCaptures,n.start,n.end,n.finalCaptures],n=>new il(n[0],n[1],n[2],n[3]));class J3 extends I1{constructor(){super(t3)}static get(){return J3.singleton.isAbsent()&&(J3.singleton=y.of(new J3)),J3.singleton.get()}applyLegalMove(t,e,r){return new t3(r.board,r.sideRings,r.turn+1)}applyCaptures(t,e){let r=e;return t.forEach(s=>{r=this.applyCapture(s,r)}),r}applyCapture(t,e){const r=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new t3(r,e.sideRings,e.turn),t.ringTaken.get())}takeRing(t,e){const r=t.getCurrentPlayer().value,s=t.setAt(e,Nt.EMPTY).board,i=[t.sideRings[0],t.sideRings[1]];return i[r]+=1,new t3(s,i,t.turn)}applyCaptureWithoutTakingRing(t,e){return e.forEach(r=>{t=t.setAt(r,Nt.EMPTY)}),t.board}ringSelectionValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)===Nt.RINGS[r]?R.SUCCESS:R.failure(zr.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(t,e,r){const s=r.getCurrentPlayer().value;let i=r.setAt(t,Nt.MARKERS[s]);i=i.setAt(e,Nt.RINGS[s]);const o=De.factory.fromMove(t,e).get();for(let c=t.getNext(o);!1===c.equals(e);c=c.getNext(o)){const u=i.getPieceAt(c);u!==Nt.EMPTY&&(i=i.setAt(c,u.flip()))}return i}isLegal(t,e){if(t.isInitialPlacement())return this.initialPlacementValidity(e,t.start);if(e.isInitialPlacementPhase())return ve.failure(zr.NO_MARKERS_IN_INITIAL_PHASE());const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toOtherFallible();const s=this.applyCaptures(t.initialCaptures,e),i=this.moveValidity(s,t.start,t.end.get());if(i.isFailure())return i.toOtherFallible();const o=this.applyRingMoveAndFlip(t.start,t.end.get(),s),c=this.capturesValidity(o,t.finalCaptures);if(c.isFailure())return c.toOtherFallible();const u=this.applyCaptures(t.finalCaptures,o),h=this.noMoreCapturesValidity(u);return h.isFailure()?h.toOtherFallible():ve.success(u)}initialPlacementValidity(t,e){if(!0!==t.isInitialPlacementPhase())return ve.failure(zr.PLACEMENT_AFTER_INITIAL_PHASE());if(t.getPieceAt(e)!==Nt.EMPTY)return ve.failure(Xe.MUST_CLICK_ON_EMPTY_SPACE());const r=t.getCurrentPlayer(),s=[t.sideRings[0],t.sideRings[1]];s[r.value]-=1;const i=t.setAt(e,Nt.of(r,!0)).board,o=new t3(i,s,t.turn);return ve.success(o)}moveStartValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)!==Nt.RINGS[r]?R.failure(zr.SHOULD_SELECT_PLAYER_RING()):R.SUCCESS}moveValidity(t,e,r){const s=this.moveStartValidity(t,e);if(s.isFailure())return s;if(t.getPieceAt(r)!==Nt.EMPTY)return R.failure(zr.SHOULD_END_MOVE_ON_EMPTY_SPACE());const i=De.factory.fromMove(e,r);if(i.isFailure())return R.failure(zr.MOVE_DIRECTION_INVALID());const o=i.get();let c=!1;for(let u=e.getNext(o);!1===u.equals(r);u=u.getNext(o)){const h=t.getPieceAt(u);if(h===Nt.EMPTY){if(c)return R.failure(zr.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(h.isRing)return R.failure(zr.MOVE_SHOULD_NOT_PASS_ABOVE_RING());c=!0}}return R.SUCCESS}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=this.applyCapture(s,r)}return R.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer().value;for(const s of e.capturedSpaces)if(t.getPieceAt(s)!==Nt.MARKERS[r])return R.failure(zr.CAN_ONLY_CAPTURE_YOUR_MARKERS());return t.getPieceAt(e.ringTaken.get())!==Nt.RINGS[r]?R.failure(zr.CAPTURE_SHOULD_TAKE_RING()):R.SUCCESS}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).length?R.SUCCESS:R.failure(zr.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=this.getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let u,c=i;for(u=i;t.isOnBoard(u);u=u.getNext(o)){const h=t.getPieceAt(u);if(h.player===e&&!1===h.isRing)0===s&&(c=u),s+=1;else{if(s>=5)break;s=0}}return s>=5?y.of({start:c,end:u,dir:o}):y.empty()}getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).forEach(s=>{for(let i=s.start;i.getDistance(s.end)>=5;i=i.getNext(s.dir))r.push(n3.of(i,i.getNext(s.dir,4)))}),r}getRingTargets(t,e){const r=[];for(const s of De.factory.all){let i=!1;for(let o=e.getNext(s);t.isOnBoard(o);o=o.getNext(s)){const c=t.getPieceAt(o);if(c===Nt.EMPTY){if(r.push(o),i)break}else{if(c.isRing)break;i=!0}}}return r}getGameStatus(t){return t.gameState.isInitialPlacementPhase()?Ie.ONGOING:t.gameState.sideRings[0]>=3?Ie.ZERO_WON:t.gameState.sideRings[1]>=3?Ie.ONE_WON:Ie.ONGOING}}J3.singleton=y.empty();class F7t extends ks{getMetrics(t){return t.gameState.sideRings}getListMoves(t){const e=[],r=t.gameState;if(r.isInitialPlacementPhase())for(const{coord:s,content:i}of r.getCoordsAndContents())i===Nt.EMPTY&&e.push(new il([],s,y.empty(),[]));else{const s=J3.get();this.getPossibleCaptureCombinations(r).forEach(i=>{const o=s.applyCaptures(i,r);this.getRingMoves(o).forEach(c=>{const u=s.applyRingMoveAndFlip(c.start,c.end,o);this.getPossibleCaptureCombinations(u).forEach(h=>{const g=new il(i,c.start,y.of(c.end),h);e.push(g)})})})}return e}getPossibleCaptureCombinations(t){const r=J3.get().getPossibleCaptures(t),s=this.getRingCoords(t);return o_.getPossibleCaptureCombinationsFromPossibleCaptures(r).map(i=>class H7t{static getCombinations(t,e){return We(t.length>=e,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(t,e).map(r=>this.getPermutations(r)).reduce((r,s)=>r.concat(s))}static getPermutations(t){const e=t.length,r=[t.slice()],s=new Array(e).fill(0);let i=1;for(;i<e;)if(s[i]<i){const o=i%2&&s[i],c=t[i];t[i]=t[o],t[o]=c,++s[i],i=1,r.push(t.slice())}else s[i]=0,++i;return r}static getSubsetsOfSize(t,e){return function r(s,i){if(i>=t.length||s<1)return[[]];{const o=[];for(;i<=t.length-s;){const c=t[i];for(const u of r(s-1,i+1))u.push(c),o.push(u);++i}return o}}(e,0)}}.getCombinations(s,i.length).map(o=>i.map((c,u)=>new n3(c.capturedSpaces,y.of(o[u]))))).reduce((i,o)=>i.concat(o),[])}getRingMoves(t){const e=J3.get(),r=[];for(const s of this.getRingCoords(t))for(const i of e.getRingTargets(t,s))r.push({start:s,end:i});return r}getRingCoords(t){const e=t.getCurrentPlayer().value,r=[];return t.forEachCoord((s,i)=>{i===Nt.RINGS[e]&&r.push(s)}),r}}const W=Nt.EMPTY,Te=Nt.UNREACHABLE,s2=Nt.MARKER_ZERO,vo=Nt.RING_ZERO,ol=Nt.MARKER_ONE,Ii=Nt.RING_ONE;let m4e=(()=>{class n{}return n.MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`,n.MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`,n})();class _4e extends z1{constructor(){super(...arguments),this.tutorial=[te.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new t3([[Te,Te,Te,Te,Te,Te,W,W,W,W,Te],[Te,Te,Te,Te,W,W,W,W,W,W,W],[Te,Te,Te,s2,Ii,W,W,W,W,W,W],[Te,Te,W,s2,W,Ii,W,ol,W,W,W],[Te,W,vo,ol,W,W,Ii,s2,W,W,W],[Te,W,W,s2,ol,W,W,W,W,W,Te],[W,W,W,s2,W,W,W,Ii,W,W,Te],[W,W,W,ol,s2,vo,W,W,W,Te,Te],[W,W,W,W,W,W,W,W,Te,Te,Te],[W,W,W,W,W,W,W,Te,Te,Te,Te],[Te,W,W,W,W,Te,Te,Te,Te,Te,Te]],[3,1],20)),te.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new t3(t3.getInitialState().board,[5,5],0),new il([],new S(5,5),y.empty(),[]),$localize`Congratulations!`),te.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new t3([[Te,Te,Te,Te,Te,Te,W,W,W,W,Te],[Te,Te,Te,Te,W,W,W,W,W,W,W],[Te,Te,Te,Ii,W,W,W,W,W,W,W],[Te,Te,Ii,W,W,Ii,W,W,W,W,W],[Te,W,vo,ol,W,W,Ii,W,W,W,W],[Te,W,W,ol,W,W,W,W,W,W,Te],[W,W,W,W,vo,W,W,Ii,W,W,Te],[W,W,W,W,W,vo,W,W,W,Te,Te],[W,W,W,vo,W,W,W,Te,Te,Te,Te],[W,W,W,W,W,W,W,Te,Te,Te,Te],[Te,W,W,W,W,Te,Te,Te,Te,Te,Te]],[0,0],20),new il([],new S(2,4),y.of(new S(4,4)),[]),$localize`Congratulations!`),te.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new t3([[Te,Te,Te,Te,Te,Te,W,W,W,W,Te],[Te,Te,Te,Te,W,W,W,W,W,W,W],[Te,Te,Te,Ii,W,W,W,W,W,W,W],[Te,Te,Ii,W,W,Ii,W,W,W,W,W],[Te,W,s2,s2,vo,ol,ol,W,W,W,W],[Te,W,W,Ii,W,W,W,W,W,W,Te],[W,W,W,W,vo,W,W,Ii,W,W,Te],[W,W,W,W,W,vo,W,W,W,Te,Te],[W,W,W,vo,W,W,W,vo,Te,Te,Te],[W,W,W,W,W,W,W,Te,Te,Te,Te],[Te,W,W,W,W,Te,Te,Te,Te,Te,Te]],[0,0],20),new il([],new S(4,4),y.of(new S(7,4)),[n3.of(new S(2,4),new S(6,4),y.of(new S(7,4)))]),(t,e,r)=>1===r.sideRings[B.ZERO.value]?R.SUCCESS:R.failure(m4e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),te.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new t3([[Te,Te,Te,Te,Te,Te,W,W,W,W,Te],[Te,Te,Te,Te,vo,W,W,Ii,Ii,vo,W],[Te,Te,Te,vo,W,W,ol,Ii,W,vo,W],[Te,Te,W,vo,W,W,W,W,W,Ii,W],[Te,W,W,W,W,s2,W,W,Ii,W,W],[Te,W,W,W,s2,s2,W,ol,W,W,Te],[W,W,W,s2,W,s2,W,W,W,W,Te],[W,W,s2,W,W,s2,W,W,W,Te,Te],[W,s2,W,W,W,s2,W,W,Te,Te,Te],[W,W,W,W,W,s2,W,Te,Te,Te,Te],[Te,W,W,W,W,Te,Te,Te,Te,Te,Te]],[0,0],10),new il([n3.of(new S(5,4),new S(1,8),y.of(new S(3,2))),n3.of(new S(5,9),new S(5,5),y.of(new S(3,3)))],new S(4,1),y.of(new S(4,2)),[]),(t,e,r)=>2===r.sideRings[B.ZERO.value]?R.SUCCESS:R.failure(m4e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)]}}function B7t(n,t){if(1&n&&(H(),X(0,"circle",12)),2&n){const e=C(2).$implicit,r=C(2);z("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringOuterSize)}}function $7t(n,t){if(1&n&&(H(),X(0,"circle",13)),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();Le("id","ring_",r,"_",i,""),w("ngClass",s.ringClasses),z("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.ringMidSize)}}function U7t(n,t){if(1&n&&(H(),X(0,"circle",12)),2&n){const e=C(2).$implicit,r=C(2);z("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringInnerSize)}}function G7t(n,t){if(1&n&&(H(),X(0,"circle",14)),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();Le("id","marker_",r,"_",i,""),w("ngClass",s.markerClasses),z("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.markerSize)}}function q7t(n,t){if(1&n){const e=Ae();H(),b(0,"g",6),ee("click",function(){de(e);const s=C().$implicit;return le(C(2).onClick(s.coord))}),X(1,"polygon",7),b(2,"g",8),x(3,B7t,1,3,"circle",9),x(4,$7t,1,6,"circle",10),x(5,U7t,1,3,"circle",9),x(6,G7t,1,6,"circle",11),A()()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index;Le("id","click_",r,"_",i,""),T(1),Le("id","space_",r,"_",i,""),w("ngClass",s.spaceClasses),z("points",s.coordinates),T(1),Le("id","pieceGroup_",r,"_",i,""),w("ngClass",s.removedClass),T(1),w("ngIf",s.isRing),T(1),w("ngIf",s.isRing),T(1),w("ngIf",s.isRing),T(1),w("ngIf",s.isMarker)}}function W7t(n,t){if(1&n&&(H(),b(0,"g"),x(1,q7t,7,13,"g",5),A()),2&n){const e=t.$implicit;T(1),w("ngIf",null!=e)}}function j7t(n,t){if(1&n&&(H(),b(0,"g"),x(1,W7t,2,1,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function Z7t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",15),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();Le("id","selected_",e.x,"_",e.y,""),z("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function Y7t(n,t){if(1&n){const e=Ae();H(),b(0,"polygon",17),ee("click",function(){const i=de(e).$implicit;return le(C(2).onClick(i))}),A()}if(2&n){const e=t.$implicit,r=C(2);Le("id","selectable_",e.x,"_",e.y,""),z("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function K7t(n,t){if(1&n&&(H(),b(0,"g"),x(1,Y7t,1,3,"polygon",16),A()),2&n){const e=C();T(1),w("ngForOf",e.viewInfo.selectableCoords)}}function X7t(n,t){if(1&n){const e=Ae();H(),b(0,"rect",18),ee("click",function(){const i=de(e).$implicit;return le(C().onClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();Le("id","indicator_",e.x,"_",e.y,""),z("x",r.viewInfo.spaceInfo[e.y][e.x].center.x-r.viewInfo.indicatorSize/2)("y",r.viewInfo.spaceInfo[e.y][e.x].center.y-r.viewInfo.indicatorSize/2)("width",r.viewInfo.indicatorSize)("height",r.viewInfo.indicatorSize)}}function Q7t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"circle",19)(2,"circle",12)(3,"circle",20),A()),2&n){const e=t.index,r=C().$implicit,s=C();T(1),Le("id","player_",r.value,"_sideRing_",e+1,""),z("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringOuterSize),T(1),z("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringInnerSize),T(1),w("ngClass",s.viewInfo.sideRingClass[r.value]),z("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringMidSize)}}const J7t=function(){return[]};function eft(n,t){if(1&n&&(H(),b(0,"g"),x(1,Q7t,4,12,"g",1),A()),2&n){const e=t.$implicit,r=C();z("transform","rotate("+180*(r.role.value+1)+" 532.5 780)"),T(1),w("ngForOf",er(2,J7t).constructor(r.viewInfo.sideRings[e.value]))}}class xi extends Uh{constructor(t){super(t),this.movePhase="MOVE_START",this.moveStart=y.empty(),this.moveEnd=y.empty(),this.currentlyMoved=[],this.currentCapture=y.empty(),this.initialCaptures=[],this.finalCaptures=[],this.possibleCaptures=[],this.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:xi.MARKER_SIZE,ringOuterSize:xi.RING_OUTER_SIZE,ringMidSize:xi.RING_MID_SIZE,ringInnerSize:xi.RING_INNER_SIZE,indicatorSize:xi.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},this.scores=y.of([0,0]),this.rules=J3.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new F7t(this.rules,"YinshMinimax")],this.encoder=il.encoder,this.tutorial=(new _4e).tutorial,this.hexaLayout=new Gh(1.5*xi.RING_OUTER_SIZE,new S(2*xi.RING_OUTER_SIZE,0),xs.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(e=>{null==this.viewInfo.spaceInfo[e.y]&&(this.viewInfo.spaceInfo[e.y]=[]),this.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:this.getHexaPointsAt(e),center:this.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt();const t=this.getState();this.scores=y.of(t.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(t=>{this.viewInfo.spaceInfo[t.y][t.x].spaceClasses=this.getSpaceClasses(t);const e=this.constructedState.getPieceAt(t);this.viewInfo.spaceInfo[t.y][t.x].removedClass="",this.setRingInfo(t,e),this.setMarkerInfo(t,e)});for(const t of B.PLAYERS)this.viewInfo.sideRings[t.value]=this.constructedState.sideRings[t.value];switch(this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const t of this.possibleCaptures)for(const e of t.capturedSpaces)this.viewInfo.selectableCoords.push(e);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const t of this.initialCaptures)this.markCurrentCapture(t);for(const t of this.finalCaptures)this.markCurrentCapture(t)}getSpaceClasses(t){return this.currentlyMoved.some(e=>e.equals(t))?["moved-fill"]:[]}setRingInfo(t,e){e.isRing?(this.viewInfo.spaceInfo[t.y][t.x].isRing=!0,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=["player"+e.player.value+"-stroke"]):(this.viewInfo.spaceInfo[t.y][t.x].isRing=!1,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=[])}setMarkerInfo(t,e){if(this.viewInfo.spaceInfo[t.y][t.x].isMarker=!1,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[],e!==Nt.EMPTY&&(!e.isRing||this.moveStart.equalsValue(t))){const s=this.getPlayerClass(e.player);this.viewInfo.spaceInfo[t.y][t.x].isMarker=!0,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[s]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=y.empty(),this.moveStart=y.empty(),this.moveEnd=y.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(t){if(t.isInitialPlacement())this.viewInfo.spaceInfo[t.start.y][t.start.x].spaceClasses=["moved-fill"];else{for(const r of this.coordsBetween(t.start,t.end.get()))this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["moved-fill"];const e=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();t.initialCaptures.forEach(r=>this.showLastMoveCapture(r,e)),t.finalCaptures.forEach(r=>this.showLastMoveCapture(r,e))}}coordsBetween(t,e){const r=[],s=De.factory.fromMove(t,e).get();for(let i=t;!i.equals(e);i=i.getNext(s))this.constructedState.getPieceAt(i)!==Nt.EMPTY&&r.push(i),r.push(e);return r}showLastMoveCapture(t,e){for(const r of t.capturedSpaces)this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["captured-fill"],e&&this.markRemovedMarker(r,this.getState().getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[t.ringTaken.get().y][t.ringTaken.get().x].spaceClasses=["captured-fill"],e&&this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),R.SUCCESS}onClick(t){var e=this;return I(function*(){const r=e.canUserPlay("#click_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());switch(e.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return e.selectCaptureFirstCoord(t);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return e.selectCaptureLastCoord(t);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return e.selectRing(t);case"MOVE_START":return e.selectMoveStart(t);case"MOVE_END":return e.selectMoveEnd(t)}})()}selectCaptureFirstCoord(t){var e=this;return I(function*(){const r=[];if(e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1)e.viewInfo.selectedCoords.push(t),e.moveToCaptureSelectLast(r);else{if(0===r.length)return e.cancelMove(zr.MISSING_CAPTURES());e.selectCapture(r[0])}return R.SUCCESS})()}moveToCaptureSelectLast(t){this.viewInfo.selectableCoords=[],this.possibleCaptures=t;for(const e of t)for(const r of e.capturedSpaces)this.viewInfo.selectableCoords.push(r);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(ge.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(t){var e=this;return I(function*(){const r=[];return e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1?e.cancelMove(zr.AMBIGUOUS_CAPTURE_COORD()):0===r.length?e.cancelMove(zr.MISSING_CAPTURES()):e.selectCapture(r[0])})()}selectCapture(t){return this.currentCapture=y.of(t),this.constructedState=new t3(this.rules.applyCaptureWithoutTakingRing(this.constructedState,t),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(We("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),R.SUCCESS}markCurrentCapture(t){for(const e of t.capturedSpaces)this.viewInfo.selectedCoords.push(e),this.markRemovedMarker(e,this.getState().getCurrentPlayer());t.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(t.ringTaken.get()),this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setMarkerInfo(t,Nt.MARKERS[e.value])}markRemovedRing(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setRingInfo(t,Nt.RINGS[e.value])}selectRing(t){var e=this;return I(function*(){const r=e.rules.ringSelectionValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.constructedState=e.rules.takeRing(e.constructedState,t);const s=e.currentCapture.get().setRingTaken(t);return"INITIAL_CAPTURE_SELECT_RING"===(e.currentCapture=y.empty(),e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),e.movePhase)?(e.initialCaptures.push(s),0===e.possibleCaptures.length?e.moveToMovePhase():(e.movePhase="INITIAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),R.SUCCESS)):(ge.expectToBe(e.movePhase,"FINAL_CAPTURE_SELECT_RING"),e.finalCaptures.push(s),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),R.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),R.SUCCESS}tryMove(){var t=this;return I(function*(){const e=new il(t.initialCaptures,t.moveStart.get(),t.moveEnd,t.finalCaptures);return yield t.chooseMove(e)})()}selectMoveStart(t){var e=this;return I(function*(){if(e.constructedState.isInitialPlacementPhase()){const r=e.rules.initialPlacementValidity(e.constructedState,t);return r.isFailure()?e.cancelMove(r.getReason()):(e.moveStart=y.of(t),e.tryMove())}{const r=e.rules.moveStartValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.moveStart=y.of(t),e.movePhase="MOVE_END",e.updateViewInfo()}return R.SUCCESS})()}selectMoveEnd(t){var e=this;return I(function*(){if(e.moveStart.equalsValue(t))return e.cancelMoveAttempt(),R.SUCCESS;const r=Nt.RINGS[e.getState().getCurrentPlayer().value];if(e.constructedState.getPieceAt(t)===r)return e.cancelMoveAttempt(),e.selectMoveStart(t);const s=e.rules.moveValidity(e.constructedState,e.moveStart.get(),t);return s.isFailure()?e.cancelMove(s.getReason()):(e.moveEnd=y.of(t),e.currentlyMoved=e.coordsBetween(e.moveStart.get(),t),e.constructedState=e.rules.applyRingMoveAndFlip(e.moveStart.get(),t,e.constructedState),e.updateViewInfo(),e.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var t=this;return I(function*(){return t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),R.SUCCESS)})()}}function tft(n,t){if(1&n&&(b(0,"option",5),wt(1),A()),2&n){const e=t.$implicit;w("value",e.urlName),T(1),c1(e.name)}}xi.RING_OUTER_SIZE=40,xi.RING_MID_SIZE=34,xi.RING_INNER_SIZE=28,xi.MARKER_SIZE=xi.RING_INNER_SIZE,xi.INDICATOR_SIZE=10,xi.\u0275fac=function(t){return new(t||xi)(Q(_n))},xi.\u0275cmp=ct({type:xi,selectors:[["app-yinsh"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(t,e){1&t&&(H(),b(0,"svg",0),x(1,j7t,2,1,"g",1),x(2,Z7t,1,3,"polygon",2),x(3,K7t,2,1,"g",3),x(4,X7t,1,6,"rect",4),x(5,eft,2,3,"g",1),A()),2&t&&(T(1),w("ngForOf",e.viewInfo.spaceInfo),T(1),w("ngForOf",e.viewInfo.selectedCoords),T(1),w("ngIf",e.isPlayerTurn()),T(1),w("ngForOf",e.viewInfo.targets),T(1),w("ngForOf",e.Player.PLAYERS))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let E1=(()=>{class n{}return n.ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`,n.APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`,n.AWALE=()=>$localize`The international version of the famous African strategy game!`,n.BRANDHUB=()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`,n.CONNECT_SIX=()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`,n.CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`,n.DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`,n.DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`,n.ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`,n.EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`,n.GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`,n.GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`,n.HIVE=()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`,n.HNEFATAFL=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`,n.KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`,n.LASCA=()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`,n.LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`,n.LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`,n.MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`,n.P4=()=>$localize`The classical 4 in a row game!`,n.PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`,n.PENTE=()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`,n.PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`,n.QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`,n.QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`,n.REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`,n.SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`,n.SIAM=()=>$localize`Be the first to push a mountain out of the board!`,n.SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`,n.TABLUT=()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.TEEKO=()=>$localize`Align your 4 pieces or form a square with them to win!`,n.TREXO=()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`,n.YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`,n})(),o9=(()=>{class n{constructor(e,r,s,i,o,c,u,h=!0){this.name=e,this.urlName=r,this.component=s,this.tutorial=i,this.rules=o,this.creationDate=c,this.description=u,this.display=h}}return n.ALL_GAMES=()=>[new n($localize`Four in a Row`,"P4",B8t,new $3e,ti.get(),new Date("2018-08-28"),E1.P4()),new n($localize`Awal`,"Awale",A4t,new i3e,q1.get(),new Date("2018-11-29"),E1.AWALE()),new n($localize`Quarto`,"Quarto",Kut,new e4e,Dr.get(),new Date("2018-12-09"),E1.QUARTO()),new n($localize`Tablut`,"Tablut",u7t,new u4e,A8.get(),new Date("2018-12-27"),E1.TABLUT()),new n($localize`Reversi`,"Reversi",c5t,new r4e,Ni.get(),new Date("2019-01-16"),E1.REVERSI()),new n($localize`Go`,"Go",V6t,new T3e,At.get(),new Date("2019-12-21"),E1.GO()),new n($localize`Encapsule`,"Encapsule",i6t,new E3e,co.get(),new Date("2019-12-30"),E1.ENCAPSULE()),new n($localize`Siam`,"Siam",H5t,new c4e,Er.get(),new Date("2020-01-11"),E1.SIAM()),new n($localize`Sahara`,"Sahara",E5t,new s4e,U2.get(),new Date("2020-02-29"),E1.SAHARA()),new n($localize`Pylos`,"Pylos",Cut,new K3e,Ai.get(),new Date("2020-10-02"),E1.PYLOS()),new n($localize`Kamisado`,"Kamisado",D0t,new x3e,Oi.get(),new Date("2020-10-03"),E1.KAMISADO()),new n($localize`Quixo`,"Quixo",r5t,new t4e,n2.get(),new Date("2020-10-15"),E1.QUIXO()),new n($localize`Dvonn`,"Dvonn",jlt,new _3e,_s.get(),new Date("2020-10-21"),E1.DVONN()),new n($localize`Epaminondas`,"Epaminondas",h6t,new M3e,lo.get(),new Date("2021-01-16"),E1.EPAMINONDAS()),new n($localize`Gipf`,"Gipf",E6t,new P3e,An.get(),new Date("2021-02-22"),E1.GIPF()),new n($localize`Coerceo`,"Coerceo",glt,new g3e,$c.get(),new Date("2021-03-21"),E1.COERCEO()),new n($localize`Six`,"Six",X5t,new l4e,G2.get(),new Date("2021-04-08"),E1.SIX()),new n($localize`Lines of Action`,"LinesOfAction",X0t,new D3e,zs.get(),new Date("2021-04-28"),E1.LINES_OF_ACTION()),new n($localize`Pentago`,"Pentago",X8t,new G3e,J4.get(),new Date("2021-05-23"),E1.PENTAGO()),new n($localize`Abalone`,"Abalone",m4t,new s3e,Uo.get(),new Date("2021-07-13"),E1.ABALONE()),new n($localize`Yinsh`,"Yinsh",xi,new _4e,J3.get(),new Date("2021-07-31"),E1.YINSH()),new n($localize`Apagos`,"Apagos",P4t,new t3e,C6.get(),new Date("2021-11-04"),E1.APAGOS()),new n($localize`Diam`,"Diam",B3,new h3e,q4.get(),new Date("2021-11-30"),E1.DIAM()),new n($localize`Brandhub`,"Brandhub",U4t,new a3e,C8.get(),new Date("2021-12-07"),E1.BRANDHUB()),new n($localize`Conspirateurs`,"Conspirateurs",Tlt,new l3e,cc.get(),new Date("2021-12-30"),E1.CONSPIRATEURS()),new n($localize`Lodestone`,"Lodestone",F2,new z3e,H2.get(),new Date("2022-06-24"),E1.LODESTONE()),new n($localize`Martian Chess`,"MartianChess",Xo,new B3e,G3.get(),new Date("2022-07-01"),E1.MARTIAN_CHESS()),new n($localize`Hnefatafl`,"Hnefatafl",O0t,new I3e,P8.get(),new Date("2022-09-21"),E1.HNEFATAFL()),new n($localize`Hive`,"Hive",p0t,new A3e,e2.get(),new Date("2023-04-02"),E1.HIVE()),new n($localize`Trexo`,"Trexo",u1,new p4e,r2.get(),new Date("2023-04-23"),E1.TREXO()),new n($localize`Lasca`,"Lasca",q0t,new R3e,Yo.get(),new Date("2023-05-11"),E1.LASCA()),new n($localize`Connect Six`,"ConnectSix",X4t,new c3e,ac.get(),new Date("2023-05-13"),E1.CONNECT_SIX()),new n($localize`Pente`,"Pente",iut,new j3e,wa.get(),new Date("2023-05-20"),E1.PENTE()),new n($localize`Teeko`,"Teeko",g7t,new f4e,gc.get(),new Date("2023-07-30"),E1.TEEKO())].sort((t,e)=>t.name.localeCompare(e.name)),n})(),uF=(()=>{class n{constructor(){this.games=o9.ALL_GAMES(),this.pickGame=new dr}onChange(e){this.pickGame.emit(e.target.value)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ct({type:n,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"select",1),ee("change",function(i){return r.onChange(i)}),b(2,"option",2),Ce(3,3),A(),x(4,tft,2,2,"option",4),A()()),2&e&&(T(4),w("ngForOf",r.games))},dependencies:[En,Up,Gp],encapsulation:2}),n})();function nft(n,t){if(1&n){const e=Ae();b(0,"div",26)(1,"div",27),ee("click",function(){return de(e),le(C().closeInfo())}),A(),b(2,"div",28)(3,"header",29)(4,"p",30),wt(5),A(),b(6,"button",31),ee("click",function(){return de(e),le(C().closeInfo())}),A()(),b(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),X(11,"img",35),A()(),b(12,"div",7)(13,"div",13),wt(14),A()()(),b(15,"div",6)(16,"div",33)(17,"a",36),ee("click",function(){de(e);const s=C();return le(s.createGame(s.gameInfoDetails.get().urlName))}),X(18,"fa-icon",37),wt(19,"\xa0"),b(20,"span"),Ce(21,38),A()()(),b(22,"div",33)(23,"a",36),ee("click",function(){de(e);const s=C();return le(s.createLocalGame(s.gameInfoDetails.get().urlName))}),X(24,"fa-icon",37),wt(25,"\xa0"),b(26,"span"),Ce(27,39),A()()(),b(28,"div",33)(29,"a",36),ee("click",function(){de(e);const s=C();return le(s.createTutorial(s.gameInfoDetails.get().urlName))}),X(30,"fa-icon",37),wt(31,"\xa0"),b(32,"span"),Ce(33,40),A()()()()()()()}if(2&n){const e=C();T(5),c1(e.gameInfoDetails.get().name),T(6),Le("src","assets/images/",e.theme,"/",e.gameInfoDetails.get().urlName,".png",E3),T(3),Bi(" ",e.gameInfoDetails.get().description," "),T(4),w("icon",e.iconOnlineGame),T(6),w("icon",e.iconLocalGame),T(6),w("icon",e.iconTutorial)}}function rft(n,t){if(1&n){const e=Ae();b(0,"div",8)(1,"div",9)(2,"p",10),wt(3),A()(),b(4,"div",42)(5,"figure",34)(6,"img",43),ee("click",function(){const i=de(e).$implicit;return le(C(2).openInfo(i))}),A(),b(7,"figcaption",44),ee("click",function(){const i=de(e).$implicit;return le(C(2).openInfo(i))}),b(8,"div",45),wt(9,"?"),A()(),b(10,"figcaption",46)(11,"a",47),ee("click",function(){const i=de(e).$implicit;return le(C(2).createGame(i.urlName))}),X(12,"fa-icon",37),A(),b(13,"a",48),ee("click",function(){const i=de(e).$implicit;return le(C(2).createLocalGame(i.urlName))}),X(14,"fa-icon",37),A(),b(15,"a",49),ee("click",function(){const i=de(e).$implicit;return le(C(2).createTutorial(i.urlName))}),X(16,"fa-icon",37),A()()()(),b(17,"div",50),wt(18),A()()}if(2&n){const e=t.$implicit,r=C(2);T(3),c1(e.name),T(3),p1("id","image_",e.urlName,""),Le("src","assets/images/",r.theme,"/",e.urlName,".png",E3),T(5),p1("id","playOnline_",e.urlName,""),T(1),w("icon",r.iconOnlineGame),T(1),p1("id","playLocally_",e.urlName,""),T(1),w("icon",r.iconLocalGame),T(1),p1("id","startTutorial_",e.urlName,""),T(1),w("icon",r.iconTutorial),T(2),Bi(" ",e.description," ")}}function sft(n,t){if(1&n&&(b(0,"div",7),x(1,rft,19,11,"div",41),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let ift=(()=>{class n{constructor(e,r,s,i){this.router=e,this.messageDisplayer=r,this.currentGameService=s,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=Moe,this.iconLocalGame=bH,this.iconTutorial=Pce,this.gameInfoDetails=y.empty(),this.theme=i.getTheme();const o=o9.ALL_GAMES();let c=0;for(let u=0;u<o.length;u++)u<this.numberOfColumns&&this.games.push([]),this.games[c].push(o[u]),c=(c+1)%this.numberOfColumns}createGame(e){var r=this;return I(function*(){const s=r.currentGameService.canUserCreate();return s.isSuccess()?r.router.navigate(null==e?["/play"]:["/play",e]):(r.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(e){var r=this;return I(function*(){return r.router.navigate(["/local",e])})()}createTutorial(e){return this.router.navigate(["/tutorial",e])}openInfo(e){this.gameInfoDetails=y.of(e)}closeInfo(){this.gameInfoDetails=y.empty()}}return n.\u0275fac=function(e){return new(e||n)(Q(Xn),Q(_n),Q(D2),Q(qS))},n.\u0275cmp=ct({type:n,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E,O,k;return t=$localize`EveryBoard`,e=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,r=$localize`Play online`,s=$localize`Create an online game`,i=$localize`See the game list`,o=$localize`Play offline`,c=$localize`Play`,u=$localize`Learn`,h=$localize`Play online`,g=$localize`Play offline`,m=$localize`Learn the rules`,E=$localize`Play online`,O=$localize`Play offline`,k=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],e,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],r,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],i,o,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],u,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],h,g,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",E,1,"button",3,"id","click"],["data-tooltip",O,1,"button",3,"id","click"],["data-tooltip",k,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,r){1&e&&(b(0,"section",0)(1,"div",1)(2,"p",2),Ce(3,3),A(),b(4,"p",4),ga(5,5),X(6,"br"),ma(),A()(),b(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),Ce(12,11),A()(),b(13,"div",12)(14,"div",13)(15,"button",14),ee("click",function(){return r.createGame()}),Ce(16,15),A(),b(17,"button",16),Ce(18,17),A()()()()(),b(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),Ce(23,18),A()(),b(24,"div",12)(25,"div",19)(26,"button",20),Ce(27,21),A(),b(28,"button",22),Ce(29,23),A()()()()()(),x(30,nft,34,7,"div",24),b(31,"div",6),x(32,sft,2,1,"div",25),A()()),2&e&&(T(30),w("ngIf",r.gameInfoDetails.isPresent()),T(2),w("ngForOf",r.games))},dependencies:[En,Kt,Ff,F5],encapsulation:2}),n})();const oft=["board"];let K5=(()=>{class n{static NO_MATCHING_GAME(e){return $localize`This game (${e}) does not exist.`}}return n.NOT_YOUR_TURN=()=>$localize`It is not your turn!`,n.GAME_HAS_ENDED=()=>$localize`This game has ended.`,n.CANNOT_PLAY_AS_OBSERVER=()=>$localize`You are an observer in this game, you cannot play.`,n.MUST_ANSWER_REQUEST=()=>$localize`You must answer your opponent's request.`,n})(),dT=(()=>{class n{constructor(e,r,s,i){this.actRoute=e,this.connectedUserService=r,this.router=s,this.messageDisplayer=i,this.boardRef=null,this.players=[y.empty(),y.empty()],this.role=ue.NONE,this.endGame=!1,this.Player=B,J(n.VERBOSE,"GameWrapper.constructed: "+(null!=this.boardRef))}getMatchingComponent(e){return J(n.VERBOSE,"GameWrapper.getMatchingComponent"),y.ofNullable(o9.ALL_GAMES().find(s=>s.urlName===e)).map(s=>s.component)}afterViewInit(){var e=this;return I(function*(){J(n.VERBOSE,"GameWrapper.afterViewInit");const r=yield e.createGameComponent();return r&&(e.gameComponent.node=e.gameComponent.rules.getInitialNode(),e.gameComponent.updateBoard()),r})()}getGameName(){return ge.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var e=this;return I(function*(){J(n.VERBOSE,{m:"GameWrapper.createGameComponent",that:e});const r=e.getGameName(),s=e.getMatchingComponent(r);if(s.isAbsent())return yield e.router.navigate(["/notFound",K5.NO_MATCHING_GAME(r)],{skipLocationChange:!0}),!1;We(null!=e.boardRef,"Board element should be present");const i=ge.getNonNullable(e.boardRef).createComponent(s.get());return e.gameComponent=i.instance,e.gameComponent.chooseMove=o=>e.receiveValidMove(o),e.gameComponent.canUserPlay=o=>e.canUserPlay(o),e.gameComponent.isPlayerTurn=()=>e.isPlayerTurn(),e.gameComponent.cancelMoveOnWrapper=o=>{e.onCancelMove(o)},e.setRole(e.role),!0})()}setRole(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymmetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")"),this.updateBoardAndShowLastMove()}receiveValidMove(e){var r=this;return I(function*(){J(n.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:e}});const i=r.gameComponent.rules.isLegal(e,r.gameComponent.getState());return i.isFailure()?(r.gameComponent.cancelMove(i.getReason()),R.ofFallible(i)):(r.gameComponent.cancelMoveAttempt(),yield r.onLegalUserMove(e),J(n.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),R.SUCCESS)})()}canUserPlay(e){if(this.role===ue.NONE){const r=K5.CANNOT_PLAY_AS_OBSERVER();return R.failure(r)}return!1===this.isPlayerTurn()?R.failure(K5.NOT_YOUR_TURN()):this.endGame?R.failure(K5.GAME_HAS_ENDED()):R.SUCCESS}isPlayerTurn(){if(this.role===ue.NONE||null==this.gameComponent)return!1;const e=this.gameComponent.getTurn(),r=e%2,s=this.getPlayer();return J(n.VERBOSE,{isPlayerTurn:{turn:e,players:this.players,player:s,observer:this.role,areYouPlayer:this.players[r].isPresent()&&tc(this.players[r].get(),s),isThereAPlayer:this.players[r]}}),!this.players[r].isPresent()||this.players[r].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}updateBoardAndShowLastMove(){if(this.gameComponent.cancelMoveAttempt(),this.gameComponent.updateBoard(),this.gameComponent.node.move.isPresent()){const e=this.gameComponent.node.move.get();this.gameComponent.showLastMove(e)}}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(zo),Q(Is),Q(Xn),Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],viewQuery:function(e,r){if(1&e&&I0(oft,5,Za),2&e){let s;w4(s=O4())&&(r.boardRef=s.first)}},decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();const aft=["board"];let cft=(()=>{class n extends dT{constructor(e,r,s,i,o){super(e,r,s,i),this.cdr=o,this.boardRef=null}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var e=this;return I(function*(){setTimeout(I(function*(){yield e.afterViewInit(),e.gameComponent.node=e.demoNodeInfo.node,e.setRole(e.gameComponent.getCurrentPlayer()),e.cdr.detectChanges(),e.demoNodeInfo.click.isPresent()&&(ge.getNonNullable(document.querySelector(e.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),e.cdr.detectChanges())}),1)})()}onLegalUserMove(e,r){return I(function*(){})()}getPlayer(){return"no-player"}onCancelMove(e){}}return n.\u0275fac=function(e){return new(e||n)(Q(zo),Q(Is),Q(Xn),Q(_n),Q(Ru))},n.\u0275cmp=ct({type:n,selectors:[["app-demo-card"]],viewQuery:function(e,r){if(1&e&&I0(aft,5,Za),2&e){let s;w4(s=O4())&&(r.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[l],decls:2,vars:0,consts:[["board",""]],template:function(e,r){1&e&&X(0,"div",null,0)},encapsulation:2}),n})();function lft(n,t){if(1&n&&(b(0,"div",17)(1,"figure",18),X(2,"app-demo-card",19),A()()),2&n){const e=C().$implicit;T(2),w("demoNodeInfo",e)}}function uft(n,t){if(1&n&&(b(0,"div",20)(1,"figure",21),X(2,"app-demo-card",19),A()()),2&n){const e=C().$implicit;T(2),w("demoNodeInfo",e)}}function fft(n,t){if(1&n&&(b(0,"div",12)(1,"div",13)(2,"p",14),wt(3),A()(),x(4,lft,3,1,"div",15),x(5,uft,3,1,"ng-template",null,16,qn),A()),2&n){const e=t.$implicit,r=Hn(6),s=C(2);T(3),c1(e.name),T(1),w("ngIf",s.squared.value)("ngIfElse",r)}}function hft(n,t){if(1&n&&(b(0,"div",10),x(1,fft,7,3,"div",11),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let dft=(()=>{class n{constructor(){this.numberOfColumns=new Ya(5),this.squared=new Ya(!0),this.columns=[],this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(e=>{this.fillColumns(e)})}fillColumns(e){const r=o9.ALL_GAMES();let s=0,i=0;this.columns=[];for(const o of r){const c=[],u=o.rules,h=o.tutorial.tutorial;for(const g of h){const m=this.getNodeFromStep(g,u);c.push(m)}for(const g of c)i<e&&this.columns.push([]),this.columns[s].push({name:o.urlName,node:g.node,click:g.click}),i++,s=(s+1)%e}}getNodeFromStep(e,r){if(e.hasSolution()){const s=e.getSolution();if("string"==typeof s)return{node:new mr(e.state),click:y.of(s)};{const i=s;return{node:new mr(r.applyLegalMove(i,e.state,r.isLegal(i,e.state).get()),y.of(new mr(e.state)),y.of(i)),click:y.empty()}}}return{node:new mr(e.state),click:y.empty()}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ct({type:n,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,e;return t=$localize`Number of columns: `,e=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],e,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(e,r){1&e&&(b(0,"form")(1,"div",0)(2,"label",1),dn(3),Ce(4,2),pn(),b(5,"output"),wt(6),A()(),b(7,"div",3),X(8,"input",4),A()(),b(9,"div",0)(10,"label",5),X(11,"input",6),wt(12," \xa0"),dn(13),Ce(14,7),pn(),A()()(),b(15,"div",8),x(16,hft,2,1,"div",9),A()),2&e&&(T(6),c1(r.numberOfColumns.value),T(2),w("formControl",r.numberOfColumns),T(3),w("formControl",r.squared),T(5),w("ngForOf",r.columns))},dependencies:[En,Kt,Fu,I4,tE,yA,Gl,Hu,kA,Bp,cft],encapsulation:2}),n})(),fF=(()=>{class n{constructor(e){this.element=e}ngAfterViewInit(){this.element.nativeElement.focus()}}return n.\u0275fac=function(e){return new(e||n)(Q(y2))},n.\u0275dir=qt({type:n,selectors:[["","autofocus",""]]}),n})(),v4e=(()=>{class n{constructor(e){this.shown=!1,this.input=e.nativeElement.parentNode.previousSibling,e.nativeElement.addEventListener("click",r=>{this.toggle()})}toggle(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return n.\u0275fac=function(e){return new(e||n)(Q(y2))},n.\u0275dir=qt({type:n,selectors:[["","toggleVisibility",""]]}),n})();function pft(n,t){if(1&n&&(b(0,"div",29)(1,"div",30),Ce(2,31),A(),b(3,"div",32),wt(4),A()()),2&n){const e=C();T(4),c1(e.errorMessage)}}const gft=function(){return["/register"]},mft=function(){return["/reset-password"]};let _ft=(()=>{class n{constructor(e,r){this.router=e,this.connectedUserService=r,this.faEye=sH,this.loginForm=new z0({email:new Ya,password:new Ya})}ngOnInit(){var e=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var r=I(function*(s){s!==R5.NOT_CONNECTED&&(yield e.redirect())});return function(s){return r.apply(this,arguments)}}())}loginWithEmail(e){var r=this;return I(function*(){const s=yield r.connectedUserService.doEmailLogin(e.email,e.password);s.isFailure()&&(r.errorMessage=s.getReason())})()}loginWithGoogle(){var e=this;return I(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isFailure()&&(e.errorMessage=r.getReason())})()}redirect(){var e=this;return I(function*(){return e.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(Xn),Q(Is))},n.\u0275cmp=ct({type:n,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E;return t=$localize`Log in`,e=$localize`Email`,r=$localize`Email`,s=$localize`Password`,i=$localize`Password`,o=$localize`Log in`,c=$localize`Log in with Google`,u=$localize`No account?`,h=$localize`Register`,g=$localize`Forgot your password?`,m=$localize`Reset your password`,E=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",r,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",i,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],o,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],u,[3,"routerLink"],h,g,m,["role","alert",1,"message","is-danger"],[1,"message-header"],E,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),Ce(2,2),A(),b(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),Ce(7,7),A()(),b(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),A()()()(),b(12,"div",4)(13,"div",5)(14,"label",12),Ce(15,13),A()(),b(16,"div",8)(17,"div",9)(18,"div",14),X(19,"input",15),b(20,"span",16),X(21,"fa-icon",17),A()()()()(),b(22,"div",4),X(23,"div",5),b(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),ee("click",function(){return r.loginWithEmail(r.loginForm.value)}),Ce(28,19),A()()()()(),b(29,"div",4),X(30,"div",5),b(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),ee("click",function(){return r.loginWithGoogle()}),Ce(35,21),A()()()()(),x(36,pft,5,1,"div",22),b(37,"p",23),dn(38),Ce(39,24),pn(),wt(40,"\xa0 "),b(41,"a",25),Ce(42,26),A()(),b(43,"p",23),dn(44),Ce(45,27),pn(),wt(46,"\xa0 "),b(47,"a",25),Ce(48,28),A()()()()),2&e&&(T(3),w("formGroup",r.loginForm),T(18),w("icon",r.faEye),T(6),w("disabled",!r.canLogin()),T(9),w("ngIf",r.errorMessage),T(5),w("routerLink",er(6,gft)),T(6),w("routerLink",er(7,mft)))},dependencies:[Kt,ju,Fu,I4,Gl,Hu,Uu,Bu,kf,F5,fF,v4e],encapsulation:2}),n})(),vft=(()=>{class n{constructor(e){this.partDAO=e}subscribeToActiveParts(e){let r=[];const c=new US(u=>{r=r.concat(...u),e(r)},u=>{const h=r;for(const g of u)h.forEach(m=>{m.id===g.id&&(m.data=g.data)});r=h,e(r)},u=>{const h=[];for(const g of r)u.some(m=>m.id===g.id)||h.push(g);r=h,e(r)});return this.partDAO.observingWhere([["result","==",P1.UNACHIEVED.value]],c)}}return n.\u0275fac=function(e){return new(e||n)(ze(cV))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),Cft=(()=>{class n{transform(e){return wG(1e3*e.seconds,"HH:mm:ss","en-US")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=ai({name:"firestoreTime",type:n,pure:!0}),n})();const yft=["chatDiv"];function Eft(n,t){1&n&&(dn(0),Ce(1,5),pn())}function Mft(n,t){1&n&&Ce(0,6),2&n&&(S1(C().unreadMessagesText),N1(0))}function Sft(n,t){if(1&n){const e=Ae();b(0,"button",11),ee("click",function(){return de(e),le(C(2).scrollToBottom())}),wt(1),A()}if(2&n){const e=C(2);T(1),Bi("",e.unreadMessagesText," \u2193")}}function Pft(n,t){if(1&n&&(b(0,"p"),wt(1),x3(2,"firestoreTime"),b(3,"b",12),wt(4),A(),b(5,"span",13),wt(6),A()()),2&n){const e=t.$implicit;T(1),Bi(" [",T4(2,3,e.postedTime),"] "),T(3),Bi("",e.sender.name," : "),T(2),c1(e.content)}}function Tft(n,t){if(1&n){const e=Ae();b(0,"div"),x(1,Sft,2,1,"button",7),b(2,"div",8,9),ee("scroll",function(){return de(e),le(C().updateCurrentScrollPosition())}),x(4,Pft,7,5,"p",10),A()()}if(2&n){const e=C();T(1),w("ngIf",e.showUnreadMessagesButton),T(3),w("ngForOf",e.chat)}}const wft=function(){return{standalone:!0}};function Oft(n,t){if(1&n){const e=Ae();b(0,"form",14),ee("onSubmit",function(){return de(e),le(C().sendMessage())}),b(1,"div",15)(2,"div",16)(3,"input",17,18),ee("ngModelChange",function(s){return de(e),le(C().userMessage=s)}),A(),b(5,"p",19),wt(6),A()(),b(7,"div",20)(8,"button",21),ee("click",function(){return de(e),le(C().sendMessage())}),X(9,"fa-icon",22),A()()(),b(10,"div",23)(11,"p")(12,"strong"),Ce(13,24),A()()()()}if(2&n){const e=Hn(4),r=C();T(3),w("ngModel",r.userMessage)("ngModelOptions",er(4,wft)),T(3),Bi("",e.value.length,"/128"),T(3),w("icon",r.faReply)}}let C4e=(()=>{class n{constructor(e,r){this.chatService=e,this.connectedUserService=r,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=UV,this.isNearBottom=!0,this.notYetScrolled=!0,J(n.VERBOSE,"ChatComponent constructor")}ngOnInit(){J(n.VERBOSE,`ChatComponent.ngOnInit for chat ${this.chatId}`),We(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=s=>{this.updateMessages(s.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},r=new US(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,r)}updateMessages(e){this.chat=this.chat.concat(e);const r=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=r,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(r-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return I(function*(){const r=e.userMessage;e.userMessage="";const s=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,s,r,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(BS),Q(Is))},n.\u0275cmp=ct({type:n,selectors:[["app-chat"]],viewQuery:function(e,r){if(1&e&&I0(yft,5),2&e){let s;w4(s=O4())&&(r.chatDiv=s.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let t,e,r,s;return t=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,r=$localize`Type your message here`,s=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],t,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",r,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],s]},template:function(e,r){if(1&e&&(b(0,"div")(1,"button",0),ee("click",function(){return r.switchChatVisibility()}),x(2,Eft,2,0,"ng-container",1),x(3,Mft,1,1,"ng-template",null,2,qn),A(),x(5,Tft,5,2,"div",3),x(6,Oft,14,5,"form",4),A()),2&e){const s=Hn(4);T(2),w("ngIf",r.visible)("ngIfElse",s),T(3),w("ngIf",r.visible),T(1),w("ngIf",r.visible)}},dependencies:[En,Kt,Fu,I4,Gl,Hu,zA,$p,Bp,F5,Cft],encapsulation:2}),n})(),y4e=(()=>{class n{constructor(e,r,s){this.router=e,this.currentGameService=r,this.messageDisplayer=s}pickGame(e){this.selectedGame=e}navigateToOnlineGameCreation(){var e=this;return I(function*(){const r=e.currentGameService.canUserCreate();r.isSuccess()?yield e.router.navigate(["/play",e.selectedGame]):e.messageDisplayer.criticalMessage(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Xn),Q(D2),Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),A(),b(1,"button",1),ee("click",function(){return r.navigateToOnlineGameCreation()}),Ce(2,2),A()),2&e&&(T(1),w("disabled",!r.selectedGame))},dependencies:[uF],encapsulation:2}),n})();function bft(n,t){if(1&n&&(dn(0),wt(1),pn()),2&n){const e=C().$implicit;T(1),c1(e.data.playerOne.name)}}function Aft(n,t){1&n&&(dn(0),Ce(1,27),pn())}function Nft(n,t){if(1&n){const e=Ae();b(0,"tr",22),ee("click",function(){const i=de(e).$implicit;return le(C(2).joinGame(i))}),b(1,"td",23),wt(2),A(),b(3,"td",23),wt(4),A(),b(5,"td",23),x(6,bft,2,1,"ng-container",24),x(7,Aft,2,0,"ng-template",null,25,qn),A(),b(9,"td",26),wt(10),A()()}if(2&n){const e=t.$implicit,r=t.index,s=Hn(8);p1("id","part_",r,""),T(2),c1(e.data.typeGame),T(2),c1(e.data.playerZero.name),T(2),w("ngIf",e.data.playerOne)("ngIfElse",s),T(4),c1(e.data.turn+1)}}function Ift(n,t){if(1&n&&(b(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),Ce(6,17),A(),b(7,"th",16),Ce(8,18),A(),b(9,"th",16),Ce(10,19),A(),b(11,"th",16),Ce(12,20),A()()(),b(13,"tbody"),x(14,Nft,11,6,"tr",21),A()()()()),2&n){const e=C();T(14),w("ngForOf",e.activeParts)}}function xft(n,t){1&n&&(b(0,"div",28),X(1,"app-online-game-selection",29),A())}function kft(n,t){1&n&&(b(0,"div",30)(1,"div",31)(2,"div",32),X(3,"app-chat",33),A()()()),2&n&&(T(3),w("turn",-1))}let Lft=(()=>{class n{constructor(e,r,s,i){this.router=e,this.messageDisplayer=r,this.activePartsService=s,this.currentGameService=i,this.activeParts=[],this.currentTab="games",this.createTabClasses=[]}ngOnInit(){J(n.VERBOSE,"lobbyComponent.ngOnInit"),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){J(n.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activePartsSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}joinGame(e){var r=this;return I(function*(){const s=e.id,i=e.data.typeGame,c=r.currentGameService.canUserJoin(s,null!=e.data.beginning);c.isSuccess()?yield r.router.navigate(["/play",i,s]):r.messageDisplayer.criticalMessage(c.getReason())})()}selectTab(e){if("create"===e){const r=this.currentGameService.canUserCreate();r.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(r.getReason())}else this.currentTab=e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Xn),Q(_n),Q(vft),Q(D2))},n.\u0275cmp=ct({type:n,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let t,e,r,s,i,o,c,u;return t=$localize`Games`,e=$localize`Create`,r=$localize`Chat`,s=$localize`Game`,i=$localize`First player`,o=$localize`Second player`,c=$localize`Turn`,u=$localize`Waiting for opponent`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],t,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],r,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],s,i,o,c,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],[1,"td","turn"],u,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],[1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),ee("click",function(){return r.selectTab("games")}),Ce(4,3),A()(),b(5,"li",4)(6,"a",5),ee("click",function(){return r.selectTab("create")}),Ce(7,6),A()(),b(8,"li",7)(9,"a",8),ee("click",function(){return r.selectTab("chat")}),Ce(10,9),A()()()(),x(11,Ift,15,1,"div",10),x(12,xft,2,0,"div",11),x(13,kft,4,1,"div",12)),2&e&&(T(6),w("ngClass",r.createTabClasses),T(5),w("ngIf","games"===r.currentTab),T(1),w("ngIf","create"===r.currentTab),T(1),w("ngIf","chat"===r.currentTab))},dependencies:[hn,En,Kt,C4e,y4e],encapsulation:2}),n})(),Rft=(()=>{class n{constructor(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ct({type:n,selectors:[["app-account"]],decls:11,vars:0,consts:function(){let t,e,r;return t=$localize`User settings`,e=$localize`If you forgot your password or want to change it, click on the following button:`,r=$localize`Reset password`,[[1,"hero-body"],[1,"title"],t,[1,"box"],[1,"block","level-left"],[1,"level-item"],e,["id","reset","routerLink","/reset-password",1,"button","is-primary","level-item","is-small"],r]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),Ce(2,2),A()(),b(3,"div",3)(4,"p",1),wt(5,"Resetting password"),A(),b(6,"div",4)(7,"p",5),Ce(8,6),A(),b(9,"button",7),Ce(10,8),A()()())},dependencies:[Ff],encapsulation:2}),n})(),E4e=(()=>{class n{constructor(e){this.route=e,this.message=e.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return n.\u0275fac=function(e){return new(e||n)(Q(zo))},n.\u0275cmp=ct({type:n,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1),Ce(2,2),A(),b(3,"div",3),wt(4),A()()),2&e&&(T(4),c1(r.message))},encapsulation:2}),n})();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const Vft=new Error("request for lock canceled");class Fft{constructor(t,e=Vft){this._value=t,this._cancelError=e,this._weightedQueues=[],this._weightedWaiters=[]}acquire(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);return new Promise((e,r)=>{this._weightedQueues[t-1]||(this._weightedQueues[t-1]=[]),this._weightedQueues[t-1].push({resolve:e,reject:r}),this._dispatch()})}runExclusive(t,e=1){return function(n,t,e,r){return new(e||(e=Promise))(function(i,o){function c(g){try{h(r.next(g))}catch(m){o(m)}}function u(g){try{h(r.throw(g))}catch(m){o(m)}}function h(g){g.done?i(g.value):function s(i){return i instanceof e?i:new e(function(o){o(i)})}(g.value).then(c,u)}h((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){const[r,s]=yield this.acquire(e);try{return yield t(r)}finally{s()}})}waitForUnlock(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);return new Promise(e=>{this._weightedWaiters[t-1]||(this._weightedWaiters[t-1]=[]),this._weightedWaiters[t-1].push(e),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(t){this._value=t,this._dispatch()}release(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);this._value+=t,this._dispatch()}cancel(){this._weightedQueues.forEach(t=>t.forEach(e=>e.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var t;for(let e=this._value;e>0;e--){const r=null===(t=this._weightedQueues[e-1])||void 0===t?void 0:t.shift();if(!r)continue;const s=this._value,i=e;this._value-=e,e=this._value+1,r.resolve([s,this._newReleaser(i)])}this._drainUnlockWaiters()}_newReleaser(t){let e=!1;return()=>{e||(e=!0,this.release(t))}}_drainUnlockWaiters(){for(let t=this._value;t>0;t--)!this._weightedWaiters[t-1]||(this._weightedWaiters[t-1].forEach(e=>e()),this._weightedWaiters[t-1]=[])}}class $ft{constructor(t){this._semaphore=new Fft(1,t)}acquire(){return function(n,t,e,r){return new(e||(e=Promise))(function(i,o){function c(g){try{h(r.next(g))}catch(m){o(m)}}function u(g){try{h(r.throw(g))}catch(m){o(m)}}function h(g){g.done?i(g.value):function s(i){return i instanceof e?i:new e(function(o){o(i)})}(g.value).then(c,u)}h((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){const[,t]=yield this._semaphore.acquire();return t})}runExclusive(t){return this._semaphore.runExclusive(()=>t())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}let S4e=(()=>{class n{constructor(){this.requestAwaitingReply=y.empty(),this.lastDeniedRequest=y.empty(),this.forbiddenRequests=new bt}onGameStart(){this.requestAwaitingReply=y.empty(),this.lastDeniedRequest=y.empty(),this.forbiddenRequests=new bt}onReceivedMove(){this.forbiddenRequests=new bt,this.lastDeniedRequest=y.empty()}onReceivedRequest(e){ge.assert(this.requestAwaitingReply.isAbsent(),"Should not receive two requests in a row!"),this.requestAwaitingReply=y.of(e)}onReceivedReply(e,r){var s=this;return I(function*(){switch(s.requestAwaitingReply=y.empty(),e.reply){case"Accept":return!0;case"Reject":return e.player===r.getOpponent().value&&(s.lastDeniedRequest=y.of(e.requestType),s.forbiddenRequests.add(e.requestType)),!1}})()}canMakeRequest(e){return!(this.requestAwaitingReply.isPresent()||this.forbiddenRequests.contains(e))}getRequestAwaitingReplyFrom(e){return this.requestAwaitingReply.isPresent()&&this.requestAwaitingReply.get().player===e.getOpponent().value?y.of(this.requestAwaitingReply.get().requestType):y.empty()}getCurrentRequest(){return this.requestAwaitingReply}deniedRequest(){return this.lastDeniedRequest}}return n.requestInfos={TakeBack:{requestType:"TakeBack",textForRequest:()=>$localize`Ask to take back one move`,textForReply:()=>$localize`Your opponent is asking for a take back.`,name:()=>$localize`take back`,icon:hH},Draw:{requestType:"Draw",textForRequest:()=>$localize`Propose a draw`,textForReply:()=>$localize`Your opponent is proposing a draw.`,name:()=>$localize`draw`,icon:Tre},Rematch:{requestType:"Rematch",textForRequest:()=>$localize`Propose a rematch`,textForReply:()=>$localize`Your opponent is proposing a rematch.`,name:()=>$localize`rematch`,icon:ose}},n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function P4e(n){return 1e3*n.seconds+n.nanoseconds/1e6}function T4e(n,t){return P4e(t)-P4e(n)}let Gft=(()=>{class n{constructor(){this.configRoom=y.empty(),this.takenGlobalTime=[0,0],this.extraGlobalTime=[0,0],this.availableTurnTime=[0,0],this.lastMoveStartTimestamp=y.empty()}setClocks(e,r){this.turnClocks=e,this.globalClocks=r,this.allClocks=e.concat(r)}onGameStart(e){this.configRoom=y.of(e);for(const r of B.PLAYERS)this.takenGlobalTime[r.value]=0,this.extraGlobalTime[r.value]=0,this.availableTurnTime[r.value]=this.getMoveDurationInMs(),this.globalClocks[r.value].setDuration(this.getPartDurationInMs()),this.turnClocks[r.value].setDuration(this.getMoveDurationInMs());for(const r of this.allClocks)r.start(),r.pause()}getPartDurationInMs(){return 1e3*this.configRoom.get().totalPartDuration}getMoveDurationInMs(){return 1e3*this.configRoom.get().maximalMoveDuration}onReceivedAction(e){switch(e.action){case"AddTurnTime":this.addTurnTime(B.of(e.player));break;case"AddGlobalTime":this.addGlobalTime(B.of(e.player));break;case"StartGame":this.lastMoveStartTimestamp=y.of(e.time);break;case"EndGame":this.onGameEnd()}}onReceivedMove(e){const r=B.of(e.player),s=e.time,i=this.getMillisecondsElapsedSinceLastMoveStart(s);this.lastMoveStartTimestamp=y.of(s),this.takenGlobalTime[r.value]+=i,this.availableTurnTime[r.value]-=i;const o=r.getOpponent();this.availableTurnTime[o.value]=this.getMoveDurationInMs();const c=this.getPartDurationInMs()-this.takenGlobalTime[o.value];this.globalClocks[o.value].changeDuration(c)}getMillisecondsElapsedSinceLastMoveStart(e){return T4e(this.lastMoveStartTimestamp.get(),e)}onGameEnd(){for(const e of this.allClocks)e.isStarted()&&e.stop();this.updateClocks()}beforeEventsBatch(e){!1===e&&this.pauseAllClocks()}afterEventsBatch(e,r,s){if(this.updateClocks(),!1===e){const i=this.getMillisecondsElapsedSinceLastMoveStart(s);this.turnClocks[r.value].subtract(i),this.globalClocks[r.value].subtract(i),this.resumeClocks(r)}}resumeClocks(e){this.turnClocks[e.value].resume(),this.globalClocks[e.value].resume()}addTurnTime(e){this.availableTurnTime[e.getOpponent().value]+=3e4}addGlobalTime(e){this.extraGlobalTime[e.getOpponent().value]+=3e5}updateClocks(){for(const e of B.PLAYERS){this.turnClocks[e.value].changeDuration(this.availableTurnTime[e.value]);const r=this.getPartDurationInMs()+this.extraGlobalTime[e.value]-this.takenGlobalTime[e.value];this.globalClocks[e.value].changeDuration(r)}}pauseAllClocks(){for(const e of this.allClocks)!1===e.isIdle()&&e.pause()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function C_(n){return hr((t,e)=>{Eo(n).subscribe(cs(e,()=>e.complete(),yo)),!e.closed&&t.subscribe(e)})}let qft=(()=>{class n{transform(e){const r=e%60,s=(e-r)%3600/60,i=(e-60*s-r)/3600,o=[];if(i>1?o.push($localize`${i} hours`):1===i&&o.push($localize`1 hour`),s>1?o.push($localize`${s} minutes`):1===s&&o.push($localize`1 minute`),r>1?o.push($localize`${r} seconds`):1===r&&o.push($localize`1 second`),0===o.length)return $localize`0 seconds`;if(1===o.length)return o[0];{const c=o.slice(0,-1).join(", "),u=o.slice(-1)[0];return $localize`${c} and ${u}`}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=ai({name:"humanDuration",type:n,pure:!0}),n})();function Wft(n,t){if(1&n&&(dn(0),wt(1),pn()),2&n){const e=C(3);T(1),c1(e.viewInfo.chosenOpponent)}}function jft(n,t){1&n&&Ce(0,44)}function Zft(n,t){if(1&n&&(b(0,"div",45)(1,"div",8)(2,"label",46),dn(3),Ce(4,47),pn(),b(5,"output"),wt(6),x3(7,"humanDuration"),A()(),b(8,"div",37),X(9,"input",48),A()(),b(10,"div",8)(11,"label",49),ga(12,50),X(13,"output"),x3(14,"humanDuration"),ma(),A(),b(15,"div",37),X(16,"input",51),A()()()),2&n){const e=C(3);T(6),c1(T4(7,2,e.viewInfo.maximalMoveDuration||0)),T(8),S1(T4(14,4,e.viewInfo.totalPartDuration||0)),N1(12)}}function Yft(n,t){1&n&&(b(0,"div"),ga(1,52),X(2,"br"),ma(),A())}function Kft(n,t){1&n&&(b(0,"button",64),Ce(1,65),A())}function Xft(n,t){if(1&n){const e=Ae();b(0,"tr",60),ee("click",function(){const i=de(e).$implicit;return le(C(4).selectOpponent(i))}),b(1,"td",61),wt(2),A(),b(3,"td",62),x(4,Kft,2,0,"button",63),A()()}if(2&n){const e=t.$implicit,r=C(4);p1("id","presenceOf_",e,""),w("ngClass",r.viewInfo.candidateClasses[e]),T(1),w("id",r.viewInfo.chosenOpponent===e?"selected_"+e:"candidate_"+e),T(1),c1(e),T(2),w("ngIf",r.viewInfo.chosenOpponent!==e)}}function Qft(n,t){if(1&n&&(dn(0),Ce(1,53),pn(),b(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),Ce(7,57),A(),b(8,"th",56),Ce(9,58),A()()(),b(10,"tbody"),x(11,Xft,5,5,"tr",59),A()()()),2&n){const e=C(3);T(11),w("ngForOf",e.viewInfo.candidates)}}function Jft(n,t){if(1&n){const e=Ae();b(0,"button",66),ee("click",function(){return de(e),le(C(3).changeConfig())}),Ce(1,67),A()}}function eht(n,t){if(1&n){const e=Ae();b(0,"div")(1,"h1",4),Ce(2,5),A(),b(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),Ce(7,10),A(),b(8,"div",11)(9,"button",12),ee("click",function(){return de(e),le(C(2).selectFirstPlayer("RANDOM"))}),Ce(10,13),A(),b(11,"button",14),ee("click",function(){return de(e),le(C(2).selectFirstPlayer("CREATOR"))}),Ce(12,15),A(),b(13,"button",16),ee("click",function(){return de(e),le(C(2).selectFirstPlayer("CHOSEN_PLAYER"))}),x(14,Wft,2,1,"ng-container",17),x(15,jft,1,0,"ng-template",null,18,qn),A()()(),b(17,"div",8)(18,"label",9),Ce(19,19),A(),b(20,"div",11)(21,"div",20),ee("click",function(){return de(e),le(C(2).selectPartType("STANDARD"))}),b(22,"div",21)(23,"span"),Ce(24,22),A()(),b(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),dn(29),Ce(30,26),pn(),b(31,"strong"),wt(32),x3(33,"humanDuration"),A(),X(34,"br"),dn(35),ga(36,27),X(37,"strong"),x3(38,"humanDuration"),ma(),pn(),A()()()()(),b(39,"div",28),ee("click",function(){return de(e),le(C(2).selectPartType("BLITZ"))}),b(40,"div",21)(41,"span"),Ce(42,29),A()(),b(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),dn(47),Ce(48,30),pn(),b(49,"strong"),wt(50),x3(51,"humanDuration"),A(),X(52,"br"),dn(53),ga(54,31),X(55,"strong"),x3(56,"humanDuration"),ma(),pn(),A()()()()(),b(57,"button",32),ee("click",function(){return de(e),le(C(2).selectPartType("CUSTOM"))}),Ce(58,33),A()()(),x(59,Zft,17,6,"div",34),b(60,"div",8)(61,"label",35),Ce(62,36),A(),b(63,"div",37),x(64,Yft,3,0,"div",17),x(65,Qft,12,1,"ng-template",null,38,qn),A()()(),b(67,"div",8)(68,"div",11)(69,"button",39),ee("click",function(){return de(e),le(C(2).proposeConfig())}),Ce(70,40),A(),x(71,Jft,2,0,"button",41),b(72,"button",42),ee("click",function(){return de(e),le(C(2).cancelGameCreation())}),Ce(73,43),A()()()()()}if(2&n){const e=Hn(16),r=Hn(66),s=C(2);T(3),w("formGroup",s.configFormGroup),T(1),w("disabled",!s.viewInfo.canEditConfig),T(5),w("ngClass",s.viewInfo.firstPlayerClasses.RANDOM),T(2),w("ngClass",s.viewInfo.firstPlayerClasses.CREATOR),T(2),w("ngClass",s.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),T(1),w("ngIf",s.viewInfo.chosenOpponent)("ngIfElse",e),T(7),w("ngClass",s.viewInfo.partTypeClasses.STANDARD),T(11),c1(T4(33,19,s.partType.NORMAL_MOVE_DURATION)),T(6),S1(T4(38,21,s.partType.NORMAL_PART_DURATION)),N1(36),T(1),w("ngClass",s.viewInfo.partTypeClasses.BLITZ),T(11),c1(T4(51,23,s.partType.BLITZ_MOVE_DURATION)),T(6),S1(T4(56,25,s.partType.BLITZ_PART_DURATION)),N1(54),T(1),w("ngClass",s.viewInfo.partTypeClasses.CUSTOM),T(2),w("ngIf",s.viewInfo.showCustomTime),T(5),w("ngIf",0===s.viewInfo.candidates.length)("ngIfElse",r),T(5),w("disabled",!s.viewInfo.canProposeConfig),T(2),w("ngIf",s.viewInfo.canReviewConfig)}}function tht(n,t){if(1&n&&(b(0,"div",74)(1,"p"),ga(2,75),X(3,"br"),ma(),A()()),2&n){const e=C(3);T(3),S1(e.viewInfo.creator),N1(2)}}function nht(n,t){if(1&n&&(b(0,"span"),Ce(1,81),A()),2&n){const e=C(4);T(1),S1(e.viewInfo.creator),N1(1)}}function rht(n,t){1&n&&(b(0,"span"),Ce(1,82),A())}function sht(n,t){1&n&&(b(0,"span"),Ce(1,83),A())}function iht(n,t){if(1&n){const e=Ae();b(0,"div",74)(1,"p"),Ce(2,76),A(),b(3,"ul")(4,"li"),x(5,nht,2,1,"span",2),x(6,rht,2,0,"span",2),x(7,sht,2,0,"span",2),A(),b(8,"li"),ga(9,77),X(10,"strong"),x3(11,"humanDuration"),ma(),A(),b(12,"li"),ga(13,78),X(14,"strong"),x3(15,"humanDuration"),ma(),A()(),b(16,"button",79),ee("click",function(){return de(e),le(C(3).acceptConfig())}),Ce(17,80),A()()}if(2&n){const e=C(3);T(2),S1(e.viewInfo.creator)(e.viewInfo.partTypeName),N1(2),T(3),w("ngIf","CREATOR"===e.viewInfo.firstPlayer),T(1),w("ngIf","CHOSEN_PLAYER"===e.viewInfo.firstPlayer),T(1),w("ngIf","RANDOM"===e.viewInfo.firstPlayer),T(4),S1(T4(11,7,e.viewInfo.maximalMoveDuration||0)),N1(9),T(4),S1(T4(15,9,e.viewInfo.totalPartDuration||0)),N1(13)}}function oht(n,t){if(1&n&&(b(0,"div")(1,"div",68)(2,"div",69)(3,"p"),Ce(4,70),A()(),b(5,"div",71),x(6,tht,4,1,"div",72),x(7,iht,18,11,"ng-template",null,73,qn),A()()()),2&n){const e=Hn(8),r=C(2);T(6),w("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function aht(n,t){if(1&n&&(dn(0),Ce(1,86),pn()),2&n){const e=C(3);T(1),S1(e.viewInfo.creator),N1(1)}}function cht(n,t){if(1&n&&Ce(0,87),2&n){const e=C(3);S1(e.viewInfo.creator)(e.viewInfo.chosenOpponent),N1(0)}}function lht(n,t){if(1&n&&(b(0,"div",68)(1,"div",69)(2,"p"),Ce(3,84),A()(),b(4,"div",71)(5,"p"),x(6,aht,2,1,"ng-container",17),x(7,cht,1,2,"ng-template",null,85,qn),A()()()),2&n){const e=Hn(8),r=C(2);T(6),w("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function uht(n,t){if(1&n&&(b(0,"div",1),x(1,eht,74,27,"div",2),x(2,oht,9,2,"div",2),x(3,lht,9,2,"div",3),A()),2&n){const e=C();T(1),w("ngIf",e.viewInfo.userIsCreator),T(1),w("ngIf",e.viewInfo.userIsChosenOpponent),T(1),w("ngIf",e.viewInfo.userIsObserver)}}class f1{constructor(t,e,r,s,i,o,c,u,h,g){this.router=t,this.actRoute=e,this.connectedUserService=r,this.currentGameService=s,this.gameService=i,this.configRoomService=o,this.chatService=c,this.userService=u,this.formBuilder=h,this.messageDisplayer=g,this.partType=Ar,this.gameStartNotification=new dr,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new W2,this.allUserInterval=y.empty(),this.ownTokenInterval=y.empty(),this.selfSubscription=new k1,this.configRoomSubscription=new k1,this.candidatesSubscription=new k1,this.allDocDeleted=!1,J(f1.VERBOSE,"PartCreationComponent constructed")}ngOnInit(){var t=this;return I(function*(){J(f1.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms();const e=yield t.configRoomService.joinGame(t.partId);if(e.isFailure()){const r=e.getReason();t.messageDisplayer.criticalMessage(r)}else yield t.startSendingPresenceTokens(),t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),J(f1.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds")})()}checkInputs(){const t=this.connectedUserService.user;We(t.isPresent(),"PartCreationComponent should not be called without connected user"),We(t.get()!==R5.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),We(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[Ks.RANDOM.value,Dp.required],maximalMoveDuration:[Ar.NORMAL_MOVE_DURATION,Dp.required],partType:["STANDARD",Dp.required],totalPartDuration:[Ar.NORMAL_PART_DURATION,Dp.required],chosenOpponent:["",Dp.required]})}updateUserDocWithCurrentGame(t){J(f1.VERBOSE,"updateUserDocWithCurrentGame of '"+this.partId+"'");const e=this.getUserRoleInPart(t),r={id:this.partId,opponent:this.getOpponent(),typeGame:ge.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:e};return this.currentGameService.updateCurrentGame(r)}getUserRoleInPart(t){const e=this.connectedUserService.user.get().id;return e===t.creator.id?"Creator":e===t.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let t=null;return t=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:ge.getNonNullable(this.currentConfigRoom?.creator),t}subscribeToConfigRoomDoc(){var t=this;const e=function(){var s=I(function*(i){yield t.onCurrentConfigRoomUpdate(i)});return function(o){return s.apply(this,arguments)}}(),r=function(){var s=I(function*(i){yield t.onCandidatesUpdate(i)});return function(o){return s.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,e),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}getForm(t){return ge.getNonNullable(this.configFormGroup.get(t))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(C_(this.ngUnsubscribe)).subscribe(t=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[t]=["is-selected"],this.viewInfo.chosenOpponent=t;const e=ge.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=e!==Xs.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(C_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],this.viewInfo.partType=t,this.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(C_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(C_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(C_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],this.viewInfo.firstPlayer=t})}updateViewInfo(){const t=ge.getNonNullable(this.currentConfigRoom),e=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=t.partStatus===Xs.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=t.partStatus!==Xs.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(t),this.viewInfo.userIsChosenOpponent=e.id===t.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=t.partStatus!==Xs.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=t.creator.name,this.viewInfo.candidates=this.candidates.map(r=>r.name),this.userIsCreator(t)?this.setDataForCreator(t):(this.viewInfo.maximalMoveDuration=t.maximalMoveDuration,this.viewInfo.totalPartDuration=t.totalPartDuration,this.viewInfo.partType=t.partType,this.viewInfo.chosenOpponent=t.chosenOpponent?.name,this.viewInfo.firstPlayer=t.firstPlayer),t.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(t){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??t.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??t.totalPartDuration;let e=this.viewInfo.chosenOpponent;null==e||""===e?e=t.chosenOpponent?.name??"":!1===this.candidates.some(s=>s.name===e)&&(e=""),this.getForm("chosenOpponent").setValue(e)}selectFirstPlayer(t){this.getForm("firstPlayer").setValue(t)}selectPartType(t){"STANDARD"===t?(this.getForm("maximalMoveDuration").setValue(Ar.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Ar.NORMAL_PART_DURATION)):"BLITZ"===t&&(this.getForm("maximalMoveDuration").setValue(Ar.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Ar.BLITZ_PART_DURATION)),this.getForm("partType").setValue(t)}selectOpponent(t){var e=this;return I(function*(){J(f1.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")");const r=e.getUserFromName(t);yield Promise.all([e.currentGameService.updateCurrentGame({opponent:r}),e.configRoomService.setChosenOpponent(e.partId,r)])})()}getUserFromName(t){const e=this.candidates.find(r=>r.name===t);return ge.getNonNullable(e)}changeConfig(){var t=this;return I(function*(){return t.configRoomService.reviewConfig(t.partId)})()}proposeConfig(){var t=this;return I(function*(){const e=t.getForm("chosenOpponent").value,r=t.getForm("partType").value,s=t.getForm("maximalMoveDuration").value,i=t.getForm("firstPlayer").value,o=t.getForm("totalPartDuration").value,c=t.getUserFromName(e);return t.configRoomService.proposeConfig(t.partId,c,Ar.of(r),s,Ks.of(i),o)})()}cancelGameCreation(){var t=this;return I(function*(){t.allDocDeleted=!0,yield t.currentGameService.removeCurrentGame(),J(f1.VERBOSE,"PartCreationComponent.cancelGameCreation"),yield t.chatService.deleteChat(t.partId),J(f1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),yield t.gameService.deletePart(t.partId),J(f1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),yield t.configRoomService.deleteConfigRoom(t.partId,t.candidates),J(f1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(t){var e=this;return I(function*(){if(J(f1.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(e.currentConfigRoom),then:JSON.stringify(t)}}),t.isAbsent())return J(f1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),e.onGameCancelled();{const r=t.get();if(e.chosenOpponentJustLeft(r)&&e.userIsCreator(r)){const i=ge.getNonNullable(e.currentConfigRoom),o=ge.getNonNullable(i.chosenOpponent).name;e.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield e.currentGameService.updateCurrentGame({opponent:null})}let s=!1;e.userJustChosenAsOpponent(r)&&(yield e.updateUserDocWithCurrentGame(r),s=!0),e.currentConfigRoom=r,e.allUserInterval.isAbsent()&&(We(!1===s,"Expected currentGameUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield e.updateUserDocWithCurrentGame(e.currentConfigRoom),yield e.observeNeededPlayers()),e.updateViewInfo(),e.isGameStarted(e.currentConfigRoom)&&(J(f1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),e.onGameStarted())}})()}onCandidatesUpdate(t){var e=this;return I(function*(){e.candidates=t,e.updateViewInfo()})()}userJustChosenAsOpponent(t){if(this.isGameStarted(t))return!1;const e=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==e&&t.chosenOpponent?.id===e}chosenOpponentJustLeft(t){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==t.chosenOpponent)}onGameCancelled(){var t=this;return I(function*(){J(f1.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield t.router.navigate(["/lobby"])})()}isGameStarted(t){return We(null!=t,"configRoom should not be null (isGameStarted)"),ge.getNonNullable(t).partStatus===Xs.PART_STARTED.value}onGameStarted(){const t=ge.getNonNullable(this.currentConfigRoom);J(f1.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,J(f1.VERBOSE,"PartCreationComponent.onGameStarted finished")}observeNeededPlayers(){var t=this;return I(function*(){const e=ge.getNonNullable(t.currentConfigRoom);J(f1.VERBOSE,{PartCreationComponent_observeNeededPlayers:{configRoom:e}}),We(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),t.allUserInterval=y.of(window.setInterval(I(function*(){const r=t.lastToken;t.userIsCreator(e)?yield t.checkCandidatesTokensFreshness(r):yield t.checkCreatorTokenFreshness(r)}),f1.TOKEN_INTERVAL))})()}userIsCreator(t){return this.connectedUserService.user.get().id===t.creator.id}checkCreatorTokenFreshness(t){var e=this;return I(function*(){const r=ge.getNonNullable(e.currentConfigRoom);(yield e.didUserTimeout(r.creator.id,t))&&(yield e.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var t=this;return I(function*(){We(!1===t.isGameStarted(t.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),We(!1===t.allDocDeleted,"Should not delete doc twice"),yield t.cancelGameCreation()})()}checkCandidatesTokensFreshness(t){var e=this;return I(function*(){for(const r of e.candidates)(yield e.didUserTimeout(r.id,t))&&(yield e.removeCandidateFromLobby(r))})()}didUserTimeout(t,e){var r=this;return I(function*(){const s=yield r.userService.getUserLastUpdateTime(t);return s.isAbsent()?(Ns.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):T4e(s.get(),e)>f1.TOKEN_TIMEOUT})()}removeCandidateFromLobby(t){var e=this;return I(function*(){const r=ge.getNonNullable(e.currentConfigRoom);return t.id===r.chosenOpponent?.id&&(yield e.configRoomService.reviewConfigAndRemoveChosenOpponent(e.partId)),e.configRoomService.removeCandidate(e.partId,t)})()}startSendingPresenceTokens(){var t=this;return I(function*(){yield t.connectedUserService.sendPresenceToken(),We(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=y.of(window.setInterval(()=>{t.connectedUserService.sendPresenceToken()},f1.TOKEN_INTERVAL));const e=t.connectedUserService.user.get().id;t.selfSubscription=t.userService.observeUserOnServer(e,r=>{We(r.isPresent(),"connected user should exist"),t.lastToken=ge.getNonNullable(r.get().lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=y.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return J(f1.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,ge.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var t=this;return I(function*(){if(J(f1.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded(),t.connectedUserService.user.isAbsent())return;const e=t.connectedUserService.user.get();!0!==t.gameStarted&&(null===t.currentConfigRoom?J(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"):!0===t.allDocDeleted?J(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"):e.id===t.currentConfigRoom.creator.id?(J(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),yield t.cancelGameCreation()):(J(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),yield t.currentGameService.removeCurrentGame(),yield t.configRoomService.cancelJoining(t.partId)))})()}}function fht(n,t){if(1&n){const e=Ae();b(0,"button",3),ee("click",function(){return de(e),le(C().addTime())}),Ce(1,4),A()}if(2&n){const e=C();T(1),S1(e.timeToAdd),N1(1)}}f1.VERBOSE=!1,f1.TOKEN_INTERVAL=5e3,f1.TOKEN_TIMEOUT=2*f1.TOKEN_INTERVAL,f1.\u0275fac=function(t){return new(t||f1)(Q(Xn),Q(zo),Q(Is),Q(D2),Q(GS),Q(uV),Q(BS),Q(Rh),Q(x7e),Q(_n))},f1.\u0275cmp=ct({type:f1,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let n,t,e,r,s,i,o,c,u,h,g,m,E,O,k,U,j,oe,Ee,ne,ke,Ue,et,Bt,B1,x1,bn,L6,r3,ka,R6,D6,St,Wt,en,i1;return n=$localize`Game creation`,t=$localize`First player`,e=$localize`Random`,r=$localize`You`,s=$localize`Game type`,i=$localize`Standard`,o=$localize`Maximal turn duration: `,c=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,u=$localize`Blitz`,h=$localize`Maximal turn duration: `,g=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,m=$localize`Custom`,E=$localize`Opponents`,O=$localize`Propose configuration`,k=$localize`Cancel game`,U=$localize`The opponent`,j=$localize`Maximal turn duration: `,oe=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,Ee=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,ne=$localize`Click on the opponent against which you would like to play.`,ke=$localize`Name`,Ue=$localize`Actions`,et=$localize`Pick`,Bt=$localize`Change configuration`,B1=$localize`Configuration proposal`,x1=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,bn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,L6=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,r3=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,ka=$localize`Accept and start`,R6=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,D6=$localize`you play first`,St=$localize`the first player is selected randomly`,Wt=$localize`One moment...`,en=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,i1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],n,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],t,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],e,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],r,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],s,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],i,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,c,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],u,h,g,["id","partTypeCustom",1,"button",3,"ngClass","click"],m,["id","customTime",4,"ngIf"],[1,"label"],E,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],O,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],k,U,["id","customTime"],["for","maximalMoveDuration",1,"label"],j,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],oe,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],Ee,ne,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],ke,Ue,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],et,["id","reviewConfig",1,"button",3,"click"],Bt,[1,"message","is-primary"],[1,"message-header"],B1,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],x1,bn,L6,r3,["id","acceptConfig",1,"button","is-primary",3,"click"],ka,R6,D6,St,Wt,["proposalSent",""],en,i1]},template:function(t,e){1&t&&x(0,uht,4,3,"div",0),2&t&&w("ngIf",e.viewInfo)},dependencies:[hn,En,Kt,Fu,I4,tE,Gl,Hu,Bu,kf,qft],encapsulation:2});let hht=(()=>{class n{constructor(){this.timeoutHandleGlobal=null,this.timeoutHandleSec=null,this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new dr,this.addTimeToOpponent=new dr,this.cssClasses=n.SAFE_TIME}ngOnInit(){J(n.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}setDuration(e){J(n.VERBOSE,this.debugName+".set("+e+"ms)"),ge.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){ge.assert(this.isPaused,"Should not change duration of a clock while it is running"),this.remainingMs=e,this.displayDuration()}subtract(e){this.changeDuration(this.remainingMs-e)}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){J(n.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),ge.assert(this.isSet,"Should not start a chrono that has not been set!"),ge.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){J(n.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),ge.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){J(n.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){J(n.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),ge.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),ge.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){J(n.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),ge.assert(this.started,"Should only stop chrono that are started!"),!1===this.isPaused&&this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?n.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?n.DANGER_TIME_ODD:n.DANGER_TIME_EVEN:n.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){J(n.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}}return n.VERBOSE=!1,n.DANGER_TIME_EVEN="has-background-danger has-text-white",n.DANGER_TIME_ODD="has-background-warning has-text-white",n.PASSIVE_STYLE="has-text-passive is-italic",n.SAFE_TIME="",n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ct({type:n,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let t;return t=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],t]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),wt(2),x3(3,"number"),A(),x(4,fht,2,1,"button",2),A()),2&e&&(w("ngClass",r.getTimeClass()),T(2),hb("",r.displayedMinute,":",pU(3,4,r.displayedSec,"2.0-0"),""),T(2),w("ngIf",r.canAddTime))},dependencies:[hn,Kt,FG],encapsulation:2}),n})();const dht=["chronoZeroGlobal"],pht=["chronoOneGlobal"],ght=["chronoZeroTurn"],mht=["chronoOneTurn"];function _ht(n,t){if(1&n){const e=Ae();b(0,"app-part-creation",5,6),ee("gameStartNotification",function(s){return de(e),le(C().startGame(s))}),A()}2&n&&w("partId",C().currentPartId)}function vht(n,t){1&n&&(dn(0),b(1,"span",39),Ce(2,40),A(),pn())}function Cht(n,t){if(1&n&&(b(0,"span",41),Ce(1,42),A()),2&n){const e=C(4);T(1),S1(null==e.currentPlayer?null:e.currentPlayer.name),N1(1)}}function yht(n,t){if(1&n&&(b(0,"p",36),x(1,vht,3,0,"ng-container",37),x(2,Cht,2,1,"ng-template",null,38,qn),A()),2&n){const e=Hn(3),r=C(3);T(1),w("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",e)}}function Eht(n,t){if(1&n&&(b(0,"div",32)(1,"p",33),Ce(2,34),A(),x(3,yht,4,2,"p",35),A()),2&n){const e=C(2);T(2),S1(e.currentPart.getTurn()+1),N1(2),T(1),w("ngIf",!1===e.endGame)}}function Mht(n,t){if(1&n&&(b(0,"p",43),wt(1),A()),2&n){const e=C(2);w("ngClass",e.getPlayerNameClass(e.Player.ZERO)),T(1),c1(e.players[0].get().name)}}function Sht(n,t){if(1&n&&(b(0,"p",44),Ce(1,45),A()),2&n){const e=C(2);T(1),S1(e.gameComponent.scores.get()[0]),N1(1)}}function Pht(n,t){if(1&n&&(b(0,"p",46),wt(1),A()),2&n){const e=C(2);w("ngClass",e.getPlayerNameClass(e.Player.ONE)),T(1),c1(e.players[1].get().name)}}function Tht(n,t){if(1&n&&(b(0,"p",47),Ce(1,48),A()),2&n){const e=C(2);T(1),S1(e.gameComponent.scores.get()[1]),N1(1)}}function wht(n,t){1&n&&(b(0,"div")(1,"p",50),Ce(2,51),A()())}function Oht(n,t){1&n&&(b(0,"p",55),Ce(1,56),A())}function bht(n,t){1&n&&(b(0,"p",57),Ce(1,58),A())}function Aht(n,t){1&n&&(b(0,"p",59),Ce(1,60),A())}function Nht(n,t){if(1&n&&(b(0,"div"),x(1,Oht,2,0,"p",52),x(2,bht,2,0,"p",53),x(3,Aht,2,0,"p",54),A()),2&n){const e=C(3);T(1),w("ngIf",e.currentPart.getDrawAccepter().name===e.getPlayer().name),T(1),w("ngIf",e.currentPart.getDrawAccepter().name!==e.getPlayer().name&&e.isPlaying()),T(1),w("ngIf",!1===e.isPlaying())}}function Iht(n,t){1&n&&(b(0,"p",64),Ce(1,65),A())}function xht(n,t){1&n&&(b(0,"p",66),Ce(1,67),A())}function kht(n,t){if(1&n&&(b(0,"p",68),Ce(1,69),A()),2&n){const e=C(4);T(1),S1(e.currentPart.getWinner().get().name),N1(1)}}function Lht(n,t){if(1&n&&(b(0,"div"),x(1,Iht,2,0,"p",61),x(2,xht,2,0,"p",62),x(3,kht,2,1,"p",63),A()),2&n){const e=C(3);T(1),w("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),T(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),T(1),w("ngIf",!1===e.isPlaying())}}function Rht(n,t){if(1&n&&(b(0,"p",64),Ce(1,70),A()),2&n){const e=C(4);T(1),S1(e.currentPart.getLoser().get().name),N1(1)}}function Dht(n,t){1&n&&(b(0,"p",68),Ce(1,71),A())}function zht(n,t){if(1&n&&(b(0,"p",68),Ce(1,72),A()),2&n){const e=C(4);T(1),S1(e.currentPart.getLoser().get().name),N1(1)}}function Vht(n,t){if(1&n&&(b(0,"div"),x(1,Rht,2,1,"p",61),x(2,Dht,2,0,"p",63),x(3,zht,2,1,"p",63),A()),2&n){const e=C(3);T(1),w("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),T(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),T(1),w("ngIf",!1===e.isPlaying())}}function Hht(n,t){1&n&&(b(0,"p",74),Ce(1,75),A())}function Fht(n,t){if(1&n&&(b(0,"p",74),Ce(1,76),A()),2&n){const e=C(4);T(1),S1(e.currentPart.getLoser().get().name),N1(1)}}function Bht(n,t){if(1&n&&(b(0,"div"),x(1,Hht,2,0,"p",73),x(2,Fht,2,1,"p",73),A()),2&n){const e=C(3);T(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),T(1),w("ngIf",!1===e.isPlaying()||e.currentPart.getWinner().get().name===e.getPlayer().name)}}function $ht(n,t){if(1&n&&(b(0,"div",49),X(1,"hr"),x(2,wht,3,0,"div",27),x(3,Nht,4,3,"div",27),x(4,Lht,4,3,"div",27),x(5,Vht,4,3,"div",27),x(6,Bht,3,2,"div",27),A()),2&n){const e=C(2);T(2),w("ngIf",e.currentPart.isHardDraw()),T(1),w("ngIf",e.currentPart.isAgreedDraw()),T(1),w("ngIf",e.currentPart.isWin()),T(1),w("ngIf",e.currentPart.isTimeout()),T(1),w("ngIf",e.currentPart.isResign())}}function Uht(n,t){if(1&n){const e=Ae();dn(0),b(1,"button",85),ee("click",function(){const i=de(e).$implicit;return le(C(4).propose(i))}),wt(2),X(3,"fa-icon",86),A(),pn()}if(2&n){const e=t.$implicit,r=C(4);T(1),p1("id","propose",e,""),w("disabled",!1===r.requestAvailable(e)),T(1),Bi("",r.requestInfos[e].textForRequest(),"\xa0\xa0"),T(1),w("icon",r.requestInfos[e].icon)}}function Ght(n,t){if(1&n){const e=Ae();dn(0),b(1,"button",80),ee("click",function(){return de(e),le(C(3).resign())}),Ce(2,81),A(),b(3,"button",82),ee("click",function(){return de(e),le(C(3).gameComponent.pass())}),Ce(4,83),A(),x(5,Uht,4,4,"ng-container",84),pn()}if(2&n){const e=C(3);T(1),w("disabled",!1===e.canResign()),T(2),w("disabled",!1===e.canPass()),T(2),w("ngForOf",e.allRequests)}}function qht(n,t){if(1&n){const e=Ae();b(0,"div",87)(1,"p"),wt(2),X(3,"fa-icon",86),A(),b(4,"button",88),ee("click",function(){return de(e),le(C(3).accept())}),Ce(5,89),A(),b(6,"button",90),ee("click",function(){return de(e),le(C(3).reject())}),Ce(7,91),A()()}if(2&n){const e=C(3);T(2),Bi(" ",e.requestInfos[e.requestAwaitingReplyFromUs().get()].textForReply(),"\xa0\xa0 "),T(1),w("icon",e.requestInfos[e.requestAwaitingReplyFromUs().get()].icon)}}function Wht(n,t){if(1&n&&(b(0,"div",92)(1,"p")(2,"span"),ga(3,93),X(4,"fa-icon",86),ma(),A()()()),2&n){const e=C(3);T(4),w("icon",e.requestInfos[e.deniedRequest().get()].icon),S1(e.requestInfos[e.deniedRequest().get()].name()),N1(3)}}function jht(n,t){if(1&n&&(b(0,"div",94)(1,"p")(2,"span"),ga(3,95),X(4,"fa-icon",86),ma(),A()()()),2&n){const e=C(3);T(4),w("icon",e.requestInfos[e.requestAwaitingReplyFromOpponent().get()].icon),S1(e.requestInfos[e.requestAwaitingReplyFromOpponent().get()].name()),N1(3)}}function Zht(n,t){if(1&n&&(dn(0),x(1,Ght,6,3,"ng-container",37),x(2,qht,8,2,"ng-template",null,77,qn),x(4,Wht,5,2,"div",78),x(5,jht,5,2,"div",79),pn()),2&n){const e=Hn(3),r=C(2);T(1),w("ngIf",!1===r.mustReply())("ngIfElse",e),T(3),w("ngIf",r.deniedRequest().isPresent()),T(1),w("ngIf",r.requestAwaitingReplyFromOpponent().isPresent())}}function Yht(n,t){1&n&&(b(0,"button",96),Ce(1,97),A())}function Kht(n,t){if(1&n){const e=Ae();b(0,"div",7)(1,"div",8)(2,"div",9),x(3,Eht,4,2,"div",10),b(4,"div",11),x(5,Mht,2,2,"p",12),x(6,Sht,2,1,"p",13),b(7,"app-count-down",14,15),ee("outOfTimeAction",function(){de(e);const s=C();return le(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return de(e),le(C().addGlobalTime())}),A(),b(9,"app-count-down",16,17),ee("outOfTimeAction",function(){de(e);const s=C();return le(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return de(e),le(C().addTurnTime())}),A()(),b(11,"p",18),Ce(12,19),A(),b(13,"div",11),x(14,Pht,2,2,"p",20),x(15,Tht,2,1,"p",21),b(16,"app-count-down",22,23),ee("outOfTimeAction",function(){de(e);const s=C();return le(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return de(e),le(C().addGlobalTime())}),A(),b(18,"app-count-down",24,25),ee("outOfTimeAction",function(){de(e);const s=C();return le(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return de(e),le(C().addTurnTime())}),A()(),X(20,"hr"),x(21,$ht,7,5,"div",26),x(22,Zht,6,4,"ng-container",27),x(23,Yht,2,0,"button",28),A()(),b(24,"div",29)(25,"div",30),X(26,"div",null,31),A()()()}if(2&n){const e=C();T(3),w("ngIf",null!==e.currentPart),T(2),w("ngIf",e.players[0].isPresent()),T(1),w("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),T(1),w("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),T(2),w("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),T(5),w("ngIf",e.players[1].isPresent()),T(1),w("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),T(1),w("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),T(2),w("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),T(3),w("ngIf",e.endGame&&null!==e.currentPart),T(1),w("ngIf",e.isPlaying()),T(1),w("ngIf",e.endGame),T(1),w("ngClass",e.getBoardHighlight())}}let Xht=(()=>{class n{}return n.NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`,n})(),Qht=(()=>{class n extends dT{constructor(e,r,s,i,o,c,u,h,g,m){super(e,r,s,i),this.currentGameService=o,this.userService=c,this.gameService=u,this.gameEventService=h,this.timeManager=g,this.requestManager=m,this.currentPart=null,this.gameStarted=!1,this.opponent=null,this.currentPlayer=null,this.currentGame=y.empty(),this.userLinkedToThisPart=!0,this.opponentSubscription=new k1,this.partSubscription=new k1,this.gameEventsSubscription=new k1,this.currentGameSubscription=new k1,this.OFFLINE_FONT_COLOR={color:"lightgrey"},this.globalTimeMessage=$localize`5 minutes`,this.turnTimeMessage=$localize`30 seconds`,this.requestInfos=S4e.requestInfos,this.allRequests=["TakeBack","Draw","Rematch"],J(n.VERBOSE,"OnlineGameWrapperComponent constructed")}extractPartIdFromURL(){return ge.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return ge.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}redirectIfPartOrGameIsInvalid(){var e=this;return I(function*(){const r=e.extractGameNameFromURL();if(o9.ALL_GAMES().some(i=>i.urlName===r)){if((yield e.gameService.getPartValidity(e.currentPartId,r)).isFailure()){e.routerEventsSubscription.unsubscribe();const o=Xht.NO_MATCHING_PART();yield e.router.navigate(["/notFound",o],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=K5.NO_MATCHING_GAME(r);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSubscription=e.router.events.subscribe(function(){var r=I(function*(s){s instanceof U0&&(yield e.setCurrentPartIdOrRedirect())});return function(s){return r.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(r=>{e.authUser=r}),yield e.setCurrentPartIdOrRedirect(),e.currentGameSubscription=e.currentGameService.subscribeToCurrentGame(function(){var r=I(function*(s){yield e.onCurrentGameUpdate(s)});return function(s){return r.apply(this,arguments)}}()),J(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done")})()}onCurrentGameUpdate(e){var r=this;return I(function*(){if(J(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentGameUpdate called"),e.isPresent()){const s=e.get();"Observer"===s.role||s.id===r.currentPartId?r.currentGame=e:(r.userLinkedToThisPart=!1,yield r.router.navigate(["/lobby"]))}else r.currentGame=y.empty()})()}startGame(e){var r=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),ge.assert(!1===r.gameStarted,"Should not start already started game"),r.configRoom=e,r.gameStarted=!0,window.setTimeout(I(function*(){const s=yield r.afterViewInit();r.timeManager.setClocks([r.chronoZeroTurn,r.chronoOneTurn],[r.chronoZeroGlobal,r.chronoOneGlobal]),ge.assert(s,"Game should be created successfully, otherwise part-creation would have redirected"),yield r.startPart()}),2)})()}startPart(){var e=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.startPart");const r=(yield e.gameService.getPart(e.currentPartId)).get();e.currentPart=new $S(e.currentPartId,r),e.partSubscription=e.gameService.subscribeToChanges(e.currentPartId,function(){var s=I(function*(i){ge.assert(i.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.currentPart=new $S(e.currentPartId,i.get())});return function(i){return s.apply(this,arguments)}}()),e.subscribeToEvents()})()}onGameStart(){var e=this;return I(function*(){yield e.initializePlayersDatas(e.currentPart);const r=e.gameComponent.getTurn();ge.assert(0===r,"turn should always be 0 upon game start"),e.timeManager.onGameStart(e.configRoom),e.requestManager.onGameStart()})()}subscribeToEvents(){var e=this;const r=new $ft,s=function(){var i=I(function*(o){yield r.runExclusive(I(function*(){e.beforeEventsBatch();for(const c of o)switch(c.eventType){case"Move":const u=c;yield e.onReceivedMove(u);break;case"Request":e.requestManager.onReceivedRequest(c);break;case"Reply":const g=c;(yield e.requestManager.onReceivedReply(g,e.role))&&(yield e.handleReply(g));break;default:ge.expectToBe(c.eventType,"Action","Event should be an action");const E=c;e.timeManager.onReceivedAction(E),"EndGame"===E.action?yield e.onGameEnd():"StartGame"===E.action&&(yield e.onGameStart())}yield e.afterEventsBatch()}))});return function(c){return i.apply(this,arguments)}}();this.gameEventsSubscription=this.gameEventService.subscribeToEvents(this.currentPartId,s)}handleReply(e){var r=this;return I(function*(){switch(e.requestType){case"TakeBack":const s=B.of(e.player);r.takeBackToPreviousPlayerTurn(s.getOpponent());break;case"Rematch":yield r.router.navigate(["/nextGameLoading"]);const i=r.extractGameNameFromURL();yield r.router.navigate(["/play",i,e.data])}})()}onGameEnd(){var e=this;return I(function*(){yield e.currentGameService.removeCurrentGame(),e.endGame=!0})()}onReceivedMove(e){var r=this;return I(function*(){const s=r.gameComponent.rules,i=r.gameComponent.getTurn(),o=r.gameComponent.encoder.decode(e.move),c=s.isLegal(o,r.gameComponent.getState()),u="We received an incorrect db move: "+o.toString()+" at turn "+i+'because "'+c.getReasonOr("")+'"';ge.assert(c.isSuccess(),u);const h=s.choose(r.gameComponent.node,o);ge.assert(h.isPresent(),"Chosen move should be legal after all checks, but it is not!"),r.gameComponent.node=h.get(),r.updateBoardAndShowLastMove(),r.currentPlayer=r.players[r.gameComponent.getTurn()%2].get(),r.timeManager.onReceivedMove(e),r.requestManager.onReceivedMove()})()}beforeEventsBatch(){this.timeManager.beforeEventsBatch(this.endGame)}afterEventsBatch(){var e=this;return I(function*(){const r=B.ofTurn(e.gameComponent.getTurn()),s=yield e.userService.getServerTime(e.connectedUserService.user.get().id);e.timeManager.afterEventsBatch(e.endGame,r,s)})()}takeBackToPreviousPlayerTurn(e){J(n.VERBOSE,"OnlineGameWrapperComponent.takeBackToPreviousPlayerTurn"),this.gameComponent.node=this.gameComponent.node.mother.get(),this.gameComponent.getCurrentPlayer()!==e&&(this.gameComponent.node=this.gameComponent.node.mother.get()),this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.updateBoardAndShowLastMove()}canResign(){return ge.assert(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}requestAvailable(e){switch(e){case"TakeBack":return this.canAskTakeBack();case"Draw":return this.canProposeDraw();default:return ge.expectToBe(e,"Rematch"),this.endGame}}mustReply(){return this.requestAwaitingReplyFromUs().isPresent()}requestAwaitingReplyFromUs(){return ge.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role)}requestAwaitingReplyFromOpponent(){return ge.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role.getOpponent())}deniedRequest(){return this.requestManager.deniedRequest()}canPass(){return ge.assert(this.isPlaying(),"Non playing should not call canPass"),!this.endGame&&this.currentPlayer?.name===this.getPlayer().name&&this.gameComponent.canPass}canAskTakeBack(){return ge.assert(this.isPlaying(),"Non playing should not call canAskTakeBack"),ge.assert(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(!0===this.endGame||ge.getNonNullable(this.currentPart).data.turn<=this.role.value)&&this.requestManager.canMakeRequest("TakeBack")}canProposeDraw(){return ge.assert(this.isPlaying(),"Non playing should not call canProposeDraw"),!this.endGame&&this.requestManager.canMakeRequest("Draw")}initializePlayersDatas(e){var r=this;return I(function*(){J(n.VERBOSE,{OnlineGameWrapper_initializePlayersDatas:e}),r.players=[y.of(e.data.playerZero),y.ofNullable(e.data.playerOne)],ge.assert(null!=e.data.playerOne,"should not initializePlayersDatas when players data is not received"),r.currentPlayer=r.players[e.data.turn%2].get();const s=yield r.setRealObserverRole();if(s.isPresent()){const i=o=>{ge.assert(o.isPresent(),"opponent was deleted, what sorcery is this"),r.opponent=s.get()};r.opponentSubscription=r.userService.observeUserOnServer(s.get().id,i)}})()}setRealObserverRole(){var e=this;return I(function*(){let r=y.empty();return e.players[0].equalsValue(e.getPlayer())?(e.setRole(B.ZERO),r=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(e.setRole(B.ONE),r=e.players[0]):e.setRole(ue.NONE),yield e.currentGameService.updateCurrentGame({...e.currentGame.get(),role:e.role===ue.NONE?"Observer":"Player"}),r})()}onLegalUserMove(e){var r=this;return I(function*(){if(J(n.VERBOSE,"OnlineGameWrapperComponent.onLegalUserMove"),!r.mustReply()){const s=r.gameComponent.rules.isLegal(e,r.gameComponent.node.gameState);ge.assert(s.isSuccess(),"onLegalUserMove called with an illegal move");const i=r.gameComponent.rules.applyLegalMove(e,r.gameComponent.node.gameState,s.get()),o=new mr(i,y.of(r.gameComponent.node),y.of(e)),c=r.gameComponent.rules.getGameStatus(o),u=r.gameComponent.encoder.encode(e);return yield r.gameService.addMove(r.currentPartId,r.role,u),r.updatePartWithStatusAndScores(c,r.gameComponent.scores)}r.gameComponent.message(K5.MUST_ANSWER_REQUEST())})()}updatePartWithStatusAndScores(e,r){var s=this;return I(function*(){return J(n.VERBOSE,"OnlineGameWrapperComponent.updatePartWithStatusAndScores"),e.isEndGame?e===Ie.DRAW?yield s.gameService.drawPart(s.currentPartId,s.role,r):(ge.assert(e.winner.isPlayer(),"Non-draw end games should have a winner"),s.notifyVictory(e.winner,r)):s.gameService.updatePart(s.currentPartId,r)})()}notifyTimeoutVictory(e,r){var s=this;return I(function*(){const i=s.role;yield s.gameService.notifyTimeout(s.currentPartId,i,e,r)})()}notifyVictory(e,r){var s=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");const i=ge.getNonNullable(s.currentPart),o=s.players[0].get(),c=s.players[1].get();s.currentPart=e===B.ONE?i.setWinnerAndLoser(c,o):i.setWinnerAndLoser(o,c);const u=s.role;yield s.gameService.endPartWithVictory(s.currentPartId,u,s.currentPart.getWinner().get(),s.currentPart.getLoser().get(),r)})()}resign(){var e=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.resign");const r=e.role,s=e.getPlayer(),i=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,r,i,s)})()}reachedOutOfTime(e){var r=this;return I(function*(){if(J(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),!1===r.isPlaying())return;const s=ge.getNonNullable(r.opponent);e===r.role?yield r.notifyTimeoutVictory(s,r.authUser.toMinimalUser()):yield r.notifyTimeoutVictory(r.authUser.toMinimalUser(),s)})()}propose(e){var r=this;return I(function*(){ge.assert(r.role.isPlayer(),"cannot propose request if not player");const s=r.role;switch(e){case"Rematch":return r.gameService.proposeRematch(r.currentPartId,s);case"Draw":return r.gameService.proposeDraw(r.currentPartId,s);default:return ge.expectToBe(e,"TakeBack"),r.gameService.askTakeBack(r.currentPartId,s)}})()}accept(){var e=this;return I(function*(){ge.assert(e.role.isPlayer(),"cannot accept request if not player");const r=e.role,s=ge.getNonNullable(e.currentPart),i=e.requestManager.getCurrentRequest().get().requestType;switch(i){case"Rematch":return e.gameService.acceptRematch(s,r);case"Draw":return e.gameService.acceptDraw(s.id,r);default:return ge.expectToBe(i,"TakeBack"),e.gameService.acceptTakeBack(s.id,s.data.turn,r)}})()}reject(){var e=this;return I(function*(){ge.assert(e.role.isPlayer(),"cannot reject request if not player");const r=e.role,s=e.requestManager.getCurrentRequest().get().requestType;switch(s){case"Rematch":return e.gameService.rejectRematch(e.currentPartId,r);case"Draw":return e.gameService.refuseDraw(e.currentPartId,r);default:return ge.expectToBe(s,"TakeBack"),e.gameService.refuseTakeBack(e.currentPartId,r)}})()}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===B.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}addGlobalTime(){return this.gameService.addGlobalTime(this.currentPartId,this.role)}addTurnTime(){return this.gameService.addTurnTime(this.currentPartId,this.role)}onCancelMove(e){if(this.gameComponent.node.move.isPresent()){const r=this.gameComponent.node.move.get();this.gameComponent.showLastMove(r)}}ngOnDestroy(){var e=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.currentGameSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&e.connectedUserService.user.isPresent()&&(yield e.currentGameService.removeCurrentGame()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe(),e.gameEventsSubscription.unsubscribe()),J(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")})()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(zo),Q(Is),Q(Xn),Q(_n),Q(D2),Q(Rh),Q(GS),Q(lV),Q(Gft),Q(S4e))},n.\u0275cmp=ct({type:n,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,r){if(1&e&&(I0(dht,5),I0(pht,5),I0(ght,5),I0(mht,5)),2&e){let s;w4(s=O4())&&(r.chronoZeroGlobal=s.first),w4(s=O4())&&(r.chronoOneGlobal=s.first),w4(s=O4())&&(r.chronoZeroTurn=s.first),w4(s=O4())&&(r.chronoOneTurn=s.first)}},features:[l],decls:5,vars:4,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E,O,k,U,j,oe,Ee,ne,ke,Ue,et,Bt,B1,x1;return t=$localize`vs.`,e=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,r=$localize`It is your turn.`,s=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Draw`,u=$localize`You agreed to draw.`,h=$localize`Your draw proposal has been accepted.`,g=$localize`Players agreed to draw.`,m=$localize`You won.`,E=$localize`You lost.`,O=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,k=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,U=$localize`You reached your time limit.`,j=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,oe=$localize`You resigned.`,Ee=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,ne=$localize`Resign`,ke=$localize`Pass a turn`,Ue=$localize`Accept`,et=$localize`Reject`,Bt=$localize`Your ${"\ufffd0\ufffd"}:INTERPOLATION: request has been rejected.${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,B1=$localize`Your request for a ${"\ufffd0\ufffd"}:INTERPOLATION: has been sent.${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,x1=$localize`Go back to the game list`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],t,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],["class","block","id","winnerIndicator",4,"ngIf"],[4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],r,["id","opponentTurn"],s,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],o,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],c,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],u,["id","yourOpponentAgreedToDrawIndicator",1,"title"],h,["id","playersAgreedToDraw",1,"title"],g,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],m,["id","youLostIndicator",1,"title"],E,[1,"title"],O,k,U,j,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],oe,Ee,["replyButtons",""],["id","requestRejected","class","notification is-danger",4,"ngIf"],["id","requestAwaitingReply","class","notification",4,"ngIf"],["id","resign",1,"button","is-fullwidth","mb-1","is-danger",3,"disabled","click"],ne,["id","pass",1,"button","is-fullwidth","mb-1","is-success",3,"disabled","click"],ke,[4,"ngFor","ngForOf"],[1,"button","is-fullwidth","mb-1",3,"id","disabled","click"],[3,"icon"],[1,"notification"],["id","accept",1,"button","is-fullwidth","mb-1","is-success",3,"click"],Ue,["id","reject",1,"button","is-fullwidth","mb-1","is-danger",3,"click"],et,["id","requestRejected",1,"notification","is-danger"],Bt,["id","requestAwaitingReply",1,"notification"],B1,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],x1]},template:function(e,r){1&e&&(x(0,_ht,2,1,"app-part-creation",0),x(1,Kht,28,25,"div",1),b(2,"div",2)(3,"div",3),X(4,"app-chat",4),A()()),2&e&&(w("ngIf",!1===r.gameStarted),T(1),w("ngIf",r.gameStarted),T(3),w("chatId",r.currentPartId)("turn",null==r.currentPart?null:r.currentPart.getTurn()))},dependencies:[hn,En,Kt,Ff,F5,C4e,f1,hht],encapsulation:2}),n})();function Jht(n,t){if(1&n&&(b(0,"option",26),wt(1),A()),2&n){const e=t.$implicit;w("value",e.name),T(1),c1(e.name)}}function e9t(n,t){if(1&n&&(b(0,"option",26),Ce(1,30),A()),2&n){const e=t.$implicit;w("value",e),T(1),S1(e),N1(1)}}const t9t=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function n9t(n,t){if(1&n){const e=Ae();b(0,"select",27),ee("ngModelChange",function(s){return de(e),le(C(2).aiDepths[0]=s)})("change",function(){de(e);const s=C(2);return le(s.updatePlayer(s.Player.ZERO))}),b(1,"option",28),Ce(2,29),A(),x(3,e9t,2,2,"option",17),A()}2&n&&(w("ngModel",C(2).aiDepths[0]),T(3),w("ngForOf",er(2,t9t)))}function r9t(n,t){if(1&n&&(b(0,"p",31),Ce(1,32),A()),2&n){const e=C(2);T(1),S1(e.gameComponent.scores.get()[0]),N1(1)}}function s9t(n,t){if(1&n&&(b(0,"option",26),wt(1),A()),2&n){const e=t.$implicit;w("value",e.name),T(1),c1(e.name)}}function i9t(n,t){if(1&n&&(b(0,"option",26),Ce(1,35),A()),2&n){const e=t.$implicit;w("value",e),T(1),S1(e),N1(1)}}const o9t=function(){return[1,2,3,4,5,6,7,8,9,10]};function a9t(n,t){if(1&n){const e=Ae();b(0,"select",33),ee("ngModelChange",function(s){return de(e),le(C(2).aiDepths[1]=s)})("change",function(){de(e);const s=C(2);return le(s.updatePlayer(s.Player.ONE))}),b(1,"option",28),Ce(2,34),A(),x(3,i9t,2,2,"option",17),A()}2&n&&(w("ngModel",C(2).aiDepths[1]),T(3),w("ngForOf",er(2,o9t)))}function c9t(n,t){if(1&n&&(b(0,"p",36),Ce(1,37),A()),2&n){const e=C(2);T(1),S1(e.gameComponent.scores.get()[1]),N1(1)}}function l9t(n,t){if(1&n&&(b(0,"h4",41),wt(1),A()),2&n){const e=C(3);T(1),c1(e.winnerMessage.get())}}function u9t(n,t){1&n&&(b(0,"h4",42),Ce(1,43),A())}function f9t(n,t){if(1&n&&(b(0,"div",38),x(1,l9t,2,1,"h4",39),x(2,u9t,2,0,"h4",40),A()),2&n){const e=C(2);T(1),w("ngIf",e.winnerMessage.isPresent()),T(1),w("ngIf",e.winnerMessage.isAbsent())}}function h9t(n,t){if(1&n){const e=Ae();b(0,"div",7)(1,"div",8)(2,"p",9),Ce(3,10),A()(),b(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),ee("change",function(){de(e);const s=C();return le(s.updatePlayer(s.Player.ZERO))})("ngModelChange",function(s){return de(e),le(C().playerSelection[0]=s)}),b(8,"option",15),Ce(9,16),A(),x(10,Jht,2,2,"option",17),A()(),b(11,"div",13),x(12,n9t,4,3,"select",18),A(),x(13,r9t,2,1,"p",19),A(),b(14,"div",20)(15,"div",13)(16,"select",21),ee("change",function(){de(e);const s=C();return le(s.updatePlayer(s.Player.ONE))})("ngModelChange",function(s){return de(e),le(C().playerSelection[1]=s)}),b(17,"option",15),Ce(18,22),A(),x(19,s9t,2,2,"option",17),A()(),b(20,"div",13),x(21,a9t,4,3,"select",23),A(),x(22,c9t,2,1,"p",24),A()(),x(23,f9t,3,2,"div",25),A()}if(2&n){const e=C();T(3),S1(e.gameComponent.getTurn()+1),N1(3),T(4),w("ngModel",e.playerSelection[0]),T(3),w("ngForOf",e.gameComponent.availableMinimaxes),T(2),w("ngIf",!1===e.players[0].equalsValue("human")),T(1),w("ngIf",e.gameComponent.scores.isPresent()),T(3),w("ngModel",e.playerSelection[1]),T(3),w("ngForOf",e.gameComponent.availableMinimaxes),T(2),w("ngIf",!1===e.players[1].equalsValue("human")),T(1),w("ngIf",e.gameComponent.scores.isPresent()),T(1),w("ngIf",e.endGame)}}function d9t(n,t){if(1&n){const e=Ae();b(0,"button",50),ee("click",function(){return de(e),le(C(2).gameComponent.pass())}),Ce(1,51),A()}}function p9t(n,t){if(1&n){const e=Ae();b(0,"button",52),ee("click",function(){return de(e),le(C(2).takeBack())}),Ce(1,53),A()}}function g9t(n,t){if(1&n&&(dn(0),wt(1),X(2,"br"),pn()),2&n){const e=t.$implicit,r=C(3);T(1),Bi(" ",e.name+": "+e.getBoardValue(r.gameComponent.node)," ")}}function m9t(n,t){if(1&n&&(b(0,"div",54),x(1,g9t,3,1,"ng-container",55),wt(2),X(3,"br"),wt(4),X(5,"br"),A()),2&n){const e=C(2);T(1),w("ngForOf",e.gameComponent.availableMinimaxes),T(1),Bi(" Created ",e.getCreatedNodes()," nodes."),T(2),Bi(" Minimax time: ",e.getMinimaxTime(),"ms.")}}function _9t(n,t){if(1&n){const e=Ae();b(0,"div",44),x(1,d9t,2,0,"button",45),x(2,p9t,2,0,"button",46),b(3,"button",47),ee("click",function(){return de(e),le(C().restartGame())}),Ce(4,48),A(),x(5,m9t,6,3,"div",49),A()}if(2&n){const e=C();T(1),w("ngIf",!1===e.endGame&&e.gameComponent.canPass),T(1),w("ngIf",e.canTakeBack()),T(3),w("ngIf",e.gameComponent.node.move.isPresent()&&e.displayAIMetrics)}}let v9t=(()=>{class n extends dT{constructor(e,r,s,i,o){super(e,r,s,i),this.cdr=o,this.aiDepths=["0","0"],this.playerSelection=["human","human"],this.winnerMessage=y.empty(),this.botTimeOut=1e3,this.displayAIMetrics=!1,this.players=[y.of(this.playerSelection[0]),y.of(this.playerSelection[1])],this.role=B.ZERO,J(n.VERBOSE,"LocalGameWrapper.constructor")}getCreatedNodes(){return AP.createdNodes}getMinimaxTime(){return AP.minimaxTime}ngAfterViewInit(){var e=this;setTimeout(I(function*(){(yield e.afterViewInit())&&(e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){this.players[e.value]=y.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?B.ONE:B.ZERO),this.proposeAIToPlay()}onLegalUserMove(e){var r=this;return I(function*(){J(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),r.gameComponent.node=r.gameComponent.rules.choose(r.gameComponent.node,e).get(),r.updateBoard(),r.proposeAIToPlay()})()}updateBoard(){this.updateBoardAndShowLastMove();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.node);if(!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer())){const r=$localize`Player ${e.winner.value+1}`,i=e.winner.getOpponent().value;this.winnerMessage=this.players[e.winner.value].equalsValue("human")?this.players[i].equalsValue("human")?y.of($localize`${r} won`):y.of($localize`You won`):this.players[i].equalsValue("human")?y.of($localize`You lost`):y.of($localize`${this.players[e.winner.value].get()} (Player ${e.winner.value+1}) won`)}}proposeAIToPlay(){var e=this;const r=this.getPlayingAI();r.isPresent()&&window.setTimeout(I(function*(){yield e.doAIMove(r.get())}),this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.node).isEndGame)return y.empty();const e=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[e]?y.empty():y.ofNullable(this.gameComponent.availableMinimaxes.find(r=>this.players[e].equalsValue(r.name)))}doAIMove(e){var r=this;return I(function*(){const s=r.gameComponent.rules;We(s.getGameStatus(r.gameComponent.node)===Ie.ONGOING,"AI should not try to play when game is over!");const c=Number.parseInt(r.aiDepths[r.gameComponent.node.gameState.turn%2%2]),u=r.gameComponent.node.findBestMove(c,e,!0),h=s.choose(r.gameComponent.node,u);return h.isPresent()?(r.gameComponent.node=h.get(),r.updateBoard(),r.cdr.detectChanges(),r.proposeAIToPlay(),R.SUCCESS):(r.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),Ns.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:u.toString()}))})()}canTakeBack(){return this.gameComponent.getTurn()>0}takeBack(){this.gameComponent.node=this.gameComponent.node.mother.get(),this.isAITurn()&&(this.gameComponent.node=this.gameComponent.node.mother.get()),this.updateBoardAndShowLastMove()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){this.gameComponent.node=this.gameComponent.rules.getInitialNode(),this.gameComponent.updateBoard(),this.endGame=!1,this.winnerMessage=y.empty(),this.proposeAIToPlay()}getPlayer(){return"human"}onCancelMove(e){if(this.gameComponent.node.move.isPresent()){const r=this.gameComponent.node.move.get();this.gameComponent.showLastMove(r)}}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(zo),Q(Is),Q(Xn),Q(_n),Q(Ru))},n.\u0275cmp=ct({type:n,selectors:[["app-local-game-wrapper"]],features:[l],decls:8,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E,O;return t=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,r=$localize`Human`,s=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Pick the level`,u=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,g=$localize`Draw`,m=$localize`Start a new game`,E=$localize`Pass a turn`,O=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],r,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],s,i,["id","scoreOne",1,"block"],o,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],c,u,["id","scoreZero",1,"block"],h,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],g,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],m,["id","AIMetrics",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],E,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],O,["id","AIMetrics"],[4,"ngFor","ngForOf"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1),x(2,h9t,24,10,"div",2),x(3,_9t,6,3,"div",3),A(),b(4,"div",4)(5,"div",5),X(6,"div",null,6),A()()()),2&e&&(T(2),w("ngIf",r.gameComponent),T(1),w("ngIf",r.gameComponent),T(1),w("ngClass",r.getBoardHighlight()))},dependencies:[hn,En,Kt,Up,Gp,nE,Gl,$p],encapsulation:2,changeDetection:0}),n})(),w4e=(()=>{class n{}return n.STEP_FINISHED=()=>$localize`Step finished!`,n.INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`,n})();function C9t(n,t){if(1&n&&(b(0,"div",21)(1,"div",22),Ce(2,23),A(),X(3,"div",24),A()),2&n){const e=C();T(3),w("innerHTML",e.currentReason.get(),gu)}}function y9t(n,t){if(1&n){const e=Ae();b(0,"button",25),ee("click",function(){return de(e),le(C().retry())}),Ce(1,26),A()}}function E9t(n,t){1&n&&(dn(0),Ce(1,31),pn())}function M9t(n,t){1&n&&(dn(0),Ce(1,32),pn())}function S9t(n,t){if(1&n&&x(0,M9t,2,0,"ng-container",28),2&n){C();const e=Hn(5),r=C();w("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",e)}}function P9t(n,t){1&n&&(dn(0),Ce(1,33),pn())}function T9t(n,t){if(1&n){const e=Ae();b(0,"button",27),ee("click",function(){return de(e),le(C().next())}),x(1,E9t,2,0,"ng-container",28),x(2,S9t,1,2,"ng-template",null,29,qn),x(4,P9t,2,0,"ng-template",null,30,qn),A()}if(2&n){const e=Hn(3),r=C();T(1),w("ngIf",r.steps[r.stepIndex]&&r.steps[r.stepIndex].isInformation())("ngIfElse",e)}}function w9t(n,t){if(1&n){const e=Ae();b(0,"button",34),ee("click",function(){return de(e),le(C().start())}),Ce(1,35),A()}}function O9t(n,t){if(1&n){const e=Ae();b(0,"button",36),ee("click",function(){return de(e),le(C().playLocally())}),Ce(1,37),A()}}function b9t(n,t){if(1&n){const e=Ae();b(0,"button",38),ee("click",function(){return de(e),le(C().createGame())}),Ce(1,39),A()}}function A9t(n,t){if(1&n){const e=Ae();b(0,"button",40),ee("click",function(){return de(e),le(C().showSolution())}),Ce(1,41),A()}}function N9t(n,t){if(1&n&&(dn(0),b(1,"option",43),wt(2),A(),pn()),2&n){const e=C(),r=e.index,s=e.$implicit;T(1),p1("id","step_",r,""),w("value",r),T(1),c1(s.title)}}function I9t(n,t){1&n&&(dn(0),wt(1,"v "),pn())}function x9t(n,t){1&n&&wt(0,"x ")}function k9t(n,t){if(1&n&&(b(0,"option",44),x(1,I9t,2,0,"ng-container",28),x(2,x9t,1,0,"ng-template",null,45,qn),b(4,"span",46),wt(5),A()()),2&n){const e=Hn(3),r=C(),s=r.index,i=r.$implicit,o=C();w("value",s),T(1),w("ngIf",o.stepFinished[s])("ngIfElse",e),T(3),p1("id","step_",s,""),T(1),c1(i.title)}}function L9t(n,t){if(1&n&&(dn(0),x(1,N9t,3,3,"ng-container",28),x(2,k9t,6,5,"ng-template",null,42,qn),pn()),2&n){const e=t.index,r=Hn(3),s=C();T(1),w("ngIf",e===s.stepIndex)("ngIfElse",r)}}let R9t=(()=>{class n extends dT{constructor(e,r,s,i,o){super(e,o,r,s),this.cdr=i,this.COMPLETED_TUTORIAL_MESSAGE=$localize`Congratulations, you completed the tutorial.`,this.steps=[],this.successfulSteps=0,this.stepIndex=-1,this.currentMessage="",this.currentReason=y.empty(),this.moveAttemptMade=!1,this.stepFinished=[],this.tutorialOver=!1,J(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),this.role=B.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return I(function*(){J(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),(yield e.afterViewInit())&&e.start()})()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(e){J(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(e){J(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;const r=this.steps[this.stepIndex];this.currentMessage=r.instruction,this.currentReason=y.empty(),this.gameComponent.node=new mr(r.state,y.empty(),r.previousMove),this.setRole(this.gameComponent.getCurrentPlayer()),this.cdr.detectChanges()}onLegalUserMove(e){var r=this;return I(function*(){J(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}});const s=r.steps[r.stepIndex],i=r.gameComponent.rules.choose(r.gameComponent.node,e);if(We(i.isPresent(),"It should be impossible to call onLegalUserMove with an illegal move"),r.gameComponent.node=i.get(),J(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),r.updateBoardAndShowLastMove(),r.moveAttemptMade=!0,s.isPredicate()){const o=r.gameComponent.getPreviousState(),c=r.gameComponent.getState(),u=ge.getNonNullable(s.predicate)(e,o,c);u.isSuccess()?r.showStepSuccess(s.getSuccessMessage()):r.currentReason=y.of(u.getReason())}else if(s.isAnyMove())J(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(s.getSuccessMessage());else{We(s.isMove(),"cannot reach here with a click step");const o=s;o.acceptedMoves.some(c=>c.equals(e))?(J(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(o.getSuccessMessage())):(J(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),r.currentReason=y.of(o.getFailureMessage()))}r.cdr.detectChanges()})()}retry(){J(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}canUserPlay(e){if(J(n.VERBOSE,"tutorialGameWrapper.canUserPlay("+e+")"),this.currentReason=y.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return R.failure(w4e.STEP_FINISHED());const r=this.steps[this.stepIndex];return r.isClick()?(this.updateBoardAndShowLastMove(),this.moveAttemptMade=!0,ge.getNonNullable(r.acceptedClicks).some(s=>s===e)?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),R.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(()=>{this.cdr.detectChanges()},10),R.SUCCESS):R.failure(w4e.INFORMATIONAL_STEP())}onCancelMove(e){J(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=y.of(e)),this.cdr.detectChanges()}showStepSuccess(e){J(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const r of this.stepFinished)r&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var e=this;return I(function*(){J(n.VERBOSE,"tutorialGameWrapper.showSolution()");const r=e.steps[e.stepIndex];We(r.hasSolution(),"step must have solution");const s=r,i=s.getSolution();i instanceof oo?(e.showStep(e.stepIndex),e.gameComponent.node=e.gameComponent.rules.choose(e.gameComponent.node,i).get(),e.updateBoardAndShowLastMove()):(e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=s.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return I(function*(){const r=ge.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",r])})()}createGame(){var e=this;return I(function*(){const r=ge.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",r])})()}getPlayer(){return"tutorial-player"}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(zo),Q(Xn),Q(_n),Q(Ru),Q(Is))},n.\u0275cmp=ct({type:n,selectors:[["app-tutorial-game-wrapper"]],features:[l],decls:23,vars:15,consts:function(){let t,e,r,s,i,o,c,u,h;return t=$localize`Failure`,e=$localize`Try again`,r=$localize`Ok`,s=$localize`Continue`,i=$localize`Skip`,o=$localize`Try again`,c=$localize`Play locally`,u=$localize`Create an online game`,h=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],t,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],r,s,i,["id","restartButton",1,"button",3,"click"],o,["id","playLocallyButton",1,"button",3,"click"],c,["id","playOnlineButton",1,"button",3,"click"],u,["id","showSolutionButton",1,"button",3,"click"],h,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1)(2,"div",2),X(3,"progress",3),b(4,"div",4)(5,"p",5),wt(6),A(),X(7,"p",6),A(),x(8,C9t,4,1,"div",7),b(9,"div",8),x(10,y9t,2,0,"button",9),x(11,T9t,6,2,"button",10),x(12,w9t,2,0,"button",11),x(13,O9t,2,0,"button",12),x(14,b9t,2,0,"button",13),x(15,A9t,2,0,"button",14),b(16,"div",15)(17,"select",16),ee("change",function(i){return r.changeStep(i)}),x(18,L9t,4,2,"ng-container",17),A()()()()(),b(19,"div",18)(20,"div",19),X(21,"div",null,20),A()()()),2&e&&(T(3),z("value",r.successfulSteps)("max",r.getNumberOfSteps()),T(3),db("",r.getCurrentStepTitle()," [",r.stepIndex+1,"/",r.getNumberOfSteps(),"]"),T(1),w("innerHTML",r.currentMessage,gu),T(1),w("ngIf",r.currentReason.isPresent()),T(2),w("ngIf",!1===r.tutorialOver&&(r.stepFinished&&!0===r.stepFinished[r.stepIndex]||r.moveAttemptMade)),T(1),w("ngIf",!1===r.tutorialOver),T(1),w("ngIf",r.tutorialOver),T(1),w("ngIf",r.tutorialOver),T(1),w("ngIf",r.tutorialOver),T(1),w("ngIf",r.moveAttemptMade&&!1===r.stepFinished[r.stepIndex]),T(3),w("ngForOf",r.steps),T(1),w("ngClass",r.getBoardHighlight()))},dependencies:[hn,En,Kt,Up,Gp],encapsulation:2,changeDetection:0}),n})();function D9t(n,t){if(1&n&&(b(0,"div",35)(1,"div",36),Ce(2,37),A(),b(3,"div",38),wt(4),A()()),2&n){const e=C();T(4),c1(e.errorMessage)}}const z9t=function(){return["/login"]};let V9t=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.faEye=sH,this.registrationForm=new z0({email:new Ya,username:new Ya,password:new Ya})}registerWithEmail(){var e=this;return I(function*(){const r=e.registrationForm.value.username,s=e.registrationForm.value.email,i=e.registrationForm.value.password;if(null==r||null==s||null==i)e.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const o=yield e.connectedUserService.doRegister(r,s,i);if(o.isSuccess()){const c=yield e.connectedUserService.sendEmailVerification();c.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=c.getReason()}else e.errorMessage=o.getReason()}})()}registerWithGoogle(){var e=this;return I(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=r.getReason()})()}getPasswordHelpClass(){const e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}canRegister(){const e=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===e||e.length<6)}}return n.\u0275fac=function(e){return new(e||n)(Q(Is),Q(Xn))},n.\u0275cmp=ct({type:n,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E,O,k;return t=$localize`Registering`,e=$localize`Email`,r=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,i=$localize`Username`,o=$localize`Username`,c=$localize`Password`,u=$localize`Password`,h=$localize`The password should be at least 6 characters long`,g=$localize`Register`,m=$localize`Register with Google`,E=$localize`Have an account?`,O=$localize`Log in`,k=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",r,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],i,["id","username","formControlName","username","name","username","placeholder",o,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",u,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],h,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],g,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],E,[3,"routerLink"],O,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],k,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),Ce(2,2),A(),b(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),Ce(7,7),A()(),b(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),b(12,"p",12),Ce(13,13),A()()()()(),b(14,"div",4)(15,"div",5)(16,"label",14),Ce(17,15),A()(),b(18,"div",8)(19,"div",9)(20,"div",10),X(21,"input",16),A()()()(),b(22,"div",4)(23,"div",5)(24,"label",17),Ce(25,18),A()(),b(26,"div",8)(27,"div",9)(28,"div",19),X(29,"input",20),b(30,"span",21),X(31,"fa-icon",22),A(),b(32,"p",23),Ce(33,24),A()()()()(),b(34,"div",4),X(35,"div",5),b(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),ee("click",function(){return r.registerWithEmail()}),Ce(40,26),A()()()()(),b(41,"div",4),X(42,"div",5),b(43,"div",27),x(44,D9t,5,1,"div",28),A()(),b(45,"div",4),X(46,"div",5),b(47,"div",8)(48,"button",29),ee("click",function(){return r.registerWithGoogle()}),Ce(49,30),A()()(),b(50,"p",31),dn(51),Ce(52,32),pn(),wt(53,"\xa0 "),b(54,"a",33),Ce(55,34),A()()()()),2&e&&(T(3),w("formGroup",r.registrationForm),T(28),w("icon",r.faEye),T(1),w("ngClass",r.getPasswordHelpClass()),T(7),w("disabled",!r.canRegister()),T(5),w("ngIf",r.errorMessage),T(10),w("routerLink",er(6,z9t)))},dependencies:[hn,Kt,ju,Fu,I4,Gl,Hu,Uu,Bu,kf,F5,fF,v4e],encapsulation:2}),n})(),H9t=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}playLocally(){var e=this;return I(function*(){yield e.router.navigate(["local/"+e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Xn))},n.\u0275cmp=ct({type:n,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),A(),b(1,"button",1),ee("click",function(){return r.playLocally()}),Ce(2,2),A()),2&e&&(T(1),w("disabled",!r.selectedGame))},dependencies:[uF],encapsulation:2}),n})(),F9t=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}launchTutorial(){var e=this;return I(function*(){yield e.router.navigate(["/tutorial/",e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Xn))},n.\u0275cmp=ct({type:n,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),A(),b(1,"button",1),ee("click",function(){return r.launchTutorial()}),Ce(2,2),A()),2&e&&(T(1),w("disabled",!r.selectedGame))},dependencies:[uF],encapsulation:2}),n})(),B9t=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ct({type:n,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(b(0,"p"),Ce(1,0),A())},encapsulation:2}),n})();function U9t(n,t){if(1&n&&(H(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessQueenComponent.HEPTAGON)}}function G9t(n,t){if(1&n&&(H(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function q9t(n,t){if(1&n&&(H(),X(0,"circle",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function W9t(n,t){if(1&n&&(dn(0),H(),X(1,"circle",6)(2,"circle",6)(3,"circle",6),pn()),2&n){const e=C();T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(3)),T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function j9t(n,t){if(1&n&&(H(),b(0,"g"),X(1,"circle",7)(2,"circle",7)(3,"circle",7),A()),2&n){const e=C();T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.45*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),T(1),z("cx",.45*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),T(1),z("cx",.55*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function Z9t(n,t){if(1&n&&(H(),b(0,"g",8),X(1,"circle",9)(2,"circle",9)(3,"circle",9),A()),2&n){const e=C();w("ngClass",e.pieceClasses),T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE-3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE+3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class x6{constructor(){this.MartianChessQueenComponent=x6,this.MartianChessComponent=Xo,this.horizontalDotsRadius=Xo.SPACE_SIZE/15}}function K9t(n,t){if(1&n&&(H(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessDroneComponent.PENTAGON)}}function X9t(n,t){if(1&n&&(H(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function Q9t(n,t){if(1&n&&(H(),X(0,"circle",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function J9t(n,t){if(1&n&&(dn(0),H(),X(1,"circle",6)(2,"circle",6),pn()),2&n){const e=C();T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function edt(n,t){if(1&n&&(H(),b(0,"g",7),X(1,"circle",8)(2,"circle",8),A()),2&n){const e=C();w("ngClass",e.pieceClasses),T(1),z("cx",.4*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),T(1),z("cx",.6*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function tdt(n,t){if(1&n&&(H(),b(0,"g",7),X(1,"circle",9)(2,"circle",9),A()),2&n){const e=C();w("ngClass",e.pieceClasses),T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE-2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE+2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}x6.HEPTAGON=Xo.getRegularPolygon(7),x6.EIGHT_POINTED_STAR=Xo.getNPointedStar(8,0),x6.\u0275fac=function(t){return new(t||x6)},x6.\u0275cmp=ct({type:x6,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,U9t,1,3,"polygon",0),x(1,G9t,1,3,"polygon",0),x(2,q9t,1,5,"circle",1),x(3,W9t,4,9,"ng-container",2),x(4,j9t,4,9,"g",2),x(5,Z9t,4,10,"g",3)),2&t&&(w("ngIf","Polygon"===e.style.shape),T(1),w("ngIf","Star"===e.style.shape),T(1),w("ngIf","Circle"===e.style.shape),T(1),w("ngIf","Concentric Circles"===e.style.points),T(1),w("ngIf","Dots"===e.style.points),T(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[hn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class k6{constructor(){this.MartianChessComponent=Xo,this.MartianChessDroneComponent=k6,this.horizontalDotsRadius=Xo.SPACE_SIZE/15}}function rdt(n,t){if(1&n&&(H(),X(0,"polygon",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessPawnComponent.TRIANGLE)}}function sdt(n,t){if(1&n&&(H(),X(0,"polygon",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function idt(n,t){if(1&n&&(H(),X(0,"circle",6)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function odt(n,t){if(1&n&&(H(),X(0,"circle",7)),2&n){const e=C();z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE+e.getConcreteTriangleYOffset())("r",e.MartianChessComponent.getRadius(1))}}function adt(n,t){if(1&n&&(H(),X(0,"circle",8)),2&n){const e=C();z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function cdt(n,t){if(1&n&&(H(),b(0,"g",9),X(1,"circle",10),A()),2&n){const e=C();w("ngClass",e.pieceClasses),T(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}k6.FOUR_POINTED_STAR_VERTICAL=Xo.getNPointedStar(4,0),k6.PENTAGON=Xo.getRegularPolygon(5),k6.\u0275fac=function(t){return new(t||k6)},k6.\u0275cmp=ct({type:k6,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,K9t,1,3,"polygon",0),x(1,X9t,1,3,"polygon",0),x(2,Q9t,1,5,"circle",1),x(3,J9t,3,6,"ng-container",2),x(4,edt,3,7,"g",3),x(5,tdt,3,7,"g",3)),2&t&&(w("ngIf","Polygon"===e.style.shape),T(1),w("ngIf","Star"===e.style.shape),T(1),w("ngIf","Circle"===e.style.shape),T(1),w("ngIf","Concentric Circles"===e.style.points),T(1),w("ngIf","Dots"===e.style.points),T(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[hn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class xa{constructor(){this.MartianChessComponent=Xo,this.MartianChessPawnComponent=xa,this.horizontalDotsRadius=Xo.SPACE_SIZE/15}static getTriangle(){return Xo.getRegularPolygon(3,xa.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const e=Xo.getRegularPolygonCoords(3).map(u=>u.y);return(e.reduce((u,h)=>Math.min(u,h))+(100-e.reduce((u,h)=>Math.max(u,h))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?xa.TRIANGLE_Y_OFFSET:0}}function udt(n,t){if(1&n&&(H(),X(0,"text",8)),2&n){const e=C();J2("id","height_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),w("innerHTML",e.coord.z,gu)}}function fdt(n,t){if(1&n&&(H(),X(0,"polyline",9)),2&n){const e=C();w("ngClass",e.pieceClasses),z("points",e.getUpperHorizontalLine())}}function hdt(n,t){if(1&n&&(H(),b(0,"g"),X(1,"polyline",10)(2,"polyline",11),A()),2&n){const e=C();T(1),w("ngClass",e.pieceClasses),z("points",e.getMiddleHorizontalLine()),T(1),w("ngClass",e.pieceClasses),z("points",e.getLowerHorizontalLine())}}function ddt(n,t){if(1&n&&(H(),X(0,"polyline",12)),2&n){const e=C();w("ngClass",e.pieceClasses),z("points",e.getLeftDiagonalLine())}}function pdt(n,t){if(1&n&&(H(),b(0,"g"),X(1,"polyline",13)(2,"polyline",14),A()),2&n){const e=C();T(1),w("ngClass",e.pieceClasses),z("points",e.getMiddleDiagonalLine()),T(1),w("ngClass",e.pieceClasses),z("points",e.getRighterDiagonalLine())}}function gdt(n,t){if(1&n&&(H(),X(0,"polyline",15)),2&n){const e=C();w("ngClass",e.pieceClasses),z("points",e.getLeftVerticalLine())}}function mdt(n,t){if(1&n&&(H(),X(0,"polyline",16)),2&n){const e=C();w("ngClass",e.pieceClasses),z("points",e.getMiddleVerticalLine())}}function _dt(n,t){if(1&n&&(H(),X(0,"polyline",17)),2&n){const e=C();w("ngClass",e.pieceClasses),z("points",e.getRighterVerticalLine())}}xa.FOUR_POINTED_STAR_DIAGONAL=Xo.getNPointedStar(4,45),xa.TRIANGLE_Y_OFFSET=xa.yOffsetForVerticalCentering(),xa.TRIANGLE=xa.getTriangle(),xa.\u0275fac=function(t){return new(t||xa)},xa.\u0275cmp=ct({type:xa,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,rdt,1,3,"polygon",0),x(1,sdt,1,3,"polygon",0),x(2,idt,1,5,"circle",1),x(3,odt,1,3,"circle",2),x(4,adt,1,3,"circle",3),x(5,cdt,2,4,"g",4)),2&t&&(w("ngIf","Polygon"===e.style.shape),T(1),w("ngIf","Star"===e.style.shape),T(1),w("ngIf","Circle"===e.style.shape),T(1),w("ngIf","Concentric Circles"===e.style.points),T(1),w("ngIf","Dots"===e.style.points),T(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[hn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class a9{mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(t=>"victory-stroke"===t)||this.pieceClasses.some(t=>"last-move-stroke"===t)}get3DIsoSquarePoints(){const t=this.getParallelogramPoints();return this.mapCoordToPoints([t[0],t[1],t[4],t[6],t[5],t[2],t[0]])}getParallelogramPoints(){const t=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,e=this.mode.parallelogramHeight,r=this.mode.offsetRatio*this.mode.parallelogramHeight,s=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,i=t,c=t-r,u=e,h=-r,g=e;return[new S(0,0),new S(i,0),new S(h,g),new S(c,u),new S(i,0+s),new S(h,g+s),new S(c,u+s)]}mapCoordToPoints(t){return t.map(e=>e.x+" "+e.y).join(" ")}getUpperHorizontalLineCoords(){const t=this.getParallelogramPoints(),e=t[0],r=t[1],i=new $t(-1*this.mode.offsetRatio*u1.STROKE_WIDTH,u1.STROKE_WIDTH),o=e.getNext(i),c=r.getNext(i);return[e,r,c,o]}getUpperHorizontalLine(){const t=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(t)}getMiddleHorizontalCoords(){const t=this.getParallelogramPoints(),e=t[2],r=t[3],i=new $t(-1*this.mode.offsetRatio*u1.STROKE_WIDTH,u1.STROKE_WIDTH);return[e.getNext(i,-1),r.getNext(i,-1),r,e]}getMiddleHorizontalLine(){const t=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(t)}getLowerHorizontalLine(){const t=this.getParallelogramPoints(),e=t[5],r=t[6],s=new $t(0,u1.STROKE_WIDTH),i=e.getNext(s,-1),o=r.getNext(s,-1);return this.mapCoordToPoints([i,o,r,e])}getLeftDiagonalLine(){const t=this.getParallelogramPoints(),e=t[0],r=t[2],i=new $t(u1.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleDiagonalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[3],i=new $t(u1.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterDiagonalLine(){const t=this.getParallelogramPoints(),e=t[4],r=t[6],i=new $t(0,u1.STROKE_WIDTH),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getLeftVerticalLine(){const t=this.getParallelogramPoints(),e=t[2],r=t[5],i=new $t(u1.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleVerticalLine(){const t=this.getParallelogramPoints(),e=t[3],r=t[6],i=new $t(u1.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterVerticalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[4],o=new $t(u1.STROKE_WIDTH,-u1.STROKE_WIDTH/this.mode.offsetRatio),c=e.getNext(o,-1),u=r.getNext(o,-1);return this.mapCoordToPoints([c,e,r,u])}getOtherCoord(){We(null!=this.move,"Move should be set before calling getOtherCoord");const t=this.move;return t.getZero().equals(this.coord)?t.getOne():t.getZero()}isLeftHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x-1}}isRightHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x+1}}isTopHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y-1}}isBottomHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y+1}}}a9.STROKE_OFFSET=u1.STROKE_WIDTH/2,a9.\u0275fac=function(t){return new(t||a9)},a9.\u0275cmp=ct({type:a9,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(t,e){1&t&&(H(),X(0,"polyline",0),x(1,udt,1,4,"text",1),x(2,fdt,1,2,"polyline",2),x(3,hdt,3,4,"g",3),x(4,ddt,1,2,"polyline",4),x(5,pdt,3,4,"g",3),x(6,gdt,1,2,"polyline",5),x(7,mdt,1,2,"polyline",6),x(8,_dt,1,2,"polyline",7)),2&t&&(J2("id","tile_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),w("ngClass",e.pieceClasses),z("points",e.get3DIsoSquarePoints()),T(1),w("ngIf",e.mustDisplayHeight),T(1),w("ngIf",!1===e.isBottomHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",!1===e.isTopHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",!1===e.isRightHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",!1===e.isLeftHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",e.isBottomHalf()||e.isLeftHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",e.isBottomHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",e.isTopHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()))},dependencies:[hn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});const y__firebaseConfig={apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631",appId:"1:936588361631:web:2c059886d8d427edbac7aa"};let hF=(()=>{class n{constructor(e){this.connectedUserService=e}canActivate(){var e=this;return I(function*(){const r=yield new Promise(s=>{e.userSubscription=e.connectedUserService.subscribeToUser(function(){var i=I(function*(o){return s(yield e.evaluateUserPermission(o))});return function(o){return i.apply(this,arguments)}}())});return e.userSubscription.unsubscribe(),r})()}}return n.\u0275fac=function(e){return new(e||n)(ze(Is))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),c9=(()=>{class n extends hF{constructor(e,r){super(e),this.router=r}static evaluateUserPermission(e,r){return I(function*(){return!1===r.isConnected()?e.parseUrl("/login"):!1!==r.verified||e.parseUrl("/verify-account")})()}evaluateUserPermission(e){var r=this;return I(function*(){return n.evaluateUserPermission(r.router,e)})()}}return n.\u0275fac=function(e){return new(e||n)(ze(Is),ze(Xn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),dF=(()=>{class n{constructor(e,r){this.currentGameService=e,this.router=r,this.currentGameSubscription=y.empty()}canActivate(e){var r=this;return I(function*(){const s=yield r.currentGameService.getCurrentGame();if(s.isAbsent())return!0;const i=s.get();return e.params.id===i.id||r.router.parseUrl("/play/"+i.typeGame+"/"+i.id)})()}}return n.\u0275fac=function(e){return new(e||n)(ze(D2),ze(Xn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),vdt=(()=>{class n extends hF{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return I(function*(){return!1===e.isConnected()?r.router.parseUrl("/login"):!e.verified||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(ze(Is),ze(Xn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Cdt=(()=>{class n extends hF{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return I(function*(){return!1===e.isConnected()||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(ze(Is),ze(Xn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function ydt(n,t){1&n&&(b(0,"p",20),Ce(1,21),A())}function Edt(n,t){if(1&n){const e=Ae();b(0,"div",7)(1,"p",8),Ce(2,9),A(),b(3,"div",10)(4,"p",11),Ce(5,12),A(),b(6,"button",13),ee("click",function(){return de(e),le(C().finalizeEmailVerification())}),Ce(7,14),A()(),b(8,"div",15)(9,"p",11),Ce(10,16),A(),b(11,"button",17),ee("click",function(){return de(e),le(C().sendEmailVerification())}),Ce(12,18),A()(),x(13,ydt,2,0,"p",19),A()}if(2&n){const e=C();T(2),S1(e.emailAddress),N1(2),T(11),w("ngIf",e.success)}}function Mdt(n,t){if(1&n){const e=Ae();b(0,"div",24)(1,"div",8),Ce(2,25),A(),b(3,"form",26)(4,"div",27)(5,"div",28),X(6,"input",29),A(),b(7,"div",28)(8,"button",30),ee("click",function(){de(e);const s=C(2);return le(s.pickUsername(s.usernameForm.value))}),Ce(9,31),A()()()()()}if(2&n){const e=C(2);T(3),w("formGroup",e.usernameForm)}}const Sdt=function(){return["/lobby"]};function Pdt(n,t){1&n&&(b(0,"div",32),ga(1,33),X(2,"a",34),ma(),A()),2&n&&(T(2),w("routerLink",er(1,Sdt)))}function Tdt(n,t){if(1&n&&(dn(0),x(1,Mdt,10,1,"div",22),x(2,Pdt,3,2,"div",23),pn()),2&n){const e=C();T(1),w("ngIf",!e.success),T(1),w("ngIf",e.success)}}function wdt(n,t){if(1&n&&(b(0,"div",35)(1,"div",36),wt(2),A()()),2&n){const e=C();T(2),c1(e.errorMessage)}}let Odt=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new z0({username:new Ya})}ngOnInit(){var e=this;return I(function*(){e.userSubscription=e.connectedUserService.subscribeToUser(function(){var r=I(function*(s){e.emailAddress=s.email.get(),s.username.isAbsent()?e.verificationType="enter-username":(e.verificationType="send-email",!0===e.triedToFinalize&&!1===s.verified&&(e.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield e.router.navigate(["/lobby"])))});return function(s){return r.apply(this,arguments)}}())})()}pickUsername(e){var r=this;return I(function*(){const s=yield r.connectedUserService.setUsername(e.username);s.isSuccess()?r.success=!0:r.errorMessage=s.getReason()})()}sendEmailVerification(){var e=this;return I(function*(){const r=yield e.connectedUserService.sendEmailVerification();r.isSuccess()?e.success=!0:e.errorMessage=r.getReason()})()}finalizeEmailVerification(){var e=this;return I(function*(){e.triedToFinalize=!0,yield e.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(Is),Q(Xn))},n.\u0275cmp=ct({type:n,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,g,m;return t=$localize`Account verification`,e=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,r=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,i=$localize`If you have not received the verification email, click on the following button:`,o=$localize`Send verification email again`,c=$localize`The email has been sent`,u=$localize`In order to finalize your account, you must choose a username.`,h=$localize`Username`,g=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],e,[1,"block","level-left"],[1,"level-item"],r,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],i,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],o,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],u,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",h,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],g,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1)(2,"div",2),Ce(3,3),A(),x(4,Edt,14,2,"div",4),x(5,Tdt,3,2,"ng-container",5),A(),x(6,wdt,3,1,"div",6),A()),2&e&&(T(4),w("ngIf","send-email"===r.verificationType),T(1),w("ngIf","enter-username"===r.verificationType),T(1),w("ngIf",r.errorMessage))},dependencies:[Kt,ju,Fu,I4,Gl,Hu,Uu,Bu,kf],encapsulation:2}),n})();function bdt(n,t){1&n&&(b(0,"p",17),Ce(1,18),A())}function Adt(n,t){if(1&n&&(b(0,"div",19)(1,"div",20),Ce(2,21),A(),b(3,"div",22),wt(4),A()()),2&n){const e=C();T(4),c1(e.errorMessage.get())}}const Ndt=function(){return{standalone:!0}};let Idt=(()=>{class n{constructor(e){this.connectedUserService=e,this.success=!1,this.errorMessage=y.empty(),this.email=""}resetPassword(){var e=this;return I(function*(){We(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=y.empty(),e.success=!1;const r=yield e.connectedUserService.sendPasswordResetEmail(e.email);r.isSuccess()?e.success=!0:e.errorMessage=y.of(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Is))},n.\u0275cmp=ct({type:n,selectors:[["app-reset-password"]],decls:17,vars:6,consts:function(){let t,e,r,s,i,o,c;return t=$localize`Password reset`,e=$localize`Email`,r=$localize`Email`,s=$localize`An email will be sent with instruction to reset your password.`,i=$localize`Reset password`,o=$localize`The email has been sent, please follow the instructions from that email.`,c=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","name","email","placeholder",r,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],s,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],i,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],o,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],c,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),Ce(2,2),A(),b(3,"div",3)(4,"div",4)(5,"label",5),Ce(6,6),A()(),b(7,"div",7)(8,"div",8)(9,"div",9)(10,"input",10),ee("ngModelChange",function(i){return r.email=i}),A(),b(11,"p",11),Ce(12,12),A(),x(13,bdt,2,0,"p",13),A()()()(),b(14,"button",14),ee("click",function(){return r.resetPassword()}),Ce(15,15),A(),x(16,Adt,5,1,"div",16),A()),2&e&&(T(10),w("ngModel",r.email)("ngModelOptions",er(5,Ndt)),T(3),w("ngIf",r.success),T(1),w("disabled",""===r.email),T(2),w("ngIf",r.errorMessage.isPresent()))},dependencies:[Kt,I4,Gl,Uu,$p,fF],encapsulation:2}),n})();function xdt(n,t){if(1&n&&(b(0,"option",13),wt(1),A()),2&n){const e=t.$implicit,r=C();w("value",e.value)("selected",e.value===r.currentTheme),T(1),Bi(" ",e.name," ")}}function kdt(n,t){if(1&n&&(b(0,"option",13),wt(1),A()),2&n){const e=t.$implicit,r=C();w("value",e.value)("selected",e.value===r.currentLanguage),T(1),Bi(" ",e.name," ")}}let Ldt=(()=>{class n{constructor(e,r){this.userSettingsService=e,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}],this.currentTheme=r.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}changeTheme(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return n.\u0275fac=function(e){return new(e||n)(Q(Pne),Q(qS))},n.\u0275cmp=ct({type:n,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,e,r;return t=$localize`User settings`,e=$localize`Theme`,r=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],e,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],r,["id","language",3,"change"],[3,"value","selected"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),Ce(2,2),A(),b(3,"div",3)(4,"label",4),Ce(5,5),A(),b(6,"div",6)(7,"div",7)(8,"select",8),ee("change",function(i){return r.changeTheme(i)}),x(9,xdt,2,3,"option",9),A()()()(),b(10,"div",3)(11,"label",10),Ce(12,11),A(),b(13,"div",6)(14,"div",7)(15,"select",12),ee("change",function(i){return r.changeLanguage(i)}),x(16,kdt,2,3,"option",9),A()()()()()),2&e&&(T(9),w("ngForOf",r.availableThemes),T(7),w("ngForOf",r.availableLanguages))},dependencies:[En,Up,Gp],encapsulation:2}),n})(),Rdt=(()=>{class n{constructor(e,r,s,i,o,c){this.route=e,this.router=r,this.connectedUserService=s,this.currentGameService=i,this.messageDisplayer=o,this.gameService=c}ngOnInit(){var e=this;return I(function*(){yield e.createGameAndRedirectOrShowError(e.extractGameFromURL())})()}extractGameFromURL(){return ge.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(e){var r=this;return I(function*(){if(We(r.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===r.gameExists(e))return yield r.router.navigate(["/notFound",K5.NO_MATCHING_GAME(e)],{skipLocationChange:!0}),!1;const i=r.currentGameService.canUserCreate();if(i.isSuccess()){const o=yield r.gameService.createPartConfigRoomAndChat(e);return yield r.router.navigate(["/play",e,o]),!0}return r.messageDisplayer.infoMessage(i.getReason()),yield r.router.navigate(["/lobby"]),!1})()}gameExists(e){return y.ofNullable(o9.ALL_GAMES().find(s=>s.urlName===e)).isPresent()}}return n.\u0275fac=function(e){return new(e||n)(Q(zo),Q(Xn),Q(Is),Q(D2),Q(_n),Q(GS))},n.\u0275cmp=ct({type:n,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(b(0,"p"),Ce(1,0),A())},encapsulation:2}),n})();!function eue(n,t,e){(function ble(n,t,e){"string"!=typeof t&&(e=t,t=n[Ct.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),bf[t]=n,e&&(bf[t][Ct.ExtraData]=e)})(n,t,e)}(Cpe);const Ddt=[{path:"login",component:_ft},{path:"lobby",component:Lft,canActivate:[c9]},{path:"account",component:Rft,canActivate:[c9]},{path:"settings",component:Ldt},{path:"register",component:V9t,canActivate:[Cdt]},{path:"reset-password",component:Idt},{path:"notFound/:message",component:E4e},{path:"nextGameLoading",component:B9t,canActivate:[c9]},{path:"verify-account",component:Odt,canActivate:[vdt]},{path:"play",component:y4e,canActivate:[c9,dF]},{path:"play/:compo",component:Rdt,canActivate:[c9,dF]},{path:"play/:compo/:id",component:Qht,canActivate:[c9,dF]},{path:"local",component:H9t},{path:"local/:compo",component:v9t},{path:"tutorial",component:F9t},{path:"tutorial/:compo",component:R9t},{path:"",component:ift},{path:"demo",component:dft},{path:"**",component:E4e}];class pF{static app(){return function xSe(n,...t){return{ngModule:ISe,providers:[{provide:UR,useFactory:NSe(n),multi:!0,deps:[wr,fi,BR,...t]}]}}(()=>kSe(y__firebaseConfig))}static firestore(){return function IOe(n,...t){return{ngModule:NOe,providers:[{provide:iV,useFactory:OOe(n),multi:!0,deps:[wr,fi,BR,$R,[new ui,Vte],[new ui,aD],...t]}]}}(()=>{const t=VOe();t.toJSON();return t})}static auth(){return function gOe(n,...t){return{ngModule:pOe,providers:[{provide:sV,useFactory:fOe(n),multi:!0,deps:[wr,fi,BR,$R,[new ui,aD],...t]}]}}(()=>{const t=vOe();return t})}}let zdt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n,bootstrap:[t4t]}),n.\u0275inj=Zr({providers:[Is,GS,lV,uV,Rh,BS,qS,{provide:b4,useValue:Rm.getLocale()}],imports:[pF.app(),pF.firestore(),pF.auth(),cq,j7e,f9e.forRoot(Ddt,{useHash:!1}),_W,I7e,_pe,_Ve]}),n})();$8(Xo,function(){return[hn,En,Kt,x6,k6,xa]},[]),$8(u1,function(){return[hn,En,Kt,a9]},[]);var Vdt=_c(7742);function O4e(){(function j0e(){aG=!1})(),E5e().bootstrapModule(zdt).catch(n=>console.error(n))}const b4e=Rm.getLocale();"en"!==b4e?fetch("/assets/"+b4e+".json").then(n=>n.ok?n.json():{locale:"en",translations:{}}).then(n=>{(0,Vdt.XJ)(n.translations),$localize.locale=n.locale,O4e()}).catch(function(n){console.log(n)}):O4e()},2486:function(l9,Q5){!function(_c){"use strict";function ln(mt,ft){var rn=Object.keys(mt);if(Object.getOwnPropertySymbols){var o1=Object.getOwnPropertySymbols(mt);ft&&(o1=o1.filter(function(Fs){return Object.getOwnPropertyDescriptor(mt,Fs).enumerable})),rn.push.apply(rn,o1)}return rn}function as(mt){for(var ft,rn=1;rn<arguments.length;rn++)ft=arguments[rn]??{},rn%2?ln(Object(ft),!0).forEach(function(o1){k8(mt,o1,ft[o1])}):Object.getOwnPropertyDescriptors?Object.defineProperties(mt,Object.getOwnPropertyDescriptors(ft)):ln(Object(ft)).forEach(function(o1){Object.defineProperty(mt,o1,Object.getOwnPropertyDescriptor(ft,o1))});return mt}function e4(mt,ft){if(!(mt instanceof ft))throw new TypeError("Cannot call a class as a function")}function i3(mt,ft){for(var rn,o1=0;o1<ft.length;o1++)(rn=ft[o1]).enumerable=rn.enumerable||!1,rn.configurable=!0,"value"in rn&&(rn.writable=!0),Object.defineProperty(mt,rn.key,rn)}function k1(mt,ft,rn){return ft&&i3(mt.prototype,ft),rn&&i3(mt,rn),mt}function k8(mt,ft,rn){return ft in mt?Object.defineProperty(mt,ft,{value:rn,enumerable:!0,configurable:!0,writable:!0}):mt[ft]=rn,mt}function o3(){var mt;return null!==(mt=cl)&&void 0!==mt?mt:document}var t4={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},yo=as({},t4),ni={},cl=null,u9=function(mt,ft,rn,o1,Fs){return"top-left"===mt?"left:".concat(o1,";top:").concat(ft,";text-align:left;align-items:flex-start;"):"top-right"===mt?"right:".concat(Fs,";top:").concat(ft,";text-align:right;align-items:flex-end;"):"top-center"===mt?"top:".concat(ft,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===mt?"left:".concat(o1,";bottom:").concat(rn,";text-align:left;align-items:flex-start;"):"bottom-right"===mt?"right:".concat(Fs,";bottom:").concat(rn,";text-align:right;align-items:flex-end;"):"bottom-center"===mt?"bottom:".concat(rn,";left:0;right:0;text-align:center;align-items:center;"):"center"===mt?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},L8=function(){function mt(ft){var rn=this;e4(this,mt),this.element=o3().createElement("div"),this.opacity=ft.opacity,this.type=ft.type,this.animate=ft.animate,this.dismissible=ft.dismissible,this.closeOnClick=ft.closeOnClick,this.message=ft.message,this.duration=ft.duration,this.pauseOnHover=ft.pauseOnHover,this.offsetTop=ft.offsetTop,this.offsetBottom=ft.offsetBottom,this.offsetLeft=ft.offsetLeft,this.offsetRight=ft.offsetRight,this.extraClasses=ft.extraClasses;var o1="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),Fs=["notification",this.extraClasses];if(this.type&&Fs.push(this.type),this.animate&&this.animate.in){var xn="animate__".concat(this.animate.in),or=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";Fs.push("animate__animated ".concat(xn," ").concat(or)),this.onAnimationEnd(function(){return rn.element.classList.remove(xn)})}if(this.element.className=Fs.join(" "),this.dismissible){var n4=o3().createElement("button");n4.className="delete",n4.addEventListener("click",function(){rn.destroy()}),this.element.insertAdjacentElement("afterbegin",n4)}else o1+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){rn.destroy()}),this.element.setAttribute("style",o1),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var J5=new c3(function(){rn.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){J5.pause()}),this.element.addEventListener("mouseout",function(){J5.resume()}))}return k1(mt,[{key:"destroy",value:function(){var ft=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){ft.removeParent(ft.element.parentNode),ft.element.remove(),delete ni.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete ni.position)}},{key:"removeParent",value:function(ft){ft&&1>=ft.children.length&&ft.remove()}},{key:"onAnimationEnd",value:function(){var ft=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},rn={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var o1 in rn)if(void 0!==this.element.style[o1]){this.element.addEventListener(rn[o1],function(){return ft()});break}}}]),mt}(),c3=function(){function mt(ft,rn){e4(this,mt),this.remaining=rn,this.callback=ft,this.resume()}return k1(mt,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),mt}();_c.resetDefaults=function(){yo=as({},t4)},_c.setDefaults=function(mt){yo=as(as({},t4),mt)},_c.setDoc=function vc(mt){for(var ft in ni)ni[ft].remove();ni={},cl=mt},_c.toast=function a3(mt){if(!mt.message)throw new Error("message is required");var ft=as(as({},yo),mt),rn=new L8(ft),o1=function vn(mt,ft,rn,o1,Fs,xn){if(ni.position)return ni.position;var or=o3().createElement("div");return or.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+u9(ft,rn,o1,Fs,xn)),mt.appendChild(or),ni.position=or,or}(ft.appendTo||o3().body,ft.position||yo.position,ft.offsetTop||yo.offsetTop,ft.offsetBottom||yo.offsetBottom,ft.offsetLeft||yo.offsetLeft,ft.offsetRight||yo.offsetRight);if(ft.single)for(var Fs=o1.lastElementChild;Fs;)o1.removeChild(Fs),Fs=o1.lastElementChild;o1.appendChild(rn.element)},Object.defineProperty(_c,"__esModule",{value:!0})}(Q5)},7742:(l9,Q5,_c)=>{"use strict";_c.d(Q5,{XJ:()=>Iu,pQ:()=>uy,Q:()=>ab});class Cn{constructor(a){this.digits=a}static zero(){return new Cn([0])}static one(){return new Cn([1])}clone(){return new Cn(this.digits.slice())}add(a){const l=this.clone();return l.addToSelf(a),l}addToSelf(a){const l=Math.max(this.digits.length,a.digits.length);let f=0;for(let p=0;p<l;p++){let _=f;p<this.digits.length&&(_+=this.digits[p]),p<a.digits.length&&(_+=a.digits[p]),_>=10?(this.digits[p]=_-10,f=1):(this.digits[p]=_,f=0)}f>0&&(this.digits[l]=1)}toString(){let a="";for(let l=this.digits.length-1;l>=0;l--)a+=this.digits[l];return a}}class n7{constructor(a){this.powerOfTwos=[a]}getValue(){return this.powerOfTwos[0]}multiplyBy(a){const l=Cn.zero();return this.multiplyByAndAddTo(a,l),l}multiplyByAndAddTo(a,l){for(let f=0;0!==a;a>>>=1,f++)if(1&a){const p=this.getMultipliedByPowerOfTwo(f);l.addToSelf(p)}}getMultipliedByPowerOfTwo(a){for(let l=this.powerOfTwos.length;l<=a;l++){const f=this.powerOfTwos[l-1];this.powerOfTwos[l]=f.add(f)}return this.powerOfTwos[a]}}class _F{constructor(a){this.base=a,this.exponents=[new n7(Cn.one())]}toThePowerOf(a){for(let l=this.exponents.length;l<=a;l++){const f=this.exponents[l-1].multiplyBy(this.base);this.exponents[l]=new n7(f)}return this.exponents[a]}}function O_(d){const a=function W2(d){let a=[];for(let l=0;l<d.length;l++){let f=d.charCodeAt(l);if(f>=55296&&f<=56319&&d.length>l+1){const p=d.charCodeAt(l+1);p>=56320&&p<=57343&&(l++,f=(f-55296<<10)+p-56320+65536)}f<=127?a.push(f):f<=2047?a.push(f>>6&31|192,63&f|128):f<=65535?a.push(f>>12|224,f>>6&63|128,63&f|128):f<=2097151&&a.push(f>>18&7|240,f>>12&63|128,f>>6&63|128,63&f|128)}return a}(d);let l=ET(a,0),f=ET(a,102072);return 0==l&&(0==f||1==f)&&(l^=319790063,f^=-1801410264),[l,f]}function ET(d,a){let p,l=2654435769,f=2654435769;const _=d.length;for(p=0;p+12<=_;p+=12){l=o2(l,z6(d,p,jr.Little)),f=o2(f,z6(d,p+4,jr.Little));const M=MT(l,f,a=o2(a,z6(d,p+8,jr.Little)));l=M[0],f=M[1],a=M[2]}return l=o2(l,z6(d,p,jr.Little)),f=o2(f,z6(d,p+4,jr.Little)),a=o2(a,_),MT(l,f,a=o2(a,z6(d,p+8,jr.Little)<<8))[2]}function MT(d,a,l){return d=ri(d,a),d=ri(d,l),d^=l>>>13,a=ri(a,l),a=ri(a,d),a^=d<<8,l=ri(l,d),l=ri(l,a),l^=a>>>13,d=ri(d,a),d=ri(d,l),d^=l>>>12,a=ri(a,l),a=ri(a,d),a^=d<<16,l=ri(l,d),l=ri(l,a),l^=a>>>5,d=ri(d,a),d=ri(d,l),d^=l>>>3,a=ri(a,l),a=ri(a,d),a^=d<<10,l=ri(l,d),l=ri(l,a),[d,a,l^=a>>>15]}var jr=(()=>((jr=jr||{})[jr.Little=0]="Little",jr[jr.Big=1]="Big",jr))();function o2(d,a){return ST(d,a)[1]}function ST(d,a){const l=(65535&d)+(65535&a),f=(d>>>16)+(a>>>16)+(l>>>16);return[f>>>16,f<<16|65535&l]}function ri(d,a){const l=(65535&d)-(65535&a);return(d>>16)-(a>>16)+(l>>16)<<16|65535&l}function A_(d,a){return a>=d.length?0:d[a]}function z6(d,a,l){let f=0;if(l===jr.Big)for(let p=0;p<4;p++)f+=A_(d,a+p)<<24-8*p;else for(let p=0;p<4;p++)f+=A_(d,a+p)<<8*p;return f}const m9=new _F(256);function iy(d,a,l,f,p=[]){const _={},M={},N={},D=function oy(d,a){const{text:l,block:f}=Pf(d,a);if(void 0===f)return{text:l};{const[p,..._]=f.split("\u241f"),[M,N]=p.split("@@",2);let[D,F]=M.split("|",2);return void 0===F&&(F=D,D=void 0),""===F&&(F=void 0),{text:l,meaning:D,description:F,customId:N,legacyIds:_}}}(d[0],d.raw[0]),F=[D.text],q=[];let ie=D.text;for(let He=1;He<d.length;He++){const{messagePart:Et,placeholderName:ot=b3(He),associatedMessageId:yt}=ay(d[He],d.raw[He]);ie+=`{$${ot}}${Et}`,void 0!==a&&(_[ot]=a[He-1],M[ot]=p[He-1]),q.push(ot),void 0!==yt&&(N[ot]=yt),F.push(Et)}const we=D.customId||function b_(d,a=""){let l=O_(d);if(a){const _=O_(a);l=function PT(d,a){const l=d[0],p=a[0],M=ST(d[1],a[1]),N=M[0],D=M[1];return[o2(o2(l,p),N),D]}(function yF(d,a){const l=d[0],f=d[1];return[l<<a|f>>>32-a,f<<a|l>>>32-a]}(l,1),_)}return function x_(d,a){const l=m9.toThePowerOf(0).multiplyBy(a);return m9.toThePowerOf(4).multiplyByAndAddTo(d,l),l.toString()}(2147483647&l[0],l[1])}(ie,D.meaning||""),Fe=D.legacyIds?D.legacyIds.filter(He=>He!==we):[];return{id:we,legacyIds:Fe,substitutions:_,substitutionLocations:M,text:ie,customId:D.customId,meaning:D.meaning||"",description:D.description||"",messageParts:F,messagePartLocations:f,placeholderNames:q,associatedMessageIds:N,location:l}}function ay(d,a){const{text:l,block:f}=Pf(d,a);if(void 0===f)return{messagePart:l};{const[p,_]=f.split("@@");return{messagePart:l,placeholderName:p,associatedMessageId:_}}}function Pf(d,a){if(":"!==a.charAt(0))return{text:d};{const l=Nu(d,a);return{block:d.substring(1,l),text:d.substring(l+1)}}}function b3(d){return 1===d?"PH":"PH_"+(d-1)}function Nu(d,a){for(let l=1,f=1;l<d.length;l++,f++)if("\\"===a[f])f++;else if(":"===d[l])return l;throw new Error(`Unterminated $localize metadata block in "${a}".`)}class Tf extends Error{constructor(a){super(`No translation found for ${ly(a)}.`),this.parsedMessage=a,this.type="MissingTranslationError"}}function cy(d,a){return Object.defineProperty(d,"raw",{value:a}),d}function ly(d){const a=d.meaning&&` - "${d.meaning}"`,l=d.legacyIds&&d.legacyIds.length>0?` [${d.legacyIds.map(f=>`"${f}"`).join(", ")}]`:"";return`"${d.id}"${l} ("${d.text}"${a})`}function Iu(d){$localize.translate||($localize.translate=AB),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(d).forEach(a=>{$localize.TRANSLATIONS[a]=function mp(d){const a=d.split(/{\$([^}]*)}/),l=[a[0]],f=[];for(let _=1;_<a.length-1;_+=2)f.push(a[_]),l.push(`${a[_+1]}`);const p=l.map(_=>":"===_.charAt(0)?"\\"+_:_);return{text:d,messageParts:cy(l,p),placeholderNames:f}}(d[a])})}function AB(d,a){try{return function ib(d,a,l){const f=iy(a,l);let p=d[f.id];if(void 0!==f.legacyIds)for(let _=0;_<f.legacyIds.length&&void 0===p;_++)p=d[f.legacyIds[_]];if(void 0===p)throw new Tf(f);return[p.messageParts,p.placeholderNames.map(_=>{if(f.substitutions.hasOwnProperty(_))return f.substitutions[_];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${ly(f)}.\nThe translation contains a placeholder with name ${_}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,d,a)}catch(l){return console.warn(l.message),[d,a]}}const ab=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),uy=function(d,...a){if(uy.translate){const f=uy.translate(d,a);d=f[0],a=f[1]}let l=fy(d[0],d.raw[0]);for(let f=1;f<d.length;f++)l+=a[f-1]+fy(d[f],d.raw[f]);return l};function fy(d,a){return":"===a.charAt(0)?d.substring(Nu(d,a)+1):d}}},l9=>{l9(l9.s=9713)}]);