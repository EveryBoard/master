(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,s;!function(o){if("object"==typeof e.exports){var a=o(0,t);void 0!==a&&(e.exports=a)}else i=[n,t],void 0!==(s="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=s)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++)n=arguments[r]??{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))});return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function s(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(){var e;return null!==(e=h)&&void 0!==e?e:document}var l={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},l),u={},h=null,d=function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},f=function(){function e(t){var n=this;r(this,e),this.element=a().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),s=["notification",this.extraClasses];if(this.type&&s.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),l=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";s.push("animate__animated ".concat(o," ").concat(l)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=s.join(" "),this.dismissible){var c=a().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var u=new p(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){u.pause()}),this.element.addEventListener("mouseout",function(){u.resume()}))}return s(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete u.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete u.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),p=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return s(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},l)},e.setDefaults=function(e){c=n(n({},l),e)},e.setDoc=function(e){for(var t in u)u[t].remove();u={},h=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new f(t),i=function(e,t,n,r,i,s){if(u.position)return u.position;var o=a().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+d(t,n,r,i,s)),e.appendChild(o),u.position=o,o}(t.appendTo||a().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var s=i.lastElementChild;s;)i.removeChild(s),s=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},2791:function(e,t,n){"use strict";function r(e){return"function"==typeof e}function i(e){const t=e(e=>{Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const s=i(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function o(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class a{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:i}=this;if(i)if(this._parentage=null,Array.isArray(i))for(const e of i)e.remove(this);else i.remove(this);const{initialTeardown:o}=this;if(r(o))try{o()}catch(t){e=t instanceof s?t.errors:[t]}const{_teardowns:a}=this;if(a){this._teardowns=null;for(const t of a)try{u(t)}catch(n){e=e??[],n instanceof s?e=[...e,...n.errors]:e.push(n)}}if(e)throw new s(e)}}add(e){var t;if(e&&e!==this)if(this.closed)u(e);else{if(e instanceof a){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(t=this._teardowns)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&o(t,e)}remove(e){const{_teardowns:t}=this;t&&o(t,e),e instanceof a&&e._removeParent(this)}}a.EMPTY=(()=>{const e=new a;return e.closed=!0,e})();const l=a.EMPTY;function c(e){return e instanceof a||e&&"closed"in e&&r(e.remove)&&r(e.add)&&r(e.unsubscribe)}function u(e){r(e)?e():e.unsubscribe()}const h={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},d={setTimeout(...e){const{delegate:t}=d;return((null==t?void 0:t.setTimeout)||setTimeout)(...e)},clearTimeout(e){const{delegate:t}=d;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function f(e){d.setTimeout(()=>{const{onUnhandledError:t}=h;if(!t)throw e;t(e)})}function p(){}const g=m("C",void 0,void 0);function m(e,t,n){return{kind:e,value:t,error:n}}let y=null;function v(e){if(h.useDeprecatedSynchronousErrorHandling){const t=!y;if(t&&(y={errorThrown:!1,error:null}),e(),t){const{errorThrown:e,error:t}=y;if(y=null,e)throw t}}else e()}class C extends a{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,c(e)&&e.add(this)):this.destination=S}static create(e,t,n){return new _(e,t,n)}next(e){this.isStopped?P(m("N",e,void 0),this):this._next(e)}error(e){this.isStopped?P(m("E",void 0,e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?P(g,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class _ extends C{constructor(e,t,n){let i;if(super(),r(e))i=e;else if(e){let r;({next:i,error:t,complete:n}=e),this&&h.useDeprecatedNextContext?(r=Object.create(e),r.unsubscribe=()=>this.unsubscribe()):r=e,i=null==i?void 0:i.bind(r),t=null==t?void 0:t.bind(r),n=null==n?void 0:n.bind(r)}this.destination={next:i?E(i):p,error:E(t??w),complete:n?E(n):p}}}function E(e,t){return(...t)=>{try{e(...t)}catch(n){h.useDeprecatedSynchronousErrorHandling?function(e){h.useDeprecatedSynchronousErrorHandling&&y&&(y.errorThrown=!0,y.error=e)}(n):f(n)}}}function w(e){throw e}function P(e,t){const{onStoppedNotification:n}=h;n&&d.setTimeout(()=>n(e,t))}const S={closed:!0,next:p,error:w,complete:p},b="function"==typeof Symbol&&Symbol.observable||"@@observable";function O(e){return e}let k=(()=>{class e{constructor(e){e&&(this._subscribe=e)}lift(t){const n=new e;return n.source=this,n.operator=t,n}subscribe(e,t,n){const i=function(e){return e&&e instanceof C||function(e){return e&&r(e.next)&&r(e.error)&&r(e.complete)}(e)&&c(e)}(e)?e:new _(e,t,n);return v(()=>{const{operator:e,source:t}=this;i.add(e?e.call(i,t):t?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(t){e.error(t)}}forEach(e,t){return new(t=T(t))((t,n)=>{const r=new _({next:t=>{try{e(t)}catch(i){n(i),r.unsubscribe()}},error:n,complete:t});this.subscribe(r)})}_subscribe(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}[b](){return this}pipe(...e){return function(e){return 0===e.length?O:1===e.length?e[0]:function(t){return e.reduce((e,t)=>t(e),t)}}(e)(this)}toPromise(e){return new(e=T(e))((e,t)=>{let n;this.subscribe(e=>n=e,e=>t(e),()=>e(n))})}}return e.create=t=>new e(t),e})();function T(e){var t;return null!==(t=e??h.Promise)&&void 0!==t?t:Promise}const I=i(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let A=(()=>{class e extends k{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const t=new M(this,this);return t.operator=e,t}_throwIfClosed(){if(this.closed)throw new I}next(e){v(()=>{if(this._throwIfClosed(),!this.isStopped){const t=this.observers.slice();for(const n of t)n.next(e)}})}error(e){v(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:t}=this;for(;t.length;)t.shift().error(e)}})}complete(){v(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:t,isStopped:n,observers:r}=this;return t||n?l:(r.push(e),new a(()=>o(r,e)))}_checkFinalizedStatuses(e){const{hasError:t,thrownError:n,isStopped:r}=this;t?e.error(n):r&&e.complete()}asObservable(){const e=new k;return e.source=this,e}}return e.create=(e,t)=>new M(e,t),e})();class M extends A{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:l}}function N(e){return r(null==e?void 0:e.lift)}function R(e){return t=>{if(N(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}class x extends C{constructor(e,t,n,r,i){super(e),this.onFinalize=i,this._next=t?function(n){try{t(n)}catch(r){e.error(r)}}:super._next,this._error=r?function(t){try{r(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(t){e.error(t)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}function D(e,t){return R((n,r)=>{let i=0;n.subscribe(new x(r,n=>{r.next(e.call(t,n,i++))}))})}function L(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function F(e){return this instanceof F?(this.v=e,this):new F(e)}function U(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){s.push([e,t,n,r])>1||a(e,t)})})}function a(e,t){try{!function(e){e.value instanceof F?Promise.resolve(e.value.v).then(l,c):u(s[0][2],e)}(i[e](t))}catch(n){u(s[0][3],n)}}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function V(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}const B=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function $(e){return r(null==e?void 0:e.then)}function z(e){return r(e[b])}function H(e){return Symbol.asyncIterator&&r(null==e?void 0:e[Symbol.asyncIterator])}function G(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Z="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function q(e){return r(null==e?void 0:e[Z])}function W(e){return U(this,arguments,function*(){const t=e.getReader();try{for(;;){const{value:e,done:n}=yield F(t.read());if(n)return yield F(void 0);yield yield F(e)}}finally{t.releaseLock()}})}function j(e){return r(null==e?void 0:e.getReader)}function Y(e){if(e instanceof k)return e;if(null!=e){if(z(e))return function(e){return new k(t=>{const n=e[b]();if(r(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(B(e))return function(e){return new k(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if($(e))return function(e){return new k(t=>{e.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,f)})}(e);if(H(e))return K(e);if(q(e))return function(e){return new k(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(j(e))return function(e){return K(W(e))}(e)}throw G(e)}function K(e){return new k(t=>{(function(e,t){var n,r,i,s;return function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,a)}l((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=V(e);!(r=yield n.next()).done;)if(t.next(r.value),t.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}t.complete()})})(e,t).catch(e=>t.error(e))})}function Q(e,t,n,r=0,i=!1){const s=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(s),!i)return s}function X(e,t,n=1/0){return r(t)?X((n,r)=>D((e,i)=>t(n,e,r,i))(Y(e(n,r))),n):("number"==typeof t&&(n=t),R((t,r)=>function(e,t,n,r,i,s,o,a){const l=[];let c=0,u=0,h=!1;const d=()=>{h&&!l.length&&!c&&t.complete()},f=e=>c<r?p(e):l.push(e),p=e=>{c++;let i=!1;Y(n(e,u++)).subscribe(new x(t,e=>{t.next(e)},()=>{i=!0},void 0,()=>{if(i)try{for(c--;l.length&&c<r;){const e=l.shift();p(e)}d()}catch(e){t.error(e)}}))};return e.subscribe(new x(t,f,()=>{h=!0,d()})),()=>{}}(t,r,e,n)))}function J(e=1/0){return X(O,e)}const ee=new k(e=>e.complete());function te(e){return e[e.length-1]}function ne(e){return r(te(e))?e.pop():void 0}function re(e){return function(e){return e&&r(e.schedule)}(te(e))?e.pop():void 0}function ie(e,t=0){return R((n,r)=>{n.subscribe(new x(r,n=>Q(r,e,()=>r.next(n),t),()=>Q(r,e,()=>r.complete(),t),n=>Q(r,e,()=>r.error(n),t)))})}function se(e,t=0){return R((n,r)=>{r.add(e.schedule(()=>n.subscribe(r),t))})}function oe(e,t){if(!e)throw new Error("Iterable cannot be null");return new k(n=>{Q(n,t,()=>{const r=e[Symbol.asyncIterator]();Q(n,t,()=>{r.next().then(e=>{e.done?n.complete():n.next(e.value)})},0,!0)})})}function ae(e,t){return t?function(e,t){if(null!=e){if(z(e))return function(e,t){return Y(e).pipe(se(t),ie(t))}(e,t);if(B(e))return function(e,t){return new k(n=>{let r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if($(e))return function(e,t){return Y(e).pipe(se(t),ie(t))}(e,t);if(H(e))return oe(e,t);if(q(e))return function(e,t){return new k(n=>{let i;return Q(n,t,()=>{i=e[Z](),Q(n,t,()=>{let e,t;try{({value:e,done:t}=i.next())}catch(r){return void n.error(r)}t?n.complete():n.next(e)},0,!0)}),()=>r(null==i?void 0:i.return)&&i.return()})}(e,t);if(j(e))return function(e,t){return oe(W(e),t)}(e,t)}throw G(e)}(e,t):Y(e)}function le(e){return e<=0?()=>ee:R((t,n)=>{let r=0;t.subscribe(new x(n,t=>{++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function ce(e,t,...n){return!0===t?(e(),null):!1===t?null:t(...n).pipe(le(1)).subscribe(()=>e())}function ue(e){for(let t in e)if(e[t]===ue)return t;throw Error("Could not find renamed property on target object.")}function he(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function de(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(de).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function fe(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const pe=ue({__forward_ref__:ue});function ge(e){return e.__forward_ref__=ge,e.toString=function(){return de(this())},e}function me(e){return ye(e)?e():e}function ye(e){return"function"==typeof e&&e.hasOwnProperty(pe)&&e.__forward_ref__===ge}class ve extends Error{constructor(e,t){super(function(e,t){return`${e?`NG0${e}: `:""}${t}`}(e,t)),this.code=e}}function Ce(e){return"string"==typeof e?e:null==e?"":String(e)}function _e(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Ce(e)}function Ee(e,t){const n=t?` in ${t}`:"";throw new ve("201",`No provider for ${_e(e)} found${n}`)}function we(e,t,n,r){throw new Error(`ASSERTION ERROR: ${e}`+(null==r?"":` [Expected=> ${n} ${r} ${t} <=Actual]`))}function Pe(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Se(e){return{providers:e.providers||[],imports:e.imports||[]}}function be(e){return Oe(e,Te)||Oe(e,Ae)}function Oe(e,t){return e.hasOwnProperty(t)?e[t]:null}function ke(e){return e&&(e.hasOwnProperty(Ie)||e.hasOwnProperty(Me))?e[Ie]:null}const Te=ue({"\u0275prov":ue}),Ie=ue({"\u0275inj":ue}),Ae=ue({ngInjectableDef:ue}),Me=ue({ngInjectorDef:ue});var Ne=(()=>((Ne=Ne||{})[Ne.Default=0]="Default",Ne[Ne.Host=1]="Host",Ne[Ne.Self=2]="Self",Ne[Ne.SkipSelf=4]="SkipSelf",Ne[Ne.Optional=8]="Optional",Ne))();let Re;function xe(e){const t=Re;return Re=e,t}function De(e,t,n){const r=be(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Ne.Optional?null:void 0!==t?t:void Ee(de(e),"Injector")}function Le(e){return{toString:e}.toString()}var Fe=(()=>((Fe=Fe||{})[Fe.OnPush=0]="OnPush",Fe[Fe.Default=1]="Default",Fe))(),Ue=(()=>((Ue=Ue||{})[Ue.Emulated=0]="Emulated",Ue[Ue.None=2]="None",Ue[Ue.ShadowDom=3]="ShadowDom",Ue))();const Ve="undefined"!=typeof globalThis&&globalThis,Be="undefined"!=typeof window&&window,$e="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ze=Ve||"undefined"!=typeof global&&global||Be||$e,He={},Ge=[],Ze=ue({"\u0275cmp":ue}),qe=ue({"\u0275dir":ue}),We=ue({"\u0275pipe":ue}),je=ue({"\u0275mod":ue}),Ye=ue({"\u0275loc":ue}),Ke=ue({"\u0275fac":ue}),Qe=ue({__NG_ELEMENT_ID__:ue});let Xe=0;function Je(e){return Le(()=>{const t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Fe.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Ge,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Ue.Emulated,id:"c",styles:e.styles||Ge,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,s=e.pipes;return n.id+=Xe++,n.inputs=it(e.inputs,t),n.outputs=it(e.outputs),i&&i.forEach(e=>e(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(et):null,n.pipeDefs=s?()=>("function"==typeof s?s():s).map(tt):null,n})}function et(e){return at(e)||function(e){return e[qe]||null}(e)}function tt(e){return function(e){return e[We]||null}(e)}const nt={};function rt(e){return Le(()=>{const t={type:e.type,bootstrap:e.bootstrap||Ge,declarations:e.declarations||Ge,imports:e.imports||Ge,exports:e.exports||Ge,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(nt[e.id]=e.type),t})}function it(e,t){if(null==e)return He;const n={};for(const r in e)if(e.hasOwnProperty(r)){let i=e[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,t&&(t[i]=s)}return n}const st=Je;function ot(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function at(e){return e[Ze]||null}function lt(e,t){const n=e[je]||null;if(!n&&!0===t)throw new Error(`Type ${de(e)} does not have '\u0275mod' property.`);return n}function ct(e){return Array.isArray(e)&&"object"==typeof e[1]}function ut(e){return Array.isArray(e)&&!0===e[1]}function ht(e){return 0!=(8&e.flags)}function dt(e){return 2==(2&e.flags)}function ft(e){return 1==(1&e.flags)}function pt(e){return null!==e.template}function gt(e){return 0!=(512&e[2])}function mt(e,t){return e.hasOwnProperty(Ke)?e[Ke]:null}class yt{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function vt(){return Ct}function Ct(e){return e.type.prototype.ngOnChanges&&(e.setInput=Et),_t}function _t(){const e=Pt(this),t=null==e?void 0:e.current;if(t){const n=e.previous;if(n===He)e.previous=t;else for(let e in t)n[e]=t[e];e.current=null,this.ngOnChanges(t)}}function Et(e,t,n,r){const i=Pt(e)||function(e,t){return e[wt]=t}(e,{previous:He,current:null}),s=i.current||(i.current={}),o=i.previous,a=this.declaredInputs[n],l=o[a];s[a]=new yt(l&&l.currentValue,t,o===He),e[r]=t}vt.ngInherit=!0;const wt="__ngSimpleChanges__";function Pt(e){return e[wt]||null}const St="http://www.w3.org/2000/svg";let bt;function Ot(){return void 0!==bt?bt:"undefined"!=typeof document?document:void 0}function kt(e){return!!e.listen}const Tt={createRenderer:(e,t)=>Ot()};function It(e){for(;Array.isArray(e);)e=e[0];return e}function At(e,t){return It(t[e])}function Mt(e,t){return It(t[e.index])}function Nt(e,t){return e.data[t]}function Rt(e,t){return e[t]}function xt(e,t){const n=t[e];return ct(n)?n:n[0]}function Dt(e){return 4==(4&e[2])}function Lt(e){return 128==(128&e[2])}function Ft(e,t){return null==t?null:e[t]}function Ut(e){e[18]=0}function Vt(e,t){e[5]+=t;let n=e,r=e[3];for(;null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}const Bt={lFrame:fn(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function $t(){return Bt.bindingsEnabled}function zt(){return Bt.lFrame.lView}function Ht(){return Bt.lFrame.tView}function Gt(e){return Bt.lFrame.contextLView=e,e[8]}function Zt(){let e=qt();for(;null!==e&&64===e.type;)e=e.parent;return e}function qt(){return Bt.lFrame.currentTNode}function Wt(){const e=Bt.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function jt(e,t){const n=Bt.lFrame;n.currentTNode=e,n.isParent=t}function Yt(){return Bt.lFrame.isParent}function Kt(){Bt.lFrame.isParent=!1}function Qt(){return Bt.isInCheckNoChangesMode}function Xt(e){Bt.isInCheckNoChangesMode=e}function Jt(){const e=Bt.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function en(){return Bt.lFrame.bindingIndex}function tn(){return Bt.lFrame.bindingIndex++}function nn(e){const t=Bt.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function rn(e){Bt.lFrame.inI18n=e}function sn(e,t){const n=Bt.lFrame;n.bindingIndex=n.bindingRootIndex=e,on(t)}function on(e){Bt.lFrame.currentDirectiveIndex=e}function an(){return Bt.lFrame.currentQueryIndex}function ln(e){Bt.lFrame.currentQueryIndex=e}function cn(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function un(e,t,n){if(n&Ne.SkipSelf){let r=t,i=e;for(;!(r=r.parent,null!==r||n&Ne.Host||(r=cn(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}const r=Bt.lFrame=dn();return r.currentTNode=t,r.lView=e,!0}function hn(e){const t=dn(),n=e[1];Bt.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function dn(){const e=Bt.lFrame,t=null===e?null:e.child;return null===t?fn(e):t}function fn(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function pn(){const e=Bt.lFrame;return Bt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const gn=pn;function mn(){const e=pn();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function yn(){return Bt.lFrame.selectedIndex}function vn(e){Bt.lFrame.selectedIndex=e}function Cn(){const e=Bt.lFrame;return Nt(e.tView,e.selectedIndex)}function _n(){Bt.lFrame.currentNamespace=St}function En(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){const t=e.data[n].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:i,ngAfterViewInit:s,ngAfterViewChecked:o,ngOnDestroy:a}=t;r&&(e.contentHooks||(e.contentHooks=[])).push(-n,r),i&&((e.contentHooks||(e.contentHooks=[])).push(n,i),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,i)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),o&&((e.viewHooks||(e.viewHooks=[])).push(n,o),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,o)),null!=a&&(e.destroyHooks||(e.destroyHooks=[])).push(n,a)}}function wn(e,t,n){bn(e,t,3,n)}function Pn(e,t,n,r){(3&e[2])===n&&bn(e,t,n,r)}function Sn(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function bn(e,t,n,r){const i=r??-1,s=t.length-1;let o=0;for(let a=void 0!==r?65535&e[18]:0;a<s;a++)if("number"==typeof t[a+1]){if(o=t[a],null!=r&&o>=r)break}else t[a]<0&&(e[18]+=65536),(o<i||-1==i)&&(On(e,n,t,a),e[18]=(4294901760&e[18])+a+2),a++}function On(e,t,n,r){const i=n[r]<0,s=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{s.call(o)}finally{}}}else try{s.call(o)}finally{}}class kn{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function Tn(e,t,n){const r=kt(e);let i=0;for(;i<n.length;){const s=n[i];if("number"==typeof s){if(0!==s)break;i++;const o=n[i++],a=n[i++],l=n[i++];r?e.setAttribute(t,a,l,o):t.setAttributeNS(o,a,l)}else{const o=s,a=n[++i];An(o)?r&&e.setProperty(t,o,a):r?e.setAttribute(t,o,a):t.setAttribute(o,a),i++}}return i}function In(e){return 3===e||4===e||6===e}function An(e){return 64===e.charCodeAt(0)}function Mn(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){const i=t[r];"number"==typeof i?n=i:0===n||Nn(e,n,i,null,-1===n||2===n?t[++r]:null)}}return e}function Nn(e,t,n,r,i){let s=0,o=e.length;if(-1===t)o=-1;else for(;s<e.length;){const n=e[s++];if("number"==typeof n){if(n===t){o=-1;break}if(n>t){o=s-1;break}}}for(;s<e.length;){const t=e[s];if("number"==typeof t)break;if(t===n){if(null===r)return void(null!==i&&(e[s+1]=i));if(r===e[s+1])return void(e[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(e.splice(o,0,t),s=o+1),e.splice(s++,0,n),null!==r&&e.splice(s++,0,r),null!==i&&e.splice(s++,0,i)}function Rn(e){return-1!==e}function xn(e){return 32767&e}function Dn(e,t){let n=function(e){return e>>16}(e),r=t;for(;n>0;)r=r[15],n--;return r}let Ln=!0;function Fn(e){const t=Ln;return Ln=e,t}let Un=0;function Vn(e,t){const n=$n(e,t);if(-1!==n)return n;const r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,Bn(r.data,e),Bn(t,null),Bn(r.blueprint,null));const i=zn(e,t),s=e.injectorIndex;if(Rn(i)){const e=xn(i),n=Dn(i,t),r=n[1].data;for(let i=0;i<8;i++)t[s+i]=n[e+i]|r[e+i]}return t[s+8]=i,s}function Bn(e,t){e.push(0,0,0,0,0,0,0,0,t)}function $n(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function zn(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,r=null,i=t;for(;null!==i;){const e=i[1],t=e.type;if(r=2===t?e.declTNode:1===t?i[6]:null,null===r)return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function Hn(e,t,n){!function(e,t,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Qe)&&(r=n[Qe]),null==r&&(r=n[Qe]=Un++);const i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function Gn(e,t,n){if(n&Ne.Optional)return e;Ee(t,"NodeInjector")}function Zn(e,t,n,r){if(n&Ne.Optional&&void 0===r&&(r=null),0==(n&(Ne.Self|Ne.Host))){const i=e[9],s=xe(void 0);try{return i?i.get(t,r,n&Ne.Optional):De(t,r,n&Ne.Optional)}finally{xe(s)}}return Gn(r,t,n)}function qn(e,t,n,r=Ne.Default,i){if(null!==e){const s=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(Qe)?e[Qe]:void 0;return"number"==typeof t?t>=0?255&t:jn:t}(n);if("function"==typeof s){if(!un(t,e,r))return r&Ne.Host?Gn(i,n,r):Zn(t,n,r,i);try{const e=s(r);if(null!=e||r&Ne.Optional)return e;Ee(n)}finally{gn()}}else if("number"==typeof s){let i=null,o=$n(e,t),a=-1,l=r&Ne.Host?t[16][6]:null;for((-1===o||r&Ne.SkipSelf)&&(a=-1===o?zn(e,t):t[o+8],-1!==a&&Jn(r,!1)?(i=t[1],o=xn(a),t=Dn(a,t)):o=-1);-1!==o;){const e=t[1];if(Xn(s,o,e.data)){const e=Yn(o,t,n,i,r,l);if(e!==Wn)return e}a=t[o+8],-1!==a&&Jn(r,t[1].data[o+8]===l)&&Xn(s,o,t)?(i=e,o=xn(a),t=Dn(a,t)):o=-1}}}return Zn(t,n,r,i)}const Wn={};function jn(){return new er(Zt(),zt())}function Yn(e,t,n,r,i,s){const o=t[1],a=o.data[e+8],l=Kn(a,o,n,null==r?dt(a)&&Ln:r!=o&&0!=(3&a.type),i&Ne.Host&&s===a);return null!==l?Qn(t,o,l,a):Wn}function Kn(e,t,n,r,i){const s=e.providerIndexes,o=t.data,a=1048575&s,l=e.directiveStart,c=s>>20,u=i?a+c:e.directiveEnd;for(let h=r?a:a+c;h<u;h++){const e=o[h];if(h<l&&n===e||h>=l&&e.type===n)return h}if(i){const e=o[l];if(e&&pt(e)&&e.type===n)return l}return null}function Qn(e,t,n,r){let i=e[n];const s=t.data;if(function(e){return e instanceof kn}(i)){const o=i;o.resolving&&function(e,t){throw new ve("200",`Circular dependency in DI detected for ${e}`)}(_e(s[n]));const a=Fn(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?xe(o.injectImpl):null;un(e,r,Ne.Default);try{i=e[n]=o.factory(void 0,s,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=t.type.prototype;if(r){const r=Ct(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,r)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,i),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s))}(n,s[n],t)}finally{null!==l&&xe(l),Fn(a),o.resolving=!1,gn()}}return i}function Xn(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function Jn(e,t){return!(e&Ne.Self||e&Ne.Host&&t)}class er{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return qn(this._tNode,this._lView,e,n,t)}}function tr(e){return Le(()=>{const t=e.prototype.constructor,n=t[Ke]||nr(t),r=Object.prototype;let i=Object.getPrototypeOf(e.prototype).constructor;for(;i&&i!==r;){const e=i[Ke]||nr(i);if(e&&e!==n)return e;i=Object.getPrototypeOf(i)}return e=>new e})}function nr(e){return ye(e)?()=>{const t=nr(me(e));return t&&t()}:mt(e)}function rr(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const e=n.length;let r=0;for(;r<e;){const i=n[r];if(In(i))break;if(0===i)r+=2;else if("number"==typeof i)for(r++;r<e&&"string"==typeof n[r];)r++;else{if(i===t)return n[r+1];r+=2}}}return null}(Zt(),e)}const ir="__parameters__";function sr(e,t,n){return Le(()=>{const r=function(e){return function(...t){if(e){const n=e(...t);for(const e in n)this[e]=n[e]}}}(t);function i(...e){if(this instanceof i)return r.apply(this,e),this;const t=new i(...e);return n.annotation=t,n;function n(e,n,r){const i=e.hasOwnProperty(ir)?e[ir]:Object.defineProperty(e,ir,{value:[]})[ir];for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(t),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}class or{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Pe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const ar=new or("AnalyzeForEntryComponents"),lr=Function;function cr(e,t){void 0===t&&(t=e);for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),cr(r,t)):t!==e&&t.push(r)}return t}function ur(e,t){e.forEach(e=>Array.isArray(e)?ur(e,t):t(e))}function hr(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function dr(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function fr(e,t){const n=[];for(let r=0;r<e;r++)n.push(t);return n}function pr(e,t,n){let r=mr(e,t);return r>=0?e[1|r]=n:(r=~r,function(e,t,n,r){let i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r,t,n)),r}function gr(e,t){const n=mr(e,t);if(n>=0)return e[1|n]}function mr(e,t){return function(e,t,n){let r=0,i=e.length>>n;for(;i!==r;){const s=r+(i-r>>1),o=e[s<<n];if(t===o)return s<<n;o>t?i=s:r=s+1}return~(i<<n)}(e,t,1)}const yr={},vr="__NG_DI_FLAG__",Cr="ngTempTokenPath",_r=/\n/gm,Er="__source",wr=ue({provide:String,useValue:ue});let Pr;function Sr(e){const t=Pr;return Pr=e,t}function br(e,t=Ne.Default){if(void 0===Pr)throw new Error("inject() must be called from an injection context");return null===Pr?De(e,void 0,t):Pr.get(e,t&Ne.Optional?null:void 0,t)}function Or(e,t=Ne.Default){return(Re||br)(me(e),t)}function kr(e){const t=[];for(let n=0;n<e.length;n++){const r=me(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let e,n=Ne.Default;for(let t=0;t<r.length;t++){const i=r[t],s=Ir(i);"number"==typeof s?-1===s?e=i.token:n|=s:e=i}t.push(Or(e,n))}else t.push(Or(r))}return t}function Tr(e,t){return e[vr]=t,e.prototype[vr]=t,e}function Ir(e){return e[vr]}function Ar(e,t,n,r){const i=e[Cr];throw t[Er]&&i.unshift(t[Er]),e.message=function(e,t,n,r=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let i=de(t);if(Array.isArray(t))i=t.map(de).join(" -> ");else if("object"==typeof t){let e=[];for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];e.push(n+":"+("string"==typeof r?JSON.stringify(r):de(r)))}i=`{${e.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${e.replace(_r,"\n  ")}`}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[Cr]=null,e}const Mr=Tr(sr("Inject",e=>({token:e})),-1),Nr=Tr(sr("Optional"),8),Rr=Tr(sr("SkipSelf"),4);let xr,Dr;function Lr(e){var t;return(null===(t=function(){if(void 0===xr&&(xr=null,ze.trustedTypes))try{xr=ze.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return xr}())||void 0===t?void 0:t.createHTML(e))||e}function Fr(e){var t;return(null===(t=function(){if(void 0===Dr&&(Dr=null,ze.trustedTypes))try{Dr=ze.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Dr}())||void 0===t?void 0:t.createHTML(e))||e}class Ur{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Vr extends Ur{getTypeName(){return"HTML"}}class Br extends Ur{getTypeName(){return"Style"}}class $r extends Ur{getTypeName(){return"Script"}}class zr extends Ur{getTypeName(){return"URL"}}class Hr extends Ur{getTypeName(){return"ResourceURL"}}function Gr(e){return e instanceof Ur?e.changingThisBreaksApplicationSecurity:e}function Zr(e,t){const n=qr(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===t}function qr(e){return e instanceof Ur&&e.getTypeName()||null}function Wr(e){const t=new Yr(e);return function(){try{return!!(new window.DOMParser).parseFromString(Lr(""),"text/html")}catch{return!1}}()?new jr(t):t}class jr{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Lr(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class Yr{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const t=this.inertDocument.createElement("body");e.appendChild(t)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Lr(e),t;const n=this.inertDocument.createElement("body");return n.innerHTML=Lr(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const n=t.item(r).name;("xmlns:ns1"===n||0===n.indexOf("ns1:"))&&e.removeAttribute(n)}let n=e.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const Kr=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Qr=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Xr(e){return(e=String(e)).match(Kr)||e.match(Qr)?e:"unsafe:"+e}function Jr(e){return(e=String(e)).split(",").map(e=>Xr(e.trim())).join(", ")}function ei(e){const t={};for(const n of e.split(","))t[n]=!0;return t}function ti(...e){const t={};for(const n of e)for(const e in n)n.hasOwnProperty(e)&&(t[e]=!0);return t}const ni=ei("area,br,col,hr,img,wbr"),ri=ei("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),ii=ei("rp,rt"),si=ti(ni,ti(ri,ei("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ti(ii,ei("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ti(ii,ri)),oi=ei("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ai=ei("srcset"),li=ti(oi,ai,ei("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ei("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ci=ei("script,style,template");class ui{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let e=this.checkClobberedElement(t,t.nextSibling);if(e){t=e;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!si.hasOwnProperty(t))return this.sanitizedSomething=!0,!ci.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let r=0;r<n.length;r++){const e=n.item(r),t=e.name,i=t.toLowerCase();if(!li.hasOwnProperty(i)){this.sanitizedSomething=!0;continue}let s=e.value;oi[i]&&(s=Xr(s)),ai[i]&&(s=Jr(s)),this.buf.push(" ",t,'="',fi(s),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();si.hasOwnProperty(t)&&!ni.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(fi(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const hi=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,di=/([^\#-~ |!])/g;function fi(e){return e.replace(/&/g,"&amp;").replace(hi,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(di,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let pi;function gi(e,t){let n=null;try{pi=pi||Wr(e);let r=t?String(t):"";n=pi.getInertBodyElement(r);let i=5,s=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=s,s=n.innerHTML,n=pi.getInertBodyElement(r)}while(r!==s);return Lr((new ui).sanitizeChildren(mi(n)||n))}finally{if(n){const e=mi(n)||n;for(;e.firstChild;)e.removeChild(e.firstChild)}}}function mi(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var yi=(()=>((yi=yi||{})[yi.NONE=0]="NONE",yi[yi.HTML=1]="HTML",yi[yi.STYLE=2]="STYLE",yi[yi.SCRIPT=3]="SCRIPT",yi[yi.URL=4]="URL",yi[yi.RESOURCE_URL=5]="RESOURCE_URL",yi))();function vi(e){const t=_i();return t?Fr(t.sanitize(yi.HTML,e)||""):Zr(e,"HTML")?Fr(Gr(e)):gi(Ot(),Ce(e))}function Ci(e){const t=_i();return t?t.sanitize(yi.URL,e)||"":Zr(e,"URL")?Gr(e):Xr(Ce(e))}function _i(){const e=zt();return e&&e[12]}const Ei="__ngContext__";function wi(e,t){e[Ei]=t}function Pi(e){const t=function(e){return e[Ei]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Si(e){return e.ngOriginalError}function bi(e,...t){e.error(...t)}class Oi{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),n=this._findContext(e),r=(i=e)&&i.ngErrorLogger||bi;var i;r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(e){return e?e.ngDebugContext||this._findContext(Si(e)):null}_findOriginalError(e){let t=e&&Si(e);for(;t&&Si(t);)t=Si(t);return t||null}}const ki=/^>|^->|<!--|-->|--!>|<!-$/g,Ti=/(<|>)/;const Ii=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ze))();function Ai(e){return e instanceof Function?e():e}var Mi=(()=>((Mi=Mi||{})[Mi.Important=1]="Important",Mi[Mi.DashCase=2]="DashCase",Mi))();let Ni;function Ri(e,t){return Ni(e,t)}function xi(e){const t=e[3];return ut(t)?t[3]:t}function Di(e){return Fi(e[13])}function Li(e){return Fi(e[4])}function Fi(e){for(;null!==e&&!ut(e);)e=e[4];return e}function Ui(e,t,n,r,i){if(null!=r){let s,o=!1;ut(r)?s=r:ct(r)&&(o=!0,r=r[0]);const a=It(r);0===e&&null!==n?null==i?Ki(t,n,a):Yi(t,n,a,i||null,!0):1===e&&null!==n?Yi(t,n,a,i||null,!0):2===e?ls(t,a,o):3===e&&t.destroyNode(a),null!=s&&function(e,t,n,r,i){const s=n[7];s!==It(n)&&Ui(t,e,r,s,i);for(let o=10;o<n.length;o++){const i=n[o];us(i[1],i,e,t,r,s)}}(t,e,s,n,i)}}function Vi(e,t){return kt(e)?e.createText(t):e.createTextNode(t)}function Bi(e,t,n){kt(e)?e.setValue(t,n):t.textContent=n}function $i(e,t){return e.createComment(function(e){return e.replace(ki,e=>e.replace(Ti,"\u200b$1\u200b"))}(t))}function zi(e,t,n){return kt(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function Hi(e,t){const n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,Vt(i,-1)),n.splice(r,1)}function Gi(e,t){if(e.length<=10)return;const n=10+t,r=e[n];if(r){const i=r[17];null!==i&&i!==e&&Hi(i,r),t>0&&(e[n-1][4]=r[4]);const s=dr(e,10+t);!function(e,t){us(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const o=s[19];null!==o&&o.detachView(s[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function Zi(e,t){if(!(256&t[2])){const n=t[11];kt(n)&&n.destroyNode&&us(e,t,n,3,null,null),function(e){let t=e[13];if(!t)return qi(e[1],e);for(;t;){let n=null;if(ct(t))n=t[13];else{const e=t[10];e&&(n=e)}if(!n){for(;t&&!t[4]&&t!==e;)ct(t)&&qi(t[1],t),t=t[3];null===t&&(t=e),ct(t)&&qi(t[1],t),n=t&&t[4]}t=n}}(t)}}function qi(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let r=0;r<n.length;r+=2){const e=t[n[r]];if(!(e instanceof kn)){const t=n[r+1];if(Array.isArray(t))for(let n=0;n<t.length;n+=2){const r=e[t[n]],i=t[n+1];try{i.call(r)}finally{}}else try{t.call(e)}finally{}}}}(e,t),function(e,t){const n=e.cleanup,r=t[7];let i=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const e=n[s+1],o="function"==typeof e?e(t):It(t[e]),a=r[i=n[s+2]],l=n[s+3];"boolean"==typeof l?o.removeEventListener(n[s],a,l):l>=0?r[i=l]():r[i=-l].unsubscribe(),s+=2}else{const e=r[i=n[s+1]];n[s].call(e)}if(null!==r){for(let e=i+1;e<r.length;e++)r[e]();t[7]=null}}(e,t),1===t[1].type&&kt(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&ut(t[3])){n!==t[3]&&Hi(n,t);const r=t[19];null!==r&&r.detachView(e)}}}function Wi(e,t,n){return ji(e,t.parent,n)}function ji(e,t,n){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){const t=e.data[r.directiveStart].encapsulation;if(t===Ue.None||t===Ue.Emulated)return null}return Mt(r,n)}function Yi(e,t,n,r,i){kt(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function Ki(e,t,n){kt(e)?e.appendChild(t,n):t.appendChild(n)}function Qi(e,t,n,r,i){null!==r?Yi(e,t,n,r,i):Ki(e,t,n)}function Xi(e,t){return kt(e)?e.parentNode(t):t.parentNode}function Ji(e,t,n){return ns(e,t,n)}function es(e,t,n){return 40&e.type?Mt(e,n):null}let ts,ns=es;function rs(e,t){ns=e,ts=t}function is(e,t,n,r){const i=Wi(e,r,t),s=t[11],o=Ji(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(let a=0;a<n.length;a++)Qi(s,i,n[a],o,!1);else Qi(s,i,n,o,!1);void 0!==ts&&ts(s,r,t,n,i)}function ss(e,t){if(null!==t){const n=t.type;if(3&n)return Mt(t,e);if(4&n)return as(-1,e[t.index]);if(8&n){const n=t.child;if(null!==n)return ss(e,n);{const n=e[t.index];return ut(n)?as(-1,n):It(n)}}if(32&n)return Ri(t,e)()||It(e[t.index]);{const n=os(e,t);return null!==n?Array.isArray(n)?n[0]:ss(xi(e[16]),n):ss(e,t.next)}}return null}function os(e,t){return null!==t?e[16][6].projection[t.projection]:null}function as(e,t){const n=10+e+1;if(n<t.length){const e=t[n],r=e[1].firstChild;if(null!==r)return ss(e,r)}return t[7]}function ls(e,t,n){const r=Xi(e,t);r&&function(e,t,n,r){kt(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function cs(e,t,n,r,i,s,o){for(;null!=n;){const a=r[n.index],l=n.type;if(o&&0===t&&(a&&wi(It(a),r),n.flags|=4),64!=(64&n.flags))if(8&l)cs(e,t,n.child,r,i,s,!1),Ui(t,e,i,a,s);else if(32&l){const o=Ri(n,r);let l;for(;l=o();)Ui(t,e,i,l,s);Ui(t,e,i,a,s)}else 16&l?hs(e,t,r,n,i,s):Ui(t,e,i,a,s);n=o?n.projectionNext:n.next}}function us(e,t,n,r,i,s){cs(n,r,e.firstChild,t,i,s,!1)}function hs(e,t,n,r,i,s){const o=n[16],a=o[6].projection[r.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)Ui(t,e,i,a[l],s);else cs(e,t,a,o[3],i,s,!0)}function ds(e,t,n){kt(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function fs(e,t,n){kt(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function ps(e,t,n){let r=e.length;for(;;){const i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){const n=t.length;if(i+n===r||e.charCodeAt(i+n)<=32)return i}n=i+1}}const gs="ng-template";function ms(e,t,n){let r=0;for(;r<e.length;){let i=e[r++];if(n&&"class"===i){if(i=e[r],-1!==ps(i.toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function ys(e){return 4===e.type&&e.value!==gs}function vs(e,t,n){return t===(4!==e.type||n?e.value:gs)}function Cs(e,t,n){let r=4;const i=e.attrs||[],s=function(e){for(let t=0;t<e.length;t++)if(In(e[t]))return t;return e.length}(i);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&r){if(r=2|1&r,""!==l&&!vs(e,l,n)||""===l&&1===t.length){if(_s(r))return!1;o=!0}}else{const c=8&r?l:t[++a];if(8&r&&null!==e.attrs){if(!ms(e.attrs,c,n)){if(_s(r))return!1;o=!0}continue}const u=Es(8&r?"class":l,i,ys(e),n);if(-1===u){if(_s(r))return!1;o=!0;continue}if(""!==c){let e;e=u>s?"":i[u+1].toLowerCase();const t=8&r?e:null;if(t&&-1!==ps(t,c,0)||2&r&&c!==e){if(_s(r))return!1;o=!0}}}}else{if(!o&&!_s(r)&&!_s(l))return!1;if(o&&_s(l))continue;o=!1,r=l|1&r}}return _s(r)||o}function _s(e){return 0==(1&e)}function Es(e,t,n,r){if(null===t)return-1;let i=0;if(r||!n){let n=!1;for(;i<t.length;){const r=t[i];if(r===e)return i;if(3===r||6===r)n=!0;else{if(1===r||2===r){let e=t[++i];for(;"string"==typeof e;)e=t[++i];continue}if(4===r)break;if(0===r){i+=4;continue}}i+=n?1:2}return-1}return function(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function ws(e,t,n=!1){for(let r=0;r<t.length;r++)if(Cs(e,t[r],n))return!0;return!1}function Ps(e,t){e:for(let n=0;n<t.length;n++){const r=t[n];if(e.length===r.length){for(let t=0;t<e.length;t++)if(e[t]!==r[t])continue e;return!0}}return!1}function Ss(e,t){return e?":not("+t.trim()+")":t}function bs(e){let t=e[0],n=1,r=2,i="",s=!1;for(;n<e.length;){let o=e[n];if("string"==typeof o)if(2&r){const t=e[++n];i+="["+o+(t.length>0?'="'+t+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!_s(o)&&(t+=Ss(s,i),i=""),r=o,s=s||!_s(r);n++}return""!==i&&(t+=Ss(s,i)),t}const Os={};function ks(e){Ts(Ht(),zt(),yn()+e,Qt())}function Ts(e,t,n,r){if(!r)if(3==(3&t[2])){const r=e.preOrderCheckHooks;null!==r&&wn(t,r,n)}else{const r=e.preOrderHooks;null!==r&&Pn(t,r,0,n)}vn(n)}function Is(e,t){return e<<17|t<<2}function As(e){return e>>17&32767}function Ms(e){return 2|e}function Ns(e){return(131068&e)>>2}function Rs(e,t){return-131069&e|t<<2}function xs(e){return 1|e}function Ds(e,t){const n=e.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],s=n[r+1];if(-1!==s){const n=e.data[s];ln(i),n.contentQueries(2,t[s],s)}}}function Ls(e,t,n,r,i,s,o,a,l,c){const u=t.blueprint.slice();return u[0]=i,u[2]=140|r,Ut(u),u[3]=u[15]=e,u[8]=n,u[10]=o||e&&e[10],u[11]=a||e&&e[11],u[12]=l||e&&e[12]||null,u[9]=c||e&&e[9]||null,u[6]=s,u[16]=2==t.type?e[16]:u,u}function Fs(e,t,n,r,i){let s=e.data[t];if(null===s)s=Us(e,t,n,r,i),Bt.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const e=Wt();s.injectorIndex=null===e?-1:e.injectorIndex}return jt(s,!0),s}function Us(e,t,n,r,i){const s=qt(),o=Yt(),a=e.data[t]=function(e,t,n,r,i,s){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=a),null!==s&&(o?null==s.child&&null!==a.parent&&(s.child=a):null===s.next&&(s.next=a)),a}function Vs(e,t,n,r){if(0===n)return-1;const i=t.length;for(let s=0;s<n;s++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function Bs(e,t,n){hn(t);try{const r=e.viewQuery;null!==r&&Co(1,r,n);const i=e.template;null!==i&&Hs(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Ds(e,t),e.staticViewQueries&&Co(2,e.viewQuery,n);const s=e.components;null!==s&&function(e,t){for(let n=0;n<t.length;n++)po(e,t[n])}(t,s)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,mn()}}function $s(e,t,n,r){const i=t[2];if(256==(256&i))return;hn(t);const s=Qt();try{Ut(t),function(e){Bt.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&Hs(e,t,n,2,r);const o=3==(3&i);if(!s)if(o){const n=e.preOrderCheckHooks;null!==n&&wn(t,n,null)}else{const n=e.preOrderHooks;null!==n&&Pn(t,n,0,null),Sn(t,0)}if(function(e){for(let t=Di(e);null!==t;t=Li(t)){if(!t[2])continue;const e=t[9];for(let t=0;t<e.length;t++){const n=e[t],r=n[3];0==(1024&n[2])&&Vt(r,1),n[2]|=1024}}}(t),function(e){for(let t=Di(e);null!==t;t=Li(t))for(let e=10;e<t.length;e++){const n=t[e],r=n[1];Lt(n)&&$s(r,n,r.template,n[8])}}(t),null!==e.contentQueries&&Ds(e,t),!s)if(o){const n=e.contentCheckHooks;null!==n&&wn(t,n)}else{const n=e.contentHooks;null!==n&&Pn(t,n,1),Sn(t,1)}!function(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let e=0;e<n.length;e++){const r=n[e];if(r<0)vn(~r);else{const i=r,s=n[++e],o=n[++e];sn(s,i),o(2,t[i])}}}finally{vn(-1)}}(e,t);const a=e.components;null!==a&&function(e,t){for(let n=0;n<t.length;n++)ho(e,t[n])}(t,a);const l=e.viewQuery;if(null!==l&&Co(2,l,r),!s)if(o){const n=e.viewCheckHooks;null!==n&&wn(t,n)}else{const n=e.viewHooks;null!==n&&Pn(t,n,2),Sn(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),s||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Vt(t[3],-1))}finally{mn()}}function zs(e,t,n,r){const i=t[10],s=!Qt(),o=Dt(t);try{s&&!o&&i.begin&&i.begin(),o&&Bs(e,t,r),$s(e,t,n,r)}finally{s&&!o&&i.end&&i.end()}}function Hs(e,t,n,r,i){const s=yn(),o=2&r;try{vn(-1),o&&t.length>20&&Ts(e,t,20,Qt()),n(r,i)}finally{vn(s)}}function Gs(e,t,n){if(ht(t)){const r=t.directiveEnd;for(let i=t.directiveStart;i<r;i++){const t=e.data[i];t.contentQueries&&t.contentQueries(1,n[i],i)}}}function Zs(e,t,n){!$t()||(function(e,t,n,r){const i=n.directiveStart,s=n.directiveEnd;e.firstCreatePass||Vn(n,t),wi(r,t);const o=n.initialInputs;for(let a=i;a<s;a++){const r=e.data[a],s=pt(r);s&&so(t,n,r);const l=Qn(t,e,a,n);wi(l,t),null!==o&&lo(0,a-i,l,r,0,o),s&&(xt(n.index,t)[8]=l)}}(e,t,n,Mt(n,t)),128==(128&n.flags)&&function(e,t,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=Bt.lFrame.currentDirectiveIndex;try{vn(s);for(let n=r;n<i;n++){const r=e.data[n],i=t[n];on(n),(null!==r.hostBindings||0!==r.hostVars||null!==r.hostAttrs)&&eo(r,i)}}finally{vn(-1),on(o)}}(e,t,n))}function qs(e,t,n=Mt){const r=t.localNames;if(null!==r){let i=t.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(t,e):e[o];e[i++]=a}}}function Ws(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=js(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function js(e,t,n,r,i,s,o,a,l,c){const u=20+r,h=u+i,d=function(e,t){const n=[];for(let r=0;r<t;r++)n.push(r<e?null:Os);return n}(u,h),f="function"==typeof c?c():c;return d[1]={type:e,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:t,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function Ys(e,t,n,r){const i=Eo(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&wo(e).push(r,i.length-1))}function Ks(e,t,n){for(let r in e)if(e.hasOwnProperty(r)){const i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function Qs(e,t,n,r,i,s,o,a){const l=Mt(t,n);let c,u=t.inputs;!a&&null!=u&&(c=u[r])?(So(e,n,c,r,i),dt(t)&&function(e,t){const n=xt(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,kt(s)?s.setProperty(l,r,i):An(r)||(l.setProperty?l.setProperty(r,i):l[r]=i))}function Xs(e,t,n,r){let i=!1;if($t()){const s=function(e,t,n){const r=e.directiveRegistry;let i=null;if(r)for(let s=0;s<r.length;s++){const o=r[s];ws(n,o.selectors,!1)&&(i||(i=[]),Hn(Vn(n,t),e,o.type),pt(o)?(to(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==s){i=!0,ro(n,e.data.length,s.length);for(let e=0;e<s.length;e++){const t=s[e];t.providersResolver&&t.providersResolver(t)}let r=!1,a=!1,l=Vs(e,t,s.length,null);for(let i=0;i<s.length;i++){const c=s[i];n.mergedAttrs=Mn(n.mergedAttrs,c.hostAttrs),io(e,n,t,l,c),no(l,c,o),null!==c.contentQueries&&(n.flags|=8),(null!==c.hostBindings||null!==c.hostAttrs||0!==c.hostVars)&&(n.flags|=128);const u=c.type.prototype;!r&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),r=!0),!a&&(u.ngOnChanges||u.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),a=!0),l++}!function(e,t){const n=t.directiveEnd,r=e.data,i=t.attrs,s=[];let o=null,a=null;for(let l=t.directiveStart;l<n;l++){const e=r[l],n=e.inputs,c=null===i||ys(t)?null:co(n,i);s.push(c),o=Ks(n,l,o),a=Ks(e.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=s,t.inputs=o,t.outputs=a}(e,n)}o&&function(e,t,n){if(t){const r=e.localNames=[];for(let e=0;e<t.length;e+=2){const i=n[t[e+1]];if(null==i)throw new ve("301",`Export of name '${t[e+1]}' not found!`);r.push(t[e],i)}}}(n,r,o)}return n.mergedAttrs=Mn(n.mergedAttrs,n.attrs),i}function Js(e,t,n,r,i,s){const o=s.hostBindings;if(o){let n=e.hostBindingOpCodes;null===n&&(n=e.hostBindingOpCodes=[]);const s=~t.index;(function(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(n)!=s&&n.push(s),n.push(r,i,o)}}function eo(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function to(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function no(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;pt(t)&&(n[""]=e)}}function ro(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function io(e,t,n,r,i){e.data[r]=i;const s=i.factory||(i.factory=mt(i.type)),o=new kn(s,pt(i),null);e.blueprint[r]=o,n[r]=o,Js(e,t,0,r,Vs(e,n,i.hostVars,Os),i)}function so(e,t,n){const r=Mt(t,e),i=Ws(n),s=e[10],o=go(e,Ls(e,i,null,n.onPush?64:16,r,t,s,s.createRenderer(r,n),null,null));e[t.index]=o}function oo(e,t,n,r,i,s){const o=Mt(e,t);ao(t[11],o,s,e.value,n,r,i)}function ao(e,t,n,r,i,s,o){if(null==s)kt(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{const a=null==o?Ce(s):o(s,r||"",i);kt(e)?e.setAttribute(t,i,a,n):n?t.setAttributeNS(n,i,a):t.setAttribute(i,a)}}function lo(e,t,n,r,i,s){const o=s[t];if(null!==o){const e=r.setInput;for(let t=0;t<o.length;){const i=o[t++],s=o[t++],a=o[t++];null!==e?r.setInput(n,a,i,s):n[s]=a}}}function co(e,t){let n=null,r=0;for(;r<t.length;){const i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function uo(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function ho(e,t){const n=xt(t,e);if(Lt(n)){const e=n[1];80&n[2]?$s(e,n,e.template,n[8]):n[5]>0&&fo(n)}}function fo(e){for(let n=Di(e);null!==n;n=Li(n))for(let e=10;e<n.length;e++){const t=n[e];if(1024&t[2]){const e=t[1];$s(e,t,e.template,t[8])}else t[5]>0&&fo(t)}const t=e[1].components;if(null!==t)for(let n=0;n<t.length;n++){const r=xt(t[n],e);Lt(r)&&r[5]>0&&fo(r)}}function po(e,t){const n=xt(t,e),r=n[1];(function(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),Bs(r,n,n[8])}function go(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function mo(e){for(;e;){e[2]|=64;const t=xi(e);if(gt(e)&&!t)return e;e=t}return null}function yo(e,t,n){const r=t[10];r.begin&&r.begin();try{$s(e,t,e.template,n)}catch(i){throw Po(t,i),i}finally{r.end&&r.end()}}function vo(e){!function(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],r=Pi(n),i=r[1];zs(i,r,i.template,n)}}(e[8])}function Co(e,t,n){ln(0),t(e,n)}const _o=(()=>Promise.resolve(null))();function Eo(e){return e[7]||(e[7]=[])}function wo(e){return e.cleanup||(e.cleanup=[])}function Po(e,t){const n=e[9],r=n?n.get(Oi,null):null;r&&r.handleError(t)}function So(e,t,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=t[o],c=e.data[o];null!==c.setInput?c.setInput(l,i,r,a):l[a]=i}}function bo(e,t,n){const r=At(t,e);Bi(e[11],r,n)}function Oo(e,t,n){let r=n?e.styles:null,i=n?e.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const e=t[o];"number"==typeof e?s=e:1==s?i=fe(i,e):2==s&&(r=fe(r,e+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}const ko=new or("INJECTOR",-1);class To{get(e,t=yr){if(t===yr){const t=new Error(`NullInjectorError: No provider for ${de(e)}!`);throw t.name="NullInjectorError",t}return t}}const Io=new or("Set Injector scope."),Ao={},Mo={};let No;function Ro(){return void 0===No&&(No=new To),No}function xo(e,t=null,n=null,r){return new Do(e,n,t||Ro(),r)}class Do{constructor(e,t,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const i=[];t&&ur(t,n=>this.processProvider(n,e,t)),ur([e],e=>this.processInjectorType(e,[],i)),this.records.set(ko,Uo(void 0,this));const s=this.records.get(Io);this.scope=null!=s?s.value:null,this.source=r||("object"==typeof e?null:de(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=yr,n=Ne.Default){this.assertNotDestroyed();const r=Sr(this),i=xe(void 0);try{if(!(n&Ne.SkipSelf)){let t=this.records.get(e);if(void 0===t){const n=("function"==typeof(s=e)||"object"==typeof s&&s instanceof or)&&be(e);t=n&&this.injectableDefInScope(n)?Uo(Lo(e),Ao):null,this.records.set(e,t)}if(null!=t)return this.hydrate(e,t)}return(n&Ne.Self?Ro():this.parent).get(e,t=n&Ne.Optional&&t===yr?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Cr]=o[Cr]||[]).unshift(de(e)),r)throw o;return Ar(o,e,"R3InjectorError",this.source)}throw o}finally{xe(i),Sr(r)}var s}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((t,n)=>e.push(de(n))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,n){if(!(e=me(e)))return!1;let r=ke(e);const i=null==r&&e.ngModule||void 0,s=void 0===i?e:i,o=-1!==n.indexOf(s);if(void 0!==i&&(r=ke(i)),null==r)return!1;if(null!=r.imports&&!o){let e;n.push(s);try{ur(r.imports,r=>{this.processInjectorType(r,t,n)&&(void 0===e&&(e=[]),e.push(r))})}finally{}if(void 0!==e)for(let t=0;t<e.length;t++){const{ngModule:n,providers:r}=e[t];ur(r,e=>this.processProvider(e,n,r||Ge))}}this.injectorDefTypes.add(s);const a=mt(s)||(()=>new s);this.records.set(s,Uo(a,Ao));const l=r.providers;if(null!=l&&!o){const t=e;ur(l,e=>this.processProvider(e,t,l))}return void 0!==i&&void 0!==e.providers}processProvider(e,t,n){let r=Bo(e=me(e))?e:me(e&&e.provide);const i=(s=e,Vo(s)?Uo(void 0,s.useValue):Uo(Fo(s),Ao));var s;if(Bo(e)||!0!==e.multi)this.records.get(r);else{let t=this.records.get(r);t||(t=Uo(void 0,Ao,!0),t.factory=()=>kr(t.multi),this.records.set(r,t)),r=e,t.multi.push(e)}this.records.set(r,i)}hydrate(e,t){return t.value===Ao&&(t.value=Mo,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}injectableDefInScope(e){if(!e.providedIn)return!1;const t=me(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function Lo(e){const t=be(e),n=null!==t?t.factory:mt(e);if(null!==n)return n;if(e instanceof or)throw new Error(`Token ${de(e)} is missing a \u0275prov definition.`);if(e instanceof Function)return function(e){const t=e.length;if(t>0){const n=fr(t,"?");throw new Error(`Can't resolve all parameters for ${de(e)}: (${n.join(", ")}).`)}const n=function(e){const t=e&&(e[Te]||e[Ae]);if(t){const n=function(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new Error("unreachable")}function Fo(e,t,n){let r;if(Bo(e)){const t=me(e);return mt(t)||Lo(t)}if(Vo(e))r=()=>me(e.useValue);else if(function(e){return!(!e||!e.useFactory)}(e))r=()=>e.useFactory(...kr(e.deps||[]));else if(function(e){return!(!e||!e.useExisting)}(e))r=()=>Or(me(e.useExisting));else{const t=me(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return mt(t)||Lo(t);r=()=>new t(...kr(e.deps))}return r}function Uo(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function Vo(e){return null!==e&&"object"==typeof e&&wr in e}function Bo(e){return"function"==typeof e}const $o=function(e,t,n){return function(e,t=null,n=null,r){const i=xo(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)};let zo=(()=>{class e{static create(e,t){return Array.isArray(e)?$o(e,t,""):$o(e.providers,e.parent,e.name||"")}}return e.THROW_IF_NOT_FOUND=yr,e.NULL=new To,e.\u0275prov=Pe({token:e,providedIn:"any",factory:()=>Or(ko)}),e.__NG_ELEMENT_ID__=-1,e})();function Ho(e,t){En(Pi(e)[1],Zt())}function Go(e){let t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const r=[e];for(;t;){let i;if(pt(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);const t=e;t.inputs=Zo(e.inputs),t.declaredInputs=Zo(e.declaredInputs),t.outputs=Zo(e.outputs);const n=i.hostBindings;n&&jo(e,n);const s=i.viewQuery,o=i.contentQueries;if(s&&qo(e,s),o&&Wo(e,o),he(e.inputs,i.inputs),he(e.declaredInputs,i.declaredInputs),he(e.outputs,i.outputs),pt(i)&&i.data.animation){const t=e.data;t.animation=(t.animation||[]).concat(i.data.animation)}}const t=i.features;if(t)for(let r=0;r<t.length;r++){const i=t[r];i&&i.ngInherit&&i(e),i===Go&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){let t=0,n=null;for(let r=e.length-1;r>=0;r--){const i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=Mn(i.hostAttrs,n=Mn(n,i.hostAttrs))}}(r)}function Zo(e){return e===He?{}:e===Ge?[]:e}function qo(e,t){const n=e.viewQuery;e.viewQuery=n?(e,r)=>{t(e,r),n(e,r)}:t}function Wo(e,t){const n=e.contentQueries;e.contentQueries=n?(e,r,i)=>{t(e,r,i),n(e,r,i)}:t}function jo(e,t){const n=e.hostBindings;e.hostBindings=n?(e,r)=>{t(e,r),n(e,r)}:t}let Yo=null;function Ko(){if(!Yo){const e=ze.Symbol;if(e&&e.iterator)Yo=e.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Yo=n)}}}return Yo}class Qo{constructor(e){this.wrapped=e}static wrap(e){return new Qo(e)}static unwrap(e){return Qo.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Qo}}function Xo(e){return!!Jo(e)&&(Array.isArray(e)||!(e instanceof Map)&&Ko()in e)}function Jo(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function ea(e,t,n){return e[t]=n}function ta(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function na(e,t,n,r){const i=ta(e,t,n);return ta(e,t+1,r)||i}function ra(e,t,n,r){const i=zt();return ta(i,tn(),t)&&(Ht(),oo(Cn(),i,e,t,n,r)),ra}function ia(e,t,n,r){return ta(e,tn(),n)?t+Ce(n)+r:Os}function sa(e,t,n,r,i,s){const o=na(e,en(),n,i);return nn(2),o?t+Ce(n)+r+Ce(i)+s:Os}function oa(e,t,n,r,i,s,o,a){const l=function(e,t,n,r,i){const s=na(e,t,n,r);return ta(e,t+2,i)||s}(e,en(),n,i,o);return nn(3),l?t+Ce(n)+r+Ce(i)+s+Ce(o)+a:Os}function aa(e,t,n,r,i,s){const o=zt(),a=ia(o,t,n,r);return a!==Os&&oo(Cn(),o,e,a,i,s),aa}function la(e,t,n,r,i,s,o,a){const l=zt(),c=Ht(),u=e+20,h=c.firstCreatePass?function(e,t,n,r,i,s,o,a,l){const c=t.consts,u=Fs(t,e,4,o||null,Ft(c,a));Xs(t,n,u,Ft(c,l)),En(t,u);const h=u.tViews=js(2,u,r,i,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,u),h.queries=t.queries.embeddedTView(u)),u}(u,c,l,t,n,r,i,s,o):c.data[u];jt(h,!1);const d=l[11].createComment("");is(c,l,d,h),wi(d,l),go(l,l[u]=uo(d,l,d,h)),ft(h)&&Zs(c,l,h),null!=o&&qs(l,h,a)}function ca(e){return Rt(Bt.lFrame.contextLView,20+e)}function ua(e,t=Ne.Default){const n=zt();return null===n?Or(e,t):qn(Zt(),n,me(e),t)}function ha(e,t,n){const r=zt();return ta(r,tn(),t)&&Qs(Ht(),Cn(),r,e,t,r[11],n,!1),ha}function da(e,t,n,r,i){const s=i?"class":"style";So(e,n,t.inputs[s],s,r)}function fa(e,t,n,r){const i=zt(),s=Ht(),o=20+e,a=i[11],l=i[o]=zi(a,t,Bt.lFrame.currentNamespace),c=s.firstCreatePass?function(e,t,n,r,i,s,o){const a=t.consts,l=Fs(t,e,2,i,Ft(a,s));return Xs(t,n,l,Ft(a,o)),null!==l.attrs&&Oo(l,l.attrs,!1),null!==l.mergedAttrs&&Oo(l,l.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,l),l}(o,s,i,0,t,n,r):s.data[o];jt(c,!0);const u=c.mergedAttrs;null!==u&&Tn(a,l,u);const h=c.classes;null!==h&&fs(a,l,h);const d=c.styles;null!==d&&ds(a,l,d),64!=(64&c.flags)&&is(s,i,l,c),0===Bt.lFrame.elementDepthCount&&wi(l,i),Bt.lFrame.elementDepthCount++,ft(c)&&(Zs(s,i,c),Gs(s,c,i)),null!==r&&qs(i,c)}function pa(){let e=Zt();Yt()?Kt():(e=e.parent,jt(e,!1));const t=e;Bt.lFrame.elementDepthCount--;const n=Ht();n.firstCreatePass&&(En(n,e),ht(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&da(n,t,zt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&da(n,t,zt(),t.stylesWithoutHost,!1)}function ga(e,t,n,r){fa(e,t,n,r),pa()}function ma(e,t,n){const r=zt(),i=Ht(),s=e+20,o=i.firstCreatePass?function(e,t,n,r,i){const s=t.consts,o=Ft(s,r),a=Fs(t,e,8,"ng-container",o);return null!==o&&Oo(a,o,!0),Xs(t,n,a,Ft(s,i)),null!==t.queries&&t.queries.elementStart(t,a),a}(s,i,r,t,n):i.data[s];jt(o,!0);const a=r[s]=r[11].createComment("");is(i,r,a,o),wi(a,r),ft(o)&&(Zs(i,r,o),Gs(i,o,r)),null!=n&&qs(r,o)}function ya(){let e=Zt();const t=Ht();Yt()?Kt():(e=e.parent,jt(e,!1)),t.firstCreatePass&&(En(t,e),ht(e)&&t.queries.elementEnd(e))}function va(){return zt()}function Ca(e){return!!e&&"function"==typeof e.then}const _a=function(e){return!!e&&"function"==typeof e.subscribe};function Ea(e,t,n,r){const i=zt(),s=Ht(),o=Zt();return function(e,t,n,r,i,s,o,a){const l=ft(r),c=e.firstCreatePass&&wo(e),u=t[8],h=Eo(t);let d=!0;if(3&r.type||a){const f=Mt(r,t),p=a?a(f):f,g=h.length,m=a?e=>a(It(e[r.index])):r.index;if(kt(n)){let o=null;if(!a&&l&&(o=function(e,t,n,r){const i=e.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const e=i[s];if(e===n&&i[s+1]===r){const e=t[7],n=i[s+2];return e.length>n?e[n]:null}"string"==typeof e&&(s+=2)}return null}(e,t,i,r.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=s,o.__ngLastListenerFn__=s,d=!1;else{s=Pa(r,t,u,s,!1);const e=n.listen(p,i,s);h.push(s,e),c&&c.push(i,m,g,g+1)}}else s=Pa(r,t,u,s,!0),p.addEventListener(i,s,o),h.push(s),c&&c.push(i,m,g,o)}else s=Pa(r,t,u,s,!1);const f=r.outputs;let p;if(d&&null!==f&&(p=f[i])){const e=p.length;if(e)for(let n=0;n<e;n+=2){const e=t[p[n]][p[n+1]].subscribe(s),o=h.length;h.push(s,e),c&&c.push(i,r.index,o,-(o+1))}}}(s,i,i[11],o,e,t,!!n,r),Ea}function wa(e,t,n,r){try{return!1!==n(r)}catch(i){return Po(e,i),!1}}function Pa(e,t,n,r,i){return function n(s){if(s===Function)return r;const o=2&e.flags?xt(e.index,t):t;0==(32&t[2])&&mo(o);let a=wa(t,0,r,s),l=n.__ngNextListenerFn__;for(;l;)a=wa(t,0,l,s)&&a,l=l.__ngNextListenerFn__;return i&&!1===a&&(s.preventDefault(),s.returnValue=!1),a}}function Sa(e=1){return function(e){return(Bt.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Bt.lFrame.contextLView))[8]}(e)}function ba(e,t){let n=null;const r=function(e){const t=e.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(e);for(let i=0;i<t.length;i++){const s=t[i];if("*"!==s){if(null===r?ws(e,s,!0):Ps(r,s))return i}else n=i}return n}function Oa(e,t,n){return ka(e,"",t,"",n),Oa}function ka(e,t,n,r,i){const s=zt(),o=ia(s,t,n,r);return o!==Os&&Qs(Ht(),Cn(),s,e,o,s[11],i,!1),ka}function Ta(e,t,n,r,i,s,o){const a=zt(),l=sa(a,t,n,r,i,s);return l!==Os&&Qs(Ht(),Cn(),a,e,l,a[11],o,!1),Ta}function Ia(e,t,n,r,i,s,o,a,l){const c=zt(),u=oa(c,t,n,r,i,s,o,a);return u!==Os&&Qs(Ht(),Cn(),c,e,u,c[11],l,!1),Ia}function Aa(e,t,n,r,i){const s=e[n+1],o=null===t;let a=r?As(s):Ns(s),l=!1;for(;0!==a&&(!1===l||o);){const n=e[a+1];Ma(e[a],t)&&(l=!0,e[a+1]=r?xs(n):Ms(n)),a=r?As(n):Ns(n)}l&&(e[n+1]=r?Ms(s):xs(s))}function Ma(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&mr(e,t)>=0}const Na={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Ra(e){return e.substring(Na.key,Na.keyEnd)}function xa(e){return e.substring(Na.value,Na.valueEnd)}function Da(e,t){const n=Na.textEnd;let r=Na.key=La(e,t,n);return n===r?-1:(r=Na.keyEnd=function(e,t,n){let r;for(;t<n&&(45===(r=e.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(e,r,n),r=Fa(e,r,n),r=Na.value=La(e,r,n),r=Na.valueEnd=function(e,t,n){let r=-1,i=-1,s=-1,o=t,a=o;for(;o<n;){const l=e.charCodeAt(o++);if(59===l)return a;34===l||39===l?a=o=Ua(e,l,o,n):t===o-4&&85===s&&82===i&&76===r&&40===l?a=o=Ua(e,41,o,n):l>32&&(a=o),s=i,i=r,r=-33&l}return a}(e,r,n),Fa(e,r,n))}function La(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function Fa(e,t,n,r){return(t=La(e,t,n))<n&&t++,t}function Ua(e,t,n,r){let i=-1,s=n;for(;s<r;){const n=e.charCodeAt(s++);if(n==t&&92!==i)return s;i=92==n&&92===i?0:n}throw new Error}function Va(e,t){return function(e,t,n,r){const i=zt(),s=Ht(),o=nn(2);s.firstUpdatePass&&Ha(s,e,o,r),t!==Os&&ta(i,o,t)&&Wa(s,s.data[yn()],i,i[11],e,i[o+1]=function(e,t){return null==e||("string"==typeof t?e+=t:"object"==typeof e&&(e=de(Gr(e)))),e}(t,n),r,o)}(e,t,null,!0),Va}function Ba(e){!function(e,t,n,r){const i=Ht(),s=nn(2);i.firstUpdatePass&&Ha(i,null,s,r);const o=zt();if(n!==Os&&ta(o,s,n)){const a=i.data[yn()];if(Ka(a,r)&&!za(i,s)){let e=r?a.classesWithoutHost:a.stylesWithoutHost;null!==e&&(n=fe(e,n||"")),da(i,a,o,n,r)}else!function(e,t,n,r,i,s,o,a){i===Os&&(i=Ge);let l=0,c=0,u=0<i.length?i[0]:null,h=0<s.length?s[0]:null;for(;null!==u||null!==h;){const d=l<i.length?i[l+1]:void 0,f=c<s.length?s[c+1]:void 0;let p,g=null;u===h?(l+=2,c+=2,d!==f&&(g=h,p=f)):null===h||null!==u&&u<h?(l+=2,g=u):(c+=2,g=h,p=f),null!==g&&Wa(e,t,n,r,g,p,o,a),u=l<i.length?i[l]:null,h=c<s.length?s[c]:null}}(i,a,o,o[11],o[s+1],o[s+1]=function(e,t,n){if(null==n||""===n)return Ge;const r=[],i=Gr(n);if(Array.isArray(i))for(let s=0;s<i.length;s++)e(r,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&e(r,s,i[s]);else"string"==typeof i&&t(r,i);return r}(e,t,n),r,s)}}(qa,$a,e,!1)}function $a(e,t){for(let n=function(e){return function(e){Na.key=0,Na.keyEnd=0,Na.value=0,Na.valueEnd=0,Na.textEnd=e.length}(e),Da(e,La(e,0,Na.textEnd))}(t);n>=0;n=Da(t,n))qa(e,Ra(t),xa(t))}function za(e,t){return t>=e.expandoStartIndex}function Ha(e,t,n,r){const i=e.data;if(null===i[n+1]){const s=i[yn()],o=za(e,n);Ka(s,r)&&null===t&&!o&&(t=!1),t=function(e,t,n,r){const i=function(e){const t=Bt.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let s=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(n=Za(n=Ga(null,e,t,n,r),t.attrs,r),s=null);else{const o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=Ga(i,e,t,n,r),null===s){let n=function(e,t,n){const r=n?t.classBindings:t.styleBindings;if(0!==Ns(r))return e[As(r)]}(e,t,r);void 0!==n&&Array.isArray(n)&&(n=Ga(null,e,t,n[1],r),n=Za(n,t.attrs,r),function(e,t,n,r){e[As(n?t.classBindings:t.styleBindings)]=r}(e,t,r,n))}else s=function(e,t,n){let r;const i=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<i;s++)r=Za(r,e[s].hostAttrs,n);return Za(r,t.attrs,n)}(e,t,r)}return void 0!==s&&(r?t.residualClasses=s:t.residualStyles=s),n}(i,s,t,r),function(e,t,n,r,i,s){let o=s?t.classBindings:t.styleBindings,a=As(o),l=Ns(o);e[r]=n;let c,u=!1;if(Array.isArray(n)){const e=n;c=e[1],(null===c||mr(e,c)>0)&&(u=!0)}else c=n;if(i)if(0!==l){const t=As(e[a+1]);e[r+1]=Is(t,a),0!==t&&(e[t+1]=Rs(e[t+1],r)),e[a+1]=function(e,t){return 131071&e|t<<17}(e[a+1],r)}else e[r+1]=Is(a,0),0!==a&&(e[a+1]=Rs(e[a+1],r)),a=r;else e[r+1]=Is(l,0),0===a?a=r:e[l+1]=Rs(e[l+1],r),l=r;u&&(e[r+1]=Ms(e[r+1])),Aa(e,c,r,!0),Aa(e,c,r,!1),function(e,t,n,r,i){const s=i?e.residualClasses:e.residualStyles;null!=s&&"string"==typeof t&&mr(s,t)>=0&&(n[r+1]=xs(n[r+1]))}(t,c,e,r,s),o=Is(a,l),s?t.classBindings=o:t.styleBindings=o}(i,s,t,n,o,r)}}function Ga(e,t,n,r,i){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=t[a],r=Za(r,s.hostAttrs,i),s!==e);)a++;return null!==e&&(n.directiveStylingLast=a),r}function Za(e,t,n){const r=n?1:2;let i=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),pr(e,o,!!n||t[++s]))}return void 0===e?null:e}function qa(e,t,n){pr(e,t,Gr(n))}function Wa(e,t,n,r,i,s,o,a){if(!(3&t.type))return;const l=e.data,c=l[a+1];Ya(function(e){return 1==(1&e)}(c)?ja(l,t,n,i,Ns(c),o):void 0)||(Ya(s)||function(e){return 2==(2&e)}(c)&&(s=ja(l,null,n,i,a,o)),function(e,t,n,r,i){const s=kt(e);if(t)i?s?e.addClass(n,r):n.classList.add(r):s?e.removeClass(n,r):n.classList.remove(r);else{let t=-1===r.indexOf("-")?void 0:Mi.DashCase;if(null==i)s?e.removeStyle(n,r,t):n.style.removeProperty(r);else{const o="string"==typeof i&&i.endsWith("!important");o&&(i=i.slice(0,-10),t|=Mi.Important),s?e.setStyle(n,r,i,t):n.style.setProperty(r,i,o?"important":"")}}}(r,o,At(yn(),n),i,s))}function ja(e,t,n,r,i,s){const o=null===t;let a;for(;i>0;){const t=e[i],s=Array.isArray(t),l=s?t[1]:t,c=null===l;let u=n[i+1];u===Os&&(u=c?Ge:void 0);let h=c?gr(u,r):l===r?u:void 0;if(s&&!Ya(h)&&(h=gr(t,r)),Ya(h)&&(a=h,o))return a;const d=e[i+1];i=o?As(d):Ns(d)}if(null!==t){let e=s?t.residualClasses:t.residualStyles;null!=e&&(a=gr(e,r))}return a}function Ya(e){return void 0!==e}function Ka(e,t){return 0!=(e.flags&(t?16:32))}function Qa(e,t=""){const n=zt(),r=Ht(),i=e+20,s=r.firstCreatePass?Fs(r,i,1,t,null):r.data[i],o=n[i]=Vi(n[11],t);is(r,n,o,s),jt(s,!1)}function Xa(e){return Ja("",e,""),Xa}function Ja(e,t,n){const r=zt(),i=ia(r,e,t,n);return i!==Os&&bo(r,yn(),i),Ja}function el(e,t,n,r,i){const s=zt(),o=sa(s,e,t,n,r,i);return o!==Os&&bo(s,yn(),o),el}function tl(e,t,n,r,i,s,o){const a=zt(),l=oa(a,e,t,n,r,i,s,o);return l!==Os&&bo(a,yn(),l),tl}function nl(e,t,n){const r=zt();return ta(r,tn(),t)&&Qs(Ht(),Cn(),r,e,t,r[11],n,!0),nl}const rl=void 0;var il=["en",[["a","p"],["AM","PM"],rl],[["AM","PM"],rl,rl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],rl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],rl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",rl,"{1} 'at' {0}",rl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){const t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let sl={};function ol(e){const t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e);let n=ll(t);if(n)return n;const r=t.split("-")[0];if(n=ll(r),n)return n;if("en"===r)return il;throw new Error(`Missing locale data for the locale "${e}".`)}function al(e){return ol(e)[cl.PluralCase]}function ll(e){return e in sl||(sl[e]=ze.ng&&ze.ng.common&&ze.ng.common.locales&&ze.ng.common.locales[e]),sl[e]}var cl=(()=>((cl=cl||{})[cl.LocaleId=0]="LocaleId",cl[cl.DayPeriodsFormat=1]="DayPeriodsFormat",cl[cl.DayPeriodsStandalone=2]="DayPeriodsStandalone",cl[cl.DaysFormat=3]="DaysFormat",cl[cl.DaysStandalone=4]="DaysStandalone",cl[cl.MonthsFormat=5]="MonthsFormat",cl[cl.MonthsStandalone=6]="MonthsStandalone",cl[cl.Eras=7]="Eras",cl[cl.FirstDayOfWeek=8]="FirstDayOfWeek",cl[cl.WeekendRange=9]="WeekendRange",cl[cl.DateFormat=10]="DateFormat",cl[cl.TimeFormat=11]="TimeFormat",cl[cl.DateTimeFormat=12]="DateTimeFormat",cl[cl.NumberSymbols=13]="NumberSymbols",cl[cl.NumberFormats=14]="NumberFormats",cl[cl.CurrencyCode=15]="CurrencyCode",cl[cl.CurrencySymbol=16]="CurrencySymbol",cl[cl.CurrencyName=17]="CurrencyName",cl[cl.Currencies=18]="Currencies",cl[cl.Directionality=19]="Directionality",cl[cl.PluralCase=20]="PluralCase",cl[cl.ExtraData=21]="ExtraData",cl))();const ul=["zero","one","two","few","many"],hl="en-US",dl={marker:"element"},fl={marker:"ICU"};var pl=(()=>((pl=pl||{})[pl.SHIFT=2]="SHIFT",pl[pl.APPEND_EAGERLY=1]="APPEND_EAGERLY",pl[pl.COMMENT=2]="COMMENT",pl))();let gl=hl;function ml(e){(function(e,t){null==e&&we(t,e,null,"!=")})(e,"Expected localeId to be defined"),"string"==typeof e&&(gl=e.toLowerCase().replace(/_/g,"-"))}function yl(e,t,n){const r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?es(e,0,n):It(n[i])}function vl(e,t,n,r,i){const s=t.insertBeforeIndex;if(Array.isArray(s)){let o=r,a=null;if(3&t.type||(a=o,o=i),null!==o&&0==(2&t.flags))for(let t=1;t<s.length;t++)Yi(e,o,n[s[t]],a,!1)}}function Cl(e,t){if(e.push(t),e.length>1)for(let n=e.length-2;n>=0;n--){const r=e[n];_l(r)||El(r,t)&&null===wl(r)&&Pl(r,t.index)}}function _l(e){return!(64&e.type)}function El(e,t){return _l(t)||e.index>t.index}function wl(e){const t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function Pl(e,t){const n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(rs(yl,vl),e.insertBeforeIndex=t)}function Sl(e,t){const n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function bl(e,t,n){const r=Us(e,n,64,null,null);return Cl(t,r),r}function Ol(e,t){const n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function kl(e){return e>>>17}function Tl(e){return(131070&e)>>>1}let Il=0,Al=0;function Ml(e,t,n,r){const i=n[11];let s,o=null;for(let a=0;a<t.length;a++){const l=t[a];if("string"==typeof l){const e=t[++a];null===n[e]&&(n[e]=Vi(i,l))}else if("number"==typeof l)switch(1&l){case 0:const c=kl(l);let u,h;if(null===o&&(o=c,s=Xi(i,r)),c===o?(u=r,h=s):(u=null,h=It(n[c])),null!==h){const t=Tl(l);Yi(i,h,n[t],u,!1);const r=Sl(e,t);if(null!==r&&"object"==typeof r){const t=Ol(r,n);null!==t&&Ml(e,r.create[t],n,n[r.anchorIdx])}}break;case 1:const d=t[++a],f=t[++a];ao(i,At(l>>>1,n),null,null,d,f,null);break;default:throw new Error(`Unable to determine the type of mutate operation for "${l}"`)}else switch(l){case fl:const e=t[++a],r=t[++a];null===n[r]&&wi(n[r]=$i(i,e),n);break;case dl:const s=t[++a],o=t[++a];null===n[o]&&wi(n[o]=zi(i,s,null),n)}}}function Nl(e,t,n,r,i){for(let s=0;s<n.length;s++){const o=n[s],a=n[++s];if(o&i){let i="";for(let o=s+1;o<=s+a;o++){const s=n[o];if("string"==typeof s)i+=s;else if("number"==typeof s)if(s<0)i+=Ce(t[r-s]);else{const a=s>>>2;switch(3&s){case 1:const s=n[++o],l=n[++o],c=e.data[a];"string"==typeof c?ao(t[11],t[a],null,c,s,i,l):Qs(e,c,t,s,i,t[11],l,!1);break;case 0:const u=t[a];null!==u&&Bi(t[11],u,i);break;case 2:xl(e,Sl(e,a),t,i);break;case 3:Rl(e,Sl(e,a),r,t)}}}}else{const i=n[s+1];if(i>0&&3==(3&i)){const n=Sl(e,i>>>2);t[n.currentCaseLViewIndex]<0&&Rl(e,n,r,t)}}s+=a}}function Rl(e,t,n,r){let i=r[t.currentCaseLViewIndex];if(null!==i){let s=Il;i<0&&(i=r[t.currentCaseLViewIndex]=~i,s=-1),Nl(e,r,t.update[i],n,s)}}function xl(e,t,n,r){const i=function(e,t){let n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:{const r=function(e,t){const n=al(t)(parseInt(e,10)),r=ul[n];return void 0!==r?r:"other"}(t,gl);n=e.cases.indexOf(r),-1===n&&"other"!==r&&(n=e.cases.indexOf("other"));break}case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(Ol(t,n)!==i&&(Dl(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){const r=n[t.anchorIdx];r&&Ml(e,t.create[i],n,r)}}function Dl(e,t,n){let r=Ol(t,n);if(null!==r){const i=t.remove[r];for(let t=0;t<i.length;t++){const r=i[t];if(r>0){const e=At(r,n);null!==e&&ls(n[11],e)}else Dl(e,Sl(e,~r),n)}}}function Ll(){const e=[];let t,n,r=-1;function i(e,t){r=0;const i=Ol(e,t);n=null!==i?e.remove[i]:Ge}function s(){if(r<n.length){const o=n[r++];return o>0?t[o]:(e.push(r,n),i(t[1].data[~o],t),s())}return 0===e.length?null:(n=e.pop(),r=e.pop(),s())}return function(n,r){for(t=r;e.length;)e.pop();return i(n.value,r),s}}const Fl=/\ufffd(\d+):?\d*\ufffd/gi,Ul=/\ufffd(\d+)\ufffd/,Vl=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,Bl=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,$l=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,zl=/\uE500/g;function Hl(e,t,n,r,i,s,o){const a=Vs(e,r,1,null);let l=a<<pl.SHIFT,c=Wt();t===c&&(c=null),null===c&&(l|=pl.APPEND_EAGERLY),o&&(l|=pl.COMMENT,function(e){void 0===Ni&&(Ni=e())}(Ll)),i.push(l,null===s?"":s);const u=Us(e,a,o?32:1,null===s?"":s,null);Cl(n,u);const h=u.index;return jt(u,!1),null!==c&&t!==c&&function(e,t){let n=e.insertBeforeIndex;null===n?(rs(yl,vl),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){e!=t&&we(n,e,t,"==")}(Array.isArray(n),!0,"Expecting array here"),n.push(t))}(c,h),u}function Gl(e,t,n,r,i,s,o){const a=o.match(Fl),l=Hl(e,t,n,s,r,a?null:o,!1);a&&Zl(i,o,l.index,null,0,null)}function Zl(e,t,n,r,i,s){const o=e.length,a=o+1;e.push(null,null);const l=o+2,c=t.split(Fl);let u=0;for(let h=0;h<c.length;h++){const t=c[h];if(1&h){const n=i+parseInt(t,10);e.push(-1-n),u|=ql(n)}else""!==t&&e.push(t)}return e.push(n<<2|(r?1:0)),r&&e.push(r,s),e[o]=u,e[a]=e.length-l,u}function ql(e){return 1<<Math.min(e,31)}function Wl(e){let t,n,r="",i=0,s=!1;for(;null!==(t=Bl.exec(e));)s?t[0]===`\ufffd/*${n}\ufffd`&&(i=t.index,s=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],s=!0);return r+=e.substr(i),r}function jl(e,t,n,r,i,s){let o=0;const a={type:i.type,currentCaseLViewIndex:Vs(e,t,1,null),anchorIdx:s,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(ql(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,s),function(e,t,n){const r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,s,a);const l=i.values;for(let c=0;c<l.length;c++){const s=l[c],u=[];for(let e=0;e<s.length;e++){const t=s[e];if("string"!=typeof t){const n=u.push(t)-1;s[e]=`\x3c!--\ufffd${n}\ufffd--\x3e`}}o=Ql(e,a,t,n,r,i.cases[c],s.join(""),u)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,s)}function Yl(e){const t=[],n=[];let r=1,i=0;const s=Kl(e=e.replace(Vl,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""}));for(let o=0;o<s.length;){let e=s[o++].trim();1===r&&(e=e.replace(/\s*(?:=)?(\w+)\s*/,"$1")),e.length&&t.push(e);const i=Kl(s[o++]);t.length>n.length&&n.push(i)}return{type:r,mainBinding:i,cases:t,values:n}}function Kl(e){if(!e)return[];let t=0;const n=[],r=[],i=/[{}]/g;let s;for(i.lastIndex=0;s=i.exec(e);){const i=s.index;if("}"==s[0]){if(n.pop(),0==n.length){const n=e.substring(t,i);Vl.test(n)?r.push(Yl(n)):r.push(n),t=i+1}}else{if(0==n.length){const n=e.substring(t,i);r.push(n),t=i+1}n.push("{")}}const o=e.substring(t);return r.push(o),r}function Ql(e,t,n,r,i,s,o,a){const l=[],c=[],u=[];t.cases.push(s),t.create.push(l),t.remove.push(c),t.update.push(u);const h=Wr(Ot()).getInertBodyElement(o),d=mi(h)||h;return d?Xl(e,t,n,r,l,c,u,d,i,a,0):0}function Xl(e,t,n,r,i,s,o,a,l,c,u){let h=0,d=a.firstChild;for(;d;){const a=Vs(e,n,1,null);switch(d.nodeType){case Node.ELEMENT_NODE:const f=d,p=f.tagName.toLowerCase();if(si.hasOwnProperty(p)){tc(i,dl,p,l,a),e.data[a]=p;const g=f.attributes;for(let e=0;e<g.length;e++){const t=g.item(e),n=t.name.toLowerCase();t.value.match(Fl)?li.hasOwnProperty(n)&&Zl(o,t.value,a,t.name,0,oi[n]?Xr:ai[n]?Jr:null):nc(i,a,t)}h=Xl(e,t,n,r,i,s,o,d,a,c,u+1)|h,Jl(s,a,u)}break;case Node.TEXT_NODE:const g=d.textContent||"",m=g.match(Fl);tc(i,null,m?"":g,l,a),Jl(s,a,u),m&&(h=Zl(o,g,a,null,0,null)|h);break;case Node.COMMENT_NODE:const y=Ul.exec(d.textContent||"");if(y){const t=c[parseInt(y[1],10)];tc(i,fl,"",l,a),jl(e,n,r,l,t,a),ec(s,a,u)}}d=d.nextSibling}return h}function Jl(e,t,n){0===n&&e.push(t)}function ec(e,t,n){0===n&&(e.push(~t),e.push(t))}function tc(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function nc(e,t,n){e.push(t<<1|1,n.name,n.value)}function rc(e,t,n=-1){const r=Ht(),i=zt(),s=20+e,o=Ft(r.consts,t),a=Wt();r.firstCreatePass&&function(e,t,n,r,i,s){const o=Wt(),a=[],l=[],c=[[]];i=function(e,t){if(function(e){return-1===e}(t))return Wl(e);{const n=e.indexOf(`:${t}\ufffd`)+2+t.toString().length,r=e.search(new RegExp(`\ufffd\\/\\*\\d+:${t}\ufffd`));return Wl(e.substring(n,r))}}(i,s);const u=function(e){return e.replace(zl," ")}(i).split($l);for(let h=0;h<u.length;h++){let r=u[h];if(0==(1&h)){const s=Kl(r);for(let r=0;r<s.length;r++){let u=s[r];if(0==(1&r)){const t=u;""!==t&&Gl(e,o,c[0],a,l,n,t)}else{const r=u;if("object"!=typeof r)throw new Error(`Unable to parse ICU expression in "${i}" message.`);jl(e,n,l,t,r,Hl(e,o,c[0],n,a,"",!0).index)}}}else{const t=47===r.charCodeAt(0),n=(r.charCodeAt(t?1:0),20+Number.parseInt(r.substring(t?2:1)));if(t)c.shift(),jt(Wt(),!1);else{const t=bl(e,c[0],n);c.unshift([]),jt(t,!0)}}}e.data[r]={create:a,update:l}}(r,null===a?0:a.index,i,s,o,n);const l=r.data[s],c=ji(r,a===i[6]?null:a,i);(function(e,t,n,r){const i=e[11];for(let s=0;s<t.length;s++){const o=t[s++],a=t[s],l=(o&pl.COMMENT)===pl.COMMENT,c=(o&pl.APPEND_EAGERLY)===pl.APPEND_EAGERLY,u=o>>>pl.SHIFT;let h=e[u];null===h&&(h=e[u]=l?i.createComment(a):Vi(i,a)),c&&null!==n&&Yi(i,n,h,r,!1)}})(i,l.create,c,a&&8&a.type?i[a.index]:null),rn(!0)}function ic(){rn(!1)}function sc(e,t,n){rc(e,t,n),ic()}function oc(e){return function(e){e&&(Il|=1<<Math.min(Al,31)),Al++}(ta(zt(),tn(),e)),oc}function ac(e){!function(e,t,n){if(Al>0){const r=e.data[n];Nl(e,t,Array.isArray(r)?r:r.update,en()-Al-1,Il)}Il=0,Al=0}(Ht(),zt(),e+20)}function lc(e,t,n,r,i){if(e=me(e),Array.isArray(e))for(let s=0;s<e.length;s++)lc(e[s],t,n,r,i);else{const s=Ht(),o=zt();let a=Bo(e)?e:me(e.provide),l=Fo(e);const c=Zt(),u=1048575&c.providerIndexes,h=c.directiveStart,d=c.providerIndexes>>20;if(Bo(e)||!e.multi){const r=new kn(l,i,ua),f=hc(a,t,i?u:u+d,h);-1===f?(Hn(Vn(c,o),s,a),cc(s,e,t.length),t.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(r),o.push(r)):(n[f]=r,o[f]=r)}else{const f=hc(a,t,u+d,h),p=hc(a,t,u,u+d),g=f>=0&&n[f],m=p>=0&&n[p];if(i&&!m||!i&&!g){Hn(Vn(c,o),s,a);const u=function(e,t,n,r,i){const s=new kn(e,n,ua);return s.multi=[],s.index=t,s.componentProviders=0,uc(s,i,r&&!n),s}(i?fc:dc,n.length,i,r,l);!i&&m&&(n[p].providerFactory=u),cc(s,e,t.length,0),t.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(u),o.push(u)}else cc(s,e,f>-1?f:p,uc(n[i?p:f],l,!i&&r));!i&&r&&m&&n[p].componentProviders++}}}function cc(e,t,n,r){const i=Bo(t);if(i||function(e){return!!e.useClass}(t)){const s=(t.useClass||t).prototype.ngOnDestroy;if(s){const o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){const e=o.indexOf(n);-1===e?o.push(n,[r,s]):o[e+1].push(r,s)}else o.push(n,s)}}}function uc(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function hc(e,t,n,r){for(let i=n;i<r;i++)if(t[i]===e)return i;return-1}function dc(e,t,n,r){return pc(this.multi,[])}function fc(e,t,n,r){const i=this.multi;let s;if(this.providerFactory){const e=this.providerFactory.componentProviders,t=Qn(n,n[1],this.providerFactory.index,r);s=t.slice(0,e),pc(i,s);for(let n=e;n<t.length;n++)s.push(t[n])}else s=[],pc(i,s);return s}function pc(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function gc(e,t=[]){return n=>{n.providersResolver=(n,r)=>function(e,t,n){const r=Ht();if(r.firstCreatePass){const i=pt(e);lc(n,r.data,r.blueprint,i,!0),lc(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}class mc{}const yc="ngComponent";class vc{resolveComponentFactory(e){throw function(e){const t=Error(`No component factory found for ${de(e)}. Did you add it to @NgModule.entryComponents?`);return t[yc]=e,t}(e)}}let Cc=(()=>{class e{}return e.NULL=new vc,e})();function _c(...e){}function Ec(e,t){return new Pc(Mt(e,t))}const wc=function(){return Ec(Zt(),zt())};let Pc=(()=>{class e{constructor(e){this.nativeElement=e}}return e.__NG_ELEMENT_ID__=wc,e})();function Sc(e){return e instanceof Pc?e.nativeElement:e}class bc{}let Oc=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>kc(),e})();const kc=function(){const e=zt(),t=xt(Zt().index,e);return function(e){return e[11]}(ct(t)?t:e)};let Tc=(()=>{class e{}return e.\u0275prov=Pe({token:e,providedIn:"root",factory:()=>null}),e})();class Ic{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Ac=new Ic("12.2.16");class Mc{constructor(){}supports(e){return Xo(e)}create(e){return new Rc(e)}}const Nc=(e,t)=>t;class Rc{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Nc}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,i=null;for(;t||n;){const s=!n||t&&t.currentIndex<Fc(n,r,i)?t:n,o=Fc(s,r,i),a=s.currentIndex;if(s===n)r--,n=n._nextRemoved;else if(t=t._next,null==s.previousIndex)r++;else{i||(i=[]);const e=o-r,t=a-r;if(e!=t){for(let n=0;n<e;n++){const r=n<i.length?i[n]:i[n]=0,s=r+n;t<=s&&s<e&&(i[n]=r+1)}i[s.previousIndex]=t-e}}o!==a&&e(s,o,a)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Xo(e))throw new Error(`Error trying to diff '${de(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t,n,r,i=this._itHead,s=!1;if(Array.isArray(e)){this.length=e.length;for(let t=0;t<this.length;t++)n=e[t],r=this._trackByFn(t,n),null!==i&&Object.is(i.trackById,r)?(s&&(i=this._verifyReinsertion(i,n,r,t)),Object.is(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,t),s=!0),i=i._next}else t=0,function(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[Ko()]();let r;for(;!(r=n.next()).done;)t(r.value)}}(e,e=>{r=this._trackByFn(t,e),null!==i&&Object.is(i.trackById,r)?(s&&(i=this._verifyReinsertion(i,e,r,t)),Object.is(i.item,e)||this._addIdentityChange(i,e)):(i=this._mismatch(i,e,r,t),s=!0),i=i._next,t++}),this.length=t;return this._truncate(i),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new xc(t,n),i,r),e}_verifyReinsertion(e,t,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new Lc),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Lc),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class xc{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Dc{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class Lc{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new Dc,this.map.set(t,n)),n.add(e)}get(e,t){const n=this.map.get(e);return n?n.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Fc(e,t,n){const r=e.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+t+i}class Uc{constructor(){}supports(e){return e instanceof Map||Jo(e)}create(){return new Vc}}class Vc{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Jo(e)))throw new Error(`Error trying to diff '${de(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(e,n)=>{if(t&&t.key===n)this._maybeAddToChanges(t,e),this._appendAfter=t,t=t._next;else{const r=this._getOrCreateRecordForKey(n,e);t=this._insertBeforeOrAppend(t,r)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let e=t;null!==e;e=e._nextRemoved)e===this._mapHead&&(this._mapHead=null),this._records.delete(e.key),e._nextRemoved=e._next,e.previousValue=e.currentValue,e.currentValue=null,e._prev=null,e._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const n=this._records.get(e);this._maybeAddToChanges(n,t);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new Bc(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class Bc{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function $c(){return new zc([new Mc])}let zc=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(null!=n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>e.create(t,n||$c()),deps:[[e,new Rr,new Nr]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(null!=t)return t;throw new Error(`Cannot find a differ supporting object '${e}' of type '${function(e){return e.name||typeof e}(e)}'`)}}return e.\u0275prov=Pe({token:e,providedIn:"root",factory:$c}),e})();function Hc(){return new Gc([new Uc])}let Gc=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>e.create(t,n||Hc()),deps:[[e,new Rr,new Nr]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(t)return t;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return e.\u0275prov=Pe({token:e,providedIn:"root",factory:Hc}),e})();function Zc(e,t,n,r,i=!1){for(;null!==n;){const s=t[n.index];if(null!==s&&r.push(It(s)),ut(s))for(let e=10;e<s.length;e++){const t=s[e],n=t[1].firstChild;null!==n&&Zc(t[1],t,n,r)}const o=n.type;if(8&o)Zc(e,t,n.child,r);else if(32&o){const e=Ri(n,t);let i;for(;i=e();)r.push(i)}else if(16&o){const e=os(t,n);if(Array.isArray(e))r.push(...e);else{const n=xi(t[16]);Zc(n[1],n,e,r,!0)}}n=i?n.projectionNext:n.next}return r}class qc{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Zc(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(ut(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(Gi(e,n),dr(t,n))}this._attachedToViewContainer=!1}Zi(this._lView[1],this._lView)}onDestroy(e){Ys(this._lView[1],this._lView,null,e)}markForCheck(){mo(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){yo(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(e,t,n){Xt(!0);try{yo(e,t,n)}finally{Xt(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var e;this._appRef=null,us(this._lView[1],e=this._lView,e[11],2,null,null)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class Wc extends qc{constructor(e){super(e),this._view=e}detectChanges(){vo(this._view)}checkNoChanges(){!function(e){Xt(!0);try{vo(e)}finally{Xt(!1)}}(this._view)}get context(){return null}}const jc=function(e){return function(e,t,n){if(dt(e)&&!n){const n=xt(e.index,t);return new qc(n,n)}return 47&e.type?new qc(t[16],t):null}(Zt(),zt(),16==(16&e))};let Yc=(()=>{class e{}return e.__NG_ELEMENT_ID__=jc,e})();const Kc=[new Uc],Qc=new zc([new Mc]),Xc=new Gc(Kc),Jc=function(){return ru(Zt(),zt())};let eu=(()=>{class e{}return e.__NG_ELEMENT_ID__=Jc,e})();const tu=eu,nu=class extends tu{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e){const t=this._declarationTContainer.tViews,n=Ls(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),Bs(t,n,e),new qc(n)}};function ru(e,t){return 4&e.type?new nu(t,e,Ec(e,t)):null}class iu{}class su{}const ou=function(){return du(Zt(),zt())};let au=(()=>{class e{}return e.__NG_ELEMENT_ID__=ou,e})();const lu=au,cu=class extends lu{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Ec(this._hostTNode,this._hostLView)}get injector(){return new er(this._hostTNode,this._hostLView)}get parentInjector(){const e=zn(this._hostTNode,this._hostLView);if(Rn(e)){const t=Dn(e,this._hostLView),n=xn(e);return new er(t[1].data[n+8],t)}return new er(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=uu(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,n){const r=e.createEmbeddedView(t||{});return this.insert(r,n),r}createComponent(e,t,n,r,i){const s=n||this.parentInjector;if(!i&&null==e.ngModule&&s){const e=s.get(iu,null);e&&(i=e)}const o=e.create(s,r,void 0,i);return this.insert(o.hostView,t),o}insert(e,t){const n=e._lView,r=n[1];if(ut(n[3])){const t=this.indexOf(e);if(-1!==t)this.detach(t);else{const t=n[3],r=new cu(t,t[6],t[3]);r.detach(r.indexOf(e))}}const i=this._adjustIndex(t),s=this._lContainer;!function(e,t,n,r){const i=10+r,s=n.length;r>0&&(n[i-1][4]=t),r<s-10?(t[4]=n[i],hr(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;const o=t[17];null!==o&&n!==o&&function(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(r,n,s,i);const o=as(i,s),a=n[11],l=Xi(a,s[7]);return null!==l&&function(e,t,n,r,i,s){r[0]=i,r[6]=t,us(e,r,n,1,i,s)}(r,s[6],a,n,l,o),e.attachToViewContainerRef(),hr(hu(s),i,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=uu(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=Gi(this._lContainer,t);n&&(dr(hu(this._lContainer),t),Zi(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=Gi(this._lContainer,t);return n&&null!=dr(hu(this._lContainer),t)?new qc(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function uu(e){return e[8]}function hu(e){return e[8]||(e[8]=[])}function du(e,t){let n;const r=t[e.index];if(ut(r))n=r;else{let i;if(8&e.type)i=It(r);else{const n=t[11];i=n.createComment("");const r=Mt(e,t);Yi(n,Xi(n,r),i,function(e,t){return kt(e)?e.nextSibling(t):t.nextSibling}(n,r),!1)}t[e.index]=n=uo(r,t,i,e),go(t,n)}return new cu(n,e,t)}const fu={};class pu extends Cc{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=at(e);return new yu(t,this.ngModule)}}function gu(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}const mu=new or("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Ii});class yu extends mc{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=e.selectors.map(bs).join(","),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return gu(this.componentDef.inputs)}get outputs(){return gu(this.componentDef.outputs)}create(e,t,n,r){const i=(r=r||this.ngModule)?function(e,t){return{get:(n,r,i)=>{const s=e.get(n,fu,i);return s!==fu||r===fu?s:t.get(n,r,i)}}}(e,r.injector):e,s=i.get(bc,Tt),o=i.get(Tc,null),a=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",c=n?function(e,t,n){if(kt(e))return e.selectRootElement(t,n===Ue.ShadowDom);let r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(a,n,this.componentDef.encapsulation):zi(s.createRenderer(null,this.componentDef),l,function(e){const t=e.toLowerCase();return"svg"===t?St:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),u=this.componentDef.onPush?576:528,h=function(e,t){return{components:[],scheduler:e||Ii,clean:_o,playerHandler:t||null,flags:0}}(),d=js(0,null,null,1,0,null,null,null,null,null),f=Ls(null,d,h,u,null,null,s,a,o,i);let p,g;hn(f);try{const e=function(e,t,n,r,i,s){const o=n[1];n[20]=e;const a=Fs(o,20,2,"#host",null),l=a.mergedAttrs=t.hostAttrs;null!==l&&(Oo(a,l,!0),null!==e&&(Tn(i,e,l),null!==a.classes&&fs(i,e,a.classes),null!==a.styles&&ds(i,e,a.styles)));const c=r.createRenderer(e,t),u=Ls(n,Ws(t),null,t.onPush?64:16,n[20],a,r,c,s||null,null);return o.firstCreatePass&&(Hn(Vn(a,n),o,t.type),to(o,a),ro(a,n.length,1)),go(n,u),n[20]=u}(c,this.componentDef,f,s,a);if(c)if(n)Tn(a,c,["ng-version",Ac.full]);else{const{attrs:e,classes:t}=function(e){const t=[],n=[];let r=1,i=2;for(;r<e.length;){let s=e[r];if("string"==typeof s)2===i?""!==s&&t.push(s,e[++r]):8===i&&n.push(s);else{if(!_s(i))break;i=s}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);e&&Tn(a,c,e),t&&t.length>0&&fs(a,c,t.join(" "))}if(g=Nt(d,20),void 0!==t){const e=g.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const r=t[n];e.push(null!=r?Array.from(r):null)}}p=function(e,t,n,r,i){const s=n[1],o=function(e,t,n){const r=Zt();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),io(e,r,t,Vs(e,t,1,null),n));const i=Qn(t,e,r.directiveStart,r);wi(i,t);const s=Mt(r,t);return s&&wi(s,t),i}(s,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(e=>e(o,t)),t.contentQueries){const e=Zt();t.contentQueries(1,o,e.directiveStart)}const a=Zt();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(vn(a.index),Js(n[1],a,0,a.directiveStart,a.directiveEnd,t),eo(t,o)),o}(e,this.componentDef,f,h,[Ho]),Bs(d,f,null)}finally{mn()}return new vu(this.componentType,p,Ec(g,f),f,g)}}class vu extends class{}{constructor(e,t,n,r,i){super(),this.location=n,this._rootLView=r,this._tNode=i,this.instance=t,this.hostView=this.changeDetectorRef=new Wc(r),this.componentType=e}get injector(){return new er(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const Cu=new Map;class _u extends iu{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new pu(this);const n=lt(e),r=e[Ye]||null;r&&ml(r),this._bootstrapComponents=Ai(n.bootstrap),this._r3Injector=xo(e,t,[{provide:iu,useValue:this},{provide:Cc,useValue:this.componentFactoryResolver}],de(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=zo.THROW_IF_NOT_FOUND,n=Ne.Default){return e===zo||e===iu||e===ko?this:this._r3Injector.get(e,t,n)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Eu extends su{constructor(e){super(),this.moduleType=e,null!==lt(e)&&function(e){const t=new Set;!function e(n){const r=lt(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error(`Duplicate module registered for ${e} - ${de(t)} vs ${de(t.name)}`)}(i,Cu.get(i),n),Cu.set(i,n));const s=Ai(r.imports);for(const o of s)t.has(o)||(t.add(o),e(o))}(e)}(e)}create(e){return new _u(this.moduleType,e)}}function wu(e,t,n){const r=Jt()+e,i=zt();return i[r]===Os?ea(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function Pu(e,t,n,r){return bu(zt(),Jt(),e,t,n,r)}function Su(e,t){const n=e[t];return n===Os?void 0:n}function bu(e,t,n,r,i,s){const o=t+n;return ta(e,o,i)?ea(e,o+1,s?r.call(s,i):r(i)):Su(e,o+1)}function Ou(e,t){const n=Ht();let r;const i=e+20;n.firstCreatePass?(r=function(e,t){if(t)for(let n=t.length-1;n>=0;n--){const r=t[n];if(e===r.name)return r}throw new ve("302",`The pipe '${e}' could not be found!`)}(t,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(i,r.onDestroy)):r=n.data[i];const s=r.factory||(r.factory=mt(r.type)),o=xe(ua);try{const e=Fn(!1),t=s();return Fn(e),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(n,zt(),i,t),t}finally{xe(o)}}function ku(e,t,n){const r=e+20,i=zt(),s=Rt(i,r);return Au(i,Iu(i,r)?bu(i,Jt(),t,s.transform,n,s):s.transform(n))}function Tu(e,t,n,r){const i=e+20,s=zt(),o=Rt(s,i);return Au(s,Iu(s,i)?function(e,t,n,r,i,s,o){const a=t+n;return na(e,a,i,s)?ea(e,a+2,o?r.call(o,i,s):r(i,s)):Su(e,a+2)}(s,Jt(),t,o.transform,n,r,o):o.transform(n,r))}function Iu(e,t){return e[1].data[t].pure}function Au(e,t){return Qo.isWrapped(t)&&(t=Qo.unwrap(t),e[en()]=Os),t}function Mu(e){return t=>{setTimeout(e,void 0,t)}}const Nu=class extends A{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){var r,i,s;let o=e,l=t||(()=>null),c=n;if(e&&"object"==typeof e){const t=e;o=null===(r=t.next)||void 0===r?void 0:r.bind(t),l=null===(i=t.error)||void 0===i?void 0:i.bind(t),c=null===(s=t.complete)||void 0===s?void 0:s.bind(t)}this.__isAsync&&(l=Mu(l),o&&(o=Mu(o)),c&&(c=Mu(c)));const u=super.subscribe({next:o,error:l,complete:c});return e instanceof a&&e.add(u),u}};function Ru(){return this._results[Ko()]()}class xu{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Ko(),n=xu.prototype;n[t]||(n[t]=Ru)}get changes(){return this._changes||(this._changes=new Nu)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const r=cr(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],s=t[r];if(n&&(i=n(i),s=n(s)),s!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class Du{constructor(e){this.queryList=e,this.matches=null}clone(){return new Du(this.queryList)}setDirty(){this.queryList.setDirty()}}class Lu{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let e=0;e<n;e++){const n=t.getByIndex(e);r.push(this.queries[n.indexInDeclarationView].clone())}return new Lu(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==Wu(e,t).matches&&this.queries[t].setDirty()}}class Fu{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class Uu{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const r=null!==t?t.length:0,i=this.getByIndex(n).embeddedTView(e,r);i&&(i.indexInDeclarationView=n,null!==t?t.push(i):t=[i])}return null!==t?new Uu(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Vu{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Vu(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const i=n[r];this.matchTNodeWithReadOption(e,t,Bu(t,i)),this.matchTNodeWithReadOption(e,t,Kn(t,e,i,!1,!1))}else n===eu?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Kn(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===Pc||r===au||r===eu&&4&t.type)this.addMatch(t.index,-2);else{const n=Kn(t,e,r,!1,!1);null!==n&&this.addMatch(t.index,n)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Bu(e,t){const n=e.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function $u(e,t,n,r){return-1===n?function(e,t){return 11&e.type?Ec(e,t):4&e.type?ru(e,t):null}(t,e):-2===n?function(e,t,n){return n===Pc?Ec(t,e):n===eu?ru(t,e):n===au?du(t,e):void 0}(e,t,r):Qn(e,e[1],n,t)}function zu(e,t,n,r){const i=t[19].queries[r];if(null===i.matches){const r=e.data,s=n.matches,o=[];for(let e=0;e<s.length;e+=2){const i=s[e];o.push(i<0?null:$u(t,r[i],s[e+1],n.metadata.read))}i.matches=o}return i.matches}function Hu(e,t,n,r){const i=e.queries.getByIndex(n),s=i.matches;if(null!==s){const o=zu(e,t,i,n);for(let e=0;e<s.length;e+=2){const n=s[e];if(n>0)r.push(o[e/2]);else{const i=s[e+1],o=t[-n];for(let e=10;e<o.length;e++){const t=o[e];t[17]===t[3]&&Hu(t[1],t,i,r)}if(null!==o[9]){const e=o[9];for(let t=0;t<e.length;t++){const n=e[t];Hu(n[1],n,i,r)}}}}}return r}function Gu(e){const t=zt(),n=Ht(),r=an();ln(r+1);const i=Wu(n,r);if(e.dirty&&Dt(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{const s=i.crossesNgTemplate?Hu(n,t,r,[]):zu(n,t,i,r);e.reset(s,Sc),e.notifyOnChanges()}return!0}return!1}function Zu(e,t,n){const r=Ht();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new Uu),e.queries.track(new Vu(t,n))}(r,new Fu(e,t,n),-1),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){const r=new xu(4==(4&n));Ys(e,t,r,r.destroy),null===t[19]&&(t[19]=new Lu),t[19].queries.push(new Du(r))}(r,zt(),t)}function qu(){return e=zt(),t=an(),e[19].queries[t].queryList;var e,t}function Wu(e,t){return e.queries.getByIndex(t)}function ju(e,t){return ru(e,t)}const Yu=new or("Application Initializer");let Ku=(()=>{class e{constructor(e){this.appInits=e,this.resolve=_c,this.reject=_c,this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}runInitializers(){if(this.initialized)return;const e=[],t=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const t=this.appInits[n]();if(Ca(t))e.push(t);else if(_a(t)){const n=new Promise((e,n)=>{t.subscribe({complete:e,error:n})});e.push(n)}}Promise.all(e).then(()=>{t()}).catch(e=>{this.reject(e)}),0===e.length&&t(),this.initialized=!0}}return e.\u0275fac=function(t){return new(t||e)(Or(Yu,8))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const Qu=new or("AppId"),Xu={provide:Qu,useFactory:function(){return`${Ju()}${Ju()}${Ju()}`},deps:[]};function Ju(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const eh=new or("Platform Initializer"),th=new or("Platform ID"),nh=new or("appBootstrapListener");let rh=(()=>{class e{log(e){console.log(e)}warn(e){console.warn(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const ih=new or("LocaleId"),sh=new or("DefaultCurrencyCode");class oh{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const ah=function(e){return new Eu(e)},lh=ah,ch=function(e){return Promise.resolve(ah(e))},uh=function(e){const t=ah(e),n=Ai(lt(e).declarations).reduce((e,t)=>{const n=at(t);return n&&e.push(new yu(n)),e},[]);return new oh(t,n)},hh=uh,dh=function(e){return Promise.resolve(uh(e))};let fh=(()=>{class e{constructor(){this.compileModuleSync=lh,this.compileModuleAsync=ch,this.compileModuleAndAllComponentsSync=hh,this.compileModuleAndAllComponentsAsync=dh}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const ph=(()=>Promise.resolve(0))();function gh(e){"undefined"==typeof Zone?ph.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class mh{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Nu(!1),this.onMicrotaskEmpty=new Nu(!1),this.onStable=new Nu(!1),this.onError=new Nu(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let e=ze.requestAnimationFrame,t=ze.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){const t=()=>{!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(ze,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Ch(e),e.isCheckStableRunning=!0,vh(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Ch(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{try{return _h(e),n.invokeTask(i,s,o,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||e.shouldCoalesceRunChangeDetection)&&t(),Eh(e)}},onInvoke:(n,r,i,s,o,a,l)=>{try{return _h(e),n.invoke(i,s,o,a,l)}finally{e.shouldCoalesceRunChangeDetection&&t(),Eh(e)}},onHasTask:(t,n,r,i)=>{t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,Ch(e),vh(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:(t,n,r,i)=>(t.handleError(r,i),e.runOutsideAngular(()=>e.onError.emit(i)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!mh.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(mh.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const i=this._inner,s=i.scheduleEventTask("NgZoneEvent: "+r,e,yh,_c,_c);try{return i.runTask(s,t,n)}finally{i.cancelTask(s)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const yh={};function vh(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Ch(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function _h(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Eh(e){e._nesting--,vh(e)}class wh{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Nu,this.onMicrotaskEmpty=new Nu,this.onStable=new Nu,this.onError=new Nu}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}}let Ph=(()=>{class e{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{mh.assertNotInAngularZone(),gh(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())gh(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(t=>!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,t,n){let r=-1;t&&t>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(e=>e.timeoutId!==r),e(this._didWork,this.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:r,updateCb:n})}whenStable(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,t,n){return[]}}return e.\u0275fac=function(t){return new(t||e)(Or(mh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),Sh=(()=>{class e{constructor(){this._applications=new Map,Oh.addToWindow(this)}registerApplication(e,t){this._applications.set(e,t)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,t=!0){return Oh.findTestabilityInTree(this,e,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class bh{addToWindow(e){}findTestabilityInTree(e,t,n){return null}}let Oh=new bh,kh=!0,Th=!1;let Ih;const Ah=new or("AllowMultipleToken");class Mh{constructor(e,t){this.name=e,this.token=t}}function Nh(e,t,n=[]){const r=`Platform: ${t}`,i=new or(r);return(t=[])=>{let s=Rh();if(!s||s.injector.get(Ah,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{const e=n.concat(t).concat({provide:i,useValue:!0},{provide:Io,useValue:"platform"});!function(e){if(Ih&&!Ih.destroyed&&!Ih.injector.get(Ah,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ih=e.get(xh);const t=e.get(eh,null);t&&t.forEach(e=>e())}(zo.create({providers:e,name:r}))}return function(e){const t=Rh();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function Rh(){return Ih&&!Ih.destroyed?Ih:null}let xh=(()=>{class e{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,t){const n=function(e,t){let n;return n="noop"===e?new wh:("zone.js"===e?void 0:e)||new mh({enableLongStackTrace:(Th=!0,kh),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),n}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),r=[{provide:mh,useValue:n}];return n.run(()=>{const i=zo.create({providers:r,parent:this.injector,name:e.moduleType.name}),s=e.create(i),o=s.injector.get(Oi,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const e=n.onError.subscribe({next:e=>{o.handleError(e)}});s.onDestroy(()=>{Fh(this._modules,s),e.unsubscribe()})}),function(e,n,r){try{const t=r();return Ca(t)?t.catch(t=>{throw n.runOutsideAngular(()=>e.handleError(t)),t}):t}catch(t){throw n.runOutsideAngular(()=>e.handleError(t)),t}}(o,n,()=>{const e=s.injector.get(Ku);return e.runInitializers(),e.donePromise.then(()=>(ml(s.injector.get(ih,hl)||hl),this._moduleDoBootstrap(s),s))})})}bootstrapModule(e,t=[]){const n=Dh({},t);return function(e,t,n){const r=new Eu(n);return Promise.resolve(r)}(0,0,e).then(e=>this.bootstrapModuleFactory(e,n))}_moduleDoBootstrap(e){const t=e.injector.get(Lh);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(e=>t.bootstrap(e));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${de(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);e.instance.ngDoBootstrap(t)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(t){return new(t||e)(Or(zo))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function Dh(e,t){return Array.isArray(t)?t.reduce(Dh,e):Object.assign(Object.assign({},e),t)}let Lh=(()=>{class e{constructor(e,t,n,r,i){this._zone=e,this._injector=t,this._exceptionHandler=n,this._componentFactoryResolver=r,this._initStatus=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new k(e=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{e.next(this._stable),e.complete()})}),o=new k(e=>{let t;this._zone.runOutsideAngular(()=>{t=this._zone.onStable.subscribe(()=>{mh.assertNotInAngularZone(),gh(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,e.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{mh.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{e.next(!1)}))});return()=>{t.unsubscribe(),n.unsubscribe()}});this.isStable=function(...e){const t=re(e),n=function(e,t){return"number"==typeof te(e)?e.pop():1/0}(e),r=e;return r.length?1===r.length?Y(r[0]):J(n)(ae(r,t)):ee}(s,o.pipe(function(e={}){const{connector:t=(()=>new A),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=e;return e=>{let s=null,o=null,a=null,l=0,c=!1,u=!1;const h=()=>{null==o||o.unsubscribe(),o=null},d=()=>{h(),s=a=null,c=u=!1},f=()=>{const e=s;d(),null==e||e.unsubscribe()};return R((e,p)=>{l++,!u&&!c&&h();const g=a=a??t();p.add(()=>{l--,0===l&&!u&&!c&&(o=ce(f,i))}),g.subscribe(p),s||(s=new _({next:e=>g.next(e),error:e=>{u=!0,h(),o=ce(d,n,e),g.error(e)},complete:()=>{c=!0,h(),o=ce(d,r),g.complete()}}),ae(e).subscribe(s))})(e)}}()))}bootstrap(e,t){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=e instanceof mc?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);const r=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(iu),i=n.create(zo.NULL,[],t||n.selector,r),s=i.location.nativeElement,o=i.injector.get(Ph,null),a=o&&i.injector.get(Sh);return o&&a&&a.registerApplication(s,o),i.onDestroy(()=>{this.detachView(i.hostView),Fh(this.components,i),a&&a.unregisterApplication(s)}),this._loadComponent(i),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const t=e;this._views.push(t),t.attachToAppRef(this)}detachView(e){const t=e;Fh(this._views,t),t.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(nh,[]).concat(this._bootstrapListeners).forEach(t=>t(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(t){return new(t||e)(Or(mh),Or(zo),Or(Oi),Or(Cc),Or(Ku))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function Fh(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class Uh{}class Vh{}const Bh={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let $h=(()=>{class e{constructor(e,t){this._compiler=e,this._config=t||Bh}load(e){return this.loadAndCompile(e)}loadAndCompile(e){let[t,r]=e.split("#");return void 0===r&&(r="default"),n(8255)(t).then(e=>e[r]).then(e=>zh(e,t,r)).then(e=>this._compiler.compileModuleAsync(e))}loadFactory(e){let[t,r]=e.split("#"),i="NgFactory";return void 0===r&&(r="default",i=""),n(8255)(this._config.factoryPathPrefix+t+this._config.factoryPathSuffix).then(e=>e[r+i]).then(e=>zh(e,t,r))}}return e.\u0275fac=function(t){return new(t||e)(Or(fh),Or(Vh,8))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function zh(e,t,n){if(!e)throw new Error(`Cannot find '${n}' in '${t}'`);return e}const Hh=Nh(null,"core",[{provide:th,useValue:"unknown"},{provide:xh,deps:[zo]},{provide:Sh,deps:[]},{provide:rh,deps:[]}]),Gh=[{provide:Lh,useClass:Lh,deps:[mh,zo,Oi,Cc,Ku]},{provide:mu,deps:[mh],useFactory:function(e){let t=[];return e.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:Ku,useClass:Ku,deps:[[new Nr,Yu]]},{provide:fh,useClass:fh,deps:[]},Xu,{provide:zc,useFactory:function(){return Qc},deps:[]},{provide:Gc,useFactory:function(){return Xc},deps:[]},{provide:ih,useFactory:function(e){return ml(e=e||"undefined"!=typeof $localize&&$localize.locale||hl),e},deps:[[new Mr(ih),new Nr,new Rr]]},{provide:sh,useValue:"USD"}];let Zh=(()=>{class e{constructor(e){}}return e.\u0275fac=function(t){return new(t||e)(Or(Lh))},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:Gh}),e})(),qh=null;function Wh(){return qh}const jh=new or("DocumentToken");let Yh=(()=>{class e{historyGo(e){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({factory:Kh,token:e,providedIn:"platform"}),e})();function Kh(){return Or(Xh)}const Qh=new or("Location Initialized");let Xh=(()=>{class e extends Yh{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Wh().getBaseHref(this._doc)}onPopState(e){const t=Wh().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),()=>t.removeEventListener("popstate",e)}onHashChange(e){const t=Wh().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),()=>t.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,t,n){Jh()?this._history.pushState(e,t,n):this.location.hash=n}replaceState(e,t,n){Jh()?this._history.replaceState(e,t,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return e.\u0275fac=function(t){return new(t||e)(Or(jh))},e.\u0275prov=Pe({factory:ed,token:e,providedIn:"platform"}),e})();function Jh(){return!!window.history.pushState}function ed(){return new Xh(Or(jh))}function td(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function nd(e){const t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function rd(e){return e&&"?"!==e[0]?"?"+e:e}let id=(()=>{class e{historyGo(e){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({factory:sd,token:e,providedIn:"root"}),e})();function sd(e){const t=Or(jh).location;return new ad(Or(Yh),t&&t.origin||"")}const od=new or("appBaseHref");let ad=(()=>{class e extends id{constructor(e,t){if(super(),this._platformLocation=e,this._removeListenerFns=[],null==t&&(t=this._platformLocation.getBaseHrefFromDOM()),null==t)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=t}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return td(this._baseHref,e)}path(e=!1){const t=this._platformLocation.pathname+rd(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?`${t}${n}`:t}pushState(e,t,n,r){const i=this.prepareExternalUrl(n+rd(r));this._platformLocation.pushState(e,t,i)}replaceState(e,t,n,r){const i=this.prepareExternalUrl(n+rd(r));this._platformLocation.replaceState(e,t,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var t,n;null===(n=(t=this._platformLocation).historyGo)||void 0===n||n.call(t,e)}}return e.\u0275fac=function(t){return new(t||e)(Or(Yh),Or(od,8))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),ld=(()=>{class e extends id{constructor(e,t){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=t&&(this._baseHref=t)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let t=this._platformLocation.hash;return null==t&&(t="#"),t.length>0?t.substring(1):t}prepareExternalUrl(e){const t=td(this._baseHref,e);return t.length>0?"#"+t:t}pushState(e,t,n,r){let i=this.prepareExternalUrl(n+rd(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}replaceState(e,t,n,r){let i=this.prepareExternalUrl(n+rd(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var t,n;null===(n=(t=this._platformLocation).historyGo)||void 0===n||n.call(t,e)}}return e.\u0275fac=function(t){return new(t||e)(Or(Yh),Or(od,8))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),cd=(()=>{class e{constructor(e,t){this._subject=new Nu,this._urlChangeListeners=[],this._platformStrategy=e;const n=this._platformStrategy.getBaseHref();this._platformLocation=t,this._baseHref=nd(hd(n)),this._platformStrategy.onPopState(e=>{this._subject.emit({url:this.path(!0),pop:!0,state:e.state,type:e.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,t=""){return this.path()==this.normalize(e+rd(t))}normalize(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,hd(t)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,t="",n=null){this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+rd(t)),n)}replaceState(e,t="",n=null){this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+rd(t)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(e=0){var t,n;null===(n=(t=this._platformStrategy).historyGo)||void 0===n||n.call(t,e)}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(e=>{this._notifyUrlChangeListeners(e.url,e.state)}))}_notifyUrlChangeListeners(e="",t){this._urlChangeListeners.forEach(n=>n(e,t))}subscribe(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}return e.\u0275fac=function(t){return new(t||e)(Or(id),Or(Yh))},e.normalizeQueryParams=rd,e.joinWithSlash=td,e.stripTrailingSlash=nd,e.\u0275prov=Pe({factory:ud,token:e,providedIn:"root"}),e})();function ud(){return new cd(Or(id),Or(Yh))}function hd(e){return e.replace(/\/index.html$/,"")}var dd=(()=>((dd=dd||{})[dd.Decimal=0]="Decimal",dd[dd.Percent=1]="Percent",dd[dd.Currency=2]="Currency",dd[dd.Scientific=3]="Scientific",dd))(),fd=(()=>((fd=fd||{})[fd.Zero=0]="Zero",fd[fd.One=1]="One",fd[fd.Two=2]="Two",fd[fd.Few=3]="Few",fd[fd.Many=4]="Many",fd[fd.Other=5]="Other",fd))(),pd=(()=>((pd=pd||{})[pd.Format=0]="Format",pd[pd.Standalone=1]="Standalone",pd))(),gd=(()=>((gd=gd||{})[gd.Narrow=0]="Narrow",gd[gd.Abbreviated=1]="Abbreviated",gd[gd.Wide=2]="Wide",gd[gd.Short=3]="Short",gd))(),md=(()=>((md=md||{})[md.Short=0]="Short",md[md.Medium=1]="Medium",md[md.Long=2]="Long",md[md.Full=3]="Full",md))(),yd=(()=>((yd=yd||{})[yd.Decimal=0]="Decimal",yd[yd.Group=1]="Group",yd[yd.List=2]="List",yd[yd.PercentSign=3]="PercentSign",yd[yd.PlusSign=4]="PlusSign",yd[yd.MinusSign=5]="MinusSign",yd[yd.Exponential=6]="Exponential",yd[yd.SuperscriptingExponent=7]="SuperscriptingExponent",yd[yd.PerMille=8]="PerMille",yd[yd.Infinity=9]="Infinity",yd[yd.NaN=10]="NaN",yd[yd.TimeSeparator=11]="TimeSeparator",yd[yd.CurrencyDecimal=12]="CurrencyDecimal",yd[yd.CurrencyGroup=13]="CurrencyGroup",yd))();function vd(e,t){return Sd(ol(e)[cl.DateFormat],t)}function Cd(e,t){return Sd(ol(e)[cl.TimeFormat],t)}function _d(e,t){return Sd(ol(e)[cl.DateTimeFormat],t)}function Ed(e,t){const n=ol(e),r=n[cl.NumberSymbols][t];if(void 0===r){if(t===yd.CurrencyDecimal)return n[cl.NumberSymbols][yd.Decimal];if(t===yd.CurrencyGroup)return n[cl.NumberSymbols][yd.Group]}return r}const wd=al;function Pd(e){if(!e[cl.ExtraData])throw new Error(`Missing extra locale data for the locale "${e[cl.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Sd(e,t){for(let n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function bd(e){const[t,n]=e.split(":");return{hours:+t,minutes:+n}}const Od=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,kd={},Td=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Id=(()=>((Id=Id||{})[Id.Short=0]="Short",Id[Id.ShortGMT=1]="ShortGMT",Id[Id.Long=2]="Long",Id[Id.Extended=3]="Extended",Id))(),Ad=(()=>((Ad=Ad||{})[Ad.FullYear=0]="FullYear",Ad[Ad.Month=1]="Month",Ad[Ad.Date=2]="Date",Ad[Ad.Hours=3]="Hours",Ad[Ad.Minutes=4]="Minutes",Ad[Ad.Seconds=5]="Seconds",Ad[Ad.FractionalSeconds=6]="FractionalSeconds",Ad[Ad.Day=7]="Day",Ad))(),Md=(()=>((Md=Md||{})[Md.DayPeriods=0]="DayPeriods",Md[Md.Days=1]="Days",Md[Md.Months=2]="Months",Md[Md.Eras=3]="Eras",Md))();function Nd(e,t,n,r){let i=function(e){if(Zd(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){const[t,n=1,r=1]=e.split("-").map(e=>+e);return Rd(t,n-1,r)}const t=parseFloat(e);if(!isNaN(e-t))return new Date(t);let n;if(n=e.match(Od))return function(e){const t=new Date(0);let n=0,r=0;const i=e[8]?t.setUTCFullYear:t.setFullYear,s=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));const o=Number(e[4]||0)-n,a=Number(e[5]||0)-r,l=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return s.call(t,o,a,l,c),t}(n)}const t=new Date(e);if(!Zd(t))throw new Error(`Unable to convert "${e}" into a date`);return t}(e);t=xd(n,t)||t;let s,o=[];for(;t;){if(s=Td.exec(t),!s){o.push(t);break}{o=o.concat(s.slice(1));const e=o.pop();if(!e)break;t=e}}let a=i.getTimezoneOffset();r&&(a=Gd(r,a),i=function(e,t,n){const r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(Gd(t,r)-r))}(i,r));let l="";return o.forEach(e=>{const t=function(e){if(Hd[e])return Hd[e];let t;switch(e){case"G":case"GG":case"GGG":t=Ud(Md.Eras,gd.Abbreviated);break;case"GGGG":t=Ud(Md.Eras,gd.Wide);break;case"GGGGG":t=Ud(Md.Eras,gd.Narrow);break;case"y":t=Fd(Ad.FullYear,1,0,!1,!0);break;case"yy":t=Fd(Ad.FullYear,2,0,!0,!0);break;case"yyy":t=Fd(Ad.FullYear,3,0,!1,!0);break;case"yyyy":t=Fd(Ad.FullYear,4,0,!1,!0);break;case"Y":t=zd(1);break;case"YY":t=zd(2,!0);break;case"YYY":t=zd(3);break;case"YYYY":t=zd(4);break;case"M":case"L":t=Fd(Ad.Month,1,1);break;case"MM":case"LL":t=Fd(Ad.Month,2,1);break;case"MMM":t=Ud(Md.Months,gd.Abbreviated);break;case"MMMM":t=Ud(Md.Months,gd.Wide);break;case"MMMMM":t=Ud(Md.Months,gd.Narrow);break;case"LLL":t=Ud(Md.Months,gd.Abbreviated,pd.Standalone);break;case"LLLL":t=Ud(Md.Months,gd.Wide,pd.Standalone);break;case"LLLLL":t=Ud(Md.Months,gd.Narrow,pd.Standalone);break;case"w":t=$d(1);break;case"ww":t=$d(2);break;case"W":t=$d(1,!0);break;case"d":t=Fd(Ad.Date,1);break;case"dd":t=Fd(Ad.Date,2);break;case"c":case"cc":t=Fd(Ad.Day,1);break;case"ccc":t=Ud(Md.Days,gd.Abbreviated,pd.Standalone);break;case"cccc":t=Ud(Md.Days,gd.Wide,pd.Standalone);break;case"ccccc":t=Ud(Md.Days,gd.Narrow,pd.Standalone);break;case"cccccc":t=Ud(Md.Days,gd.Short,pd.Standalone);break;case"E":case"EE":case"EEE":t=Ud(Md.Days,gd.Abbreviated);break;case"EEEE":t=Ud(Md.Days,gd.Wide);break;case"EEEEE":t=Ud(Md.Days,gd.Narrow);break;case"EEEEEE":t=Ud(Md.Days,gd.Short);break;case"a":case"aa":case"aaa":t=Ud(Md.DayPeriods,gd.Abbreviated);break;case"aaaa":t=Ud(Md.DayPeriods,gd.Wide);break;case"aaaaa":t=Ud(Md.DayPeriods,gd.Narrow);break;case"b":case"bb":case"bbb":t=Ud(Md.DayPeriods,gd.Abbreviated,pd.Standalone,!0);break;case"bbbb":t=Ud(Md.DayPeriods,gd.Wide,pd.Standalone,!0);break;case"bbbbb":t=Ud(Md.DayPeriods,gd.Narrow,pd.Standalone,!0);break;case"B":case"BB":case"BBB":t=Ud(Md.DayPeriods,gd.Abbreviated,pd.Format,!0);break;case"BBBB":t=Ud(Md.DayPeriods,gd.Wide,pd.Format,!0);break;case"BBBBB":t=Ud(Md.DayPeriods,gd.Narrow,pd.Format,!0);break;case"h":t=Fd(Ad.Hours,1,-12);break;case"hh":t=Fd(Ad.Hours,2,-12);break;case"H":t=Fd(Ad.Hours,1);break;case"HH":t=Fd(Ad.Hours,2);break;case"m":t=Fd(Ad.Minutes,1);break;case"mm":t=Fd(Ad.Minutes,2);break;case"s":t=Fd(Ad.Seconds,1);break;case"ss":t=Fd(Ad.Seconds,2);break;case"S":t=Fd(Ad.FractionalSeconds,1);break;case"SS":t=Fd(Ad.FractionalSeconds,2);break;case"SSS":t=Fd(Ad.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=Vd(Id.Short);break;case"ZZZZZ":t=Vd(Id.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=Vd(Id.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=Vd(Id.Long);break;default:return null}return Hd[e]=t,t}(e);l+=t?t(i,n,a):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function Rd(e,t,n){const r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function xd(e,t){const n=function(e){return ol(e)[cl.LocaleId]}(e);if(kd[n]=kd[n]||{},kd[n][t])return kd[n][t];let r="";switch(t){case"shortDate":r=vd(e,md.Short);break;case"mediumDate":r=vd(e,md.Medium);break;case"longDate":r=vd(e,md.Long);break;case"fullDate":r=vd(e,md.Full);break;case"shortTime":r=Cd(e,md.Short);break;case"mediumTime":r=Cd(e,md.Medium);break;case"longTime":r=Cd(e,md.Long);break;case"fullTime":r=Cd(e,md.Full);break;case"short":const t=xd(e,"shortTime"),n=xd(e,"shortDate");r=Dd(_d(e,md.Short),[t,n]);break;case"medium":const i=xd(e,"mediumTime"),s=xd(e,"mediumDate");r=Dd(_d(e,md.Medium),[i,s]);break;case"long":const o=xd(e,"longTime"),a=xd(e,"longDate");r=Dd(_d(e,md.Long),[o,a]);break;case"full":const l=xd(e,"fullTime"),c=xd(e,"fullDate");r=Dd(_d(e,md.Full),[l,c])}return r&&(kd[n][t]=r),r}function Dd(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function Ld(e,t,n="-",r,i){let s="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,s=n));let o=String(e);for(;o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),s+o}function Fd(e,t,n=0,r=!1,i=!1){return function(s,o){let a=function(e,t){switch(e){case Ad.FullYear:return t.getFullYear();case Ad.Month:return t.getMonth();case Ad.Date:return t.getDate();case Ad.Hours:return t.getHours();case Ad.Minutes:return t.getMinutes();case Ad.Seconds:return t.getSeconds();case Ad.FractionalSeconds:return t.getMilliseconds();case Ad.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${e}".`)}}(e,s);if((n>0||a>-n)&&(a+=n),e===Ad.Hours)0===a&&-12===n&&(a=12);else if(e===Ad.FractionalSeconds)return function(e,t){return Ld(e,3).substr(0,t)}(a,t);const l=Ed(o,yd.MinusSign);return Ld(a,t,l,r,i)}}function Ud(e,t,n=pd.Format,r=!1){return function(i,s){return function(e,t,n,r,i,s){switch(n){case Md.Months:return function(e,t,n){const r=ol(e),i=Sd([r[cl.MonthsFormat],r[cl.MonthsStandalone]],t);return Sd(i,n)}(t,i,r)[e.getMonth()];case Md.Days:return function(e,t,n){const r=ol(e),i=Sd([r[cl.DaysFormat],r[cl.DaysStandalone]],t);return Sd(i,n)}(t,i,r)[e.getDay()];case Md.DayPeriods:const o=e.getHours(),a=e.getMinutes();if(s){const e=function(e){const t=ol(e);return Pd(t),(t[cl.ExtraData][2]||[]).map(e=>"string"==typeof e?bd(e):[bd(e[0]),bd(e[1])])}(t),n=function(e,t,n){const r=ol(e);Pd(r);const i=Sd([r[cl.ExtraData][0],r[cl.ExtraData][1]],t)||[];return Sd(i,n)||[]}(t,i,r),s=e.findIndex(e=>{if(Array.isArray(e)){const[t,n]=e,r=o>=t.hours&&a>=t.minutes,i=o<n.hours||o===n.hours&&a<n.minutes;if(t.hours<n.hours){if(r&&i)return!0}else if(r||i)return!0}else if(e.hours===o&&e.minutes===a)return!0;return!1});if(-1!==s)return n[s]}return function(e,t,n){const r=ol(e),i=Sd([r[cl.DayPeriodsFormat],r[cl.DayPeriodsStandalone]],t);return Sd(i,n)}(t,i,r)[o<12?0:1];case Md.Eras:return function(e,t){return Sd(ol(e)[cl.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${n}`)}}(i,s,e,t,n,r)}}function Vd(e){return function(t,n,r){const i=-1*r,s=Ed(n,yd.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case Id.Short:return(i>=0?"+":"")+Ld(o,2,s)+Ld(Math.abs(i%60),2,s);case Id.ShortGMT:return"GMT"+(i>=0?"+":"")+Ld(o,1,s);case Id.Long:return"GMT"+(i>=0?"+":"")+Ld(o,2,s)+":"+Ld(Math.abs(i%60),2,s);case Id.Extended:return 0===r?"Z":(i>=0?"+":"")+Ld(o,2,s)+":"+Ld(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${e}"`)}}}function Bd(e){return Rd(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function $d(e,t=!1){return function(n,r){let i;if(t){const e=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,t=n.getDate();i=1+Math.floor((t+e)/7)}else{const e=Bd(n),t=function(e){const t=Rd(e,0,1).getDay();return Rd(e,0,1+(t<=4?4:11)-t)}(e.getFullYear()),r=e.getTime()-t.getTime();i=1+Math.round(r/6048e5)}return Ld(i,e,Ed(r,yd.MinusSign))}}function zd(e,t=!1){return function(n,r){return Ld(Bd(n).getFullYear(),e,Ed(r,yd.MinusSign),t)}}const Hd={};function Gd(e,t){e=e.replace(/:/g,"");const n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function Zd(e){return e instanceof Date&&!isNaN(e.valueOf())}const qd=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function Wd(e){const t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}class jd{}let Yd=(()=>{class e extends jd{constructor(e){super(),this.locale=e}getPluralCategory(e,t){switch(wd(t||this.locale)(e)){case fd.Zero:return"zero";case fd.One:return"one";case fd.Two:return"two";case fd.Few:return"few";case fd.Many:return"many";default:return"other"}}}return e.\u0275fac=function(t){return new(t||e)(Or(ih))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function Kd(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const e=n.indexOf("="),[r,i]=-1==e?[n,""]:[n.slice(0,e),n.slice(e+1)];if(r.trim()===t)return decodeURIComponent(i)}return null}let Qd=(()=>{class e{constructor(e,t,n,r){this._iterableDiffers=e,this._keyValueDiffers=t,this._ngEl=n,this._renderer=r,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Xo(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachChangedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachRemovedItem(e=>{e.previousValue&&this._toggleClass(e.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(e=>{if("string"!=typeof e.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${de(e.item)}`);this._toggleClass(e.item,!0)}),e.forEachRemovedItem(e=>this._toggleClass(e.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!0)):Object.keys(e).forEach(t=>this._toggleClass(t,!!e[t])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!1)):Object.keys(e).forEach(e=>this._toggleClass(e,!1)))}_toggleClass(e,t){(e=e.trim())&&e.split(/\s+/g).forEach(e=>{t?this._renderer.addClass(this._ngEl.nativeElement,e):this._renderer.removeClass(this._ngEl.nativeElement,e)})}}return e.\u0275fac=function(t){return new(t||e)(ua(zc),ua(Gc),ua(Pc),ua(Oc))},e.\u0275dir=st({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e})();class Xd{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Jd=(()=>{class e{constructor(e,t,n){this._viewContainer=e,this._template=t,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch{throw new Error(`Cannot find a differ supporting object '${e}' of type '${function(e){return e.name||typeof e}(e)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const t=[];e.forEachOperation((e,n,r)=>{if(null==e.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new Xd(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new ef(e,n);t.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const s=new ef(e,i);t.push(s)}});for(let n=0;n<t.length;n++)this._perViewChange(t[n].view,t[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const e=this._viewContainer.get(n);e.context.index=n,e.context.count=r,e.context.ngForOf=this._ngForOf}e.forEachIdentityChange(e=>{this._viewContainer.get(e.currentIndex).context.$implicit=e.item})}_perViewChange(e,t){e.context.$implicit=t.item}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(ua(au),ua(eu),ua(zc))},e.\u0275dir=st({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();class ef{constructor(e,t){this.record=e,this.view=t}}let tf=(()=>{class e{constructor(e,t){this._viewContainer=e,this._context=new nf,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=t}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){rf("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){rf("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(ua(au),ua(eu))},e.\u0275dir=st({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e})();class nf{constructor(){this.$implicit=null,this.ngIf=null}}function rf(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${de(t)}'.`)}let sf=(()=>{class e{constructor(e){this._locale=e}transform(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,s,o=!1){let a="",l=!1;if(isFinite(e)){let c=function(e){let t,n,r,i,s,o=Math.abs(e)+"",a=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(s=o.length))t=[0],n=1;else{for(s--;"0"===o.charAt(s);)s--;for(n-=r,t=[],i=0;r<=s;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),a=n-1,n=1),{digits:t,exponent:a,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;const t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));let u=t.minInt,h=t.minFrac,d=t.maxFrac;if(s){const e=s.match(qd);if(null===e)throw new Error(`${s} is not a valid digit info`);const t=e[1],n=e[3],r=e[5];null!=t&&(u=Wd(t)),null!=n&&(h=Wd(n)),null!=r?d=Wd(r):null!=n&&h>d&&(d=h)}!function(e,t,n){if(t>n)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${n}).`);let r=e.digits,i=r.length-e.integerLen;const s=Math.min(Math.max(t,i),n);let o=s+e.integerLen,a=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(let e=o;e<r.length;e++)r[e]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=s+1),r[0]=0;for(let e=1;e<o;e++)r[e]=0}if(a>=5)if(o-1<0){for(let t=0;t>o;t--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,s);i++)r.push(0);let l=0!==s;const c=t+e.integerLen,u=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,l&&(0===r[n]&&n>=c?r.pop():l=!1),t>=10?1:0},0);u&&(r.unshift(u),e.integerLen++)}(c,h,d);let f=c.digits,p=c.integerLen;const g=c.exponent;let m=[];for(l=f.every(e=>!e);p<u;p++)f.unshift(0);for(;p<0;p++)f.unshift(0);p>0?m=f.splice(p,f.length):(m=f,f=[0]);const y=[];for(f.length>=t.lgSize&&y.unshift(f.splice(-t.lgSize,f.length).join(""));f.length>t.gSize;)y.unshift(f.splice(-t.gSize,f.length).join(""));f.length&&y.unshift(f.join("")),a=y.join(Ed(n,r)),m.length&&(a+=Ed(n,i)+m.join("")),g&&(a+=Ed(n,yd.Exponential)+"+"+g)}else a=Ed(n,yd.Infinity);return a=e<0&&!l?t.negPre+a+t.negSuf:t.posPre+a+t.posSuf,a}(e,function(e,t="-"){const n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],s=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],a=o[0],l=o[1]||"";n.posPre=a.substr(0,a.indexOf("#"));for(let u=0;u<l.length;u++){const e=l.charAt(u);"0"===e?n.minFrac=n.maxFrac=u+1:"#"===e?n.maxFrac=u+1:n.posSuf+=e}const c=a.split(",");if(n.gSize=c[1]?c[1].length:0,n.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,s){const e=i.length-n.posPre.length-n.posSuf.length,t=s.indexOf("#");n.negPre=s.substr(0,t).replace(/'/g,""),n.negSuf=s.substr(t+e).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return ol(e)[cl.NumberFormats][t]}(t,dd.Decimal),Ed(t,yd.MinusSign)),t,yd.Group,yd.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error(`${e} is not a number`);return e}(t),r,n)}catch(i){throw function(e,t){return Error(`InvalidPipeArgument: '${t}' for pipe '${de(e)}'`)}(e,i.message)}}}return e.\u0275fac=function(t){return new(t||e)(ua(ih,16))},e.\u0275pipe=ot({name:"number",type:e,pure:!0}),e})();let of=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[{provide:jd,useClass:Yd}]}),e})();let af=(()=>{class e{}return e.\u0275prov=Pe({token:e,providedIn:"root",factory:()=>new lf(Or(jh),window)}),e})();class lf{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const n=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const e=r.shadowRoot;if(e){const n=e.getElementById(t)||e.querySelector(`[name="${t}"]`);if(n)return n}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=cf(this.window.history)||cf(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function cf(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class uf{}class hf extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var e;e=new hf,qh||(qh=e)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(ff=ff||document.querySelector("base"),ff?ff.getAttribute("href"):null);return null==t?null:function(e){df=df||document.createElement("a"),df.setAttribute("href",e);const t=df.pathname;return"/"===t.charAt(0)?t:`/${t}`}(t)}resetBaseElement(){ff=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Kd(document.cookie,e)}}let df,ff=null;const pf=new or("TRANSITION_ID"),gf=[{provide:Yu,useFactory:function(e,t,n){return()=>{n.get(Ku).donePromise.then(()=>{const n=Wh(),r=t.querySelectorAll(`style[ng-transition="${e}"]`);for(let e=0;e<r.length;e++)n.remove(r[e])})}},deps:[pf,jh,zo],multi:!0}];class mf{static init(){var e;e=new mf,Oh=e}addToWindow(e){ze.getAngularTestability=(t,n=!0)=>{const r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},ze.getAllAngularTestabilities=()=>e.getAllTestabilities(),ze.getAllAngularRootElements=()=>e.getAllRootElements(),ze.frameworkStabilizers||(ze.frameworkStabilizers=[]),ze.frameworkStabilizers.push(e=>{const t=ze.getAllAngularTestabilities();let n=t.length,r=!1;const i=function(t){r=r||t,n--,0==n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?Wh().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}}let yf=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const vf=new or("EventManagerPlugins");let Cf=(()=>{class e{constructor(e,t){this._zone=t,this._eventNameToPlugin=new Map,e.forEach(e=>e.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}addGlobalEventListener(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}getZone(){return this._zone}_findPluginFor(e){const t=this._eventNameToPlugin.get(e);if(t)return t;const n=this._plugins;for(let r=0;r<n.length;r++){const t=n[r];if(t.supports(e))return this._eventNameToPlugin.set(e,t),t}throw new Error(`No event manager plugin found for event ${e}`)}}return e.\u0275fac=function(t){return new(t||e)(Or(vf),Or(mh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class _f{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=Wh().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let Ef=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(e){const t=new Set;e.forEach(e=>{this._stylesSet.has(e)||(this._stylesSet.add(e),t.add(e))}),this.onStylesAdded(t)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),wf=(()=>{class e extends Ef{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,t,n){e.forEach(e=>{const r=this._doc.createElement("style");r.textContent=e,n.push(t.appendChild(r))})}addHost(e){const t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}removeHost(e){const t=this._hostNodes.get(e);t&&t.forEach(Pf),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((t,n)=>{this._addStylesToHost(e,n,t)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(Pf))}}return e.\u0275fac=function(t){return new(t||e)(Or(jh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function Pf(e){Wh().remove(e)}const Sf={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},bf=/%COMP%/g;function Of(e,t,n){for(let r=0;r<t.length;r++){let i=t[r];Array.isArray(i)?Of(e,i,n):(i=i.replace(bf,e),n.push(i))}return n}function kf(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let Tf=(()=>{class e{constructor(e,t,n){this.eventManager=e,this.sharedStylesHost=t,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new If(e)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Ue.Emulated:{let n=this.rendererByCompId.get(t.id);return n||(n=new Af(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n}case 1:case Ue.ShadowDom:return new Mf(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){const e=Of(t.id,t.styles,[]);this.sharedStylesHost.addStyles(e),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(t){return new(t||e)(Or(Cf),Or(wf),Or(Qu))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class If{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(Sf[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const i=Sf[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=Sf[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(Mi.DashCase|Mi.Important)?e.style.setProperty(t,n,r&Mi.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&Mi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,kf(n)):this.eventManager.addEventListener(e,t,kf(n))}}class Af extends If{constructor(e,t,n,r){super(e),this.component=n;const i=Of(r+"-"+n.id,n.styles,[]);t.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(bf,r+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(bf,r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class Mf extends If{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=Of(r.id,r.styles,[]);for(let s=0;s<i.length;s++){const e=document.createElement("style");e.textContent=i[s],this.shadowRoot.appendChild(e)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Nf=(()=>{class e extends _f{constructor(e){super(e)}supports(e){return!0}addEventListener(e,t,n){return e.addEventListener(t,n,!1),()=>this.removeEventListener(e,t,n)}removeEventListener(e,t,n){return e.removeEventListener(t,n)}}return e.\u0275fac=function(t){return new(t||e)(Or(jh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const Rf=["alt","control","meta","shift"],xf={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Df={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Lf={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let Ff=(()=>{class e extends _f{constructor(e){super(e)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,n,r){const i=e.parseEventName(n),s=e.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Wh().onAndCancel(t,i.domEventName,s))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=e._normalizeKey(n.pop());let s="";if(Rf.forEach(e=>{const t=n.indexOf(e);t>-1&&(n.splice(t,1),s+=e+".")}),s+=i,0!=n.length||0===i.length)return null;const o={};return o.domEventName=r,o.fullKey=s,o}static getEventFullKey(e){let t="",n=function(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&Df.hasOwnProperty(t)&&(t=Df[t]))}return xf[t]||t}(e);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),Rf.forEach(r=>{r!=n&&Lf[r](e)&&(t+=r+".")}),t+=n,t}static eventCallback(t,n,r){return i=>{e.getEventFullKey(i)===t&&r.runGuarded(()=>n(i))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return e.\u0275fac=function(t){return new(t||e)(Or(jh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),Uf=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({factory:function(){return Or(Vf)},token:e,providedIn:"root"}),e})(),Vf=(()=>{class e extends Uf{constructor(e){super(),this._doc=e}sanitize(e,t){if(null==t)return null;switch(e){case yi.NONE:return t;case yi.HTML:return Zr(t,"HTML")?Gr(t):gi(this._doc,String(t)).toString();case yi.STYLE:return Zr(t,"Style")?Gr(t):t;case yi.SCRIPT:if(Zr(t,"Script"))return Gr(t);throw new Error("unsafe value used in a script context");case yi.URL:return qr(t),Zr(t,"URL")?Gr(t):Xr(String(t));case yi.RESOURCE_URL:if(Zr(t,"ResourceURL"))return Gr(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function(e){return new Vr(e)}(e)}bypassSecurityTrustStyle(e){return function(e){return new Br(e)}(e)}bypassSecurityTrustScript(e){return function(e){return new $r(e)}(e)}bypassSecurityTrustUrl(e){return function(e){return new zr(e)}(e)}bypassSecurityTrustResourceUrl(e){return function(e){return new Hr(e)}(e)}}return e.\u0275fac=function(t){return new(t||e)(Or(jh))},e.\u0275prov=Pe({factory:function(){return function(e){return new Vf(e.get(jh))}(Or(ko))},token:e,providedIn:"root"}),e})();const Bf=[{provide:th,useValue:"browser"},{provide:eh,useValue:function(){hf.makeCurrent(),mf.init()},multi:!0},{provide:jh,useFactory:function(){return e=document,bt=e,document;var e},deps:[]}],$f=Nh(Hh,"browser",Bf),zf=[[],{provide:Io,useValue:"root"},{provide:Oi,useFactory:function(){return new Oi},deps:[]},{provide:vf,useClass:Nf,multi:!0,deps:[jh,mh,th]},{provide:vf,useClass:Ff,multi:!0,deps:[jh]},[],{provide:Tf,useClass:Tf,deps:[Cf,wf,Qu]},{provide:bc,useExisting:Tf},{provide:Ef,useExisting:wf},{provide:wf,useClass:wf,deps:[jh]},{provide:Ph,useClass:Ph,deps:[mh]},{provide:Cf,useClass:Cf,deps:[vf,mh]},{provide:uf,useClass:yf,deps:[]},[]];let Hf=(()=>{class e{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:e,providers:[{provide:Qu,useValue:t.appId},{provide:pf,useExisting:Qu},gf]}}}return e.\u0275fac=function(t){return new(t||e)(Or(e,12))},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:zf,imports:[of,Zh]}),e})();"undefined"!=typeof window&&window;const{isArray:Gf}=Array,{getPrototypeOf:Zf,prototype:qf,keys:Wf}=Object;function jf(e){if(1===e.length){const t=e[0];if(Gf(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&Zf(e)===qf}(t)){const e=Wf(t);return{args:e.map(e=>t[e]),keys:e}}}return{args:e,keys:null}}const{isArray:Yf}=Array;function Kf(e){return D(t=>function(e,t){return Yf(t)?e(...t):e(t)}(e,t))}function Qf(e,t){return e.reduce((e,n,r)=>(e[n]=t[r],e),{})}let Xf=(()=>{class e{constructor(e,t){this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}setProperty(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return e.\u0275fac=function(t){return new(t||e)(ua(Oc),ua(Pc))},e.\u0275dir=st({type:e}),e})(),Jf=(()=>{class e extends Xf{}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275dir=st({type:e,features:[Go]}),e})();const ep=new or("NgValueAccessor"),tp={provide:ep,useExisting:ge(()=>rp),multi:!0},np=new or("CompositionEventMode");let rp=(()=>{class e extends Xf{constructor(e,t,n){super(e,t),this._compositionMode=n,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const e=Wh()?Wh().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return e.\u0275fac=function(t){return new(t||e)(ua(Oc),ua(Pc),ua(np,8))},e.\u0275dir=st({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&Ea("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[gc([tp]),Go]}),e})();function ip(e){return null==e||0===e.length}function sp(e){return null!=e&&"number"==typeof e.length}const op=new or("NgValidators"),ap=new or("NgAsyncValidators"),lp=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class cp{static min(e){return t=e,e=>{if(ip(e.value)||ip(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null};var t}static max(e){return t=e,e=>{if(ip(e.value)||ip(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null};var t}static required(e){return up(e)}static requiredTrue(e){return!0===e.value?null:{required:!0}}static email(e){return ip((t=e).value)||lp.test(t.value)?null:{email:!0};var t}static minLength(e){return t=e,e=>ip(e.value)||!sp(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null;var t}static maxLength(e){return hp(e)}static pattern(e){return function(e){if(!e)return dp;let t,n;return"string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),e=>{if(ip(e.value))return null;const r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}(e)}static nullValidator(e){return null}static compose(e){return vp(e)}static composeAsync(e){return _p(e)}}function up(e){return ip(e.value)?{required:!0}:null}function hp(e){return t=>sp(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}function dp(e){return null}function fp(e){return null!=e}function pp(e){const t=Ca(e)?ae(e):e;return _a(t),t}function gp(e){let t={};return e.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function mp(e,t){return t.map(t=>t(e))}function yp(e){return e.map(e=>function(e){return!e.validate}(e)?e:t=>e.validate(t))}function vp(e){if(!e)return null;const t=e.filter(fp);return 0==t.length?null:function(e){return gp(mp(e,t))}}function Cp(e){return null!=e?vp(yp(e)):null}function _p(e){if(!e)return null;const t=e.filter(fp);return 0==t.length?null:function(e){return function(...e){const t=ne(e),{args:n,keys:r}=jf(e),i=new k(e=>{const{length:t}=n;if(!t)return void e.complete();const i=new Array(t);let s=t,o=t;for(let a=0;a<t;a++){let t=!1;Y(n[a]).subscribe(new x(e,e=>{t||(t=!0,o--),i[a]=e},()=>s--,void 0,()=>{(!s||!t)&&(o||e.next(r?Qf(r,i):i),e.complete())}))}});return t?i.pipe(Kf(t)):i}(mp(e,t).map(pp)).pipe(D(gp))}}function Ep(e){return null!=e?_p(yp(e)):null}function wp(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}function Pp(e){return e._rawValidators}function Sp(e){return e._rawAsyncValidators}function bp(e){return e?Array.isArray(e)?e:[e]:[]}function Op(e,t){return Array.isArray(e)?e.includes(t):e===t}function kp(e,t){const n=bp(t);return bp(e).forEach(e=>{Op(n,e)||n.push(e)}),n}function Tp(e,t){return bp(t).filter(t=>!Op(e,t))}let Ip=(()=>{class e{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Cp(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Ep(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=st({type:e}),e})(),Ap=(()=>{class e extends Ip{get formDirective(){return null}get path(){return null}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275dir=st({type:e,features:[Go]}),e})();class Mp extends Ip{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Np{constructor(e){this._cd=e}is(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}let Rp=(()=>{class e extends Np{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(ua(Mp,2))},e.\u0275dir=st({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&Va("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[Go]}),e})(),xp=(()=>{class e extends Np{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(ua(Ap,10))},e.\u0275dir=st({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&Va("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[Go]}),e})();function Dp(e,t){return[...t.path,e]}function Lp(e,t){Vp(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&$p(e,t)})}(e,t),function(e,t){const n=(e,n)=>{t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(()=>{e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&$p(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){const n=e=>{t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(n)})}}(e,t)}function Fp(e,t,n=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),Bp(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function Up(e,t){e.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function Vp(e,t){const n=Pp(e);null!==t.validator?e.setValidators(wp(n,t.validator)):"function"==typeof n&&e.setValidators([n]);const r=Sp(e);null!==t.asyncValidator?e.setAsyncValidators(wp(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);const i=()=>e.updateValueAndValidity();Up(t._rawValidators,i),Up(t._rawAsyncValidators,i)}function Bp(e,t){let n=!1;if(null!==e){if(null!==t.validator){const r=Pp(e);if(Array.isArray(r)&&r.length>0){const i=r.filter(e=>e!==t.validator);i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){const r=Sp(e);if(Array.isArray(r)&&r.length>0){const i=r.filter(e=>e!==t.asyncValidator);i.length!==r.length&&(n=!0,e.setAsyncValidators(i))}}}const r=()=>{};return Up(t._rawValidators,r),Up(t._rawAsyncValidators,r),n}function $p(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function zp(e,t){Vp(e,t)}function Hp(e,t){if(!e.hasOwnProperty("model"))return!1;const n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function Gp(e,t){e._syncPendingControls(),t.forEach(e=>{const t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function Zp(e,t){if(!t)return null;let n,r,i;return Array.isArray(t),t.forEach(e=>{e.constructor===rp?n=e:function(e){return Object.getPrototypeOf(e.constructor)===Jf}(e)?r=e:i=e}),i||r||n||null}function qp(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Wp="VALID",jp="INVALID",Yp="PENDING",Kp="DISABLED";function Qp(e){return(tg(e)?e.validators:e)||null}function Xp(e){return Array.isArray(e)?Cp(e):e||null}function Jp(e,t){return(tg(t)?t.asyncValidators:e)||null}function eg(e){return Array.isArray(e)?Ep(e):e||null}function tg(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class ng{constructor(e,t){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=Xp(this._rawValidators),this._composedAsyncValidatorFn=eg(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Wp}get invalid(){return this.status===jp}get pending(){return this.status==Yp}get disabled(){return this.status===Kp}get enabled(){return this.status!==Kp}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=Xp(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=eg(e)}addValidators(e){this.setValidators(kp(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(kp(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Tp(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Tp(e,this._rawAsyncValidators))}hasValidator(e){return Op(this._rawValidators,e)}hasAsyncValidator(e){return Op(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Yp,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Kp,this.errors=null,this._forEachChild(t=>{t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Wp,this._forEachChild(t=>{t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Wp||this.status===Yp)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Kp:Wp}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Yp,this._hasOwnPendingAsyncValidator=!0;const t=pp(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(t=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(t,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;let r=e;return t.forEach(e=>{r=r instanceof ig?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof sg&&r.at(e)||null}),r}(this,e)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Nu,this.statusChanges=new Nu}_calculateStatus(){return this._allControlsDisabled()?Kp:this.errors?jp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Yp)?Yp:this._anyControlsHaveStatus(jp)?jp:Wp}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){tg(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class rg extends ng{constructor(e=null,t,n){super(Qp(t),Jp(n,t)),this._onChange=[],this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(e=>e(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=null,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){qp(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){qp(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class ig extends ng{constructor(e,t,n){super(Qp(t),Jp(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){this._checkAllValuesPresent(e),Object.keys(e).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t instanceof rg?t.value:t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(e,t)=>!!t._syncPendingControls()||e);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error(`Cannot find form control with name: ${e}.`)}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const n=this.controls[t];if(this.contains(t)&&e(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,n)=>((t.enabled||this.disabled)&&(e[n]=t.value),e))}_reduceChildren(e,t){let n=e;return this._forEachChild((e,r)=>{n=t(n,e,r)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(e){this._forEachChild((t,n)=>{if(void 0===e[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class sg extends ng{constructor(e,t,n){super(Qp(t),Jp(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){this._checkAllValuesPresent(e),e.forEach((e,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((e,n)=>{this.at(n)&&this.at(n).patchValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e instanceof rg?e.value:e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((e,t)=>!!t._syncPendingControls()||e,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error(`Cannot find form control at index ${e}`)}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_checkAllValuesPresent(e){this._forEachChild((t,n)=>{if(void 0===e[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const og={provide:Ap,useExisting:ge(()=>lg)},ag=(()=>Promise.resolve(null))();let lg=(()=>{class e extends Ap{constructor(e,t){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new Nu,this.form=new ig({},Cp(e),Ep(t))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){ag.then(()=>{const t=this._findContainer(e.path);e.control=t.registerControl(e.name,e.control),Lp(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){ag.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name),qp(this._directives,e)})}addFormGroup(e){ag.then(()=>{const t=this._findContainer(e.path),n=new ig({});zp(n,e),t.registerControl(e.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){ag.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,t){ag.then(()=>{this.form.get(e.path).setValue(t)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,Gp(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return e.\u0275fac=function(t){return new(t||e)(ua(op,10),ua(ap,10))},e.\u0275dir=st({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&Ea("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[gc([og]),Go]}),e})();const cg={provide:Mp,useExisting:ge(()=>hg)},ug=(()=>Promise.resolve(null))();let hg=(()=>{class e extends Mp{constructor(e,t,n,r){super(),this.control=new rg,this._registered=!1,this.update=new Nu,this._parent=e,this._setValidators(t),this._setAsyncValidators(n),this.valueAccessor=Zp(0,r)}ngOnChanges(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),Hp(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?Dp(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Lp(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){ug.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1})})}_updateDisabled(e){const t=e.isDisabled.currentValue,n=""===t||t&&"false"!==t;ug.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable()})}}return e.\u0275fac=function(t){return new(t||e)(ua(Ap,9),ua(op,10),ua(ap,10),ua(ep,10))},e.\u0275dir=st({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[gc([cg]),Go,vt]}),e})(),dg=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=st({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})(),fg=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({}),e})();const pg={provide:ep,useExisting:ge(()=>gg),multi:!0};let gg=(()=>{class e extends Jf{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=t=>{e(""==t?null:parseFloat(t))}}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275dir=st({type:e,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&Ea("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[gc([pg]),Go]}),e})();const mg=new or("NgModelWithFormControlWarning"),yg={provide:Ap,useExisting:ge(()=>vg)};let vg=(()=>{class e extends Ap{constructor(e,t){super(),this.validators=e,this.asyncValidators=t,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Nu,this._setValidators(e),this._setAsyncValidators(t)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Bp(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const t=this.form.get(e.path);return Lp(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}getControl(e){return this.form.get(e.path)}removeControl(e){Fp(e.control||null,e,!1),qp(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,t){this.form.get(e.path).setValue(t)}onSubmit(e){return this.submitted=!0,Gp(this.form,this.directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const t=e.control,n=this.form.get(e.path);t!==n&&(Fp(t||null,e),n instanceof rg&&(Lp(n,e),e.control=n))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const t=this.form.get(e.path);zp(t,e),t.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const t=this.form.get(e.path);t&&function(e,t){return Bp(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Vp(this.form,this),this._oldForm&&Bp(this._oldForm,this)}_checkFormPresent(){}}return e.\u0275fac=function(t){return new(t||e)(ua(op,10),ua(ap,10))},e.\u0275dir=st({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&Ea("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[gc([yg]),Go,vt]}),e})();const Cg={provide:Mp,useExisting:ge(()=>_g)};let _g=(()=>{class e extends Mp{constructor(e,t,n,r,i){super(),this._ngModelWarningConfig=i,this._added=!1,this.update=new Nu,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(t),this._setAsyncValidators(n),this.valueAccessor=Zp(0,r)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),Hp(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Dp(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return e.\u0275fac=function(t){return new(t||e)(ua(Ap,13),ua(op,10),ua(ap,10),ua(ep,10),ua(mg,8))},e.\u0275dir=st({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[gc([Cg]),Go,vt]}),e._ngModelWarningSentOnce=!1,e})();const Eg={provide:ep,useExisting:ge(()=>Pg),multi:!0};function wg(e,t){return null==e?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let Pg=(()=>{class e extends Jf{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);const n=wg(t,e);this.setProperty("value",n)}registerOnChange(e){this.onChange=t=>{this.value=this._getOptionValue(t),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t),e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275dir=st({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&Ea("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[gc([Eg]),Go]}),e})(),Sg=(()=>{class e{constructor(e,t,n){this._element=e,this._renderer=t,this._select=n,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(wg(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(ua(Pc),ua(Oc),ua(Pg,9))},e.\u0275dir=st({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const bg={provide:ep,useExisting:ge(()=>kg),multi:!0};function Og(e,t){return null==e?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let kg=(()=>{class e extends Jf{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let t;if(this.value=e,Array.isArray(e)){const n=e.map(e=>this._getOptionId(e));t=(e,t)=>{e._setSelected(n.indexOf(t.toString())>-1)}}else t=(e,t)=>{e._setSelected(!1)};this._optionMap.forEach(t)}registerOnChange(e){this.onChange=t=>{const n=[];if(void 0!==t.selectedOptions){const e=t.selectedOptions;for(let t=0;t<e.length;t++){const r=e.item(t),i=this._getOptionValue(r.value);n.push(i)}}else{const e=t.options;for(let t=0;t<e.length;t++){const r=e.item(t);if(r.selected){const e=this._getOptionValue(r.value);n.push(e)}}}this.value=n,e(n)}}_registerOption(e){const t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t)._value,e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275dir=st({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&Ea("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[gc([bg]),Go]}),e})(),Tg=(()=>{class e{constructor(e,t,n){this._element=e,this._renderer=t,this._select=n,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(Og(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(Og(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(ua(Pc),ua(Oc),ua(kg,9))},e.\u0275dir=st({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const Ig={provide:op,useExisting:ge(()=>Ag),multi:!0};let Ag=(()=>{class e{constructor(){this._required=!1}get required(){return this._required}set required(e){this._required=null!=e&&!1!==e&&"false"!=`${e}`,this._onChange&&this._onChange()}validate(e){return this.required?up(e):null}registerOnValidatorChange(e){this._onChange=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=st({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&ra("required",t.required?"":null)},inputs:{required:"required"},features:[gc([Ig])]}),e})();const Mg={provide:op,useExisting:ge(()=>Ng),multi:!0};let Ng=(()=>{class e{constructor(){this._validator=dp}ngOnChanges(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}validate(e){return this.enabled()?this._validator(e):null}registerOnValidatorChange(e){this._onChange=e}_createValidator(){this._validator=this.enabled()?hp(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):dp}enabled(){return null!=this.maxlength}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=st({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&ra("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[gc([Mg]),vt]}),e})(),Rg=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({imports:[[fg]]}),e})(),xg=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({imports:[Rg]}),e})(),Dg=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:mg,useValue:t.warnOnNgModelWithFormControl}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({imports:[Rg]}),e})(),Lg=(()=>{class e{group(e,t=null){const n=this._reduceControls(e);let r,i=null,s=null;return null!=t&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(t)?(i=null!=t.validators?t.validators:null,s=null!=t.asyncValidators?t.asyncValidators:null,r=null!=t.updateOn?t.updateOn:void 0):(i=null!=t.validator?t.validator:null,s=null!=t.asyncValidator?t.asyncValidator:null)),new ig(n,{asyncValidators:s,updateOn:r,validators:i})}control(e,t,n){return new rg(e,t,n)}array(e,t,n){const r=e.map(e=>this._createControl(e));return new sg(r,t,n)}_reduceControls(e){const t={};return Object.keys(e).forEach(n=>{t[n]=this._createControl(e[n])}),t}_createControl(e){return e instanceof rg||e instanceof ig||e instanceof sg?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({factory:function(){return new e},token:e,providedIn:Dg}),e})();function Fg(...e){return ae(e,re(e))}function Ug(e,t){return r(t)?X(e,t,1):X(e,1)}function Vg(e,t){return R((n,r)=>{let i=0;n.subscribe(new x(r,n=>e.call(t,n,i++)&&r.next(n)))})}class Bg{}class $g{}class zg{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(e=>{const t=e.indexOf(":");if(t>0){const n=e.slice(0,t),r=n.toLowerCase(),i=e.slice(t+1).trim();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(i):this.headers.set(r,[i])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const r=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof zg?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new zg;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof zg?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":const i=e.value;if(i){let e=this.headers.get(t);if(!e)return;e=e.filter(e=>-1===i.indexOf(e)),0===e.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,e)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Hg{encodeKey(e){return qg(e)}encodeValue(e){return qg(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Gg=/%(\d[a-f0-9])/gi,Zg={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function qg(e){return encodeURIComponent(e).replace(Gg,(e,t)=>{var n;return null!==(n=Zg[t])&&void 0!==n?n:e})}function Wg(e){return`${e}`}class jg{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Hg,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){const n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(e=>{const r=e.indexOf("="),[i,s]=-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],o=n.get(i)||[];o.push(s),n.set(i,o)}),n}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t];this.map.set(t,Array.isArray(n)?n:[n])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const r=e[n];Array.isArray(r)?r.forEach(e=>{t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(e=>t+"="+this.encoder.encodeValue(e)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new jg({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Wg(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let t=this.map.get(e.param)||[];const n=t.indexOf(Wg(e.value));-1!==n&&t.splice(n,1),t.length>0?this.map.set(e.param,t):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Yg{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}keys(){return this.map.keys()}}function Kg(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function Qg(e){return"undefined"!=typeof Blob&&e instanceof Blob}function Xg(e){return"undefined"!=typeof FormData&&e instanceof FormData}class Jg{constructor(e,t,n,r){let i;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,i=r):i=n,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new zg),this.context||(this.context=new Yg),this.params){const e=this.params.toString();if(0===e.length)this.urlWithParams=t;else{const n=t.indexOf("?");this.urlWithParams=t+(-1===n?"?":n<t.length-1?"&":"")+e}}else this.params=new jg,this.urlWithParams=t}serializeBody(){return null===this.body?null:Kg(this.body)||Qg(this.body)||Xg(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof jg?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Xg(this.body)?null:Qg(this.body)?this.body.type||null:Kg(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof jg?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const n=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const u=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((t,n)=>t.set(n,e.setHeaders[n]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((t,n)=>t.set(n,e.setParams[n]),c)),new Jg(n,r,s,{params:c,headers:l,context:u,reportProgress:a,responseType:i,withCredentials:o})}}var em=(()=>((em=em||{})[em.Sent=0]="Sent",em[em.UploadProgress=1]="UploadProgress",em[em.ResponseHeader=2]="ResponseHeader",em[em.DownloadProgress=3]="DownloadProgress",em[em.Response=4]="Response",em[em.User=5]="User",em))();class tm{constructor(e,t=200,n="OK"){this.headers=e.headers||new zg,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class nm extends tm{constructor(e={}){super(e),this.type=em.ResponseHeader}clone(e={}){return new nm({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class rm extends tm{constructor(e={}){super(e),this.type=em.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new rm({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class im extends tm{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function sm(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let om=(()=>{class e{constructor(e){this.handler=e}request(e,t,n={}){let r;if(e instanceof Jg)r=e;else{let i,s;i=n.headers instanceof zg?n.headers:new zg(n.headers),n.params&&(s=n.params instanceof jg?n.params:new jg({fromObject:n.params})),r=new Jg(e,t,void 0!==n.body?n.body:null,{headers:i,context:n.context,params:s,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const i=Fg(r).pipe(Ug(e=>this.handler.handle(e)));if(e instanceof Jg||"events"===n.observe)return i;const s=i.pipe(Vg(e=>e instanceof rm));switch(n.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return s.pipe(D(e=>{if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return s.pipe(D(e=>{if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return s.pipe(D(e=>{if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));default:return s.pipe(D(e=>e.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(e,t={}){return this.request("DELETE",e,t)}get(e,t={}){return this.request("GET",e,t)}head(e,t={}){return this.request("HEAD",e,t)}jsonp(e,t){return this.request("JSONP",e,{params:(new jg).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,t={}){return this.request("OPTIONS",e,t)}patch(e,t,n={}){return this.request("PATCH",e,sm(n,t))}post(e,t,n={}){return this.request("POST",e,sm(n,t))}put(e,t,n={}){return this.request("PUT",e,sm(n,t))}}return e.\u0275fac=function(t){return new(t||e)(Or(Bg))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class am{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const lm=new or("HTTP_INTERCEPTORS");let cm=(()=>{class e{intercept(e,t){return t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const um=/^\)\]\}',?\n/;let hm=(()=>{class e{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new k(t=>{const n=this.xhrFactory.build();if(n.open(e.method,e.urlWithParams),e.withCredentials&&(n.withCredentials=!0),e.headers.forEach((e,t)=>n.setRequestHeader(e,t.join(","))),e.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const t=e.detectContentTypeHeader();null!==t&&n.setRequestHeader("Content-Type",t)}if(e.responseType){const t=e.responseType.toLowerCase();n.responseType="json"!==t?t:"text"}const r=e.serializeBody();let i=null;const s=()=>{if(null!==i)return i;const t=1223===n.status?204:n.status,r=n.statusText||"OK",s=new zg(n.getAllResponseHeaders()),o=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(n)||e.url;return i=new nm({headers:s,status:t,statusText:r,url:o}),i},o=()=>{let{headers:r,status:i,statusText:o,url:a}=s(),l=null;204!==i&&(l=void 0===n.response?n.responseText:n.response),0===i&&(i=l?200:0);let c=i>=200&&i<300;if("json"===e.responseType&&"string"==typeof l){const e=l;l=l.replace(um,"");try{l=""!==l?JSON.parse(l):null}catch(u){l=e,c&&(c=!1,l={error:u,text:l})}}c?(t.next(new rm({body:l,headers:r,status:i,statusText:o,url:a||void 0})),t.complete()):t.error(new im({error:l,headers:r,status:i,statusText:o,url:a||void 0}))},a=e=>{const{url:r}=s(),i=new im({error:e,status:n.status||0,statusText:n.statusText||"Unknown Error",url:r||void 0});t.error(i)};let l=!1;const c=r=>{l||(t.next(s()),l=!0);let i={type:em.DownloadProgress,loaded:r.loaded};r.lengthComputable&&(i.total=r.total),"text"===e.responseType&&!!n.responseText&&(i.partialText=n.responseText),t.next(i)},u=e=>{let n={type:em.UploadProgress,loaded:e.loaded};e.lengthComputable&&(n.total=e.total),t.next(n)};return n.addEventListener("load",o),n.addEventListener("error",a),n.addEventListener("timeout",a),n.addEventListener("abort",a),e.reportProgress&&(n.addEventListener("progress",c),null!==r&&n.upload&&n.upload.addEventListener("progress",u)),n.send(r),t.next({type:em.Sent}),()=>{n.removeEventListener("error",a),n.removeEventListener("abort",a),n.removeEventListener("load",o),n.removeEventListener("timeout",a),e.reportProgress&&(n.removeEventListener("progress",c),null!==r&&n.upload&&n.upload.removeEventListener("progress",u)),n.readyState!==n.DONE&&n.abort()}})}}return e.\u0275fac=function(t){return new(t||e)(Or(uf))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const dm=new or("XSRF_COOKIE_NAME"),fm=new or("XSRF_HEADER_NAME");class pm{}let gm=(()=>{class e{constructor(e,t,n){this.doc=e,this.platform=t,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Kd(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return e.\u0275fac=function(t){return new(t||e)(Or(jh),Or(th),Or(dm))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),mm=(()=>{class e{constructor(e,t){this.tokenService=e,this.headerName=t}intercept(e,t){const n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);const r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(Or(pm),Or(fm))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),ym=(()=>{class e{constructor(e,t){this.backend=e,this.injector=t,this.chain=null}handle(e){if(null===this.chain){const e=this.injector.get(lm,[]);this.chain=e.reduceRight((e,t)=>new am(e,t),this.backend)}return this.chain.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(Or($g),Or(zo))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),vm=(()=>{class e{static disable(){return{ngModule:e,providers:[{provide:mm,useClass:cm}]}}static withOptions(t={}){return{ngModule:e,providers:[t.cookieName?{provide:dm,useValue:t.cookieName}:[],t.headerName?{provide:fm,useValue:t.headerName}:[]]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[mm,{provide:lm,useExisting:mm,multi:!0},{provide:pm,useClass:gm},{provide:dm,useValue:"XSRF-TOKEN"},{provide:fm,useValue:"X-XSRF-TOKEN"}]}),e})(),Cm=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[om,{provide:Bg,useClass:ym},hm,{provide:$g,useExisting:hm}],imports:[[vm.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e})();class _m extends A{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}function Em(e,t,n){e?Q(n,e,t):t()}const wm=i(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function Pm(...e){return J(1)(ae(e,re(e)))}function Sm(e){return new k(t=>{Y(e()).subscribe(t)})}function bm(){return R((e,t)=>{let n=null;e._refCount++;const r=new x(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()});e.subscribe(r),r.closed||(n=e.connect())})}class Om extends k{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,N(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new a;const t=this.getSubject();e.add(this.source.subscribe(new x(t,void 0,()=>{this._teardown(),t.complete()},e=>{this._teardown(),t.error(e)},()=>this._teardown()))),e.closed&&(this._connection=null,e=a.EMPTY)}return e}refCount(){return bm()(this)}}function km(e,t){return R((n,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();n.subscribe(new x(r,n=>{null==i||i.unsubscribe();let o=0;const l=s++;Y(e(n,l)).subscribe(i=new x(r,e=>r.next(t?t(n,e,l,o++):e),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Tm(e,t,n,r,i){return(s,o)=>{let a=n,l=t,c=0;s.subscribe(new x(o,t=>{const n=c++;l=a?e(l,t,n):(a=!0,t),r&&o.next(l)},i&&(()=>{a&&o.next(l),o.complete()})))}}function Im(e,t){return R(Tm(e,t,arguments.length>=2,!0))}function Am(e){return R((t,n)=>{let r,i=null,s=!1;i=t.subscribe(new x(n,void 0,void 0,o=>{r=Y(e(o,Am(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):s=!0})),s&&(i.unsubscribe(),i=null,r.subscribe(n))})}function Mm(e){return e<=0?()=>ee:R((t,n)=>{let r=[];t.subscribe(new x(n,t=>{r.push(t),e<r.length&&r.shift()},()=>{for(const e of r)n.next(e);n.complete()},void 0,()=>{r=null}))})}function Nm(e=Rm){return R((t,n)=>{let r=!1;t.subscribe(new x(n,e=>{r=!0,n.next(e)},()=>r?n.complete():n.error(e())))})}function Rm(){return new wm}function xm(e){return R((t,n)=>{let r=!1;t.subscribe(new x(n,e=>{r=!0,n.next(e)},()=>{r||n.next(e),n.complete()}))})}function Dm(e,t){const n=arguments.length>=2;return r=>r.pipe(e?Vg((t,n)=>e(t,n,r)):O,le(1),n?xm(t):Nm(()=>new wm))}function Lm(e,t,n){const i=r(e)||t||n?{next:e,error:t,complete:n}:e;return i?R((e,t)=>{var n;null===(n=i.subscribe)||void 0===n||n.call(i);let r=!0;e.subscribe(new x(t,e=>{var n;null===(n=i.next)||void 0===n||n.call(i,e),t.next(e)},()=>{var e;r=!1,null===(e=i.complete)||void 0===e||e.call(i),t.complete()},e=>{var n;r=!1,null===(n=i.error)||void 0===n||n.call(i,e),t.error(e)},()=>{var e,t;r&&(null===(e=i.unsubscribe)||void 0===e||e.call(i)),null===(t=i.finalize)||void 0===t||t.call(i)}))}):O}class Fm{constructor(e,t){this.id=e,this.url=t}}class Um extends Fm{constructor(e,t,n="imperative",r=null){super(e,t),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Vm extends Fm{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Bm extends Fm{constructor(e,t,n){super(e,t),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class $m extends Fm{constructor(e,t,n){super(e,t),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class zm extends Fm{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hm extends Fm{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Gm extends Fm{constructor(e,t,n,r,i){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Zm extends Fm{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class qm extends Fm{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Wm{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class jm{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Ym{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Km{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Qm{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Xm{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Jm{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const ey="primary";class ty{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function ny(e){return new ty(e)}const ry="ngNavigationCancelingError";function iy(e){const t=Error("NavigationCancelingError: "+e);return t[ry]=!0,t}function sy(e,t,n){const r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;const i={};for(let s=0;s<r.length;s++){const t=r[s],n=e[s];if(t.startsWith(":"))i[t.substring(1)]=n;else if(t!==n.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function oy(e,t){const n=e?Object.keys(e):void 0,r=t?Object.keys(t):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!ay(e[i],t[i]))return!1;return!0}function ay(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),r=[...t].sort();return n.every((e,t)=>r[t]===e)}return e===t}function ly(e){return Array.prototype.concat.apply([],e)}function cy(e){return e.length>0?e[e.length-1]:null}function uy(e,t){for(const n in e)e.hasOwnProperty(n)&&t(e[n],n)}function hy(e){return _a(e)?e:Ca(e)?ae(Promise.resolve(e)):Fg(e)}const dy={exact:function e(t,n,r){if(!Ey(t.segments,n.segments)||!yy(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(const i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:gy},fy={exact:function(e,t){return oy(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>ay(e[n],t[n]))},ignored:()=>!0};function py(e,t,n){return dy[n.paths](e.root,t.root,n.matrixParams)&&fy[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function gy(e,t,n){return my(e,t,t.segments,n)}function my(e,t,n,r){if(e.segments.length>n.length){const i=e.segments.slice(0,n.length);return!(!Ey(i,n)||t.hasChildren()||!yy(i,n,r))}if(e.segments.length===n.length){if(!Ey(e.segments,n)||!yy(e.segments,n,r))return!1;for(const n in t.children)if(!e.children[n]||!gy(e.children[n],t.children[n],r))return!1;return!0}{const i=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(Ey(e.segments,i)&&yy(e.segments,i,r)&&e.children[ey])&&my(e.children[ey],t,s,r)}}function yy(e,t,n){return t.every((t,r)=>fy[n](e[r].parameters,t.parameters))}class vy{constructor(e,t,n){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ny(this.queryParams)),this._queryParamMap}toString(){return Sy.serialize(this)}}class Cy{constructor(e,t){this.segments=e,this.children=t,this.parent=null,uy(t,(e,t)=>e.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return by(this)}}class _y{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=ny(this.parameters)),this._parameterMap}toString(){return Ny(this)}}function Ey(e,t){return e.length===t.length&&e.every((e,n)=>e.path===t[n].path)}class wy{}class Py{parse(e){const t=new Fy(e);return new vy(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Oy(e.root,!0)}`,n=function(e){const t=Object.keys(e).map(t=>{const n=e[t];return Array.isArray(n)?n.map(e=>`${Ty(t)}=${Ty(e)}`).join("&"):`${Ty(t)}=${Ty(n)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(e.queryParams);var r;return`${t}${n}${"string"==typeof e.fragment?`#${r=e.fragment,encodeURI(r)}`:""}`}}const Sy=new Py;function by(e){return e.segments.map(e=>Ny(e)).join("/")}function Oy(e,t){if(!e.hasChildren())return by(e);if(t){const t=e.children[ey]?Oy(e.children[ey],!1):"",n=[];return uy(e.children,(e,t)=>{t!==ey&&n.push(`${t}:${Oy(e,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function(e,t){let n=[];return uy(e.children,(e,r)=>{r===ey&&(n=n.concat(t(e,r)))}),uy(e.children,(e,r)=>{r!==ey&&(n=n.concat(t(e,r)))}),n}(e,(t,n)=>n===ey?[Oy(e.children[ey],!1)]:[`${n}:${Oy(t,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[ey]?`${by(e)}/${t[0]}`:`${by(e)}/(${t.join("//")})`}}function ky(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ty(e){return ky(e).replace(/%3B/gi,";")}function Iy(e){return ky(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ay(e){return decodeURIComponent(e)}function My(e){return Ay(e.replace(/\+/g,"%20"))}function Ny(e){return`${Iy(e.path)}${function(e){return Object.keys(e).map(t=>`;${Iy(t)}=${Iy(e[t])}`).join("")}(e.parameters)}`}const Ry=/^[^\/()?;=#]+/;function xy(e){const t=e.match(Ry);return t?t[0]:""}const Dy=/^[^=?&#]+/,Ly=/^[^?&#]+/;class Fy{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Cy([],{}):new Cy([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[ey]=new Cy(e,t)),n}parseSegment(){const e=xy(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new _y(Ay(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=xy(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const e=xy(this.remaining);e&&(n=e,this.capture(n))}e[Ay(t)]=Ay(n)}parseQueryParam(e){const t=function(e){const t=e.match(Dy);return t?t[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const e=function(e){const t=e.match(Ly);return t?t[0]:""}(this.remaining);e&&(n=e,this.capture(n))}const r=My(t),i=My(n);if(e.hasOwnProperty(r)){let t=e[r];Array.isArray(t)||(t=[t],e[r]=t),t.push(i)}else e[r]=i}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=xy(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=ey);const s=this.parseChildren();t[i]=1===Object.keys(s).length?s[ey]:new Cy([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class Uy{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Vy(e,this._root);return t?t.children.map(e=>e.value):[]}firstChild(e){const t=Vy(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=By(e,this._root);return t.length<2?[]:t[t.length-2].children.map(e=>e.value).filter(t=>t!==e)}pathFromRoot(e){return By(e,this._root).map(e=>e.value)}}function Vy(e,t){if(e===t.value)return t;for(const n of t.children){const t=Vy(e,n);if(t)return t}return null}function By(e,t){if(e===t.value)return[t];for(const n of t.children){const r=By(e,n);if(r.length)return r.unshift(t),r}return[]}class $y{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function zy(e){const t={};return e&&e.children.forEach(e=>t[e.value.outlet]=e),t}class Hy extends Uy{constructor(e,t){super(e),this.snapshot=t,Yy(this,e)}toString(){return this.snapshot.toString()}}function Gy(e,t){const n=function(e,t){const n=new Wy([],{},{},"",{},ey,t,null,e.root,-1,{});return new jy("",new $y(n,[]))}(e,t),r=new _m([new _y("",{})]),i=new _m({}),s=new _m({}),o=new _m({}),a=new _m(""),l=new Zy(r,i,o,a,s,ey,t,n.root);return l.snapshot=n.root,new Hy(new $y(l,[]),n)}class Zy{constructor(e,t,n,r,i,s,o,a){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=s,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(D(e=>ny(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(D(e=>ny(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function qy(e,t="emptyOnly"){const n=e.pathFromRoot;let r=0;if("always"!==t)for(r=n.length-1;r>=1;){const e=n[r],t=n[r-1];if(e.routeConfig&&""===e.routeConfig.path)r--;else{if(t.component)break;r--}}return function(e){return e.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class Wy{constructor(e,t,n,r,i,s,o,a,l,c,u){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=s,this.component=o,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ny(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ny(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(e=>e.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class jy extends Uy{constructor(e,t){super(t),this.url=e,Yy(this,t)}toString(){return Ky(this._root)}}function Yy(e,t){t.value._routerState=e,t.children.forEach(t=>Yy(e,t))}function Ky(e){const t=e.children.length>0?` { ${e.children.map(Ky).join(", ")} } `:"";return`${e.value}${t}`}function Qy(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,oy(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),oy(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!oy(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),oy(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function Xy(e,t){const n=oy(e.params,t.params)&&function(e,t){return Ey(e,t)&&e.every((e,n)=>oy(e.parameters,t[n].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||Xy(e.parent,t.parent))}function Jy(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=t.value;const i=function(e,t,n){return t.children.map(t=>{for(const r of n.children)if(e.shouldReuseRoute(t.value,r.value.snapshot))return Jy(e,t,r);return Jy(e,t)})}(e,t,n);return new $y(r,i)}{if(e.shouldAttach(t.value)){const n=e.retrieve(t.value);if(null!==n){const e=n.route;return ev(t,e),e}}const n=function(e){return new Zy(new _m(e.url),new _m(e.params),new _m(e.queryParams),new _m(e.fragment),new _m(e.data),e.outlet,e.component,e)}(t.value),r=t.children.map(t=>Jy(e,t));return new $y(n,r)}}function ev(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(let n=0;n<e.children.length;++n)ev(e.children[n],t.children[n])}function tv(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function nv(e){return"object"==typeof e&&null!=e&&e.outlets}function rv(e,t,n,r,i){let s={};return r&&uy(r,(e,t)=>{s[t]=Array.isArray(e)?e.map(e=>`${e}`):`${e}`}),new vy(n.root===e?t:iv(n.root,e,t),s,i)}function iv(e,t,n){const r={};return uy(e.children,(e,i)=>{r[i]=e===t?n:iv(e,t,n)}),new Cy(e.segments,r)}class sv{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&tv(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(nv);if(r&&r!==cy(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ov{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function av(e,t,n){if(e||(e=new Cy([],{})),0===e.segments.length&&e.hasChildren())return lv(e,t,n);const r=function(e,t,n){let r=0,i=t;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<e.segments.length;){if(r>=n.length)return s;const t=e.segments[i],o=n[r];if(nv(o))break;const a=`${o}`,l=r<n.length-1?n[r+1]:null;if(i>0&&void 0===a)break;if(a&&l&&"object"==typeof l&&void 0===l.outlets){if(!dv(a,l,t))return s;r+=2}else{if(!dv(a,{},t))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){const t=new Cy(e.segments.slice(0,r.pathIndex),{});return t.children[ey]=new Cy(e.segments.slice(r.pathIndex),e.children),lv(t,0,i)}return r.match&&0===i.length?new Cy(e.segments,{}):r.match&&!e.hasChildren()?cv(e,t,n):r.match?lv(e,0,i):cv(e,t,n)}function lv(e,t,n){if(0===n.length)return new Cy(e.segments,{});{const r=function(e){return nv(e[0])?e[0].outlets:{[ey]:e}}(n),i={};return uy(r,(n,r)=>{"string"==typeof n&&(n=[n]),null!==n&&(i[r]=av(e.children[r],t,n))}),uy(e.children,(e,t)=>{void 0===r[t]&&(i[t]=e)}),new Cy(e.segments,i)}}function cv(e,t,n){const r=e.segments.slice(0,t);let i=0;for(;i<n.length;){const s=n[i];if(nv(s)){const e=uv(s.outlets);return new Cy(r,e)}if(0===i&&tv(n[0])){r.push(new _y(e.segments[t].path,hv(n[0]))),i++;continue}const o=nv(s)?s.outlets[ey]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&tv(a)?(r.push(new _y(o,hv(a))),i+=2):(r.push(new _y(o,{})),i++)}return new Cy(r,{})}function uv(e){const t={};return uy(e,(e,n)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[n]=cv(new Cy([],{}),0,e))}),t}function hv(e){const t={};return uy(e,(e,n)=>t[n]=`${e}`),t}function dv(e,t,n){return e==n.path&&oy(t,n.parameters)}class fv{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Qy(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=zy(t);e.children.forEach(e=>{const t=e.value.outlet;this.deactivateRoutes(e,r[t],n),delete r[t]}),uy(r,(e,t)=>{this.deactivateRouteAndItsChildren(e,n)})}deactivateRoutes(e,t,n){const r=e.value,i=t?t.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(e,t,i.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet);if(n&&n.outlet){const t=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:t,route:e,contexts:r})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=zy(e);for(const s of Object.keys(i))this.deactivateRouteAndItsChildren(i[s],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=zy(t);e.children.forEach(e=>{this.activateRoutes(e,r[e.value.outlet],n),this.forwardEvent(new Xm(e.value.snapshot))}),e.children.length&&this.forwardEvent(new Km(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,i=t?t.value:null;if(Qy(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,i.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const t=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const e=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),t.children.onOutletReAttached(e.contexts),t.attachRef=e.componentRef,t.route=e.route.value,t.outlet&&t.outlet.attach(e.componentRef,e.route.value),pv(e.route)}else{const n=function(e){for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(r.snapshot),i=n?n.module.componentFactoryResolver:null;t.attachRef=null,t.route=r,t.resolver=i,t.outlet&&t.outlet.activateWith(r,i),this.activateChildRoutes(e,null,t.children)}}else this.activateChildRoutes(e,null,n)}}function pv(e){Qy(e.value),e.children.forEach(pv)}class gv{constructor(e,t){this.routes=e,this.module=t}}function mv(e){return"function"==typeof e}function yv(e){return e instanceof vy}const vv=Symbol("INITIAL_VALUE");function Cv(){return km(e=>function(...e){const t=re(e),n=ne(e),{args:r,keys:i}=jf(e);if(0===r.length)return ae([],t);const s=new k(function(e,t,n=O){return r=>{Em(t,()=>{const{length:i}=e,s=new Array(i);let o=i,a=i;for(let l=0;l<i;l++)Em(t,()=>{const i=ae(e[l],t);let c=!1;i.subscribe(new x(r,e=>{s[l]=e,c||(c=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,t,i?e=>Qf(i,e):O));return n?s.pipe(Kf(n)):s}(e.map(e=>e.pipe(le(1),function(...e){const t=re(e);return R((n,r)=>{(t?Pm(e,n,t):Pm(e,n)).subscribe(r)})}(vv)))).pipe(Im((e,t)=>{let n=!1;return t.reduce((e,r,i)=>e!==vv?e:(r===vv&&(n=!0),n||!1!==r&&i!==t.length-1&&!yv(r)?e:r),e)},vv),Vg(e=>e!==vv),D(e=>yv(e)?e:!0===e),le(1)))}let _v=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&ga(0,"router-outlet")},directives:function(){return[vC]},encapsulation:2}),e})();function Ev(e,t=""){for(let n=0;n<e.length;n++){const r=e[n];wv(r,Pv(t,r))}}function wv(e,t){e.children&&Ev(e.children,t)}function Pv(e,t){return t?e||t.path?e&&!t.path?`${e}/`:!e&&t.path?t.path:`${e}/${t.path}`:"":e}function Sv(e){const t=e.children&&e.children.map(Sv),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==ey&&(n.component=_v),n}function bv(e){return e.outlet||ey}function Ov(e,t){const n=e.filter(e=>bv(e)===t);return n.push(...e.filter(e=>bv(e)!==t)),n}const kv={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Tv(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},kv):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const i=(t.matcher||sy)(n,e,t);if(!i)return Object.assign({},kv);const s={};uy(i.posParams,(e,t)=>{s[t]=e.path});const o=i.consumed.length>0?Object.assign(Object.assign({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function Iv(e,t,n,r,i="corrected"){if(n.length>0&&function(e,t,n){return n.some(n=>Av(e,t,n)&&bv(n)!==ey)}(e,n,r)){const i=new Cy(t,function(e,t,n,r){const i={};i[ey]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;for(const s of n)if(""===s.path&&bv(s)!==ey){const n=new Cy([],{});n._sourceSegment=e,n._segmentIndexShift=t.length,i[bv(s)]=n}return i}(e,t,r,new Cy(n,e.children)));return i._sourceSegment=e,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(n=>Av(e,t,n))}(e,n,r)){const s=new Cy(e.segments,function(e,t,n,r,i,s){const o={};for(const a of r)if(Av(e,n,a)&&!i[bv(a)]){const n=new Cy([],{});n._sourceSegment=e,n._segmentIndexShift="legacy"===s?e.segments.length:t.length,o[bv(a)]=n}return Object.assign(Object.assign({},i),o)}(e,t,n,r,e.children,i));return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}const s=new Cy(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function Av(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function Mv(e,t,n,r){return!!(bv(e)===r||r!==ey&&Av(t,n,e))&&("**"===e.path||Tv(t,e,n).matched)}function Nv(e,t,n){return 0===t.length&&!e.children[n]}class Rv{constructor(e){this.segmentGroup=e||null}}class xv{constructor(e){this.urlTree=e}}function Dv(e){return new k(t=>t.error(new Rv(e)))}function Lv(e){return new k(t=>t.error(new xv(e)))}function Fv(e){return new k(t=>t.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e}'`)))}class Uv{constructor(e,t,n,r,i){this.configLoader=t,this.urlSerializer=n,this.urlTree=r,this.config=i,this.allowRedirects=!0,this.ngModule=e.get(iu)}apply(){const e=Iv(this.urlTree.root,[],[],this.config).segmentGroup,t=new Cy(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,ey).pipe(D(e=>this.createUrlTree(Vv(e),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Am(e=>{if(e instanceof xv)return this.allowRedirects=!1,this.match(e.urlTree);throw e instanceof Rv?this.noMatchError(e):e}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,ey).pipe(D(t=>this.createUrlTree(Vv(t),e.queryParams,e.fragment))).pipe(Am(e=>{throw e instanceof Rv?this.noMatchError(e):e}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,n){const r=e.segments.length>0?new Cy([],{[ey]:e}):e;return new vy(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(D(e=>new Cy([],e))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const i of Object.keys(n.children))"primary"===i?r.unshift(i):r.push(i);return ae(r).pipe(Ug(r=>{const i=n.children[r],s=Ov(t,r);return this.expandSegmentGroup(e,s,i,r).pipe(D(e=>({segment:e,outlet:r})))}),Im((e,t)=>(e[t.outlet]=t.segment,e),{}),function(e,t){const n=arguments.length>=2;return r=>r.pipe(e?Vg((t,n)=>e(t,n,r)):O,Mm(1),n?xm(t):Nm(()=>new wm))}())}expandSegment(e,t,n,r,i,s){return ae(n).pipe(Ug(o=>this.expandSegmentAgainstRoute(e,t,n,o,r,i,s).pipe(Am(e=>{if(e instanceof Rv)return Fg(null);throw e}))),Dm(e=>!!e),Am((e,n)=>{if(e instanceof wm||"EmptyError"===e.name){if(Nv(t,r,i))return Fg(new Cy([],{}));throw new Rv(t)}throw e}))}expandSegmentAgainstRoute(e,t,n,r,i,s,o){return Mv(r,t,i,s)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,s):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,s):Dv(t):Dv(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,s){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,s):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Lv(i):this.lineralizeSegments(n,i).pipe(X(n=>{const i=new Cy(n,{});return this.expandSegment(e,i,t,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,s){const{matched:o,consumedSegments:a,lastChild:l,positionalParamSegments:c}=Tv(t,r,i);if(!o)return Dv(t);const u=this.applyRedirectCommands(a,r.redirectTo,c);return r.redirectTo.startsWith("/")?Lv(u):this.lineralizeSegments(r,u).pipe(X(r=>this.expandSegment(e,t,n,r.concat(i.slice(l)),s,!1)))}matchSegmentAgainstRoute(e,t,n,r,i){if("**"===n.path)return n.loadChildren?(n._loadedConfig?Fg(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(D(e=>(n._loadedConfig=e,new Cy(r,{})))):Fg(new Cy(r,{}));const{matched:s,consumedSegments:o,lastChild:a}=Tv(t,n,r);if(!s)return Dv(t);const l=r.slice(a);return this.getChildConfig(e,n,r).pipe(X(e=>{const r=e.module,s=e.routes,{segmentGroup:a,slicedSegments:c}=Iv(t,o,l,s),u=new Cy(a.segments,a.children);if(0===c.length&&u.hasChildren())return this.expandChildren(r,s,u).pipe(D(e=>new Cy(o,e)));if(0===s.length&&0===c.length)return Fg(new Cy(o,{}));const h=bv(n)===i;return this.expandSegment(r,u,s,c,h?ey:i,!0).pipe(D(e=>new Cy(o.concat(e.segments),e.children)))}))}getChildConfig(e,t,n){return t.children?Fg(new gv(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Fg(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(X(n=>{return n?this.configLoader.load(e.injector,t).pipe(D(e=>(t._loadedConfig=e,e))):(r=t,new k(e=>e.error(iy(`Cannot load children because the guard of the route "path: '${r.path}'" returned false`))));var r})):Fg(new gv([],e))}runCanLoadGuards(e,t,n){const r=t.canLoad;return r&&0!==r.length?Fg(r.map(r=>{const i=e.get(r);let s;if((o=i)&&mv(o.canLoad))s=i.canLoad(t,n);else{if(!mv(i))throw new Error("Invalid CanLoad guard");s=i(t,n)}var o;return hy(s)})).pipe(Cv(),Lm(e=>{if(!yv(e))return;const t=iy(`Redirecting to "${this.urlSerializer.serialize(e)}"`);throw t.url=e,t}),D(e=>!0===e)):Fg(!0)}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Fg(n);if(r.numberOfChildren>1||!r.children[ey])return Fv(e.redirectTo);r=r.children[ey]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreatreUrlTree(e,t,n,r){const i=this.createSegmentGroup(e,t.root,n,r);return new vy(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return uy(e,(e,r)=>{if("string"==typeof e&&e.startsWith(":")){const i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}createSegmentGroup(e,t,n,r){const i=this.createSegments(e,t.segments,n,r);let s={};return uy(t.children,(t,i)=>{s[i]=this.createSegmentGroup(e,t,n,r)}),new Cy(i,s)}createSegments(e,t,n,r){return t.map(t=>t.path.startsWith(":")?this.findPosParam(e,t,r):this.findOrReturn(t,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}function Vv(e){const t={};for(const n of Object.keys(e.children)){const r=Vv(e.children[n]);(r.segments.length>0||r.hasChildren())&&(t[n]=r)}return function(e){if(1===e.numberOfChildren&&e.children[ey]){const t=e.children[ey];return new Cy(e.segments.concat(t.segments),t.children)}return e}(new Cy(e.segments,t))}class Bv{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class $v{constructor(e,t){this.component=e,this.route=t}}function zv(e,t,n){const r=e._root;return Gv(r,t?t._root:null,n,[r.value])}function Hv(e,t,n){const r=function(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function Gv(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=zy(t);return e.children.forEach(e=>{(function(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=e.value,o=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!Ey(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Ey(e.url,t.url)||!oy(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Xy(e,t)||!oy(e.queryParams,t.queryParams);default:return!Xy(e,t)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new Bv(r)):(s.data=o.data,s._resolvedData=o._resolvedData),Gv(e,t,s.component?a?a.children:null:n,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new $v(a.outlet.component,o))}else o&&Zv(t,a,i),i.canActivateChecks.push(new Bv(r)),Gv(e,null,s.component?a?a.children:null:n,r,i)})(e,s[e.value.outlet],n,r.concat([e.value]),i),delete s[e.value.outlet]}),uy(s,(e,t)=>Zv(e,n.getContext(t),i)),i}function Zv(e,t,n){const r=zy(e),i=e.value;uy(r,(e,r)=>{Zv(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new $v(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}class qv{}function Wv(e){return new k(t=>t.error(e))}class jv{constructor(e,t,n,r,i,s){this.rootComponentType=e,this.config=t,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=s}recognize(){const e=Iv(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,ey);if(null===t)return null;const n=new Wy([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},ey,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new $y(n,t),i=new jy(this.url,r);return this.inheritParamsAndData(i._root),i}inheritParamsAndData(e){const t=e.value,n=qy(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(e=>this.inheritParamsAndData(e))}processSegmentGroup(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}processChildren(e,t){const n=[];for(const i of Object.keys(t.children)){const r=t.children[i],s=Ov(e,i),o=this.processSegmentGroup(s,r,i);if(null===o)return null;n.push(...o)}const r=Kv(n);return r.sort((e,t)=>e.value.outlet===ey?-1:t.value.outlet===ey?1:e.value.outlet.localeCompare(t.value.outlet)),r}processSegment(e,t,n,r){for(const i of e){const e=this.processSegmentAgainstRoute(i,t,n,r);if(null!==e)return e}return Nv(t,n,r)?[]:null}processSegmentAgainstRoute(e,t,n,r){if(e.redirectTo||!Mv(e,t,n,r))return null;let i,s=[],o=[];if("**"===e.path){const r=n.length>0?cy(n).parameters:{};i=new Wy(n,r,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Jv(e),bv(e),e.component,e,Qv(t),Xv(t)+n.length,eC(e))}else{const r=Tv(t,e,n);if(!r.matched)return null;s=r.consumedSegments,o=n.slice(r.lastChild),i=new Wy(s,r.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Jv(e),bv(e),e.component,e,Qv(t),Xv(t)+s.length,eC(e))}const a=(u=e).children?u.children:u.loadChildren?u._loadedConfig.routes:[],{segmentGroup:l,slicedSegments:c}=Iv(t,s,o,a.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution);var u;if(0===c.length&&l.hasChildren()){const e=this.processChildren(a,l);return null===e?null:[new $y(i,e)]}if(0===a.length&&0===c.length)return[new $y(i,[])];const h=bv(e)===r,d=this.processSegment(a,l,c,h?ey:r);return null===d?null:[new $y(i,d)]}}function Yv(e){const t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function Kv(e){const t=[],n=new Set;for(const r of e){if(!Yv(r)){t.push(r);continue}const e=t.find(e=>r.value.routeConfig===e.value.routeConfig);void 0!==e?(e.children.push(...r.children),n.add(e)):t.push(r)}for(const r of n){const e=Kv(r.children);t.push(new $y(r.value,e))}return t.filter(e=>!n.has(e))}function Qv(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function Xv(e){let t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,n+=t._segmentIndexShift?t._segmentIndexShift:0;return n-1}function Jv(e){return e.data||{}}function eC(e){return e.resolve||{}}function tC(e){return km(t=>{const n=e(t);return n?ae(n).pipe(D(()=>t)):Fg(t)})}class nC extends class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const rC=new or("ROUTES");class iC{constructor(e,t,n,r){this.loader=e,this.compiler=t,this.onLoadStartListener=n,this.onLoadEndListener=r}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const n=this.loadModuleFactory(t.loadChildren).pipe(D(n=>{this.onLoadEndListener&&this.onLoadEndListener(t);const r=n.create(e);return new gv(ly(r.injector.get(rC,void 0,Ne.Self|Ne.Optional)).map(Sv),r)}),Am(e=>{throw t._loader$=void 0,e}));return t._loader$=new Om(n,()=>new A).pipe(bm()),t._loader$}loadModuleFactory(e){return"string"==typeof e?ae(this.loader.load(e)):hy(e()).pipe(X(e=>e instanceof su?Fg(e):ae(this.compiler.compileModuleAsync(e))))}}class sC{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new oC,this.attachRef=null}}class oC{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new sC,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}class aC{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function lC(e){throw e}function cC(e,t,n){return t.parse("/")}function uC(e,t){return Fg(null)}const hC={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},dC={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let fC=(()=>{class e{constructor(e,t,n,r,i,s,o,a){this.rootComponentType=e,this.urlSerializer=t,this.rootContexts=n,this.location=r,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new A,this.errorHandler=lC,this.malformedUriErrorHandler=cC,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:uC,afterPreactivation:uC},this.urlHandlingStrategy=new aC,this.routeReuseStrategy=new nC,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=i.get(iu),this.console=i.get(rh);const l=i.get(mh);this.isNgZoneEnabled=l instanceof mh&&mh.isInAngularZone(),this.resetConfig(a),this.currentUrlTree=new vy(new Cy([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new iC(s,o,e=>this.triggerEvent(new Wm(e)),e=>this.triggerEvent(new jm(e))),this.routerState=Gy(this.currentUrlTree,this.rootComponentType),this.transitions=new _m({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}setupNavigations(e){const t=this.events;return e.pipe(Vg(e=>0!==e.id),D(e=>Object.assign(Object.assign({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl)})),km(e=>{let n=!1,r=!1;return Fg(e).pipe(Lm(e=>{this.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),km(e=>{const n=this.browserUrlTree.toString(),i=!this.navigated||e.extractedUrl.toString()!==n||n!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||i)&&this.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return pC(e.source)&&(this.browserUrlTree=e.extractedUrl),Fg(e).pipe(km(e=>{const n=this.transitions.getValue();return t.next(new Um(e.id,this.serializeUrl(e.extractedUrl),e.source,e.restoredState)),n!==this.transitions.getValue()?ee:Promise.resolve(e)}),function(e,t,n,r){return km(i=>function(e,t,n,r,i){return new Uv(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(D(e=>Object.assign(Object.assign({},i),{urlAfterRedirects:e}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Lm(e=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,t,n,i,s){return X(o=>function(e,t,n,i,s="emptyOnly",o="legacy"){try{const r=new jv(e,t,n,i,s,o).recognize();return null===r?Wv(new qv):Fg(r)}catch(r){return Wv(r)}}(e,t,o.urlAfterRedirects,n(o.urlAfterRedirects),i,s).pipe(D(e=>Object.assign(Object.assign({},o),{targetSnapshot:e}))))}(this.rootComponentType,this.config,e=>this.serializeUrl(e),this.paramsInheritanceStrategy,this.relativeLinkResolution),Lm(e=>{"eager"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(e.urlAfterRedirects,e),this.browserUrlTree=e.urlAfterRedirects);const n=new zm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.next(n)}));if(i&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:i,restoredState:s,extras:o}=e,a=new Um(n,this.serializeUrl(r),i,s);t.next(a);const l=Gy(r,this.rootComponentType).snapshot;return Fg(Object.assign(Object.assign({},e),{targetSnapshot:l,urlAfterRedirects:r,extras:Object.assign(Object.assign({},o),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=e.rawUrl,this.browserUrlTree=e.urlAfterRedirects,e.resolve(null),ee}),tC(e=>{const{targetSnapshot:t,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:s,replaceUrl:o}}=e;return this.hooks.beforePreactivation(t,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!s,replaceUrl:!!o})}),Lm(e=>{const t=new Hm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),D(e=>Object.assign(Object.assign({},e),{guards:zv(e.targetSnapshot,e.currentSnapshot,this.rootContexts)})),function(e,t){return X(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?Fg(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return ae(e).pipe(X(e=>function(e,t,n,r,i){const s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return s&&0!==s.length?Fg(s.map(s=>{const o=Hv(s,t,i);let a;if(function(e){return e&&mv(e.canDeactivate)}(o))a=hy(o.canDeactivate(e,t,n,r));else{if(!mv(o))throw new Error("Invalid CanDeactivate guard");a=hy(o(e,t,n,r))}return a.pipe(Dm())})).pipe(Cv()):Fg(!0)}(e.component,e.route,n,t,r)),Dm(e=>!0!==e,!0))}(o,r,i,e).pipe(X(n=>n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return ae(t).pipe(Ug(t=>Pm(function(e,t){return null!==e&&t&&t(new Ym(e)),Fg(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new Qm(e)),Fg(!0)}(t.route,r),function(e,t,n){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(e=>function(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)).filter(e=>null!==e).map(t=>Sm(()=>Fg(t.guards.map(i=>{const s=Hv(i,t.node,n);let o;if(function(e){return e&&mv(e.canActivateChild)}(s))o=hy(s.canActivateChild(r,e));else{if(!mv(s))throw new Error("Invalid CanActivateChild guard");o=hy(s(r,e))}return o.pipe(Dm())})).pipe(Cv())));return Fg(i).pipe(Cv())}(e,t.path,n),function(e,t,n){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Fg(!0);const i=r.map(r=>Sm(()=>{const i=Hv(r,t,n);let s;if(function(e){return e&&mv(e.canActivate)}(i))s=hy(i.canActivate(t,e));else{if(!mv(i))throw new Error("Invalid CanActivate guard");s=hy(i(t,e))}return s.pipe(Dm())}));return Fg(i).pipe(Cv())}(e,t.route,n))),Dm(e=>!0!==e,!0))}(r,s,e,t):Fg(n)),D(e=>Object.assign(Object.assign({},n),{guardsResult:e})))})}(this.ngModule.injector,e=>this.triggerEvent(e)),Lm(e=>{if(yv(e.guardsResult)){const t=iy(`Redirecting to "${this.serializeUrl(e.guardsResult)}"`);throw t.url=e.guardsResult,t}const t=new Gm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);this.triggerEvent(t)}),Vg(e=>!!e.guardsResult||(this.restoreHistory(e),this.cancelNavigationTransition(e,""),!1)),tC(e=>{if(e.guards.canActivateChecks.length)return Fg(e).pipe(Lm(e=>{const t=new Zm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),km(e=>{let t=!1;return Fg(e).pipe(function(e,t){return X(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return Fg(n);let s=0;return ae(i).pipe(Ug(n=>function(e,t,n,r){return function(e,t,n,r){const i=Object.keys(e);if(0===i.length)return Fg({});const s={};return ae(i).pipe(X(i=>function(e,t,n,r){const i=Hv(e,t,r);return hy(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(Lm(e=>{s[i]=e}))),Mm(1),X(()=>Object.keys(s).length===i.length?Fg(s):ee))}(e._resolve,e,t,r).pipe(D(t=>(e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),qy(e,n).resolve),null)))}(n.route,r,e,t)),Lm(()=>s++),Mm(1),X(e=>s===i.length?Fg(n):ee))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Lm({next:()=>t=!0,complete:()=>{t||(this.restoreHistory(e),this.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),Lm(e=>{const t=new qm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}))}),tC(e=>{const{targetSnapshot:t,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:s,replaceUrl:o}}=e;return this.hooks.afterPreactivation(t,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!s,replaceUrl:!!o})}),D(e=>{const t=function(e,t,n){const r=Jy(e,t._root,n?n._root:void 0);return new Hy(r,t)}(this.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:t})}),Lm(e=>{this.currentUrlTree=e.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),this.routerState=e.targetRouterState,"deferred"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,e),this.browserUrlTree=e.urlAfterRedirects)}),((e,t,n)=>D(r=>(new fv(t,r.targetRouterState,r.currentRouterState,n).activate(e),r)))(this.rootContexts,this.routeReuseStrategy,e=>this.triggerEvent(e)),Lm({next(){n=!0},complete(){n=!0}}),function(e){return R((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}(()=>{var t;if(!n&&!r){const t=`Navigation ID ${e.id} is not equal to the current navigation id ${this.navigationId}`;"replace"===this.canceledNavigationResolution?(this.restoreHistory(e),this.cancelNavigationTransition(e,t)):this.cancelNavigationTransition(e,t)}(null===(t=this.currentNavigation)||void 0===t?void 0:t.id)===e.id&&(this.currentNavigation=null)}),Am(n=>{if(r=!0,function(e){return e&&e[ry]}(n)){const r=yv(n.url);r||(this.navigated=!0,this.restoreHistory(e,!0));const i=new Bm(e.id,this.serializeUrl(e.extractedUrl),n.message);t.next(i),r?setTimeout(()=>{const t=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree),r={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||pC(e.source)};this.scheduleNavigation(t,"imperative",null,r,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{this.restoreHistory(e,!0);const r=new $m(e.id,this.serializeUrl(e.extractedUrl),n);t.next(r);try{e.resolve(this.errorHandler(n))}catch(i){e.reject(i)}}return ee}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}getTransition(){const e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}setTransition(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const t=this.extractLocationChangeInfoFromEvent(e);this.shouldScheduleNavigation(this.lastLocationChangeInfo,t)&&setTimeout(()=>{const{source:e,state:n,urlTree:r}=t,i={replaceUrl:!0};if(n){const e=Object.assign({},n);delete e.navigationId,delete e.\u0275routerPageId,0!==Object.keys(e).length&&(i.state=e)}this.scheduleNavigation(r,e,n,i)},0),this.lastLocationChangeInfo=t}))}extractLocationChangeInfoFromEvent(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(e,t){if(!e)return!0;const n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){Ev(e),this.config=e.map(Sv),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,t={}){const{relativeTo:n,queryParams:r,fragment:i,queryParamsHandling:s,preserveFragment:o}=t,a=n||this.routerState.root,l=o?this.currentUrlTree.fragment:i;let c=null;switch(s){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return rv(t.root,t.root,t,r,i);const s=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new sv(!0,0,e);let t=0,n=!1;const r=e.reduce((e,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const t={};return uy(r.outlets,(e,n)=>{t[n]="string"==typeof e?e.split("/"):e}),[...e,{outlets:t}]}if(r.segmentPath)return[...e,r.segmentPath]}return"string"!=typeof r?[...e,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[...e,r]},[]);return new sv(n,t,r)}(n);if(s.toRoot())return rv(t.root,new Cy([],{}),t,r,i);const o=function(e,t,n){if(e.isAbsolute)return new ov(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){const e=n.snapshot._urlSegment;return new ov(e,e===t.root,0)}const r=tv(e.commands[0])?0:1;return function(e,t,n){let r=e,i=t,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new ov(r,!1,i-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,e.numberOfDoubleDots)}(s,t,e),a=o.processChildren?lv(o.segmentGroup,o.index,s.commands):av(o.segmentGroup,o.index,s.commands);return rv(o.segmentGroup,a,t,r,i)}(a,this.currentUrlTree,e,c,l??null)}navigateByUrl(e,t={skipLocationChange:!1}){const n=yv(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}navigate(e,t={skipLocationChange:!1}){return function(e){for(let t=0;t<e.length;t++){const n=e[t];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${t}`)}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}isActive(e,t){let n;if(n=!0===t?Object.assign({},hC):!1===t?Object.assign({},dC):t,yv(e))return py(this.currentUrlTree,e,n);const r=this.parseUrl(e);return py(this.currentUrlTree,r,n)}removeEmptyProps(e){return Object.keys(e).reduce((t,n)=>{const r=e[n];return null!=r&&(t[n]=r),t},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new Vm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,t,n,r,i){var s,o;if(this.disposed)return Promise.resolve(!1);const a=this.getTransition(),l=pC(t)&&a&&!pC(a.source),c=(this.lastSuccessfulId===a.id||this.currentNavigation?a.rawUrl:a.urlAfterRedirects).toString()===e.toString();if(l&&c)return Promise.resolve(!0);let u,h,d;i?(u=i.resolve,h=i.reject,d=i.promise):d=new Promise((e,t)=>{u=e,h=t});const f=++this.navigationId;let p;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),p=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(s=this.browserPageId)&&void 0!==s?s:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):p=0,this.setTransition({id:f,targetPageId:p,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:u,reject:h,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(e=>Promise.reject(e))}setBrowserUrl(e,t){const n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}restoreHistory(e,t=!1){var n,r;if("computed"===this.canceledNavigationResolution){const t=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)||0===t?this.currentUrlTree===(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)&&0===t&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(t)}else"replace"===this.canceledNavigationResolution&&(t&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,t){const n=new Bm(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}generateNgRouterState(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}return e.\u0275fac=function(t){return new(t||e)(Or(lr),Or(wy),Or(oC),Or(cd),Or(zo),Or(Uh),Or(fh),Or(void 0))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function pC(e){return"imperative"!==e}let gC=(()=>{class e{constructor(e,t,n,r,i){this.router=e,this.route=t,this.commands=[],this.onChanges=new A,null==n&&r.setAttribute(i.nativeElement,"tabindex","0")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}onClick(){const e={skipLocationChange:yC(this.skipLocationChange),replaceUrl:yC(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:yC(this.preserveFragment)})}}return e.\u0275fac=function(t){return new(t||e)(ua(fC),ua(Zy),rr("tabindex"),ua(Oc),ua(Pc))},e.\u0275dir=st({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&Ea("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[vt]}),e})(),mC=(()=>{class e{constructor(e,t,n){this.router=e,this.route=t,this.locationStrategy=n,this.commands=[],this.onChanges=new A,this.subscription=e.events.subscribe(e=>{e instanceof Vm&&this.updateTargetUrlAndHref()})}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;const s={skipLocationChange:yC(this.skipLocationChange),replaceUrl:yC(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,s),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:yC(this.preserveFragment)})}}return e.\u0275fac=function(t){return new(t||e)(ua(fC),ua(Zy),ua(id))},e.\u0275dir=st({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&Ea("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(nl("href",t.href,Ci),ra("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[vt]}),e})();function yC(e){return""===e||!!e}let vC=(()=>{class e{constructor(e,t,n,r,i){this.parentContexts=e,this.location=t,this.resolver=n,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new Nu,this.deactivateEvents=new Nu,this.name=r||ey,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,e}attach(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new CC(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(t){return new(t||e)(ua(oC),ua(au),ua(Cc),rr("name"),ua(Yc))},e.\u0275dir=st({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e})();class CC{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Zy?this.route:e===oC?this.childContexts:this.parent.get(e,t)}}class _C{}class EC{preload(e,t){return Fg(null)}}let wC=(()=>{class e{constructor(e,t,n,r,i){this.router=e,this.injector=r,this.preloadingStrategy=i,this.loader=new iC(t,n,t=>e.triggerEvent(new Wm(t)),t=>e.triggerEvent(new jm(t)))}setUpPreloading(){this.subscription=this.router.events.pipe(Vg(e=>e instanceof Vm),Ug(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(iu);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,t){const n=[];for(const r of t)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const e=r._loadedConfig;n.push(this.processRoutes(e.module,e.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(e,r)):r.children&&n.push(this.processRoutes(e,r.children));return ae(n).pipe(J(),D(e=>{}))}preloadConfig(e,t){return this.preloadingStrategy.preload(t,()=>(t._loadedConfig?Fg(t._loadedConfig):this.loader.load(e.injector,t)).pipe(X(e=>(t._loadedConfig=e,this.processRoutes(e.module,e.routes)))))}}return e.\u0275fac=function(t){return new(t||e)(Or(fC),Or(Uh),Or(fh),Or(zo),Or(_C))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),PC=(()=>{class e{constructor(e,t,n={}){this.router=e,this.viewportScroller=t,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Um?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Vm&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Jm&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,t){this.router.triggerEvent(new Jm(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(Or(fC),Or(af),Or(void 0))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const SC=new or("ROUTER_CONFIGURATION"),bC=new or("ROUTER_FORROOT_GUARD"),OC=[cd,{provide:wy,useClass:Py},{provide:fC,useFactory:function(e,t,n,r,i,s,o,a={},l,c){const u=new fC(null,e,t,n,r,i,s,ly(o));return l&&(u.urlHandlingStrategy=l),c&&(u.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(a,u),a.enableTracing&&u.events.subscribe(e=>{var t,n;null===(t=console.group)||void 0===t||t.call(console,`Router Event: ${e.constructor.name}`),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),u},deps:[wy,oC,cd,zo,Uh,fh,rC,SC,[class{},new Nr],[class{},new Nr]]},oC,{provide:Zy,useFactory:function(e){return e.routerState.root},deps:[fC]},{provide:Uh,useClass:$h},wC,EC,class{preload(e,t){return t().pipe(Am(()=>Fg(null)))}},{provide:SC,useValue:{enableTracing:!1}}];function kC(){return new Mh("Router",fC)}let TC=(()=>{class e{constructor(e,t){}static forRoot(t,n){return{ngModule:e,providers:[OC,NC(t),{provide:bC,useFactory:MC,deps:[[fC,new Nr,new Rr]]},{provide:SC,useValue:n||{}},{provide:id,useFactory:AC,deps:[Yh,[new Mr(od),new Nr],SC]},{provide:PC,useFactory:IC,deps:[fC,af,SC]},{provide:_C,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:EC},{provide:Mh,multi:!0,useFactory:kC},[RC,{provide:Yu,multi:!0,useFactory:xC,deps:[RC]},{provide:LC,useFactory:DC,deps:[RC]},{provide:nh,multi:!0,useExisting:LC}]]}}static forChild(t){return{ngModule:e,providers:[NC(t)]}}}return e.\u0275fac=function(t){return new(t||e)(Or(bC,8),Or(fC,8))},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({}),e})();function IC(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new PC(e,t,n)}function AC(e,t,n={}){return n.useHash?new ld(e,t):new ad(e,t)}function MC(e){return"guarded"}function NC(e){return[{provide:ar,multi:!0,useValue:e},{provide:rC,multi:!0,useValue:e}]}let RC=(()=>{class e{constructor(e){this.injector=e,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new A}appInitializer(){return this.injector.get(Qh,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let e=null;const t=new Promise(t=>e=t),n=this.injector.get(fC),r=this.injector.get(SC);return"disabled"===r.initialNavigation?(n.setUpLocationChangeListener(),e(!0)):"enabled"===r.initialNavigation||"enabledBlocking"===r.initialNavigation?(n.hooks.afterPreactivation=()=>this.initNavigation?Fg(null):(this.initNavigation=!0,e(!0),this.resultOfPreactivationDone),n.initialNavigation()):e(!0),t})}bootstrapListener(e){const t=this.injector.get(SC),n=this.injector.get(wC),r=this.injector.get(PC),i=this.injector.get(fC),s=this.injector.get(Lh);e===s.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(s.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return e.\u0275fac=function(t){return new(t||e)(Or(zo))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function xC(e){return e.appInitializer.bind(e)}function DC(e){return e.bootstrapListener.bind(e)}const LC=new or("Router Initializer");class FC{}const UC="*";function VC(e,t=null){return{type:2,steps:e,options:t}}function BC(e){return{type:6,styles:e,offset:null}}function $C(e){Promise.resolve(null).then(e)}class zC{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){$C(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}class HC{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,r=0;const i=this.players.length;0==i?$C(()=>this._onFinish()):this.players.forEach(e=>{e.onDone(()=>{++t==i&&this._onFinish()}),e.onDestroy(()=>{++n==i&&this._onDestroy()}),e.onStart(()=>{++r==i&&this._onStart()})}),this.totalTime=this.players.reduce((e,t)=>Math.max(e,t.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(e=>{const n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}getPosition(){const e=this.players.reduce((e,t)=>null===e||t.totalTime>e.totalTime?t:e,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}function GC(){return"undefined"!=typeof window&&void 0!==window.document}function ZC(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function qC(e){switch(e.length){case 0:return new zC;case 1:return e[0];default:return new HC(e)}}function WC(e,t,n,r,i={},s={}){const o=[],a=[];let l=-1,c=null;if(r.forEach(e=>{const n=e.offset,r=n==l,u=r&&c||{};Object.keys(e).forEach(n=>{let r=n,a=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),a){case"!":a=i[n];break;case UC:a=s[n];break;default:a=t.normalizeStyleValue(n,r,a,o)}u[r]=a}),r||a.push(u),c=u,l=n}),o.length){const e="\n - ";throw new Error(`Unable to animate due to the following errors:${e}${o.join(e)}`)}return a}function jC(e,t,n,r){switch(t){case"start":e.onStart(()=>r(n&&YC(n,"start",e)));break;case"done":e.onDone(()=>r(n&&YC(n,"done",e)));break;case"destroy":e.onDestroy(()=>r(n&&YC(n,"destroy",e)))}}function YC(e,t,n){const r=KC(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,n.totalTime??e.totalTime,!!n.disabled),i=e._data;return null!=i&&(r._data=i),r}function KC(e,t,n,r,i="",s=0,o){return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:s,disabled:!!o}}function QC(e,t,n){let r;return e instanceof Map?(r=e.get(t),r||e.set(t,r=n)):(r=e[t],r||(r=e[t]=n)),r}function XC(e){const t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}let JC=(e,t)=>!1,e_=(e,t)=>!1,t_=(e,t,n)=>[];const n_=ZC();(n_||"undefined"!=typeof Element)&&(JC=GC()?(e,t)=>{for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:(e,t)=>e.contains(t),e_=(()=>{if(n_||Element.prototype.matches)return(e,t)=>e.matches(t);{const e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?(e,n)=>t.apply(e,[n]):e_}})(),t_=(e,t,n)=>{let r=[];if(n){const n=e.querySelectorAll(t);for(let e=0;e<n.length;e++)r.push(n[e])}else{const n=e.querySelector(t);n&&r.push(n)}return r});let r_=null,i_=!1;function s_(e){r_||(r_=("undefined"!=typeof document?document.body:null)||{},i_=!!r_.style&&"WebkitAppearance"in r_.style);let t=!0;return r_.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in r_.style,!t&&i_&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in r_.style)),t}const o_=e_,a_=JC,l_=t_;function c_(e){const t={};return Object.keys(e).forEach(n=>{const r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}let u_=(()=>{class e{validateStyleProperty(e){return s_(e)}matchesElement(e,t){return o_(e,t)}containsElement(e,t){return a_(e,t)}query(e,t,n){return l_(e,t,n)}computeStyle(e,t,n){return n||""}animate(e,t,n,r,i,s=[],o){return new zC(n,r)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),h_=(()=>{class e{}return e.NOOP=new u_,e})();const d_="ng-enter",f_="ng-leave",p_="ng-trigger",g_=".ng-trigger",m_="ng-animating",y_=".ng-animating";function v_(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:C_(parseFloat(t[1]),t[2])}function C_(e,t){return"s"===t?1e3*e:e}function __(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){let r,i=0,s="";if("string"==typeof e){const n=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return t.push(`The provided timing value "${e}" is invalid.`),{duration:0,delay:0,easing:""};r=C_(parseFloat(n[1]),n[2]);const o=n[3];null!=o&&(i=C_(parseFloat(o),n[4]));const a=n[5];a&&(s=a)}else r=e;if(!n){let n=!1,s=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),n=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&t.splice(s,0,`The provided timing value "${e}" is invalid.`)}return{duration:r,delay:i,easing:s}}(e,t,n)}function E_(e,t={}){return Object.keys(e).forEach(n=>{t[n]=e[n]}),t}function w_(e,t,n={}){if(t)for(let r in e)n[r]=e[r];else E_(e,n);return n}function P_(e,t,n){return n?t+":"+n+";":""}function S_(e){let t="";for(let n=0;n<e.style.length;n++){const r=e.style.item(n);t+=P_(0,r,e.style.getPropertyValue(r))}for(const n in e.style)e.style.hasOwnProperty(n)&&!n.startsWith("_")&&(t+=P_(0,x_(n),e.style[n]));e.setAttribute("style",t)}function b_(e,t,n){e.style&&(Object.keys(t).forEach(r=>{const i=R_(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),ZC()&&S_(e))}function O_(e,t){e.style&&(Object.keys(t).forEach(t=>{const n=R_(t);e.style[n]=""}),ZC()&&S_(e))}function k_(e){return Array.isArray(e)?1==e.length?e[0]:VC(e):e}const T_=new RegExp("{{\\s*(.+?)\\s*}}","g");function I_(e){let t=[];if("string"==typeof e){let n;for(;n=T_.exec(e);)t.push(n[1]);T_.lastIndex=0}return t}function A_(e,t,n){const r=e.toString(),i=r.replace(T_,(e,r)=>{let i=t[r];return t.hasOwnProperty(r)||(n.push(`Please provide a value for the animation param ${r}`),i=""),i.toString()});return i==r?e:i}function M_(e){const t=[];let n=e.next();for(;!n.done;)t.push(n.value),n=e.next();return t}const N_=/-+([a-z0-9])/g;function R_(e){return e.replace(N_,(...e)=>e[1].toUpperCase())}function x_(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function D_(e,t){return 0===e||0===t}function L_(e,t,n){const r=Object.keys(n);if(r.length&&t.length){let s=t[0],o=[];if(r.forEach(e=>{s.hasOwnProperty(e)||o.push(e),s[e]=n[e]}),o.length)for(var i=1;i<t.length;i++){let n=t[i];o.forEach(function(t){n[t]=U_(e,t)})}}return t}function F_(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error(`Unable to resolve animation metadata node #${t.type}`)}}function U_(e,t){return window.getComputedStyle(e)[t]}function V_(e,t){const n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(e=>function(e,t,n){if(":"==e[0]){const r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,t)=>parseFloat(t)>parseFloat(e);case":decrement":return(e,t)=>parseFloat(t)<parseFloat(e);default:return t.push(`The transition alias value "${e}" is not supported`),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}const r=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(`The provided transition expression "${e}" is not supported`),t;const i=r[1],s=r[2],o=r[3];t.push(z_(i,o));"<"==s[0]&&!("*"==i&&"*"==o)&&t.push(z_(o,i))}(e,n,t)):n.push(e),n}const B_=new Set(["true","1"]),$_=new Set(["false","0"]);function z_(e,t){const n=B_.has(e)||$_.has(e),r=B_.has(t)||$_.has(t);return(i,s)=>{let o="*"==e||e==i,a="*"==t||t==s;return!o&&n&&"boolean"==typeof i&&(o=i?B_.has(e):$_.has(e)),!a&&r&&"boolean"==typeof s&&(a=s?B_.has(t):$_.has(t)),o&&a}}const H_=new RegExp("s*:selfs*,?","g");function G_(e,t,n){return new Z_(e).build(t,n)}class Z_{constructor(e){this._driver=e}build(e,t){const n=new q_(t);return this._resetContextStyleTimingState(n),F_(this,k_(e),n)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0;const i=[],s=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(e=>{if(this._resetContextStyleTimingState(t),0==e.type){const n=e,r=n.name;r.toString().split(/\s*,\s*/).forEach(e=>{n.name=e,i.push(this.visitState(n,t))}),n.name=r}else if(1==e.type){const i=this.visitTransition(e,t);n+=i.queryCount,r+=i.depCount,s.push(i)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:i,transitions:s,queryCount:n,depCount:r,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){const i=new Set,s=r||{};if(n.styles.forEach(e=>{if(W_(e)){const t=e;Object.keys(t).forEach(e=>{I_(t[e]).forEach(e=>{s.hasOwnProperty(e)||i.add(e)})})}}),i.size){const n=M_(i.values());t.errors.push(`state("${e.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=F_(this,k_(e.animation),t);return{type:1,matchers:V_(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:j_(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(e=>F_(this,e,t)),options:j_(e.options)}}visitGroup(e,t){const n=t.currentTime;let r=0;const i=e.steps.map(e=>{t.currentTime=n;const i=F_(this,e,t);return r=Math.max(r,t.currentTime),i});return t.currentTime=r,{type:3,steps:i,options:j_(e.options)}}visitAnimate(e,t){const n=function(e,t){let n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return Y_(__(e,t).duration,0,"");const r=e;if(r.split(/\s+/).some(e=>"{"==e.charAt(0)&&"{"==e.charAt(1))){const e=Y_(0,0,"");return e.dynamic=!0,e.strValue=r,e}return n=n||__(r,t),Y_(n.duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let r,i=e.styles?e.styles:BC({});if(5==i.type)r=this.visitKeyframes(i,t);else{let i=e.styles,s=!1;if(!i){s=!0;const e={};n.easing&&(e.easing=n.easing),i=BC(e)}t.currentTime+=n.duration+n.delay;const o=this.visitStyle(i,t);o.isEmptyStep=s,r=o}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[];Array.isArray(e.styles)?e.styles.forEach(e=>{"string"==typeof e?e==UC?n.push(e):t.errors.push(`The provided style string value ${e} is not allowed.`):n.push(e)}):n.push(e.styles);let r=!1,i=null;return n.forEach(e=>{if(W_(e)){const t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(let e in t)if(t[e].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let r=t.currentTime,i=t.currentTime;n&&i>0&&(i-=n.duration+n.delay),e.styles.forEach(e=>{"string"!=typeof e&&Object.keys(e).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void t.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const s=t.collectedStyles[t.currentQuerySelector],o=s[n];let a=!0;o&&(i!=r&&i>=o.startTime&&r<=o.endTime&&(t.errors.push(`The CSS property "${n}" that exists between the times of "${o.startTime}ms" and "${o.endTime}ms" is also being animated in a parallel animation between the times of "${i}ms" and "${r}ms"`),a=!1),i=o.startTime),a&&(s[n]={startTime:i,endTime:r}),t.options&&function(e,t,n){const r=t.params||{},i=I_(e);i.length&&i.forEach(e=>{r.hasOwnProperty(e)||n.push(`Unable to resolve the local animation param ${e} in the given list of values`)})}(e[n],t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),n;let r=0;const i=[];let s=!1,o=!1,a=0;const l=e.steps.map(e=>{const n=this._makeStyleAst(e,t);let l=null!=n.offset?n.offset:function(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(e=>{if(W_(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}});else if(W_(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}return t}(n.styles),c=0;return null!=l&&(r++,c=n.offset=l),o=o||c<0||c>1,s=s||c<a,a=c,i.push(c),n});o&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),s&&t.errors.push("Please ensure that all keyframe offsets are in order");const c=e.steps.length;let u=0;r>0&&r<c?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(u=1/(c-1));const h=c-1,d=t.currentTime,f=t.currentAnimateTimings,p=f.duration;return l.forEach((e,r)=>{const s=u>0?r==h?1:u*r:i[r],o=s*p;t.currentTime=d+f.delay+o,f.duration=o,this._validateStyleAst(e,t),e.offset=s,n.styles.push(e)}),n}visitReference(e,t){return{type:8,animation:F_(this,k_(e.animation),t),options:j_(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:j_(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:j_(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[i,s]=function(e){const t=!!e.split(/\s*,\s*/).find(e=>":self"==e);return t&&(e=e.replace(H_,"")),e=e.replace(/@\*/g,g_).replace(/@\w+/g,e=>g_+"-"+e.substr(1)).replace(/:animating/g,y_),[e,t]}(e.selector);t.currentQuerySelector=n.length?n+" "+i:i,QC(t.collectedStyles,t.currentQuerySelector,{});const o=F_(this,k_(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:i,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:o,originalSelector:e.selector,options:j_(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:__(e.timings,t.errors,!0);return{type:12,animation:F_(this,k_(e.animation),t),timings:n,options:null}}}class q_{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function W_(e){return!Array.isArray(e)&&"object"==typeof e}function j_(e){return e?(e=E_(e)).params&&(e.params=function(e){return e?E_(e):null}(e.params)):e={},e}function Y_(e,t,n){return{duration:e,delay:t,easing:n}}function K_(e,t,n,r,i,s,o=null,a=!1){return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class Q_{constructor(){this._map=new Map}consume(e){let t=this._map.get(e);return t?this._map.delete(e):t=[],t}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const X_=new RegExp(":enter","g"),J_=new RegExp(":leave","g");function eE(e,t,n,r,i,s={},o={},a,l,c=[]){return(new tE).buildKeyframes(e,t,n,r,i,s,o,a,l,c)}class tE{buildKeyframes(e,t,n,r,i,s,o,a,l,c=[]){l=l||new Q_;const u=new rE(e,t,l,r,i,c,[]);u.options=a,u.currentTimeline.setStyles([s],null,u.errors,a),F_(this,n,u);const h=u.timelines.filter(e=>e.containsAnimation());if(h.length&&Object.keys(o).length){const e=h[h.length-1];e.allowOnlyTimelineStyles()||e.setStyles([o],null,u.errors,a)}return h.length?h.map(e=>e.buildKeyframes()):[K_(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.consume(t.element);if(n){const r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,s=this._visitSubInstructions(n,r,r.options);i!=s&&t.transformIntoNewTimeline(s)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let r=t.currentTimeline.currentTime;const i=null!=n.duration?v_(n.duration):null,s=null!=n.delay?v_(n.delay):null;return 0!==i&&e.forEach(e=>{const n=t.appendInstructionToTimeline(e,i,s);r=Math.max(r,n.duration+n.delay)}),r}visitReference(e,t){t.updateOptions(e.options,!0),F_(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let r=t;const i=e.options;if(i&&(i.params||i.delay)&&(r=t.createSubContext(i),r.transformIntoNewTimeline(),null!=i.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=nE);const e=v_(i.delay);r.delayNextStep(e)}e.steps.length&&(e.steps.forEach(e=>F_(this,e,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let r=t.currentTimeline.currentTime;const i=e.options&&e.options.delay?v_(e.options.delay):0;e.steps.forEach(s=>{const o=t.createSubContext(e.options);i&&o.delayNextStep(i),F_(this,s,o),r=Math.max(r,o.currentTimeline.currentTime),n.push(o.currentTimeline)}),n.forEach(e=>t.currentTimeline.mergeTimelineCollectedStyles(e)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return __(t.params?A_(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());const i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,s=t.createSubContext().currentTimeline;s.easing=n.easing,e.styles.forEach(e=>{s.forwardTime((e.offset||0)*i),s.setStyles(e.styles,e.easing,t.errors,t.options),s.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(s),t.transformIntoNewTimeline(r+i),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,r=e.options||{},i=r.delay?v_(r.delay):0;i&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=nE);let s=n;const o=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=o.length;let a=null;o.forEach((n,r)=>{t.currentQueryIndex=r;const o=t.createSubContext(e.options,n);i&&o.delayNextStep(i),n===t.element&&(a=o.currentTimeline),F_(this,e.animation,o),o.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,o.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(s),a&&(t.currentTimeline.mergeTimelineCollectedStyles(a),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,r=t.currentTimeline,i=e.timings,s=Math.abs(i.duration),o=s*(t.currentQueryTotal-1);let a=s*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":a=o-a;break;case"full":a=n.currentStaggerTime}const l=t.currentTimeline;a&&l.delayNextStep(a);const c=l.currentTime;F_(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}const nE={};class rE{constructor(e,t,n,r,i,s,o,a){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=i,this.errors=s,this.timelines=o,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=nE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new iE(this._driver,t,0),o.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let r=this.options;null!=n.duration&&(r.duration=v_(n.duration)),null!=n.delay&&(r.delay=v_(n.delay));const i=n.params;if(i){let e=r.params;e||(e=this.options.params={}),Object.keys(i).forEach(n=>{(!t||!e.hasOwnProperty(n))&&(e[n]=A_(i[n],e,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(e=>{n[e]=t[e]})}}return e}createSubContext(e=null,t,n){const r=t||this.element,i=new rE(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(e),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(e){return this.previousNode=nE,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},i=new sE(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,i,s){let o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(X_,"."+this._enterClassName)).replace(J_,"."+this._leaveClassName);let t=this._driver.query(this.element,e,1!=n);0!==n&&(t=n<0?t.slice(t.length+n,t.length):t.slice(0,n)),o.push(...t)}return!i&&0==o.length&&s.push(`\`query("${t}")\` returned zero elements. (Use \`query("${t}", { optional: true })\` if you wish to allow this.)`),o}}class iE{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new iE(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||UC,this._currentKeyframe[e]=UC}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&(this._previousKeyframe.easing=t);const i=r&&r.params||{},s=function(e,t){const n={};let r;return e.forEach(e=>{"*"===e?(r=r||Object.keys(t),r.forEach(e=>{n[e]=UC})):w_(e,!1,n)}),n}(e,this._globalTimelineStyles);Object.keys(s).forEach(e=>{const t=A_(s[e],i,n);this._pendingStyles[e]=t,this._localTimelineStyles.hasOwnProperty(e)||(this._backFill[e]=this._globalTimelineStyles.hasOwnProperty(e)?this._globalTimelineStyles[e]:UC),this._updateStyle(e,t)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(t=>{this._currentKeyframe[t]=e[t]}),Object.keys(this._localTimelineStyles).forEach(e=>{this._currentKeyframe.hasOwnProperty(e)||(this._currentKeyframe[e]=this._localTimelineStyles[e])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const n=this._styleSummary[t],r=e._styleSummary[t];(!n||r.time>n.time)&&this._updateStyle(t,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((i,s)=>{const o=w_(i,!0);Object.keys(o).forEach(n=>{const r=o[n];"!"==r?e.add(n):r==UC&&t.add(n)}),n||(o.offset=s/this.duration),r.push(o)});const i=e.size?M_(e.values()):[],s=t.size?M_(t.values()):[];if(n){const e=r[0],t=E_(e);e.offset=0,t.offset=1,r=[e,t]}return K_(this.element,r,i,s,this.duration,this.startTime,this.easing,!1)}}class sE extends iE{constructor(e,t,n,r,i,s,o=!1){super(e,t,s.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=i,this._stretchStartingKeyframe=o,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const i=[],s=n+t,o=t/s,a=w_(e[0],!1);a.offset=0,i.push(a);const l=w_(e[0],!1);l.offset=oE(o),i.push(l);const c=e.length-1;for(let r=1;r<=c;r++){let o=w_(e[r],!1);o.offset=oE((t+o.offset*n)/s),i.push(o)}n=s,t=0,r="",e=i}return K_(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}}function oE(e,t=3){const n=Math.pow(10,t-1);return Math.round(e*n)/n}class aE{}class lE extends aE{normalizePropertyName(e,t){return R_(e)}normalizeStyleValue(e,t,n,r){let i="";const s=n.toString().trim();if(cE[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{const t=n.match(/^[+-]?[\d\.]+([a-z]*)$/);t&&0==t[1].length&&r.push(`Please provide a CSS unit value for ${e}:${n}`)}return s+i}}const cE=(()=>function(e){const t={};return e.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function uE(e,t,n,r,i,s,o,a,l,c,u,h,d){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:s,toState:r,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:d}}const hE={};class dE{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return function(e,t,n,r,i){return e.some(e=>e(t,n,r,i))}(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){const r=this._stateStyles["*"],i=this._stateStyles[e],s=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):s}build(e,t,n,r,i,s,o,a,l,c){const u=[],h=this.ast.options&&this.ast.options.params||hE,d=this.buildStyles(n,o&&o.params||hE,u),f=a&&a.params||hE,p=this.buildStyles(r,f,u),g=new Set,m=new Map,y=new Map,v="void"===r,C={params:Object.assign(Object.assign({},h),f)},_=c?[]:eE(e,t,this.ast.animation,i,s,d,p,C,l,u);let E=0;if(_.forEach(e=>{E=Math.max(e.duration+e.delay,E)}),u.length)return uE(t,this._triggerName,n,r,v,d,p,[],[],m,y,E,u);_.forEach(e=>{const n=e.element,r=QC(m,n,{});e.preStyleProps.forEach(e=>r[e]=!0);const i=QC(y,n,{});e.postStyleProps.forEach(e=>i[e]=!0),n!==t&&g.add(n)});const w=M_(g.values());return uE(t,this._triggerName,n,r,v,d,p,_,w,m,y,E)}}class fE{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n={},r=E_(this.defaultParams);return Object.keys(e).forEach(t=>{const n=e[t];null!=n&&(r[t]=n)}),this.styles.styles.forEach(e=>{if("string"!=typeof e){const i=e;Object.keys(i).forEach(e=>{let s=i[e];s.length>1&&(s=A_(s,r,t));const o=this.normalizer.normalizePropertyName(e,t);s=this.normalizer.normalizeStyleValue(e,o,s,t),n[o]=s})}}),n}}class pE{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states={},t.states.forEach(e=>{this.states[e.name]=new fE(e.style,e.options&&e.options.params||{},n)}),gE(this.states,"true","1"),gE(this.states,"false","0"),t.transitions.forEach(t=>{this.transitionFactories.push(new dE(e,t,this.states))}),this.fallbackTransition=function(e,t,n){return new dE(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(e,t)=>!0],options:null,queryCount:0,depCount:0},t)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(i=>i.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function gE(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}const mE=new Q_;class yE{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(e,t){const n=[],r=G_(this._driver,t,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[e]=r}_buildPlayer(e,t,n){const r=e.element,i=WC(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const r=[],i=this._animations[e];let s;const o=new Map;if(i?(s=eE(this._driver,t,i,d_,f_,{},{},n,mE,r),s.forEach(e=>{const t=QC(o,e.element,{});e.postStyleProps.forEach(e=>t[e]=null)})):(r.push("The requested animation doesn't exist or has already been destroyed"),s=[]),r.length)throw new Error(`Unable to create the animation due to the following errors: ${r.join("\n")}`);o.forEach((e,t)=>{Object.keys(e).forEach(n=>{e[n]=this._driver.computeStyle(t,n,UC)})});const a=qC(s.map(e=>{const t=o.get(e.element);return this._buildPlayer(e,{},t)}));return this._playersById[e]=a,a.onDestroy(()=>this.destroy(e)),this.players.push(a),a}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw new Error(`Unable to find the timeline player referenced by ${e}`);return t}listen(e,t,n,r){const i=KC(t,"","","");return jC(this._getPlayer(e),n,i,r),()=>{}}command(e,t,n,r){if("register"==n)return void this.register(e,r[0]);if("create"==n)return void this.create(e,t,r[0]||{});const i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const vE="ng-animate-queued",CE="ng-animate-disabled",_E=".ng-animate-disabled",EE=[],wE={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},PE={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},SE="__ng_removed";class bE{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=(n?e.value:e)??null,n){const t=E_(e);delete t.value,this.options=t}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const e=this.options.params;Object.keys(t).forEach(n=>{null==e[n]&&(e[n]=t[n])})}}}const OE="void",kE=new bE(OE);class TE{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,LE(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.hasOwnProperty(t))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${t}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${t}" because the provided event is undefined!`);if("start"!=(i=n)&&"done"!=i)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${t}" is not supported!`);var i;const s=QC(this._elementListeners,e,[]),o={name:t,phase:n,callback:r};s.push(o);const a=QC(this._engine.statesByElement,e,{});return a.hasOwnProperty(t)||(LE(e,p_),LE(e,p_+"-"+t),a[t]=kE),()=>{this._engine.afterFlush(()=>{const e=s.indexOf(o);e>=0&&s.splice(e,1),this._triggers[t]||delete a[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw new Error(`The provided animation trigger "${e}" has not been registered!`);return t}trigger(e,t,n,r=!0){const i=this._getTrigger(t),s=new AE(this.id,t,e);let o=this._engine.statesByElement.get(e);o||(LE(e,p_),LE(e,p_+"-"+t),this._engine.statesByElement.set(e,o={}));let a=o[t];const l=new bE(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&a&&l.absorbOptions(a.options),o[t]=l,a||(a=kE),l.value!==OE&&a.value===l.value){if(!function(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(!t.hasOwnProperty(r)||e[r]!==t[r])return!1}return!0}(a.params,l.params)){const t=[],n=i.matchStyles(a.value,a.params,t),r=i.matchStyles(l.value,l.params,t);t.length?this._engine.reportError(t):this._engine.afterFlush(()=>{O_(e,n),b_(e,r)})}return}const c=QC(this._engine.playersByElement,e,[]);c.forEach(e=>{e.namespaceId==this.id&&e.triggerName==t&&e.queued&&e.destroy()});let u=i.matchTransition(a.value,l.value,e,l.params),h=!1;if(!u){if(!r)return;u=i.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:u,fromState:a,toState:l,player:s,isFallbackTransition:h}),h||(LE(e,vE),s.onStart(()=>{FE(e,vE)})),s.onDone(()=>{let t=this.players.indexOf(s);t>=0&&this.players.splice(t,1);const n=this._engine.playersByElement.get(e);if(n){let e=n.indexOf(s);e>=0&&n.splice(e,1)}}),this.players.push(s),c.push(s),s}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,n)=>{delete t[e]}),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(t=>t.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(e=>e.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,g_,!0);n.forEach(e=>{if(e[SE])return;const n=this._engine.fetchNamespacesByElement(e);n.size?n.forEach(n=>n.triggerLeaveAnimation(e,t,!1,!0)):this.clearElementCache(e)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(e=>this.clearElementCache(e)))}triggerLeaveAnimation(e,t,n,r){const i=this._engine.statesByElement.get(e);if(i){const s=[];if(Object.keys(i).forEach(t=>{if(this._triggers[t]){const n=this.trigger(e,t,OE,r);n&&s.push(n)}}),s.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&qC(s).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const r=new Set;t.forEach(t=>{const i=t.name;if(r.has(i))return;r.add(i);const s=this._triggers[i].fallbackTransition,o=n[i]||kE,a=new bE(OE),l=new AE(this.id,i,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:i,transition:s,fromState:o,toState:a,player:l,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){const t=n.players.length?n.playersByQueriedElement.get(e):[];if(t&&t.length)r=!0;else{let t=e;for(;t=t.parentNode;)if(n.statesByElement.get(t)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{const r=e[SE];(!r||r===wE)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){LE(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const i=n.element,s=this._elementListeners.get(i);s&&s.forEach(t=>{if(t.name==n.triggerName){const r=KC(i,n.triggerName,n.fromState.value,n.toState.value);r._data=e,jC(n.player,t.phase,r,t.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((e,t)=>{const n=e.transition.ast.depCount,r=t.transition.ast.depCount;return 0==n||0==r?n-r:this._engine.driver.containsElement(e.element,t.element)?1:-1})}destroy(e){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(t=>t.element===e)||t,t}}class IE{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(e,t)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(t=>{t.queued&&e.push(t)})}),e}createNamespace(e,t){const n=new TE(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList.length-1;if(n>=0){let r=!1;for(let i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const t=this._namespaceList.indexOf(n);t>=0&&this._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n){const e=Object.keys(n);for(let r=0;r<e.length;r++){const i=n[e[r]].namespaceId;if(i){const e=this._fetchNamespace(i);e&&t.add(e)}}}return t}trigger(e,t,n,r){if(ME(t)){const i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!ME(t))return;const i=t[SE];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const e=this.collectedLeaveElements.indexOf(t);e>=0&&this.collectedLeaveElements.splice(e,1)}if(e){const r=this._fetchNamespace(e);r&&r.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),LE(e,CE)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),FE(e,CE))}removeNode(e,t,n,r){if(ME(t)){const i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){const n=this.namespacesByHostElement.get(t);n&&n.id!==e&&n.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,n,r){this.collectedLeaveElements.push(t),t[SE]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}listen(e,t,n,r,i){return ME(t)?this._fetchNamespace(e).listen(t,n,r,i):()=>{}}_buildInstruction(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}destroyInnerAnimations(e){let t=this.driver.query(e,g_,!0);t.forEach(e=>this.destroyActiveAnimationsForElement(e)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,y_,!0),t.forEach(e=>this.finishActiveQueriedAnimationOnElement(e)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(e=>{e.queued?e.markedForDestroy=!0:e.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(e=>e.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return qC(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[SE];if(t&&t.setForRemoval){if(e[SE]=wE,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}this.driver.matchesElement(e,_E)&&this.markElementAsDisabled(e,!1),this.driver.query(e,_E,!0).forEach(e=>{this.markElementAsDisabled(e,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((e,t)=>this._balanceNamespaceList(e,t)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)LE(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let e=0;e<n.length;e++)n[e]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(e=>e()),this._flushFns=[],this._whenQuietFns.length){const e=this._whenQuietFns;this._whenQuietFns=[],t.length?qC(t).onDone(()=>{e.forEach(e=>e())}):e.forEach(e=>e())}}reportError(e){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${e.join("\n")}`)}_flushAnimations(e,t){const n=new Q_,r=[],i=new Map,s=[],o=new Map,a=new Map,l=new Map,c=new Set;this.disabledNodes.forEach(e=>{c.add(e);const t=this.driver.query(e,".ng-animate-queued",!0);for(let n=0;n<t.length;n++)c.add(t[n])});const u=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=xE(h,this.collectedEnterElements),f=new Map;let p=0;d.forEach((e,t)=>{const n=d_+p++;f.set(t,n),e.forEach(e=>LE(e,n))});const g=[],m=new Set,y=new Set;for(let A=0;A<this.collectedLeaveElements.length;A++){const e=this.collectedLeaveElements[A],t=e[SE];t&&t.setForRemoval&&(g.push(e),m.add(e),t.hasAnimation?this.driver.query(e,".ng-star-inserted",!0).forEach(e=>m.add(e)):y.add(e))}const v=new Map,C=xE(h,Array.from(m));C.forEach((e,t)=>{const n=f_+p++;v.set(t,n),e.forEach(e=>LE(e,n))}),e.push(()=>{d.forEach((e,t)=>{const n=f.get(t);e.forEach(e=>FE(e,n))}),C.forEach((e,t)=>{const n=v.get(t);e.forEach(e=>FE(e,n))}),g.forEach(e=>{this.processLeaveNode(e)})});const _=[],E=[];for(let A=this._namespaceList.length-1;A>=0;A--)this._namespaceList[A].drainQueuedTransitions(t).forEach(e=>{const t=e.player,i=e.element;if(_.push(t),this.collectedEnterElements.length){const e=i[SE];if(e&&e.setForMove)return void t.destroy()}const c=!u||!this.driver.containsElement(u,i),h=v.get(i),d=f.get(i),p=this._buildInstruction(e,n,d,h,c);if(p.errors&&p.errors.length)E.push(p);else{if(c)return t.onStart(()=>O_(i,p.fromStyles)),t.onDestroy(()=>b_(i,p.toStyles)),void r.push(t);if(e.isFallbackTransition)return t.onStart(()=>O_(i,p.fromStyles)),t.onDestroy(()=>b_(i,p.toStyles)),void r.push(t);p.timelines.forEach(e=>e.stretchStartingKeyframe=!0),n.append(i,p.timelines),s.push({instruction:p,player:t,element:i}),p.queriedElements.forEach(e=>QC(o,e,[]).push(t)),p.preStyleProps.forEach((e,t)=>{const n=Object.keys(e);if(n.length){let e=a.get(t);e||a.set(t,e=new Set),n.forEach(t=>e.add(t))}}),p.postStyleProps.forEach((e,t)=>{const n=Object.keys(e);let r=l.get(t);r||l.set(t,r=new Set),n.forEach(e=>r.add(e))})}});if(E.length){const e=[];E.forEach(t=>{e.push(`@${t.triggerName} has failed due to:\n`),t.errors.forEach(t=>e.push(`- ${t}\n`))}),_.forEach(e=>e.destroy()),this.reportError(e)}const w=new Map,P=new Map;s.forEach(e=>{const t=e.element;n.has(t)&&(P.set(t,t),this._beforeAnimationBuild(e.player.namespaceId,e.instruction,w))}),r.forEach(e=>{const t=e.element;this._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(e=>{QC(w,t,[]).push(e),e.destroy()})});const S=g.filter(e=>BE(e,a,l)),b=new Map;RE(b,this.driver,y,l,UC).forEach(e=>{BE(e,a,l)&&S.push(e)});const O=new Map;d.forEach((e,t)=>{RE(O,this.driver,new Set(e),a,"!")}),S.forEach(e=>{const t=b.get(e),n=O.get(e);b.set(e,Object.assign(Object.assign({},t),n))});const k=[],T=[],I={};s.forEach(e=>{const{element:t,player:s,instruction:o}=e;if(n.has(t)){if(c.has(t))return s.onDestroy(()=>b_(t,o.toStyles)),s.disabled=!0,s.overrideTotalTime(o.totalTime),void r.push(s);let e=I;if(P.size>1){let n=t;const r=[];for(;n=n.parentNode;){const t=P.get(n);if(t){e=t;break}r.push(n)}r.forEach(t=>P.set(t,e))}const n=this._buildAnimation(s.namespaceId,o,w,i,O,b);if(s.setRealPlayer(n),e===I)k.push(s);else{const t=this.playersByElement.get(e);t&&t.length&&(s.parentPlayer=qC(t)),r.push(s)}}else O_(t,o.fromStyles),s.onDestroy(()=>b_(t,o.toStyles)),T.push(s),c.has(t)&&r.push(s)}),T.forEach(e=>{const t=i.get(e.element);if(t&&t.length){const n=qC(t);e.setRealPlayer(n)}}),r.forEach(e=>{e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(let A=0;A<g.length;A++){const e=g[A],t=e[SE];if(FE(e,f_),t&&t.hasAnimation)continue;let n=[];if(o.size){let t=o.get(e);t&&t.length&&n.push(...t);let r=this.driver.query(e,y_,!0);for(let e=0;e<r.length;e++){let t=o.get(r[e]);t&&t.length&&n.push(...t)}}const r=n.filter(e=>!e.destroyed);r.length?UE(this,e,r):this.processLeaveNode(e)}return g.length=0,k.forEach(e=>{this.players.push(e),e.onDone(()=>{e.destroy();const t=this.players.indexOf(e);this.players.splice(t,1)}),e.play()}),k}elementContainsData(e,t){let n=!1;const r=t[SE];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,i){let s=[];if(t){const t=this.playersByQueriedElement.get(e);t&&(s=t)}else{const t=this.playersByElement.get(e);if(t){const e=!i||i==OE;t.forEach(t=>{t.queued||!e&&t.triggerName!=r||s.push(t)})}}return(n||r)&&(s=s.filter(e=>!(n&&n!=e.namespaceId||r&&r!=e.triggerName))),s}_beforeAnimationBuild(e,t,n){const r=t.element,i=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName;for(const o of t.timelines){const e=o.element,a=e!==r,l=QC(n,e,[]);this._getPreviousPlayers(e,a,i,s,t.toState).forEach(e=>{const t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),l.push(e)})}O_(r,t.fromStyles)}_buildAnimation(e,t,n,r,i,s){const o=t.triggerName,a=t.element,l=[],c=new Set,u=new Set,h=t.timelines.map(t=>{const h=t.element;c.add(h);const d=h[SE];if(d&&d.removedBeforeQueried)return new zC(t.duration,t.delay);const f=h!==a,p=function(e){const t=[];return VE(e,t),t}((n.get(h)||EE).map(e=>e.getRealPlayer())).filter(e=>!!e.element&&e.element===h),g=i.get(h),m=s.get(h),y=WC(0,this._normalizer,0,t.keyframes,g,m),v=this._buildPlayer(t,y,p);if(t.subTimeline&&r&&u.add(h),f){const t=new AE(e,o,h);t.setRealPlayer(v),l.push(t)}return v});l.forEach(e=>{QC(this.playersByQueriedElement,e.element,[]).push(e),e.onDone(()=>function(e,t,n){let r;if(e instanceof Map){if(r=e.get(t),r){if(r.length){const e=r.indexOf(n);r.splice(e,1)}0==r.length&&e.delete(t)}}else if(r=e[t],r){if(r.length){const e=r.indexOf(n);r.splice(e,1)}0==r.length&&delete e[t]}return r}(this.playersByQueriedElement,e.element,e))}),c.forEach(e=>LE(e,m_));const d=qC(h);return d.onDestroy(()=>{c.forEach(e=>FE(e,m_)),b_(a,t.toStyles)}),u.forEach(e=>{QC(r,e,[]).push(d)}),d}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new zC(e.duration,e.delay)}}class AE{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new zC,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(n=>jC(e,t,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){QC(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function ME(e){return e&&1===e.nodeType}function NE(e,t){const n=e.style.display;return e.style.display=t??"none",n}function RE(e,t,n,r,i){const s=[];n.forEach(e=>s.push(NE(e)));const o=[];r.forEach((n,r)=>{const s={};n.forEach(e=>{const n=s[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[SE]=PE,o.push(r))}),e.set(r,s)});let a=0;return n.forEach(e=>NE(e,s[a++])),o}function xE(e,t){const n=new Map;if(e.forEach(e=>n.set(e,[])),0==t.length)return n;const r=new Set(t),i=new Map;function s(e){if(!e)return 1;let t=i.get(e);if(t)return t;const o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:s(o),i.set(e,t),t}return t.forEach(e=>{const t=s(e);1!==t&&n.get(t).push(e)}),n}const DE="$$classes";function LE(e,t){if(e.classList)e.classList.add(t);else{let n=e[DE];n||(n=e[DE]={}),n[t]=!0}}function FE(e,t){if(e.classList)e.classList.remove(t);else{let n=e[DE];n&&delete n[t]}}function UE(e,t,n){qC(n).onDone(()=>e.processLeaveNode(t))}function VE(e,t){for(let n=0;n<e.length;n++){const r=e[n];r instanceof HC?VE(r.players,t):t.push(r)}}function BE(e,t,n){const r=n.get(e);if(!r)return!1;let i=t.get(e);return i?r.forEach(e=>i.add(e)):t.set(e,r),n.delete(e),!0}class $E{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(e,t)=>{},this._transitionEngine=new IE(e,t,n),this._timelineEngine=new yE(e,t,n),this._transitionEngine.onRemovalComplete=(e,t)=>this.onRemovalComplete(e,t)}registerTrigger(e,t,n,r,i){const s=e+"-"+r;let o=this._triggerCache[s];if(!o){const e=[],t=G_(this._driver,i,e);if(e.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${e.join("\n - ")}`);o=function(e,t,n){return new pE(e,t,n)}(r,t,this._normalizer),this._triggerCache[s]=o}this._transitionEngine.registerTrigger(t,r,o)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if("@"==n.charAt(0)){const[e,i]=XC(n);this._timelineEngine.command(e,t,i,r)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,i){if("@"==n.charAt(0)){const[e,r]=XC(n);return this._timelineEngine.listen(e,t,r,i)}return this._transitionEngine.listen(e,t,n,r,i)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function zE(e,t){let n=null,r=null;return Array.isArray(t)&&t.length?(n=GE(t[0]),t.length>1&&(r=GE(t[t.length-1]))):t&&(n=GE(t)),n||r?new HE(e,n,r):null}let HE=(()=>{class e{constructor(t,n,r){this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;let i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&b_(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(b_(this._element,this._initialStyles),this._endStyles&&(b_(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(O_(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(O_(this._element,this._endStyles),this._endStyles=null),b_(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function GE(e){let t=null;const n=Object.keys(e);for(let r=0;r<n.length;r++){const i=n[r];ZE(i)&&(t=t||{},t[i]=e[i])}return t}function ZE(e){return"display"===e||"position"===e}const qE="animation",WE="animationend";class jE{constructor(e,t,n,r,i,s,o){this._element=e,this._name=t,this._duration=n,this._delay=r,this._easing=i,this._fillMode=s,this._onDoneFn=o,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=e=>this._handleCallback(e)}apply(){(function(e,t){const n=ew(e,"").trim();let r=0;n.length&&(function(e,t){let n=0;for(let r=0;r<e.length;r++)","===e.charAt(r)&&n++;return n}(n)+1,t=`${n}, ${t}`),JE(e,"",t)})(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),XE(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){YE(this._element,this._name,"paused")}resume(){YE(this._element,this._name,"running")}setPosition(e){const t=KE(this._element,this._name);this._position=e*this._duration,JE(this._element,"Delay",`-${this._position}ms`,t)}getPosition(){return this._position}_handleCallback(e){const t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),XE(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){const n=ew(e,"").split(","),r=QE(n,t);r>=0&&(n.splice(r,1),JE(e,"",n.join(",")))}(this._element,this._name))}}function YE(e,t,n){JE(e,"PlayState",n,KE(e,t))}function KE(e,t){const n=ew(e,"");return n.indexOf(",")>0?QE(n.split(","),t):QE([n],t)}function QE(e,t){for(let n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function XE(e,t,n){n?e.removeEventListener(WE,t):e.addEventListener(WE,t)}function JE(e,t,n,r){const i=qE+t;if(null!=r){const t=e.style[i];if(t.length){const e=t.split(",");e[r]=n,n=e.join(",")}}e.style[i]=n}function ew(e,t){return e.style[qE+t]||""}class tw{constructor(e,t,n,r,i,s,o,a){this.element=e,this.keyframes=t,this.animationName=n,this._duration=r,this._delay=i,this._finalStyles=o,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=s||"linear",this.totalTime=r+i,this._buildStyler()}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}destroy(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(e=>e()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}finish(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(e){this._styler.setPosition(e)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new jE(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}beforeDestroy(){this.init();const e={};if(this.hasStarted()){const t=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(e[n]=t?this._finalStyles[n]:U_(this.element,n))})}this.currentSnapshot=e}}class nw extends zC{constructor(e,t){super(),this.element=e,this._startingStyles={},this.__initialized=!1,this._styles=c_(t)}init(){this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(e=>{this._startingStyles[e]=this.element.style[e]}),super.init())}play(){!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(e=>this.element.style.setProperty(e,this._styles[e])),super.play())}destroy(){!this._startingStyles||(Object.keys(this._startingStyles).forEach(e=>{const t=this._startingStyles[e];t?this.element.style.setProperty(e,t):this.element.style.removeProperty(e)}),this._startingStyles=null,super.destroy())}}class rw{constructor(){this._count=0}validateStyleProperty(e){return s_(e)}matchesElement(e,t){return o_(e,t)}containsElement(e,t){return a_(e,t)}query(e,t,n){return l_(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}buildKeyframeElement(e,t,n){n=n.map(e=>c_(e));let r=`@keyframes ${t} {\n`,i="";n.forEach(e=>{i=" ";const t=parseFloat(e.offset);r+=`${i}${100*t}% {\n`,i+=" ",Object.keys(e).forEach(t=>{const n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+=`${i}animation-timing-function: ${n};\n`));default:return void(r+=`${i}${t}: ${n};\n`)}}),r+=`${i}}\n`}),r+="}\n";const s=document.createElement("style");return s.textContent=r,s}animate(e,t,n,r,i,s=[],o){const a=s.filter(e=>e instanceof tw),l={};D_(n,r)&&a.forEach(e=>{let t=e.currentSnapshot;Object.keys(t).forEach(e=>l[e]=t[e])});const c=function(e){let t={};return e&&(Array.isArray(e)?e:[e]).forEach(e=>{Object.keys(e).forEach(n=>{"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=L_(e,t,l));if(0==n)return new nw(e,c);const u="gen_css_kf_"+this._count++,h=this.buildKeyframeElement(e,u,t);(function(e){var t;const n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(h);const d=zE(e,t),f=new tw(e,t,u,n,r,i,c,d);return f.onDestroy(()=>{var e;(e=h).parentNode.removeChild(e)}),f}}class iw{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,n){return e.animate(t,n)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(t=>{"offset"!=t&&(e[t]=this._finished?this._finalKeyframe[t]:U_(this.element,t))}),this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}class sw{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(ow().toString()),this._cssKeyframesDriver=new rw}validateStyleProperty(e){return s_(e)}matchesElement(e,t){return o_(e,t)}containsElement(e,t){return a_(e,t)}query(e,t,n){return l_(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}overrideWebAnimationsSupport(e){this._isNativeImpl=e}animate(e,t,n,r,i,s=[],o){if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,s);const a={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(a.easing=i);const l={},c=s.filter(e=>e instanceof iw);D_(n,r)&&c.forEach(e=>{let t=e.currentSnapshot;Object.keys(t).forEach(e=>l[e]=t[e])});const u=zE(e,t=L_(e,t=t.map(e=>w_(e,!1)),l));return new iw(e,t,a,u)}}function ow(){return GC()&&Element.prototype.animate||{}}let aw=(()=>{class e extends FC{constructor(e,t){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(t.body,{id:"0",encapsulation:Ue.None,styles:[],data:{animation:[]}})}build(e){const t=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(e)?VC(e):e;return uw(this._renderer,null,t,"register",[n]),new lw(t,this._renderer)}}return e.\u0275fac=function(t){return new(t||e)(Or(bc),Or(jh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class lw extends class{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new cw(this._id,e,t||{},this._renderer)}}class cw{constructor(e,t,n,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return uw(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function uw(e,t,n,r,i){return e.setProperty(t,`@@${n}:${r}`,i)}const hw="@.disabled";let dw=(()=>{class e{constructor(e,t,n){this.delegate=e,this.engine=t,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),t.onRemovalComplete=(e,t)=>{t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}createRenderer(e,t){const n=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){let e=this._rendererCache.get(n);return e||(e=new fw("",n,this.engine),this._rendererCache.set(n,e)),e}const r=t.id,i=t.id+"-"+this._currentId;this._currentId++,this.engine.register(i,e);const s=t=>{Array.isArray(t)?t.forEach(s):this.engine.registerTrigger(r,i,e,t.name,t)};return t.data.animation.forEach(s),new pw(this,i,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,n){e>=0&&e<this._microtaskId?this._zone.run(()=>t(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(e=>{const[t,n]=e;t(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return e.\u0275fac=function(t){return new(t||e)(Or(bc),Or($E),Or(mh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class fw{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?e=>t.destroyNode(e):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==hw?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class pw extends fw{constructor(e,t,n,r){super(t,n,r),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==hw?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const r=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e);let i=t.substr(1),s="";return"@"!=i.charAt(0)&&([i,s]=function(e){const t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(i)),this.engine.listen(this.namespaceId,r,i,s,e=>{this.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}let gw=(()=>{class e extends $E{constructor(e,t,n){super(e.body,t,n)}ngOnDestroy(){this.flush()}}return e.\u0275fac=function(t){return new(t||e)(Or(jh),Or(h_),Or(aE))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const mw=new or("AnimationModuleType"),yw=[{provide:FC,useClass:aw},{provide:aE,useFactory:function(){return new lE}},{provide:$E,useClass:gw},{provide:bc,useFactory:function(e,t,n){return new dw(e,t,n)},deps:[Tf,$E,mh]}],vw=[{provide:h_,useFactory:function(){return"function"==typeof ow()?new sw:new rw}},{provide:mw,useValue:"BrowserAnimations"},...yw],Cw=[{provide:h_,useClass:u_},{provide:mw,useValue:"NoopAnimations"},...yw];let _w=(()=>{class e{static withConfig(t){return{ngModule:e,providers:t.disableAnimations?Cw:vw}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:vw,imports:[Hf]}),e})();var Ew=n(9575),ww=n.n(Ew);function Pw(e,t,n,r,i,s,o){try{var a=e[s](o),l=a.value}catch(c){return void n(c)}a.done?t(l):Promise.resolve(l).then(r,i)}function Sw(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var s=e.apply(t,n);function o(e){Pw(s,r,i,o,a,"next",e)}function a(e){Pw(s,r,i,o,a,"throw",e)}o(void 0)})}}class bw{static expectToBe(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error(`A default switch case did not observe the correct value, expected ${t}, but got ${e} instead.`)}static expectToBeMultiple(e,t){let n=!1;for(const r of t)if(e===r){n=!0;break}if(!1===n)throw new Error(`A default switch case did not observe the correct value, expected a value among ${t}, but got ${e} instead.`)}static getNonNullable(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}function Ow(e,t){e&&console.log(t)}function kw(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);{const n=e,r=t;for(const e of Object.keys(n)){if(!(e in r))return!1;if(!1===kw(n[e],r[e]))return!1}return!0}}return e===t}function Tw(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(const t in e)if(null!=e[t]&&!1===Tw(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function Iw(e,t){if(Tw(e)&&Tw(t))return kw(e,t);throw new Error(`Comparing non comparable objects: ${e.constructor.name} and ${t.constructor.name}`)}class Aw{constructor(e){this.value=e}static of(e){return new Aw(e)}static ofNullable(e){return null==e?Aw.empty():Aw.of(e)}static empty(){return new Aw(null)}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(e){return this.isPresent()?this.value:e}equals(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&Iw(this.value,e.value)}equalsValue(e){return this.equals(Aw.of(e))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(e){return this.isPresent()?Aw.of(e(this.get())):Aw.empty()}}class Mw{static success(e){return new Nw(e)}static failure(e){return new Rw(e)}constructor(){}equals(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&Iw(this.get(),e.get())}}class Nw extends Mw{constructor(e){super(),this.value=e}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(e){return e}toOptional(){return Aw.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class Rw extends Mw{constructor(e){super(),this.reason=e}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(e){return this.getReason()}toOptional(){return Aw.empty()}toString(){return`MGPFallible.failure(${this.reason})`}}class xw{constructor(e){this.reason=e}static ofFallible(e){return e.isSuccess()?xw.SUCCESS:xw.failure(e.getReason())}static failure(e){return new xw(e)}isFailure(){return!1===this.isSuccess()}isSuccess(){return null==this.reason}getReason(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}toFallible(e){return this.isSuccess()?Mw.success(e):Mw.failure(this.getReason())}toFailedFallible(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return Mw.failure(this.getReason())}}xw.SUCCESS=new xw(null);const Dw=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Lw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0;let c=(15&o)<<2|l>>6,u=63&l;a||(u=64,s||(c=64)),r.push(n[t>>2],n[(3&t)<<4|o>>4],n[c],n[u])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Dw(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw Error();r.push(t<<2|s>>4),64!==o&&(r.push(s<<4&240|o>>2),64!==a&&r.push(o<<6&192|a))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Fw=function(e){return function(e){const t=Dw(e);return Lw.encodeByteArray(t,!0)}(e).replace(/\./g,"")};class Uw{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function Vw(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Bw(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vw())}function $w(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function zw(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Hw(){const e=Vw();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function Gw(){return"object"==typeof indexedDB}function Zw(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function qw(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class Ww extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Ww.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jw.prototype.create)}}class jw{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(Yw,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(i,n):"Error";return new Ww(r,`${this.serviceName}: ${s} (${r}).`,n)}}const Yw=/\{\$([^}]+)}/g;function Kw(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(Qw(n)&&Qw(s)){if(!Kw(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Qw(e){return null!==e&&"object"==typeof e}function Xw(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Jw(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function eP(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class tP{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of["next","error","complete"])if(n in e&&"function"==typeof e[n])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=nP),void 0===r.error&&(r.error=nP),void 0===r.complete&&(r.complete=nP);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!=typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function nP(){}function rP(e,t=1e3,n=2){const r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function iP(e){return e&&e._delegate?e._delegate:e}class sP{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const oP="[DEFAULT]";class aP{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Uw;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:oP})}catch{}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch{}}}}clearInstance(e=oP){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return Sw(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=oP){return this.instances.has(e)}getOptions(e=oP){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(i)&&s.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===oP?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=oP){return this.component?this.component.multipleInstances?e:oP:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class lP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new aP(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const cP=[];var uP=(()=>{return(e=uP||(uP={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",uP;var e})();const hP={debug:uP.DEBUG,verbose:uP.VERBOSE,info:uP.INFO,warn:uP.WARN,error:uP.ERROR,silent:uP.SILENT},dP=uP.INFO,fP={[uP.DEBUG]:"log",[uP.VERBOSE]:"log",[uP.INFO]:"info",[uP.WARN]:"warn",[uP.ERROR]:"error"},pP=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=fP[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class gP{constructor(e){this.name=e,this._logLevel=dP,this._logHandler=pP,this._userLogHandler=null,cP.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in uP))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?hP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,uP.DEBUG,...e),this._logHandler(this,uP.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,uP.VERBOSE,...e),this._logHandler(this,uP.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,uP.INFO,...e),this._logHandler(this,uP.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,uP.WARN,...e),this._logHandler(this,uP.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,uP.ERROR,...e),this._logHandler(this,uP.ERROR,...e)}}let mP,yP;const vP=new WeakMap,CP=new WeakMap,_P=new WeakMap,EP=new WeakMap,wP=new WeakMap;let PP={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return CP.get(e);if("objectStoreNames"===t)return e.objectStoreNames||_P.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return bP(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function SP(e){return"function"==typeof e?function(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(yP||(yP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(OP(this),t),bP(vP.get(this))}:function(...t){return bP(e.apply(OP(this),t))}:function(t,...n){const r=e.call(OP(this),t,...n);return _P.set(r,t.sort?t.sort():[t]),bP(r)}}(e):(e instanceof IDBTransaction&&function(e){if(CP.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});CP.set(e,t)}(e),((e,t)=>t.some(t=>e instanceof t))(e,mP||(mP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,PP):e)}function bP(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(bP(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&vP.set(t,e)}).catch(()=>{}),wP.set(t,e),t}(e);if(EP.has(e))return EP.get(e);const t=SP(e);return t!==e&&(EP.set(e,t),wP.set(t,e)),t}const OP=e=>wP.get(e);function kP(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=bP(o);return r&&o.addEventListener("upgradeneeded",e=>{r(bP(o.result),e.oldVersion,e.newVersion,bP(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}function TP(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",()=>t()),bP(n).then(()=>{})}const IP=["get","getKey","getAll","getAllKeys","count"],AP=["put","add","delete","clear"],MP=new Map;function NP(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(MP.get(t))return MP.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=AP.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!IP.includes(n))return;const s=function(){var e=Sw(function*(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(yield Promise.all([o[n](...t),i&&s.done]))[0]});return function(t){return e.apply(this,arguments)}}();return MP.set(t,s),s}var RP;RP=PP,PP={...RP,get:(e,t,n)=>NP(e,t)||RP.get(e,t,n),has:(e,t)=>!!NP(e,t)||RP.has(e,t)};class xP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const DP="@firebase/app",LP=new gP("@firebase/app"),FP="[DEFAULT]",UP={[DP]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},VP=new Map,BP=new Map;function $P(e,t){try{e.container.addComponent(t)}catch(n){LP.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function zP(e){const t=e.name;if(BP.has(t))return LP.debug(`There were multiple attempts to register component ${t}.`),!1;BP.set(t,e);for(const n of VP.values())$P(n,e);return!0}function HP(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const GP=new jw("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class ZP{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new sP("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw GP.create("app-deleted",{appName:this._name})}}const qP="9.9.0";function WP(e,t={}){"object"!=typeof t&&(t={name:t});const n=Object.assign({name:FP,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw GP.create("bad-app-name",{appName:String(r)});const i=VP.get(r);if(i){if(Kw(e,i.options)&&Kw(n,i.config))return i;throw GP.create("duplicate-app",{appName:r})}const s=new lP(r);for(const a of BP.values())s.addComponent(a);const o=new ZP(e,n,s);return VP.set(r,o),o}function jP(e=FP){const t=VP.get(e);if(!t)throw GP.create("no-app",{appName:e});return t}function YP(){return Array.from(VP.values())}function KP(e,t,n){var r;let i=null!==(r=UP[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void LP.warn(e.join(" "))}zP(new sP(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const QP="firebase-heartbeat-store";let XP=null;function JP(){return XP||(XP=kP("firebase-heartbeat-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(QP)}}).catch(e=>{throw GP.create("storage-open",{originalErrorMessage:e.message})})),XP}function eS(){return eS=Sw(function*(e){var t;try{return(yield JP()).transaction(QP).objectStore(QP).get(rS(e))}catch(n){throw GP.create("storage-get",{originalErrorMessage:null===(t=n)||void 0===t?void 0:t.message})}}),eS.apply(this,arguments)}function tS(e,t){return nS.apply(this,arguments)}function nS(){return nS=Sw(function*(e,t){var n;try{const n=(yield JP()).transaction(QP,"readwrite");return yield n.objectStore(QP).put(t,rS(e)),n.done}catch(r){throw GP.create("storage-set",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message})}}),nS.apply(this,arguments)}function rS(e){return`${e.name}!${e.options.appId}`}class iS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new oS(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}triggerHeartbeat(){var e=this;return Sw(function*(){const t=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=sS();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==n&&!e._heartbeatsCache.heartbeats.some(e=>e.date===n))return e._heartbeatsCache.heartbeats.push({date:n,agent:t}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return Sw(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const t=sS(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),aS(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),aS(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(e._heartbeatsCache.heartbeats),i=Fw(JSON.stringify({version:2,heartbeats:n}));return e._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(e._heartbeatsCache.heartbeats=r,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),i})()}}function sS(){return(new Date).toISOString().substring(0,10)}class oS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Sw(function*(){return!!Gw()&&Zw().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return Sw(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function(e){return eS.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var t=this;return Sw(function*(){var n;if(yield t._canUseIndexedDBPromise){const r=yield t.read();return tS(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return Sw(function*(){var n;if(yield t._canUseIndexedDBPromise){const r=yield t.read();return tS(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}})()}}function aS(e){return Fw(JSON.stringify({version:2,heartbeats:e})).length}zP(new sP("platform-logger",e=>new xP(e),"PRIVATE")),zP(new sP("heartbeat",e=>new iS(e),"PRIVATE")),KP(DP,"0.7.28",""),KP(DP,"0.7.28","esm2017"),KP("fire-js","");var lS,cS="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},uS={},hS=hS||{},dS=cS||self;function fS(){}function pS(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function gS(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var mS="closure_uid_"+(1e9*Math.random()>>>0),yS=0;function vS(e,t,n){return e.call.apply(e.bind,arguments)}function CS(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function _S(e,t,n){return(_S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?vS:CS).apply(null,arguments)}function ES(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function wS(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function PS(){this.s=this.s,this.o=this.o}var SS={};PS.prototype.s=!1,PS.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,mS)&&e[mS]||(e[mS]=++yS)}(this);delete SS[e]}},PS.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const bS=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},OS=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){const r=e.length,i="string"==typeof e?e.split(""):e;for(let s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)};function kS(e){return Array.prototype.concat.apply([],arguments)}function TS(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function IS(e){return/^[\s\xa0]*$/.test(e)}var AS,MS=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function NS(e,t){return-1!=e.indexOf(t)}function RS(e,t){return e<t?-1:e>t?1:0}e:{var xS=dS.navigator;if(xS){var DS=xS.userAgent;if(DS){AS=DS;break e}}AS=""}function LS(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function FS(e){const t={};for(const n in e)t[n]=e[n];return t}var US="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function VS(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<US.length;t++)n=US[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function BS(e){return BS[" "](e),e}BS[" "]=fS;var $S,zS=NS(AS,"Opera"),HS=NS(AS,"Trident")||NS(AS,"MSIE"),GS=NS(AS,"Edge"),ZS=GS||HS,qS=NS(AS,"Gecko")&&!(NS(AS.toLowerCase(),"webkit")&&!NS(AS,"Edge"))&&!(NS(AS,"Trident")||NS(AS,"MSIE"))&&!NS(AS,"Edge"),WS=NS(AS.toLowerCase(),"webkit")&&!NS(AS,"Edge");function jS(){var e=dS.document;return e?e.documentMode:void 0}e:{var YS="",KS=function(){var e=AS;return qS?/rv:([^\);]+)(\)|;)/.exec(e):GS?/Edge\/([\d\.]+)/.exec(e):HS?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):WS?/WebKit\/(\S+)/.exec(e):zS?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(KS&&(YS=KS?KS[1]:""),HS){var QS=jS();if(null!=QS&&QS>parseFloat(YS)){$S=String(QS);break e}}$S=YS}var XS={};function JS(){return e=XS,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){let e=0;const t=MS(String($S)).split("."),n=MS("9").split("."),r=Math.max(t.length,n.length);for(let o=0;0==e&&o<r;o++){var i=t[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;e=RS(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||RS(0==i[2].length,0==s[2].length)||RS(i[2],s[2]),i=i[3],s=s[3]}while(0==e)}return 0<=e}();var e}var eb=dS.document&&HS&&(jS()||parseInt($S,10))||void 0,tb=function(){if(!dS.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{dS.addEventListener("test",fS,t),dS.removeEventListener("test",fS,t)}catch{}return e}();function nb(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function rb(e,t){if(nb.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(qS){e:{try{BS(t.nodeName);var i=!0;break e}catch{}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:ib[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&rb.Z.h.call(this)}}nb.prototype.h=function(){this.defaultPrevented=!0},wS(rb,nb);var ib={2:"touch",3:"pen",4:"mouse"};rb.prototype.h=function(){rb.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var sb="closure_listenable_"+(1e6*Math.random()|0),ob=0;function ab(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++ob,this.ca=this.fa=!1}function lb(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function cb(e){this.src=e,this.g={},this.h=0}function ub(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=bS(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(lb(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function hb(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==r)return i}return-1}cb.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=hb(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new ab(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var db="closure_lm_"+(1e6*Math.random()|0),fb={};function pb(e,t,n,r,i){if(r&&r.once)return mb(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)pb(e,t[s],n,r,i);return null}return n=Pb(n),e&&e[sb]?e.N(t,n,gS(r)?!!r.capture:!!r,i):gb(e,t,n,!1,r,i)}function gb(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=gS(i)?!!i.capture:!!i,a=Eb(e);if(a||(e[db]=a=new cb(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){var e=_b;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)tb||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Cb(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function mb(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)mb(e,t[s],n,r,i);return null}return n=Pb(n),e&&e[sb]?e.O(t,n,gS(r)?!!r.capture:!!r,i):gb(e,t,n,!0,r,i)}function yb(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)yb(e,t[s],n,r,i);else r=gS(r)?!!r.capture:!!r,n=Pb(n),e&&e[sb]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=hb(s=e.g[t],n,r,i))&&(lb(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=Eb(e))&&(t=e.g[t.toString()],e=-1,t&&(e=hb(t,n,r,i)),(n=-1<e?t[e]:null)&&vb(n))}function vb(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[sb])ub(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Cb(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Eb(t))?(ub(n,e),0==n.h&&(n.src=null,t[db]=null)):lb(e)}}}function Cb(e){return e in fb?fb[e]:fb[e]="on"+e}function _b(e,t){if(e.ca)e=!0;else{t=new rb(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&vb(e),e=n.call(r,t)}return e}function Eb(e){return(e=e[db])instanceof cb?e:null}var wb="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pb(e){return"function"==typeof e?e:(e[wb]||(e[wb]=function(t){return e.handleEvent(t)}),e[wb])}function Sb(){PS.call(this),this.i=new cb(this),this.P=this,this.I=null}function bb(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new nb(t,e);else if(t instanceof nb)t.target=t.target||e;else{var i=t;VS(t=new nb(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Ob(o,r,!0,t)&&i}if(i=Ob(o=t.g=e,r,!0,t)&&i,i=Ob(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Ob(o=t.g=n[s],r,!1,t)&&i}function Ob(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,l=o.ia||o.src;o.fa&&ub(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}wS(Sb,PS),Sb.prototype[sb]=!0,Sb.prototype.removeEventListener=function(e,t,n,r){yb(this,e,t,n,r)},Sb.prototype.M=function(){if(Sb.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)lb(n[r]);delete t.g[e],t.h--}}this.I=null},Sb.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Sb.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var kb=dS.JSON.stringify;function Tb(){var e=Db;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Ib,Ab=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new Mb,e=>e.reset());class Mb{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Nb(e){dS.setTimeout(()=>{throw e},0)}function Rb(e,t){Ib||function(){var e=dS.Promise.resolve(void 0);Ib=function(){e.then(Lb)}}(),xb||(Ib(),xb=!0),Db.add(e,t)}var xb=!1,Db=new class{constructor(){this.h=this.g=null}add(e,t){const n=Ab.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function Lb(){for(var e;e=Tb();){try{e.h.call(e.g)}catch(n){Nb(n)}var t=Ab;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}xb=!1}function Fb(e,t){Sb.call(this),this.h=e||1,this.g=t||dS,this.j=_S(this.kb,this),this.l=Date.now()}function Ub(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function Vb(e,t,n){if("function"==typeof e)n&&(e=_S(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=_S(e.handleEvent,e)}return 2147483647<Number(t)?-1:dS.setTimeout(e,t||0)}function Bb(e){e.g=Vb(()=>{e.g=null,e.i&&(e.i=!1,Bb(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}wS(Fb,Sb),(lS=Fb.prototype).da=!1,lS.S=null,lS.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),bb(this,"tick"),this.da&&(Ub(this),this.start()))}},lS.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},lS.M=function(){Fb.Z.M.call(this),Ub(this),delete this.g};class $b extends PS{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Bb(this)}M(){super.M(),this.g&&(dS.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function zb(e){PS.call(this),this.h=e,this.g={}}wS(zb,PS);var Hb=[];function Gb(e,t,n,r){Array.isArray(n)||(n&&(Hb[0]=n.toString()),n=Hb);for(var i=0;i<n.length;i++){var s=pb(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Zb(e){LS(e.g,function(e,t){this.g.hasOwnProperty(t)&&vb(e)},e),e.g={}}function qb(){this.g=!0}function Wb(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return kb(n)}catch{return t}}(e,n)+(r?" "+r:"")})}zb.prototype.M=function(){zb.Z.M.call(this),Zb(this)},zb.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},qb.prototype.Aa=function(){this.g=!1},qb.prototype.info=function(){};var jb={},Yb=null;function Kb(){return Yb=Yb||new Sb}function Qb(e){nb.call(this,jb.Ma,e)}function Xb(e){const t=Kb();bb(t,new Qb(t,e))}function Jb(e,t){nb.call(this,jb.STAT_EVENT,e),this.stat=t}function eO(e){const t=Kb();bb(t,new Jb(t,e))}function tO(e,t){nb.call(this,jb.Na,e),this.size=t}function nO(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return dS.setTimeout(function(){e()},t)}jb.Ma="serverreachability",wS(Qb,nb),jb.STAT_EVENT="statevent",wS(Jb,nb),jb.Na="timingevent",wS(tO,nb);var rO={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},iO={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function sO(){}function oO(){}sO.prototype.h=null;var aO,lO={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function cO(){nb.call(this,"d")}function uO(){nb.call(this,"c")}function hO(){}function dO(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new zb(this),this.P=pO,this.W=new Fb(e=ZS?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new fO}function fO(){this.i=null,this.g="",this.h=!1}wS(cO,nb),wS(uO,nb),wS(hO,sO),hO.prototype.g=function(){return new XMLHttpRequest},hO.prototype.i=function(){return{}},aO=new hO;var pO=45e3,gO={},mO={};function yO(e,t,n){e.K=1,e.v=BO(xO(t)),e.s=n,e.U=!0,vO(e,null)}function vO(e,t){e.F=Date.now(),wO(e),e.A=xO(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),JO(n.h,"t",r),e.C=0,n=e.l.H,e.h=new fO,e.g=Jk(e.l,n?t:null,!e.s),0<e.O&&(e.L=new $b(_S(e.Ia,e,e.g),e.O)),Gb(e.V,e.g,"readystatechange",e.gb),t=e.H?FS(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Xb(1),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function CO(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function _O(e,t,n){let r,i=!0;for(;!e.I&&e.C<n.length;){if(r=EO(e,n),r==mO){4==t&&(e.o=4,eO(14),i=!1),Wb(e.j,e.m,null,"[Incomplete Response]");break}if(r==gO){e.o=4,eO(15),Wb(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Wb(e.j,e.m,r,null),kO(e,r)}CO(e)&&r!=mO&&r!=gO&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,eO(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zk(t),t.L=!0,eO(11))):(Wb(e.j,e.m,n,"[Invalid Chunked Response]"),OO(e),bO(e))}function EO(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?mO:(n=Number(t.substring(n,r)),isNaN(n)?gO:(r+=1)+n>t.length?mO:(t=t.substr(r,n),e.C=r+n,t))}function wO(e){e.Y=Date.now()+e.P,PO(e,e.P)}function PO(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=nO(_S(e.eb,e),t)}function SO(e){e.B&&(dS.clearTimeout(e.B),e.B=null)}function bO(e){0==e.l.G||e.I||jk(e.l,e)}function OO(e){SO(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Ub(e.W),Zb(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function kO(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||sk(n.i,e)))if(n.I=e.N,!e.J&&sk(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=nO(_S(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;Wk(n),Lk(n)}Gk(n),eO(18)}if(1>=ik(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Kk(n,11)}else if((e.J||n.g==e)&&Wk(n),!IS(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.U=c[0],c=c[1],2==n.G)if("c"==c[0]){n.J=c[1],n.la=c[2];const t=c[3];null!=t&&(n.ma=t,n.h.info("VER="+n.ma));const i=c[4];null!=i&&(n.za=i,n.h.info("SVER="+n.za));const u=c[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;!s.g&&(NS(e,"spdy")||NS(e,"quic")||NS(e,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(ok(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.sa=e,VO(r.F,r.D,e))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=e;if((r=n).oa=Xk(r,r.H?r.la:null,r.W),o.J){ak(r.i,o);var a=o,l=r.K;l&&a.setTimeout(l),a.B&&(SO(a),wO(a)),r.g=o}else Hk(r);0<n.l.length&&Vk(n)}else"stop"!=c[0]&&"close"!=c[0]||Kk(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?Kk(n,7):Dk(n):"noop"!=c[0]&&n.j&&n.j.wa(c),n.A=0)}Xb(4)}catch{}}function TO(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(pS(e)||"string"==typeof e)OS(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(pS(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(pS(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}}function IO(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof IO)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function AO(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];MO(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)MO(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function MO(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(lS=dO.prototype).setTimeout=function(e){this.P=e},lS.gb=function(e){e=e.target;const t=this.L;t&&3==Ak(e)?t.l():this.Ia(e)},lS.Ia=function(e){try{if(e==this.g)e:{const u=Ak(this.g);var t=this.g.Da();const h=this.g.ba();if(!(3>u)&&(3!=u||ZS||this.g&&(this.h.h||this.g.ga()||Mk(this.g)))){this.I||4!=u||7==t||Xb(8==t||0>=h?3:2),SO(this);var n=this.g.ba();this.N=n;t:if(CO(this)){var r=Mk(this.g);e="";var i=r.length,s=4==Ak(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){OO(this),bO(this);var o="";break t}this.h.i=new dS.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!IS(a)){var c=a;break t}}c=null}if(!(n=c)){this.i=!1,this.o=3,eO(12),OO(this),bO(this);break e}Wb(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,kO(this,n)}this.U?(_O(this,u,o),ZS&&this.i&&3==u&&(Gb(this.V,this.W,"tick",this.fb),this.W.start())):(Wb(this.j,this.m,o,null),kO(this,o)),4==u&&OO(this),this.i&&!this.I&&(4==u?jk(this.l,this):(this.i=!1,wO(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,eO(12)):(this.o=0,eO(13)),OO(this),bO(this)}}}catch{}},lS.fb=function(){if(this.g){var e=Ak(this.g),t=this.g.ga();this.C<t.length&&(SO(this),_O(this,e,t),this.i&&4!=e&&wO(this))}},lS.cancel=function(){this.I=!0,OO(this)},lS.eb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(Xb(3),eO(17)),OO(this),this.o=2,bO(this)):PO(this,this.Y-e)},(lS=IO.prototype).R=function(){AO(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},lS.T=function(){return AO(this),this.g.concat()},lS.get=function(e,t){return MO(this.h,e)?this.h[e]:t},lS.set=function(e,t){MO(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},lS.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}};var NO=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function RO(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof RO){this.g=void 0!==t?t:e.g,DO(this,e.j),this.s=e.s,LO(this,e.i),FO(this,e.m),this.l=e.l,t=e.h;var n=new YO;n.i=t.i,t.g&&(n.g=new IO(t.g),n.h=t.h),UO(this,n),this.o=e.o}else e&&(n=String(e).match(NO))?(this.g=!!t,DO(this,n[1]||"",!0),this.s=$O(n[2]||""),LO(this,n[3]||"",!0),FO(this,n[4]),this.l=$O(n[5]||"",!0),UO(this,n[6]||"",!0),this.o=$O(n[7]||"")):(this.g=!!t,this.h=new YO(null,this.g))}function xO(e){return new RO(e)}function DO(e,t,n){e.j=n?$O(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function LO(e,t,n){e.i=n?$O(t,!0):t}function FO(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function UO(e,t,n){t instanceof YO?(e.h=t,function(e,t){t&&!e.j&&(KO(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(QO(this,t),JO(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=zO(t,WO)),e.h=new YO(t,e.g))}function VO(e,t,n){e.h.set(t,n)}function BO(e){return VO(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function $O(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function zO(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,HO),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function HO(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}RO.prototype.toString=function(){var e=[],t=this.j;t&&e.push(zO(t,GO,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(zO(t,GO,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(zO(n,"/"==n.charAt(0)?qO:ZO,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",zO(n,jO)),e.join("")};var GO=/[#\/\?@]/g,ZO=/[#\?:]/g,qO=/[#\?]/g,WO=/[#\?@]/g,jO=/#/g;function YO(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function KO(e){e.g||(e.g=new IO,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function QO(e,t){KO(e),t=ek(e,t),MO(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,MO((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&AO(e)))}function XO(e,t){return KO(e),t=ek(e,t),MO(e.g.h,t)}function JO(e,t,n){QO(e,t),0<n.length&&(e.i=null,e.g.set(ek(e,t),TS(n)),e.h+=n.length)}function ek(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function tk(e){this.l=e||nk,e=dS.PerformanceNavigationTiming?0<(e=dS.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(dS.g&&dS.g.Ea&&dS.g.Ea()&&dS.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(lS=YO.prototype).add=function(e,t){KO(this),this.i=null,e=ek(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},lS.forEach=function(e,t){KO(this),this.g.forEach(function(n,r){OS(n,function(n){e.call(t,n,r,this)},this)},this)},lS.T=function(){KO(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},lS.R=function(e){KO(this);var t=[];if("string"==typeof e)XO(this,e)&&(t=kS(t,this.g.get(ek(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=kS(t,e[n])}return t},lS.set=function(e,t){return KO(this),this.i=null,XO(this,e=ek(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},lS.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},lS.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};var nk=10;function rk(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ik(e){return e.h?1:e.g?e.g.size:0}function sk(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ok(e,t){e.g?e.g.add(t):e.h=t}function ak(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function lk(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return TS(e.i)}function ck(){}function uk(){this.g=new ck}function hk(e,t,n){const r=n||"";try{TO(e,function(e,n){let i=e;gS(e)&&(i=kb(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function dk(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch{}}function fk(e){this.l=e.$b||null,this.j=e.ib||!1}function pk(e,t){Sb.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=gk,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}tk.prototype.cancel=function(){if(this.i=lk(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}},ck.prototype.stringify=function(e){return dS.JSON.stringify(e,void 0)},ck.prototype.parse=function(e){return dS.JSON.parse(e,void 0)},wS(fk,sO),fk.prototype.g=function(){return new pk(this.l,this.j)},fk.prototype.i=function(e){return function(){return e}}({}),wS(pk,Sb);var gk=0;function mk(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function yk(e){e.readyState=4,e.l=null,e.j=null,e.A=null,vk(e)}function vk(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(lS=pk.prototype).open=function(e,t){if(this.readyState!=gk)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,vk(this)},lS.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||dS).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},lS.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,yk(this)),this.readyState=gk},lS.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,vk(this)),this.g&&(this.readyState=3,vk(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==dS.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;mk(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},lS.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?yk(this):vk(this),3==this.readyState&&mk(this)}},lS.Ua=function(e){this.g&&(this.response=this.responseText=e,yk(this))},lS.Ta=function(e){this.g&&(this.response=e,yk(this))},lS.ha=function(){this.g&&yk(this)},lS.setRequestHeader=function(e,t){this.v.append(e,t)},lS.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},lS.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(pk.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Ck=dS.JSON.parse;function _k(e){Sb.call(this),this.headers=new IO,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Ek,this.K=this.L=!1}wS(_k,Sb);var Ek="",wk=/^https?$/i,Pk=["POST","PUT"];function Sk(e){return"content-type"==e.toLowerCase()}function bk(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Ok(e),Tk(e)}function Ok(e){e.D||(e.D=!0,bb(e,"complete"),bb(e,"error"))}function kk(e){if(e.h&&void 0!==hS&&(!e.C[1]||4!=Ak(e)||2!=e.ba()))if(e.v&&4==Ak(e))Vb(e.Fa,0,e);else if(bb(e,"readystatechange"),4==Ak(e)){e.h=!1;try{const a=e.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===a){var i=String(e.H).match(NO)[1]||null;if(!i&&dS.self&&dS.self.location){var s=dS.self.location.protocol;i=s.substr(0,s.length-1)}r=!wk.test(i?i.toLowerCase():"")}n=r}if(n)bb(e,"complete"),bb(e,"success");else{e.m=6;try{var o=2<Ak(e)?e.g.statusText:""}catch{o=""}e.j=o+" ["+e.ba()+"]",Ok(e)}}finally{Tk(e)}}}function Tk(e,t){if(e.g){Ik(e);const n=e.g,r=e.C[0]?fS:null;e.g=null,e.C=null,t||bb(e,"ready");try{n.onreadystatechange=r}catch{}}}function Ik(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(dS.clearTimeout(e.A),e.A=null)}function Ak(e){return e.g?e.g.readyState:0}function Mk(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case Ek:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function Nk(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){let t="";return LS(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):VO(e,t,n))}function Rk(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function xk(e){this.za=0,this.l=[],this.h=new qb,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Rk("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Rk("baseRetryDelayMs",5e3,e),this.$a=Rk("retryDelaySeedMs",1e4,e),this.Ya=Rk("forwardChannelMaxRetries",2,e),this.ra=Rk("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new tk(e&&e.concurrentRequestLimit),this.Ca=new uk,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function Dk(e){if(Fk(e),3==e.G){var t=e.V++,n=xO(e.F);VO(n,"SID",e.J),VO(n,"RID",t),VO(n,"TYPE","terminate"),$k(e,n),(t=new dO(e,e.h,t,void 0)).K=2,t.v=BO(xO(n)),n=!1,dS.navigator&&dS.navigator.sendBeacon&&(n=dS.navigator.sendBeacon(t.v.toString(),"")),!n&&dS.Image&&((new Image).src=t.v,n=!0),n||(t.g=Jk(t.l,null),t.g.ea(t.v)),t.F=Date.now(),wO(t)}Qk(e)}function Lk(e){e.g&&(Zk(e),e.g.cancel(),e.g=null)}function Fk(e){Lk(e),e.u&&(dS.clearTimeout(e.u),e.u=null),Wk(e),e.i.cancel(),e.m&&("number"==typeof e.m&&dS.clearTimeout(e.m),e.m=null)}function Uk(e,t){e.l.push(new class{constructor(e,t){this.h=e,this.g=t}}(e.Za++,t)),3==e.G&&Vk(e)}function Vk(e){rk(e.i)||e.m||(e.m=!0,Rb(e.Ha,e),e.C=0)}function Bk(e,t){var n;n=t?t.m:e.V++;const r=xO(e.F);VO(r,"SID",e.J),VO(r,"RID",n),VO(r,"AID",e.U),$k(e,r),e.o&&e.s&&Nk(r,e.o,e.s),n=new dO(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=zk(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),ok(e.i,n),yO(n,r,t)}function $k(e,t){e.j&&TO({},function(e,n){VO(t,n,e)})}function zk(e,t,n){n=Math.min(e.l.length,n);var r=e.j?_S(e.j.Oa,e.j,e):null;e:{var i=e.l;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].h,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].h;const a=i[o].g;if(n-=t,0>n)t=Math.max(0,i[o].h-100),s=!1;else try{hk(a,e,"req"+n+"_")}catch{r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.l.splice(0,n),t.D=e,r}function Hk(e){e.g||e.u||(e.Y=1,Rb(e.Ga,e),e.A=0)}function Gk(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=nO(_S(e.Ga,e),Yk(e,e.A)),e.A++,0))}function Zk(e){null!=e.B&&(dS.clearTimeout(e.B),e.B=null)}function qk(e){e.g=new dO(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=xO(e.oa);VO(t,"RID","rpc"),VO(t,"SID",e.J),VO(t,"CI",e.N?"0":"1"),VO(t,"AID",e.U),$k(e,t),VO(t,"TYPE","xmlhttp"),e.o&&e.s&&Nk(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=BO(xO(t)),n.s=null,n.U=!0,vO(n,e)}function Wk(e){null!=e.v&&(dS.clearTimeout(e.v),e.v=null)}function jk(e,t){var n=null;if(e.g==t){Wk(e),Zk(e),e.g=null;var r=2}else{if(!sk(e.i,t))return;n=t.D,ak(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;bb(r=Kb(),new tO(r,n,t,i)),Vk(e)}else Hk(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(ik(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=nO(_S(e.Ha,e,t),Yk(e,e.C)),e.C++,0)))}(e,t)||2==r&&Gk(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Kk(e,5);break;case 4:Kk(e,10);break;case 3:Kk(e,6);break;default:Kk(e,2)}}function Yk(e,t){let n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function Kk(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=_S(e.jb,e);n||(n=new RO("//www.google.com/images/cleardot.gif"),dS.location&&"http"==dS.location.protocol||DO(n,"https"),BO(n)),function(e,t){const n=new qb;if(dS.Image){const r=new Image;r.onload=ES(dk,n,r,"TestLoadImage: loaded",!0,t),r.onerror=ES(dk,n,r,"TestLoadImage: error",!1,t),r.onabort=ES(dk,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=ES(dk,n,r,"TestLoadImage: timeout",!1,t),dS.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else eO(2);e.G=0,e.j&&e.j.va(t),Qk(e),Fk(e)}function Qk(e){e.G=0,e.I=-1,e.j&&((0!=lk(e.i).length||0!=e.l.length)&&(e.i.i.length=0,TS(e.l),e.l.length=0),e.j.ua())}function Xk(e,t,n){let r=function(e){return e instanceof RO?xO(e):new RO(e,void 0)}(n);if(""!=r.i)t&&LO(r,t+"."+r.i),FO(r,r.m);else{const e=dS.location;r=function(e,t,n,r){var i=new RO(null,void 0);return e&&DO(i,e),t&&LO(i,t),n&&FO(i,n),r&&(i.l=r),i}(e.protocol,t?t+"."+e.hostname:e.hostname,+e.port,n)}return e.aa&&LS(e.aa,function(e,t){VO(r,t,e)}),n=e.sa,(t=e.D)&&n&&VO(r,t,n),VO(r,"VER",e.ma),$k(e,r),r}function Jk(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new _k(n&&e.Ba&&!e.qa?new fk({ib:!0}):e.qa)).L=e.H,t}function eT(){}function tT(){if(HS&&!(10<=Number(eb)))throw Error("Environmental error: no available transport.")}function nT(e,t){Sb.call(this),this.g=new xk(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!IS(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!IS(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new sT(this)}function rT(e){cO.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function iT(){uO.call(this),this.status=1}function sT(e){this.g=e}(lS=_k.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():aO.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:aO),this.g.onreadystatechange=_S(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(s){return void bk(this,s)}e=n||"";const i=new IO(this.headers);r&&TO(r,function(e,t){i.set(t,e)}),r=function(e){e:{var t=Sk;const n=e.length,r="string"==typeof e?e.split(""):e;for(let i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=dS.FormData&&e instanceof dS.FormData,!(0<=bS(Pk,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Ik(this),0<this.B&&((this.K=function(e){return HS&&JS()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_S(this.pa,this)):this.A=Vb(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){bk(this,s)}},lS.pa=function(){void 0!==hS&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,bb(this,"timeout"),this.abort(8))},lS.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,bb(this,"complete"),bb(this,"abort"),Tk(this))},lS.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Tk(this,!0)),_k.Z.M.call(this)},lS.Fa=function(){this.s||(this.F||this.v||this.l?kk(this):this.cb())},lS.cb=function(){kk(this)},lS.ba=function(){try{return 2<Ak(this)?this.g.status:-1}catch{return-1}},lS.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}},lS.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Ck(t)}},lS.Da=function(){return this.m},lS.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(lS=xk.prototype).ma=8,lS.G=1,lS.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch{}},lS.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new dO(this,this.h,e,void 0);let s=this.s;if(this.P&&(s?(s=FS(s),VS(s,this.P)):s=this.P),null===this.o&&(i.H=s),this.ja)e:{for(var t=0,n=0;n<this.l.length;n++){var r=this.l[n];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.l.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=zk(this,i,t),VO(n=xO(this.F),"RID",e),VO(n,"CVER",22),this.D&&VO(n,"X-HTTP-Session-Id",this.D),$k(this,n),this.o&&s&&Nk(n,this.o,s),ok(this.i,i),this.Ra&&VO(n,"TYPE","init"),this.ja?(VO(n,"$req",t),VO(n,"SID","null"),i.$=!0,yO(i,n,null)):yO(i,n,t),this.G=2}}else 3==this.G&&(e?Bk(this,e):0==this.l.length||rk(this.i)||Bk(this))},lS.Ga=function(){if(this.u=null,qk(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=nO(_S(this.bb,this),e)}},lS.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,eO(10),Lk(this),qk(this))},lS.ab=function(){null!=this.v&&(this.v=null,Lk(this),Gk(this),eO(19))},lS.jb=function(e){e?(this.h.info("Successfully pinged google.com"),eO(2)):(this.h.info("Failed to ping google.com"),eO(1))},(lS=eT.prototype).xa=function(){},lS.wa=function(){},lS.va=function(){},lS.ua=function(){},lS.Oa=function(){},tT.prototype.g=function(e,t){return new nT(e,t)},wS(nT,Sb),nT.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Rb(_S(e.hb,e,t))),eO(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=Xk(e,null,e.W),Vk(e)},nT.prototype.close=function(){Dk(this.g)},nT.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,Uk(this.g,t)}else this.v?((t={}).__data__=kb(e),Uk(this.g,t)):Uk(this.g,e)},nT.prototype.M=function(){this.g.j=null,delete this.j,Dk(this.g),delete this.g,nT.Z.M.call(this)},wS(rT,cO),wS(iT,uO),wS(sT,eT),sT.prototype.xa=function(){bb(this.g,"a")},sT.prototype.wa=function(e){bb(this.g,new rT(e))},sT.prototype.va=function(e){bb(this.g,new iT(e))},sT.prototype.ua=function(){bb(this.g,"b")},tT.prototype.createWebChannel=tT.prototype.g,nT.prototype.send=nT.prototype.u,nT.prototype.open=nT.prototype.m,nT.prototype.close=nT.prototype.close,rO.NO_ERROR=0,rO.TIMEOUT=8,rO.HTTP_ERROR=6,iO.COMPLETE="complete",oO.EventType=lO,lO.OPEN="a",lO.CLOSE="b",lO.ERROR="c",lO.MESSAGE="d",Sb.prototype.listen=Sb.prototype.N,_k.prototype.listenOnce=_k.prototype.O,_k.prototype.getLastError=_k.prototype.La,_k.prototype.getLastErrorCode=_k.prototype.Da,_k.prototype.getStatus=_k.prototype.ba,_k.prototype.getResponseJson=_k.prototype.Qa,_k.prototype.getResponseText=_k.prototype.ga,_k.prototype.send=_k.prototype.ea;var oT=uS.createWebChannelTransport=function(){return new tT},aT=uS.getStatEventTarget=function(){return Kb()},lT=uS.ErrorCode=rO,cT=uS.EventType=iO,uT=uS.Event=jb,hT=uS.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},dT=uS.FetchXmlHttpFactory=fk,fT=uS.WebChannel=oO,pT=uS.XhrIo=_k;const gT="@firebase/firestore";class mT{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}mT.UNAUTHENTICATED=new mT(null),mT.GOOGLE_CREDENTIALS=new mT("google-credentials-uid"),mT.FIRST_PARTY=new mT("first-party-uid"),mT.MOCK_USER=new mT("mock-user");let yT="9.9.0";const vT=new gP("@firebase/firestore");function CT(){return vT.logLevel}function _T(e,...t){if(vT.logLevel<=uP.DEBUG){const n=t.map(PT);vT.debug(`Firestore (${yT}): ${e}`,...n)}}function ET(e,...t){if(vT.logLevel<=uP.ERROR){const n=t.map(PT);vT.error(`Firestore (${yT}): ${e}`,...n)}}function wT(e,...t){if(vT.logLevel<=uP.WARN){const n=t.map(PT);vT.warn(`Firestore (${yT}): ${e}`,...n)}}function PT(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch{return e}}function ST(e="Unexpected state"){const t=`FIRESTORE (${yT}) INTERNAL ASSERTION FAILED: `+e;throw ET(t),new Error(t)}function bT(e,t){e||ST()}function OT(e,t){return e}const kT={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class TT extends Ww{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class IT{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class AT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class MT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(mT.UNAUTHENTICATED))}shutdown(){}}class NT{constructor(e){this.t=e,this.currentUser=mT.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let r=this.i;const i=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve();let s=new IT;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new IT,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const t=s;e.enqueueRetryable(Sw(function*(){yield t.promise,yield i(n.currentUser)}))},a=e=>{_T("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(_T("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new IT)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(_T("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(bT("string"==typeof t.accessToken),new AT(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return bT(null===e||"string"==typeof e),new mT(e)}}class RT{constructor(e,t,n){this.type="FirstParty",this.user=mT.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class xT{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new RT(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(mT.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class DT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class LT{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const n=e=>{null!=e.error&&_T("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.p;return this.p=e.token,_T("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{_T("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.g.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.g.getImmediate({optional:!0});e?r(e):_T("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(bT("string"==typeof e.token),this.p=e.token,new DT(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function FT(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class UT{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=FT(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length))}return n}}function VT(e,t){return e<t?-1:e>t?1:0}function BT(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}class $T{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new TT(kT.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new TT(kT.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new TT(kT.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new TT(kT.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return $T.fromMillis(Date.now())}static fromDate(e){return $T.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new $T(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?VT(this.nanoseconds,e.nanoseconds):VT(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class zT{constructor(e){this.timestamp=e}static fromTimestamp(e){return new zT(e)}static min(){return new zT(new $T(0,0))}static max(){return new zT(new $T(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class HT{constructor(e,t,n){void 0===t?t=0:t>e.length&&ST(),void 0===n?n=e.length-t:n>e.length-t&&ST(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===HT.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof HT?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class GT extends HT{construct(e,t,n){return new GT(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new TT(kT.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new GT(t)}static emptyPath(){return new GT([])}}const ZT=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qT extends HT{construct(e,t,n){return new qT(e,t,n)}static isValidIdentifier(e){return ZT.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qT.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new qT(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new TT(kT.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new TT(kT.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new TT(kT.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new TT(kT.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qT(t)}static emptyPath(){return new qT([])}}class WT{constructor(e){this.path=e}static fromPath(e){return new WT(GT.fromString(e))}static fromName(e){return new WT(GT.fromString(e).popFirst(5))}static empty(){return new WT(GT.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===GT.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return GT.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new WT(new GT(e.slice()))}}function jT(e){return new YT(e.readTime,e.key,-1)}class YT{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new YT(zT.min(),WT.empty(),-1)}static max(){return new YT(zT.max(),WT.empty(),-1)}}function KT(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=WT.comparator(e.documentKey,t.documentKey),0!==n?n:VT(e.largestBatchId,t.largestBatchId))}const QT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function XT(e){return JT.apply(this,arguments)}function JT(){return JT=Sw(function*(e){if(e.code!==kT.FAILED_PRECONDITION||e.message!==QT)throw e;_T("LocalStore","Unexpectedly lost primary lease")}),JT.apply(this,arguments)}class eI{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ST(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new eI((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof eI?t:eI.resolve(t)}catch(t){return eI.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):eI.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):eI.reject(t)}static resolve(e){return new eI((t,n)=>{t(e)})}static reject(e){return new eI((t,n)=>{n(e)})}static waitFor(e){return new eI((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=eI.resolve(!1);for(const n of e)t=t.next(e=>e?eI.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new eI((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new eI((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function tI(e){return"IndexedDbTransactionError"===e.name}class nI{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.it(e),this.rt=e=>t.writeSequenceNumber(e))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}function rI(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function iI(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function sI(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}nI.ot=-1;class oI{constructor(e,t){this.comparator=e,this.root=t||lI.EMPTY}insert(e,t){return new oI(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,lI.BLACK,null,null))}remove(e){return new oI(this.comparator,this.root.remove(e,this.comparator).copy(null,null,lI.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new aI(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new aI(this.root,e,this.comparator,!1)}getReverseIterator(){return new aI(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new aI(this.root,e,this.comparator,!0)}}class aI{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class lI{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=n??lI.RED,this.left=r??lI.EMPTY,this.right=i??lI.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new lI(e??this.key,t??this.value,n??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return lI.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return lI.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,lI.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,lI.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ST();const e=this.left.check();if(e!==this.right.check())throw ST();return e+(this.isRed()?0:1)}}lI.EMPTY=null,lI.RED=!0,lI.BLACK=!1,lI.EMPTY=new class{constructor(){this.size=0}get key(){throw ST()}get value(){throw ST()}get color(){throw ST()}get left(){throw ST()}get right(){throw ST()}copy(e,t,n,r,i){return this}insert(e,t,n){return new lI(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class cI{constructor(e){this.comparator=e,this.data=new oI(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new uI(this.data.getIterator())}getIteratorFrom(e){return new uI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof cI)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new cI(this.comparator);return t.data=e,t}}class uI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class hI{constructor(e){this.fields=e,e.sort(qT.comparator)}static empty(){return new hI([])}unionWith(e){let t=new cI(qT.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new hI(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return BT(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class dI{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new dI(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new dI(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return VT(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}dI.EMPTY_BYTE_STRING=new dI("");const fI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pI(e){if(bT(!!e),"string"==typeof e){let t=0;const n=fI.exec(e);if(bT(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:gI(e.seconds),nanos:gI(e.nanos)}}function gI(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function mI(e){return"string"==typeof e?dI.fromBase64String(e):dI.fromUint8Array(e)}function yI(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function vI(e){const t=e.mapValue.fields.__previous_value__;return yI(t)?vI(t):t}function CI(e){const t=pI(e.mapValue.fields.__local_write_time__.timestampValue);return new $T(t.seconds,t.nanos)}class _I{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class EI{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new EI("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof EI&&e.projectId===this.projectId&&e.database===this.database}}function wI(e){return null==e}function PI(e){return 0===e&&1/e==-1/0}const SI={fields:{__type__:{stringValue:"__max__"}}};function bI(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?yI(e)?4:VI(e)?9007199254740991:10:ST()}function OI(e,t){if(e===t)return!0;const n=bI(e);if(n!==bI(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return CI(e).isEqual(CI(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=pI(e.timestampValue),r=pI(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return r=t,mI(e.bytesValue).isEqual(mI(r.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return gI(e.geoPointValue.latitude)===gI(t.geoPointValue.latitude)&&gI(e.geoPointValue.longitude)===gI(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return gI(e.integerValue)===gI(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=gI(e.doubleValue),r=gI(t.doubleValue);return n===r?PI(n)===PI(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return BT(e.arrayValue.values||[],t.arrayValue.values||[],OI);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(rI(n)!==rI(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!OI(n[i],r[i])))return!1;return!0}(e,t);default:return ST()}var r}function kI(e,t){return void 0!==(e.values||[]).find(e=>OI(e,t))}function TI(e,t){if(e===t)return 0;const n=bI(e),r=bI(t);if(n!==r)return VT(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return VT(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=gI(e.integerValue||e.doubleValue),r=gI(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return II(e.timestampValue,t.timestampValue);case 4:return II(CI(e),CI(t));case 5:return VT(e.stringValue,t.stringValue);case 6:return function(e,t){const n=mI(e),r=mI(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=VT(n[i],r[i]);if(0!==e)return e}return VT(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=VT(gI(e.latitude),gI(t.latitude));return 0!==n?n:VT(gI(e.longitude),gI(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=TI(n[i],r[i]);if(e)return e}return VT(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===SI&&t===SI)return 0;if(e===SI)return 1;if(t===SI)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=VT(r[o],s[o]);if(0!==e)return e;const t=TI(n[r[o]],i[s[o]]);if(0!==t)return t}return VT(r.length,s.length)}(e.mapValue,t.mapValue);default:throw ST()}}function II(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return VT(e,t);const n=pI(e),r=pI(t),i=VT(n.seconds,r.seconds);return 0!==i?i:VT(n.nanos,r.nanos)}function AI(e){return MI(e)}function MI(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=pI(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?mI(e.bytesValue).toBase64():"referenceValue"in e?WT.fromName(e.referenceValue).toString():"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=MI(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${MI(e.fields[i])}`;return n+"}"}(e.mapValue):ST();var t}function NI(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function RI(e){return!!e&&"integerValue"in e}function xI(e){return!!e&&"arrayValue"in e}function DI(e){return!!e&&"nullValue"in e}function LI(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function FI(e){return!!e&&"mapValue"in e}function UI(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return iI(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=UI(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=UI(e.arrayValue.values[n]);return t}return Object.assign({},e)}function VI(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class BI{constructor(e){this.value=e}static empty(){return new BI({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!FI(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=UI(t)}setAll(e){let t=qT.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=UI(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());FI(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return OI(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];FI(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){iI(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new BI(UI(this.value))}}function $I(e){const t=[];return iI(e.fields,(e,n)=>{const r=new qT([e]);if(FI(n)){const e=$I(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new hI(t)}class zI{constructor(e,t,n,r,i,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.data=i,this.documentState=s}static newInvalidDocument(e){return new zI(e,0,zT.min(),zT.min(),BI.empty(),0)}static newFoundDocument(e,t,n){return new zI(e,1,t,zT.min(),n,0)}static newNoDocument(e,t){return new zI(e,2,t,zT.min(),BI.empty(),0)}static newUnknownDocument(e,t){return new zI(e,3,t,zT.min(),BI.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=BI.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=BI.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=zT.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof zI&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new zI(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class HI{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ut=null}}function GI(e,t=null,n=[],r=[],i=null,s=null,o=null){return new HI(e,t,n,r,i,s,o)}function ZI(e){const t=OT(e);if(null===t.ut){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>{return(t=e).field.canonicalString()+t.op.toString()+AI(t.value);var t}).join(","),e+="|ob:",e+=t.orderBy.map(e=>{return(t=e).field.canonicalString()+t.dir;var t}).join(","),wI(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>AI(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>AI(e)).join(",")),t.ut=e}return t.ut}function qI(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++)if(!sA(e.orderBy[i],t.orderBy[i]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if((n=e.filters[i]).op!==(r=t.filters[i]).op||!n.field.isEqual(r.field)||!OI(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!aA(e.startAt,t.startAt)&&aA(e.endAt,t.endAt)}function WI(e){return WT.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class jI extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,n):new YI(e,t,n):"array-contains"===t?new JI(e,n):"in"===t?new eA(e,n):"not-in"===t?new tA(e,n):"array-contains-any"===t?new nA(e,n):new jI(e,t,n)}static ct(e,t,n){return"in"===t?new KI(e,n):new QI(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(TI(t,this.value)):null!==t&&bI(this.value)===bI(t)&&this.at(TI(t,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ST()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class YI extends jI{constructor(e,t,n){super(e,t,n),this.key=WT.fromName(n.referenceValue)}matches(e){const t=WT.comparator(e.key,this.key);return this.at(t)}}class KI extends jI{constructor(e,t){super(e,"in",t),this.keys=XI(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class QI extends jI{constructor(e,t){super(e,"not-in",t),this.keys=XI(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function XI(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>WT.fromName(e.referenceValue))}class JI extends jI{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return xI(t)&&kI(t.arrayValue,this.value)}}class eA extends jI{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&kI(this.value.arrayValue,t)}}class tA extends jI{constructor(e,t){super(e,"not-in",t)}matches(e){if(kI(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!kI(this.value.arrayValue,t)}}class nA extends jI{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!xI(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>kI(this.value.arrayValue,e))}}class rA{constructor(e,t){this.position=e,this.inclusive=t}}class iA{constructor(e,t="asc"){this.field=e,this.dir=t}}function sA(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function oA(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?WT.comparator(WT.fromName(o.referenceValue),n.key):TI(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function aA(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!OI(e.position[n],t.position[n]))return!1;return!0}class lA{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.lt=null,this.ft=null}}function cA(e){return new lA(e)}function uA(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function hA(e){for(const t of e.filters)if(t.ht())return t.field;return null}function dA(e){return null!==e.collectionGroup}function fA(e){const t=OT(e);if(null===t.lt){t.lt=[];const e=hA(t),n=uA(t);if(null!==e&&null===n)e.isKeyField()||t.lt.push(new iA(e)),t.lt.push(new iA(qT.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.lt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new iA(qT.keyField(),e))}}}return t.lt}function pA(e){const t=OT(e);if(!t.ft)if("F"===t.limitType)t.ft=GI(t.path,t.collectionGroup,fA(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of fA(t))e.push(new iA(i.field,"desc"===i.dir?"asc":"desc"));const n=t.endAt?new rA(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new rA(t.startAt.position,t.startAt.inclusive):null;t.ft=GI(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.ft}function gA(e,t,n){return new lA(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function mA(e,t){return qI(pA(e),pA(t))&&e.limitType===t.limitType}function yA(e){return`${ZI(pA(e))}|lt:${e.limitType}`}function vA(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>{return`${(t=e).field.canonicalString()} ${t.op} ${AI(t.value)}`;var t}).join(", ")}]`),wI(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>AI(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>AI(e)).join(",")),`Target(${t})`}(pA(e))}; limitType=${e.limitType})`}function CA(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):WT.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){const r=oA(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,fA(n),r)||n.endAt&&!function(e,t,n){const r=oA(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,fA(n),r)));var n,r}function _A(e){return(t,n)=>{let r=!1;for(const i of fA(e)){const e=EA(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function EA(e,t,n){const r=e.field.isKeyField()?WT.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?TI(r,i):ST()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return ST()}}function wA(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:PI(t)?"-0":t}}function PA(e){return{integerValue:""+e}}function SA(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!PI(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?PA(t):wA(e,t)}class bA{constructor(){this._=void 0}}function OA(e,t,n){return e instanceof IA?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof AA?MA(e,t):e instanceof NA?RA(e,t):function(e,t){const n=TA(e,t),r=DA(n)+DA(e._t);return RI(n)&&RI(e._t)?PA(r):wA(e.wt,r)}(e,t)}function kA(e,t,n){return e instanceof AA?MA(e,t):e instanceof NA?RA(e,t):n}function TA(e,t){return e instanceof xA?RI(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}class IA extends bA{}class AA extends bA{constructor(e){super(),this.elements=e}}function MA(e,t){const n=LA(t);for(const r of e.elements)n.some(e=>OI(e,r))||n.push(r);return{arrayValue:{values:n}}}class NA extends bA{constructor(e){super(),this.elements=e}}function RA(e,t){let n=LA(t);for(const r of e.elements)n=n.filter(e=>!OI(e,r));return{arrayValue:{values:n}}}class xA extends bA{constructor(e,t){super(),this.wt=e,this._t=t}}function DA(e){return gI(e.integerValue||e.doubleValue)}function LA(e){return xI(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class FA{constructor(e,t){this.field=e,this.transform=t}}class UA{constructor(e,t){this.version=e,this.transformResults=t}}class VA{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new VA}static exists(e){return new VA(void 0,e)}static updateTime(e){return new VA(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function BA(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class $A{}function zA(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new XA(e.key,VA.none()):new WA(e.key,e.data,VA.none());{const n=e.data,r=BI.empty();let i=new cI(qT.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new jA(e.key,r,new hI(i.toArray()),VA.none())}}function HA(e,t,n){e instanceof WA?function(e,t,n){const r=e.value.clone(),i=KA(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof jA?function(e,t,n){if(!BA(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=KA(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(YA(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function GA(e,t,n,r){return e instanceof WA?function(e,t,n,r){if(!BA(e.precondition,t))return n;const i=e.value.clone(),s=QA(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof jA?function(e,t,n,r){if(!BA(e.precondition,t))return n;const i=QA(e.fieldTransforms,r,t),s=t.data;return s.setAll(YA(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):(s=n,BA(e.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):s);var i,s}function ZA(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=TA(r.transform,e||null);null!=i&&(null===n&&(n=BI.empty()),n.set(r.field,i))}return n||null}function qA(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&BT(n,r,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof AA&&r instanceof AA||n instanceof NA&&r instanceof NA?BT(n.elements,r.elements,OI):n instanceof xA&&r instanceof xA?OI(n._t,r._t):n instanceof IA&&r instanceof IA);var n,r}(e,t))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}class WA extends $A{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class jA extends $A{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function YA(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function KA(e,t,n){const r=new Map;bT(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,kA(o,a,n[i]))}return r}function QA(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,OA(e,s,t))}return r}class XA extends $A{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class JA extends $A{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class eM{constructor(e){this.count=e}}var tM,nM;function rM(e){switch(e){default:return ST();case kT.CANCELLED:case kT.UNKNOWN:case kT.DEADLINE_EXCEEDED:case kT.RESOURCE_EXHAUSTED:case kT.INTERNAL:case kT.UNAVAILABLE:case kT.UNAUTHENTICATED:return!1;case kT.INVALID_ARGUMENT:case kT.NOT_FOUND:case kT.ALREADY_EXISTS:case kT.PERMISSION_DENIED:case kT.FAILED_PRECONDITION:case kT.ABORTED:case kT.OUT_OF_RANGE:case kT.UNIMPLEMENTED:case kT.DATA_LOSS:return!0}}function iM(e){if(void 0===e)return ET("GRPC error has no .code"),kT.UNKNOWN;switch(e){case tM.OK:return kT.OK;case tM.CANCELLED:return kT.CANCELLED;case tM.UNKNOWN:return kT.UNKNOWN;case tM.DEADLINE_EXCEEDED:return kT.DEADLINE_EXCEEDED;case tM.RESOURCE_EXHAUSTED:return kT.RESOURCE_EXHAUSTED;case tM.INTERNAL:return kT.INTERNAL;case tM.UNAVAILABLE:return kT.UNAVAILABLE;case tM.UNAUTHENTICATED:return kT.UNAUTHENTICATED;case tM.INVALID_ARGUMENT:return kT.INVALID_ARGUMENT;case tM.NOT_FOUND:return kT.NOT_FOUND;case tM.ALREADY_EXISTS:return kT.ALREADY_EXISTS;case tM.PERMISSION_DENIED:return kT.PERMISSION_DENIED;case tM.FAILED_PRECONDITION:return kT.FAILED_PRECONDITION;case tM.ABORTED:return kT.ABORTED;case tM.OUT_OF_RANGE:return kT.OUT_OF_RANGE;case tM.UNIMPLEMENTED:return kT.UNIMPLEMENTED;case tM.DATA_LOSS:return kT.DATA_LOSS;default:return ST()}}(nM=tM||(tM={}))[nM.OK=0]="OK",nM[nM.CANCELLED=1]="CANCELLED",nM[nM.UNKNOWN=2]="UNKNOWN",nM[nM.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nM[nM.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nM[nM.NOT_FOUND=5]="NOT_FOUND",nM[nM.ALREADY_EXISTS=6]="ALREADY_EXISTS",nM[nM.PERMISSION_DENIED=7]="PERMISSION_DENIED",nM[nM.UNAUTHENTICATED=16]="UNAUTHENTICATED",nM[nM.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nM[nM.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nM[nM.ABORTED=10]="ABORTED",nM[nM.OUT_OF_RANGE=11]="OUT_OF_RANGE",nM[nM.UNIMPLEMENTED=12]="UNIMPLEMENTED",nM[nM.INTERNAL=13]="INTERNAL",nM[nM.UNAVAILABLE=14]="UNAVAILABLE",nM[nM.DATA_LOSS=15]="DATA_LOSS";class sM{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){iI(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return sI(this.inner)}size(){return this.innerSize}}const oM=new oI(WT.comparator);function aM(){return oM}const lM=new oI(WT.comparator);function cM(...e){let t=lM;for(const n of e)t=t.insert(n.key,n);return t}function uM(e){let t=lM;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function hM(){return fM()}function dM(){return fM()}function fM(){return new sM(e=>e.toString(),(e,t)=>e.isEqual(t))}const pM=new oI(WT.comparator),gM=new cI(WT.comparator);function mM(...e){let t=gM;for(const n of e)t=t.add(n);return t}const yM=new cI(VT);function vM(){return yM}class CM{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,_M.createSynthesizedTargetChangeForCurrentChange(e,t)),new CM(zT.min(),n,vM(),aM(),mM())}}class _M{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t){return new _M(dI.EMPTY_BYTE_STRING,t,mM(),mM(),mM())}}class EM{constructor(e,t,n,r){this.gt=e,this.removedTargetIds=t,this.key=n,this.yt=r}}class wM{constructor(e,t){this.targetId=e,this.It=t}}class PM{constructor(e,t,n=dI.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class SM{constructor(){this.Tt=0,this.Et=kM(),this.At=dI.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=mM(),t=mM(),n=mM();return this.Et.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:ST()}}),new _M(this.At,this.Rt,e,t,n)}Dt(){this.bt=!1,this.Et=kM()}Ct(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class bM{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=aM(),this.Bt=OM(),this.Lt=new cI(VT)}Ut(e){for(const t of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(t,e.yt):this.Kt(t,e.key,e.yt);for(const t of e.removedTargetIds)this.Kt(t,e.key,e.yt)}Gt(e){this.forEachTarget(e,t=>{const n=this.Qt(t);switch(e.state){case 0:this.jt(t)&&n.Vt(e.resumeToken);break;case 1:n.kt(),n.Pt||n.Dt(),n.Vt(e.resumeToken);break;case 2:n.kt(),n.Pt||this.removeTarget(t);break;case 3:this.jt(t)&&(n.Ot(),n.Vt(e.resumeToken));break;case 4:this.jt(t)&&(this.Wt(t),n.Vt(e.resumeToken));break;default:ST()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach((e,n)=>{this.jt(n)&&t(n)})}zt(e){const t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){const e=r.target;if(WI(e))if(0===n){const n=new WT(e.path);this.Kt(t,n,zI.newNoDocument(n,zT.min()))}else bT(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}Yt(e){const t=new Map;this.Ft.forEach((n,r)=>{const i=this.Ht(r);if(i){if(n.current&&WI(i.target)){const t=new WT(i.target.path);null!==this.$t.get(t)||this.Xt(r,t)||this.Kt(r,t,zI.newNoDocument(t,e))}n.vt&&(t.set(r,n.St()),n.Dt())}});let n=mM();this.Bt.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.Ht(e);return!t||2===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.$t.forEach((t,n)=>n.setReadTime(e));const r=new CM(e,t,this.Lt,this.$t,n);return this.$t=aM(),this.Bt=OM(),this.Lt=new cI(VT),r}qt(e,t){if(!this.jt(e))return;const n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}Kt(e,t,n){if(!this.jt(e))return;const r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}removeTarget(e){this.Ft.delete(e)}Jt(e){const t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let t=this.Ft.get(e);return t||(t=new SM,this.Ft.set(e,t)),t}Zt(e){let t=this.Bt.get(e);return t||(t=new cI(VT),this.Bt=this.Bt.insert(e,t)),t}jt(e){const t=null!==this.Ht(e);return t||_T("WatchChangeAggregator","Detected inactive target",e),t}Ht(e){const t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new SM),this.Mt.getRemoteKeysForTarget(e).forEach(t=>{this.Kt(e,t,null)})}Xt(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}function OM(){return new oI(WT.comparator)}function kM(){return new oI(WT.comparator)}const TM={asc:"ASCENDING",desc:"DESCENDING"},IM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class AM{constructor(e,t){this.databaseId=e,this.dt=t}}function MM(e,t){return e.dt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function NM(e,t){return e.dt?t.toBase64():t.toUint8Array()}function RM(e,t){return MM(e,t.toTimestamp())}function xM(e){return bT(!!e),zT.fromTimestamp(function(e){const t=pI(e);return new $T(t.seconds,t.nanos)}(e))}function DM(e,t){return(n=e,new GT(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function LM(e){const t=GT.fromString(e);return bT(eN(t)),t}function FM(e,t){return DM(e.databaseId,t.path)}function UM(e,t){const n=LM(t);if(n.get(1)!==e.databaseId.projectId)throw new TT(kT.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new TT(kT.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new WT($M(n))}function VM(e,t){return DM(e.databaseId,t)}function BM(e){return new GT(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function $M(e){return bT(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function zM(e,t,n){return{name:FM(e,t),fields:n.value.mapValue.fields}}function HM(e,t){return{documents:[VM(e,t.path)]}}function GM(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=VM(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=VM(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0===e.length)return;const t=e.map(e=>function(e){if("=="===e.op){if(LI(e.value))return{unaryFilter:{field:YM(e.field),op:"IS_NAN"}};if(DI(e.value))return{unaryFilter:{field:YM(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(LI(e.value))return{unaryFilter:{field:YM(e.field),op:"IS_NOT_NAN"}};if(DI(e.value))return{unaryFilter:{field:YM(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:YM(e.field),op:jM(e.op),value:e.value}}}(e));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map(e=>{return{field:YM((t=e).field),direction:WM(t.dir)};var t})}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=(a=t.limit,e.dt||wI(a)?a:{value:a});var a,l,c;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(l=t.startAt).inclusive,values:l.position}),t.endAt&&(n.structuredQuery.endAt={before:!(c=t.endAt).inclusive,values:c.position}),n}function ZM(e){let t=function(e){const t=LM(e);return 4===t.length?GT.emptyPath():$M(t)}(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){bT(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=qM(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>{return new iA(KM((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,wI(t)?null:t}(n.limit));let l=null;var c;n.startAt&&(l=new rA((c=n.startAt).values||[],!!c.before));let u=null;return n.endAt&&(u=function(e){return new rA(e.values||[],!e.before)}(n.endAt)),function(e,t,n,r,i,s,o,a){return new lA(e,t,n,r,i,s,o,a)}(t,i,o,s,a,"F",l,u)}function qM(e){return e?void 0!==e.unaryFilter?[XM(e)]:void 0!==e.fieldFilter?[QM(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(e=>qM(e)).reduce((e,t)=>e.concat(t)):ST():[]}function WM(e){return TM[e]}function jM(e){return IM[e]}function YM(e){return{fieldPath:e.canonicalString()}}function KM(e){return qT.fromServerFormat(e.fieldPath)}function QM(e){return jI.create(KM(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ST()}}(e.fieldFilter.op),e.fieldFilter.value)}function XM(e){switch(e.unaryFilter.op){case"IS_NAN":const t=KM(e.unaryFilter.field);return jI.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=KM(e.unaryFilter.field);return jI.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=KM(e.unaryFilter.field);return jI.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=KM(e.unaryFilter.field);return jI.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ST()}}function JM(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function eN(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class tN{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&HA(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=GA(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=GA(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=dM();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=zA(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(zT.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),mM())}isEqual(e){return this.batchId===e.batchId&&BT(this.mutations,e.mutations,(e,t)=>qA(e,t))&&BT(this.baseMutations,e.baseMutations,(e,t)=>qA(e,t))}}class nN{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){bT(e.mutations.length===n.length);let r=pM;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new nN(e,t,n,r)}}class rN{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class iN{constructor(e,t,n,r,i=zT.min(),s=zT.min(),o=dI.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new iN(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new iN(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new iN(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class sN{constructor(e){this.ne=e}}function oN(e){const t=ZM({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?gA(t,t.limit,"L"):t}class aN{constructor(){}re(e,t){this.oe(e,t),t.ue()}oe(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(gI(e.integerValue));else if("doubleValue"in e){const n=gI(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),PI(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ce(t,20),"string"==typeof n?t.he(n):(t.he(`${n.seconds||""}`),t.ae(n.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(mI(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ce(t,45),t.ae(n.latitude||0),t.ae(n.longitude||0)}else"mapValue"in e?VI(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):ST()}le(e,t){this.ce(t,25),this.ge(e,t)}ge(e,t){t.he(e)}we(e,t){const n=e.fields||{};this.ce(t,55);for(const r of Object.keys(n))this.le(r,t),this.oe(n[r],t)}me(e,t){const n=e.values||[];this.ce(t,50);for(const r of n)this.oe(r,t)}_e(e,t){this.ce(t,37),WT.fromName(e).path.forEach(e=>{this.ce(t,60),this.ge(e,t)})}ce(e,t){e.ae(t)}fe(e){e.ae(2)}}aN.ye=new aN;class lN{constructor(){this.ze=new cN}addToCollectionParentIndex(e,t){return this.ze.add(t),eI.resolve()}getCollectionParents(e,t){return eI.resolve(this.ze.getEntries(t))}addFieldIndex(e,t){return eI.resolve()}deleteFieldIndex(e,t){return eI.resolve()}getDocumentsMatchingTarget(e,t){return eI.resolve(null)}getIndexType(e,t){return eI.resolve(0)}getFieldIndexes(e,t){return eI.resolve([])}getNextCollectionGroupToUpdate(e){return eI.resolve(null)}getMinOffset(e,t){return eI.resolve(YT.min())}getMinOffsetFromCollectionGroup(e,t){return eI.resolve(YT.min())}updateCollectionGroup(e,t,n){return eI.resolve()}updateIndexEntries(e,t){return eI.resolve()}}class cN{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new cI(GT.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new cI(GT.comparator)).toArray()}}new Uint8Array(0);class uN{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new uN(e,uN.DEFAULT_COLLECTION_PERCENTILE,uN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}uN.DEFAULT_COLLECTION_PERCENTILE=10,uN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,uN.DEFAULT=new uN(41943040,uN.DEFAULT_COLLECTION_PERCENTILE,uN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),uN.DISABLED=new uN(-1,0,0);class hN{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new hN(0)}static Rn(){return new hN(-1)}}class dN{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class fN{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.getBaseDocument(e,t,n))).next(e=>(null!==n&&GA(n.mutation,e,hI.empty(),$T.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,mM()).next(()=>t))}getLocalViewOfDocuments(e,t,n=mM()){const r=hM();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=cM();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=hM();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,mM()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=aM();const s=fM(),o=fM();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof jA)?i=i.insert(t.key,t):void 0!==o&&(s.set(t.key,o.mutation.getFieldMask()),GA(o.mutation,t,o.mutation.getFieldMask(),$T.now()))}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new dN(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=fM();let r=new oI((e,t)=>e-t),i=mM();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||hI.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||mM()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=dM();l.forEach(e=>{if(!i.has(e)){const r=zA(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return eI.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n){return WT.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):dA(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):eI.resolve(hM());let o=-1,a=i;return s.next(t=>eI.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?eI.resolve():this.getBaseDocument(e,t,n).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,mM())).next(e=>({batchId:o,changes:uM(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new WT(t)).next(e=>{let t=cM();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let i=cM();return this.indexManager.getCollectionParents(e,r).next(s=>eI.forEach(s,s=>{const o=(a=t,l=s.child(r),new lA(l,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt));var a,l;return this.getDocumentsMatchingCollectionQuery(e,o,n).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(i=>(r=i,this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId))).next(e=>{e.forEach((e,t)=>{const n=t.getKey();null===r.get(n)&&(r=r.insert(n,zI.newInvalidDocument(n)))});let n=cM();return r.forEach((r,i)=>{const s=e.get(r);void 0!==s&&GA(s.mutation,i,hI.empty(),$T.now()),CA(t,i)&&(n=n.insert(r,i))}),n})}getBaseDocument(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):eI.resolve(zI.newInvalidDocument(t))}}class pN{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,t){return eI.resolve(this.Jn.get(t))}saveBundleMetadata(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:xM(n.createTime)}),eI.resolve()}getNamedQuery(e,t){return eI.resolve(this.Yn.get(t))}saveNamedQuery(e,t){return this.Yn.set(t.name,{name:(n=t).name,query:oN(n.bundledQuery),readTime:xM(n.readTime)}),eI.resolve();var n}}class gN{constructor(){this.overlays=new oI(WT.comparator),this.Xn=new Map}getOverlay(e,t){return eI.resolve(this.overlays.get(t))}getOverlays(e,t){const n=hM();return eI.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.ie(e,t,r)}),eI.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Xn.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.Xn.delete(n)),eI.resolve()}getOverlaysForCollection(e,t,n){const r=hM(),i=t.length+1,s=new WT(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return eI.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new oI((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=hM(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=hM(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return eI.resolve(o)}ie(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new rN(t,n));let i=this.Xn.get(t);void 0===i&&(i=mM(),this.Xn.set(t,i)),this.Xn.set(t,i.add(n.key))}}class mN{constructor(){this.Zn=new cI(yN.ts),this.es=new cI(yN.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const n=new yN(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.rs(new yN(e,t))}os(e,t){e.forEach(e=>this.removeReference(e,t))}us(e){const t=new WT(new GT([])),n=new yN(t,e),r=new yN(t,e+1),i=[];return this.es.forEachInRange([n,r],e=>{this.rs(e),i.push(e.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new WT(new GT([])),n=new yN(t,e),r=new yN(t,e+1);let i=mM();return this.es.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new yN(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class yN{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return WT.comparator(e.key,t.key)||VT(e.ls,t.ls)}static ns(e,t){return VT(e.ls,t.ls)||WT.comparator(e.key,t.key)}}class vN{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.fs=1,this.ds=new cI(yN.ts)}checkEmpty(e){return eI.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.fs;this.fs++;const s=new tN(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.ds=this.ds.add(new yN(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return eI.resolve(s)}lookupMutationBatch(e,t){return eI.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const n=this.ws(t+1),r=n<0?0:n;return eI.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return eI.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(e){return eI.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new yN(t,0),r=new yN(t,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([n,r],e=>{const t=this._s(e.ls);i.push(t)}),eI.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new cI(VT);return t.forEach(e=>{const t=new yN(e,0),r=new yN(e,Number.POSITIVE_INFINITY);this.ds.forEachInRange([t,r],e=>{n=n.add(e.ls)})}),eI.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;WT.isDocumentKey(i)||(i=i.child(""));const s=new yN(new WT(i),0);let o=new cI(VT);return this.ds.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)},s),eI.resolve(this.gs(o))}gs(e){const t=[];return e.forEach(e=>{const n=this._s(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){bT(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();let n=this.ds;return eI.forEach(t.mutations,r=>{const i=new yN(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.ds=n})}In(e){}containsKey(e,t){const n=new yN(t,0),r=this.ds.firstAfterOrEqual(n);return eI.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return eI.resolve()}ys(e,t){return this.ws(e)}ws(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}_s(e){const t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class CN{constructor(e){this.ps=e,this.docs=new oI(WT.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return eI.resolve(n?n.document.mutableCopy():zI.newInvalidDocument(t))}getEntries(e,t){let n=aM();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():zI.newInvalidDocument(e))}),eI.resolve(n)}getAllFromCollection(e,t,n){let r=aM();const i=new WT(t.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i}}=s.getNext();if(!t.isPrefixOf(e.path))break;e.path.length>t.length+1||KT(jT(i),n)<=0||(r=r.insert(i.key,i.mutableCopy()))}return eI.resolve(r)}getAllFromCollectionGroup(e,t,n,r){ST()}Is(e,t){return eI.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new _N(this)}getSize(e){return eI.resolve(this.size)}}class _N extends class{constructor(){this.changes=new sM(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,zI.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?eI.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}{constructor(e){super(),this.zn=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.zn.addEntry(e,r)):this.zn.removeEntry(n)}),eI.waitFor(t)}getFromCache(e,t){return this.zn.getEntry(e,t)}getAllFromCache(e,t){return this.zn.getEntries(e,t)}}class EN{constructor(e){this.persistence=e,this.Ts=new sM(e=>ZI(e),qI),this.lastRemoteSnapshotVersion=zT.min(),this.highestTargetId=0,this.Es=0,this.As=new mN,this.targetCount=0,this.Rs=hN.An()}forEachTarget(e,t){return this.Ts.forEach((e,n)=>t(n)),eI.resolve()}getLastRemoteSnapshotVersion(e){return eI.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return eI.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),eI.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),eI.resolve()}vn(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new hN(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,t){return this.vn(t),this.targetCount+=1,eI.resolve()}updateTargetData(e,t){return this.vn(t),eI.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,eI.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Ts.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Ts.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),eI.waitFor(i).next(()=>r)}getTargetCount(e){return eI.resolve(this.targetCount)}getTargetData(e,t){const n=this.Ts.get(t)||null;return eI.resolve(n)}addMatchingKeys(e,t,n){return this.As.ss(t,n),eI.resolve()}removeMatchingKeys(e,t,n){this.As.os(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),eI.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.As.us(t),eI.resolve()}getMatchingKeysForTargetId(e,t){const n=this.As.hs(t);return eI.resolve(n)}containsKey(e,t){return eI.resolve(this.As.containsKey(t))}}class wN{constructor(e,t){this.bs={},this.overlays={},this.Ps=new nI(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new EN(this),this.indexManager=new lN,this.remoteDocumentCache=new CN(e=>this.referenceDelegate.Ss(e)),this.wt=new sN(t),this.Ds=new pN(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new gN,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.bs[e.toKey()];return n||(n=new vN(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,t,n){_T("MemoryPersistence","Starting transaction:",e);const r=new PN(this.Ps.next());return this.referenceDelegate.Cs(),n(r).next(e=>this.referenceDelegate.xs(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ns(e,t){return eI.or(Object.values(this.bs).map(n=>()=>n.containsKey(e,t)))}}class PN extends class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}{constructor(e){super(),this.currentSequenceNumber=e}}class SN{constructor(e){this.persistence=e,this.ks=new mN,this.Os=null}static Ms(e){return new SN(e)}get Fs(){if(this.Os)return this.Os;throw ST()}addReference(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),eI.resolve()}removeReference(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),eI.resolve()}markPotentiallyOrphaned(e,t){return this.Fs.add(t.toString()),eI.resolve()}removeTarget(e,t){this.ks.us(t.targetId).forEach(e=>this.Fs.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Fs.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Cs(){this.Os=new Set}xs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return eI.forEach(this.Fs,n=>{const r=WT.fromPath(n);return this.$s(e,r).next(e=>{e||t.removeEntry(r,zT.min())})}).next(()=>(this.Os=null,t.apply(e)))}updateLimboDocument(e,t){return this.$s(e,t).next(e=>{e?this.Fs.delete(t.toString()):this.Fs.add(t.toString())})}Ss(e){return 0}$s(e,t){return eI.or([()=>eI.resolve(this.ks.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ns(e,t)])}}class bN{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Pi=n,this.vi=r}static Vi(e,t){let n=mM(),r=mM();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new bN(e,t.fromCache,n,r)}}class ON{constructor(){this.Si=!1}initialize(e,t){this.Di=e,this.indexManager=t,this.Si=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ci(e,t).next(i=>i||this.xi(e,t,r,n)).next(n=>n||this.Ni(e,t))}Ci(e,t){return eI.resolve(null)}xi(e,t,n,r){return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(zT.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next(i=>{const s=this.ki(t,i);return this.Oi(t,s,n,r)?this.Ni(e,t):(CT()<=uP.DEBUG&&_T("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),vA(t)),this.Mi(e,s,t,function(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=zT.fromTimestamp(1e9===r?new $T(n+1,0):new $T(n,r));return new YT(i,WT.empty(),t)}(r,-1)))})}ki(e,t){let n=new cI(_A(e));return t.forEach((t,r)=>{CA(e,r)&&(n=n.add(r))}),n}Oi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ni(e,t){return CT()<=uP.DEBUG&&_T("QueryEngine","Using full collection scan to execute query:",vA(t)),this.Di.getDocumentsMatchingQuery(e,t,YT.min())}Mi(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class kN{constructor(e,t,n,r){this.persistence=e,this.Fi=t,this.wt=r,this.$i=new oI(VT),this.Bi=new sM(e=>ZI(e),qI),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(n)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fN(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.$i))}}function TN(e,t){return IN.apply(this,arguments)}function IN(){return IN=Sw(function*(e,t){const n=OT(e);return yield n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.qi(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=mM();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Ki:e,removedBatchIds:i,addedBatchIds:s}))})})}),IN.apply(this,arguments)}function AN(e,t){const n=OT(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=eI.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);bT(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=mM();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}function MN(e){const t=OT(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Vs.getLastRemoteSnapshotVersion(e))}function NN(e,t){const n=OT(e),r=t.snapshotVersion;let i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;const o=[];t.targetChanges.forEach((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Vs.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Vs.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);var u,h,d;t.targetMismatches.has(a)?c=c.withResumeToken(dI.EMPTY_BYTE_STRING,zT.min()).withLastLimboFreeSnapshotVersion(zT.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),h=c,d=s,(0===(u=l).resumeToken.approximateByteSize()||h.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()>=3e8||d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size>0)&&o.push(n.Vs.updateTargetData(e,c))});let a=aM(),l=mM();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){let r=mM(),i=mM();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=aM();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(zT.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):_T("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{Gi:r,Qi:i}})}(e,s,t.documentUpdates).next(e=>{a=e.Gi,l=e.Qi})),!r.isEqual(zT.min())){const t=n.Vs.getLastRemoteSnapshotVersion(e).next(t=>n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return eI.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.$i=i,e))}function RN(e,t){const n=OT(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function xN(e,t){const n=OT(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Vs.getTargetData(e,t).next(i=>i?(r=i,eI.resolve(r)):n.Vs.allocateTargetId(e).next(i=>(r=new iN(t,i,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e})}function DN(e,t,n){return LN.apply(this,arguments)}function LN(){return LN=Sw(function*(e,t,n){const r=OT(e),i=r.$i.get(t),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(o){if(!tI(o))throw o;_T("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.$i=r.$i.remove(t),r.Bi.delete(i.target)}),LN.apply(this,arguments)}function FN(e,t,n){const r=OT(e);let i=zT.min(),s=mM();return r.persistence.runTransaction("Execute query","readonly",e=>function(e,t,n){const r=OT(e),i=r.Bi.get(n);return void 0!==i?eI.resolve(r.$i.get(i)):r.Vs.getTargetData(t,n)}(r,e,pA(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Fi.getDocumentsMatchingQuery(e,t,n?i:zT.min(),n?s:mM())).next(e=>(function(e,t,n){let r=zT.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Li.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ji:s})))}class UN{constructor(){this.activeTargetIds=vM()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class VN{constructor(){this.Fr=new UN,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,n){this.$r[e]=t}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new UN,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class BN{Br(e){}shutdown(){}}class $N{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){_T("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){_T("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const zN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class HN{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}class GN extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.so=(e.ssl?"https":"http")+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,t,n,r,i){const s=this.oo(e,t);_T("RestConnection","Sending: ",s,n);const o={};return this.uo(o,r,i),this.co(e,s,o,n).then(e=>(_T("RestConnection","Received: ",e),e),t=>{throw wT("RestConnection",`${e} failed with error: `,t,"url: ",s,"request:",n),t})}ao(e,t,n,r,i,s){return this.ro(e,t,n,r,i)}uo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+yT,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}oo(e,t){return`${this.so}/v1/${t}:${zN[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,t,n,r){return new Promise((i,s)=>{const o=new pT;o.listenOnce(cT.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case lT.NO_ERROR:const t=o.getResponseJson();_T("Connection","XHR received:",JSON.stringify(t)),i(t);break;case lT.TIMEOUT:_T("Connection",'RPC "'+e+'" timed out'),s(new TT(kT.DEADLINE_EXCEEDED,"Request time out"));break;case lT.HTTP_ERROR:const n=o.getStatus();if(_T("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(kT).indexOf(t)>=0?t:kT.UNKNOWN}(e.status);s(new TT(t,e.message))}else s(new TT(kT.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new TT(kT.UNAVAILABLE,"Connection failed."));break;default:ST()}}finally{_T("Connection",'RPC "'+e+'" completed.')}});const a=JSON.stringify(r);o.send(t,"POST",a,n,15)})}ho(e,t,n){const r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=oT(),s=aT(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new dT({})),this.uo(o.initMessageHeaders,t,n),Bw()||zw()||Vw().indexOf("Electron/")>=0||Hw()||Vw().indexOf("MSAppHost/")>=0||$w()||(o.httpHeadersOverwriteParam="$httpHeaders");const a=r.join("");_T("Connection","Creating WebChannel: "+a,o);const l=i.createWebChannel(a,o);let c=!1,u=!1;const h=new HN({jr:e=>{u?_T("Connection","Not sending because WebChannel is closed:",e):(c||(_T("Connection","Opening WebChannel transport."),l.open(),c=!0),_T("Connection","WebChannel sending:",e),l.send(e))},Wr:()=>l.close()}),d=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(t){setTimeout(()=>{throw t},0)}})};return d(l,fT.EventType.OPEN,()=>{u||_T("Connection","WebChannel transport opened.")}),d(l,fT.EventType.CLOSE,()=>{u||(u=!0,_T("Connection","WebChannel transport closed"),h.eo())}),d(l,fT.EventType.ERROR,e=>{u||(u=!0,wT("Connection","WebChannel transport errored:",e),h.eo(new TT(kT.UNAVAILABLE,"The operation could not be completed")))}),d(l,fT.EventType.MESSAGE,e=>{var t;if(!u){const n=e.data[0];bT(!!n);const r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){_T("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=tM[e];if(void 0!==t)return iM(t)}(e),n=i.message;void 0===t&&(t=kT.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),u=!0,h.eo(new TT(t,n)),l.close()}else _T("Connection","WebChannel received:",n),h.no(n)}}),d(s,uT.STAT_EVENT,e=>{e.stat===hT.PROXY?_T("Connection","Detected buffering proxy"):e.stat===hT.NOPROXY&&_T("Connection","Detected no buffering proxy")}),setTimeout(()=>{h.Zr()},0),h}}function ZN(){return"undefined"!=typeof document?document:null}function qN(e){return new AM(e,!0)}class WN{constructor(e,t,n=1e3,r=1.5,i=6e4){this.js=e,this.timerId=t,this.lo=n,this.fo=r,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const t=Math.floor(this.wo+this.To()),n=Math.max(0,Date.now()-this.yo),r=Math.max(0,t-n);r>0&&_T("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.wo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,r,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class jN{constructor(e,t,n,r,i,s,o,a){this.js=e,this.Ao=n,this.Ro=r,this.bo=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new WN(e,t)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}stop(){var e=this;return Sw(function*(){e.Do()&&(yield e.close(0))})()}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}Oo(){var e=this;return Sw(function*(){if(e.Co())return e.close(0)})()}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}close(e,t){var n=this;return Sw(function*(){n.Fo(),n.$o(),n.So.cancel(),n.Po++,4!==e?n.So.reset():t&&t.code===kT.RESOURCE_EXHAUSTED?(ET(t.toString()),ET("Using maximum backoff delay to prevent overloading the backend."),n.So.po()):t&&t.code===kT.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Bo(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.Jr(t)})()}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),t=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.Po===t&&this.Uo(e,n)},t=>{e(()=>{const e=new TT(kT.UNKNOWN,"Fetching auth token failed: "+t.message);return this.qo(e)})})}Uo(e,t){const n=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(()=>{n(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(e=>{n(()=>this.qo(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}xo(){var e=this;this.state=5,this.So.Io(Sw(function*(){e.state=0,e.start()}))}qo(e){return _T("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return t=>{this.js.enqueueAndForget(()=>this.Po===e?t():(_T("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class YN extends jN{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.wt=i}Ko(e,t){return this.bo.ho("Listen",e,t)}onMessage(e){this.So.reset();const t=function(e,t){let n;if("targetChange"in t){const i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:ST(),s=t.targetChange.targetIds||[],o=function(e,t){return e.dt?(bT(void 0===t||"string"==typeof t),dI.fromBase64String(t||"")):(bT(void 0===t||t instanceof Uint8Array),dI.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,l=a&&function(e){const t=void 0===e.code?kT.UNKNOWN:iM(e.code);return new TT(t,e.message||"")}(a);n=new PM(i,s,o,l||null)}else if("documentChange"in t){const r=t.documentChange,i=UM(e,r.document.name),s=xM(r.document.updateTime),o=new BI({mapValue:{fields:r.document.fields}}),a=zI.newFoundDocument(i,s,o);n=new EM(r.targetIds||[],r.removedTargetIds||[],a.key,a)}else if("documentDelete"in t){const r=t.documentDelete,i=UM(e,r.document),s=r.readTime?xM(r.readTime):zT.min(),o=zI.newNoDocument(i,s);n=new EM([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){const r=t.documentRemove,i=UM(e,r.document);n=new EM([],r.removedTargetIds||[],i,null)}else{if(!("filter"in t))return ST();{const e=t.filter,r=new eM(e.count||0);n=new wM(e.targetId,r)}}var r;return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return zT.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?zT.min():t.readTime?xM(t.readTime):zT.min()}(e);return this.listener.Go(t,n)}Qo(e){const t={};t.database=BM(this.wt),t.addTarget=function(e,t){let n;const r=t.target;return n=WI(r)?{documents:HM(e,r)}:{query:GM(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=NM(e,t.resumeToken):t.snapshotVersion.compareTo(zT.min())>0&&(n.readTime=MM(e,t.snapshotVersion.toTimestamp())),n}(this.wt,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ST()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);n&&(t.labels=n),this.Mo(t)}jo(e){const t={};t.database=BM(this.wt),t.removeTarget=e,this.Mo(t)}}class KN extends jN{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,t){return this.bo.ho("Write",e,t)}onMessage(e){if(bT(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const t=function(e,t){return e&&e.length>0?(bT(void 0!==t),e.map(e=>function(e,t){let n=xM(e.updateTime?e.updateTime:t);return n.isEqual(zT.min())&&(n=xM(t)),new UA(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=xM(e.commitTime);return this.listener.Jo(n,t)}return bT(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=BM(this.wt),this.Mo(e)}Ho(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>function(e,t){let n;if(t instanceof WA)n={update:zM(e,t.key,t.value)};else if(t instanceof XA)n={delete:FM(e,t.key)};else if(t instanceof jA)n={update:zM(e,t.key,t.data),updateMask:JM(t.fieldMask)};else{if(!(t instanceof JA))return ST();n={verify:FM(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof IA)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof AA)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof NA)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof xA)return{fieldPath:t.field.canonicalString(),increment:n._t};throw ST()}(0,e))),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:RM(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:ST()),n;var r}(this.wt,e))};this.Mo(t)}}class QN extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.bo=n,this.wt=r,this.Zo=!1}tu(){if(this.Zo)throw new TT(kT.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,t,n){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.bo.ro(e,t,n,r,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===kT.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new TT(kT.UNKNOWN,e.toString())})}ao(e,t,n,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.bo.ao(e,t,n,i,s,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===kT.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new TT(kT.UNKNOWN,e.toString())})}terminate(){this.Zo=!0}}class XN{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(ET(t),this.su=!1):_T("OnlineStateTracker",t)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class JN{constructor(e,t,n,r,i){var s=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(e=>{n.enqueueAndForget(Sw(function*(){var e;uR(s)&&(_T("RemoteStore","Restarting streams for network reachability change."),yield(e=Sw(function*(e){const t=OT(e);t.lu.add(4),yield nR(t),t._u.set("Unknown"),t.lu.delete(4),yield eR(t)}),function(t){return e.apply(this,arguments)})(s))}))}),this._u=new XN(n,r)}}function eR(e){return tR.apply(this,arguments)}function tR(){return tR=Sw(function*(e){if(uR(e))for(const t of e.fu)yield t(!0)}),tR.apply(this,arguments)}function nR(e){return rR.apply(this,arguments)}function rR(){return rR=Sw(function*(e){for(const t of e.fu)yield t(!1)}),rR.apply(this,arguments)}function iR(e,t){const n=OT(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),cR(n)?lR(n):UR(n).Co()&&oR(n,t))}function sR(e,t){const n=OT(e),r=UR(n);n.hu.delete(t),r.Co()&&aR(n,t),0===n.hu.size&&(r.Co()?r.ko():uR(n)&&n._u.set("Unknown"))}function oR(e,t){e.wu.Nt(t.targetId),UR(e).Qo(t)}function aR(e,t){e.wu.Nt(t),UR(e).jo(t)}function lR(e){e.wu=new bM({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),te:t=>e.hu.get(t)||null}),UR(e).start(),e._u.iu()}function cR(e){return uR(e)&&!UR(e).Do()&&e.hu.size>0}function uR(e){return 0===OT(e).lu.size}function hR(e){e.wu=void 0}function dR(e){return fR.apply(this,arguments)}function fR(){return fR=Sw(function*(e){e.hu.forEach((t,n)=>{oR(e,t)})}),fR.apply(this,arguments)}function pR(e,t){return gR.apply(this,arguments)}function gR(){return gR=Sw(function*(e,t){hR(e),cR(e)?(e._u.uu(t),lR(e)):e._u.set("Unknown")}),gR.apply(this,arguments)}function mR(e,t,n){return yR.apply(this,arguments)}function yR(){return yR=Sw(function*(e,t,n){if(e._u.set("Online"),t instanceof PM&&2===t.state&&t.cause)try{yield(r=Sw(function*(e,t){const n=t.cause;for(const r of t.targetIds)e.hu.has(r)&&(yield e.remoteSyncer.rejectListen(r,n),e.hu.delete(r),e.wu.removeTarget(r))}),function(e,t){return r.apply(this,arguments)})(e,t)}catch(r){_T("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield vR(e,r)}else if(t instanceof EM?e.wu.Ut(t):t instanceof wM?e.wu.zt(t):e.wu.Gt(t),!n.isEqual(zT.min()))try{const t=yield MN(e.localStore);n.compareTo(t)>=0&&(yield function(e,t){const n=e.wu.Yt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(t=>{const n=e.hu.get(t);if(!n)return;e.hu.set(t,n.withResumeToken(dI.EMPTY_BYTE_STRING,n.snapshotVersion)),aR(e,t);const r=new iN(n.target,t,1,n.sequenceNumber);oR(e,r)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n))}catch(r){_T("RemoteStore","Failed to raise snapshot:",r),yield vR(e,r)}var r}),yR.apply(this,arguments)}function vR(e,t,n){return CR.apply(this,arguments)}function CR(){return CR=Sw(function*(e,t,n){if(!tI(t))throw t;e.lu.add(1),yield nR(e),e._u.set("Offline"),n||(n=()=>MN(e.localStore)),e.asyncQueue.enqueueRetryable(Sw(function*(){_T("RemoteStore","Retrying IndexedDB access"),yield n(),e.lu.delete(1),yield eR(e)}))}),CR.apply(this,arguments)}function _R(e,t){return t().catch(n=>vR(e,n,t))}function ER(e){return wR.apply(this,arguments)}function wR(){return wR=Sw(function*(e){const t=OT(e),n=VR(t);let r=t.au.length>0?t.au[t.au.length-1].batchId:-1;for(;PR(t);)try{const e=yield RN(t.localStore,r);if(null===e){0===t.au.length&&n.ko();break}r=e.batchId,SR(t,e)}catch(i){yield vR(t,i)}bR(t)&&OR(t)}),wR.apply(this,arguments)}function PR(e){return uR(e)&&e.au.length<10}function SR(e,t){e.au.push(t);const n=VR(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function bR(e){return uR(e)&&!VR(e).Do()&&e.au.length>0}function OR(e){VR(e).start()}function kR(e){return TR.apply(this,arguments)}function TR(){return TR=Sw(function*(e){VR(e).Xo()}),TR.apply(this,arguments)}function IR(e){return AR.apply(this,arguments)}function AR(){return AR=Sw(function*(e){const t=VR(e);for(const n of e.au)t.Ho(n.mutations)}),AR.apply(this,arguments)}function MR(e,t,n){return NR.apply(this,arguments)}function NR(){return NR=Sw(function*(e,t,n){const r=e.au.shift(),i=nN.from(r,t,n);yield _R(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),yield ER(e)}),NR.apply(this,arguments)}function RR(e,t){return xR.apply(this,arguments)}function xR(){return xR=Sw(function*(e,t){var n;t&&VR(e).zo&&(yield(n=Sw(function*(e,t){if(rM(n=t.code)&&n!==kT.ABORTED){const n=e.au.shift();VR(e).No(),yield _R(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),yield ER(e)}var n}),function(e,t){return n.apply(this,arguments)})(e,t)),bR(e)&&OR(e)}),xR.apply(this,arguments)}function DR(e,t){return LR.apply(this,arguments)}function LR(){return LR=Sw(function*(e,t){const n=OT(e);n.asyncQueue.verifyOperationInProgress(),_T("RemoteStore","RemoteStore received new credentials");const r=uR(n);n.lu.add(3),yield nR(n),r&&n._u.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(t),n.lu.delete(3),yield eR(n)}),LR.apply(this,arguments)}function FR(){return FR=Sw(function*(e,t){const n=OT(e);t?(n.lu.delete(2),yield eR(n)):t||(n.lu.add(2),yield nR(n),n._u.set("Unknown"))}),FR.apply(this,arguments)}function UR(e){return e.mu||(e.mu=function(e,t,n){const r=OT(e);return r.tu(),new YN(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(e.datastore,e.asyncQueue,{zr:dR.bind(null,e),Jr:pR.bind(null,e),Go:mR.bind(null,e)}),e.fu.push(function(){var t=Sw(function*(t){t?(e.mu.No(),cR(e)?lR(e):e._u.set("Unknown")):(yield e.mu.stop(),hR(e))});return function(e){return t.apply(this,arguments)}}())),e.mu}function VR(e){return e.gu||(e.gu=function(e,t,n){const r=OT(e);return r.tu(),new KN(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(e.datastore,e.asyncQueue,{zr:kR.bind(null,e),Jr:RR.bind(null,e),Yo:IR.bind(null,e),Jo:MR.bind(null,e)}),e.fu.push(function(){var t=Sw(function*(t){t?(e.gu.No(),yield ER(e)):(yield e.gu.stop(),e.au.length>0&&(_T("RemoteStore",`Stopping write stream with ${e.au.length} pending writes`),e.au=[]))});return function(e){return t.apply(this,arguments)}}())),e.gu}class BR{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new IT,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new BR(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new TT(kT.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $R(e,t){if(ET("AsyncQueue",`${t}: ${e}`),tI(e))return new TT(kT.UNAVAILABLE,`${t}: ${e}`);throw e}class zR{constructor(e){this.comparator=e?(t,n)=>e(t,n)||WT.comparator(t.key,n.key):(e,t)=>WT.comparator(e.key,t.key),this.keyedMap=cM(),this.sortedSet=new oI(this.comparator)}static emptySet(e){return new zR(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof zR)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new zR;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class HR{constructor(){this.yu=new oI(WT.comparator)}track(e){const t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):ST():this.yu=this.yu.insert(t,e)}pu(){const e=[];return this.yu.inorderTraversal((t,n)=>{e.push(n)}),e}}class GR{constructor(e,t,n,r,i,s,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,r){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new GR(e,t,zR.emptySet(t),i,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mA(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class ZR{constructor(){this.Iu=void 0,this.listeners=[]}}class qR{constructor(){this.queries=new sM(e=>yA(e),mA),this.onlineState="Unknown",this.Tu=new Set}}function WR(e,t){return jR.apply(this,arguments)}function jR(){return jR=Sw(function*(e,t){const n=OT(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new ZR),i)try{s.Iu=yield n.onListen(r)}catch(o){const e=$R(o,`Initialization of query '${vA(t.query)}' failed`);return void t.onError(e)}n.queries.set(r,s),s.listeners.push(t),t.Eu(n.onlineState),s.Iu&&t.Au(s.Iu)&&JR(n)}),jR.apply(this,arguments)}function YR(e,t){return KR.apply(this,arguments)}function KR(){return KR=Sw(function*(e,t){const n=OT(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}),KR.apply(this,arguments)}function QR(e,t){const n=OT(e);let r=!1;for(const i of t){const e=n.queries.get(i.query);if(e){for(const t of e.listeners)t.Au(i)&&(r=!0);e.Iu=i}}r&&JR(n)}function XR(e,t,n){const r=OT(e),i=r.queries.get(t);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(t)}function JR(e){e.Tu.forEach(e=>{e.next()})}class ex{constructor(e,t,n){this.query=e,this.Ru=t,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=n||{}}Au(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new GR(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),t=!0):this.Vu(e,this.onlineState)&&(this.Su(e),t=!0),this.Pu=e,t}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}Vu(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}vu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Su(e){e=GR.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}class tx{constructor(e){this.key=e}}class nx{constructor(e){this.key=e}}class rx{constructor(e,t){this.query=e,this.Fu=t,this.$u=null,this.current=!1,this.Bu=mM(),this.mutatedKeys=mM(),this.Lu=_A(e),this.Uu=new zR(this.Lu)}get qu(){return this.Fu}Ku(e,t){const n=t?t.Gu:new HR,r=t?t.Uu:this.Uu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=CA(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.Qu(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Lu(u,a)>0||l&&this.Lu(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Uu:s,Gu:n,Oi:o,mutatedKeys:i}}Qu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ST()}};return n(e)-n(t)}(e.type,t.type)||this.Lu(e.doc,t.doc)),this.ju(n);const s=t?this.Wu():[],o=0===this.Bu.size&&this.current?1:0,a=o!==this.$u;return this.$u=o,0!==i.length||a?{snapshot:new GR(this.query,e.Uu,r,i,e.mutatedKeys,0===o,a,!1),zu:s}:{zu:s}}Eu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new HR,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(e=>this.Fu=this.Fu.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Fu=this.Fu.delete(e)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=mM(),this.Uu.forEach(e=>{this.Hu(e.key)&&(this.Bu=this.Bu.add(e.key))});const t=[];return e.forEach(e=>{this.Bu.has(e)||t.push(new nx(e))}),this.Bu.forEach(n=>{e.has(n)||t.push(new tx(n))}),t}Ju(e){this.Fu=e.ji,this.Bu=mM();const t=this.Ku(e.documents);return this.applyChanges(t,!0)}Yu(){return GR.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class ix{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class sx{constructor(e){this.key=e,this.Xu=!1}}class ox{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Zu={},this.tc=new sM(e=>yA(e),mA),this.ec=new Map,this.nc=new Set,this.sc=new oI(WT.comparator),this.ic=new Map,this.rc=new mN,this.oc={},this.uc=new Map,this.cc=hN.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}function ax(e,t){return lx.apply(this,arguments)}function lx(){return lx=Sw(function*(e,t){const n=Dx(e);let r,i;const s=n.tc.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Yu();else{const e=yield xN(n.localStore,pA(t));n.isPrimaryClient&&iR(n.remoteStore,e);const s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=yield cx(n,t,r,"current"===s)}return i}),lx.apply(this,arguments)}function cx(e,t,n,r){return ux.apply(this,arguments)}function ux(){return ux=Sw(function*(e,t,n,r){e.hc=(t,n,r)=>{return(i=Sw(function*(e,t,n,r){let i=t.view.Ku(n);i.Oi&&(i=yield FN(e.localStore,t.query,!1).then(({documents:e})=>t.view.Ku(e,i)));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return kx(e,t.targetId,o.zu),o.snapshot}),function(e,t,n,r){return i.apply(this,arguments)})(e,t,n,r);var i};const i=yield FN(e.localStore,t,!0),s=new rx(t,i.ji),o=s.Ku(i.documents),a=_M.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),l=s.applyChanges(o,e.isPrimaryClient,a);kx(e,n,l.zu);const c=new ix(t,n,s);return e.tc.set(t,c),e.ec.has(n)?e.ec.get(n).push(t):e.ec.set(n,[t]),l.snapshot}),ux.apply(this,arguments)}function hx(e,t){return dx.apply(this,arguments)}function dx(){return dx=Sw(function*(e,t){const n=OT(e),r=n.tc.get(t),i=n.ec.get(r.targetId);if(i.length>1)return n.ec.set(r.targetId,i.filter(e=>!mA(e,t))),void n.tc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield DN(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),sR(n.remoteStore,r.targetId),bx(n,r.targetId)}).catch(XT))):(bx(n,r.targetId),yield DN(n.localStore,r.targetId,!0))}),dx.apply(this,arguments)}function fx(){return fx=Sw(function*(e,t,n){const r=Lx(e);try{const e=yield function(e,t){const n=OT(e),r=$T.now(),i=t.reduce((e,t)=>e.add(t.key),mM());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=aM(),l=mM();return n.Ui.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=ZA(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new jA(e.key,t,$I(t.value.mapValue),VA.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:uM(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.oc[e.currentUser.toKey()];r||(r=new oI(VT)),r=r.insert(t,n),e.oc[e.currentUser.toKey()]=r}(r,e.batchId,n),yield Ax(r,e.changes),yield ER(r.remoteStore)}catch(i){const e=$R(i,"Failed to persist write");n.reject(e)}}),fx.apply(this,arguments)}function px(e,t){return gx.apply(this,arguments)}function gx(){return gx=Sw(function*(e,t){const n=OT(e);try{const e=yield NN(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.ic.get(t);r&&(bT(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Xu=!0:e.modifiedDocuments.size>0?bT(r.Xu):e.removedDocuments.size>0&&(bT(r.Xu),r.Xu=!1))}),yield Ax(n,e,t)}catch(r){yield XT(r)}}),gx.apply(this,arguments)}function mx(e,t,n){const r=OT(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.tc.forEach((n,r)=>{const i=r.view.Eu(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=OT(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.listeners)i.Eu(t)&&(r=!0)}),r&&JR(n)}(r.eventManager,t),e.length&&r.Zu.Go(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function yx(e,t,n){return vx.apply(this,arguments)}function vx(){return vx=Sw(function*(e,t,n){const r=OT(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.ic.get(t),s=i&&i.key;if(s){let e=new oI(WT.comparator);e=e.insert(s,zI.newNoDocument(s,zT.min()));const n=mM().add(s),i=new CM(zT.min(),new Map,new cI(VT),e,n);yield px(r,i),r.sc=r.sc.remove(s),r.ic.delete(t),Ix(r)}else yield DN(r.localStore,t,!1).then(()=>bx(r,t,n)).catch(XT)}),vx.apply(this,arguments)}function Cx(e,t){return _x.apply(this,arguments)}function _x(){return _x=Sw(function*(e,t){const n=OT(e),r=t.batch.batchId;try{const e=yield AN(n.localStore,t);Sx(n,r,null),Px(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Ax(n,e)}catch(i){yield XT(i)}}),_x.apply(this,arguments)}function Ex(e,t,n){return wx.apply(this,arguments)}function wx(){return wx=Sw(function*(e,t,n){const r=OT(e);try{const e=yield function(e,t){const n=OT(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(bT(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Sx(r,t,n),Px(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),yield Ax(r,e)}catch(i){yield XT(i)}}),wx.apply(this,arguments)}function Px(e,t){(e.uc.get(t)||[]).forEach(e=>{e.resolve()}),e.uc.delete(t)}function Sx(e,t,n){const r=OT(e);let i=r.oc[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.oc[r.currentUser.toKey()]=i}}function bx(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.ec.get(t))e.tc.delete(r),n&&e.Zu.lc(r,n);e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach(t=>{e.rc.containsKey(t)||Ox(e,t)})}function Ox(e,t){e.nc.delete(t.path.canonicalString());const n=e.sc.get(t);null!==n&&(sR(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),Ix(e))}function kx(e,t,n){for(const r of n)r instanceof tx?(e.rc.addReference(r.key,t),Tx(e,r)):r instanceof nx?(_T("SyncEngine","Document no longer in limbo: "+r.key),e.rc.removeReference(r.key,t),e.rc.containsKey(r.key)||Ox(e,r.key)):ST()}function Tx(e,t){const n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(_T("SyncEngine","New document in limbo: "+n),e.nc.add(r),Ix(e))}function Ix(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){const t=e.nc.values().next().value;e.nc.delete(t);const n=new WT(GT.fromString(t)),r=e.cc.next();e.ic.set(r,new sx(n)),e.sc=e.sc.insert(n,r),iR(e.remoteStore,new iN(pA(cA(n.path)),r,2,nI.ot))}}function Ax(e,t,n){return Mx.apply(this,arguments)}function Mx(){return Mx=Sw(function*(e,t,n){const r=OT(e),i=[],s=[],o=[];var a;r.tc.isEmpty()||(r.tc.forEach((e,a)=>{o.push(r.hc(a,t,n).then(e=>{if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),i.push(e);const t=bN.Vi(a.targetId,e);s.push(t)}}))}),yield Promise.all(o),r.Zu.Go(i),yield(a=Sw(function*(e,t){const n=OT(e);try{yield n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>eI.forEach(t,t=>eI.forEach(t.Pi,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>eI.forEach(t.vi,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(r){if(!tI(r))throw r;_T("LocalStore","Failed to update sequence numbers: "+r)}for(const i of t){const e=i.targetId;if(!i.fromCache){const t=n.$i.get(e),r=t.withLastLimboFreeSnapshotVersion(t.snapshotVersion);n.$i=n.$i.insert(e,r)}}}),function(e,t){return a.apply(this,arguments)})(r.localStore,s))}),Mx.apply(this,arguments)}function Nx(e,t){return Rx.apply(this,arguments)}function Rx(){return Rx=Sw(function*(e,t){const n=OT(e);if(!n.currentUser.isEqual(t)){_T("SyncEngine","User change. New user:",t.toKey());const e=yield TN(n.localStore,t);n.currentUser=t,(r=n).uc.forEach(e=>{e.forEach(e=>{e.reject(new TT(kT.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.uc.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),yield Ax(n,e.Ki)}var r}),Rx.apply(this,arguments)}function xx(e,t){const n=OT(e),r=n.ic.get(t);if(r&&r.Xu)return mM().add(r.key);{let e=mM();const r=n.ec.get(t);if(!r)return e;for(const t of r){const r=n.tc.get(t);e=e.unionWith(r.view.qu)}return e}}function Dx(e){const t=OT(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=px.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=xx.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=yx.bind(null,t),t.Zu.Go=QR.bind(null,t.eventManager),t.Zu.lc=XR.bind(null,t.eventManager),t}function Lx(e){const t=OT(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Cx.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ex.bind(null,t),t}class Fx{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return Sw(function*(){t.wt=qN(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),yield t.persistence.start(),t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore)})()}mc(e,t){return null}gc(e,t){return null}wc(e){return function(e,t,n,r){return new kN(e,t,n,r)}(this.persistence,new ON,e.initialUser,this.wt)}_c(e){return new wN(SN.Ms,this.wt)}dc(e){return new VN}terminate(){var e=this;return Sw(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Ux{initialize(e,t){var n=this;return Sw(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=e=>mx(n.syncEngine,e,1),n.remoteStore.remoteSyncer.handleCredentialChange=Nx.bind(null,n.syncEngine),yield function(e,t){return FR.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new qR}createDatastore(e){const t=qN(e.databaseInfo.databaseId),n=new GN(e.databaseInfo);return new QN(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>mx(this.syncEngine,e,0),s=$N.V()?new $N:new BN,new JN(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new ox(e,t,n,r,i,s);return o&&(a.ac=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=Sw(function*(e){const t=OT(e);_T("RemoteStore","RemoteStore shutting down."),t.lu.add(5),yield nR(t),t.du.shutdown(),t._u.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}class Vx{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Bx{constructor(e,t,n,r){var i=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=mT.UNAUTHENTICATED,this.clientId=UT.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var e=Sw(function*(e){_T("FirestoreClient","Received user=",e.uid),yield i.authCredentialListener(e),i.user=e});return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(n,e=>(_T("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}getConfiguration(){var e=this;return Sw(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new TT(kT.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new IT;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(Sw(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const e=$R(n,"Failed to shutdown persistence");t.reject(e)}})),t.promise}}function $x(e,t){return zx.apply(this,arguments)}function zx(){return zx=Sw(function*(e,t){e.asyncQueue.verifyOperationInProgress(),_T("FirestoreClient","Initializing OfflineComponentProvider");const n=yield e.getConfiguration();yield t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(function(){var e=Sw(function*(e){r.isEqual(e)||(yield TN(t.localStore,e),r=e)});return function(t){return e.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e.offlineComponents=t}),zx.apply(this,arguments)}function Hx(e,t){return Gx.apply(this,arguments)}function Gx(){return Gx=Sw(function*(e,t){e.asyncQueue.verifyOperationInProgress();const n=yield Zx(e);_T("FirestoreClient","Initializing OnlineComponentProvider");const r=yield e.getConfiguration();yield t.initialize(n,r),e.setCredentialChangeListener(e=>DR(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>DR(t.remoteStore,n)),e.onlineComponents=t}),Gx.apply(this,arguments)}function Zx(e){return qx.apply(this,arguments)}function qx(){return qx=Sw(function*(e){return e.offlineComponents||(_T("FirestoreClient","Using default OfflineComponentProvider"),yield $x(e,new Fx)),e.offlineComponents}),qx.apply(this,arguments)}function Wx(e){return jx.apply(this,arguments)}function jx(){return jx=Sw(function*(e){return e.onlineComponents||(_T("FirestoreClient","Using default OnlineComponentProvider"),yield Hx(e,new Ux)),e.onlineComponents}),jx.apply(this,arguments)}function Yx(e){return Kx.apply(this,arguments)}function Kx(){return Kx=Sw(function*(e){const t=yield Wx(e),n=t.eventManager;return n.onListen=ax.bind(null,t.syncEngine),n.onUnlisten=hx.bind(null,t.syncEngine),n}),Kx.apply(this,arguments)}const Qx=new Map;function Xx(e,t,n){if(!n)throw new TT(kT.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Jx(e){if(!WT.isDocumentKey(e))throw new TT(kT.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function eD(e){if(WT.isDocumentKey(e))throw new TT(kT.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function tD(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var t;return"function"==typeof e?"a function":ST()}function nD(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new TT(kT.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=tD(e);throw new TT(kT.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class rD{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new TT(kT.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new TT(kT.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new TT(kT.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class iD{constructor(e,t,n){this._authCredentials=t,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rD({}),this._settingsFrozen=!1,e instanceof EI?this._databaseId=e:(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new TT(kT.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new EI(e.options.projectId)}(e))}get app(){if(!this._app)throw new TT(kT.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new TT(kT.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rD(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new MT;switch(e.type){case"gapi":const t=e.client;return bT(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new xT(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new TT(kT.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Qx.get(e);t&&(_T("ComponentProvider","Removing Datastore"),Qx.delete(e),t.terminate())}(this),Promise.resolve()}}class sD{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new aD(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new sD(this.firestore,e,this._key)}}class oD{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new oD(this.firestore,e,this._query)}}class aD extends oD{constructor(e,t,n){super(e,t,cA(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new sD(this.firestore,null,new WT(e))}withConverter(e){return new aD(this.firestore,e,this._path)}}function lD(e,t,...n){if(e=iP(e),Xx("collection","path",t),e instanceof iD){const r=GT.fromString(t,...n);return eD(r),new aD(e,null,r)}{if(!(e instanceof sD||e instanceof aD))throw new TT(kT.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(GT.fromString(t,...n));return eD(r),new aD(e.firestore,null,r)}}function cD(e,t,...n){if(e=iP(e),1===arguments.length&&(t=UT.I()),Xx("doc","path",t),e instanceof iD){const r=GT.fromString(t,...n);return Jx(r),new sD(e,null,new WT(r))}{if(!(e instanceof sD||e instanceof aD))throw new TT(kT.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(GT.fromString(t,...n));return Jx(r),new sD(e.firestore,e instanceof aD?e.converter:null,new WT(r))}}class uD{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new WN(this,"async_queue_retry"),this.Kc=()=>{const e=ZN();e&&_T("AsyncQueue","Visibility state changed to "+e.visibilityState),this.So.Eo()};const e=ZN();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const t=ZN();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const t=new IT;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}jc(){var e=this;return Sw(function*(){if(0!==e.Mc.length){try{yield e.Mc[0](),e.Mc.shift(),e.So.reset()}catch(t){if(!tI(t))throw t;_T("AsyncQueue","Operation failed with retryable error: "+t)}e.Mc.length>0&&e.So.Io(()=>e.jc())}})()}Qc(e){const t=this.Oc.then(()=>(this.Lc=!0,e().catch(e=>{throw this.Bc=e,this.Lc=!1,ET("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(e=>(this.Lc=!1,e))));return this.Oc=t,t}enqueueAfterDelay(e,t,n){this.Gc(),this.qc.indexOf(e)>-1&&(t=0);const r=BR.createAndSchedule(this,e,t,n,e=>this.Wc(e));return this.$c.push(r),r}Gc(){this.Bc&&ST()}verifyOperationInProgress(){}zc(){var e=this;return Sw(function*(){let t;do{t=e.Oc,yield t}while(t!==e.Oc)})()}Hc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function hD(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of["next","error","complete"])if(r in n&&"function"==typeof n[r])return!0;return!1}(e)}class dD extends iD{constructor(e,t,n){super(e,t,n),this.type="firestore",this._queue=new uD,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||gD(this),this._firestoreClient.terminate()}}function fD(e=jP()){return HP(e,"firestore").getImmediate()}function pD(e){return e._firestoreClient||gD(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function gD(e){var t;const n=e._freezeSettings(),r=(i=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new _I(e._databaseId,i,e._persistenceKey,(s=n).host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,s.useFetchStreams));var i,s;e._firestoreClient=new Bx(e._authCredentials,e._appCheckCredentials,e._queue,r)}class mD{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new TT(kT.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qT(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class yD{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yD(dI.fromBase64String(e))}catch(t){throw new TT(kT.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new yD(dI.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class vD{constructor(e){this._methodName=e}}class CD{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new TT(kT.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new TT(kT.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return VT(this._lat,e._lat)||VT(this._long,e._long)}}const _D=/^__.*__$/;class ED{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new jA(e,this.data,this.fieldMask,t,this.fieldTransforms):new WA(e,this.data,t,this.fieldTransforms)}}class wD{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new jA(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function PD(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ST()}}class SD{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.wt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new SD(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}ia(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return FD(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(PD(this.Zc)&&_D.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class bD{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.wt=n||qN(e)}aa(e,t,n,r=!1){return new SD({Zc:e,methodName:t,ca:n,path:qT.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function OD(e){const t=e._freezeSettings(),n=qN(e._databaseId);return new bD(e._databaseId,!!t.ignoreUndefinedProperties,n)}function kD(e,t,n,r,i,s={}){const o=e.aa(s.merge||s.mergeFields?2:0,t,n,i);RD("Data must be an object, but it was:",o,r);const a=MD(r,o);let l,c;if(s.merge)l=new hI(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=xD(t,r,n);if(!o.contains(i))throw new TT(kT.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);UD(e,i)||e.push(i)}l=new hI(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new ED(new BI(a),l,c)}class TD extends vD{_toFieldTransform(e){if(2!==e.Zc)throw e.oa(1===e.Zc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof TD}}class ID extends vD{_toFieldTransform(e){return new FA(e.path,new IA)}isEqual(e){return e instanceof ID}}function AD(e,t){if(ND(e=iP(e)))return RD("Unsupported field value:",t,e),MD(e,t);if(e instanceof vD)return function(e,t){if(!PD(t.Zc))throw t.oa(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.oa(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=AD(i,t.ra(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=iP(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return SA(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=$T.fromDate(e);return{timestampValue:MM(t.wt,n)}}if(e instanceof $T){const n=new $T(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:MM(t.wt,n)}}if(e instanceof CD)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof yD)return{bytesValue:NM(t.wt,e._byteString)};if(e instanceof sD){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.oa(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:DM(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa(`Unsupported field value: ${tD(e)}`)}(e,t)}function MD(e,t){const n={};return sI(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):iI(e,(e,r)=>{const i=AD(r,t.ea(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function ND(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof $T||e instanceof CD||e instanceof yD||e instanceof sD||e instanceof vD)}function RD(e,t,n){if(!ND(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=tD(n);throw t.oa("an object"===r?e+" a custom object":e+" "+r)}var r}function xD(e,t,n){if((t=iP(t))instanceof mD)return t._internalPath;if("string"==typeof t)return LD(e,t);throw FD("Field path arguments must be of type string or ",e,!1,void 0,n)}const DD=new RegExp("[~\\*/\\[\\]]");function LD(e,t,n){if(t.search(DD)>=0)throw FD(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new mD(...t.split("."))._internalPath}catch{throw FD(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function FD(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new TT(kT.INVALID_ARGUMENT,a+e+l)}function UD(e,t){return e.some(e=>e.isEqual(t))}class VD{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new sD(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new BD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field($D("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class BD extends VD{data(){return super.data()}}function $D(e,t){return"string"==typeof t?LD(e,t):t instanceof mD?t._internalPath:t._delegate._internalPath}class zD{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class HD extends VD{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new GD(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field($D("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class GD extends HD{data(e={}){return super.data(e)}}class ZD{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new zD(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new GD(this._firestore,this._userDataWriter,n.key,n,new zD(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new TT(kT.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>({type:"added",doc:new GD(e._firestore,e._userDataWriter,n.doc.key,n.doc,new zD(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new GD(e._firestore,e._userDataWriter,t.doc.key,t.doc,new zD(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:qD(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function qD(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ST()}}function WD(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new TT(kT.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class jD{}function YD(e,...t){for(const n of t)e=n._apply(e);return e}class KD extends jD{constructor(e,t,n){super(),this.fa=e,this.da=t,this._a=n,this.type="where"}_apply(e){const t=OD(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new TT(kT.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){rL(o,s);const t=[];for(const n of o)t.push(nL(r,e,n));a={arrayValue:{values:t}}}else a=nL(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||rL(o,s),a=function(e,t,n,r=!1){return AD(n,e.aa(r?4:3,t))}(n,"where",o,"in"===s||"not-in"===s);const l=jI.create(i,s,a);return function(e,t){if(t.ht()){const n=hA(e);if(null!==n&&!n.isEqual(t.field))throw new TT(kT.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${t.field.toString()}'`);const r=uA(e);null!==r&&iL(0,t.field,r)}const n=function(e,t){for(const n of e.filters)if(t.indexOf(n.op)>=0)return n.op;return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw new TT(kT.INVALID_ARGUMENT,n===t.op?`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`:`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}(e,l),l}(e._query,0,t,e.firestore._databaseId,this.fa,this.da,this._a);return new oD(e.firestore,e.converter,function(e,t){const n=e.filters.concat([t]);return new lA(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}function QD(e,t,n){const r=t,i=$D("where",e);return new KD(i,r,n)}class XD extends jD{constructor(e,t){super(),this.fa=e,this.wa=t,this.type="orderBy"}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new TT(kT.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new TT(kT.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new iA(t,n);return function(e,t){if(null===uA(e)){const n=hA(e);null!==n&&iL(0,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new oD(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new lA(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function JD(e,t="asc"){const n=t,r=$D("orderBy",e);return new XD(r,n)}class eL extends jD{constructor(e,t,n){super(),this.type=e,this.ma=t,this.ga=n}_apply(e){return new oD(e.firestore,e.converter,gA(e._query,this.ma,this.ga))}}function tL(e){return function(e,t){if(t<=0)throw new TT(kT.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}("limit",e),new eL("limit",e,"F")}function nL(e,t,n){if("string"==typeof(n=iP(n))){if(""===n)throw new TT(kT.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dA(t)&&-1!==n.indexOf("/"))throw new TT(kT.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(GT.fromString(n));if(!WT.isDocumentKey(r))throw new TT(kT.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return NI(e,new WT(r))}if(n instanceof sD)return NI(e,n._key);throw new TT(kT.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tD(n)}.`)}function rL(e,t){if(!Array.isArray(e)||0===e.length)throw new TT(kT.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new TT(kT.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function iL(e,t,n){if(!n.isEqual(t))throw new TT(kT.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}function sL(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}function oL(e){e=nD(e,sD);const t=nD(e.firestore,dD);return function(e,t,n={}){const r=new IT;return e.asyncQueue.enqueueAndForget(Sw(function*(){return function(e,t,n,r,i){const s=new Vx({next:s=>{t.enqueueAndForget(()=>YR(e,o));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new TT(kT.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new TT(kT.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new ex(cA(n.path),s,{includeMetadataChanges:!0,Du:!0});return WR(e,o)}(yield Yx(e),e.asyncQueue,t,n,r)})),r.promise}(pD(t),e._key).then(n=>gL(t,e,n))}class aL extends class{convertValue(e,t="none"){switch(bI(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gI(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(mI(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ST()}}convertObject(e,t){const n={};return iI(e.fields,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertGeoPoint(e){return new CD(gI(e.latitude),gI(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=vI(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(CI(e));default:return null}}convertTimestamp(e){const t=pI(e);return new $T(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=GT.fromString(e);bT(eN(n));const r=new EI(n.get(1),n.get(3)),i=new WT(n.popFirst(5));return r.isEqual(t)||ET(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}{constructor(e){super(),this.firestore=e}convertBytes(e){return new yD(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new sD(this.firestore,null,t)}}function lL(e){e=nD(e,oD);const t=nD(e.firestore,dD),n=pD(t),r=new aL(t);return WD(e._query),function(e,t,n={}){const r=new IT;return e.asyncQueue.enqueueAndForget(Sw(function*(){return function(e,t,n,r,i){const s=new Vx({next:n=>{t.enqueueAndForget(()=>YR(e,o)),n.fromCache&&"server"===r.source?i.reject(new TT(kT.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new ex(n,s,{includeMetadataChanges:!0,Du:!0});return WR(e,o)}(yield Yx(e),e.asyncQueue,t,n,r)})),r.promise}(n,e._query).then(n=>new ZD(t,r,e,n))}function cL(e,t,n){e=nD(e,sD);const r=nD(e.firestore,dD),i=sL(e.converter,t,n);return pL(r,[kD(OD(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,VA.none())])}function uL(e,t,n,...r){e=nD(e,sD);const i=nD(e.firestore,dD),s=OD(i);let o;return o="string"==typeof(t=iP(t))||t instanceof mD?function(e,t,n,r,i,s){const o=e.aa(1,t,n),a=[xD(t,r,n)],l=[i];if(s.length%2!=0)throw new TT(kT.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(xD(t,s[d])),l.push(s[d+1]);const c=[],u=BI.empty();for(let d=a.length-1;d>=0;--d)if(!UD(c,a[d])){const e=a[d];let t=l[d];t=iP(t);const n=o.ia(e);if(t instanceof TD)c.push(e);else{const r=AD(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new hI(c);return new wD(u,h,o.fieldTransforms)}(s,"updateDoc",e._key,t,n,r):function(e,t,n,r){const i=e.aa(1,t,n);RD("Data must be an object, but it was:",i,r);const s=[],o=BI.empty();iI(r,(e,r)=>{const a=LD(t,e,n);r=iP(r);const l=i.ia(a);if(r instanceof TD)s.push(a);else{const e=AD(r,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new hI(s);return new wD(o,a,i.fieldTransforms)}(s,"updateDoc",e._key,t),pL(i,[o.toMutation(e._key,VA.exists(!0))])}function hL(e){return pL(nD(e.firestore,dD),[new XA(e._key,VA.none())])}function dL(e,t){const n=nD(e.firestore,dD),r=cD(e),i=sL(e.converter,t);return pL(n,[kD(OD(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,VA.exists(!1))]).then(()=>r)}function fL(e,...t){var n,r,i;e=iP(e);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||hD(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(hD(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let l,c,u;if(e instanceof sD)c=nD(e.firestore,dD),u=cA(e._key.path),l={next:n=>{t[o]&&t[o](gL(c,e,n))},error:t[o+1],complete:t[o+2]};else{const n=nD(e,oD);c=nD(n.firestore,dD),u=n._query;const r=new aL(c);l={next:e=>{t[o]&&t[o](new ZD(c,r,n,e))},error:t[o+1],complete:t[o+2]},WD(e._query)}return function(e,t,n,r){const i=new Vx(r),s=new ex(t,i,n);return e.asyncQueue.enqueueAndForget(Sw(function*(){return WR(yield Yx(e),s)})),()=>{i.Tc(),e.asyncQueue.enqueueAndForget(Sw(function*(){return YR(yield Yx(e),s)}))}}(pD(c),u,a,l)}function pL(e,t){return function(e,t){const n=new IT;return e.asyncQueue.enqueueAndForget(Sw(function*(){return function(e,t,n){return fx.apply(this,arguments)}(yield function(e){return Wx(e).then(e=>e.syncEngine)}(e),t,n)})),n.promise}(pD(e),t)}function gL(e,t,n){const r=n.docs.get(t._key),i=new aL(e);return new HD(e,i,t._key,r,new zD(n.hasPendingWrites,n.fromCache),t.converter)}function mL(){return new ID("serverTimestamp")}!function(e,t=!0){yT="9.9.0",zP(new sP("firestore",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=new dD(r,new NT(e.getProvider("auth-internal")),new LT(e.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:t},n),i._setSettings(n),i},"PUBLIC")),KP(gT,"3.4.12",e),KP(gT,"3.4.12","esm2017")}(),KP("firebase","9.9.0","app");const yL="@firebase/installations",vL="0.5.12",CL=`w:${vL}`,_L="FIS_v2",EL=new jw("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function wL(e){return e instanceof Ww&&e.code.includes("request-failed")}function PL({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function SL(e){return{token:e.token,requestStatus:2,expiresIn:ML(e.expiresIn),creationTime:Date.now()}}function bL(e,t){return OL.apply(this,arguments)}function OL(){return OL=Sw(function*(e,t){const n=(yield t.json()).error;return EL.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}),OL.apply(this,arguments)}function kL({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function TL(e,{refreshToken:t}){const n=kL(e);return n.append("Authorization",function(e){return`${_L} ${e}`}(t)),n}function IL(e){return AL.apply(this,arguments)}function AL(){return AL=Sw(function*(e){const t=yield e();return t.status>=500&&t.status<600?e():t}),AL.apply(this,arguments)}function ML(e){return Number(e.replace("s","000"))}function NL(e,t){return RL.apply(this,arguments)}function RL(){return RL=Sw(function*({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const r=PL(e),i=kL(e),s=t.getImmediate({optional:!0});if(s){const e=yield s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={method:"POST",headers:i,body:JSON.stringify({fid:n,authVersion:_L,appId:e.appId,sdkVersion:CL})},a=yield IL(()=>fetch(r,o));if(a.ok){const e=yield a.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:SL(e.authToken)}}throw yield bL("Create Installation",a)}),RL.apply(this,arguments)}function xL(e){return new Promise(t=>{setTimeout(t,e)})}const DL=/^[cdef][\w-]{21}$/;function LL(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return function(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return DL.test(t)?t:""}catch{return""}}function FL(e){return`${e.appName}!${e.appId}`}const UL=new Map;function VL(e,t){const n=FL(e);BL(n,t),function(e,t){const n=(!$L&&"BroadcastChannel"in self&&($L=new BroadcastChannel("[Firebase] FID Change"),$L.onmessage=e=>{BL(e.data.key,e.data.fid)}),$L);n&&n.postMessage({key:e,fid:t}),0===UL.size&&$L&&($L.close(),$L=null)}(n,t)}function BL(e,t){const n=UL.get(e);if(n)for(const r of n)r(t)}let $L=null;const zL="firebase-installations-store";let HL=null;function GL(){return HL||(HL=kP("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(zL)}})),HL}function ZL(e,t){return qL.apply(this,arguments)}function qL(){return qL=Sw(function*(e,t){const n=FL(e),r=(yield GL()).transaction(zL,"readwrite"),i=r.objectStore(zL),s=yield i.get(n);return yield i.put(t,n),yield r.done,(!s||s.fid!==t.fid)&&VL(e,t.fid),t}),qL.apply(this,arguments)}function WL(e){return jL.apply(this,arguments)}function jL(){return jL=Sw(function*(e){const t=FL(e),n=(yield GL()).transaction(zL,"readwrite");yield n.objectStore(zL).delete(t),yield n.done}),jL.apply(this,arguments)}function YL(e,t){return KL.apply(this,arguments)}function KL(){return KL=Sw(function*(e,t){const n=FL(e),r=(yield GL()).transaction(zL,"readwrite"),i=r.objectStore(zL),s=yield i.get(n),o=t(s);return void 0===o?yield i.delete(n):yield i.put(o,n),yield r.done,o&&(!s||s.fid!==o.fid)&&VL(e,o.fid),o}),KL.apply(this,arguments)}function QL(e){return XL.apply(this,arguments)}function XL(){return XL=Sw(function*(e){let t;const n=yield YL(e.appConfig,n=>{const r=JL(n),i=eF(e,r);return t=i.registrationPromise,i.installationEntry});return""===n.fid?{installationEntry:yield t}:{installationEntry:n,registrationPromise:t}}),XL.apply(this,arguments)}function JL(e){return sF(e||{fid:LL(),registrationStatus:0})}function eF(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(EL.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return tF.apply(this,arguments)}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:nF(e)}:{installationEntry:t}}function tF(){return tF=Sw(function*(e,t){try{const n=yield NL(e,t);return ZL(e.appConfig,n)}catch(n){throw wL(n)&&409===n.customData.serverCode?yield WL(e.appConfig):yield ZL(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}),tF.apply(this,arguments)}function nF(e){return rF.apply(this,arguments)}function rF(){return rF=Sw(function*(e){let t=yield iF(e.appConfig);for(;1===t.registrationStatus;)yield xL(100),t=yield iF(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=yield QL(e);return n||t}return t}),rF.apply(this,arguments)}function iF(e){return YL(e,e=>{if(!e)throw EL.create("installation-not-found");return sF(e)})}function sF(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function oF(e,t){return aF.apply(this,arguments)}function aF(){return aF=Sw(function*({appConfig:e,heartbeatServiceProvider:t},n){const r=lF(e,n),i=TL(e,n),s=t.getImmediate({optional:!0});if(s){const e=yield s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:CL,appId:e.appId}})},a=yield IL(()=>fetch(r,o));if(a.ok)return SL(yield a.json());throw yield bL("Generate Auth Token",a)}),aF.apply(this,arguments)}function lF(e,{fid:t}){return`${PL(e)}/${t}/authTokens:generate`}function cF(e){return uF.apply(this,arguments)}function uF(){return uF=Sw(function*(e,t=!1){let n;const r=yield YL(e.appConfig,r=>{if(!mF(r))throw EL.create("not-registered");const i=r.authToken;if(!t&&yF(i))return r;if(1===i.requestStatus)return n=hF(e,t),r;{if(!navigator.onLine)throw EL.create("app-offline");const t=vF(r);return n=pF(e,t),t}});return n?yield n:r.authToken}),uF.apply(this,arguments)}function hF(e,t){return dF.apply(this,arguments)}function dF(){return dF=Sw(function*(e,t){let n=yield fF(e.appConfig);for(;1===n.authToken.requestStatus;)yield xL(100),n=yield fF(e.appConfig);const r=n.authToken;return 0===r.requestStatus?cF(e,t):r}),dF.apply(this,arguments)}function fF(e){return YL(e,e=>{if(!mF(e))throw EL.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function pF(e,t){return gF.apply(this,arguments)}function gF(){return gF=Sw(function*(e,t){try{const n=yield oF(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return yield ZL(e.appConfig,r),n}catch(n){if(!wL(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});yield ZL(e.appConfig,n)}else yield WL(e.appConfig);throw n}}),gF.apply(this,arguments)}function mF(e){return void 0!==e&&2===e.registrationStatus}function yF(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function vF(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function CF(){return CF=Sw(function*(e){const t=e,{installationEntry:n,registrationPromise:r}=yield QL(t);return r?r.catch(console.error):cF(t).catch(console.error),n.fid}),CF.apply(this,arguments)}function _F(){return _F=Sw(function*(e,t=!1){const n=e;return yield EF(n),(yield cF(n,t)).token}),_F.apply(this,arguments)}function EF(e){return wF.apply(this,arguments)}function wF(){return wF=Sw(function*(e){const{registrationPromise:t}=yield QL(e);t&&(yield t)}),wF.apply(this,arguments)}function PF(e){return EL.create("missing-app-config-values",{valueName:e})}const SF="installations";zP(new sP(SF,e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw PF("App Configuration");if(!e.name)throw PF("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw PF(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:HP(t,"heartbeat"),_delete:()=>Promise.resolve()}},"PUBLIC")),zP(new sP("installations-internal",e=>{const t=HP(e.getProvider("app").getImmediate(),SF).getImmediate();return{getId:()=>function(e){return CF.apply(this,arguments)}(t),getToken:e=>function(e){return _F.apply(this,arguments)}(t,e)}},"PRIVATE")),KP(yL,vL),KP(yL,vL,"esm2017");const bF="@firebase/remote-config",OF=new jw("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class kF{constructor(e,t,n,r){this.client=e,this.storage=t,this.storageCache=n,this.logger=r}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,r=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}fetch(e){var t=this;return Sw(function*(){const[n,r]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(r&&t.isCachedDataFresh(e.cacheMaxAgeMillis,n))return r;e.eTag=r&&r.eTag;const i=yield t.client.fetch(e),s=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===i.status&&s.push(t.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(s),i})()}}function TF(e=navigator){return e.languages&&e.languages[0]||e.language}class IF{constructor(e,t,n,r,i,s){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=s}fetch(e){var t=this;return Sw(function*(){var n,r,i;const[s,o]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),a=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,l={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},c={sdk_version:t.sdkVersion,app_instance_id:s,app_instance_id_token:o,app_id:t.appId,language_code:TF()},u={method:"POST",headers:l,body:JSON.stringify(c)},h=fetch(a,u),d=new Promise((t,n)=>{e.signal.addEventListener(()=>{const e=new Error("The operation was aborted.");e.name="AbortError",n(e)})});let f;try{yield Promise.race([h,d]),f=yield h}catch(v){let e="fetch-client-network";throw"AbortError"===(null===(n=v)||void 0===n?void 0:n.name)&&(e="fetch-timeout"),OF.create(e,{originalErrorMessage:null===(r=v)||void 0===r?void 0:r.message})}let p=f.status;const g=f.headers.get("ETag")||void 0;let m,y;if(200===f.status){let e;try{e=yield f.json()}catch(C){throw OF.create("fetch-client-parse",{originalErrorMessage:null===(i=C)||void 0===i?void 0:i.message})}m=e.entries,y=e.state}if("INSTANCE_STATE_UNSPECIFIED"===y?p=500:"NO_CHANGE"===y?p=304:("NO_TEMPLATE"===y||"EMPTY_CONFIG"===y)&&(m={}),304!==p&&200!==p)throw OF.create("fetch-status",{httpStatus:p});return{status:p,eTag:g,config:m}})()}}class AF{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return Sw(function*(){const n=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,n)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){var r=this;return Sw(function*(){yield function(e,t){return new Promise((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener(()=>{clearTimeout(s),r(OF.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,t);try{const t=yield r.client.fetch(e);return yield r.storage.deleteThrottleMetadata(),t}catch(i){if(!function(e){if(!(e instanceof Ww&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i))throw i;const t={throttleEndTimeMillis:Date.now()+rP(n),backoffCount:n+1};return yield r.storage.setThrottleMetadata(t),r.attemptFetch(e,t)}})()}}class MF{constructor(e,t,n,r,i){this.app=e,this._client=t,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function NF(e,t){var n;const r=e.target.error||void 0;return OF.create(t,{originalErrorMessage:r&&(null===(n=r)||void 0===n?void 0:n.message)})}const RF="app_namespace_store";class xF{constructor(e,t,n,r=function(){return new Promise((e,t)=>{var r;try{const n=indexedDB.open("firebase_remote_config",1);n.onerror=e=>{t(NF(e,"storage-open"))},n.onsuccess=t=>{e(t.target.result)},n.onupgradeneeded=e=>{0===e.oldVersion&&e.target.result.createObjectStore(RF,{keyPath:"compositeKey"})}}catch(n){t(OF.create("storage-open",{originalErrorMessage:null===(r=n)||void 0===r?void 0:r.message}))}})}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return Sw(function*(){const n=yield t.openDbPromise;return new Promise((r,i)=>{var s;const o=n.transaction([RF],"readonly").objectStore(RF),a=t.createCompositeKey(e);try{const e=o.get(a);e.onerror=e=>{i(NF(e,"storage-get"))},e.onsuccess=e=>{const t=e.target.result;r(t?t.value:void 0)}}catch(l){i(OF.create("storage-get",{originalErrorMessage:null===(s=l)||void 0===s?void 0:s.message}))}})})()}set(e,t){var n=this;return Sw(function*(){const r=yield n.openDbPromise;return new Promise((i,s)=>{var o;const a=r.transaction([RF],"readwrite").objectStore(RF),l=n.createCompositeKey(e);try{const e=a.put({compositeKey:l,value:t});e.onerror=e=>{s(NF(e,"storage-set"))},e.onsuccess=()=>{i()}}catch(c){s(OF.create("storage-set",{originalErrorMessage:null===(o=c)||void 0===o?void 0:o.message}))}})})()}delete(e){var t=this;return Sw(function*(){const n=yield t.openDbPromise;return new Promise((r,i)=>{var s;const o=n.transaction([RF],"readwrite").objectStore(RF),a=t.createCompositeKey(e);try{const e=o.delete(a);e.onerror=e=>{i(NF(e,"storage-delete"))},e.onsuccess=()=>{r()}}catch(l){i(OF.create("storage-delete",{originalErrorMessage:null===(s=l)||void 0===s?void 0:s.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class DF{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return Sw(function*(){const t=e.storage.getLastFetchStatus(),n=e.storage.getLastSuccessfulFetchTimestampMillis(),r=e.storage.getActiveConfig(),i=yield t;i&&(e.lastFetchStatus=i);const s=yield n;s&&(e.lastSuccessfulFetchTimestampMillis=s);const o=yield r;o&&(e.activeConfig=o)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function LF(){return FF.apply(this,arguments)}function FF(){return(FF=Sw(function*(){if(!Gw())return!1;try{return yield Zw()}catch{return!1}})).apply(this,arguments)}zP(new sP("remote-config",function(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw OF.create("registration-window");if(!Gw())throw OF.create("indexed-db-unavailable");const{projectId:i,apiKey:s,appId:o}=n.options;if(!i)throw OF.create("registration-project-id");if(!s)throw OF.create("registration-api-key");if(!o)throw OF.create("registration-app-id");const a=new xF(o,n.name,t=t||"firebase"),l=new DF(a),c=new gP(bF);c.logLevel=uP.ERROR;const u=new IF(r,qP,t,i,s,o),h=new AF(u,a),d=new kF(h,a,l,c),f=new MF(n,d,l,a,c);return function(e){const t=iP(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0}))}(f),f},"PUBLIC").setMultipleInstances(!0)),KP(bF,"0.3.11"),KP(bF,"0.3.11","esm2017");const UF="/firebase-messaging-sw.js",VF="/firebase-cloud-messaging-push-scope",BF="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",$F="google.c.a.c_id",zF="google.c.a.c_l",HF="google.c.a.ts",GF="google.c.a.e";var ZF=(()=>(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(ZF||(ZF={})),ZF))();function qF(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function WF(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}const jF="fcm_token_details_db",YF="fcm_token_object_Store";function KF(e){return QF.apply(this,arguments)}function QF(){return QF=Sw(function*(e){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(e=>e.name).includes(jF))return null;let t=null;return(yield kP(jF,5,{upgrade:(n=Sw(function*(n,r,i,s){var o;if(r<2||!n.objectStoreNames.contains(YF))return;const a=s.objectStore(YF),l=yield a.index("fcmSenderId").get(e);if(yield a.clear(),l)if(2===r){const e=l;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(o=e.createTime)&&void 0!==o?o:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:qF(e.vapidKey)}}}else if(3===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:qF(e.auth),p256dh:qF(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:qF(e.vapidKey)}}}else if(4===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:qF(e.auth),p256dh:qF(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:qF(e.vapidKey)}}}}),function(e,t,r,i){return n.apply(this,arguments)})})).close(),yield TP(jF),yield TP("fcm_vapid_details_db"),yield TP("undefined"),XF(t)?t:null;var n}),QF.apply(this,arguments)}function XF(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}const JF="firebase-messaging-store";let eU=null;function tU(){return eU||(eU=kP("firebase-messaging-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(JF)}})),eU}function nU(e){return rU.apply(this,arguments)}function rU(){return rU=Sw(function*(e){const t=lU(e),n=yield(yield tU()).transaction(JF).objectStore(JF).get(t);if(n)return n;{const t=yield KF(e.appConfig.senderId);if(t)return yield iU(e,t),t}}),rU.apply(this,arguments)}function iU(e,t){return sU.apply(this,arguments)}function sU(){return sU=Sw(function*(e,t){const n=lU(e),r=(yield tU()).transaction(JF,"readwrite");return yield r.objectStore(JF).put(t,n),yield r.done,t}),sU.apply(this,arguments)}function oU(e){return aU.apply(this,arguments)}function aU(){return aU=Sw(function*(e){const t=lU(e),n=(yield tU()).transaction(JF,"readwrite");yield n.objectStore(JF).delete(t),yield n.done}),aU.apply(this,arguments)}function lU({appConfig:e}){return e.appId}const cU=new jw("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function uU(e,t){return hU.apply(this,arguments)}function hU(){return hU=Sw(function*(e,t){var n;const r=yield yU(e),i=CU(t),s={method:"POST",headers:r,body:JSON.stringify(i)};let o;try{o=yield(yield fetch(mU(e.appConfig),s)).json()}catch(a){throw cU.create("token-subscribe-failed",{errorInfo:null===(n=a)||void 0===n?void 0:n.toString()})}if(o.error)throw cU.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw cU.create("token-subscribe-no-token");return o.token}),hU.apply(this,arguments)}function dU(e,t){return fU.apply(this,arguments)}function fU(){return fU=Sw(function*(e,t){var n;const r=yield yU(e),i=CU(t.subscriptionOptions),s={method:"PATCH",headers:r,body:JSON.stringify(i)};let o;try{o=yield(yield fetch(`${mU(e.appConfig)}/${t.token}`,s)).json()}catch(a){throw cU.create("token-update-failed",{errorInfo:null===(n=a)||void 0===n?void 0:n.toString()})}if(o.error)throw cU.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw cU.create("token-update-no-token");return o.token}),fU.apply(this,arguments)}function pU(e,t){return gU.apply(this,arguments)}function gU(){return gU=Sw(function*(e,t){var n;const r={method:"DELETE",headers:yield yU(e)};try{const n=yield(yield fetch(`${mU(e.appConfig)}/${t}`,r)).json();if(n.error)throw cU.create("token-unsubscribe-failed",{errorInfo:n.error.message})}catch(i){throw cU.create("token-unsubscribe-failed",{errorInfo:null===(n=i)||void 0===n?void 0:n.toString()})}}),gU.apply(this,arguments)}function mU({projectId:e}){return`https://fcmregistrations.googleapis.com/v1/projects/${e}/registrations`}function yU(e){return vU.apply(this,arguments)}function vU(){return vU=Sw(function*({appConfig:e,installations:t}){const n=yield t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}),vU.apply(this,arguments)}function CU({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==BF&&(i.web.applicationPubKey=r),i}function _U(e){return EU.apply(this,arguments)}function EU(){return EU=Sw(function*(e){const t=yield TU(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:qF(t.getKey("auth")),p256dh:qF(t.getKey("p256dh"))},r=yield nU(e.firebaseDependencies);if(r){if(AU(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?SU(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{yield pU(e.firebaseDependencies,r.token)}catch(i){console.warn(i)}return OU(e.firebaseDependencies,n)}return OU(e.firebaseDependencies,n)}),EU.apply(this,arguments)}function wU(e){return PU.apply(this,arguments)}function PU(){return PU=Sw(function*(e){const t=yield nU(e.firebaseDependencies);t&&(yield pU(e.firebaseDependencies,t.token),yield oU(e.firebaseDependencies));const n=yield e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}),PU.apply(this,arguments)}function SU(e,t){return bU.apply(this,arguments)}function bU(){return bU=Sw(function*(e,t){try{const n=yield dU(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return yield iU(e.firebaseDependencies,r),n}catch(n){throw yield wU(e),n}}),bU.apply(this,arguments)}function OU(e,t){return kU.apply(this,arguments)}function kU(){return kU=Sw(function*(e,t){const n={token:yield uU(e,t),createTime:Date.now(),subscriptionOptions:t};return yield iU(e,n),n.token}),kU.apply(this,arguments)}function TU(e,t){return IU.apply(this,arguments)}function IU(){return IU=Sw(function*(e,t){return(yield e.pushManager.getSubscription())||e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:WF(t)})}),IU.apply(this,arguments)}function AU(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function MU(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i)}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){var n,r,i,s,o;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};const a=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(s=t.notification)||void 0===s?void 0:s.click_action;a&&(e.fcmOptions.link=a);const l=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;l&&(e.fcmOptions.analyticsLabel=l)}(t,e),t}function NU(e){return"object"==typeof e&&!!e&&$F in e}function RU(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function xU(e){return cU.create("missing-app-config-values",{valueName:e})}RU("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),RU("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class DU{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw xU("App Configuration Object");if(!e.name)throw xU("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const r of t)if(!n[r])throw xU(r);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}function LU(e){return FU.apply(this,arguments)}function FU(){return FU=Sw(function*(e){var t;try{e.swRegistration=yield navigator.serviceWorker.register(UF,{scope:VF}),e.swRegistration.update().catch(()=>{})}catch(n){throw cU.create("failed-service-worker-registration",{browserErrorMessage:null===(t=n)||void 0===t?void 0:t.message})}}),FU.apply(this,arguments)}function UU(e,t){return VU.apply(this,arguments)}function VU(){return VU=Sw(function*(e,t){if(!t&&!e.swRegistration&&(yield LU(e)),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw cU.create("invalid-sw-registration");e.swRegistration=t}}),VU.apply(this,arguments)}function BU(e,t){return $U.apply(this,arguments)}function $U(){return $U=Sw(function*(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=BF)}),$U.apply(this,arguments)}function zU(){return zU=Sw(function*(e,t){if(!navigator)throw cU.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw cU.create("permission-blocked");return yield BU(e,null==t?void 0:t.vapidKey),yield UU(e,null==t?void 0:t.serviceWorkerRegistration),_U(e)}),zU.apply(this,arguments)}function HU(e,t,n){return GU.apply(this,arguments)}function GU(){return GU=Sw(function*(e,t,n){const r=ZU(t);(yield e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[$F],message_name:n[zF],message_time:n[HF],message_device_time:Math.floor(Date.now()/1e3)})}),GU.apply(this,arguments)}function ZU(e){switch(e){case ZF.NOTIFICATION_CLICKED:return"notification_open";case ZF.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function qU(){return qU=Sw(function*(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===ZF.PUSH_RECEIVED&&("function"==typeof e.onMessageHandler?e.onMessageHandler(MU(n)):e.onMessageHandler.next(MU(n)));const r=n.data;NU(r)&&"1"===r[GF]&&(yield HU(e,n.messageType,r))}),qU.apply(this,arguments)}const WU="@firebase/messaging";function jU(){return YU.apply(this,arguments)}function YU(){return(YU=Sw(function*(){try{yield Zw()}catch{return!1}return"undefined"!=typeof window&&Gw()&&qw()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}zP(new sP("messaging",e=>{const t=new DU(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>function(e,t){return qU.apply(this,arguments)}(t,e)),t},"PUBLIC")),zP(new sP("messaging-internal",e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>function(e,t){return zU.apply(this,arguments)}(t,e)}},"PRIVATE")),KP(WU,"0.9.16"),KP(WU,"0.9.16","esm2017");const KU="analytics",QU="firebase_id",XU="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",JU="https://www.googletagmanager.com/gtag/js",eV=new gP("@firebase/analytics");function tV(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function nV(e,t){const n=document.createElement("script");n.src=`${JU}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}function rV(e,t,n,r,i,s){return iV.apply(this,arguments)}function iV(){return iV=Sw(function*(e,t,n,r,i,s){const o=r[i];try{if(o)yield t[o];else{const e=(yield tV(n)).find(e=>e.measurementId===i);e&&(yield t[e.appId])}}catch(a){eV.error(a)}e("config",i,s)}),iV.apply(this,arguments)}function sV(e,t,n,r,i){return oV.apply(this,arguments)}function oV(){return oV=Sw(function*(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=yield tV(n);for(const n of e){const e=r.find(e=>e.measurementId===n),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),yield Promise.all(s),e("event",r,i||{})}catch(s){eV.error(s)}}),oV.apply(this,arguments)}function aV(){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(JU))return t;return null}const lV=new jw("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),cV=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function uV(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function hV(e){return dV.apply(this,arguments)}function dV(){return dV=Sw(function*(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:uV(r)},s=XU.replace("{app-id}",n),o=yield fetch(s,i);if(200!==o.status&&304!==o.status){let e="";try{const n=yield o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch{}throw lV.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}),dV.apply(this,arguments)}function fV(e){return pV.apply(this,arguments)}function pV(){return pV=Sw(function*(e,t=cV,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw lV.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw lV.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new CV;return setTimeout(Sw(function*(){a.abort()}),void 0!==n?n:6e4),gV({appId:r,apiKey:i,measurementId:s},o,a,t)}),pV.apply(this,arguments)}function gV(e,t,n){return mV.apply(this,arguments)}function mV(){return mV=Sw(function*(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=cV){var s,o;const{appId:a,measurementId:l}=e;try{yield yV(r,t)}catch(c){if(l)return eV.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===(s=c)||void 0===s?void 0:s.message}]`),{appId:a,measurementId:l};throw c}try{const t=yield hV(e);return i.deleteThrottleMetadata(a),t}catch(c){const t=c;if(!vV(t)){if(i.deleteThrottleMetadata(a),l)return eV.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null==t?void 0:t.message}]`),{appId:a,measurementId:l};throw c}const s=503===Number(null===(o=null==t?void 0:t.customData)||void 0===o?void 0:o.httpStatus)?rP(n,i.intervalMillis,30):rP(n,i.intervalMillis),u={throttleEndTimeMillis:Date.now()+s,backoffCount:n+1};return i.setThrottleMetadata(a,u),eV.debug(`Calling attemptFetch again in ${s} millis`),gV(e,u,r,i)}}),mV.apply(this,arguments)}function yV(e,t){return new Promise((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener(()=>{clearTimeout(s),r(lV.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function vV(e){if(!(e instanceof Ww&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}class CV{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let _V,EV;function wV(){return wV=Sw(function*(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=yield t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}),wV.apply(this,arguments)}function PV(e){EV=e}function SV(e){_V=e}function bV(){return OV.apply(this,arguments)}function OV(){return OV=Sw(function*(){var e;if(!Gw())return eV.warn(lV.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield Zw()}catch(t){return eV.warn(lV.create("indexeddb-unavailable",{errorInfo:null===(e=t)||void 0===e?void 0:e.toString()}).message),!1}return!0}),OV.apply(this,arguments)}function kV(){return kV=Sw(function*(e,t,n,r,i,s,o){var a;const l=fV(e);l.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&eV.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(e=>eV.error(e)),t.push(l);const c=bV().then(e=>{if(e)return r.getId()}),[u,h]=yield Promise.all([l,c]);aV()||nV(s,u.measurementId),EV&&(i("consent","default",EV),PV(void 0)),i("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d.origin="firebase",d.update=!0,null!=h&&(d[QU]=h),i("config",u.measurementId,d),_V&&(i("set",_V),SV(void 0)),u.measurementId}),kV.apply(this,arguments)}class TV{constructor(e){this.app=e}_delete(){return delete IV[this.app.options.appId],Promise.resolve()}}let IV={},AV=[];const MV={};let NV,RV,xV="dataLayer",DV=!1;function LV(e,t,n){!function(){const e=[];if($w()&&e.push("This is a browser extension environment."),qw()||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>`(${t+1}) ${e}`).join(" "),n=lV.create("invalid-analytics-context",{errorInfo:t});eV.warn(n.message)}}();const r=e.options.appId;if(!r)throw lV.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw lV.create("no-api-key");eV.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=IV[r])throw lV.create("already-exists",{id:r});if(!DV){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(xV);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let s=function(...e){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=function(e,t,n,r){function i(){return(i=Sw(function*(i,s,o){try{"event"===i?yield sV(e,t,n,s,o):"config"===i?yield rV(e,t,n,r,s,o):"consent"===i?e("consent","update",o):e("set",s)}catch(a){eV.error(a)}})).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}(IV,AV,MV,xV,"gtag");RV=e,NV=t,DV=!0}return IV[r]=function(e,t,n,r,i,s,o){return kV.apply(this,arguments)}(e,AV,MV,t,NV,xV,n),new TV(e)}function FV(){return UV.apply(this,arguments)}function UV(){return(UV=Sw(function*(){if($w()||!qw()||!Gw())return!1;try{return yield Zw()}catch{return!1}})).apply(this,arguments)}const VV="@firebase/analytics";zP(new sP(KU,(e,{options:t})=>LV(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),zP(new sP("analytics-internal",function(e){try{const t=e.getProvider(KU).getImmediate();return{logEvent:(e,n,r)=>function(e,t,n,r){e=iP(e),function(e,t,n,r,i){return wV.apply(this,arguments)}(RV,IV[e.app.options.appId],t,n,r).catch(e=>eV.error(e))}(t,e,n,r)}}catch(t){throw lV.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),KP(VV,"0.8.0"),KP(VV,"0.8.0","esm2017");class BV extends a{constructor(e,t){super()}schedule(e,t=0){return this}}const $V={setInterval(...e){const{delegate:t}=$V;return((null==t?void 0:t.setInterval)||setInterval)(...e)},clearInterval(e){const{delegate:t}=$V;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0};class zV extends BV{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,n=0){return $V.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;$V.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,o(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const HV={now:()=>(HV.delegate||Date).now(),delegate:void 0};class GV{constructor(e,t=GV.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}GV.now=HV.now;class ZV extends GV{constructor(e,t=GV.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const qV=new class extends ZV{}(class extends zV{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!=n&&n>0||null==n&&this.delay>0?super.requestAsyncId(e,t,n):e.flush(this)}}),WV=new ZV(zV),jV=new Ic("7.4.1"),YV="__angularfire_symbol__analyticsIsSupportedValue",KV="__angularfire_symbol__analyticsIsSupported",QV="__angularfire_symbol__remoteConfigIsSupportedValue",XV="__angularfire_symbol__remoteConfigIsSupported",JV="__angularfire_symbol__messagingIsSupportedValue",eB="__angularfire_symbol__messagingIsSupported";function tB(e,t,n){if(t){if(1===t.length)return t[0];const e=t.filter(e=>e.app===n);if(1===e.length)return e[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[KV]||(globalThis[KV]=FV().then(e=>globalThis[YV]=e).catch(()=>globalThis[YV]=!1)),globalThis[eB]||(globalThis[eB]=jU().then(e=>globalThis[JV]=e).catch(()=>globalThis[JV]=!1)),globalThis[XV]||(globalThis[XV]=LF().then(e=>globalThis[QV]=e).catch(()=>globalThis[QV]=!1));const nB=(e,t)=>{const n=t?[t]:YP(),r=[];return n.forEach(t=>{t.container.getProvider(e).instances.forEach(e=>{r.includes(e)||r.push(e)})}),r};function rB(){}class iB{constructor(e,t=qV){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){const r=this.zone;return this.delegate.schedule(function(t){r.runGuarded(()=>{e.apply(this,[t])})},t,n)}}class sB{constructor(e){this.zone=e,this.task=null}call(e,t){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",rB,{},rB,rB)),t.pipe(Lm({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let oB=(()=>{class e{constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new iB(Zone.current)),this.insideAngular=e.run(()=>new iB(Zone.current,WV)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return e.\u0275fac=function(t){return new(t||e)(Or(mh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function aB(){const e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function lB(e){return aB().ngZone.runOutsideAngular(()=>e())}function cB(e){return aB().ngZone.run(()=>e())}function uB(e){return aB(),function(e){return function(t){return(t=t.lift(new sB(e.ngZone))).pipe(se(e.outsideAngular),ie(e.insideAngular))}}(aB())(e)}const hB=(e,t)=>{const n=void 0;return function(){const r=arguments;return t&&setTimeout(()=>{"scheduled"===t.state&&t.invoke()},10),cB(()=>e.apply(n,r))}},dB=(e,t)=>function(){let n;const r=arguments;for(let e=0;e<arguments.length;e++)"function"==typeof r[e]&&(t&&(n||(n=cB(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",rB,{},rB,rB)))),r[e]=hB(r[e],n));const i=lB(()=>e.apply(this,r));if(!t){if(i instanceof k){const e=aB();return i.pipe(se(e.outsideAngular),ie(e.insideAngular))}return cB(()=>i)}return i instanceof k?i.pipe(uB):i instanceof Promise?cB(()=>new Promise((e,t)=>i.then(t=>cB(()=>e(t)),e=>cB(()=>t(e))))):"function"==typeof i&&n?function(){return setTimeout(()=>{n&&"scheduled"===n.state&&n.invoke()},10),i.apply(this,arguments)}:cB(()=>i)};class fB{constructor(e){return e}}class pB{constructor(){return YP()}}const gB=new or("angularfire2._apps"),mB={provide:fB,useFactory:function(e){return e&&1===e.length?e[0]:new fB(jP())},deps:[[new Nr,gB]]},yB={provide:pB,deps:[[new Nr,gB]]};function vB(e){return(t,n)=>{const r=t.runOutsideAngular(()=>e(n));return new fB(r)}}let CB=(()=>{class e{constructor(e){KP("angularfire",jV.full,"core"),KP("angularfire",jV.full,"app"),KP("angular",Ac.full,e.toString())}}return e.\u0275fac=function(t){return new(t||e)(Or(th))},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[mB,yB]}),e})();const _B=dB(WP,!0),EB=new Map,wB={activated:!1,tokenObservers:[]},PB={initialized:!1,enabled:!1};function SB(e){return EB.get(e)||wB}function bB(e,t){EB.set(e,t)}function OB(){return PB}class kB{constructor(e,t,n,r,i){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return Sw(function*(){t.stop();try{t.pending=new Uw,yield function(e){return new Promise(t=>{setTimeout(t,e)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new Uw,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(n){t.retryPolicy(n)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const TB=new jw("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function IB(e){if(!SB(e).activated)throw TB.create("use-before-activation",{appName:e.name})}function AB(e,t){return MB.apply(this,arguments)}function MB(){return MB=Sw(function*({url:e,body:t},n){var r,i;const s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){const e=yield o.getHeartbeatsHeader();e&&(s["X-Firebase-Client"]=e)}const a={method:"POST",body:JSON.stringify(t),headers:s};let l,c;try{l=yield fetch(e,a)}catch(f){throw TB.create("fetch-network-error",{originalErrorMessage:null===(r=f)||void 0===r?void 0:r.message})}if(200!==l.status)throw TB.create("fetch-status-error",{httpStatus:l.status});try{c=yield l.json()}catch(f){throw TB.create("fetch-parse-error",{originalErrorMessage:null===(i=f)||void 0===i?void 0:i.message})}const u=c.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw TB.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});const h=1e3*Number(u[1]),d=Date.now();return{token:c.token,expireTimeMillis:d+h,issuedAtTimeMillis:d}}),MB.apply(this,arguments)}function NB(e,t){const{projectId:n,appId:r,apiKey:i}=e.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${n}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:t}}}const RB="firebase-app-check-store";let xB=null;function DB(){return xB||(xB=new Promise((e,t)=>{var n;try{const n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=t=>{e(t.target.result)},n.onerror=e=>{var n;t(TB.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=e=>{0===e.oldVersion&&e.target.result.createObjectStore(RB,{keyPath:"compositeKey"})}}catch(r){t(TB.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}}),xB)}function LB(){return LB=Sw(function*(e,t){const n=(yield DB()).transaction(RB,"readwrite"),r=n.objectStore(RB).put({compositeKey:e,value:t});return new Promise((e,t)=>{r.onsuccess=t=>{e()},n.onerror=e=>{var n;t(TB.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}})}),LB.apply(this,arguments)}const FB=new gP("@firebase/app-check");function UB(e,t){return Gw()?function(e,t){return function(e,t){return LB.apply(this,arguments)}(function(e){return`${e.options.appId}-${e.name}`}(e),t)}(e,t).catch(e=>{FB.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function VB(){return OB().enabled}function BB(){return $B.apply(this,arguments)}function $B(){return $B=Sw(function*(){const e=OB();if(e.enabled&&e.token)return e.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),$B.apply(this,arguments)}const zB={error:"UNKNOWN_ERROR"};function HB(e){return Lw.encodeString(JSON.stringify(e),!1)}function GB(e){return ZB.apply(this,arguments)}function ZB(){return ZB=Sw(function*(e,t=!1){const n=e.app;IB(n);const r=SB(n);let i,s=r.token;if(!s){const e=yield r.cachedTokenPromise;e&&YB(e)&&(s=e)}if(!t&&s&&YB(s))return{token:s.token};let o,a=!1;if(VB()){r.exchangeTokenPromise||(r.exchangeTokenPromise=AB(NB(n,yield BB()),e.heartbeatServiceProvider).then(e=>(r.exchangeTokenPromise=void 0,e)),a=!0);const t=yield r.exchangeTokenPromise;return yield UB(n,t),bB(n,Object.assign(Object.assign({},r),{token:t})),{token:t.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(e=>(r.exchangeTokenPromise=void 0,e)),a=!0),s=yield r.exchangeTokenPromise}catch(l){"appCheck/throttled"===l.code?FB.warn(l.message):FB.error(l),i=l}return s?(o={token:s.token},bB(n,Object.assign(Object.assign({},r),{token:s})),yield UB(n,s)):o=KB(i),a&&jB(n,o),o}),ZB.apply(this,arguments)}function qB(e,t){const n=SB(e),r=n.tokenObservers.filter(e=>e.next!==t);0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),bB(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function WB(e){const{app:t}=e,n=SB(t);let r=n.tokenRefresher;r||(r=function(e){const{app:t}=e;return new kB(Sw(function*(){let n;if(n=SB(t).token?yield GB(e,!0):yield GB(e),n.error)throw n.error}),()=>!0,()=>{const e=SB(t);if(e.token){let t=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return t=Math.min(t,e.token.expireTimeMillis-3e5),Math.max(0,t-Date.now())}return 0},3e4,96e4)}(e),bB(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function jB(e,t){const n=SB(e).tokenObservers;for(const r of n)try{"EXTERNAL"===r.type&&null!=t.error?r.error(t.error):r.next(t)}catch{}}function YB(e){return e.expireTimeMillis-Date.now()>0}function KB(e){return{token:HB(zB),error:e}}class QB{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=SB(this.app);for(const t of e)qB(this.app,t.next);return Promise.resolve()}}const XB="app-check-internal";zP(new sP("app-check",e=>function(e,t){return new QB(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider(XB).initialize()})),zP(new sP(XB,e=>function(e){return{getToken:t=>GB(e,t),addTokenListener:t=>function(e,t,n,r){const{app:i}=e,s=SB(i),o={next:n,error:r,type:t};if(bB(i,Object.assign(Object.assign({},s),{tokenObservers:[...s.tokenObservers,o]})),s.token&&YB(s.token)){const t=s.token;Promise.resolve().then(()=>{n({token:t.token}),WB(e)}).catch(()=>{})}s.cachedTokenPromise.then(()=>WB(e))}(e,"INTERNAL",t),removeTokenListener:t=>qB(e.app,t)}}(e.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),KP("@firebase/app-check","0.5.11");class JB{constructor(){return nB("app-check")}}"undefined"!=typeof window&&window;const e$=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},t$=new jw("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),n$=new gP("@firebase/auth");function r$(e,...t){n$.logLevel<=uP.ERROR&&n$.error(`Auth (9.9.0): ${e}`,...t)}function i$(e,...t){throw l$(e,...t)}function s$(e,...t){return l$(e,...t)}function o$(e,t,n){const r=Object.assign(Object.assign({},e$()),{[t]:n});return new jw("auth","Firebase",r).create(t,{appName:e.name})}function a$(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&i$(e,"argument-error"),o$(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function l$(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return t$.create(e,...t)}function c$(e,t,...n){if(!e)throw l$(t,...n)}function u$(e){const t="INTERNAL ASSERTION FAILED: "+e;throw r$(t),new Error(t)}function h$(e,t){e||u$(t)}const d$=new Map;function f$(e){h$(e instanceof Function,"Expected a class definition");let t=d$.get(e);return t?(h$(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,d$.set(e,t),t)}function p$(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function g$(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class m${constructor(e,t){this.shortDelay=e,this.longDelay=t,h$(t>e,"Short delay should be less than long delay!"),this.isMobile=Bw()||zw()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===g$()||"https:"===g$()||$w()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function y$(e,t){h$(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class v${static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void u$("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void u$("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void u$("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const C$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},_$=new m$(3e4,6e4);function E$(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function w$(e,t,n,r){return P$.apply(this,arguments)}function P$(){return P$=Sw(function*(e,t,n,r,i={}){return S$(e,i,Sw(function*(){let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=Xw(Object.assign({key:e.config.apiKey},s)).slice(1),a=yield e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),v$.fetch()(T$(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}),P$.apply(this,arguments)}function S$(e,t,n){return b$.apply(this,arguments)}function b$(){return b$=Sw(function*(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},C$),t);try{const t=new I$(e),i=yield Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=yield i.json();if("needConfirmation"in s)throw A$(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw A$(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw A$(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw A$(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw o$(e,a,o);i$(e,a)}}catch(i){if(i instanceof Ww)throw i;i$(e,"network-request-failed")}}),b$.apply(this,arguments)}function O$(e,t,n,r){return k$.apply(this,arguments)}function k$(){return k$=Sw(function*(e,t,n,r,i={}){const s=yield w$(e,t,n,r,i);return"mfaPendingCredential"in s&&i$(e,"multi-factor-auth-required",{_serverResponse:s}),s}),k$.apply(this,arguments)}function T$(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?y$(e.config,i):`${e.config.apiScheme}://${i}`}class I${constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(s$(this.auth,"network-request-failed")),_$.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function A$(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=s$(e,t,r);return i.customData._tokenResponse=n,i}function M$(){return M$=Sw(function*(e,t){return w$(e,"POST","/v1/accounts:delete",t)}),M$.apply(this,arguments)}function N$(e,t){return R$.apply(this,arguments)}function R$(){return R$=Sw(function*(e,t){return w$(e,"POST","/v1/accounts:lookup",t)}),R$.apply(this,arguments)}function x$(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}function D$(){return D$=Sw(function*(e,t=!1){const n=iP(e),r=yield n.getIdToken(t),i=F$(r);c$(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:x$(L$(i.auth_time)),issuedAtTime:x$(L$(i.iat)),expirationTime:x$(L$(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}),D$.apply(this,arguments)}function L$(e){return 1e3*Number(e)}function F$(e){var t;const[n,r,i]=e.split(".");if(void 0===n||void 0===r||void 0===i)return r$("JWT malformed, contained fewer than 3 sections"),null;try{const e=function(e){try{return Lw.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(r);return e?JSON.parse(e):(r$("Failed to decode base64 JWT payload"),null)}catch(s){return r$("Caught error parsing JWT payload as JSON",null===(t=s)||void 0===t?void 0:t.toString()),null}}function U$(e,t){return V$.apply(this,arguments)}function V$(){return V$=Sw(function*(e,t,n=!1){if(n)return t;try{return yield t}catch(r){throw r instanceof Ww&&B$(r)&&e.auth.currentUser===e&&(yield e.auth.signOut()),r}}),V$.apply(this,arguments)}function B$({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}class $${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(Sw(function*(){yield t.iteration()}),n)}iteration(){var e=this;return Sw(function*(){var t;try{yield e.user.getIdToken(!0)}catch(n){return void("auth/network-request-failed"===(null===(t=n)||void 0===t?void 0:t.code)&&e.schedule(!0))}e.schedule()})()}}class z${constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=x$(this.lastLoginAt),this.creationTime=x$(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function H$(e){return G$.apply(this,arguments)}function G$(){return G$=Sw(function*(e){var t;const n=e.auth,r=yield e.getIdToken(),i=yield U$(e,N$(n,{idToken:r}));c$(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?W$(s.providerUserInfo):[],a=q$(e.providerData,o),l=!!e.isAnonymous&&!(e.email&&s.passwordHash||(null==a?void 0:a.length)),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new z$(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(e,c)}),G$.apply(this,arguments)}function Z$(){return Z$=Sw(function*(e){const t=iP(e);yield H$(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}),Z$.apply(this,arguments)}function q$(e,t){return[...e.filter(e=>!t.some(t=>t.providerId===e.providerId)),...t]}function W$(e){return e.map(e=>{var{providerId:t}=e,n=L(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function j$(){return j$=Sw(function*(e,t){const n=yield S$(e,{},Sw(function*(){const n=Xw({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=T$(e,r,"/v1/token",`key=${i}`),o=yield e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",v$.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}),j$.apply(this,arguments)}class Y${constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){c$(e.idToken,"internal-error"),c$(void 0!==e.idToken,"internal-error"),c$(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=F$(e);return c$(t,"internal-error"),c$(void 0!==t.exp,"internal-error"),c$(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){var n=this;return Sw(function*(){return c$(!n.accessToken||n.refreshToken,e,"user-token-expired"),t||!n.accessToken||n.isExpired?n.refreshToken?(yield n.refresh(e,n.refreshToken),n.accessToken):null:n.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var n=this;return Sw(function*(){const{accessToken:r,refreshToken:i,expiresIn:s}=yield function(e,t){return j$.apply(this,arguments)}(e,t);n.updateTokensAndExpiration(r,i,Number(s))})()}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Y$;return n&&(c$("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(c$("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(c$("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Y$,this.toJSON())}_performRefresh(){return u$("not implemented")}}function K$(e,t){c$("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Q${constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=L(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new z$(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(e){var t=this;return Sw(function*(){const n=yield U$(t,t.stsTokenManager.getToken(t.auth,e));return c$(n,t.auth,"internal-error"),t.accessToken!==n&&(t.accessToken=n,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),n})()}getIdTokenResult(e){return function(e){return D$.apply(this,arguments)}(this,e)}reload(){return function(e){return Z$.apply(this,arguments)}(this)}_assign(e){this!==e&&(c$(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new Q$(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){c$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){var n=this;return Sw(function*(){let r=!1;e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield H$(n)),yield n.auth._persistUserIfCurrent(n),r&&n.auth._notifyListenersIfCurrent(n)})()}delete(){var e=this;return Sw(function*(){const t=yield e.getIdToken();return yield U$(e,function(e,t){return M$.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:C,isAnonymous:_,providerData:E,stsTokenManager:w}=t;c$(v&&w,e,"internal-error");const P=Y$.fromJSON(this.name,w);c$("string"==typeof v,e,"internal-error"),K$(u,e.name),K$(h,e.name),c$("boolean"==typeof C,e,"internal-error"),c$("boolean"==typeof _,e,"internal-error"),K$(d,e.name),K$(f,e.name),K$(p,e.name),K$(g,e.name),K$(m,e.name),K$(y,e.name);const S=new Q$({uid:v,auth:e,email:h,emailVerified:C,displayName:u,isAnonymous:_,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:P,createdAt:m,lastLoginAt:y});return E&&Array.isArray(E)&&(S.providerData=E.map(e=>Object.assign({},e))),g&&(S._redirectEventId=g),S}static _fromIdTokenResponse(e,t,n=!1){return Sw(function*(){const r=new Y$;r.updateFromServerResponse(t);const i=new Q$({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return yield H$(i),i})()}}const X$=(()=>{class e{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return Sw(function*(){return!0})()}_set(e,t){var n=this;return Sw(function*(){n.storage[e]=t})()}_get(e){var t=this;return Sw(function*(){const n=t.storage[e];return void 0===n?null:n})()}_remove(e){var t=this;return Sw(function*(){delete t.storage[e]})()}_addListener(e,t){}_removeListener(e,t){}}return e.type="NONE",e})();function J$(e,t,n){return`firebase:${e}:${t}:${n}`}class ez{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=J$(this.userKey,r.apiKey,i),this.fullPersistenceKey=J$("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return Sw(function*(){const t=yield e.persistence._get(e.fullUserKey);return t?Q$._fromJSON(e.auth,t):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return Sw(function*(){if(t.persistence===e)return;const n=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,n?t.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return Sw(function*(){if(!t.length)return new ez(f$(X$),e,n);const r=(yield Promise.all(t.map(function(){var e=Sw(function*(e){if(yield e._isAvailable())return e});return function(t){return e.apply(this,arguments)}}()))).filter(e=>e);let i=r[0]||f$(X$);const s=J$(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=yield n._get(s);if(t){const r=Q$._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch{}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&(yield i._set(s,o.toJSON())),yield Promise.all(t.map(function(){var e=Sw(function*(e){if(e!==i)try{yield e._remove(s)}catch{}});return function(t){return e.apply(this,arguments)}}())),new ez(i,e,n)):new ez(i,e,n)})()}}function tz(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(sz(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(nz(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(az(t))return"Blackberry";if(lz(t))return"Webos";if(rz(t))return"Safari";if((t.includes("chrome/")||iz(t))&&!t.includes("edge/"))return"Chrome";if(oz(t))return"Android";{const t=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==t?void 0:t.length))return t[1]}return"Other"}function nz(e=Vw()){return/firefox\//i.test(e)}function rz(e=Vw()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function iz(e=Vw()){return/crios\//i.test(e)}function sz(e=Vw()){return/iemobile/i.test(e)}function oz(e=Vw()){return/android/i.test(e)}function az(e=Vw()){return/blackberry/i.test(e)}function lz(e=Vw()){return/webos/i.test(e)}function cz(e=Vw()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function uz(e=Vw()){return cz(e)||oz(e)||lz(e)||az(e)||/windows phone/i.test(e)||sz(e)}function hz(e,t=[]){let n;switch(e){case"Browser":n=tz(Vw());break;case"Worker":n=`${tz(Vw())}-${e}`;break;default:n=e}return`${n}/JsCore/9.9.0/${t.length?t.join(","):"FirebaseCore-web"}`}class dz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(i){r(i)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return Sw(function*(){var n;if(t.auth.currentUser===e)return;const r=[];try{for(const n of t.queue)yield n(e),n.onAbort&&r.push(n.onAbort)}catch(i){r.reverse();for(const e of r)try{e()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:null===(n=i)||void 0===n?void 0:n.message})}})()}}class fz{constructor(e,t,n){this.app=e,this.heartbeatServiceProvider=t,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gz(this),this.idTokenSubscription=new gz(this),this.beforeStateQueue=new dz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=t$,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,t){var n=this;return t&&(this._popupRedirectResolver=f$(t)),this._initializationPromise=this.queue(Sw(function*(){var r,i;if(!n._deleted&&(n.persistenceManager=yield ez.create(n,e),!n._deleted)){if(null===(r=n._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch{}yield n.initializeCurrentUser(t),n.lastNotifiedUid=(null===(i=n.currentUser)||void 0===i?void 0:i.uid)||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return Sw(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUser(e){var t=this;return Sw(function*(){var n;const r=yield t.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const r=null===(n=t.redirectUser)||void 0===n?void 0:n._redirectEventId,o=null==i?void 0:i._redirectEventId,a=yield t.tryRedirectSignIn(e);(!r||r===o)&&(null==a?void 0:a.user)&&(i=a.user,s=!0)}if(!i)return t.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield t.beforeStateQueue.runMiddleware(i)}catch(o){i=r,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(o))}return i?t.reloadAndSetCurrentUserOrClear(i):t.directlySetCurrentUser(null)}return c$(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===i._redirectEventId?t.directlySetCurrentUser(i):t.reloadAndSetCurrentUserOrClear(i)})()}tryRedirectSignIn(e){var t=this;return Sw(function*(){let n=null;try{n=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(e){var t=this;return Sw(function*(){var n;try{yield H$(e)}catch(r){if("auth/network-request-failed"!==(null===(n=r)||void 0===n?void 0:n.code))return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}_delete(){var e=this;return Sw(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return Sw(function*(){const n=e?iP(e):null;return n&&c$(n.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(n&&n._clone(t))})()}_updateCurrentUser(e,t=!1){var n=this;return Sw(function*(){if(!n._deleted)return e&&c$(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),t||(yield n.beforeStateQueue.runMiddleware(e)),n.queue(Sw(function*(){yield n.directlySetCurrentUser(e),n.notifyAuthListeners()}))})()}signOut(){var e=this;return Sw(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var t=this;return this.queue(Sw(function*(){yield t.assertedPersistence.setPersistence(f$(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new jw("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){var n=this;return Sw(function*(){const r=yield n.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return Sw(function*(){if(!t.redirectPersistenceManager){const n=e&&f$(e)||t._popupRedirectResolver;c$(n,t,"argument-error"),t.redirectPersistenceManager=yield ez.create(t,[f$(n._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return Sw(function*(){var n,r;return t._isInitialized&&(yield t.queue(Sw(function*(){}))),(null===(n=t._currentUser)||void 0===n?void 0:n._redirectEventId)===e?t._currentUser:(null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId)===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return Sw(function*(){if(e===t.currentUser)return t.queue(Sw(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return c$(s,this,"internal-error"),s.then(()=>i(this.currentUser)),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}directlySetCurrentUser(e){var t=this;return Sw(function*(){t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return c$(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hz(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return Sw(function*(){var t;const n={"X-Client-Version":e.clientVersion};e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId);const r=yield null===(t=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();return r&&(n["X-Firebase-Client"]=r),n})()}}function pz(e){return iP(e)}class gz{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new tP(e,void 0);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return c$(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class mz{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return u$("not implemented")}_getIdTokenResponse(e){return u$("not implemented")}_linkToIdToken(e,t){return u$("not implemented")}_getReauthenticationResolver(e){return u$("not implemented")}}function yz(){return yz=Sw(function*(e,t){return w$(e,"POST","/v1/accounts:update",t)}),yz.apply(this,arguments)}function vz(){return vz=Sw(function*(e,t){return O$(e,"POST","/v1/accounts:signInWithPassword",E$(e,t))}),vz.apply(this,arguments)}function Cz(e,t){return _z.apply(this,arguments)}function _z(){return _z=Sw(function*(e,t){return w$(e,"POST","/v1/accounts:sendOobCode",E$(e,t))}),_z.apply(this,arguments)}function Ez(e,t){return wz.apply(this,arguments)}function wz(){return wz=Sw(function*(e,t){return Cz(e,t)}),wz.apply(this,arguments)}function Pz(e,t){return Sz.apply(this,arguments)}function Sz(){return Sz=Sw(function*(e,t){return Cz(e,t)}),Sz.apply(this,arguments)}function bz(){return bz=Sw(function*(e,t){return O$(e,"POST","/v1/accounts:signInWithEmailLink",E$(e,t))}),bz.apply(this,arguments)}function Oz(){return Oz=Sw(function*(e,t){return O$(e,"POST","/v1/accounts:signInWithEmailLink",E$(e,t))}),Oz.apply(this,arguments)}class kz extends mz{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new kz(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new kz(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){var t=this;return Sw(function*(){switch(t.signInMethod){case"password":return function(e,t){return vz.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password});case"emailLink":return function(e,t){return bz.apply(this,arguments)}(e,{email:t._email,oobCode:t._password});default:i$(e,"internal-error")}})()}_linkToIdToken(e,t){var n=this;return Sw(function*(){switch(n.signInMethod){case"password":return function(e,t){return yz.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password});case"emailLink":return function(e,t){return Oz.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password});default:i$(e,"internal-error")}})()}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}function Tz(e,t){return Iz.apply(this,arguments)}function Iz(){return Iz=Sw(function*(e,t){return O$(e,"POST","/v1/accounts:signInWithIdp",E$(e,t))}),Iz.apply(this,arguments)}class Az extends mz{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Az(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):i$("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=L(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Az(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Tz(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Tz(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Tz(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Xw(t)}return e}}class Mz{constructor(e){var t,n,r,i,s,o;const a=Jw(eP(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);c$(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=Jw(eP(e)).link,n=t?Jw(eP(t)).deep_link_id:null,r=Jw(eP(e)).deep_link_id;return(r?Jw(eP(r)).link:null)||r||n||t||e}(e);try{return new Mz(t)}catch{return null}}}let Nz=(()=>{class e{constructor(){this.providerId=e.PROVIDER_ID}static credential(e,t){return kz._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Mz.parseLink(t);return c$(n,"argument-error"),kz._fromEmailAndCode(e,n.code,n.tenantId)}}return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e})();class Rz{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class xz extends Rz{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let Dz=(()=>{class e extends xz{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return Az._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return e.credentialFromTaggedObject(t)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return e.credential(n,r)}catch{return null}}}return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e})();function Lz(e,t){return Fz.apply(this,arguments)}function Fz(){return Fz=Sw(function*(e,t){return O$(e,"POST","/v1/accounts:signUp",E$(e,t))}),Fz.apply(this,arguments)}class Uz{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,r=!1){return Sw(function*(){const i=yield Q$._fromIdTokenResponse(e,n,r),s=Vz(n);return new Uz({user:i,providerId:s,_tokenResponse:n,operationType:t})})()}static _forOperation(e,t,n){return Sw(function*(){yield e._updateTokensIfNecessary(n,!0);const r=Vz(n);return new Uz({user:e,providerId:r,_tokenResponse:n,operationType:t})})()}}function Vz(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Bz extends Ww{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Bz.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Bz(e,t,n,r)}}function $z(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{throw"auth/multi-factor-auth-required"===n.code?Bz._fromErrorAndOperation(e,n,t,r):n})}function zz(e,t){return Hz.apply(this,arguments)}function Hz(){return Hz=Sw(function*(e,t,n=!1){const r=yield U$(e,t._linkToIdToken(e.auth,yield e.getIdToken()),n);return Uz._forOperation(e,"link",r)}),Hz.apply(this,arguments)}function Gz(){return Gz=Sw(function*(e,t,n=!1){var r;const{auth:i}=e,s="reauthenticate";try{const r=yield U$(e,$z(i,s,t,e),n);c$(r.idToken,i,"internal-error");const o=F$(r.idToken);c$(o,i,"internal-error");const{sub:a}=o;return c$(e.uid===a,i,"user-mismatch"),Uz._forOperation(e,s,r)}catch(o){throw"auth/user-not-found"===(null===(r=o)||void 0===r?void 0:r.code)&&i$(i,"user-mismatch"),o}}),Gz.apply(this,arguments)}function Zz(e,t){return qz.apply(this,arguments)}function qz(){return qz=Sw(function*(e,t,n=!1){const r="signIn",i=yield $z(e,r,t),s=yield Uz._fromIdTokenResponse(e,r,i);return n||(yield e._updateCurrentUser(s.user)),s}),qz.apply(this,arguments)}function Wz(){return Wz=Sw(function*(e,t){return Zz(pz(e),t)}),Wz.apply(this,arguments)}function jz(e,t,n){var r;c$((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),c$(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(c$(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(c$(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function Yz(e,t,n){return Kz.apply(this,arguments)}function Kz(){return Kz=Sw(function*(e,t,n){const r=iP(e),i={requestType:"PASSWORD_RESET",email:t};n&&jz(r,i,n),yield Pz(r,i)}),Kz.apply(this,arguments)}function Qz(e,t,n){return Xz.apply(this,arguments)}function Xz(){return Xz=Sw(function*(e,t,n){const r=pz(e),i=yield Lz(r,{returnSecureToken:!0,email:t,password:n}),s=yield Uz._fromIdTokenResponse(r,"signIn",i);return yield r._updateCurrentUser(s.user),s}),Xz.apply(this,arguments)}function Jz(e,t,n){return function(e,t){return Wz.apply(this,arguments)}(iP(e),Nz.credential(t,n))}function eH(e,t){return tH.apply(this,arguments)}function tH(){return tH=Sw(function*(e,t){const n=iP(e),r={requestType:"VERIFY_EMAIL",idToken:yield e.getIdToken()};t&&jz(n.auth,r,t);const{email:i}=yield Ez(n.auth,r);i!==e.email&&(yield e.reload())}),tH.apply(this,arguments)}function nH(e,t){return rH.apply(this,arguments)}function rH(){return rH=Sw(function*(e,t){return w$(e,"POST","/v1/accounts:update",t)}),rH.apply(this,arguments)}function iH(e,t){return sH.apply(this,arguments)}function sH(){return sH=Sw(function*(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const r=iP(e),i={idToken:yield r.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},s=yield U$(r,nH(r.auth,i));r.displayName=s.displayName||null,r.photoURL=s.photoUrl||null;const o=r.providerData.find(({providerId:e})=>"password"===e);o&&(o.displayName=r.displayName,o.photoURL=r.photoURL),yield r._updateTokensIfNecessary(s)}),sH.apply(this,arguments)}function oH(e,t,n,r){return iP(e).onAuthStateChanged(t,n,r)}new WeakMap;const aH="__sak";class lH{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(aH,"1"),this.storage.removeItem(aH),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const cH=(()=>{class e extends lH{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=Vw();return rz(e)||cz(e)}()&&function(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=uz(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);!t&&this.localCache[n]===e||this.notifyListeners(n,e)},i=this.storage.getItem(n);Hw()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,t){var n=()=>super._set,r=this;return Sw(function*(){yield n().call(r,e,t),r.localCache[e]=JSON.stringify(t)})()}_get(e){var t=()=>super._get,n=this;return Sw(function*(){const r=yield t().call(n,e);return n.localCache[e]=JSON.stringify(r),r})()}_remove(e){var t=()=>super._remove,n=this;return Sw(function*(){yield t().call(n,e),delete n.localCache[e]})()}}return e.type="LOCAL",e})(),uH=(()=>{class e extends lH{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}return e.type="SESSION",e})();let hH=(()=>{class e{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(e=>e.isListeningto(t));if(n)return n;const r=new e(t);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}handleEvent(e){var t=this;return Sw(function*(){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=t.handlersMap[i];if(!(null==o?void 0:o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(function(){var e=Sw(function*(e){return e(n.origin,s)});return function(t){return e.apply(this,arguments)}}()),l=yield function(e){return Promise.all(e.map(function(){var e=Sw(function*(e){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}});return function(t){return e.apply(this,arguments)}}()))}(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})})()}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return e.receivers=[],e})();function dH(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}class fH{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){var r=this;return Sw(function*(){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=dH("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(t.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"))}}},r.handlers.add(o),i.port1.addEventListener("message",o.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{o&&r.removeMessageHandler(o)})})()}}function pH(){return window}function gH(){return void 0!==pH().WorkerGlobalScope&&"function"==typeof pH().importScripts}function mH(){return(mH=Sw(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const yH="firebaseLocalStorageDb",vH="firebaseLocalStorage",CH="fbase_key";class _H{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function EH(e,t){return e.transaction([vH],t?"readwrite":"readonly").objectStore(vH)}function wH(){const e=indexedDB.open(yH,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(vH,{keyPath:CH})}catch(r){n(r)}}),e.addEventListener("success",Sw(function*(){const n=e.result;n.objectStoreNames.contains(vH)?t(n):(n.close(),yield function(){const e=indexedDB.deleteDatabase(yH);return new _H(e).toPromise()}(),t(yield wH()))}))})}function PH(e,t,n){return SH.apply(this,arguments)}function SH(){return SH=Sw(function*(e,t,n){const r=EH(e,!0).put({[CH]:t,value:n});return new _H(r).toPromise()}),SH.apply(this,arguments)}function bH(){return bH=Sw(function*(e,t){const n=EH(e,!1).get(t),r=yield new _H(n).toPromise();return void 0===r?null:r.value}),bH.apply(this,arguments)}function OH(e,t){const n=EH(e,!0).delete(t);return new _H(n).toPromise()}const kH=(()=>{class e{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return Sw(function*(){return e.db||(e.db=yield wH()),e.db})()}_withRetries(e){var t=this;return Sw(function*(){let n=0;for(;;)try{const n=yield t._openDb();return yield e(n)}catch(r){if(n++>3)throw r;t.db&&(t.db.close(),t.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return Sw(function*(){return gH()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return Sw(function*(){e.receiver=hH._getInstance(gH()?self:null),e.receiver._subscribe("keyChanged",function(){var t=Sw(function*(t,n){return{keyProcessed:(yield e._poll()).includes(n.key)}});return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=Sw(function*(e,t){return["keyChanged"]});return function(t,n){return e.apply(this,arguments)}}())})()}initializeSender(){var e=this;return Sw(function*(){var t,n;if(e.activeServiceWorker=yield function(){return mH.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new fH(e.activeServiceWorker);const r=yield e.sender._send("ping",{},800);!r||(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var t=this;return Sw(function*(){if(t.sender&&t.activeServiceWorker&&function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===t.activeServiceWorker)try{yield t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return Sw(function*(){try{if(!indexedDB)return!1;const e=yield wH();return yield PH(e,aH,"1"),yield OH(e,aH),!0}catch{}return!1})()}_withPendingWrite(e){var t=this;return Sw(function*(){t.pendingWrites++;try{yield e()}finally{t.pendingWrites--}})()}_set(e,t){var n=this;return Sw(function*(){return n._withPendingWrite(Sw(function*(){return yield n._withRetries(n=>PH(n,e,t)),n.localCache[e]=t,n.notifyServiceWorker(e)}))})()}_get(e){var t=this;return Sw(function*(){const n=yield t._withRetries(t=>function(e,t){return bH.apply(this,arguments)}(t,e));return t.localCache[e]=n,n})()}_remove(e){var t=this;return Sw(function*(){return t._withPendingWrite(Sw(function*(){return yield t._withRetries(t=>OH(t,e)),delete t.localCache[e],t.notifyServiceWorker(e)}))})()}_poll(){var e=this;return Sw(function*(){const t=yield e._withRetries(e=>{const t=EH(e,!1).getAll();return new _H(t).toPromise()});if(!t)return[];if(0!==e.pendingWrites)return[];const n=[],r=new Set;for(const{fbase_key:i,value:s}of t)r.add(i),JSON.stringify(e.localCache[i])!==JSON.stringify(s)&&(e.notifyListeners(i,s),n.push(i));for(const i of Object.keys(e.localCache))e.localCache[i]&&!r.has(i)&&(e.notifyListeners(i,null),n.push(i));return n})()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(Sw(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return e.type="LOCAL",e})();function TH(e){return`__${e}${Math.floor(1e6*Math.random())}`}function IH(e,t){return t?f$(t):(c$(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}TH("rcb"),new m$(3e4,6e4);class AH extends mz{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Tz(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Tz(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Tz(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function MH(e){return Zz(e.auth,new AH(e),e.bypassAuthState)}function NH(e){const{auth:t,user:n}=e;return c$(n,t,"internal-error"),function(e,t){return Gz.apply(this,arguments)}(n,new AH(e),e.bypassAuthState)}function RH(e){return xH.apply(this,arguments)}function xH(){return xH=Sw(function*(e){const{auth:t,user:n}=e;return c$(n,t,"internal-error"),zz(n,new AH(e),e.bypassAuthState)}),xH.apply(this,arguments)}class DH{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=Sw(function*(t,n){e.pendingPromise={resolve:t,reject:n};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(r){e.reject(r)}});return function(e,n){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return Sw(function*(){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o)return void t.reject(o);const l={auth:t.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(a)(l))}catch(c){t.reject(c)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return MH;case"linkViaPopup":case"linkViaRedirect":return RH;case"reauthViaPopup":case"reauthViaRedirect":return NH;default:i$(this.auth,"internal-error")}}resolve(e){h$(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){h$(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const LH=new m$(2e3,1e4);function FH(e,t,n){return UH.apply(this,arguments)}function UH(){return UH=Sw(function*(e,t,n){const r=pz(e);a$(e,t,Rz);const i=IH(r,n);return new VH(r,"signInViaPopup",t,i).executeNotNull()}),UH.apply(this,arguments)}let VH=(()=>{class e extends DH{constructor(t,n,r,i,s){super(t,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,e.currentPopupAction&&e.currentPopupAction.cancel(),e.currentPopupAction=this}executeNotNull(){var e=this;return Sw(function*(){const t=yield e.execute();return c$(t,e.auth,"internal-error"),t})()}onExecution(){var e=this;return Sw(function*(){h$(1===e.filter.length,"Popup operations only handle one event");const t=dH();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],t),e.authWindow.associatedEvent=t,e.resolver._originValidation(e.auth).catch(t=>{e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,t=>{t||e.reject(s$(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(s$(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,e.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;this.pollId=(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(s$(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(e,LH.get())};e()}}return e.currentPopupAction=null,e})();const BH=new Map;class $H extends DH{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){var e=()=>super.execute,t=this;return Sw(function*(){let n=BH.get(t.auth._key());if(!n){try{const r=(yield function(e,t){return zH.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;n=()=>Promise.resolve(r)}catch(r){n=()=>Promise.reject(r)}BH.set(t.auth._key(),n)}return t.bypassAuthState||BH.set(t.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,n=this;return Sw(function*(){if("signInViaRedirect"===e.type)return t().call(n,e);if("unknown"!==e.type){if(e.eventId){const r=yield n.auth._redirectUserForId(e.eventId);if(r)return n.user=r,t().call(n,e);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return Sw(function*(){})()}cleanUp(){}}function zH(){return zH=Sw(function*(e,t){const n=ZH(t),r=GH(e);if(!(yield r._isAvailable()))return!1;const i="true"===(yield r._get(n));return yield r._remove(n),i}),zH.apply(this,arguments)}function HH(e,t){BH.set(e._key(),t)}function GH(e){return f$(e._redirectPersistence)}function ZH(e){return J$("pendingRedirect",e.config.apiKey,e.name)}function qH(e,t){return WH.apply(this,arguments)}function WH(){return WH=Sw(function*(e,t,n=!1){const r=pz(e),i=IH(r,t),s=yield new $H(r,i,n).execute();return s&&!n&&(delete s.user._redirectEventId,yield r._persistUserIfCurrent(s.user),yield r._setRedirectUser(null,t)),s}),WH.apply(this,arguments)}class jH{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return KH(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!KH(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(s$(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(YH(e))}saveEventToCache(e){this.cachedEventUids.add(YH(e)),this.lastProcessedEventTime=Date.now()}}function YH(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function KH({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}function QH(e){return XH.apply(this,arguments)}function XH(){return XH=Sw(function*(e,t={}){return w$(e,"GET","/v1/projects",t)}),XH.apply(this,arguments)}const JH=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,eG=/^https?/;function tG(){return tG=Sw(function*(e){if(e.config.emulator)return;const{authorizedDomains:t}=yield QH(e);for(const n of t)try{if(nG(n))return}catch{}i$(e,"unauthorized-domain")}),tG.apply(this,arguments)}function nG(e){const t=p$(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!eG.test(n))return!1;if(JH.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const rG=new m$(3e4,6e4);function iG(){const e=pH().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}let sG=null;function oG(e){return sG=sG||function(e){return new Promise((t,n)=>{var r,i,s;function o(){iG(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{iG(),n(s$(e,"network-request-failed"))},timeout:rG.get()})}if(null===(i=null===(r=pH().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=pH().gapi)||void 0===s?void 0:s.load)){const t=TH("iframefcb");return pH()[t]=()=>{gapi.load?o():n(s$(e,"network-request-failed"))},function(e){return new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=s$("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}(`https://apis.google.com/js/api.js?onload=${t}`).catch(e=>n(e))}o()}}).catch(e=>{throw sG=null,e})}(e),sG}const aG=new m$(5e3,15e3),lG={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cG=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uG(e){const t=e.config;c$(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?y$(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:qP},i=cG.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Xw(r).slice(1)}`}function hG(){return hG=Sw(function*(e){const t=yield oG(e),n=pH().gapi;return c$(n,e,"internal-error"),t.open({where:document.body,url:uG(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:lG,dontclear:!0},t=>new Promise(function(){var n=Sw(function*(n,r){yield t.restyle({setHideOnLeave:!1});const i=s$(e,"network-request-failed"),s=pH().setTimeout(()=>{r(i)},aG.get());function o(){pH().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})});return function(e,t){return n.apply(this,arguments)}}()))}),hG.apply(this,arguments)}const dG={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class fG{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pG(e,t,n,r,i,s){c$(e.config.authDomain,e,"auth-domain-config-required"),c$(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:qP,eventId:i};if(t instanceof Rz){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof xz){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const l of Object.keys(a))void 0===a[l]&&delete a[l];return`${function({config:e}){return e.emulator?y$(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${Xw(a).slice(1)}`}const gG="webStorageSupport",mG=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=uH,this._completeRedirectFn=qH,this._overrideRedirectResult=HH}_openPopup(e,t,n,r){var i=this;return Sw(function*(){var s;h$(null===(s=i.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");const o=pG(e,t,n,p$(),r);return function(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},dG),{width:r.toString(),height:i.toString(),top:s,left:o}),c=Vw().toLowerCase();n&&(a=iz(c)?"_blank":n),nz(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=Vw()){var t;return cz(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new fG(null);const h=window.open(t||"",a,u);c$(h,e,"popup-blocked");try{h.focus()}catch{}return new fG(h)}(e,o,dH())})()}_openRedirect(e,t,n,r){var i=this;return Sw(function*(){return yield i._originValidation(e),function(e){pH().location.href=e}(pG(e,t,n,p$(),r)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(h$(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){var t=this;return Sw(function*(){const n=yield function(e){return hG.apply(this,arguments)}(e),r=new jH(e);return n.register("authEvent",t=>(c$(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:r.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:r},t.iframes[e._key()]=n,r})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(gG,{type:gG},n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[gG];void 0!==i&&t(!!i),i$(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return tG.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return uz()||rz()||cz()}};var yG="@firebase/auth";class vG{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var t=this;return Sw(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){c$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function CG(e=jP()){const t=HP(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){const n=HP(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Kw(n.getOptions(),t??{}))return e;i$(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:mG,persistence:[kH,cH,uH]})}!function(e){zP(new sP("auth",(t,{options:n})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),{apiKey:s,authDomain:o}=r.options;return((t,r)=>{c$(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),c$(!(null==o?void 0:o.includes(":")),"argument-error",{appName:t.name});const i={apiKey:s,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hz(e)},a=new fz(t,r,i);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(f$);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(a,n),a})(r,i)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),zP(new sP("auth-internal",e=>{const t=pz(e.getProvider("auth").getImmediate());return new vG(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),KP(yG,"0.20.5",void 0),KP(yG,"0.20.5","esm2017")}("Browser");class _G{constructor(e){return e}}class EG{constructor(){return nB("auth")}}const wG=new or("angularfire2.auth-instances");function PG(e){return(t,n)=>{const r=t.runOutsideAngular(()=>e(n));return new _G(r)}}const SG={provide:EG,deps:[[new Nr,wG]]},bG={provide:_G,useFactory:function(e,t){const n=tB("auth",e,t);return n&&new _G(n)},deps:[[new Nr,wG],fB]};let OG=(()=>{class e{constructor(){KP("angularfire",jV.full,"auth")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[bG,SG]}),e})();const kG=dB(Qz,!0),TG=dB(CG,!0),IG=dB(oH,!0),AG=dB(eH,!0),MG=dB(Yz,!0),NG=dB(Jz,!0),RG=dB(FH,!0),xG=dB(iH,!0);class DG{constructor(e){return e}}const LG=new or("angularfire2.firestore-instances");function FG(e){return(t,n)=>{const r=t.runOutsideAngular(()=>e(n));return new DG(r)}}const UG={provide:class{constructor(){return nB("firestore")}},deps:[[new Nr,LG]]},VG={provide:DG,useFactory:function(e,t){const n=tB("firestore",e,t);return n&&new DG(n)},deps:[[new Nr,LG],fB]};let BG=(()=>{class e{constructor(){KP("angularfire",jV.full,"fst")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[VG,UG]}),e})();const $G=dB(dL,!0),zG=dB(lD,!0),HG=dB(hL,!0),GG=dB(cD,!0),ZG=dB(oL,!0),qG=dB(lL,!0),WG=dB(fD,!0),jG=dB(tL,!0),YG=dB(fL,!0),KG=dB(JD,!0),QG=dB(YD,!0),XG=dB(cL,!0),JG=dB(uL,!0),eZ=dB(QD,!0);let tZ=(()=>{class e{constructor(e,t){this.collectionName=e,this.firestore=t,this.subDAOs={};this.collection=zG(t,this.collectionName).withConverter({fromFirestore:e=>e.data(),toFirestore:e=>e})}create(t){var n=this;return Sw(function*(){return Ow(e.VERBOSE,{called:n.collectionName+".create",newElement:t}),(yield $G(n.collection,t)).id})()}read(t){var n=this;return Sw(function*(){Ow(e.VERBOSE,{called:n.collectionName+".read",id:t});const r=yield ZG(GG(n.collection,t));return r.exists()?Aw.of(bw.getNonNullable(r.data())):Aw.empty()})()}exists(t){var n=this;return Sw(function*(){return Ow(e.VERBOSE,{called:n.collectionName+".exists",id:t}),(yield n.read(t)).isPresent()})()}update(t,n){var r=this;return Sw(function*(){return Ow(e.VERBOSE,{called:r.collectionName+".update",id:t,update:n}),JG(GG(r.collection,t),n)})()}delete(t){return Ow(e.VERBOSE,{called:this.collectionName+".delete",id:t}),HG(GG(this.collection,t))}set(t,n){return Ow(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),XG(GG(this.collection,t),n)}subscribeToChanges(e,t){return new a(YG(GG(this.collection,e),e=>{t(Aw.ofNullable(e.data()))}))}findWhere(e,t,n){var r=this;return Sw(function*(){const i=r.constructQuery(e,t,n);return(yield qG(i)).docs.map(e=>({id:e.id,data:e.data()}))})()}observingWhere(t,n,r){Ow(e.VERBOSE,{called:this.collectionName+".observingWhere"});const i=this.constructQuery(t,r);return new a(YG(i,t=>{const r=[],i=[],s=[];t.docChanges().forEach(e=>{const t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":i.push(t);break;case"removed":s.push(t)}}),r.length>0&&(Ow(e.VERBOSE,"firebase gave us "+r.length+" NEW "+this.collectionName),n.onDocumentCreated(r)),i.length>0&&(Ow(e.VERBOSE,"firebase gave us "+i.length+" MODIFIED "+this.collectionName),n.onDocumentModified(i)),s.length>0&&(Ow(e.VERBOSE,"firebase gave us "+s.length+" DELETED "+this.collectionName),n.onDocumentDeleted(s))}))}constructQuery(e,t,n){let r=QG(this.collection);null!=t&&(r=QG(r,KG(t))),null!=n&&(r=QG(r,jG(n)));for(const i of e)r=QG(r,eZ(i[0],i[1],i[2]));return r}subCollectionDAO(t,n){const r=`${this.collection.path}/${t}/${n}`;if(r in this.subDAOs)return this.subDAOs[r];{const t=new class extends e{constructor(e){super(r,e)}}(this.firestore);return this.subDAOs[r]=t,t}}}return e.VERBOSE=!1,e})(),nZ=(()=>{class e extends tZ{constructor(t){super("chats",t),Ow(e.VERBOSE,"ChatDAO.constructor")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(DG))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),rZ=(()=>{class e{}return e.CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`,e.FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`,e})(),iZ=(()=>{class e{constructor(t){this.chatDAO=t,Ow(e.VERBOSE,"ChatService.constructor")}addMessage(e,t){var n=this;return Sw(function*(){return n.chatDAO.subCollectionDAO(e,"messages").create(t)})()}getLastMessages(e,t){var n=this;return Sw(function*(){return n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t)})()}subscribeToMessages(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}deleteChat(t){var n=this;return Sw(function*(){return Ow(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)})()}createNewChat(e){var t=this;return Sw(function*(){return t.chatDAO.set(e,{})})()}sendMessage(e,t,n,r){var i=this;return Sw(function*(){if(!1===i.userCanSendMessage(t.name,e))return xw.failure(rZ.CANNOT_SEND_MESSAGE());if(i.isForbiddenMessage(n))return xw.failure(rZ.FORBIDDEN_MESSAGE());const s={content:n,sender:t,postedTime:mL(),currentTurn:r};return yield i.addMessage(e,s),xw.SUCCESS})()}userCanSendMessage(e,t){return""!==e}isForbiddenMessage(e){return""===e}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(nZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),sZ=(()=>{class e extends tZ{constructor(e){super("errors",e)}}return e.\u0275fac=function(t){return new(t||e)(Or(DG))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var oZ=n(5378);let aZ=(()=>{class e{infoMessage(e){this.message(e,"is-info")}gameMessage(e){this.message(e,"is-warning")}criticalMessage(e){this.message(e,"is-danger")}message(e,t){(0,oZ.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class lZ{constructor(e,t,n){this.errorDAO=e,this.router=t,this.messageDisplayer=n,lZ.setSingletonInstance(this)}static setSingletonInstance(e){lZ.singleton=Aw.of(e)}static logErrorAndFail(e,t,n){throw lZ.logError(e,t,n),new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`)}static logError(e,t,n){if(this.singleton.isAbsent())throw new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`);return this.singleton.get().logError(e,t,n),xw.failure(e+": "+t)}findErrors(e,t,n,r){return this.errorDAO.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}logError(e,t,n){var r=this;return Sw(function*(){r.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const i=r.router.url,s=yield r.findErrors(e,i,t,n);if(0===s.length){const s={component:e,route:i,message:t,firstEncounter:mL(),lastEncounter:mL(),occurences:1};null!=n&&(s.data=n),yield r.errorDAO.create(s)}else{const e=s[0].id,t=s[0].data;yield r.errorDAO.update(e,{lastEncounter:mL(),occurences:t.occurences+1})}})()}}function cZ(e,t){if(!1===e)throw lZ.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}lZ.singleton=Aw.empty(),lZ.\u0275fac=function(e){return new(e||lZ)(Or(sZ),Or(fC),Or(aZ))},lZ.\u0275prov=Pe({token:lZ,factory:lZ.\u0275fac,providedIn:"root"});let uZ=(()=>{class e extends tZ{constructor(t){super(e.COLLECTION_NAME,t),Ow(e.VERBOSE,"UserDAO.constructor")}}return e.VERBOSE=!1,e.COLLECTION_NAME="users",e.\u0275fac=function(t){return new(t||e)(Or(DG))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),hZ=(()=>{class e{constructor(e){this.userDAO=e}usernameIsAvailable(e){var t=this;return Sw(function*(){return 0===(yield t.userDAO.findWhere([["username","==",e]])).length})()}setUsername(e,t){var n=this;return Sw(function*(){yield n.userDAO.update(e,{username:t})})()}markAsVerified(e){var t=this;return Sw(function*(){yield t.userDAO.update(e,{verified:!0})})()}observeUser(e,t){return this.userDAO.subscribeToChanges(e,t)}getUserLastUpdateTime(e){var t=this;return Sw(function*(){const n=yield t.userDAO.read(e);if(n.isAbsent())return Aw.empty();{const e=n.get().lastUpdateTime;return cZ(null!=e,"should not receive a lastUpdateTime equal to null"),Aw.of(e)}})()}updatePresenceToken(e){return this.userDAO.update(e,{lastUpdateTime:mL()})}}return e.\u0275fac=function(t){return new(t||e)(Or(uZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class dZ extends A{constructor(e=1/0,t=1/0,n=HV){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:i,_windowTime:s}=this;t||(n.push(e),!r&&n.push(i.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,i=r.slice();for(let s=0;s<i.length&&!e.closed;s+=n?1:2)e.next(i[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){const e=t.now();let r=0;for(let t=1;t<n.length&&n[t]<=e;t+=2)r=t;r&&n.splice(0,r+1)}}}class fZ{static createUserWithEmailAndPassword(e,t,n){return kG(e,t,n)}static sendEmailVerification(e){return AG(e)}static sendPasswordResetEmail(e,t){return MG(e,t)}static signInWithEmailAndPassword(e,t,n){return Sw(function*(){return(yield NG(e,t,n)).user})()}static signInWithPopup(e,t){return Sw(function*(){return(yield RG(e,t)).user})()}static updateProfile(e,t){return xG(e,t)}}class pZ{constructor(e,t,n,r){this.id=e,this.email=t,this.username=n,this.verified=r}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}}pZ.NOT_CONNECTED=new pZ("",Aw.empty(),Aw.empty(),!1);let gZ=(()=>{class e{constructor(t,n,r){var i=this;this.userDAO=t,this.userService=n,this.auth=r,this.user=Aw.empty(),this.userSubscription=new a,Ow(e.VERBOSE,"ConnectedUserService constructor"),this.userRS=new dZ(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new a(IG(this.auth,function(){var t=Sw(function*(t){null==t?(Ow(e.VERBOSE,"User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(pZ.NOT_CONNECTED),i.user=Aw.empty()):(cZ(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(t.uid,n=>{if(n.isPresent()){const r=n.get().username;Ow(e.VERBOSE,`User ${r} is connected, and the verified status is ${i.emailVerified(t)}`);const s=!0===i.emailVerified(t)&&null!=r;if(!0===s&&!1===n.get().verified)return i.userService.markAsVerified(t.uid);const o=new pZ(t.uid,Aw.ofNullable(t.email),Aw.ofNullable(r),s);i.user=Aw.of(o),i.userRS.next(o)}}))});return function(e){return t.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var t=this;return Sw(function*(){try{return yield fZ.sendPasswordResetEmail(t.auth,e),xw.SUCCESS}catch(n){return xw.failure(t.mapFirebaseError(n))}})()}doRegister(t,n,r){var i=this;return Sw(function*(){return Ow(e.VERBOSE,"ConnectedUserService.doRegister("+n+")"),(yield i.userService.usernameIsAvailable(t))?i.registerAfterUsernameCheck(t,n,r):Mw.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,t,n){var r=this;return Sw(function*(){try{const i=yield fZ.createUserWithEmailAndPassword(r.auth,t,n);yield fZ.signInWithEmailAndPassword(r.auth,t,n);const s=bw.getNonNullable(i.user);return yield r.createUser(s.uid,e),Mw.success(s)}catch(i){return Mw.failure(r.mapFirebaseError(i))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return lZ.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var t=this;return Sw(function*(){Ow(e.VERBOSE,"ConnectedUserService.sendEmailVerification()");const n=Aw.ofNullable(t.auth.currentUser);if(!n.isPresent())return lZ.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(t.emailVerified(n.get()))return lZ.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield fZ.sendEmailVerification(n.get()),xw.SUCCESS}catch(r){return xw.failure(t.mapFirebaseError(r))}})()}doEmailLogin(t,n){var r=this;return Sw(function*(){Ow(e.VERBOSE,"ConnectedUserService.doEmailLogin("+t+")");try{return yield fZ.signInWithEmailAndPassword(r.auth,t,n),xw.SUCCESS}catch(i){return xw.failure(r.mapFirebaseError(i))}})()}createUser(e,t){var n=this;return Sw(function*(){null==t?yield n.userDAO.set(e,{verified:!1}):yield n.userDAO.set(e,{username:t,verified:!1})})()}doGoogleLogin(){var e=this;return Sw(function*(){return xw.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return Sw(function*(){try{const t=new Dz;t.addScope("profile"),t.addScope("email");const n=yield fZ.signInWithPopup(e.auth,t);return!1===(yield e.userDAO.exists(n.uid))&&(yield e.createUser(n.uid)),Mw.success(n)}catch(t){return Mw.failure(e.mapFirebaseError(t))}})()}disconnect(){var e=this;return Sw(function*(){return Aw.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),xw.SUCCESS):xw.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var t=this;return Sw(function*(){if(""===e)return xw.failure($localize`Your username may not be empty.`);try{if(!1===(yield t.userService.usernameIsAvailable(e)))return xw.failure($localize`This username is already in use, please select a different one.`);const n=bw.getNonNullable(t.auth.currentUser);return yield fZ.updateProfile(n,{displayName:e}),yield t.userService.setUsername(n.uid,e),yield t.userService.markAsVerified(n.uid),yield t.reloadUser(),xw.SUCCESS}catch(n){return xw.failure(t.mapFirebaseError(n))}})()}setPicture(e){var t=this;return Sw(function*(){try{const n=bw.getNonNullable(t.auth.currentUser);return yield fZ.updateProfile(n,{photoURL:e}),xw.SUCCESS}catch(n){return xw.failure(t.mapFirebaseError(n))}})()}reloadUser(){var e=this;return Sw(function*(){const t=bw.getNonNullable(e.auth.currentUser);yield t.getIdToken(!0),yield t.reload()})()}updateObservedPart(e){return cZ(this.user.isPresent(),"Should not call updateObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:e})}removeObservedPart(){return cZ(this.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:null})}sendPresenceToken(){return cZ(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(uZ),Or(hZ),Or(_G))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class mZ{constructor(e){this.value=e}}mZ.HARD_DRAW=new mZ(0),mZ.RESIGN=new mZ(1),mZ.ESCAPE=new mZ(2),mZ.VICTORY=new mZ(3),mZ.TIMEOUT=new mZ(4),mZ.UNACHIEVED=new mZ(5),mZ.AGREED_DRAW_BY_ZERO=new mZ(6),mZ.AGREED_DRAW_BY_ONE=new mZ(7);class yZ{constructor(e,t){this.id=e,this.data=t}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===mZ.HARD_DRAW.value}isAgreedDraw(){return this.data.result===mZ.AGREED_DRAW_BY_ZERO.value||this.data.result===mZ.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===mZ.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(cZ(this.data.result===mZ.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),bw.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===mZ.VICTORY.value}isTimeout(){return this.data.result===mZ.TIMEOUT.value}isResign(){return this.data.result===mZ.RESIGN.value}getWinner(){return Aw.ofNullable(this.data.winner)}getLoser(){return Aw.ofNullable(this.data.loser)}setWinnerAndLoser(e,t){return new yZ(this.id,{...this.data,winner:e,loser:t})}}class vZ{constructor(e){this.value=e}static of(e){switch(e){case"CREATOR":return vZ.CREATOR;case"RANDOM":return vZ.RANDOM;default:return cZ("CHOSEN_PLAYER"===e,"Invalid value for FirstPlayer: "+e+"."),vZ.CHOSEN_PLAYER}}}vZ.CREATOR=new vZ("CREATOR"),vZ.RANDOM=new vZ("RANDOM"),vZ.CHOSEN_PLAYER=new vZ("CHOSEN_PLAYER");class CZ{constructor(e){this.value=e}static of(e){switch(e){case"STANDARD":return CZ.STANDARD;case"BLITZ":return CZ.BLITZ;case"CUSTOM":return CZ.CUSTOM;default:throw new Error("Invalid part type: "+e+".")}}}CZ.STANDARD=new CZ("STANDARD"),CZ.BLITZ=new CZ("BLITZ"),CZ.CUSTOM=new CZ("CUSTOM"),CZ.NORMAL_MOVE_DURATION=120,CZ.NORMAL_PART_DURATION=1800,CZ.BLITZ_MOVE_DURATION=30,CZ.BLITZ_PART_DURATION=900;class _Z{constructor(e){this.value=e}}_Z.PART_CREATED=new _Z(0),_Z.CONFIG_PROPOSED=new _Z(2),_Z.PART_STARTED=new _Z(3),_Z.PART_FINISHED=new _Z(4);class EZ{}class wZ extends EZ{static disjunction3(e,t,n,r,i){return new class extends wZ{encodeMove(s){return r(s)?{type:"T1",encoded:e.encode(s)}:i(s)?{type:"T2",encoded:t.encode(s)}:{type:"T3",encoded:n.encode(s)}}decodeMove(r){const i=bw.getNonNullable(r).type,s=bw.getNonNullable(r).encoded;return"T1"===i?e.decode(s):"T2"===i?t.decode(s):n.decode(s)}}}encode(e){return this.encodeMove(e)}decode(e){return cZ(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}class PZ extends wZ{static ofN(e,t,n){return new class extends PZ{maxValue(){return e}encodeNumber(e){return t(e)}decodeNumber(e){return n(e)}}}static tuple(e,t,n){return new class extends PZ{maxValue(){let t=0;return Object.keys(e).forEach(n=>{t=t*e[n].shift()+e[n].maxValue()}),t}encodeNumber(n){const r=t(n);let i=0;return Object.keys(r).forEach(t=>{i=i*e[t].shift()+e[t].encode(r[t])}),i}decodeNumber(t){const r={};let i=t;return Object.keys(e).reverse().forEach(t=>{const n=i%e[t].shift();i=(i-n)/e[t].shift(),r[t]=e[t].decode(n)}),n(r)}}}static disjunction(e,t,n){return new class extends PZ{maxValue(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}encodeNumber(r){return n(r)?2*e.encodeNumber(r):2*t.encodeNumber(r)+1}decodeNumber(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}}static numberEncoder(e){return new class extends PZ{maxValue(){return e}encodeNumber(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}decodeNumber(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}}shift(){return this.maxValue()+1}encodeMove(e){return this.encodeNumber(e)}decodeMove(e){return cZ("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}PZ.booleanEncoder=new class extends PZ{maxValue(){return 1}encodeNumber(e){return e?1:0}decodeNumber(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}};class SZ{constructor(){this.value=2}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(e){return this===e}}SZ.NONE=new SZ;class bZ{constructor(e){this.value=e}static of(e){return 0===e?bZ.ZERO:(bw.expectToBe(e,1),bZ.ONE)}static fromTurn(e){return e%2==0?bZ.ZERO:bZ.ONE}isPlayer(){return!0}toString(){return this===bZ.ZERO?"PLAYER_ZERO":(bw.expectToBe(this,bZ.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(e){return this===e}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===bZ.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===bZ.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===bZ.ZERO?bZ.ONE:(bw.expectToBe(this,bZ.ONE),bZ.ZERO)}}var OZ;bZ.numberEncoder=PZ.ofN(2,e=>e.value,e=>2===e?OZ.NONE:bZ.of(e)),bZ.ZERO=new bZ(0),bZ.ONE=new bZ(1),bZ.PLAYERS=[bZ.ZERO,bZ.ONE],function(e){e.ZERO=bZ.ZERO,e.ONE=bZ.ONE,e.NONE=SZ.NONE}(OZ||(OZ={}));class kZ{static rematchAccepted(e,t){return TZ("RematchAccepted",{typeGame:e,partId:t})}static getPlayer(e){return bZ.of(bw.getNonNullable(e.data).player)}static getTypeGame(e){return bw.getNonNullable(e.data).typeGame}static getPartId(e){return bw.getNonNullable(e.data).partId}}function TZ(e,t){return{code:e,data:t}}function IZ(e){return t=>TZ(e,{player:t.value})}kZ.drawProposed=IZ("DrawProposed"),kZ.drawAccepted=TZ("DrawAccepted",{}),kZ.drawRefused=IZ("DrawRefused"),kZ.takeBackAsked=IZ("TakeBackAsked"),kZ.takeBackRefused=IZ("TakeBackRefused"),kZ.takeBackAccepted=IZ("TakeBackAccepted"),kZ.rematchProposed=IZ("RematchProposed"),kZ.addTurnTime=IZ("AddTurnTime"),kZ.addGlobalTime=IZ("AddGlobalTime");class AZ{static mapBiArray(e,t){const n=[];let r=0;for(;r<e.length;){n[r]=[];let i=0;for(;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}static createTable(e,t,n){const r=[];let i=t-1;for(;i>=0;){r[i]=[];let t=e-1;for(;t>=0;)r[i][t]=n,t--;i--}return r}static copyBiArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=AZ.copyImmutableArray(e[n]),n++;return t}static copyImmutableArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=e[n],n++;return t}static sortByDescending(e,t){e.sort((e,n)=>{const r=t(e),i=t(n);return r<i?1:r>i?-1:0})}static compareArray(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===Iw(e[n],t[n]))return!1;return!0}static compareTable(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===AZ.compareArray(e[n],t[n]))return!1;return!0}}let MZ=(()=>{class e extends tZ{constructor(t){super("parts",t),Ow(e.VERBOSE,"PartDAO.constructor")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(DG))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class NZ{constructor(e,t,n){this.onDocumentCreated=e,this.onDocumentModified=t,this.onDocumentDeleted=n}}let RZ=(()=>{class e extends tZ{constructor(t){super("config-room",t),Ow(e.VERBOSE,"ConfigRoomDAO.constructor")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(DG))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),xZ=(()=>{class e{constructor(t,n){this.configRoomDAO=t,this.connectedUserService=n,Ow(e.VERBOSE,"ConfigRoomService.constructor")}addCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}removeCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}subscribeToChanges(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}subscribeToCandidates(e,t){let n=[];const r=new NZ(e=>{for(const t of e)n.push(t.data);t(n)},e=>{for(const t of e)n=n.map(e=>e.id===t.data.id?t.data:e);t(n)},e=>{for(const t of e)n=n.filter(e=>e.id!==t.data.id);t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],r)}createInitialConfigRoom(t){var n=this;return Sw(function*(){Ow(e.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+t+")");const r=n.connectedUserService.user.get().toMinimalUser();return n.configRoomDAO.set(t,{chosenOpponent:null,firstPlayer:vZ.RANDOM.value,partType:CZ.STANDARD.value,partStatus:_Z.PART_CREATED.value,maximalMoveDuration:CZ.NORMAL_MOVE_DURATION,totalPartDuration:CZ.NORMAL_PART_DURATION,creator:r})})()}joinGame(t){var n=this;return Sw(function*(){Ow(e.VERBOSE,"ConfigRoomService.joinGame("+t+")");const r=n.connectedUserService.user.get().toMinimalUser(),i=yield n.configRoomDAO.read(t);return i.isAbsent()?xw.failure(e.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==r.id&&(yield n.addCandidate(t,r)),xw.SUCCESS)})()}cancelJoining(t){var n=this;return Sw(function*(){Ow(e.VERBOSE,`ConfigRoomService.cancelJoining(${t})`);const r=n.connectedUserService.user.get().toMinimalUser(),i=yield n.configRoomDAO.read(t);if(!i.isAbsent()){const e=i.get(),s=[n.removeCandidate(t,r)];e.chosenOpponent?.id===r.id&&s.push(n.configRoomDAO.update(t,{chosenOpponent:null,partStatus:_Z.PART_CREATED.value})),yield Promise.all(s)}})()}deleteConfigRoom(t,n){var r=this;return Sw(function*(){Ow(e.VERBOSE,`ConfigRoomService.deleteConfigRoom(${t}`),yield Promise.all(n.map(e=>r.removeCandidate(t,e))),yield r.configRoomDAO.delete(t)})()}proposeConfig(t,n,r,i,s,o){var a=this;return Sw(function*(){return Ow(e.VERBOSE,{configRoomService_proposeConfig:{configRoomId:t,maximalMoveDuration:i,firstPlayer:s,totalPartDuration:o}}),a.configRoomDAO.update(t,{partStatus:_Z.CONFIG_PROPOSED.value,chosenOpponent:n,partType:r.value,maximalMoveDuration:i,totalPartDuration:o,firstPlayer:s.value})})()}setChosenOpponent(t,n){return Ow(e.VERBOSE,`ConfigRoomService.setChosenOpponent(${t}, ${n.name})`),this.configRoomDAO.update(t,{chosenOpponent:n})}reviewConfig(t){var n=this;return Sw(function*(){return Ow(e.VERBOSE,`ConfigRoomService.reviewConfig(${t})`),n.configRoomDAO.update(t,{partStatus:_Z.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(t){var n=this;return Sw(function*(){return Ow(e.VERBOSE,`ConfigRoomService.reviewConfigAndRemoveChosenOpponent(${t})`),n.configRoomDAO.update(t,{partStatus:_Z.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(t){return Ow(e.VERBOSE,`ConfigRoomService.acceptConfig(${t}`),this.configRoomDAO.update(t,{partStatus:_Z.PART_STARTED.value})}createConfigRoom(t,n){var r=this;return Sw(function*(){return Ow(e.VERBOSE,`ConfigRoomService.create(${t}`+JSON.stringify(n)+")"),r.configRoomDAO.set(t,n)})()}readConfigRoomById(t){var n=this;return Sw(function*(){return Ow(e.VERBOSE,`ConfigRoomService.readConfigRoomById(${t})`),(yield n.configRoomDAO.read(t)).get()})()}}return e.VERBOSE=!1,e.GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`,e.\u0275fac=function(t){return new(t||e)(Or(RZ),Or(gZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),DZ=(()=>{class e{constructor(t,n,r,i){this.partDAO=t,this.connectedUserService=n,this.configRoomService=r,this.chatService=i,Ow(e.VERBOSE,"GameService.constructor")}updateAndBumpIndex(e,t,n,r){var i=this;return Sw(function*(){return r={...r,lastUpdate:{index:n+1,player:t.value}},i.partDAO.update(e,r)})()}getPartValidity(e,t){var n=this;return Sw(function*(){const r=yield n.partDAO.read(e);return r.isAbsent()?xw.failure("NONEXISTENT_PART"):r.get().typeGame===t?xw.SUCCESS:xw.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(t){Ow(e.VERBOSE,"GameService.createPart("+t+")");const n=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:t,playerZero:n,turn:-1,result:mZ.UNACHIEVED.value,listMoves:[]})}createChat(t){return Ow(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}createPartConfigRoomAndChat(t){var n=this;return Sw(function*(){Ow(e.VERBOSE,`GameService.createGame(${t})`);const r=yield n.createUnstartedPart(t);return yield n.configRoomService.createInitialConfigRoom(r),yield n.createChat(r),r})()}startGameWithConfig(t,n,r,i){Ow(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));const s=this.getStartingConfig(i);return this.updateAndBumpIndex(t,n,r,s)}getStartingConfig(e){let t,n,r=vZ.of(e.firstPlayer);return r===vZ.RANDOM&&(r=Math.random()<.5?vZ.CREATOR:vZ.CHOSEN_PLAYER),r===vZ.CREATOR?(t=e.creator,n=bw.getNonNullable(e.chosenOpponent)):(t=bw.getNonNullable(e.chosenOpponent),n=e.creator),{playerZero:t,playerOne:n,turn:0,beginning:mL(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}deletePart(t){return Ow(e.VERBOSE,"GameService.deletePart("+t+")"),this.partDAO.delete(t)}acceptConfig(t,n){var r=this;return Sw(function*(){return Ow(e.VERBOSE,{gameService_acceptConfig:{partId:t,configRoom:n}}),yield r.configRoomService.acceptConfig(t),r.startGameWithConfig(t,bZ.ONE,0,n)})()}subscribeToChanges(e,t){return this.partDAO.subscribeToChanges(e,t)}resign(e,t,n,r,i){return this.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:mZ.RESIGN.value,request:null})}notifyTimeout(e,t,n,r,i){return this.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:mZ.TIMEOUT.value,request:null})}sendRequest(e,t,n,r){return this.updateAndBumpIndex(e,t,n,{request:r})}proposeDraw(e,t,n){return this.sendRequest(e,n,t,kZ.drawProposed(n))}acceptDraw(e,t,n){return this.updateAndBumpIndex(e,n,t,{result:(n===bZ.ZERO?mZ.AGREED_DRAW_BY_ZERO:mZ.AGREED_DRAW_BY_ONE).value,request:null})}refuseDraw(e,t,n){return this.sendRequest(e,n,t,kZ.drawRefused(n))}proposeRematch(e,t,n){return this.sendRequest(e,n,t,kZ.rematchProposed(n))}acceptRematch(t,n,r){var i=this;return Sw(function*(){Ow(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t});const s=bw.getNonNullable(t.data),o=yield i.configRoomService.readConfigRoomById(t.id);let a;const l=i.connectedUserService.user.get().toMinimalUser();let c;s.playerZero.id===l.id?(c=bw.getNonNullable(s.playerOne),a=vZ.CHOSEN_PLAYER):(c=s.playerZero,a=vZ.CREATOR);const u={...o,firstPlayer:a.value,creator:l,chosenOpponent:c,partStatus:_Z.PART_STARTED.value},h=i.getStartingConfig(u),d={lastUpdate:{index:0,player:r.value},typeGame:s.typeGame,result:mZ.UNACHIEVED.value,listMoves:[],...h},f=yield i.partDAO.create(d);return yield i.configRoomService.createConfigRoom(f,u),yield i.createChat(f),i.sendRequest(t.id,r,n,kZ.rematchAccepted(s.typeGame,f))})()}askTakeBack(e,t,n){return this.sendRequest(e,n,t,kZ.takeBackAsked(n))}acceptTakeBack(e,t,n,r){var i=this;return Sw(function*(){cZ(kZ.getPlayer(bw.getNonNullable(t.data.request))!==n,"Illegal to accept your own request");const s=kZ.takeBackAccepted(n);let o=t.data.listMoves.slice(0,t.data.listMoves.length-1);o.length%2===n.value&&(o=o.slice(0,o.length-1));const a={request:s,listMoves:o,turn:o.length,lastUpdateTime:mL(),remainingMsForZero:bw.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:bw.getNonNullable(t.data.remainingMsForOne)-r[1]},l=t.data.lastUpdate.index;return yield i.updateAndBumpIndex(e,n,l,a)})()}refuseTakeBack(e,t,n){const r=kZ.takeBackRefused(n);return this.updateAndBumpIndex(e,n,t,{request:r})}addGlobalTime(e,t,n,r){var i=this;return Sw(function*(){let s={request:kZ.addGlobalTime(r.getOpponent())};return s=r===bZ.ZERO?{...s,remainingMsForOne:bw.getNonNullable(n.remainingMsForOne)+3e5}:{...s,remainingMsForZero:bw.getNonNullable(n.remainingMsForZero)+3e5},yield i.updateAndBumpIndex(e,r,t,s)})()}addTurnTime(e,t,n){var r=this;return Sw(function*(){const i={request:kZ.addTurnTime(e.getOpponent())};return yield r.updateAndBumpIndex(n,e,t,i)})()}updateDBBoard(t,n,r,i,s,o,a,l){var c=this;return Sw(function*(){Ow(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:s,msToSubstract:i,notifyDraw:o,winner:a,loser:l}});const u=(yield c.partDAO.read(t)).get(),h=u.lastUpdate.index,d=u.turn+1,f=AZ.copyImmutableArray(u.listMoves);f[f.length]=r;let p={listMoves:f,turn:d,request:null,lastUpdateTime:mL()};return p=c.updateScore(p,s),p=c.substractMs(p,u,i),null!=a?p={...p,winner:a,loser:l,result:mZ.VICTORY.value}:!0===o&&(p={...p,result:mZ.HARD_DRAW.value}),yield c.updateAndBumpIndex(t,n,h,p)})()}updateScore(e,t){return void 0!==t?{...e,scorePlayerZero:t[0],scorePlayerOne:t[1]}:e}substractMs(e,t,n){return n[0]>0?{...e,remainingMsForZero:bw.getNonNullable(t.remainingMsForZero)-n[0]}:n[1]>0?{...e,remainingMsForOne:bw.getNonNullable(t.remainingMsForOne)-n[1]}:e}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(MZ),Or(gZ),Or(xZ),Or(iZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var LZ={prefix:"fab",iconName:"facebook",icon:[512,512,[],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},FZ={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},UZ={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class VZ{static getNavigatorLanguage(){return navigator.language}static getLocale(){const e=(localStorage.getItem("locale")??VZ.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(t=>t===e)?e:"fr"}}let BZ=(()=>{class e{changeTheme(e){localStorage.setItem("theme",e)}getTheme(){return Aw.ofNullable(localStorage.getItem("theme"))}changeLanguage(e){localStorage.setItem("locale",e.toLowerCase())}getLanguage(){return VZ.getLocale()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),$Z=(()=>{class e{constructor(e,t){this.document=e,this.userSettingsService=t,this.availableThemes=["dark","light"];const n=this.getStoredTheme();n.isPresent()?this.loadTheme(n.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const e=this.userSettingsService.getTheme();if(e.isPresent()){const t=e.get();if(this.availableThemes.some(e=>e===t))return Aw.of(t)}return Aw.empty()}loadTheme(e){this.loadStyle(e+".css"),this.theme=e}loadStyle(e){const t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{const n=this.document.createElement("link");n.id="theme",n.rel="stylesheet",n.href=`${e}`,t.appendChild(n)}}getTheme(){return this.theme}}return e.\u0275fac=function(t){return new(t||e)(Or(jh),Or(BZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var zZ={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},HZ={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},GZ={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},ZZ={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},qZ={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},WZ={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]},jZ={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"]};function YZ(e){return(YZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function QZ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){QZ(e,t,n[t])})}return e}function JZ(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(l){i=!0,s=l}finally{try{!r&&null!=a.return&&a.return()}finally{if(i)throw s}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var eq={},tq={};try{"undefined"!=typeof window&&(eq=window),"undefined"!=typeof document&&(tq=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch{}var nq=(eq.navigator||{}).userAgent,rq=void 0===nq?"":nq,iq=eq,sq=tq,oq=!!sq.documentElement&&!!sq.head&&"function"==typeof sq.addEventListener&&"function"==typeof sq.createElement,aq=(~rq.indexOf("MSIE")||rq.indexOf("Trident/"),"___FONT_AWESOME___"),lq="svg-inline--fa",cq=[1,2,3,4,5,6,7,8,9,10],uq=cq.concat([11,12,13,14,15,16,17,18,19,20]),hq={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},dq=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",hq.GROUP,hq.SWAP_OPACITY,hq.PRIMARY,hq.SECONDARY].concat(cq.map(function(e){return"".concat(e,"x")})).concat(uq.map(function(e){return"w-".concat(e)})),iq.FontAwesomeConfig||{});sq&&"function"==typeof sq.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=JZ(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=sq.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(dq[n]=r)});var fq=XZ({},{familyPrefix:"fa",replacementClass:lq,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},dq);fq.autoReplaceSvg||(fq.observeMutations=!1);var pq=XZ({},fq);iq.FontAwesomeConfig=pq;var gq=iq||{};gq[aq]||(gq[aq]={}),gq[aq].styles||(gq[aq].styles={}),gq[aq].hooks||(gq[aq].hooks={}),gq[aq].shims||(gq[aq].shims=[]);var mq=gq[aq],yq=[];oq&&((sq.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(sq.readyState)||sq.addEventListener("DOMContentLoaded",function e(){sq.removeEventListener("DOMContentLoaded",e),yq.map(function(e){return e()})}));var vq,Cq="pending",_q="fulfilled",Eq="rejected",wq=function(){},Pq="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,Sq="undefined"==typeof setImmediate?setTimeout:setImmediate,bq=[];function Oq(){for(var e=0;e<bq.length;e++)bq[e][0](bq[e][1]);bq=[],vq=!1}function kq(e,t){bq.push([e,t]),vq||(vq=!0,Sq(Oq,0))}function Tq(e){var t=e.owner,n=t._state,r=t._data,i=e[n],s=e.then;if("function"==typeof i){n=_q;try{r=i(r)}catch(o){Nq(s,o)}}Iq(s,r)||(n===_q&&Aq(s,r),n===Eq&&Nq(s,r))}function Iq(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===YZ(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?Mq(e,r):Aq(e,r))},function(t){n||(n=!0,Nq(e,t))}),!0}}catch(i){return n||Nq(e,i),!0}return!1}function Aq(e,t){(e===t||!Iq(e,t))&&Mq(e,t)}function Mq(e,t){e._state===Cq&&(e._state="settled",e._data=t,kq(xq,e))}function Nq(e,t){e._state===Cq&&(e._state="settled",e._data=t,kq(Dq,e))}function Rq(e){e._then=e._then.forEach(Tq)}function xq(e){e._state=_q,Rq(e)}function Dq(e){e._state=Eq,Rq(e),!e._handled&&Pq&&global.process.emit("unhandledRejection",e._data,e)}function Lq(e){global.process.emit("rejectionHandled",e)}function Fq(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof Fq))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){Nq(t,e)}try{e(function(e){Aq(t,e)},n)}catch(r){n(r)}}(e,this)}Fq.prototype={constructor:Fq,_state:Cq,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(wq),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===Eq&&Pq&&kq(Lq,this)),this._state===_q||this._state===Eq?kq(Tq,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},Fq.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new Fq(function(t,n){var r=[],i=0;function s(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,a=0;a<e.length;a++)(o=e[a])&&"function"==typeof o.then?o.then(s(a),n):r[a]=o;i||t(r)})},Fq.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new Fq(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},Fq.resolve=function(e){return e&&"object"===YZ(e)&&e.constructor===Fq?e:new Fq(function(t){t(e)})},Fq.reject=function(e){return new Fq(function(t,n){n(e)})};var Uq={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function Vq(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function Bq(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function $q(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function zq(e){return e.size!==Uq.size||e.x!==Uq.x||e.y!==Uq.y||e.rotate!==Uq.rotate||e.flipX||e.flipY}function Hq(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),s="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(s," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var Gq={x:0,y:0,width:"100%",height:"100%"};function Zq(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function qq(e){return"g"===e.tag?e.children:[e]}function Wq(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,s=e.iconName,o=e.transform,a=e.symbol,l=e.title,c=e.maskId,u=e.titleId,h=e.extra,d=e.watchable,f=void 0!==d&&d,p=r.found?r:n,g=p.width,m=p.height,y="fak"===i,v=y?"":"fa-w-".concat(Math.ceil(g/m*16)),C=[pq.replacementClass,s?"".concat(pq.familyPrefix,"-").concat(s):"",v].filter(function(e){return-1===h.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(h.classes).join(" "),_={children:[],attributes:XZ({},h.attributes,{"data-prefix":i,"data-icon":s,class:C,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(g," ").concat(m)})},E=y&&!~h.classes.indexOf("fa-fw")?{width:"".concat(g/m*16*.0625,"em")}:{};f&&(_.attributes["data-fa-i2svg"]=""),l&&_.children.push({tag:"title",attributes:{id:_.attributes["aria-labelledby"]||"title-".concat(u||Vq())},children:[l]});var w=XZ({},_,{prefix:i,iconName:s,main:n,mask:r,maskId:c,transform:o,symbol:a,styles:XZ({},E,h.styles)}),P=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,s=e.maskId,o=r.icon,a=i.icon,l=Hq({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:XZ({},Gq,{fill:"white"})},u=o.children?{children:o.children.map(Zq)}:{},h={tag:"g",attributes:XZ({},l.inner),children:[Zq(XZ({tag:o.tag,attributes:XZ({},o.attributes,l.path)},u))]},d={tag:"g",attributes:XZ({},l.outer),children:[h]},f="mask-".concat(s||Vq()),p="clip-".concat(s||Vq()),g={tag:"mask",attributes:XZ({},Gq,{id:f,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,d]},m={tag:"defs",children:[{tag:"clipPath",attributes:{id:p},children:qq(a)},g]};return t.push(m,{tag:"rect",attributes:XZ({fill:"currentColor","clip-path":"url(#".concat(p,")"),mask:"url(#".concat(f,")")},Gq)}),{children:t,attributes:n}}(w):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,s=$q(e.styles);if(s.length>0&&(n.style=s),zq(i)){var o=Hq({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:XZ({},o.outer),children:[{tag:"g",attributes:XZ({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:XZ({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(w),S=P.attributes;return w.children=P.children,w.attributes=S,a?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:XZ({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(pq.familyPrefix,"-").concat(t):r}),children:n}]}]}(w):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,s=e.styles,o=e.transform;if(zq(o)&&n.found&&!r.found){var a={x:n.width/n.height/2,y:.5};i.style=$q(XZ({},s,{"transform-origin":"".concat(a.x+o.x/16,"em ").concat(a.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(w)}var jq=function(e,t,n,r){var i,s,o,a=Object.keys(e),l=a.length,c=void 0!==r?function(e,t){return function(n,r,i,s){return e.call(t,n,r,i,s)}}(t,r):t;for(void 0===n?(i=1,o=e[a[0]]):(i=0,o=n);i<l;i++)o=c(o,e[s=a[i]],s,e);return o};function Yq(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,s=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof mq.hooks.addPack||i?mq.styles[e]=XZ({},mq.styles[e]||{},s):mq.hooks.addPack(e,s),"fas"===e&&Yq("fa",t)}var Kq=mq.styles,Qq=mq.shims,Xq=function(){var e=function(e){return jq(Kq,function(t,n,r){return t[r]=jq(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in Kq;jq(Qq,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function Jq(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function eW(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,s=void 0===i?[]:i;return"string"==typeof e?Bq(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(Bq(e[n]),'" ')},"").trim()}(r),">").concat(s.map(eW).join(""),"</").concat(t,">")}Xq();function tW(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}(tW.prototype=Object.create(Error.prototype)).constructor=tW;var nW={fill:"currentColor"},rW={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},iW=(XZ({},nW,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),XZ({},rW,{attributeName:"opacity"}));function sW(e){var t=e[0],n=e[1],r=JZ(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(pq.familyPrefix,"-").concat(hq.GROUP)},children:[{tag:"path",attributes:{class:"".concat(pq.familyPrefix,"-").concat(hq.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(pq.familyPrefix,"-").concat(hq.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}XZ({},nW,{cx:"256",cy:"364",r:"28"}),XZ({},rW,{attributeName:"r",values:"28;14;28;28;14;28;"}),XZ({},iW,{values:"1;0;1;1;0;1;"}),XZ({},nW,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),XZ({},iW,{values:"1;0;0;0;0;1;"}),XZ({},nW,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),XZ({},iW,{values:"0;0;1;1;0;0;"});var oW=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&KZ(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=XZ({},e.definitions[t]||{},i[t]),Yq(t,i[t]),Xq()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,s=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][s]=o}),e}}]),e}();function aW(){pq.autoAddCss&&!hW&&(function(e){if(e&&oq){var t=sq.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=sq.head.childNodes,r=null,i=n.length-1;i>-1;i--){var s=n[i],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=s)}sq.head.insertBefore(t,r)}}(function(){var e="fa",t=lq,n=pq.familyPrefix,r=pq.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var s=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),a=new RegExp("\\.".concat(t),"g");i=i.replace(s,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(a,".".concat(r))}return i}()),hW=!0)}function lW(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return eW(e)})}}),Object.defineProperty(e,"node",{get:function(){if(oq){var t=sq.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function cW(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return Jq(uW.definitions,n,r)||Jq(mq.styles,n,r)}var uW=new oW,hW=!1,dW=function(e){return function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(e)},fW=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:cW(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:cW(i||{})),e(r,XZ({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?Uq:n,i=t.symbol,s=void 0!==i&&i,o=t.mask,a=void 0===o?null:o,l=t.maskId,c=void 0===l?null:l,u=t.title,h=void 0===u?null:u,d=t.titleId,f=void 0===d?null:d,p=t.classes,g=void 0===p?[]:p,m=t.attributes,y=void 0===m?{}:m,v=t.styles,C=void 0===v?{}:v;if(e){var _=e.prefix,E=e.iconName,w=e.icon;return lW(XZ({type:"icon"},e),function(){return aW(),pq.autoA11y&&(h?y["aria-labelledby"]="".concat(pq.replacementClass,"-title-").concat(f||Vq()):(y["aria-hidden"]="true",y.focusable="false")),Wq({icons:{main:sW(w),mask:a?sW(a.icon):{found:!1,width:null,height:null,icon:{}}},prefix:_,iconName:E,transform:XZ({},Uq,r),symbol:s,title:h,maskId:c,titleId:f,extra:{attributes:y,styles:C,classes:g}})})}});const pW=["*"],gW=e=>{const t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip,[`fa-${e.size}`]:null!==e.size,[`fa-rotate-${e.rotate}`]:null!==e.rotate,[`fa-pull-${e.pull}`]:null!==e.pull,[`fa-stack-${e.stackItemSize}`]:null!=e.stackItemSize};return Object.keys(t).map(e=>t[e]?e:null).filter(e=>e)};let mW=(()=>{class e{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),yW=(()=>{class e{constructor(){this.definitions={}}addIcons(...e){for(const t of e){t.prefix in this.definitions||(this.definitions[t.prefix]={}),this.definitions[t.prefix][t.iconName]=t;for(const e of t.icon[2])"string"==typeof e&&(this.definitions[t.prefix][e]=t)}}addIconPacks(...e){for(const t of e){const e=Object.keys(t).map(e=>t[e]);this.addIcons(...e)}}getIconDefinition(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),vW=(()=>{class e{constructor(){this.stackItemSize="1x"}ngOnChanges(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=st({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[vt]}),e})(),CW=(()=>{class e{constructor(e,t){this.renderer=e,this.elementRef=t}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${e.size.currentValue}`),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${e.size.previousValue}`))}}return e.\u0275fac=function(t){return new(t||e)(ua(Oc),ua(Pc))},e.\u0275cmp=Je({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[vt],ngContentSelectors:pW,decls:1,vars:0,template:function(e,t){1&e&&(function(e){const t=zt()[16][6];if(!t.projection){const n=t.projection=fr(e?e.length:1,null),r=n.slice();let i=t.child;for(;null!==i;){const t=e?ba(i,e):0;null!==t&&(r[t]?r[t].projectionNext=i:n[t]=i,r[t]=i),i=i.next}}}(),function(e,t=0,n){const r=zt(),i=Ht(),s=Fs(i,20+e,16,null,n||null);null===s.projection&&(s.projection=t),Kt(),64!=(64&s.flags)&&function(e,t,n){hs(t[11],0,t,n,Wi(e,n,t),Ji(n.parent||t[6],n,t))}(i,r,s)}(0))},encapsulation:2}),e})(),_W=(()=>{class e{constructor(e,t,n,r,i){this.sanitizer=e,this.config=t,this.iconLibrary=n,this.stackItem=r,this.classes=[],null!=i&&null==r&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(e){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let t=null;if(t=this.icon??this.config.fallbackIcon,e){const e=this.findIconDefinition(t);if(null!=e){const t=this.buildParams();this.renderIcon(e,t)}}}render(){this.ngOnChanges({})}findIconDefinition(e){const t=((e,t)=>(e=>void 0!==e.prefix&&void 0!==e.iconName)(e)?e:Array.isArray(e)&&2===e.length?{prefix:e[0],iconName:e[1]}:"string"==typeof e?{prefix:t,iconName:e}:void 0)(e,this.config.defaultPrefix);return"icon"in t?t:this.iconLibrary.getIconDefinition(t.prefix,t.iconName)??((e=>{throw new Error(`Could not find icon with iconName=${e.iconName} and prefix=${e.prefix} in the icon library.`)})(t),null)}buildParams(){const e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?dW(this.transform):this.transform;return{title:this.title,transform:t,classes:[...gW(e),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(e,t){const n=fW(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}return e.\u0275fac=function(t){return new(t||e)(ua(Uf),ua(mW),ua(yW),ua(vW,8),ua(CW,8))},e.\u0275cmp=Je({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(nl("innerHTML",t.renderedIconHTML,vi),ra("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[vt],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})(),EW=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({}),e})();function wW(e,t){if(1&e&&(ma(0),ga(1,"fa-icon",24),ya()),2&e){const e=Sa();ks(1),ha("icon",e.faSpinner)}}function PW(e,t){if(1&e){const e=va();ma(0),fa(1,"div",9),fa(2,"a",10),Qa(3),pa(),fa(4,"div",12),fa(5,"a",26),Ea("click",function(){return Gt(e),Sa(2).logout()}),sc(6,27),pa(),pa(),pa(),ya()}if(2&e){const e=Sa(2);ks(3),Xa(e.username.get())}}const SW=function(){return["/register"]},bW=function(){return["/login"]};function OW(e,t){1&e&&(fa(0,"div",28),fa(1,"a",29),fa(2,"strong"),sc(3,30),pa(),pa(),fa(4,"a",31),sc(5,32),pa(),pa()),2&e&&(ks(1),ha("routerLink",wu(2,SW)),ks(3),ha("routerLink",wu(3,bW)))}function kW(e,t){if(1&e&&(la(0,PW,7,1,"ng-container",22),la(1,OW,6,4,"ng-template",null,25,ju)),2&e){const e=ca(2);ha("ngIf",Sa().username.isPresent())("ngIfElse",e)}}const TW=function(){return["/"]},IW=function(){return["/play"]},AW=function(){return["/lobby"]},MW=function(){return["/local"]},NW=function(){return["/tutorial"]},RW=function(){return["/settings"]};let xW=(()=>{class e{constructor(e,t,n){this.router=e,this.connectedUserService=t,this.userService=n,this.loading=!0,this.username=Aw.empty(),this.faCog=HZ,this.faSpinner=jZ,this.showMenu=!1}ngOnInit(){this.userSub=this.connectedUserService.subscribeToUser(e=>{this.loading=!1,this.username=e.username.isPresent()?e.username:e.email})}logout(){var e=this;return Sw(function*(){yield e.connectedUserService.disconnect(),yield e.router.navigate(["/"])})()}ngOnDestroy(){this.userSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(ua(fC),ua(gZ),ua(hZ))},e.\u0275cmp=Je({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){let e,t,n,r,i,s,o,a,l,c,u;return e=$localize`Home`,t=$localize`Play online`,n=$localize`Create a game`,r=$localize`Join a game`,i=$localize`Play offline`,s=$localize`Create a game`,o=$localize`Learn the rules`,a=$localize`Settings`,l=$localize`Log out`,c=$localize`Register`,u=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],e,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],t,[1,"navbar-dropdown"],n,r,i,s,o,[1,"navbar-end"],["data-tooltip",a,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","logout",1,"navbar-item",3,"click"],l,[1,"buttons"],[1,"button","is-primary",3,"routerLink"],c,[1,"button","is-light",3,"routerLink"],u]},template:function(e,t){if(1&e&&(fa(0,"nav",0),fa(1,"div",1),fa(2,"a",2),ga(3,"img",3),pa(),fa(4,"a",4),Ea("click",function(){return t.showMenu=!t.showMenu}),ga(5,"span",5),ga(6,"span",5),ga(7,"span",5),pa(),pa(),fa(8,"div",6),Ea("click",function(){return t.showMenu=!t.showMenu}),fa(9,"div",7),fa(10,"a",2),sc(11,8),pa(),fa(12,"div",9),fa(13,"a",10),sc(14,11),pa(),fa(15,"div",12),fa(16,"a",2),sc(17,13),pa(),fa(18,"a",2),sc(19,14),pa(),pa(),pa(),fa(20,"div",9),fa(21,"a",10),sc(22,15),pa(),fa(23,"div",12),fa(24,"a",2),sc(25,16),pa(),fa(26,"a",2),sc(27,17),pa(),pa(),pa(),pa(),fa(28,"div",18),fa(29,"a",19),ga(30,"fa-icon",20),pa(),fa(31,"div",21),la(32,wW,2,1,"ng-container",22),la(33,kW,3,2,"ng-template",null,23,ju),pa(),pa(),pa(),pa()),2&e){const e=ca(34);ks(2),ha("routerLink",wu(12,TW)),ks(2),ha("ngClass",t.showMenu?"is-active":""),ks(4),ha("ngClass",t.showMenu?"is-active":""),ks(2),ha("routerLink",wu(13,TW)),ks(6),ha("routerLink",wu(14,IW)),ks(2),ha("routerLink",wu(15,AW)),ks(6),ha("routerLink",wu(16,MW)),ks(2),ha("routerLink",wu(17,NW)),ks(3),ha("routerLink",wu(18,RW)),ks(1),ha("icon",t.faCog),ks(2),ha("ngIf",t.loading)("ngIfElse",e)}},directives:[mC,Qd,_W,tf],encapsulation:2}),e})(),DW=(()=>{class e{constructor(e,t){this._themeService=e,this._errorLoggerService=t,this.faTwitter=UZ,this.faFacebook=LZ,this.faGithub=FZ}}return e.\u0275fac=function(t){return new(t||e)(ua($Z),ua(lZ))},e.\u0275cmp=Je({type:e,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let e;return e=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],e,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoard"],["href","https://facebook.com/EveryBoard"]]},template:function(e,t){1&e&&(ga(0,"app-header"),fa(1,"main",0),ga(2,"router-outlet"),pa(),fa(3,"footer",1),fa(4,"div",2),fa(5,"p"),fa(6,"span"),rc(7,3),ga(8,"strong"),ic(),pa(),Qa(9," \xa0 "),fa(10,"a",4),ga(11,"fa-icon",5),pa(),Qa(12,"\xa0 "),fa(13,"a",6),ga(14,"fa-icon",5),pa(),Qa(15,"\xa0 "),fa(16,"a",7),ga(17,"fa-icon",5),pa(),pa(),pa(),pa()),2&e&&(ks(11),ha("icon",t.faGithub),ks(3),ha("icon",t.faTwitter),ks(3),ha("icon",t.faFacebook))},directives:[xW,vC,_W],encapsulation:2}),e})();class LW{constructor(e,t){this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}}class FW extends LW{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class UW{of(e,t){for(const n of this.all)if(n.x===e&&n.y===t)return Mw.success(n);return Mw.failure("Invalid x and y in direction construction")}fromDelta(e,t){return 0===e&&0===t?Mw.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):Mw.failure(zW.DIRECTION_MUST_BE_LINEAR())}fromMove(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}fromString(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return Mw.failure(`Invalid direction string ${e}`)}}fromInt(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return Mw.failure(`Invalid int direction: ${e}`)}}}class VW extends FW{constructor(e,t){super(e,t)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return VW.factory.of(-this.x,-this.y).get()}}VW.UP=new VW(0,-1),VW.UP_RIGHT=new VW(1,-1),VW.RIGHT=new VW(1,0),VW.DOWN_RIGHT=new VW(1,1),VW.DOWN=new VW(0,1),VW.DOWN_LEFT=new VW(-1,1),VW.LEFT=new VW(-1,0),VW.UP_LEFT=new VW(-1,-1),VW.factory=new class extends UW{constructor(){super(...arguments),this.all=[VW.UP,VW.UP_RIGHT,VW.RIGHT,VW.DOWN_RIGHT,VW.DOWN,VW.DOWN_LEFT,VW.LEFT,VW.UP_LEFT]}},VW.DIRECTIONS=VW.factory.all,VW.DIAGONALS=[VW.UP_RIGHT,VW.DOWN_RIGHT,VW.DOWN_LEFT,VW.UP_LEFT],VW.ORTHOGONALS=[VW.UP,VW.RIGHT,VW.DOWN,VW.LEFT],VW.encoder=new class extends EZ{encode(e){return e.toString()}decode(e){return cZ("string"==typeof e,"Invalid encoded direction"),VW.factory.fromString(e).get()}};class BW extends FW{constructor(e,t){super(e,t)}getOpposite(){return BW.factory.of(-this.x,-this.y).get()}rotateClockwise(){return BW.factory.of(-this.y,this.x).get()}}BW.UP=new BW(0,-1),BW.RIGHT=new BW(1,0),BW.DOWN=new BW(0,1),BW.LEFT=new BW(-1,0),BW.factory=new class extends UW{constructor(){super(...arguments),this.all=[BW.UP,BW.RIGHT,BW.DOWN,BW.LEFT]}of(e,t){return 0===e&&-1===t?Mw.success(BW.UP):1===e&&0===t?Mw.success(BW.RIGHT):0===e&&1===t?Mw.success(BW.DOWN):-1===e&&0===t?Mw.success(BW.LEFT):Mw.failure("Invalid orthogonal from x and y")}},BW.ORTHOGONALS=BW.factory.all,BW.encoder=new class extends EZ{encode(e){return e.toString()}decode(e){return cZ("string"==typeof e,"Invalid encoded orthogonal"),BW.factory.fromString(e).get()}};class $W extends PZ{maxValue(){return 3}encodeNumber(e){return e===BW.UP?0:e===BW.RIGHT?1:e===BW.DOWN?2:3}decodeNumber(e){switch(e){case 0:return BW.UP;case 1:return BW.RIGHT;case 2:return BW.DOWN;default:return bw.expectToBe(e,3,`Encoded orthogonal should be 3 for LEFT but got ${e} instead`),BW.LEFT}}}let zW=(()=>{class e{}return e.DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`,e})();class HW{constructor(e,t){this.x=e,this.y=t}static numberEncoder(e,t){return PZ.tuple([PZ.numberEncoder(e),PZ.numberEncoder(t)],e=>[e.x,e.y],e=>new HW(e[0],e[1]))}getNext(e,t){return new HW(this.x+(t=t??1)*e.x,this.y+t*e.y)}getPrevious(e,t){return this.getNext(e,-(t=t??1))}getLeft(e){return new HW(this.x+e.y,this.y+-e.x)}getRight(e){return new HW(this.x+-e.y,this.y+e.x)}getOpposite(){return new HW(-this.x,-this.y)}isInRange(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}isNotInRange(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}getDirectionToward(e){return VW.factory.fromMove(this,e)}getOrthogonalDistance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getDistance(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}isHexagonallyAlignedWith(e){const t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}isAlignedWith(e){const t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}getVectorToward(e){return new HW(e.x-this.x,e.y-this.y)}getMinimalVectorToward(e){return this.getVectorToward(e).toVector()}getCoordsToward(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];const t=this.getDirectionToward(e).get();let n=this.getNext(t,1);const r=[];for(;!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}toVector(){const e=Math.abs(this.x),t=Math.abs(this.y),n=Math.max(e,t);let r=this.x,i=this.y,s=2;for(;s<=n;)r%s==0&&i%s==0?(r/=s,i/=s):s++;return new HW(r,i)}isBetween(e,t){const n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}getUntil(e){const t=[],n=this.getDirectionToward(e).get();let r=this.getNext(n);for(;!1===r.equals(e);)t.push(r),r=r.getNext(n);return t}equals(e){return this===e||e.x===this.x&&e.y===this.y}compareTo(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}toString(){return"("+this.x+", "+this.y+")"}}HW.encoder=new class extends EZ{encode(e){return{x:e.x,y:e.y}}decode(e){const t=e;return cZ(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new HW(t.x,t.y)}};let GW=(()=>{class e{constructor(e){this.messageDisplayer=e,this.Player=bZ,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=Aw.empty(),this.imagesLocation="assets/images/",this.hasAsymetricBoard=!1,this.rotation=""}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?xw.SUCCESS:(this.messageDisplayer.gameMessage(e),xw.failure(e))}cancelMoveAttempt(){}getPlayerClass(e){switch(e){case bZ.ZERO:return"player0-fill";case bZ.ONE:return"player1-fill";default:return bw.expectToBe(e,OZ.NONE),""}}pass(){var e=this;return Sw(function*(){return lZ.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.rules.node.gameState.turn}getCurrentPlayer(){return this.rules.node.gameState.getCurrentPlayer()}getState(){return this.rules.node.gameState}getPreviousState(){return this.rules.node.mother.get().gameState}range(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),ZW=(()=>{class e extends GW{getHexaCoordsBy(e,t){const n=new HW(e,t);return this.getHexaCoordsAt(n)}getHexaCoordsAt(e){let t="";const n=this.hexaLayout.getHexaCoordsAt(e);for(const r of n)t+=r.x+" "+r.y+" ";return t+=n[0].x+" "+n[0].y,t}getCenterBy(e,t){const n=new HW(e,t);return this.getCenterAt(n)}getCenterAt(e){return this.hexaLayout.getCenterAt(e)}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],features:[Go],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();class qW{constructor(e){this.value=e}static from(e){switch(e){case qW.ZERO.value:return qW.ZERO;case qW.ONE.value:return qW.ONE;case qW.EMPTY.value:return qW.EMPTY;case qW.UNREACHABLE.value:return qW.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+e)}}static ofPlayer(e){return e===bZ.ZERO?qW.ZERO:(bw.expectToBe(e,bZ.ONE),qW.ONE)}equals(e){return this===e}is(e){return this.value===e.value}isPlayer(){return this===qW.ZERO||this===qW.ONE}}qW.ZERO=new qW(bZ.ZERO.value),qW.ONE=new qW(bZ.ONE.value),qW.EMPTY=new qW(OZ.NONE.value),qW.UNREACHABLE=new qW(3);class WW extends FW{constructor(e,t){super(e,t)}static getAngle(e){switch(e){case WW.UP:return 0;case WW.UP_RIGHT:return 60;case WW.RIGHT:return 120;case WW.DOWN:return 180;case WW.DOWN_LEFT:return 240;default:return bw.expectToBe(e,WW.LEFT),300}}getOpposite(){return WW.factory.of(-this.x,-this.y).get()}}WW.UP=new WW(0,-1),WW.LEFT=new WW(-1,0),WW.UP_RIGHT=new WW(1,-1),WW.DOWN_LEFT=new WW(-1,1),WW.RIGHT=new WW(1,0),WW.DOWN=new WW(0,1),WW.factory=new class extends UW{constructor(){super(...arguments),this.all=[WW.UP,WW.UP_RIGHT,WW.RIGHT,WW.DOWN,WW.DOWN_LEFT,WW.LEFT]}},WW.encoder=new class extends PZ{maxValue(){return 5}encodeNumber(e){switch(e){case WW.UP:return 0;case WW.UP_RIGHT:return 1;case WW.RIGHT:return 2;case WW.DOWN:return 3;case WW.DOWN_LEFT:return 4;default:return 5}}decodeNumber(e){return cZ(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),WW.factory.all[e]}};class jW{constructor(e,t,n){this.size=e,this.origin=t,this.orientation=n}getCenterAt(e){const t=this.orientation.conversionMatrix;return new HW(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}getCornerOffset(e){const t=2*Math.PI*(this.orientation.startAngle+e)/6;return new HW(this.size*Math.cos(t),this.size*Math.sin(t))}getHexaCoordsAt(e){const t=this.getCenterAt(e),n=[];for(let r=0;r<6;r+=1){const e=this.getCornerOffset(r);n.push(new HW(t.x+e.x,t.y+e.y))}return n}}class YW{}class KW extends YW{constructor(){super(),this.startAngle=.5,this.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],this.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3]}}KW.INSTANCE=new KW;class QW extends YW{constructor(){super(),this.startAngle=0,this.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],this.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3]}isOnBorder(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}isOnTopRightBorder(e,t){return 0===t.y}isOnRightBorder(e,t){return t.x===e.width-1}isOnLeftBorder(e,t){return 0===t.x}isOnBottomLeftBorder(e,t){return t.y===e.height-1}isOnTopLeftBorder(e,t){return null!=e.excludedSpaces[t.y]?t.x===e.excludedSpaces[t.y]:t.y===e.excludedSpaces.length&&0===t.x}isOnBottomRightBorder(e,t){return null!=e.excludedSpaces[e.height-1-t.y]?e.width-1-t.x===e.excludedSpaces[e.height-1-t.y]:e.height-1-t.y===e.excludedSpaces.length&&t.x===e.width-1}getAllBorders(e){const t=[];return e.forEachCoord((n,r)=>{this.isOnBorder(e,n)&&t.push(n)}),t}isTopCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}isTopLeftCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isTopRightCorner(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}isBottomCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}isBottomLeftCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isBottomRightCorner(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}QW.INSTANCE=new QW;let XW=(()=>{class e{}return e.CANNOT_CHOOSE_OPPONENT_PIECE=()=>$localize`You cannot pick a piece of the opponent.`,e.MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`,e.MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`,e.CANNOT_SELF_CAPTURE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`,e.MUST_CHOOSE_PLAYER_PIECE=()=>$localize`You must pick one of your pieces.`,e.CANNOT_PASS=()=>$localize`You cannot pass your turn.`,e.MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`,e.MUST_PASS=()=>$localize`You must pass your turn.`,e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`,e.MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`,e.SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`,e})();class JW{constructor(e,t){this.ruler=e,this.name=t}toString(){return this.name}}class ej{constructor(e){this.value=e}static fromWinner(e){return e.isPlayer()?new ej(e.getVictoryValue()):new ej(0)}toString(){return""+this.value}}class tj{static toComparableObjectSet(e){const t=[];return e.forEach(e=>{t.some(t=>t.equals(e))||t.push(e)}),t}static toComparableSet(e){const t=[];return e.forEach(e=>{t.some(t=>Iw(t,e))||t.push(e)}),t}}class nj{constructor(e){this.values=void 0===e?[]:tj.toComparableSet(e)}equals(e){if(e.size()!==this.size())return!1;for(const t of this)if(!1===e.contains(t))return!1;return!0}toString(){let e="";for(const t of this)e+=null==t?"null, ":t.toString()+", ";return"["+e.slice(0,-2)+"]"}add(e){return!this.contains(e)&&(this.values.push(e),!0)}union(e){for(const t of e)this.add(t)}contains(e){for(const t of this.values)if(Iw(t,e))return!0;return!1}size(){return this.values.length}toList(){const e=[];for(const t of this)e.push(t);return e}getAnyElement(){return this.size()>0?Aw.of(this.values[0]):Aw.empty()}isEmpty(){return 0===this.values.length}[Symbol.iterator](){return this.values.values()}}class rj{constructor(e){this.turn=e}getCurrentPlayer(){return bZ.fromTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?bZ.ZERO:bZ.ONE}}class ij extends rj{constructor(e,t){super(t),this.board=e}getPieceAt(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}tryToGetPieceAt(e){return this.isOnBoard(e)?Aw.of(this.board[e.y][e.x]):Aw.empty()}isOnBoard(e){return e.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(e,t){return this.getPieceAt(new HW(e,t))}forEachCoord(e){for(const[t,n]of this.getCoordsAndContents())e(t,n)}getCoordsAndContents(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const r=new HW(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}getCopiedBoard(){return AZ.copyBiArray(this.board)}}class sj extends ij{static getInitialState(){const e=qW.EMPTY,t=qW.UNREACHABLE,n=qW.ZERO,r=qW.ONE;return new sj([[t,t,t,t,r,r,r,r,r],[t,t,t,r,r,r,r,r,r],[t,t,e,e,r,r,r,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,n,n,n,e,e,t,t],[n,n,n,n,n,n,t,t,t],[n,n,n,n,n,t,t,t,t]],0)}isInBoard(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==qW.UNREACHABLE}isPiece(e){return this.getPieceAt(e).isPlayer()}getScores(){const e=[14,14];for(let t=0;t<9;t++)for(let n=0;n<9;n++)this.getPieceAtXY(n,t)===qW.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===qW.ONE&&(e[0]=e[0]-1);return e}}class oj{}class aj extends oj{constructor(e,t){super(),this.coord=new HW(e,t)}}class lj extends aj{constructor(e,t,n){if(super(e.x,e.y),this.dir=t,this.lastPiece=n,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!")}static fromSingleCoord(e,t){try{return Mw.success(new lj(e,t,Aw.empty()))}catch(n){return Mw.failure(n.message)}}static fromDoubleCoord(e,t,n){const r=[e,t];AZ.sortByDescending(r,lj.sortCoord);const i=r[1].getDirectionToward(r[0]).get(),s=WW.factory.fromDelta(i.x,i.y);if(s.isFailure())return Mw.failure("Invalid direction");const o=s.get();return r[1].getDistance(r[0])>2?Mw.failure("Distance between first coord and last coord is too great"):o.equals(n)?lj.fromSingleCoord(r[1],n):o.getOpposite().equals(n)?lj.fromSingleCoord(r[0],n):Mw.success(new lj(r[1],n,Aw.of(r[0])))}static sortCoord(e){return 9*e.y+e.x}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}lj.encoder=new class extends PZ{maxValue(){return 104831}encodeNumber(e){const t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;{const n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}}decodeNumber(e){const t=e%8;e=(e-t)/8;const n=WW.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;const s=new HW(i,r);if(0===e)return lj.fromSingleCoord(s,n).get();{const t=(e=(e-1)/2)%9,r=(e=(e-t)/9)%9;e=(e-r)/9;const i=new HW(r,t);return lj.fromDoubleCoord(s,i,n).get()}}};var cj=(()=>(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(cj||(cj={})),cj))();class uj{constructor(e=[],t=!1){this.map=e,this.isImmutable=t}static from(e){const t=Object.keys(e),n=new uj;for(const r of t)n.set(r,e[r]);return n}makeImmutable(){this.isImmutable=!0}get(e){for(const t of this.map)if(Iw(t.key,e))return Aw.of(t.value);return Aw.empty()}forEach(e){for(let t=0;t<this.map.length;t++)e(this.getByIndex(t))}getByIndex(e){return this.map[e]}putAll(e){this.checkImmutability("putAll");for(const t of e.map)this.put(t.key,t.value)}checkImmutability(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}put(e,t){this.checkImmutability("put");for(const n of this.map)if(Iw(n.key,e)){const e=n.value;return n.value=t,Aw.of(e)}return this.map.push({key:e,value:t}),Aw.empty()}containsKey(e){return this.map.some(t=>Iw(t.key,e))}size(){return this.map.length}listKeys(){return this.map.map(e=>e.key)}getKeySet(){return new nj(this.listKeys())}filter(e){const t=new uj;for(const n of this.map)e(n.key,n.value)&&t.set(n.key,n.value);return t}replace(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}set(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}delete(e){this.checkImmutability("delete");for(let t=0;t<this.map.length;t++)if(Iw(this.map[t].key,e)){const e=this.map[t].value,n=this.map.slice(0,t),r=this.map.slice(t+1);return this.map=n.concat(r),e}throw new Error('No Value to delete for key "'+e.toString()+'"!')}getCopy(){const e=new this.constructor;for(const t of this.listKeys())e.set(t,this.get(t).get());return e}equals(e){const t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;for(const r of t){const t=this.get(r).get(),n=e.get(r);if(cZ(n.isPresent(),"value is absent in a map even though its key is present!"),!1===Iw(t,n.get()))return!1}return!0}}class hj extends uj{reverse(){const e=new hj;for(const t of this.listKeys()){const n=this.get(t).get();if(e.containsKey(n))e.get(n).get().add(t);else{const r=new nj;r.add(t),e.set(n,r)}}return e}}let dj=(()=>{class e{}return e.createdNodes=0,e.minimaxTime=0,e})();class fj{constructor(e,t=Aw.empty(),n=Aw.empty(),r){if(this.gameState=e,this.mother=t,this.move=n,this.minimaxCreator=r,this.childs=Aw.empty(),this.hopedValue=new uj,this.ownValue=new uj,this.possibleMoves=new uj,this.ownValue=new uj,null!=r){const e=r.getBoardValue(this);this.ownValue.set(r.name,e),this.hopedValue.set(r.name,e.value)}dj.createdNodes++,Ow(fj.VERBOSE||!1,"creating "+this.myToString())}static getScoreStatus(e){const t=!1;return e===Number.MAX_SAFE_INTEGER||e===Number.MIN_SAFE_INTEGER?(Ow(fj.VERBOSE||t,"VICTORY"),cj.VICTORY):e===Number.MIN_SAFE_INTEGER+1?(Ow(fj.VERBOSE||t,"PRE_VICTORY_MIN"),cj.PRE_VICTORY):e===Number.MAX_SAFE_INTEGER-1?(Ow(fj.VERBOSE||t,"PRE_VICTORY_MAX"),cj.PRE_VICTORY):(Ow(fj.VERBOSE||t,"DEFAULT"),cj.DEFAULT)}findBestMove(e,t,n=!1,r=!0){const i=(new Date).getTime();let s=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);for(;s.gameState.turn>this.gameState.turn+1;)s=s.mother.get(),e--;return dj.minimaxTime+=(new Date).getTime()-i,s.move.get()}alphaBeta(e,t,n,r,i,s){if(e<1)return Ow(fj.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+e),this;if(r.ruler.getGameStatus(this).isEndGame)return Ow(fj.VERBOSE||!1,"isLeaf-EndGame("+fj.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+e),this;const o=this.getPossibleMoves(r);cZ(o.size()>0,"Minimax "+r.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=Aw.of([]));const a=this.getBestChilds(o,e,t,n,r,i,s),l=this.getBestChildAmongst(a,i),c=l.hopedValue.get(r.toString()).get();return this.hopedValue.put(r.toString(),c),l}getPossibleMoves(e){const t=this.possibleMoves.get(e.name);if(t.isAbsent()){const t=e.getListMoves(this);return this.possibleMoves.set(e.name,new nj(t)),new nj(t)}return t.get()}getBestChilds(e,t,n,r,i,s,o){let a=[];const l=this.gameState.getCurrentPlayer();let c=l===bZ.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const u=l===bZ.ZERO?(e,t)=>e<t:(e,t)=>e>t;for(const h of e){const e=this.getOrCreateChild(h,i).alphaBeta(t-1,n,r,i,s,o),d=e.getHopedValue(i);if(u(d,c)||0===a.length?(c=d,a=[e]):d===c&&a.push(e),o&&u(c,l===bZ.ZERO?n:r))break;l===bZ.ZERO?r=Math.min(c,r):n=Math.max(c,n)}return a}getBestChildAmongst(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}getOrCreateChild(e,t){let n=this.getSonByMove(e);if(n.isAbsent()){const r=t.ruler.isLegal(e,this.gameState),i=e.toString();cZ(r.isSuccess(),'The minimax "'+t.name+'" has proposed an illegal move ('+i+"), this should not happen.");const s=t.ruler.applyLegalMove(e,this.gameState,r.get());n=Aw.of(new fj(s,Aw.of(this),Aw.of(e),t)),this.childs.get().push(n.get())}return n.get()}getSonByMove(e){cZ(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const t of this.childs.get())if(t.move.isPresent()&&t.move.equalsValue(e))return Aw.of(t);return Aw.empty()}getHopedValue(e){return this.hopedValue.get(e.name).get()}getOwnValue(e){const t=this.ownValue.get(e.name);if(t.isAbsent()){const t=e.getBoardValue(this);return this.ownValue.set(e.name,t),t}return t.get()}myToString(){let e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let e=this.childs.get().length;for(const t of this.childs.get())e+=t.countDescendants();return e}}fj.VERBOSE=!1,fj.minimaxes=new uj;class pj{constructor(e,t){this.isEndGame=e,this.winner=t}static getVictory(e){return e===bZ.ZERO?pj.ZERO_WON:pj.ONE_WON}static getDefeat(e){return e===bZ.ZERO?pj.ONE_WON:pj.ZERO_WON}toBoardValue(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}pj.ZERO_WON=new pj(!0,bZ.ZERO),pj.ONE_WON=new pj(!0,bZ.ONE),pj.DRAW=new pj(!0,OZ.NONE),pj.ONGOING=new pj(!1,OZ.NONE);class gj{constructor(e){this.stateType=e,this.setInitialBoard()}choose(e){const t=!1;Ow(t,"Rules.choose: "+e.toString()+" was proposed");const n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){Ow(t,"Rules.choose: current node has moves");const r=this.node.getSonByMove(e);if(r.isPresent())return cZ(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),Ow(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(Ow(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return Ow(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;Ow(t,"Rules.choose: Move is legal, let's apply it");const r=this.applyLegalMove(e,this.node.gameState,n.get()),i=new fj(r,Aw.of(this.node),Aw.of(e));return this.node=i,!0}setInitialBoard(){const e=this.stateType.getInitialState();fj.ruler=this,this.node=new fj(e)}applyMoves(e,t,n){let r=0;for(const i of e){const e=n(i),s=this.isLegal(e,t);cZ(s.isSuccess(),"Can't create state from invalid moves ("+r+"): "+s.toString()+"."),t=this.applyLegalMove(e,t,s.get()),r++}return t}}let mj=(()=>{class e{}return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`,e.NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`,e.CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`,e.MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`,e.TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`,e.LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`,e})();class yj extends gj{static isLegal(e,t){const n=this.getFirstPieceValidity(e,t);return n.isFailure()?n.toFailedFallible():e.isSingleCoord()?yj.isLegalPush(e,t):yj.isLegalSideStep(e,t)}static getFirstPieceValidity(e,t){const n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?xw.failure(XW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===qW.ofPlayer(t.getCurrentOpponent())?xw.failure(XW.CANNOT_CHOOSE_OPPONENT_PIECE()):xw.SUCCESS}static isLegalPush(e,t){let n=1,r=e.coord.getNext(e.dir);const i=qW.ofPlayer(t.getCurrentPlayer()),s=qW.EMPTY,o=t.getCopiedBoard();for(o[e.coord.y][e.coord.x]=s;n<=3&&t.isOnBoard(r)&&t.getPieceAt(r)===i;)n++,r=r.getNext(e.dir);return n>3?Mw.failure(mj.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(r)||(o[r.y][r.x]=i,t.getPieceAt(r)===s)?Mw.success(o):yj.isLegalRealPush(r,e,t,n,o)}static isLegalRealPush(e,t,n,r,i){let s=0;const o=qW.ofPlayer(n.getCurrentOpponent()),a=qW.ofPlayer(n.getCurrentPlayer());for(;s<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)s++,e=e.getNext(t.dir);return s>=r?Mw.failure(mj.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===qW.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===a)?Mw.failure(mj.CANNOT_PUSH_YOUR_OWN_PIECES()):Mw.success(i)}static isLegalSideStep(e,t){let n=e.lastPiece.get();const r=e.coord.getDirectionToward(n).get();n=n.getNext(r);let i=e.coord;const s=qW.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();for(;!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==s)return Mw.failure(mj.MUST_ONLY_TRANSLATE_YOUR_PIECES());const n=i.getNext(e.dir);if(o[i.y][i.x]=qW.EMPTY,n.isInRange(9,9)){if(t.isPiece(n))return Mw.failure(mj.TRANSLATION_IMPOSSIBLE());t.getPieceAt(n)===qW.EMPTY&&(o[n.y][n.x]=s)}i=i.getNext(r)}return Mw.success(o)}static getGameStatus(e){const t=e.gameState.getScores();return t[0]>5?pj.ZERO_WON:t[1]>5?pj.ONE_WON:pj.ONGOING}applyLegalMove(e,t,n){return new sj(n,t.turn+1)}isLegal(e,t){return yj.isLegal(e,t)}getGameStatus(e){return yj.getGameStatus(e)}}class vj extends JW{getListMoves(e){const t=[],n=e.gameState,r=n.getCurrentPlayer();for(let i=0;i<9;i++)for(let e=0;e<9;e++){const s=new HW(e,i);if(!1!==n.getPieceAt(s).is(r))for(const e of WW.factory.all){const r=lj.fromSingleCoord(s,e).get();if(this.isAcceptablePush(r,n)){t.push(r);for(const r of WW.factory.all)for(let i=1;i<=2&&!r.equals(e);i++){const o=s.getNext(r,i);if(!o.isInRange(9,9))break;{const r=lj.fromDoubleCoord(s,o,e).get();yj.isLegal(r,n).isSuccess()&&t.push(r)}}}}}return new nj(t).toList()}isAcceptablePush(e,t){const n=t.getScores(),r=yj.isLegal(e,t);if(r.isSuccess()){const e=t.getCurrentOpponent().value;return!(new sj(r.get(),t.turn+1).getScores()[e]>n[e])}return!1}getBoardValue(e){const t=yj.getGameStatus(e);if(t.isEndGame)return new ej(t.toBoardValue());const n=e.gameState.getScores();return new ej(n[1]-n[0])}}class Cj{constructor(e,t,n){this.title=e,this.instruction=t,this.state=n,this.previousMove=Aw.empty(),this.previousState=Aw.empty()}static fromMove(e,t,n,r,i,s){return new Ej(e,t,n,r,i,s)}static forClick(e,t,n,r,i,s){return new Pj(e,t,n,r,i,s)}static anyMove(e,t,n,r,i){return new wj(e,t,n,r,i)}static fromPredicate(e,t,n,r,i,s){return new Sj(e,t,n,r,i,s)}static informational(e,t,n){return new bj(e,t,n)}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(e){return this.previousMove=Aw.of(e),this}withPreviousState(e){return this.previousState=Aw.of(e),this}}class _j extends Cj{constructor(e,t,n,r){super(e,t,n),this.successMessage=r}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class Ej extends _j{constructor(e,t,n,r,i,s){super(e,t,n,i),this.acceptedMoves=r,this.failureMessage=s,cZ(r.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class wj extends _j{constructor(e,t,n,r,i){super(e,t,n,i),this.solutionMove=r}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class Pj extends _j{constructor(e,t,n,r,i,s){super(e,t,n,i),this.acceptedClicks=r,this.failureMessage=s}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class Sj extends _j{constructor(e,t,n,r,i,s){super(e,t,n,s),this.solutionMove=r,this.predicate=i}getSolution(){return this.solutionMove}isPredicate(){return!0}}class bj extends Cj{isInformation(){return!0}}const Oj=qW.EMPTY,kj=qW.UNREACHABLE,Tj=qW.ZERO,Ij=qW.ONE;class Aj{constructor(){this.tutorial=[Cj.informational($localize`Initial board and goal of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,sj.getInitialState()),Cj.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,sj.getInitialState(),lj.fromSingleCoord(new HW(2,6),WW.UP).get(),$localize`Congratulations!`),Cj.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new sj([[kj,kj,kj,kj,Oj,Tj,Tj,Ij,Ij],[kj,kj,kj,Oj,Oj,Oj,Oj,Oj,Oj],[kj,kj,Oj,Tj,Tj,Tj,Ij,Tj,Oj],[kj,Oj,Oj,Oj,Oj,Oj,Oj,Oj,Oj],[Oj,Oj,Oj,Oj,Tj,Tj,Tj,Ij,Ij],[Oj,Oj,Oj,Oj,Oj,Oj,Oj,Oj,kj],[Oj,Oj,Oj,Oj,Tj,Ij,Oj,kj,kj],[Oj,Oj,Oj,Tj,Oj,Oj,kj,kj,kj],[Oj,Oj,Tj,Oj,Oj,kj,kj,kj,kj]],0),[lj.fromSingleCoord(new HW(4,4),WW.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed!`)]}}function Mj(e,t){if(1&e){const e=va();_n(),fa(0,"circle",6),Ea("click",function(){Gt(e);const t=Sa(2).index,n=Sa().index;return Sa().onPieceClick(t,n)}),pa()}if(2&e){const e=Sa(2).index,t=Sa().index,n=Sa();Ta("id","piece_",e,"_",t,""),ha("ngClass",n.getPieceClasses(e,t)),ra("cx",n.getCenterBy(e,t).x)("cy",n.getCenterBy(e,t).y)("r",.5*n.SPACE_SIZE)}}function Nj(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"polygon",4),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onSpaceClick(t,n)}),pa(),la(2,Mj,1,6,"circle",5),pa()}if(2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();ks(1),Ta("id","space_",t,"_",r,""),ha("ngClass",i.getSquareClasses(t,r)),ra("points",i.getHexaCoordsBy(t,r)),ks(1),ha("ngIf",i.isPiece(n))}}function Rj(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,Nj,3,5,"g",3),pa()),2&e){const e=t.$implicit,n=Sa(2);ks(1),ha("ngIf",n.isBoard(e))}}function xj(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,Rj,2,1,"g",1),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function Dj(e,t){1&e&&(_n(),fa(0,"marker",7),ga(1,"polygon",8),pa()),2&e&&ka("id","arrowhead_",t.$implicit.dir.toString(),"")}function Lj(e,t){if(1&e){const e=va();_n(),fa(0,"g"),ga(1,"line",9),fa(2,"line",10),Ea("click",function(){const t=Gt(e).$implicit;return Sa().chooseDirection(t.dir)}),pa(),fa(3,"polygon",11),Ea("click",function(){const t=Gt(e).$implicit;return Sa().chooseDirection(t.dir)}),pa(),pa()}if(2&e){const e=t.$implicit;ks(1),ka("id","line_start_",e.dir.toString(),""),ra("x1",e.startCenter.x)("y1",e.startCenter.y)("x2",e.middle.x)("y2",e.middle.y),ks(1),ka("id","line_end_",e.dir.toString(),""),ra("x1",e.middle.x)("y1",e.middle.y)("x2",e.landingCenter.x)("y2",e.landingCenter.y),ks(1),ka("id","direction_",e.dir.toString(),""),ra("transform",e.transformation)}}class Fj{constructor(e,t,n,r,i,s){this.startCenter=e,this.middle=t,this.landingCenter=n,this.landing=r,this.dir=i,this.transformation=s}}let Uj=(()=>{class e extends ZW{constructor(e){super(e),this.moveds=[],this.directions=[],this.selecteds=[],this.rules=new yj(sj),this.availableMinimaxes=[new vj(this.rules,"Dummy")],this.encoder=lj.encoder,this.tutorial=(new Aj).tutorial,this.scores=Aw.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new jW(this.SPACE_SIZE,new HW(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),KW.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=Aw.of(this.getState().getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showPreviousMove(){const e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}showPushingMove(e){const t=this.rules.node.mother.get().gameState;let n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}showSideStepMove(e){let t=e.lastPiece.get();const n=e.coord.getDirectionToward(t).get();t=t.getNext(n);let r=e.coord;for(;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}onPieceClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#piece_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=n.getState().getCurrentOpponent();return n.hexaBoard[t][e].is(i)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t)})()}opponentClick(e,t){var n=this;return Sw(function*(){return(yield n.tryChoosingDirection(e,t)).isSuccess()?xw.SUCCESS:n.cancelMove(XW.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(e,t){var n=this;return Sw(function*(){return n.selecteds=[new HW(e,t)],n.showPossibleDirections(),xw.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(e){const t=this.getState(),n=qW.ofPlayer(t.getCurrentPlayer()),r=this.selecteds[0],i=this.selecteds[this.selecteds.length-1];for(const s of WW.factory.all){let o,a=r.getNext(s,1);if(t.isOnBoard(a)&&t.getPieceAt(a)===n){if(e)continue;if(a=i.getNext(s,1),t.isOnBoard(a)&&t.getPieceAt(a)===n)continue}if(o=e?lj.fromSingleCoord(r,s).get():lj.fromDoubleCoord(r,i,s).get(),this.rules.isLegal(o,t).isSuccess()){const e=this.getCenterAt(r),t=this.getCenterAt(a),n=this.getMiddleOfArrow(s,a,t),i=t.x+" "+t.y,o=WW.getAngle(s)+150,l=new Fj(e,n,t,a,s,"rotate("+o+" "+i+") translate("+i+")");this.directions.push(l)}}}getMiddleOfArrow(e,t,n){const r=t.getPrevious(e),i=this.getCenterAt(r);return new HW(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}isBoard(e){return e!==qW.UNREACHABLE}isPiece(e){return e!==qW.EMPTY}secondClick(e,t){var n=this;return Sw(function*(){const r=n.selecteds[0],i=new HW(e,t);if(i.equals(r))return n.cancelMoveAttempt(),xw.SUCCESS;if(!1===i.isHexagonallyAlignedWith(r))return n.cancelMoveAttempt(),n.firstClick(e,t);const s=i.getDistance(r);if(s>2)return n.cancelMove(mj.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const o=r.getDirectionToward(i).get();n.selecteds=[r];for(let e=0;e<s;e++)n.selecteds.push(r.getNext(o,e+1));if(3===n.selecteds.length){const r=n.selecteds[1],i=n.getState().getCurrentPlayer();if(!1===n.hexaBoard[r.y][r.x].is(i))return n.cancelMoveAttempt(),n.firstClick(e,t)}return n.showPossibleDirections(),xw.SUCCESS})()}thirdClick(e,t){var n=this;return Sw(function*(){const r=new HW(e,t),i=n.selecteds[0];if(r.equals(i))return n.deselectExtremity(!0);const s=n.selecteds[n.selecteds.length-1];return r.equals(s)?n.deselectExtremity(!1):3===n.selecteds.length&&r.equals(n.selecteds[1])?(n.cancelMoveAttempt(),xw.SUCCESS):n.tryExtension(r,i,s)})()}tryExtension(e,t,n){var r=this;return Sw(function*(){const i=VW.factory.fromMove(t,e);if(i.isSuccess()){const s=VW.factory.fromMove(n,e);if(i.equals(s)){const i=t.getDistance(e),s=n.getDistance(e);return 2===Math.max(i,s)?(r.selecteds.push(e),AZ.sortByDescending(r.selecteds,lj.sortCoord),r.showPossibleDirections(),xw.SUCCESS):r.cancelMove(mj.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const s=r.cancelMove(mj.LINE_AND_COORD_NOT_ALIGNED());return yield r.firstClick(e.x,e.y),s})()}deselectExtremity(e){var t=this;return Sw(function*(){return t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),xw.SUCCESS})()}chooseDirection(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#direction_"+e.toString());return n.isFailure()?t.cancelMove(n.getReason()):t._chooseDirection(e)})()}_chooseDirection(e){var t=this;return Sw(function*(){const n=t.getState();let r;const i=t.selecteds[0];return r=1===t.selecteds.length?lj.fromSingleCoord(i,e).get():lj.fromDoubleCoord(i,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(r,n,t.scores.get())})()}onSpaceClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#space_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.tryChoosingDirection(e,t)})()}tryChoosingDirection(e,t){var n=this;return Sw(function*(){const r=new HW(e,t);for(const e of n.directions)if(e.landing.equals(r))return n._chooseDirection(e.dir);return xw.failure("not a direction")})()}getSquareClasses(e,t){const n=new HW(e,t),r=[];return this.moveds.some(e=>e.equals(n))&&r.push("moved-fill"),r}getPieceClasses(e,t){const n=new HW(e,t),r=bZ.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(e=>e.equals(n))&&i.push("selected-stroke"),i}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-abalone"]],features:[Go],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,xj,2,1,"g",1),fa(2,"defs"),la(3,Dj,2,1,"marker",2),pa(),la(4,Lj,4,12,"g",1),pa()),2&e&&(ks(1),ha("ngForOf",t.hexaBoard),ks(2),ha("ngForOf",t.directions),ks(1),ha("ngForOf",t.directions))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class Vj{constructor(e){this.x=e}static from(e){switch(e){case 0:return Vj.ZERO;case 1:return Vj.ONE;case 2:return Vj.TWO;default:return cZ(3===e,"Invalid Apagos Coord "+e),Vj.THREE}}equals(e){return this.x===e.x}}Vj.ZERO=new Vj(0),Vj.ONE=new Vj(1),Vj.TWO=new Vj(2),Vj.THREE=new Vj(3);let Bj=(()=>{class e{}return e.PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`,e.CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`,e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`,e.NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`,e.NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`,e})();class $j extends oj{constructor(e,t,n){super(),this.landing=e,this.piece=t,this.starting=n}static drop(e,t){return bw.getNonNullable($j.ALL_MOVES.find(n=>n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(Aw.empty())))}static transfer(e,t){if(e.x<=t.x)return Mw.failure(Bj.PIECE_SHOULD_MOVE_DOWNWARD());const n=bw.getNonNullable($j.ALL_MOVES.find(n=>n.landing.equals(t)&&n.piece.equals(Aw.empty())&&n.starting.equals(Aw.of(e))));return Mw.success(n)}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}$j.ALL_MOVES=[new $j(Vj.ZERO,Aw.of(bZ.ZERO),Aw.empty()),new $j(Vj.ONE,Aw.of(bZ.ZERO),Aw.empty()),new $j(Vj.TWO,Aw.of(bZ.ZERO),Aw.empty()),new $j(Vj.THREE,Aw.of(bZ.ZERO),Aw.empty()),new $j(Vj.ZERO,Aw.of(bZ.ONE),Aw.empty()),new $j(Vj.ONE,Aw.of(bZ.ONE),Aw.empty()),new $j(Vj.TWO,Aw.of(bZ.ONE),Aw.empty()),new $j(Vj.THREE,Aw.of(bZ.ONE),Aw.empty()),new $j(Vj.TWO,Aw.empty(),Aw.of(Vj.THREE)),new $j(Vj.ONE,Aw.empty(),Aw.of(Vj.THREE)),new $j(Vj.ZERO,Aw.empty(),Aw.of(Vj.THREE)),new $j(Vj.ONE,Aw.empty(),Aw.of(Vj.TWO)),new $j(Vj.ZERO,Aw.empty(),Aw.of(Vj.TWO)),new $j(Vj.ZERO,Aw.empty(),Aw.of(Vj.ONE))],$j.encoder=new class extends PZ{maxValue(){return $j.ALL_MOVES.length}encodeNumber(e){const t=$j.ALL_MOVES.findIndex(t=>t.equals(e));return cZ(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}decodeNumber(e){return cZ(e<$j.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),$j.ALL_MOVES[e]}};class zj{constructor(e){this.containing=e}static from(e,t,n){if(e+t>n)return Mw.failure("invalid starting space");const r=new uj([{key:bZ.ZERO,value:e},{key:bZ.ONE,value:t},{key:OZ.NONE,value:n}]);r.makeImmutable();const i=new zj(r);return Mw.success(i)}isFull(){return this.count(bZ.ZERO)+this.count(bZ.ONE)>=this.count(OZ.NONE)}count(e){return this.containing.get(e).get()}addPiece(e){let t=this.count(bZ.ZERO),n=this.count(bZ.ONE);const r=this.count(OZ.NONE);return e===bZ.ZERO?t++:n++,zj.from(t,n,r).get()}substractPiece(e){let t=this.count(bZ.ZERO),n=this.count(bZ.ONE);const r=this.count(OZ.NONE);return e===bZ.ZERO?t--:n--,zj.from(t,n,r).get()}getDominatingPlayer(){const e=this.count(bZ.ZERO),t=this.count(bZ.ONE);return e>t?bZ.ZERO:t>e?bZ.ONE:OZ.NONE}equals(e){return this.containing.equals(e.containing)}}let Hj=(()=>{class e extends rj{constructor(e,t,n){super(e),this.board=t,this.remaining=n,this.remaining.makeImmutable()}static getInitialState(){return e.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(t,n,r,i){const s=[];for(let e=0;e<4;e++){const t=zj.from(n[0][e],n[1][e],n[2][e]).get();s.push(t)}const o=new uj;return o.set(bZ.ZERO,r),o.set(bZ.ONE,i),new e(t,s,o)}getPieceAt(e){return this.board[e.x]}updateAt(t,n){const r=[];for(let e=0;e<4;e++)r.push(t.x===e?n:this.board[e]);const i=this.getRemainingCopy();return new e(this.turn,r,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&AZ.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}return e.PIECES_PER_PLAYER=10,e})();class Gj extends gj{constructor(){super(Hj)}static get(){return Gj.singleton.isAbsent()&&(Gj.singleton=Aw.of(new Gj)),Gj.singleton.get()}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}applyLegalDrop(e,t){const n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);const i=new Hj(t.turn+1,t.board,n),s=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(s);if(e.landing===Vj.THREE)return i.updateAt(e.landing,o);{const t=Vj.from(e.landing.x+1),n=i.getPieceAt(t);return i.updateAt(e.landing,n).updateAt(t,o)}}applyLegalTransfer(e,t){const n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),s=t.getPieceAt(e.landing).addPiece(n);let o=t.updateAt(r,i);return o=o.updateAt(e.landing,s),new Hj(o.turn+1,o.board,o.remaining)}isLegal(e,t){return t.getPieceAt(e.landing).isFull()?Mw.failure(Bj.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}isLegalDrop(e,t){return t.getRemaining(e.piece.get())<=0?Mw.failure(Bj.NO_PIECE_REMAINING_TO_DROP()):Mw.success(void 0)}isLegalSlideDown(e,t){const n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?Mw.failure(Bj.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):Mw.success(void 0)}getGameStatus(e){const t=e.gameState;for(let r=0;r<4;r++)if(!1===t.getPieceAt(Vj.from(r)).isFull())return pj.ONGOING;const n=t.getPieceAt(Vj.THREE).getDominatingPlayer();return cZ(n.isPlayer(),"winner can only be a player if the game is finished"),pj.getVictory(n)}}Gj.singleton=Aw.empty();class Zj extends JW{getListMoves(e){const t=e.gameState;return $j.ALL_MOVES.filter(function(e){return Gj.get().isLegal(e,t).isSuccess()})}getBoardValue(e){const t=Gj.get().getGameStatus(e);if(t.isEndGame)return ej.fromWinner(t.winner);const n=e.gameState.board[3].getDominatingPlayer();return n.isPlayer()?new ej(n.getScoreModifier()):new ej(0)}}class qj{constructor(){this.tutorial=[Cj.informational($localize`Initial board and goal of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,Hj.getInitialState()),Cj.anyMove($localize`Drop`,$localize`There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You're playing Light.<br/><br/>Drop a piece on one of those three squares.`,Hj.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),$j.drop(Vj.ZERO,bZ.ZERO),$localize`Congratulations!`),Cj.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,Hj.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),$j.transfer(Vj.TWO,Vj.ZERO).get(),(e,t,n)=>e.isDrop()?xw.failure($localize`This move is a drop, please do a transfer!`):xw.SUCCESS,$localize`Congratulations!`),Cj.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,Hj.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),$j.drop(Vj.TWO,bZ.ONE),(e,t,n)=>e.isDrop()?e.piece.equalsValue(bZ.ONE)?xw.SUCCESS:xw.failure($localize`You actively made your opponent win!`):xw.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)]}}function Wj(e,t){if(1&e&&(_n(),ga(0,"circle",5)),2&e){const e=t.$implicit,n=Sa();ra("cx",n.getRemainingPieceCx(e))("cy",n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function jj(e,t){if(1&e&&(_n(),ga(0,"circle",6)),2&e){const e=t.$implicit,n=Sa();ra("cx",n.BOARD_WIDTH-n.getRemainingPieceCx(e))("cy",n.BOARD_HEIGHT-n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function Yj(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",9),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa();return n.onArrowClick(t,n.PlayerOrNone.ZERO)}),pa()}if(2&e){const e=Sa().index,t=Sa();ka("id","dropArrow_zero_",e,""),ha("ngClass",t.getArrowClasses(e,t.PlayerOrNone.ZERO)),ra("points",t.ARROW_COORD)("transform","translate("+t.SPACE_SIZE/2+" "+-t.SPACE_SIZE/2+")")}}function Kj(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",9),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa();return n.onArrowClick(t,n.PlayerOrNone.ONE)}),pa()}if(2&e){const e=Sa().index,t=Sa();ka("id","dropArrow_one_",e,""),ha("ngClass",t.getArrowClasses(e,t.PlayerOrNone.ONE)),ra("points",t.ARROW_COORD)("transform","translate(0 "+-t.SPACE_SIZE/2+")")}}function Qj(e,t){if(1&e){const e=va();_n(),ma(0),fa(1,"circle",10),Ea("click",function(){Gt(e);const t=Sa().index;return Sa().onSquareClick(t)}),pa(),ya()}if(2&e){const e=t.$implicit,n=Sa(),r=n.index,i=n.$implicit,s=Sa();ks(1),Ia("id","square_",r,"_piece_",e,"_out_of_",i.count(s.PlayerOrNone.NONE),""),ha("ngClass",s.getPieceClasses(r,e,i)),ra("cx",s.getCircleCenter(r,e,i).x)("cy",s.getCircleCenter(r,e,i).y)}}function Xj(e,t){if(1&e){const e=va();_n(),fa(0,"g"),la(1,Yj,1,4,"polygon",7),la(2,Kj,1,4,"polygon",7),fa(3,"rect",8),Ea("click",function(){const t=Gt(e).index;return Sa().onSquareClick(t)}),pa(),la(4,Qj,2,6,"ng-container",4),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa();ra("transform",r.getBlockTransform(n)),ks(1),ha("ngIf",r.canDisplayArrow(n,r.PlayerOrNone.ZERO)),ks(1),ha("ngIf",r.canDisplayArrow(n,r.PlayerOrNone.ONE)),ks(1),ka("id","square_",n,""),ha("ngClass",r.getSquareClasses(n)),ra("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),ks(1),ha("ngForOf",r.range(e.count(r.PlayerOrNone.NONE)))}}let Jj=(()=>{class e extends GW{constructor(t){super(t),this.PlayerOrNone=OZ,this.BOARD_WIDTH=4*this.SPACE_SIZE,this.BOARD_HEIGHT=4.5*this.SPACE_SIZE,this.ARROW_COORD=e.getArrowCoord(),this.PIECES_PER_PLAYER=Hj.PIECES_PER_PLAYER,this.selectedPiece=Aw.empty(),this.leftPiece=Aw.empty(),this.droppedPiece=Aw.empty(),this.displayableArrow=[],this.rules=Gj.get(),this.hasAsymetricBoard=!0,this.availableMinimaxes=[new Zj(this.rules,"ApagosDummyMinimax")],this.encoder=$j.encoder,this.tutorial=(new qj).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5),this.updateBoard()}static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}cancelMoveAttempt(){this.selectedPiece=Aw.empty(),this.showPossibleDrops()}updateBoard(){const e=this.getState();this.board=e.board,this.remainingZero=e.remaining.get(bZ.ZERO).get(),this.remainingOne=e.remaining.get(bZ.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=Aw.empty(),this.leftPiece=Aw.empty(),this.selectedPiece=Aw.empty()}showLastMove(){const e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}showLastDrop(e){const t=e.piece.get();let n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));const r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=Aw.of({square:n,piece:r})}getLowestPlayerPiece(e,t){const n=e.count(t);return t===bZ.ZERO?n-1:e.count(OZ.NONE)-n}showLastTransfer(e){const t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=Aw.of({square:r,piece:i});const s=e.landing.x,o=this.getLowestPlayerPiece(this.board[s],n);this.droppedPiece=Aw.of({square:s,piece:o})}showPossibleDrops(){this.displayableArrow=[];const e=this.getState();for(let t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(bZ.ZERO).get()>0&&this.displayableArrow.push({x:t,player:bZ.ZERO}),e.remaining.get(bZ.ONE).get()>0&&this.displayableArrow.push({x:t,player:bZ.ONE}))}getCircleCenter(e,t,n){const r=this.SPACE_SIZE/2,i=this.SPACE_SIZE/2;if(1===n.count(OZ.NONE))return new HW(r,i);const s=n.count(OZ.NONE),o=2*t*Math.PI/s-Math.PI/2,a=.3*this.SPACE_SIZE,l=a*Math.cos(o),c=a*Math.sin(o);return new HW(r+l,i+c)}canDisplayArrow(e,t){return this.displayableArrow.some(n=>n.x===e&&n.player.equals(t))}getArrowClasses(e,t){return[this.getPlayerClass(t)]}getBlockTransform(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(e){const t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected-stroke"):this.movedSquare.includes(e)&&t.push("last-move-stroke"),t}onArrowClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#dropArrow_"+(t===bZ.ZERO?"zero":"one")+"_"+e);if(r.isFailure())return n.cancelMove(r.getReason());const i=Vj.from(e);let s;if(n.selectedPiece.isPresent()){const e=n.selectedPiece.get().square;s=$j.transfer(Vj.from(e),i).get()}else s=$j.drop(i,t);const o=n.getState();return n.chooseMove(s,o)})()}getPieceClasses(e,t,n){const r={square:e,piece:t},i=[];let s=n.count(bZ.ZERO),o=n.count(bZ.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected-stroke");else if(this.droppedPiece.equalsValue(r))i.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.getState().getCurrentOpponent()===bZ.ZERO?s++:o++}const a=n.count(OZ.NONE)-(o+s),l=this.getPieceColor(t,s,a);return""!==l&&i.push(l),i}getPieceColor(e,t,n){return e<t?"player0-fill":e>=t+n?"player1-fill":""}onSquareClick(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#square_"+e);if(n.isFailure())return t.cancelMove(n.getReason());if(t.selectedPiece.isPresent()&&t.selectedPiece.get().square===e)return t.cancelMoveAttempt(),xw.SUCCESS;const r=t.getState().getCurrentPlayer(),i=t.board[e];return i.count(r)<=0?t.cancelMove(Bj.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=Aw.of({square:e,piece:t.getLowestPlayerPiece(i,r)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(Bj.NO_POSSIBLE_TRANSFER_REMAINS()):xw.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let e=this.selectedPiece.get().square-1;const t=this.getState().getCurrentPlayer();for(;0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}getRemainingPieceCx(e){return(e+.5)*this.PIECE_RADIUS*1.5}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-apagos"]],features:[Go],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"g"),la(2,Wj,1,3,"circle",1),la(3,jj,1,3,"circle",2),pa(),fa(4,"g",3),la(5,Xj,5,8,"g",4),pa(),pa()),2&e&&(ra("viewBox",-t.STROKE_WIDTH/2+" "+-t.STROKE_WIDTH/2+" "+(t.BOARD_WIDTH+t.STROKE_WIDTH)+" "+(t.BOARD_HEIGHT+t.STROKE_WIDTH)),ks(1),ra("transform","rotate("+180*t.role.value+" "+t.BOARD_WIDTH/2+" "+t.BOARD_HEIGHT/2+")"),ks(1),ha("ngForOf",t.range(t.remainingOne)),ks(1),ha("ngForOf",t.range(t.remainingZero)),ks(2),ha("ngForOf",t.board))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),eY=(()=>{class e extends GW{getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],features:[Go],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();class tY extends ij{constructor(e,t,n){super(e,t),this.captured=n}static getInitialState(){const e=AZ.createTable(6,2,4);return new tY(e,0,[0,0])}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let nY=(()=>{class e{}return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=()=>$localize`You cannot distribute from the opponent's home.`,e.MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`,e.SHOULD_DISTRIBUTE=()=>$localize`You should distribute but you do not.`,e})(),rY=(()=>{class e extends gj{applyLegalMove(t,n,r){Ow(e.VERBOSE,{called:"AwaleRules.applyLegalMove",move:t,state:n});const i=t.x,s=n.getCurrentPlayer(),o=n.getCurrentOpponent().value,a=n.getCopiedBoard(),l=e.distribute(i,o,a),c=l[l.length-1];return c.y===o?new tY(a,n.turn+1,n.captured):this.applyPotentialCapture(s,c,a,n)}applyPotentialCapture(t,n,r,i){const s=i.getCurrentOpponent(),o=[i.captured[0],i.captured[1]],a=e.captureIfLegal(n.x,n.y,t,r);o[t.value]+=a.capturedSum;const l=a.resultingBoard;if(e.mustMansoon(t,l)){const t=e.mansoon(s,l);return o[s.value]+=t.capturedSum,new tY(t.resultingBoard,i.turn+1,o)}return new tY(l,i.turn+1,o)}static mustMansoon(t,n){return e.isStarving(t,n)&&!1===e.canDistribute(t.getOpponent(),n)}static mansoon(e,t){const n=AZ.copyBiArray(t);let r=0;const i=[[0,0,0,0,0,0],[0,0,0,0,0,0]];let s=0;const o=e.getOpponent().value;do{r+=n[o][s],i[o][s]=n[o][s],n[o][s]=0,s++}while(s<6);return{capturedSum:r,captureMap:i,resultingBoard:n}}static isLegal(t,n){const r=n.getCurrentOpponent(),i=r.value,s=t.x;if(0===n.getPieceAtXY(s,i))return Mw.failure(nY.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=e.isStarving(r,n.board),a=!1===e.doesDistribute(s,i,n.board);return o&&a?Mw.failure(nY.SHOULD_DISTRIBUTE()):Mw.success(void 0)}isLegal(t,n){return e.isLegal(t,n)}static doesDistribute(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}static canDistribute(t,n){for(let r=0;r<6;r++)if(e.doesDistribute(r++,t.getOpponent().value,n))return!0;return!1}static isStarving(e,t){let n=0;const r=e.getOpponent().value;do{if(t[r][n++]>0)return!1}while(n<6);return!0}static distribute(e,t,n){const r=e,i=t;let s=n[t][e];const o=[];for(n[t][e]=0;s>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,o.push(new HW(e,t)),s--);return o}static capture(e,t,n,r){const i=AZ.copyBiArray(r);cZ(t!==n.getOpponent().value,"AwaleRules.capture cannot capture the players house");let s=i[t][e],o=0;const a=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(s<2||s>3)return{capturedSum:0,captureMap:a,resultingBoard:i};let l=-1,c=-1;n===bZ.ONE&&(l=1,c=6);do{a[t][e]=s,o+=s,i[t][e]=0,s=i[t][e+=l]}while(e!==c&&(2===s||3===s));return{capturedSum:o,captureMap:a,resultingBoard:i}}static captureIfLegal(t,n,r,i){const s=AZ.copyBiArray(i),o=e.capture(t,n,r,i),a=e.isStarving(r.getOpponent(),o.resultingBoard);return o.capturedSum>0&&a?{capturedSum:0,resultingBoard:s,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:o}static getGameStatus(e){const t=e.gameState;return t.captured[0]>24?pj.ZERO_WON:t.captured[1]>24?pj.ONE_WON:24===t.captured[0]&&24===t.captured[1]?pj.DRAW:pj.ONGOING}getGameStatus(t){return e.getGameStatus(t)}}return e.VERBOSE=!1,e})();class iY extends oj{constructor(e){super(),this.x=e}static from(e){switch(e){case 0:return iY.ZERO;case 1:return iY.ONE;case 2:return iY.TWO;case 3:return iY.THREE;case 4:return iY.FOUR;default:return cZ(5===e,"Invalid x for AwaleMove: "+e),iY.FIVE}}equals(e){return e===this||e.x===this.x}toString(){return"AwaleMove("+this.x+")"}}iY.ZERO=new iY(0),iY.ONE=new iY(1),iY.TWO=new iY(2),iY.THREE=new iY(3),iY.FOUR=new iY(4),iY.FIVE=new iY(5),iY.encoder=new class extends PZ{maxValue(){return 5}encodeNumber(e){return e.x}decodeNumber(e){return iY.from(e)}};class sY extends JW{getListMoves(e){const t=[],n=e.gameState,r=(n.turn+1)%2;let i,s=0;do{0!==n.getPieceAtXY(s,r)&&(i=iY.from(s),rY.isLegal(i,n).isSuccess()&&(i=iY.from(s),t.push(i))),s++}while(s<6);return this.orderMoves(e,t)}orderMoves(e,t){const n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent().value,i=n.value;return AZ.sortByDescending(t,t=>{const s=e.gameState.getCopiedBoard(),o=s[r][t.x],a=rY.distribute(t.x,r,s),l=a[a.length-1];let c,u=0;return l.y===r?(c=0,o<=6&&(u=10)):c=rY.captureIfLegal(l.x,i,n,s).capturedSum,100*c+u-o}),t}getBoardValue(e){const t=rY.getGameStatus(e);if(t.isEndGame)return ej.fromWinner(t.winner);const n=e.gameState.getCapturedCopy();return new ej(n[1]-n[0])}}class oY{constructor(){this.tutorial=[Cj.anyMove($localize`Sowing`,$localize`Awal is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown. The spaces in Awal are called the houses.
         As you're playing first, the 6 houses on the bottom are yours.<br/><br>
         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house.`,tY.getInitialState(),iY.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),Cj.anyMove($localize`Big sowing`,$localize`You are still the first player.
        When there are enough seeds to make a full turn, something else happens.<br/><br/>
        Sow the house that contains 12 seeds.`,new tY([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),iY.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),Cj.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>The houses on the bottom are yours, do a capture!`,new tY([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[iY.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),Cj.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>The houses on the bottom are yours, do a capture!`,new tY([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[iY.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),Cj.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>The houses on the bottom are yours, do a capture!`,new tY([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[iY.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),Cj.fromMove($localize`Capture on the other side only`,$localize`Your houses are the one below. Try to capture the two leftmost houses of the opponent.`,new tY([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[iY.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),Cj.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        Your houses are the one below. Try it.`,new tY([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[iY.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),Cj.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>Go ahead!`,new tY([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),iY.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),Cj.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>Your houses are still the bottom one, sow the leftmost house.`,new tY([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),iY.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}}function aY(e,t){if(1&e){const e=va();_n(),fa(0,"text",7),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onClick(t,n)}),Qa(1),pa()}if(2&e){const e=Sa().index,t=Sa().index,n=Sa();Ta("id","captured_",e,"_",t,""),ra("x",65+100*e)("y",81+120*t)("transform",n.getPieceRotation(e,t)),ks(1),Ja(" ",-n.captured[t][e]," ")}}function lY(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"circle",4),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),pa(),fa(2,"text",5),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),Qa(3),pa(),la(4,aY,2,6,"text",6),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();ks(1),Ta("id","click_",n,"_",r,""),ha("ngClass",i.getSpaceClasses(n,r)),ra("cx",i.getPieceCx(n))("cy",i.getPieceCy(r)),ks(1),Ta("id","number_",n,"__",r,""),ra("x",50+100*n)("y",66+120*r)("transform",i.getPieceRotation(n,r)),ks(1),Ja(" ",e," "),ks(1),ha("ngIf",i.captured[r][n]>0)}}function cY(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,lY,5,12,"g",2),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}let uY=(()=>{class e extends eY{constructor(e){super(e),this.last=Aw.empty(),this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.hasAsymetricBoard=!0,this.scores=Aw.of([0,0]),this.rules=new rY(tY),this.availableMinimaxes=[new sY(this.rules,"AwaleMinimax")],this.encoder=iY.encoder,this.tutorial=(new oY).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.scores=Aw.of(e.getCapturedCopy()),this.hidePreviousMove();const t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){const n=e.getCurrentPlayer().value;this.last=Aw.of(new HW(t.get().x,n)),this.showPreviousMove()}else this.last=Aw.empty()}hidePreviousMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}showPreviousMove(){const e=this.rules.node.move.get(),t=this.rules.node.mother.get().gameState,n=AZ.copyBiArray(t.board),r=t.getCurrentOpponent().value;this.filledCoords=rY.distribute(e.x,r,n);const i=this.filledCoords[this.filledCoords.length-1];if(i.y!==r){const e=rY.captureIfLegal(i.x,i.y,t.getCurrentPlayer(),n);this.captured=e.captureMap;const r=this.getState().getCurrentPlayer();rY.mustMansoon(r.getOpponent(),e.resultingBoard)&&(this.captured=rY.mansoon(r,e.resultingBoard).captureMap)}}onClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(t===n.getState().getCurrentPlayer().value)return n.cancelMove(nY.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());n.last=Aw.empty();const i=iY.from(e);return n.chooseMove(i,n.getState())})()}getSpaceClasses(e,t){const n=new HW(e,t),r="player"+(t+1)%2+"-fill";return this.captured[t][e]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(n)?["moved-stroke","last-move-stroke",r]:this.filledCoords.some(e=>e.equals(n))?["moved-stroke",r]:[r]}getPieceCx(e){return 50+100*e}getPieceCy(e){return 50+120*e}getPieceRotation(e,t){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(t)+")"}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-awale-component"]],features:[Go],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),ga(1,"rect",1),la(2,cY,2,1,"g",2),ga(3,"line",3),pa()),2&e&&(ra("transform",t.rotation),ks(2),ha("ngForOf",t.board))},directives:[Jd,Qd,tf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class hY extends aj{constructor(e,t){if(super(e.x,e.y),e.equals(t))throw new Error(XW.MOVE_CANNOT_BE_STATIC());this.end=t}static getEncoder(e,t,n){return new class extends PZ{constructor(){super(...arguments),this.shiftAX=t,this.shiftDY=this.shiftAX*e,this.shiftDX=this.shiftDY*t}maxValue(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}encodeNumber(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}decodeNumber(r){const i=r%t;r/=t;const s=new HW((r-=r%1)%e,i);r/=e;const o=(r-=r%1)%t;r/=t;const a=new HW((r-=r%1)%e,o);return n(a,s)}}}length(){return this.coord.getDistance(this.end)}getDirection(){return VW.factory.fromMove(this.coord,this.end)}}let dY=(()=>{class e{}return e.LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`,e.THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`,e.SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`,e.MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`,e})();class fY extends hY{constructor(e,t){if(super(e,t),e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+t.toString()+".");const n=e.getDirectionToward(t);if(n.isFailure()||n.get().isDiagonal())throw new Error(dY.MOVE_MUST_BE_ORTHOGONAL())}equals(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return"TaflMove("+this.coord+"->"+this.end+")"}}class pY extends fY{static of(e,t){return new pY(e,t)}static from(e,t){try{const n=new pY(e,t);return Mw.success(n)}catch(n){return Mw.failure(n.message)}}getMaximalDistance(){return 7}}pY.encoder=hY.getEncoder(7,7,pY.of);const gY={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:bZ.ZERO};class mY{constructor(e,t){this.owner=e,this.king=t}isKing(){return this.king}getOwner(){return this.owner}}mY.UNOCCUPIED=new mY(OZ.NONE,!1),mY.PLAYER_ONE_KING=new mY(OZ.ONE,!0),mY.INVADERS=new mY(OZ.ZERO,!1),mY.DEFENDERS=new mY(OZ.ONE,!1);class yY{constructor(e){this.value=e}}yY.NONE=new yY("NONE"),yY.OPPONENT=new yY("OPPONENT"),yY.PLAYER=new yY("PLAYER");class vY extends ij{isCentralThrone(e){return e.equals(this.getCentralThrone())}getCentralThrone(){const e=(this.board.length-1)/2;return new HW(e,e)}getRelativeOwner(e,t){const n=this.getAbsoluteOwner(t);let r;return r=n===OZ.NONE?yY.NONE:e===n?yY.PLAYER:yY.OPPONENT,r}getAbsoluteOwner(e){return this.getPieceAt(e).getOwner()}}class CY extends vY{static getInitialState(){const e=mY.UNOCCUPIED,t=mY.INVADERS,n=mY.DEFENDERS;return new CY([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,n,e,e,e],[t,t,n,mY.PLAYER_ONE_KING,n,t,t],[e,e,e,n,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}from(e,t){return new CY(e,t)}}let _Y=(()=>{class e extends gj{constructor(e,t,n){super(e),this.config=t,this.generateMove=n}isLegal(t,n){Ow(e.VERBOSE,{tablutRules_isLegal:{move:t,state:n}});const r=n.getCurrentPlayer(),i=this.getMoveValidity(r,t,n);return i.isFailure()?Mw.failure(i.getReason()):Mw.success(void 0)}getMoveValidity(e,t,n){const r=n.getRelativeOwner(e,t.coord);if(r===yY.NONE)return xw.failure(XW.MUST_CHOOSE_PLAYER_PIECE());if(r===yY.OPPONENT)return xw.failure(XW.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==yY.NONE)return xw.failure(dY.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return xw.failure(dY.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return xw.failure(dY.THRONE_IS_LEFT_FOR_GOOD())}const i=t.coord.getDirectionToward(t.end).get(),s=t.coord.getOrthogonalDistance(t.end);let o=t.coord.getNext(i);for(let a=1;a<s;a++){if(n.getPieceAt(o)!==mY.UNOCCUPIED)return xw.failure(XW.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return xw.SUCCESS}isThrone(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}isExternalThrone(e){const t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}tryCapture(e,t,n,r){const i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===yY.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):Aw.empty()}captureKing(e,t,n,r){const i=t.getNext(n),{backCoord:s,back:o,backInRange:a,left:l,leftCoord:c,right:u,rightCoord:h}=this.getSurroundings(i,n,e,r);return!1===a?this.captureKingAgainstTheWall(l,u,i):o===yY.NONE&&this.isThrone(r,s)?this.captureKingAgainstThrone(s,i,l,u):o===yY.PLAYER?this.captureKingWithAtLeastASandwich(r,i,l,c,u,h):Aw.empty()}getSurroundings(e,t,n,r){const i=e.getNext(t),s=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=s?r.getRelativeOwner(n,i):yY.NONE,a=e.getLeft(t),l=a.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,a):yY.NONE,c=e.getRight(t),u=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):yY.NONE;return{backCoord:i,back:o,backInRange:s,leftCoord:a,left:l,rightCoord:c,right:u}}captureKingAgainstTheWall(t,n,r){let i=t===yY.PLAYER?1:0;return i+=n===yY.PLAYER?1:0,2===i&&this.config.BORDER_CAN_SURROUND_KING?(Ow(e.VERBOSE||!1,"king captured by 3 invaders against 1 border"),Aw.of(r)):Aw.empty()}captureKingAgainstThrone(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return Aw.of(t)}else{const e=r===yY.PLAYER,i=n===yY.PLAYER||e;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&i)return Aw.of(t)}return Aw.empty()}capturePawn(t,n,r,i){const s=!1,o=n.getNext(r),a=o.getNext(r);let l=yY.NONE;return a.isInRange(this.config.WIDTH,this.config.WIDTH)&&(l=i.getRelativeOwner(t,a)),l===yY.NONE?!1===this.isThrone(i,a)?(Ow(e.VERBOSE||s,"cannot capture a pawn without an ally; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),Aw.empty()):(Ow(e.VERBOSE||s,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")"),Aw.of(o)):l===yY.PLAYER?(Ow(e.VERBOSE||s,"pawn captured by 2 opponents; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")"),Aw.of(o)):(Ow(e.VERBOSE||s,"no captures; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")"),Aw.empty())}captureKingWithAtLeastASandwich(t,n,r,i,s,o){if(!1===this.kingTouchCentralThrone(t,n)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return Aw.of(n);const a=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,l=this.isThrone(t,i),c=r===yY.PLAYER||l&&a,u=this.isThrone(t,o);return c&&(s===yY.PLAYER||u&&a)?(Ow(e.VERBOSE||!1,"king captured by 4 invaders"),Aw.of(n)):Aw.empty()}kingTouchCentralThrone(e,t){const n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}applyLegalMove(t,n){Ow(e.VERBOSE,{TablutRules_applyLegalMove:{move:t,state:n}});const r=n.turn,i=n.getCopiedBoard(),s=n.getCurrentPlayer(),o=t.coord,a=t.end;i[a.y][a.x]=i[o.y][o.x],i[o.y][o.x]=mY.UNOCCUPIED;for(const e of BW.ORTHOGONALS){const r=this.tryCapture(s,t.end,e,n);r.isPresent()&&(i[r.get().y][r.get().x]=mY.UNOCCUPIED)}return n.from(i,r+1)}getGameStatus(e){const t=this.getWinner(e.gameState);return t.isPresent()?pj.getVictory(t.get()):pj.ONGOING}getWinner(e){const t=!1,n=this.getKingCoord(e);if(n.isAbsent())return Ow(t,"The king is dead, victory to invader"),Aw.of(this.getInvader());const r=n.get();return this.isExternalThrone(r)?(Ow(t,"The king escape, victory to defender"),Aw.of(this.getDefender())):this.isPlayerImmobilized(bZ.ZERO,e)?(Ow(t,"Zero has no move, victory to one"),Aw.of(bZ.ONE)):this.isPlayerImmobilized(bZ.ONE,e)?(Ow(t,"One has no move, victory to zero"),Aw.of(bZ.ZERO)):(Ow(t,"no victory"),Aw.empty())}getKingCoord(t){Ow(e.VERBOSE,{TablutRules_getKingCoord:{state:t,con:this.config}});for(let e=0;e<this.config.WIDTH;e++)for(let n=0;n<this.config.WIDTH;n++)if(t.getPieceAtXY(n,e).isKing())return Aw.of(new HW(n,e));return Aw.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,t){return 0===this.getPlayerListMoves(e,t).length}getPlayerListMoves(t,n){const r=[],i=this.getPlayerListPawns(t,n);Ow(e.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:t,state:n}});for(const e of i){const t=this.getPossibleDestinations(e,n);for(const n of t){const t=this.generateMove(e,n);r.push(t)}}return r}getPlayerListPawns(e,t){const n=[];for(let r=0;r<this.config.WIDTH;r++)for(let i=0;i<this.config.WIDTH;i++){const s=new HW(i,r);t.getAbsoluteOwner(s)===e&&n.push(s)}return n}getPossibleDestinations(e,t){const n=[];let r;for(const i of BW.ORTHOGONALS){r=e.getNext(i,1);let s=!1;for(;r.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(r)===OZ.NONE?this.isExternalThrone(r)?t.getPieceAt(e).isKing()&&n.push(r):t.isCentralThrone(r)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&n.push(r):n.push(r):s=!0,r=r.getNext(i,1)}return n}}return e.VERBOSE=!1,e})();class EY extends _Y{constructor(){super(CY,gY,pY.of)}static get(){return null==EY.singleton&&(EY.singleton=new EY),fj.ruler=this.singleton,EY.singleton}}class wY extends eY{constructor(e,t,n){super(e),this.VERBOSE=t,this.generateMove=n,this.viewInfo={pieceClasses:[]},this.EMPTY=mY.UNOCCUPIED,this.captureds=[],this.chosen=Aw.empty(),this.lastMove=Aw.empty()}getViewBox(){const e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}updateBoard(){Ow(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.getState().getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}showPreviousMove(){const e=this.rules.node.mother.get().gameState,t=this.getState().getCurrentOpponent();for(const n of BW.ORTHOGONALS){const r=this.lastMove.get().end.getNext(n,1);if(r.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const n=e.getRelativeOwner(t,r)===yY.OPPONENT,i=this.getState().getPieceAt(r)===mY.UNOCCUPIED;n&&i&&this.captureds.push(r)}}}updateViewInfo(){const e=[];for(let t=0;t<this.board.length;t++){const n=[];for(let e=0;e<this.board[0].length;e++){let r=[];r=this.board[t][e].getOwner()===OZ.NONE?[""]:this.getPieceClasses(e,t),n.push(r)}e.push(n)}this.viewInfo={pieceClasses:e}}onClick(e,t){var n=this;return Sw(function*(){Ow(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")");const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new HW(e,t);return n.chosen.equalsValue(i)?(n.cancelMoveAttempt(),xw.SUCCESS):n.chosen.isAbsent()||n.pieceBelongToCurrentPlayer(i)?n.choosePiece(i):n.chooseDestination(e,t)})()}chooseDestination(e,t){var n=this;return Sw(function*(){Ow(n.VERBOSE,"TaflComponent.chooseDestination");const r=n.chosen.get(),i=new HW(e,t),s=n.generateMove(r,i);return s.isSuccess()?yield n.chooseMove(s.get(),n.getState()):n.cancelMove(s.getReason())})()}choosePiece(e){return Ow(this.VERBOSE,"TaflComponent.choosePiece"),this.board[e.y][e.x]===mY.UNOCCUPIED?this.cancelMove(XW.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e)?(this.chosen=Aw.of(e),this.updateViewInfo(),Ow(this.VERBOSE,"selected piece = ("+e.x+", "+e.y+")"),xw.SUCCESS):this.cancelMove(XW.CANNOT_CHOOSE_OPPONENT_PIECE())}pieceBelongToCurrentPlayer(e){const t=this.getState(),n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===yY.PLAYER}cancelMoveAttempt(){this.chosen=Aw.empty(),this.updateViewInfo()}isThrone(e,t){const n=this.getState();return this.rules.isThrone(n,new HW(e,t))}isCentralThrone(e,t){return this.getState().isCentralThrone(new HW(e,t))}getPieceClasses(e,t){const n=[],r=new HW(e,t),i=this.getState().getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equalsValue(r)&&n.push("selected-stroke"),n}getRectClasses(e,t){const n=[],r=new HW(e,t);if(this.captureds.some(e=>e.equals(r)))n.push("captured-fill");else if(this.lastMove.isPresent()){const e=this.lastMove.get().coord,t=this.lastMove.get().end;(r.equals(e)||r.equals(t))&&n.push("moved-fill")}return n}getClickables(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const r=new HW(n,t);this.isClickable(r)&&e.push(r)}return e}isClickable(e){return this.pieceBelongToCurrentPlayer(e)}isInvader(e,t){return this.board[t][e]===mY.INVADERS}isKing(e,t){return this.board[t][e].isKing()}}class PY extends JW{getListMoves(e){Ow(!1,{TaflMinimax_getListMoves:{node:e}});const t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}orderMoves(e,t){const n=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?AZ.sortByDescending(t,e=>-e.end.getOrthogonalDistance(n)):AZ.sortByDescending(t,e=>e.coord.equals(n)?this.ruler.isExternalThrone(e.end)?2:1:0),t}getBoardValue(e){const t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new ej(n.get().getVictoryValue());const r=this.ruler.getPlayerListPawns(bZ.ZERO,t).length,i=this.ruler.getPlayerListPawns(bZ.ONE,t).length;let s=[1,2][this.ruler.config.INVADER.value];s*=bZ.ZERO.getScoreModifier();let o=[2,1][this.ruler.config.INVADER.value];return o*=bZ.ONE.getScoreModifier(),new ej(r*s+i*o)}}class SY{constructor(e,t){this.directThreats=e,this.mover=t}equals(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}class bY extends SY{constructor(e,t){super(new nj([e]),t),this.directThreat=e,this.mover=t}}class OY extends nj{constructor(e){if(super(),this.map=[],this.values=[],void 0!==e)for(const t of e)this.add(t)}add(e){const t=this.toFields(e);let n=this.map;for(const i of t[0])void 0===n[i]&&(n[i]=[]),n=n[i];const r=t[1];return void 0===n[r]&&(n[r]=!0,this.values.push(e),!0)}contains(e){const t=this.toFields(e);let n=this.map;for(const r of t[0]){if(void 0===n[r])return!1;n=n[r]}return void 0!==n[t[1]]}[Symbol.iterator](){return this.values.values()}}class kY extends OY{toFields(e){return[[e.y],e.x]}}class TY extends PY{constructor(e,t){super(e,t),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return new ej(t.toBoardValue());const n=e.gameState,r=mY.UNOCCUPIED;let i=0;const s=this.getPiecesMap(n),o=this.getThreatMap(n,s),a=this.filterThreatMap(o,n);for(const l of bZ.PLAYERS)for(const e of s.get(l).get())if(a.get(e).isPresent())i+=l.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=l.getScoreModifier()*this.scoreBySafePiece;let t=0;for(const i of BW.ORTHOGONALS){let s=e.getNext(i,1);for(;s.isInRange(this.width,this.width)&&n.getPieceAt(s)===r;)t++,s=s.getNext(i,1)}i+=t*l.getScoreModifier()}return new ej(i)}getPiecesMap(e){const t=mY.UNOCCUPIED,n=[],r=[];for(let i=0;i<this.width;i++)for(let s=0;s<this.width;s++){const o=new HW(s,i);e.getPieceAt(o)!==t&&(e.getAbsoluteOwner(o)===bZ.ZERO?n.push(o):r.push(o))}return new uj([{key:bZ.ZERO,value:new kY(n)},{key:bZ.ONE,value:new kY(r)}])}getThreatMap(e,t){const n=new uj;for(const r of bZ.PLAYERS)for(const i of t.get(r).get()){const t=this.getThreats(i,e);this.isThreatReal(i,e,t)&&n.set(i,new nj(t))}return n}getThreats(e,t){const n=t.getAbsoluteOwner(e);cZ(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const r=n.getOpponent(),i=[];for(const s of BW.ORTHOGONALS){const n=e.getPrevious(s,1);if(this.isAThreat(n,t,r)){const o=[];for(const n of BW.ORTHOGONALS){if(n===s.getOpposite())continue;let i=e.getNext(s,1);for(;i.isInRange(this.width,this.width)&&t.getPieceAt(i)===mY.UNOCCUPIED;)i=i.getNext(n);i.isInRange(this.width,this.width)&&t.getAbsoluteOwner(i)===r&&!1===e.getNext(s,1).equals(i)&&o.push(i)}i.push(new bY(n,new kY(o)))}}return i}isAThreat(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==bZ.ONE&&t.getPieceAt(e)!==mY.UNOCCUPIED))}isThreatReal(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;for(const r of n)if(r.mover.size()>0)return!0;return!1}filterThreatMap(e,t){const n=new uj,r=e.listKeys(),i=r.filter(e=>t.getAbsoluteOwner(e)===t.getCurrentPlayer()),s=new kY(r.filter(e=>t.getAbsoluteOwner(e)===t.getCurrentOpponent()));for(const o of i){const t=e.get(o).get(),r=[];for(const e of t)if(!1===s.contains(e.directThreat)){const t=[];for(const n of e.mover)!1===s.contains(n)&&t.push(n);t.length>0&&r.push(new bY(e.directThreat,new kY(t)))}r.length>0&&n.set(o,new nj(r))}for(const o of s){const t=e.get(o).get();n.set(o,t)}return n}}class IY extends TY{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return new ej(t.toBoardValue());const n=e.gameState,r=this.ruler.config.WIDTH,i=mY.UNOCCUPIED;let s=0;const o=this.getPiecesMap(n),a=this.getThreatMap(n,o),l=this.filterThreatMap(a,n);for(const c of bZ.PLAYERS){const e=new kY;for(const t of o.get(c).get())if(l.get(t).isPresent())s+=c.getScoreModifier()*IY.SCORE_BY_THREATENED_PIECE;else{s+=c.getScoreModifier()*IY.SCORE_BY_SAFE_PIECE;for(const s of BW.ORTHOGONALS){let o=t.getNext(s,1);for(;o.isInRange(r,r)&&n.getPieceAt(o)===i;)e.add(o),o=o.getNext(s,1)}}for(const t of e){const e=this.getControlledPieceValue(t.x,t.y,r);s+=c.getScoreModifier()*e}}return new ej(s)}getControlledPieceValue(e,t,n){let r=1;return(0===e||e===n-1)&&(r*=n),(0===t||t===n-1)&&(r*=n),r}}IY.SCORE_BY_THREATENED_PIECE=530,IY.SCORE_BY_SAFE_PIECE=16*IY.SCORE_BY_THREATENED_PIECE+1;class AY extends IY{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return new ej(t.toBoardValue());const n=e.gameState,r=this.ruler.config.WIDTH,i=mY.UNOCCUPIED;let s=0,o=0,a=0;const l=this.getPiecesMap(n),c=this.getThreatMap(n,l),u=this.filterThreatMap(c,n);for(const d of bZ.PLAYERS){const e=new kY;for(const t of l.get(d).get())if(u.get(t).isPresent())o+=d.getScoreModifier();else{s+=d.getScoreModifier();for(const s of BW.ORTHOGONALS){let o=t.getNext(s,1);for(;o.isInRange(r,r)&&n.getPieceAt(o)===i;)e.add(o),o=o.getNext(s,1)}}for(const t of e){const e=this.getControlledPieceValue(t.x,t.y,r);a+=d.getScoreModifier()*e}}const h=this.getStepForEscape(n);return new ej(531*h*17*17+531*s*17+531*o+a)}getStepForEscape(e){const t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}_getStepForEscape(e,t,n,r){const i=this.getNextGen(e,n,r);return 0===i.length?Aw.empty():i.some(e=>this.ruler.isExternalThrone(e))?Aw.of(t):(t++,r.push(...i),this._getStepForEscape(e,t,i,r))}getNextGen(e,t,n){const r=[];for(const i of t)for(const t of BW.ORTHOGONALS){let s=i.getNext(t,1);for(;s.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&e.getPieceAt(s)===mY.UNOCCUPIED;)n.every(e=>!1===e.equals(s))&&r.push(s),s=s.getNext(t,1)}return r}}AY.SCORE_BY_THREATENED_PIECE=530,AY.SCORE_BY_SAFE_PIECE=16*IY.SCORE_BY_THREATENED_PIECE+1,AY.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];const MY=mY.UNOCCUPIED,NY=mY.INVADERS,RY=mY.DEFENDERS,xY=mY.PLAYER_ONE_KING;class DY{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,CY.getInitialState()),Cj.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,CY.getInitialState(),pY.of(new HW(3,1),new HW(1,1)),$localize`Congratulations!`),Cj.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it.`,new CY([[MY,MY,MY,NY,MY,MY,MY],[MY,MY,MY,NY,MY,MY,MY],[NY,MY,MY,RY,MY,MY,MY],[MY,MY,RY,xY,RY,NY,NY],[MY,MY,NY,MY,MY,MY,MY],[MY,MY,MY,RY,MY,NY,MY],[MY,MY,MY,NY,MY,MY,MY]],1),[pY.of(new HW(3,5),new HW(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),Cj.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it.`,new CY([[MY,MY,MY,NY,MY,MY,MY],[MY,MY,NY,MY,MY,MY,MY],[MY,MY,MY,RY,MY,MY,MY],[NY,RY,MY,MY,RY,NY,NY],[MY,RY,MY,MY,MY,MY,MY],[MY,NY,MY,xY,MY,NY,MY],[MY,MY,MY,NY,MY,MY,MY]],12),[pY.of(new HW(2,1),new HW(3,1)),pY.of(new HW(3,0),new HW(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),Cj.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king.`,new CY([[MY,MY,MY,MY,MY,MY,MY],[MY,MY,MY,RY,MY,MY,MY],[MY,MY,MY,NY,MY,MY,MY],[MY,NY,MY,xY,NY,MY,MY],[MY,MY,MY,NY,MY,MY,MY],[MY,RY,MY,MY,MY,MY,MY],[MY,MY,MY,MY,MY,MY,MY]],72),[pY.of(new HW(1,3),new HW(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),Cj.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king.`,new CY([[MY,MY,NY,MY,MY,MY,MY],[MY,MY,MY,NY,MY,MY,MY],[MY,MY,MY,xY,NY,MY,MY],[MY,NY,RY,MY,RY,MY,MY],[MY,MY,MY,NY,MY,MY,MY],[MY,MY,MY,MY,MY,MY,MY],[MY,MY,MY,MY,MY,MY,MY]],72),[pY.of(new HW(2,0),new HW(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`),Cj.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king.`,new CY([[MY,MY,MY,MY,MY,MY,MY],[MY,MY,MY,MY,MY,MY,MY],[MY,NY,MY,NY,MY,MY,MY],[NY,MY,MY,MY,RY,MY,MY],[MY,MY,MY,RY,MY,MY,MY],[MY,MY,MY,MY,MY,MY,MY],[MY,xY,MY,NY,MY,MY,MY]],72),[pY.of(new HW(3,6),new HW(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`)]}}function LY(e,t){1&e&&(_n(),ga(0,"polygon",8))}function FY(e,t){1&e&&(_n(),ga(0,"rect",9))}function UY(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,LY,1,0,"polygon",6),la(2,FY,1,0,"ng-template",null,7,ju),pa()),2&e){const e=ca(3),t=Sa().index,n=Sa().index,r=Sa();ks(1),ha("ngIf",r.isCentralThrone(t,n))("ngIfElse",e)}}function VY(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"line",13),ga(2,"line",13),ga(3,"line",13),ga(4,"line",13),ga(5,"line",13),pa()),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.04*n.SPACE_SIZE)("x2",.5*n.SPACE_SIZE)("y2",.96*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.1*n.SPACE_SIZE)("y2",.6*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.9*n.SPACE_SIZE)("y2",.6*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.4*n.SPACE_SIZE)("x2",.15*n.SPACE_SIZE)("y2",.75*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.4*n.SPACE_SIZE)("x2",.85*n.SPACE_SIZE)("y2",.75*n.SPACE_SIZE)}}function BY(e,t){if(1&e&&(_n(),ga(0,"polyline",16)),2&e){const e=Sa(3).index,t=Sa().index;ha("ngClass",Sa().viewInfo.pieceClasses[t][e])}}function $Y(e,t){if(1&e&&(_n(),ga(0,"line",13),ga(1,"line",13),ga(2,"line",13),ga(3,"line",13)),2&e){const e=Sa(3).index,t=Sa().index,n=Sa();ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.04*n.SPACE_SIZE)("x2",.5*n.SPACE_SIZE)("y2",.96*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.04*n.SPACE_SIZE)("y1",.5*n.SPACE_SIZE)("x2",.96*n.SPACE_SIZE)("y2",.5*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.2*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.8*n.SPACE_SIZE)("y2",.8*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.8*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.2*n.SPACE_SIZE)("y2",.8*n.SPACE_SIZE)}}function zY(e,t){if(1&e&&(_n(),la(0,BY,1,1,"polyline",14),la(1,$Y,4,20,"ng-template",null,15,ju)),2&e){const e=ca(2),t=Sa(2).index,n=Sa().index;ha("ngIf",Sa().isKing(t,n))("ngIfElse",e)}}function HY(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",10),la(2,VY,6,25,"g",11),la(3,zY,3,2,"ng-template",null,12,ju),pa()),2&e){const e=ca(4),t=Sa().index,n=Sa().index,r=Sa();ks(1),Ta("id","piece_",t,"_",n,""),ha("ngClass",r.viewInfo.pieceClasses[n][t]),ra("r",r.SPACE_SIZE/2-r.STROKE_WIDTH)("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE),ks(1),ha("ngIf",r.isInvader(t,n))("ngIfElse",e)}}function GY(e,t){if(1&e){const e=va();_n(),fa(0,"g",3),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),ga(1,"rect",4),la(2,UY,4,2,"g",5),la(3,HY,5,8,"g",5),pa()}if(2&e){const e=t.index,n=Sa().index,r=Sa();Ta("id","click_",e,"_",n,""),ra("transform","translate("+r.SPACE_SIZE*e+", "+r.SPACE_SIZE*n+")"),ks(1),ha("ngClass",r.getRectClasses(e,n)),ra("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),ks(1),ha("ngIf",r.board[n][e]===r.EMPTY&&r.isThrone(e,n)),ks(1),ha("ngIf",r.board[n][e]!==r.EMPTY)}}function ZY(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,GY,4,8,"g",2),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function qY(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",17),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();ks(1),Ta("id","click_",e.x,"_",e.y,""),ra("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let WY=(()=>{class e extends wY{constructor(e){super(e,!1,pY.from),this.rules=EY.get(),this.availableMinimaxes=[new PY(this.rules,"DummyBot"),new TY(this.rules,"Piece > Influence"),new IY(this.rules,"Piece > Control"),new AY(this.rules,"Escape > Piece > Control")],this.encoder=pY.encoder,this.tutorial=(new DY).tutorial}ngOnInit(){this.updateBoard()}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-brandhub"]],features:[Go],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,ZY,2,1,"g",1),la(2,qY,2,6,"g",1),pa()),2&e&&(ra("viewBox",t.getViewBox()),ks(1),ha("ngForOf",t.board),ks(1),ha("ngForOf",t.getClickables()))},directives:[Jd,Qd,tf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),jY=(()=>{class e extends GW{constructor(){super(...arguments),this.SPACE_SIZE=50}getTriangleCornerCoords(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}getTriangleCoordinate(e,t){return this.getTriangleCornerCoords(e,t).map(e=>e.x+","+e.y).reduce((e,t)=>e+","+t)}getDownwardCoordinate(e,t){const n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,s=this.SPACE_SIZE*(t+1),o=new HW(.5*this.SPACE_SIZE*e,i);return[o,new HW(n,s),new HW(r,i),o]}getUpwardCoordinate(e,t){const n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,s=this.SPACE_SIZE*(t+1),o=new HW(.5*this.SPACE_SIZE*e,s);return[o,new HW(n,i),new HW(r,s),o]}getPyramidCoordinate(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}getDownwardPyramidCoordinate(e,t){const n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,s=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),a=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}getUpwardPyramidCoordinate(e,t){const n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,s=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),a=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],features:[Go],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})(),YY=(()=>{class e{}return e.INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`,e.NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`,e.FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`,e.CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`,e.CANNOT_CAPTURE_OWN_PIECES=()=>$localize`You cannot capture your own pieces.`,e})();class KY{constructor(e,t){this.direction=e,this.str=t}static fromCoords(e,t){const n=e.getVectorToward(t),r=KY.STEPS.findIndex(e=>e.direction.equals(n));if(-1===r)throw new Error(YY.INVALID_DISTANCE());return KY.STEPS[r]}toInt(){return KY.STEPS.findIndex(e=>e.direction.equals(this.direction))}equals(e){return this===e}toString(){return this.str}}KY.LEFT=new KY(new LW(-2,0),"LEFT"),KY.UP_LEFT=new KY(VW.UP_LEFT,"UP_LEFT"),KY.UP_RIGHT=new KY(VW.UP_RIGHT,"UP_RIGHT"),KY.RIGHT=new KY(new LW(2,0),"RIGHT"),KY.DOWN_LEFT=new KY(VW.DOWN_LEFT,"DOWN_LEFT"),KY.DOWN_RIGHT=new KY(VW.DOWN_RIGHT,"DOWN_RIGHT"),KY.STEPS=[KY.LEFT,KY.UP_LEFT,KY.UP_RIGHT,KY.RIGHT,KY.DOWN_LEFT,KY.DOWN_RIGHT];class QY extends oj{constructor(e,t,n,r){super(),this.start=e,this.step=t,this.landingCoord=n,this.capture=r}static fromMovement(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");const n=new HW(e.x+t.direction.x,e.y+t.direction.y);if(n.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new QY(Aw.of(e),Aw.of(t),Aw.of(n),Aw.empty())}static fromTilesExchange(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new QY(Aw.empty(),Aw.empty(),Aw.empty(),Aw.of(e))}static fromCoordToCoord(e,t){const n=KY.fromCoords(e,t);return QY.fromMovement(e,n)}isTileExchange(){return this.capture.isPresent()}toString(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}equals(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}QY.encoder=new class extends PZ{maxValue(){return 1035}encodeNumber(e){if(e.isTileExchange()){const t=e.capture.get().y;return 10*e.capture.get().x+t}{const t=e.start.get().y,n=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*n+t}}decodeNumber(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");const t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?QY.fromTilesExchange(new HW(n,t)):QY.fromMovement(new HW(n,t),KY.STEPS[e-1])}};class XY{static getNeighbors(e){let t;const n=new HW(e.x-1,e.y),r=new HW(e.x+1,e.y);return t=(e.x+e.y)%2==1?[n,r,new HW(e.x,e.y-1)]:[n,r,new HW(e.x,e.y+1)],t}static getFakeNeighbors(e){return new HW(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}static getCommonNeighbor(e,t){const n=XY.getNeighbors(e),r=XY.getNeighbors(t);let i=0;for(;i<n.length;){const e=n[i];let t=0;for(;t<r.length;){if(e.equals(r[t]))return Aw.of(e);t++}i++}return Aw.empty()}static isSpaceDark(e){return(e.x+e.y)%2==0}}class JY extends ij{static getEmptyNeighbors(e,t,n){const r=[];for(const i of XY.getNeighbors(t))i.isInRange(e[0].length,e.length)&&e[i.y][i.x]===n&&r.push(i);return r}getEmptyNeighbors(e,t){return JY.getEmptyNeighbors(this.board,e,t)}}class eK extends JY{constructor(e,t,n,r){super(e,t),this.tiles=n,this.captures=r}static getTilesUpperLeftCoord(e){const t=e.x-e.x%3;let n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new HW(t,n)}static getPresentNeighborEntrances(e){return[new HW(e.x+1,e.y-1),new HW(e.x+3,e.y+0),new HW(e.x+3,e.y+1),new HW(e.x+1,e.y+2),new HW(e.x-1,e.y+1),new HW(e.x-1,e.y+0)].filter(eK.isInRange)}static getInitialState(){const e=qW.EMPTY,t=qW.UNREACHABLE,n=qW.ZERO,r=qW.ONE;return new eK([[t,t,t,t,t,t,n,e,n,t,t,t,t,t,t],[t,t,t,e,e,n,e,e,e,n,e,e,t,t,t],[e,r,e,r,e,e,n,e,n,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[e,n,e,n,e,e,e,e,e,e,e,n,e,n,e],[n,e,e,e,n,e,e,e,e,e,n,e,e,e,n],[e,n,e,n,e,e,r,e,r,e,e,n,e,n,e],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t]],0,[0,0],[0,0])}applyLegalMovement(e){Ow(eK.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});const t=e.start.get(),n=e.landingCoord.get(),r=this.getCopiedBoard();return r[n.y][n.x]=qW.ofPlayer(this.getCurrentPlayer()),r[t.y][t.x]=qW.EMPTY,new eK(r,this.turn,this.tiles,this.captures)}doMovementCaptures(e){Ow(eK.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});const t=this.getCapturedNeighbors(e.landingCoord.get());let n=this;for(const r of t)n=n.capture(r);return n}getCapturedNeighbors(e){const t=this.getCurrentOpponent();return XY.getNeighbors(e).filter(e=>!e.isNotInRange(15,10)&&!!this.getPieceAt(e).is(t)&&this.isSurrounded(e))}isSurrounded(e){return 0===this.getEmptyNeighbors(e,qW.EMPTY).length}capture(e){Ow(eK.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});const t=this.getCopiedBoard(),n=[this.captures[0],this.captures[1]];return Ow(eK.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=qW.EMPTY,n[this.getCurrentPlayer().value]+=1,new eK(t,this.turn,this.tiles,n)}removeTilesIfNeeded(e,t){Ow(eK.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:e,countTiles:t}});let n=this;const r=eK.getTilesUpperLeftCoord(e);if(this.isTileEmpty(r)&&this.isDeconnectable(r)){n=this.deconnectTile(r,t);const e=eK.getPresentNeighborEntrances(r);for(const r of e){const e=n.getPieceAt(r);e===qW.EMPTY?n=n.removeTilesIfNeeded(r,t):e.is(this.getCurrentOpponent())&&n.isSurrounded(r)&&(n=n.capture(r))}}return n}isTileEmpty(e){cZ(this.getPieceAt(e)!==qW.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let t=0;t<2;t++)for(let n=0;n<3;n++){const r=e.getNext(new LW(n,t),1);if(this.getPieceAt(r)!==qW.EMPTY)return!1}return!0}isDeconnectable(e){const t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;let n=0;for(let r=1;r<t.length;r++)!1===this.areNeighbor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}areNeighbor(e,t){return e+1===t||0===e&&5===t}getPresentNeighborTilesRelativeIndexes(e){const t=[];let n=Aw.empty();for(let r=0;r<6;r++){const i=e.getNext(eK.NEIGHBORS_TILES_DIRECTIONS[r],1);i.isInRange(15,10)&&this.getPieceAt(i)!==qW.UNREACHABLE&&(n.isAbsent()&&(n=Aw.of(r)),t.push(r-n.get()))}return t}deconnectTile(e,t){Ow(eK.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});const n=this.getCopiedBoard(),r=e.x,i=e.y;for(let o=0;o<2;o++)for(let e=0;e<3;e++)n[i+o][r+e]=qW.UNREACHABLE;const s=[this.tiles[0],this.tiles[1]];return t&&(s[this.getCurrentPlayer().value]+=1),new eK(n,this.turn,s,this.captures)}getLegalLandings(e){const t=[];for(const n of KY.STEPS){const r=e.getNext(n.direction,1);this.isOnBoard(r)&&this.getPieceAt(r)===qW.EMPTY&&t.push(r)}return t}getPiecesByFreedom(){const e=[[0,0,0,0],[0,0,0,0]];for(let t=0;t<10;t++)for(let n=0;n<15;n++){const r=this.board[t][n];if(r.isPlayer()){const i=this.getEmptyNeighbors(new HW(n,t),qW.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}eK.VERBOSE=!1,eK.NEIGHBORS_TILES_DIRECTIONS=[new LW(0,-2),new LW(3,-1),new LW(3,1),new LW(0,2),new LW(-3,1),new LW(-3,-1)],eK.isInRange=e=>e.isInRange(15,10);let tK=(()=>{class e extends gj{applyLegalMove(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}applyLegalTileExchange(t,n){const r=n.getCopiedBoard(),i=t.capture.get();r[i.y][i.x]=qW.EMPTY;const s=[n.captures[0],n.captures[1]];s[n.getCurrentPlayer().value]+=1;const o=[n.tiles[0],n.tiles[1]];o[n.getCurrentPlayer().value]-=2;const a=new eK(r,n.turn,o,s),l=a.removeTilesIfNeeded(i,!1),c=new eK(l.getCopiedBoard(),l.turn+1,l.tiles,l.captures);return Ow(e.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:n,afterCapture:a,afterTileRemoval:l,resultingState:c}}),c}applyLegalMovement(t,n){const r=n.applyLegalMovement(t),i=r.removeTilesIfNeeded(t.start.get(),!0),s=i.doMovementCaptures(t),o=new eK(s.board,n.turn+1,s.tiles,s.captures);return Ow(e.VERBOSE,{ab_state:n,afterMovement:r,afterTilesRemoved:i,afterCaptures:s,resultingState:o}),o}isLegal(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}isLegalTileExchange(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return Mw.failure(YY.NOT_ENOUGH_TILES_TO_EXCHANGE());const n=t.getPieceAt(e.capture.get());return n===qW.UNREACHABLE||n===qW.EMPTY?Mw.failure(YY.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?Mw.failure(YY.CANNOT_CAPTURE_OWN_PIECES()):Mw.success(void 0)}isLegalMovement(e,t){if(t.getPieceAt(e.start.get())===qW.UNREACHABLE){const t="Cannot start with a coord outside the board "+e.start.get().toString()+".";return Mw.failure(t)}if(t.getPieceAt(e.landingCoord.get())===qW.UNREACHABLE){const t="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return Mw.failure(t)}const n=t.getPieceAt(e.start.get());return n===qW.EMPTY?Mw.failure(XW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.is(t.getCurrentOpponent())?Mw.failure(XW.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?Mw.failure(XW.MUST_LAND_ON_EMPTY_SPACE()):Mw.success(void 0)}static getGameStatus(e){const t=e.gameState;return t.captures[0]>=18?pj.ZERO_WON:t.captures[1]>=18?pj.ONE_WON:pj.ONGOING}getGameStatus(t){return e.getGameStatus(t)}}return e.VERBOSE=!1,e})();class nK extends JW{getListMoves(e){let t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}getListExchanges(e){const t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=qW.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(let s=0;s<10;s++)for(let e=0;e<15;e++){const r=new HW(e,s);if(n.getPieceAt(r)===i){const e=QY.fromTilesExchange(r);t.push(e)}}return t}getListMovement(e){const t=[],n=e.gameState,r=n.getCurrentPlayer();for(let i=0;i<10;i++)for(let e=0;e<15;e++){const s=new HW(e,i);if(n.getPieceAt(s).is(r)){const e=n.getLegalLandings(s);for(const n of e){const e=QY.fromCoordToCoord(s,n);t.push(e)}}}return t}getBoardValue(e){const t=tK.getGameStatus(e);if(t.isEndGame)return ej.fromWinner(t.winner);const n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new ej(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}getPiecesScore(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}getPlayerPiecesScore(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}putCaptureFirst(e,t){return AZ.sortByDescending(t,t=>this.moveCapturesList(e,t).length),t}moveCapturesList(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}let rK=(()=>{class e extends nK{getBoardValue(t){const n=tK.getGameStatus(t);if(n.isEndGame)return ej.fromWinner(n.winner);const r=t.gameState,i=this.getPiecesMap(r),s=this.getThreatMap(r,i),o=this.filterThreatMap(s,r);let a=0;for(const l of bZ.PLAYERS)for(const t of i.get(l).get())o.get(t).isPresent()?a+=l.getScoreModifier()*e.SCORE_BY_THREATENED_PIECE:a+=l.getScoreModifier()*e.SCORE_BY_SAFE_PIECE;return a+=r.tiles[1]-r.tiles[0],new ej(a)}getPiecesMap(e){const t=new uj,n=[],r=[];for(let i=0;i<10;i++)for(let t=0;t<15;t++){const s=new HW(t,i),o=e.getPieceAt(s);o===qW.ZERO?n.push(s):o===qW.ONE&&r.push(s)}return t.set(bZ.ZERO,new kY(n)),t.set(bZ.ONE,new kY(r)),t}getThreatMap(e,t){const n=new uj;for(const r of bZ.PLAYERS)for(const i of t.get(r).get()){const t=this.getThreat(i,e);t.isPresent()&&n.set(i,t.get())}return n}getThreat(e,t){const n=bZ.of(t.getPieceAt(e).value).getOpponent();let r=Aw.empty(),i=Aw.empty(),s=[];const o=XY.getNeighbors(e).filter(e=>e.isInRange(15,10));for(const a of o){const e=t.getPieceAt(a);if(e.is(n))s.push(a),this.tileCouldBeRemovedThisTurn(a,t,n)&&(i=Aw.of(a));else if(e===qW.EMPTY){if(r.isPresent())return Aw.empty();r=Aw.of(a)}}if(r.isPresent()){const e=[];for(const i of KY.STEPS){const o=r.get().getNext(i.direction,1);o.isInRange(15,10)&&t.getPieceAt(o).is(n)&&!1===s.some(e=>e.equals(o))&&e.push(o)}if(e.length>0)return Aw.of(new SY(new kY(s),new kY(e)))}if(i.isPresent()){s=s.filter(e=>e.equals(i.get()));const e=new kY(s);return Aw.of(new SY(e,new kY([i.get()])))}return Aw.empty()}tileCouldBeRemovedThisTurn(e,t,n){const r=n.getOpponent();if(!1===t.isDeconnectable(e))return!1;let i=Aw.empty();const s=eK.getTilesUpperLeftCoord(e);for(let o=0;o<2;o++)for(let e=0;e<3;e++){const a=s.getNext(new LW(e,o),1);if(t.getPieceAt(a).is(n)){if(!this.pieceCouldLeaveTheTile(a,t))return!1;i=Aw.of(a)}else if(t.getPieceAt(a).is(r))return!1}return i.isPresent()}pieceCouldLeaveTheTile(e,t){const n=eK.getTilesUpperLeftCoord(e);for(const r of KY.STEPS){const i=e.getNext(r.direction,1),s=eK.getTilesUpperLeftCoord(i);if(!1===n.equals(s)&&t.getPieceAt(i)===qW.EMPTY)return!0}return!1}filterThreatMap(e,t){const n=new uj,r=e.listKeys(),i=r.filter(e=>t.getPieceAt(e).is(t.getCurrentPlayer())),s=new kY(r.filter(e=>t.getPieceAt(e).is(t.getCurrentOpponent())));for(const o of i){const t=e.get(o).get();let r=Aw.empty();for(const e of t.directThreats)if(!1===s.contains(e)){const e=[];for(const n of t.mover)!1===s.contains(n)&&e.push(n);e.length>0&&(r=Aw.of(new SY(t.directThreats,new kY(e))))}r.isPresent()&&n.set(o,r.get())}for(const o of s){const t=e.get(o).get();n.set(o,t)}return n}}return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e})();const iK=qW.EMPTY,sK=qW.UNREACHABLE,oK=qW.ZERO,aK=qW.ONE;class lK{constructor(){this.tutorial=[Cj.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,eK.getInitialState()),Cj.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.
        You're playing first, hence you're playing Dark.<br/><br/>
        Perform any move.`,eK.getInitialState(),QY.fromCoordToCoord(new HW(3,5),new HW(5,5)),$localize`Congratulations! Let's see captures now.`),Cj.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new eK([[sK,sK,sK,sK,sK,sK,oK,iK,oK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,oK,iK,iK,iK,iK,iK,oK,iK,iK,sK,sK,sK],[iK,aK,iK,aK,oK,aK,iK,iK,oK,iK,iK,aK,iK,aK,iK],[aK,iK,iK,iK,iK,iK,iK,iK,iK,iK,aK,iK,iK,iK,aK],[iK,aK,iK,aK,iK,iK,iK,iK,iK,iK,iK,aK,iK,aK,iK],[iK,oK,iK,oK,iK,iK,iK,iK,iK,iK,iK,oK,iK,oK,iK],[oK,iK,iK,iK,oK,iK,iK,iK,iK,iK,oK,iK,iK,iK,oK],[iK,oK,iK,oK,iK,iK,aK,iK,aK,iK,iK,oK,iK,oK,iK],[sK,sK,sK,iK,iK,aK,iK,iK,iK,aK,iK,iK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,aK,iK,aK,sK,sK,sK,sK,sK,sK]],3,[0,0],[0,0]),[QY.fromCoordToCoord(new HW(5,2),new HW(4,1)),QY.fromCoordToCoord(new HW(3,4),new HW(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),Cj.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        Perform a move that lets you gain two tiles.`,new eK([[sK,sK,sK,sK,sK,sK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,aK,iK,iK,sK,sK,sK,sK,sK,sK],[iK,iK,iK,sK,sK,sK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[iK,iK,aK,iK,iK,iK,iK,oK,iK,sK,sK,sK,sK,sK,sK],[iK,iK,iK,aK,iK,iK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[iK,iK,iK,iK,iK,iK,iK,iK,iK,iK,iK,oK,sK,sK,sK],[iK,iK,oK,iK,iK,aK,iK,iK,iK,iK,oK,iK,iK,iK,oK],[iK,iK,iK,iK,iK,iK,aK,iK,aK,iK,iK,oK,iK,oK,iK],[sK,sK,sK,iK,iK,aK,iK,iK,iK,aK,iK,iK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,aK,iK,aK,sK,sK,sK,sK,sK,sK]],2,[0,0],[0,0]),[QY.fromCoordToCoord(new HW(2,6),new HW(4,6)),QY.fromCoordToCoord(new HW(2,6),new HW(3,5)),QY.fromCoordToCoord(new HW(2,6),new HW(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),Cj.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        Gain some time and capture the last piece!`,new eK([[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,oK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,iK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,iK,aK,iK,aK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,aK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,aK,iK,aK,sK,sK,sK,sK,sK,sK]],1,[0,2],[0,0]),[QY.fromTilesExchange(new HW(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),Cj.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrate both of these things can be done on this board by Light. Try it!`,new eK([[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,iK,iK,oK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,oK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,oK,aK,iK,aK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,aK,oK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,aK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK]],1,[0,0],[0,0]),[QY.fromCoordToCoord(new HW(7,6),new HW(6,5)),QY.fromCoordToCoord(new HW(7,6),new HW(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed!`)]}}function cK(e,t){if(1&e&&(_n(),ga(0,"polygon",13)),2&e){const e=Sa().index,t=Sa().index,n=Sa();ha("ngClass",n.getPyramidClass(e,t)),ra("points",n.getPyramidCoordinate(e,t))}}function uK(e,t){if(1&e&&(_n(),ga(0,"polygon",15)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ha("ngClass",n.getEmptyClass(e,t)),ra("points",n.getTriangleCoordinate(e,t))}}function hK(e,t){if(1&e&&(_n(),la(0,uK,1,2,"polygon",14)),2&e){const e=Sa().index,t=Sa().index;ha("ngIf",Sa().isEmptySpace(e,t))}}function dK(e,t){if(1&e&&(_n(),ga(0,"polygon",16)),2&e){const e=Sa().index,t=Sa().index,n=Sa();Ta("id","dark_line_",e,"_",t,""),ra("points",n.getLineCoordinate(e,t))}}function fK(e,t){if(1&e&&(_n(),ga(0,"polygon",17)),2&e){const e=Sa().index,t=Sa().index,n=Sa();Ta("id","dark_line_",e,"_",t,""),ra("points",n.getLineCoordinate(e,t))}}function pK(e,t){if(1&e){const e=va();_n(),fa(0,"g",8),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),la(1,cK,1,2,"polygon",9),la(2,hK,1,1,"ng-template",null,10,ju),la(4,dK,1,3,"polygon",11),la(5,fK,1,3,"polygon",12),pa()}if(2&e){const e=t.$implicit,n=t.index,r=ca(3),i=Sa().index,s=Sa();Ta("id","click_",n,"_",i,""),ks(1),ha("ngIf",s.isPyramid(n,i))("ngIfElse",r),ks(3),ha("ngIf",e!==s.NONE),ks(1),ha("ngIf",e!==s.NONE)}}function gK(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,pK,6,6,"g",7),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function mK(e,t){if(1&e&&(_n(),ga(0,"polygon",18)),2&e){const e=t.$implicit;ra("points",Sa().getTriangleCoordinate(e.x,e.y))}}function yK(e,t){if(1&e&&(_n(),ga(0,"polygon",19)),2&e){const e=Sa();ra("points",e.getTriangleCoordinate(e.lastStart.get().x,e.lastStart.get().y))}}function vK(e,t){if(1&e&&(_n(),ga(0,"polygon",19)),2&e){const e=Sa();ra("points",e.getTriangleCoordinate(e.lastEnd.get().x,e.lastEnd.get().y))}}function CK(e,t){if(1&e&&(_n(),ga(0,"polygon",20)),2&e){const e=Sa();Ta("id","selected_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),ra("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function _K(e,t){if(1&e&&(_n(),fa(0,"g",21),ga(1,"polygon",22),fa(2,"text",23),Qa(3),pa(),pa()),2&e){const e=Sa();ks(1),ra("points",e.getTilesCountCoordinate(0,0))("stroke",e.lastTurnWasTilesExchange(0)?"yellow":"black"),ks(1),ra("x",e.SPACE_SIZE/2+0*e.SPACE_SIZE)("y",16+e.SPACE_SIZE/2+0*e.SPACE_SIZE)("font-size",e.SPACE_SIZE/2),ks(1),Xa(e.tiles[0])}}function EK(e,t){if(1&e&&(_n(),fa(0,"g",24),ga(1,"polygon",25),fa(2,"text",26),Qa(3),pa(),pa()),2&e){const e=Sa();ks(1),ra("points",e.getTilesCountCoordinate(0,9))("stroke",e.lastTurnWasTilesExchange(1)?"yellow":"black"),ks(1),ra("x",e.SPACE_SIZE/2+0*e.SPACE_SIZE)("y",16+e.SPACE_SIZE/2+9*e.SPACE_SIZE)("font-size",e.SPACE_SIZE/2),ks(1),Xa(e.tiles[1])}}let wK=(()=>{class e extends jY{constructor(e){super(e),this.tiles=[0,0],this.NONE=qW.UNREACHABLE,this.chosenCoord=Aw.empty(),this.lastStart=Aw.empty(),this.lastEnd=Aw.empty(),this.possibleLandings=[],this.scores=Aw.of([0,0]),this.rules=new tK(eK),this.availableMinimaxes=[new nK(this.rules,"Normal"),new rK(this.rules,"Piece > Threat > Tiles")],this.encoder=QY.encoder,this.tutorial=(new lK).tutorial,this.SPACE_SIZE=70,this.updateBoard()}updateBoard(){this.chosenCoord=Aw.empty(),this.state=this.getState(),this.scores=Aw.of(this.state.captures),this.tiles=this.state.tiles;const e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=Aw.empty(),this.lastEnd=Aw.empty()),this.board=this.getState().board}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=Aw.empty(),this.possibleLandings=[]}onClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new HW(e,t),s=n.state.getCurrentPlayer();return n.chosenCoord.equalsValue(i)?(n.cancelMoveAttempt(),xw.SUCCESS):n.chosenCoord.isAbsent()||n.state.getPieceAt(i).is(s)?n.firstClick(i):n.secondClick(i)})()}firstClick(e){var t=this;return Sw(function*(){const n=t.state.getPieceAt(e);if(n.is(t.state.getCurrentOpponent())){const n=QY.fromTilesExchange(e);return t.chooseMove(n,t.state,t.state.captures)}return n.is(t.state.getCurrentPlayer())?(t.chosenCoord=Aw.of(e),t.showHighlight(),xw.SUCCESS):t.cancelMove(YY.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(e){var t=this;return Sw(function*(){if(t.possibleLandings.some(t=>t.equals(e))){const n=QY.fromCoordToCoord(t.chosenCoord.get(),e);return t.chooseMove(n,t.state,t.state.captures)}return t.cancelMove(YY.INVALID_DISTANCE())})()}isPyramid(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}wasOpponent(e,t){const n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}getPyramidClass(e,t){const n=this.board[t][e];return n===qW.ZERO?this.getPlayerClass(bZ.ZERO):n===qW.ONE?this.getPlayerClass(bZ.ONE):"captured-fill"}isEmptySpace(e,t){return this.board[t][e]===qW.EMPTY||this.wasRemoved(e,t)}wasRemoved(e,t){const n=this.rules.node.mother;if(this.board[t][e]===qW.UNREACHABLE&&n.isPresent()){const r=n.get().gameState.getPieceAtXY(e,t);return r===qW.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}getEmptyClass(e,t){return this.board[t][e]===qW.EMPTY?(e+t)%2==1?"background":"background2":"captured-alternate-fill"}getTilesCountCoordinate(e,t){const n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}getLineCoordinate(e,t){const n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}mustShowTilesOf(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}lastTurnWasTilesExchange(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-coerceo"]],features:[Go],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke",4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke",4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptySpace",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","selectable-stroke"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0-fill"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1-fill"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,gK,2,1,"g",1),la(2,mK,1,1,"polygon",2),la(3,yK,1,1,"polygon",3),la(4,vK,1,1,"polygon",3),la(5,CK,1,3,"polygon",4),la(6,_K,4,6,"g",5),la(7,EK,4,6,"g",6),pa()),2&e&&(ra("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),ks(1),ha("ngForOf",t.board),ks(1),ha("ngForOf",t.possibleLandings),ks(1),ha("ngIf",t.lastStart.isPresent()),ks(1),ha("ngIf",t.lastEnd.isPresent()),ks(1),ha("ngIf",t.chosenCoord.isPresent()),ks(1),ha("ngIf",t.mustShowTilesOf(0)),ks(1),ha("ngIf",t.mustShowTilesOf(1)))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),PK=(()=>{class e{}return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`,e.CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`,e.CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`,e.MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`,e.MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`,e.INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`,e.SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`,e})();class SK extends ij{static getInitialState(){const e=AZ.createTable(SK.WIDTH,SK.HEIGHT,OZ.NONE);return new SK(e,0)}isShelter(e){return 0===e.x||e.x===SK.WIDTH-1?SK.SHELTERS_INDICES.some(t=>e.y===t):(0===e.y||e.y===SK.HEIGHT-1)&&SK.SHELTERS_INDICES.some(t=>e.x===t)}isCentralZone(e){return e.x>=SK.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=SK.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=SK.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=SK.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}SK.WIDTH=17,SK.HEIGHT=17,SK.CENTRAL_ZONE_TOP_LEFT=new HW(4,6),SK.CENTRAL_ZONE_BOTTOM_RIGHT=new HW(12,10),SK.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],SK.ALL_SHELTERS=new nj(SK.SHELTERS_INDICES.flatMap(e=>[new HW(e,0),new HW(e,SK.HEIGHT-1),new HW(0,e),new HW(SK.WIDTH-1,e)])).toList();class bK extends aj{constructor(e){super(e.x,e.y)}static of(e){return e.isInRange(SK.WIDTH,SK.HEIGHT)?Mw.success(new bK(e)):Mw.failure("Move out of board")}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(e){return!!e.isDrop()&&this.coord.equals(e.coord)}isDrop(){return!0}isSimple(){return!1}isJump(){return!1}}bK.encoder=class{static getEncoder(e,t,n){return new class extends PZ{constructor(){super(...arguments),this.shiftX=t}maxValue(){return(e-1)*this.shiftX+(t-1)}encodeNumber(e){return e.coord.x*this.shiftX+e.coord.y}decodeNumber(r){const i=r%t;r/=t;const s=new HW((r-=r%1)%e,i);return n(s)}}}}.getEncoder(SK.WIDTH,SK.HEIGHT,e=>bK.of(e).get());class OK extends hY{constructor(e,t){super(e,t)}static of(e,t){return e.isInRange(SK.WIDTH,SK.HEIGHT)&&t.isInRange(SK.WIDTH,SK.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?Mw.success(new OK(e,t)):Mw.failure(PK.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):Mw.failure("Move out of board")}toString(){return`ConspirateursMoveSimple(${this.coord.toString()} -> ${this.end.toString()})`}equals(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}isDrop(){return!1}isSimple(){return!0}isJump(){return!1}}OK.encoder=hY.getEncoder(SK.WIDTH,SK.HEIGHT,(e,t)=>OK.of(e,t).get());class kK extends oj{constructor(e){super(),this.coords=e}static of(e){if(e.length<2)return Mw.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const t of e)if(t.isNotInRange(SK.WIDTH,SK.HEIGHT))return Mw.failure("Move out of board");for(let t=1;t<e.length;t++)if(e[t-1].getDirectionToward(e[t]).isFailure()||2!==e[t-1].getDistance(e[t]))return Mw.failure(PK.INVALID_JUMP());return new kY(e).size()===e.length?Mw.success(new kK(e)):Mw.failure(PK.SAME_LOCATION_VISITED_IN_JUMP())}addJump(e){const t=AZ.copyImmutableArray(this.coords);return t.push(e),kK.of(t)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const e=[];for(let t=1;t<this.coords.length;t++){const n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}toString(){return`ConspirateursMoveJump(${this.coords.map(e=>e.toString()).reduce((e,t)=>e+" -> "+t)})`}equals(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}isDrop(){return!1}isSimple(){return!1}isJump(){return!0}}kK.encoder=new class extends wZ{constructor(){super(...arguments),this.coordEncoder=HW.numberEncoder(SK.WIDTH,SK.HEIGHT)}encodeMove(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}decodeMove(e){cZ(null!=bw.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");const t=bw.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return kK.of(t).get()}};const TK=wZ.disjunction3(bK.encoder,OK.encoder,kK.encoder,e=>e.isDrop(),e=>e.isSimple());class IK extends gj{constructor(){super(SK)}static get(){return IK.singleton.isAbsent()&&(IK.singleton=Aw.of(new IK)),IK.singleton.get()}applyLegalMove(e,t,n){const r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=OZ.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{const n=e.getStartingCoord(),i=e.getEndingCoord();r[n.y][n.x]=OZ.NONE,r[i.y][i.x]=t.getCurrentPlayer()}return new SK(r,t.turn+1)}isLegal(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}dropLegality(e,t){return t.turn>=40?Mw.failure(PK.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?Mw.failure(XW.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?Mw.failure(PK.MUST_DROP_IN_CENTRAL_ZONE()):Mw.success(void 0)}simpleMoveLegality(e,t){return t.turn<40?Mw.failure(PK.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?Mw.failure(XW.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end).isPlayer()?Mw.failure(XW.MUST_LAND_ON_EMPTY_SPACE()):Mw.success(void 0)}jumpLegality(e,t){if(t.turn<40)return Mw.failure(PK.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return Mw.failure(XW.MUST_CHOOSE_PLAYER_PIECE());for(const n of e.getJumpedOverCoords())if(t.getPieceAt(n)===OZ.NONE)return Mw.failure(PK.MUST_JUMP_OVER_PIECES());for(const n of e.getLandingCoords())if(t.getPieceAt(n).isPlayer())return Mw.failure(XW.MUST_LAND_ON_EMPTY_SPACE());return Mw.success(void 0)}jumpTargetsFrom(e){const t=[new HW(e.x+2,e.y),new HW(e.x-2,e.y),new HW(e.x,e.y+2),new HW(e.x,e.y-2),new HW(e.x+2,e.y+2),new HW(e.x+2,e.y-2),new HW(e.x-2,e.y+2),new HW(e.x-2,e.y-2)],n=[];for(const r of t)kK.of([e,r]).isSuccess()&&n.push(r);return n}nextJumps(e,t){const n=e.getEndingCoord(),r=[];for(const i of this.jumpTargetsFrom(n)){const n=e.addJump(i);n.isSuccess()&&this.jumpLegality(n.get(),t).isSuccess()&&r.push(n.get())}return r}jumpHasPossibleNextTargets(e,t){return this.nextJumps(e,t).length>0}getGameStatus(e){const t=e.gameState,n=[0,0];for(const r of SK.ALL_SHELTERS){const e=t.getPieceAt(r);if(e.isPlayer()&&(n[e.value]+=1,20===n[e.value]))return pj.getVictory(e)}return pj.ONGOING}}IK.singleton=Aw.empty();class AK extends JW{getListMoves(e){return this.sortByNumberOfJump(e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState))}sortByNumberOfJump(e){return e.sort((e,t)=>{const n=e.isDrop()?1:e.isSimple()?2:e.coords.length;return(t.isDrop()?1:t.isSimple()?2:t.coords.length)-n})}getListMovesDrop(e){const t=[],n=SK.CENTRAL_ZONE_TOP_LEFT,r=SK.CENTRAL_ZONE_BOTTOM_RIGHT;for(let i=n.y;i<=r.y;i++)for(let s=n.x;s<=r.x;s++)e.getPieceAtXY(s,i)===OZ.NONE&&t.push(bK.of(new HW(s,i)).get());return t}getListMovesAfterDrop(e){let t=[];const n=e.getCurrentPlayer();for(let r=0;r<SK.HEIGHT;r++)for(let i=0;i<SK.WIDTH;i++){const s=new HW(i,r);e.getPieceAt(s)===n&&(t=t.concat(this.getListSimpleMoves(e,s)),t=t.concat(this.getListJumps(e,s)))}return t}getListSimpleMoves(e,t){const n=[],r=[new HW(t.x+1,t.y),new HW(t.x-1,t.y),new HW(t.x,t.y+1),new HW(t.x,t.y-1),new HW(t.x+1,t.y+1),new HW(t.x+1,t.y-1),new HW(t.x-1,t.y+1),new HW(t.x-1,t.y-1)];for(const i of r){const r=OK.of(t,i);r.isSuccess()&&IK.get().simpleMoveLegality(r.get(),e).isSuccess()&&n.push(r.get())}return n}getListJumps(e,t){const n=new nj;for(const r of IK.get().jumpTargetsFrom(t)){const i=kK.of([t,r]).get();IK.get().jumpLegality(i,e).isSuccess()&&(n.add(i),n.union(this.getListJumpStartingFrom(e,i)))}return n.toList()}getListJumpStartingFrom(e,t){const n=IK.get().nextJumps(t,e),r=new nj(n);for(const i of n)r.union(this.getListJumpStartingFrom(e,i));return r}getBoardValue(e){const t=e.gameState;let n=0;const r=new uj([{key:bZ.ZERO,value:0},{key:bZ.ONE,value:0}]);for(let i=0;i<SK.HEIGHT;i++)for(let e=0;e<SK.WIDTH;e++){const s=new HW(e,i),o=t.getPieceAt(s);if(o.isPlayer())if(t.isShelter(s)){if(n+=20*o.getScoreModifier(),r.replace(o,r.get(o).get()+1),20===r.get(o).get())return new ej(o.getVictoryValue())}else{let e=100;for(const n of SK.ALL_SHELTERS)if(t.getPieceAt(n)===OZ.NONE){const t=s.getOrthogonalDistance(n);e=Math.min(e,t)}n-=o.getScoreModifier()*e}}return new ej(n)}}const MK=OZ.NONE,NK=OZ.ZERO,RK=OZ.ONE;class xK{constructor(){this.tutorial=[Cj.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,SK.getInitialState()),Cj.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone.`,SK.getInitialState(),bK.of(new HW(7,7)).get(),$localize`Congratulations!`),Cj.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new SK([[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,NK,RK,RK,NK,NK,RK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,RK,NK,RK,NK,NK,NK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,RK,MK,MK,MK,MK,MK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,NK,RK,RK,RK,NK,NK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,RK,RK,RK,RK,RK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK]],40),OK.of(new HW(4,6),new HW(3,5)).get(),(e,t,n)=>e.isSimple()?xw.SUCCESS:xw.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),Cj.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new SK([[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,NK,RK,RK,NK,NK,RK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,RK,NK,RK,NK,NK,NK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,RK,MK,MK,MK,MK,MK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,NK,RK,RK,RK,NK,NK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,RK,RK,RK,RK,RK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK]],40),kK.of([new HW(6,7),new HW(6,5)]).get(),(e,t,n)=>e.isJump()?xw.SUCCESS:xw.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),Cj.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new SK([[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,RK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,RK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,RK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,NK,MK,RK,NK,NK,RK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,MK,NK,RK,NK,NK,NK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,RK,MK,MK,MK,MK,MK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,NK,RK,RK,RK,NK,NK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,RK,RK,RK,RK,RK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK]],40),[kK.of([new HW(8,6),new HW(6,4),new HW(6,2),new HW(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}}function DK(e,t){if(1&e){const e=va();_n(),fa(0,"rect",9),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa(2).onClick(t.coord)}),pa()}if(2&e){const e=Sa().$implicit,t=Sa(2);ra("x",1.5*t.STROKE_WIDTH+t.SPACE_SIZE*e.coord.x+t.STROKE_WIDTH)("y",1.5*t.STROKE_WIDTH+t.SPACE_SIZE*e.coord.y+t.STROKE_WIDTH)("width",t.SPACE_SIZE-3*t.STROKE_WIDTH)("height",t.SPACE_SIZE-3*t.STROKE_WIDTH)}}function LK(e,t){if(1&e){const e=va();_n(),fa(0,"circle",6),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa(2).onClick(t.coord)}),pa()}if(2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ta("id","piece_",t,"_",r,""),ha("ngClass",n.pieceClasses),ra("r",i.PIECE_RADIUS)("cx",i.SPACE_SIZE*t+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.STROKE_WIDTH+i.SPACE_SIZE/2)}}function FK(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",6),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).onClick(t.coord)}),pa(),la(2,DK,1,4,"rect",7),la(3,LK,1,6,"circle",8),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();ks(1),Ta("id","click_",n,"_",r,""),ha("ngClass",e.squareClasses),ra("x",i.SPACE_SIZE*n+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),ks(1),ha("ngIf",e.isShelter),ks(1),ha("ngIf",e.hasPiece)}}function UK(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,FK,4,9,"g",1),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function VK(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",10),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();ks(1),ha("ngClass",n.viewInfo.boardInfo[e.y][e.x].shelterClasses),ra("x",n.SPACE_SIZE*e.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*e.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function BK(e,t){if(1&e&&(_n(),ga(0,"circle",11)),2&e){const e=t.$implicit,n=Sa();ka("id","sidePiece_0_",e,""),ra("cx",-n.PIECE_RADIUS)("cy",1670-e*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function $K(e,t){if(1&e&&(_n(),ga(0,"circle",12)),2&e){const e=t.$implicit,n=Sa();ka("id","sidePiece_1_",e,""),ra("cx",1715+n.PIECE_RADIUS)("cy",1670-e*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function zK(e,t){if(1&e&&(_n(),ga(0,"rect",13)),2&e){const e=Sa();ra("x",e.SPACE_SIZE*e.CENTRAL_ZONE_START.x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.CENTRAL_ZONE_START.y+e.STROKE_WIDTH)("width",e.CENTRAL_ZONE_SIZE.x*e.SPACE_SIZE)("height",e.CENTRAL_ZONE_SIZE.y*e.SPACE_SIZE)}}let HK=(()=>{class e extends GW{constructor(e){super(e),this.ALL_SHELTERS=SK.ALL_SHELTERS,this.CENTRAL_ZONE_START=SK.CENTRAL_ZONE_TOP_LEFT,this.CENTRAL_ZONE_SIZE=new LW(SK.CENTRAL_ZONE_BOTTOM_RIGHT.x-SK.CENTRAL_ZONE_TOP_LEFT.x+1,SK.CENTRAL_ZONE_BOTTOM_RIGHT.y-SK.CENTRAL_ZONE_TOP_LEFT.y+1),this.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},this.selected=Aw.empty(),this.jumpInConstruction=Aw.empty(),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=IK.get(),this.availableMinimaxes=[new AK(this.rules,"ConspirateursMinimax")],this.encoder=TK,this.tutorial=(new xK).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}updateViewInfo(){const e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let t=0;t<SK.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(let n=0;n<SK.WIDTH;n++){const r=new HW(n,t),i=e.getPieceAt(r),s={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(s)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const e of SK.ALL_SHELTERS){const t=this.viewInfo.boardInfo[e.y][e.x];t.isShelter=!0,t.hasPiece&&t.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;for(const r of e.coords)this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill")}else{const e=this.selected.get();this.viewInfo.boardInfo[e.y][e.x].pieceClasses.push("selected-stroke")}}updateVictory(){const e=this.getState(),t=IK.get().getGameStatus(this.rules.node);if(!0===t.isEndGame)for(const n of SK.ALL_SHELTERS)e.getPieceAt(n)===t.winner&&this.viewInfo.boardInfo[n.y][n.x].squareClasses.push("victory-fill")}showLastMove(){const e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";for(const t of e.coords)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=t.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=t.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=Aw.empty(),this.selected=Aw.empty(),this.updateBoard()}onClick(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());const r=t.getState();if(r.getPieceAt(e)===t.getCurrentPlayer())return t.selected.equalsValue(e)?t.cancelMoveAttempt():(t.selected=Aw.of(e),t.jumpInConstruction=Aw.empty()),t.updateViewInfo(),xw.SUCCESS;if(t.jumpInConstruction.isPresent())return t.constructJump(e);if(t.selected.isPresent())return t.selectNextCoord(e);if(r.isDropPhase()){const n=bK.of(e);return cZ(n.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(n.get(),r)}return t.cancelMove(XW.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(e){var t=this;return Sw(function*(){const n=t.jumpInConstruction.get(),r=t.getState();if(e.equals(n.getEndingCoord()))return t.chooseMove(n,r);{const i=n.addJump(e);if(i.isFailure())return t.cancelMove(i.getReason());const s=t.rules.jumpLegality(i.get(),r);return s.isFailure()?t.cancelMove(s.getReason()):t.updateJump(i.get())}})()}updateJump(e){var t=this;return Sw(function*(){const n=t.getState();return t.rules.jumpHasPossibleNextTargets(e,n)?(t.jumpInConstruction=Aw.of(e),t.updateViewInfo(),xw.SUCCESS):t.chooseMove(e,n)})()}selectNextCoord(e){var t=this;return Sw(function*(){const n=t.selected.get(),r=OK.of(n,e);if(r.isSuccess())return t.chooseMove(r.get(),t.getState());{const r=kK.of([n,e]);return r.isFailure()?t.cancelMove(r.getReason()):t.updateJump(r.get())}})()}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-conspirateurs"]],features:[Go],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,UK,2,1,"g",1),la(2,VK,2,5,"g",1),la(3,BK,1,4,"circle",2),la(4,$K,1,4,"circle",3),la(5,zK,1,4,"rect",4),ga(6,"polyline",5),pa()),2&e&&(ks(1),ha("ngForOf",t.viewInfo.boardInfo),ks(1),ha("ngForOf",t.ALL_SHELTERS),ks(1),ha("ngForOf",t.range(t.viewInfo.sidePieces[0])),ks(1),ha("ngForOf",t.range(t.viewInfo.sidePieces[1])),ks(1),ha("ngIf",t.viewInfo.dropPhase),ks(1),ra("points",t.viewInfo.lastMoveArrow))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class GK{constructor(e,t){this.owner=e,this.otherPieceType=t}static of(e,t){return e===bZ.ZERO?t?GK.ZERO_SECOND:GK.ZERO_FIRST:e===bZ.ONE?t?GK.ONE_SECOND:GK.ONE_FIRST:GK.EMPTY}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}}GK.encoder=PZ.tuple([bZ.numberEncoder,PZ.booleanEncoder],e=>[e.owner,e.otherPieceType],e=>GK.of(e[0],e[1])),GK.EMPTY=new GK(OZ.NONE,!1),GK.ZERO_FIRST=new GK(bZ.ZERO,!1),GK.ZERO_SECOND=new GK(bZ.ZERO,!0),GK.ONE_FIRST=new GK(bZ.ONE,!1),GK.ONE_SECOND=new GK(bZ.ONE,!0),GK.PLAYER_PIECES=[GK.ZERO_FIRST,GK.ZERO_SECOND,GK.ONE_FIRST,GK.ONE_SECOND];class ZK extends oj{constructor(e,t){if(super(),this.target=e,this.piece=t,t===GK.EMPTY)throw new Error("Cannot drop an empty piece")}isDrop(){return!0}getTarget(){return this.target}equals(e){return!(this.target!==e.target||this.piece!==e.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}ZK.encoder=PZ.tuple([PZ.numberEncoder(7),GK.encoder],e=>[e.target,e.piece],e=>new ZK(e[0],e[1]));class qK extends oj{constructor(e,t){super(),this.start=e,this.moveDirection=t}static fromRepresentation(e,t){return new qK(new HW(e.x,3-e.y),t)}isDrop(){return!1}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}qK.encoder=PZ.tuple([HW.numberEncoder(8,4),PZ.booleanEncoder],e=>[e.start,"clockwise"===e.moveDirection],e=>new qK(e[0],e[1]?"clockwise":"counterclockwise"));const WK=PZ.disjunction(ZK.encoder,qK.encoder,e=>e.isDrop());let jK=(()=>{class e{}return e.NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`,e.SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`,e.TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`,e.MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`,e.MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`,e})(),YK=(()=>{class e extends ij{constructor(e,t,n){super(e,n),this.remainingPieces=t}static getInitialState(){const t=GK.EMPTY;return new e([[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t]],[4,4,4,4],0)}static fromRepresentation(t,n){const r=t.reverse(),i=[4,4,4,4];for(let s=0;s<e.HEIGHT;s++)for(let t=0;t<e.WIDTH;t++){const n=r[s][t];r[s][t]!==GK.EMPTY&&i[e.pieceIndex(n)]--}return cZ(i.every(e=>e>=0),"Invalid DiamState representation uses too many pieces"),new e(r,i,n)}static pieceIndex(e){switch(e){case GK.ZERO_FIRST:return 0;case GK.ZERO_SECOND:return 1;case GK.ONE_FIRST:return 2;default:return bw.expectToBe(e,GK.ONE_SECOND),3}}getRemainingPiecesOf(t){return this.remainingPieces[e.pieceIndex(t)]}getStackHeight(t){let n=0;for(let r=0;r<e.HEIGHT&&this.getPieceAtXY(t,r)!==GK.EMPTY;r++)n++;return n}}return e.WIDTH=8,e.HEIGHT=4,e})();class KK extends gj{constructor(){super(YK)}static get(){return KK.singleton.isAbsent()&&(KK.singleton=Aw.of(new KK)),KK.singleton.get()}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}applyLegalDrop(e,t){const n=AZ.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;const r=AZ.copyImmutableArray(t.remainingPieces);return r[YK.pieceIndex(e.piece)]-=1,new YK(n,r,t.turn+1)}applyLegalShift(e,t){const n=AZ.copyBiArray(t.board),r=e.getTarget();let i=t.getStackHeight(r),s=e.start.y;for(;s<YK.HEIGHT&&t.getPieceAtXY(e.start.x,s)!==GK.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,s),n[s][e.start.x]=GK.EMPTY,i++,s++;return new YK(n,t.remainingPieces,t.turn+1)}isLegal(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}isDropLegal(e,t){return e.piece.owner!==t.getCurrentPlayer()?Mw.failure(XW.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?Mw.failure(jK.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}dropHeightValidity(e,t){return t.getStackHeight(e.target)===YK.HEIGHT?Mw.failure(jK.SPACE_IS_FULL()):Mw.success(void 0)}isShiftLegal(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?Mw.failure(XW.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}shiftHeightValidity(e,t){const n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>YK.HEIGHT?Mw.failure(jK.TARGET_STACK_TOO_HIGH()):Mw.success(void 0)}getGameStatus(e){const t=this.findHighestAlignment(e.gameState);if(t.isPresent()){const n=e.gameState.getPieceAt(t.get());return cZ(n.owner.isPlayer(),"highest alignment is owned by a player"),pj.getVictory(n.owner)}return pj.ONGOING}findHighestAlignment(e){for(let t=0;t<YK.WIDTH/2;t++)for(let n=YK.HEIGHT-1;n>0;n--){const r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+YK.WIDTH/2,n);if(r!==GK.EMPTY&&r===i)return Aw.of(new HW(t,n))}return Aw.empty()}pieceCanMove(e,t){return!!this.isShiftLegal(new qK(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new qK(t,"counterclockwise"),e).isSuccess()}}KK.singleton=Aw.empty();class QK extends JW{getListMoves(e){const t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}getListShifts(e){const t=[],n=this.getShiftSources(e);for(const r of n)for(const n of[new qK(r,"clockwise"),new qK(r,"counterclockwise")])KK.get().shiftHeightValidity(n,e).isSuccess()&&t.push(n);return t}getListDrops(e){const t=this.getRemainingPiecesForCurrentPlayer(e),n=[];for(let r=0;r<YK.WIDTH;r++)for(const i of t){const t=new ZK(r,i);KK.get().dropHeightValidity(t,e).isSuccess()&&n.push(t)}return n}getRemainingPiecesForCurrentPlayer(e){const t=[];for(const n of GK.PLAYER_PIECES)this.currentPlayerCanDropPiece(e,n)&&t.push(n);return t}currentPlayerCanDropPiece(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}getShiftSources(e){const t=[],n=e.getCurrentPlayer();for(let r=0;r<YK.HEIGHT;r++)for(let i=0;i<YK.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new HW(i,r));return t}getBoardValue(e){const t=KK.get().getGameStatus(e);return new ej(t.isEndGame?t.toBoardValue():0)}}const XK=GK.EMPTY,JK=GK.ZERO_FIRST,eQ=GK.ZERO_SECOND,tQ=GK.ONE_FIRST,nQ=GK.ONE_SECOND;class rQ{constructor(){this.tutorial=[Cj.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,YK.getInitialState()),Cj.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!`,YK.fromRepresentation([[XK,XK,XK,XK,XK,XK,XK,XK],[XK,XK,XK,XK,XK,XK,XK,XK],[XK,XK,XK,XK,tQ,XK,XK,XK],[JK,XK,XK,XK,JK,XK,XK,XK]],3),[new ZK(0,GK.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),Cj.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,YK.fromRepresentation([[XK,XK,XK,XK,XK,XK,XK,XK],[XK,XK,XK,XK,nQ,XK,XK,XK],[XK,XK,XK,XK,JK,XK,XK,XK],[tQ,XK,XK,XK,eQ,XK,XK,XK]],4),[qK.fromRepresentation(new HW(4,3),"counterclockwise"),qK.fromRepresentation(new HW(4,3),"clockwise"),qK.fromRepresentation(new HW(4,2),"counterclockwise"),qK.fromRepresentation(new HW(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),Cj.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,YK.fromRepresentation([[XK,XK,XK,XK,JK,XK,XK,XK],[XK,XK,XK,XK,nQ,XK,XK,JK],[XK,XK,XK,XK,JK,XK,XK,nQ],[XK,tQ,XK,XK,eQ,XK,XK,tQ]],8),[qK.fromRepresentation(new HW(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)]}}function iQ(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"path",5),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onSpaceClick(t)}),pa(),fa(2,"path",6),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onSpaceClick(t)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();ks(1),ka("id","click_",e,""),ha("ngClass",n.viewInfo.boardInfo[e].spaceClasses),ra("d",n.BOARD_PATHS[e]),ks(1),ha("ngClass",n.viewInfo.boardInfo[e].spaceClasses),ra("d",n.DECORATION_PATHS[e])}}function sQ(e,t){if(1&e){const e=va();_n(),fa(0,"g",8),Ea("click",function(){const t=Gt(e).$implicit,n=Sa().$implicit;return Sa().onPieceInGameClick(n,t.y)}),ga(1,"use",9),ga(2,"use",10),pa()}if(2&e){const e=t.$implicit;Ta("id","click_",Sa().$implicit,"_",e.y,""),ha("ngClass",e.foregroundClasses),ks(1),ha("ngClass",e.backgroundClasses),ra("x",e.drawPosition.x)("y",e.drawPosition.y),ks(1),ra("x",e.drawPosition.x)("y",e.drawPosition.y)}}function oQ(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,sQ,3,8,"g",7),pa()),2&e){const e=t.$implicit,n=Sa();ks(1),ha("ngForOf",n.viewInfo.boardInfo[e].pieces)}}function aQ(e,t){if(1&e){const e=va();_n(),fa(0,"g",12),Ea("click",function(){const t=Gt(e),n=t.$implicit,r=t.index;return Sa(2).onRemainingPieceClick(n.actualPiece,r)}),ga(1,"use",9),ga(2,"use",10),pa()}if(2&e){const e=t.$implicit,n=t.index;Ia("id","piece_",e.actualPiece.owner.toString(),"_",e.actualPiece.otherPieceType?1:0,"_",n,""),ha("ngClass",e.foregroundClasses),ks(1),ha("ngClass",e.backgroundClasses),ra("x",e.drawPosition.x)("y",e.drawPosition.y),ks(1),ra("x",e.drawPosition.x)("y",e.drawPosition.y)}}function lQ(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,aQ,3,9,"g",11),pa()),2&e){const e=t.$implicit,n=Sa();ks(1),ha("ngForOf",n.viewInfo.remainingPieces.get(e).get())}}const cQ=function(){return[0,1,2,3,4,5,6,7]},uQ=function(){return[2,1,3,0,4,7,5,6]};class hQ extends GW{constructor(e){super(e),this.BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],this.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],this.selected=Aw.empty(),this.viewInfo={boardInfo:[],remainingPieces:new uj([{key:bZ.ZERO,value:[]},{key:bZ.ONE,value:[]}])},this.rules=KK.get(),this.availableMinimaxes=[new QK(this.rules,"DiamDummyMinimax")],this.encoder=WK,this.tutorial=(new rQ).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#click_"+e);return n.isFailure()?t.cancelMove(n.getReason()):t.onSpaceClickAfterCheck(e)})()}onSpaceClickAfterCheck(e){var t=this;return Sw(function*(){if(t.selected.isPresent()){const n=t.selected.get();let r;if("pieceFromReserve"===n.type)r=new ZK(e,n.piece);else if((n.position.x+1)%YK.WIDTH===e)r=new qK(n.position,"clockwise");else{if((n.position.x+(YK.WIDTH-1))%YK.WIDTH!==e)return t.cancelMove(jK.MUST_SHIFT_TO_NEIGHBOR());r=new qK(n.position,"counterclockwise")}return t.chooseMove(r,t.getState())}return t.cancelMove(jK.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new HW(e,t);return n.getState().getPieceAt(i).owner===n.getCurrentPlayer()?(n.isSelected(null,i)?n.cancelMoveAttempt():n.selected=Aw.of({type:"pieceFromBoard",position:i}),n.updateViewInfo(),xw.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(XW.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay(n.getPieceId(e,t));return r.isFailure()?n.cancelMove(r.getReason()):e.owner===n.getCurrentPlayer()?(n.selected=n.isSelected(e)?Aw.empty():Aw.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),xw.SUCCESS):n.cancelMove(XW.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}isSelected(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}getLastMovedFromDrop(e,t){const n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),s=this.getDrawPositionOnBoard(r,i),o=new HW(r,i);return[{start:Aw.empty(),end:o,startDrawPosition:n,endDrawPosition:s}]}getLastMovedFromShift(e,t){const n=e.start.x,r=e.getTarget();let i=t.getStackHeight(r);const s=[];for(let o=e.start.y;o<YK.HEIGHT&&t.getPieceAtXY(n,o)!==GK.EMPTY;o++,i++)s.push({start:Aw.of(new HW(n,o)),end:new HW(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return s}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let e=0;e<YK.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}showLastMove(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}showLastMoveOnSpaces(){const e=this.rules.node.move;cZ(e.isPresent(),"showLastMoveOnSpaces called without a last move");const t=e.get();for(let n=0;n<YK.WIDTH;n++){const e=[];t.isDrop()?t.getTarget()===n&&e.push("moved-fill"):(t.getTarget()===n||t.start.x===n)&&e.push("moved-fill"),this.viewInfo.boardInfo[n].spaceClasses=e}}showLastMoveOnPieces(){const e=this.rules.node.move;cZ(e.isPresent(),"showLastMoveOnPieces called without a last move");const t=e.get(),n=this.getPreviousState();let r=[];r=t.isDrop()?this.getLastMovedFromDrop(t,n):this.getLastMovedFromShift(t,n);for(const i of r)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new uj([{key:bZ.ZERO,value:[]},{key:bZ.ONE,value:[]}]);const t=this.isPlayerTurn();for(const n of GK.PLAYER_PIECES){const r=this.getState().getRemainingPiecesOf(n);for(let i=0;i<r;i++){const s=[];this.isTopPieceOfReserveAndSelected(i,r,n)&&s.push("selected-stroke"),t&&i===r-1&&n.owner===e&&s.push("clickable-stroke-hover");const o=this.viewInfo.remainingPieces.get(n.owner).get(),a=[];a.push(n.otherPieceType?"player"+n.owner.value+"-alternate-fill":"player"+n.owner.value+"-fill"),o.push({backgroundClasses:a,foregroundClasses:s,y:i,drawPosition:this.getDrawPositionRemainingPiece(n,i),actualPiece:n}),this.viewInfo.remainingPieces.put(n.owner,o)}}}isTopPieceOfReserveAndSelected(e,t,n){if(this.selected.isPresent()){const r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}getDrawPositionRemainingPiece(e,t){let n,r;return n=e.owner===bZ.ZERO?-100:600,r=e.otherPieceType?100:450,new HW(n,r).getNext(new LW(0,-t*hQ.PIECE_HEIGHT))}getPieces(e){const t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[];for(let i=0;i<YK.HEIGHT;i++){const s=this.getState().getPieceAtXY(e,i),o=new HW(e,i);if(s!==GK.EMPTY){const a=[];this.pieceFromBoardIsSelected(e,i)&&a.push("selected-stroke"),this.isVictory(e,i,t)&&a.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&a.push("clickable-stroke-hover"),r.push({backgroundClasses:["player"+s.owner.value+(s.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:a,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:s})}}return r}pieceFromBoardIsSelected(e,t){if(this.selected.isPresent()){const n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}isVictory(e,t,n){if(n.isPresent()){const r=n.get();return r.x%4==e%4&&r.y===t}return!1}getDrawPositionOnBoard(e,t){return hQ.CENTER[e].getNext(new LW(0,-t*hQ.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=Aw.empty(),this.updateBoard()}}hQ.CENTER=[new HW(40,160),new HW(100,50),new HW(255,2),new HW(400,50),new HW(460,160),new HW(400,270),new HW(255,320),new HW(100,270)],hQ.PIECE_HEIGHT=36,hQ.\u0275fac=function(e){return new(e||hQ)(ua(aZ))},hQ.\u0275cmp=Je({type:hQ,selectors:[["app-diam"]],features:[Go],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"defs"),fa(2,"g",1),ga(3,"path",2),ga(4,"ellipse",3),pa(),pa(),la(5,iQ,3,5,"g",4),la(6,oQ,2,1,"g",4),la(7,lQ,2,1,"g",4),pa()),2&e&&(ks(5),ha("ngForOf",wu(3,cQ)),ks(1),ha("ngForOf",wu(4,uQ)),ks(1),ha("ngForOf",t.Player.PLAYERS))},directives:[Jd,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class dQ{constructor(e,t){this.offset=e,this.constant=t}static fromTwoCoords(e,t){const n=e.x,r=t.x,i=e.y,s=t.y,o=n+i,a=r+s;return n===r&&i!==s&&o!==a?Aw.of(dQ.constantQ(n)):n!==r&&i===s&&o!==a?Aw.of(dQ.constantR(i)):n!==r&&i!==s&&o===a?Aw.of(dQ.constantS(o)):Aw.empty()}static constantQ(e){return new dQ(e,"q")}static constantR(e){return new dQ(e,"r")}static constantS(e){return new dQ(e,"s")}static areOnSameLine(e){if(e.length<2)return!0;const t=dQ.fromTwoCoords(e[0],e[1]);if(t.isAbsent())return!1;const n=t.get();for(const r of e.slice(2))if(!1===n.contains(r))return!1;return!0}toString(){return`Line(${this.constant}, ${this.offset})`}equals(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}contains(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}getDirection(){switch(this.constant){case"q":return WW.DOWN;case"r":return WW.RIGHT;case"s":return WW.DOWN_LEFT}}}class fQ extends ij{constructor(e,t,n,r,i,s){super(t,e),this.board=t,this.width=n,this.height=r,this.excludedSpaces=i,this.empty=s,cZ(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}static neighbors(e,t){return[new HW(e.x+t,e.y-t),new HW(e.x+t,e.y),new HW(e.x-t,e.y+t),new HW(e.x-t,e.y),new HW(e.x,e.y+t),new HW(e.x,e.y-t)]}setAt(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}equalsT(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedSpaces.length!==e.excludedSpaces.length)return!1;for(let n=0;n<this.excludedSpaces.length;n++)if(this.excludedSpaces[n]!==e.excludedSpaces[n])return!1;for(const n of this.allCoords())if(!1===t(this.getPieceAt(n),e.getPieceAt(n)))return!1;return!0}allCoords(){const e=[];return this.forEachCoord(t=>{e.push(t)}),e}allLines(){const e=[];for(let t=0;t<this.width;t++)e.push(dQ.constantQ(t));for(let t=0;t<this.height;t++)e.push(dQ.constantR(t));for(let t=this.excludedSpaces.length;t<this.height+this.excludedSpaces.length;t++)e.push(dQ.constantS(t));return e}getEntranceOnLine(e){let t,n;switch(e.constant){case"q":return n=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new HW(e.offset,n));case"r":return t=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new HW(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new HW(e.offset,0):new HW(this.width-1,e.offset-this.width+1))}}findEntranceFrom(e,t){const n=e.getDirection();let r=t;for(let s=0;s<Math.max(this.width,this.height);s++){if(this.isOnBoard(r))return r;r=r.getNext(n)}const i=lZ.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(i.getReason())}}class pQ{constructor(e,t,n){this.owner=e,this.size=t,this.source=n}static append(e,t){return new pQ(e.owner,e.size+t.size,e.source||t.source)}getValue(){return pQ.encoder.encodeNumber(this)}getOwner(){return this.owner}belongsTo(e){return this.owner===e}containsSource(){return this.source}isEmpty(){return 0===this.size}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}pQ.sizeEncoder=PZ.numberEncoder(49),pQ.encoder=PZ.tuple([PZ.booleanEncoder,bZ.numberEncoder,pQ.sizeEncoder],e=>[e.source,e.owner,e.size],e=>new pQ(e[1],e[2],e[0])),pQ.MAX_SIZE=49,pQ.EMPTY=new pQ(OZ.NONE,0,!1),pQ.UNREACHABLE=new pQ(OZ.NONE,-1,!1),pQ.PLAYER_ZERO=new pQ(bZ.ZERO,1,!1),pQ.PLAYER_ONE=new pQ(bZ.ONE,1,!1),pQ.SOURCE=new pQ(OZ.NONE,1,!0);let gQ=(()=>{class e extends fQ{constructor(t,n,r){super(n,t,e.WIDTH,e.HEIGHT,e.EXCLUDED_SPACES,pQ.EMPTY),this.alreadyPassed=r}static balancedBoard(){const e=pQ.UNREACHABLE,t=pQ.PLAYER_ZERO,n=pQ.PLAYER_ONE,r=pQ.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}static isOnBoard(t){return!t.isNotInRange(e.WIDTH,e.HEIGHT)&&e.balancedBoard()[t.y][t.x]!==pQ.UNREACHABLE}static getInitialState(){return new e(e.balancedBoard(),0,!1)}getAllPieces(){const t=[];for(let n=0;n<e.HEIGHT;n++)for(let r=0;r<e.WIDTH;r++){const e=new HW(r,n);this.isOnBoard(e)&&!1===this.getPieceAt(e).isEmpty()&&t.push(e)}return t}numberOfNeighbors(e){return fQ.neighbors(e,1).filter(e=>this.isOnBoard(e)&&!1===this.getPieceAt(e).isEmpty()).length}setAtUnsafe(t,n){const r=AZ.copyBiArray(this.board);return r[t.y][t.x]=n,new e(r,this.turn,this.alreadyPassed)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==pQ.UNREACHABLE}}return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_SPACES=[2,1],e})();class mQ extends hY{constructor(e,t){super(e,t)}static of(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return mQ.PASS;if(!gQ.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!gQ.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new mQ(e,t);if(e.x===t.x)return new mQ(e,t);if(e.x+e.y===t.x+t.y)return new mQ(e,t);throw new Error("Invalid move")}toString(){return this===mQ.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}length(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}mQ.PASS=new mQ(new HW(-1,-1),new HW(-2,-2)),mQ.encoder=new class extends PZ{maxValue(){return 42148}encodeNumber(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}decodeNumber(e){if(e<0)return mQ.PASS;const t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new mQ(new HW((e=e/16|0)%16,r),new HW(n,t))}};let yQ=(()=>{class e{}return e.NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`,e.EMPTY_STACK=()=>$localize`You must select a stack.`,e.TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`,e.CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`,e.INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`,e.EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`,e})();class vQ extends gj{static getGameStatus(e){const t=e.gameState,n=vQ.getScores(t);return 0===vQ.getMovablePieces(t).length?n[0]>n[1]?pj.ZERO_WON:n[0]<n[1]?pj.ONE_WON:pj.DRAW:pj.ONGOING}static getMovablePieces(e){return vQ.getFreePieces(e).filter(t=>vQ.pieceHasTarget(e,t))}static getFreePieces(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6)}static pieceHasTarget(e,t){const n=e.getPieceAt(t).getSize();return void 0!==fQ.neighbors(t,n).find(t=>e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty())}static pieceTargets(e,t){const n=e.getPieceAt(t).getSize();return fQ.neighbors(t,n).filter(t=>e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty())}static getScores(e){let t=0,n=0;return e.getAllPieces().map(r=>{const i=e.getPieceAt(r);i.belongsTo(bZ.ZERO)?t+=i.getSize():i.belongsTo(bZ.ONE)&&(n+=i.getSize())}),[t,n]}isMovablePiece(e,t){cZ(e.isOnBoard(t),"piece is not on the board");const n=e.getPieceAt(t);return n.getSize()<1?xw.failure(yQ.EMPTY_STACK()):n.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?xw.failure(yQ.TOO_MANY_NEIGHBORS()):vQ.pieceHasTarget(e,t)?xw.SUCCESS:xw.failure(yQ.CANT_REACH_TARGET()):xw.failure(yQ.NOT_PLAYER_PIECE())}canOnlyPass(e){return 0===vQ.getMovablePieces(e).length}sourceCoords(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).containsSource())}markPiecesConnectedTo(e,t,n){fQ.neighbors(t,1).forEach(t=>{e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,this.markPiecesConnectedTo(e,t,n))})}removeDisconnectedPieces(e){const t=AZ.createTable(gQ.WIDTH,gQ.HEIGHT,!1);this.sourceCoords(e).forEach(n=>{t[n.y][n.x]=!0,this.markPiecesConnectedTo(e,n,t)});let n=e;return n.getAllPieces().forEach(e=>{t[e.y][e.x]||(n=n.setAt(e,pQ.EMPTY))}),n}applyLegalMove(e,t,n){if(e===mQ.PASS)return new gQ(t.board,t.turn+1,!0);{const n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end),i=t.setAt(e.coord,pQ.EMPTY).setAt(e.end,pQ.append(n,r));return this.removeDisconnectedPieces(new gQ(i.board,t.turn+1,!1))}}isLegal(e,t){if(0===vQ.getMovablePieces(t).length)return e!==mQ.PASS||t.alreadyPassed?Mw.failure(XW.MUST_PASS()):Mw.success(void 0);if(e===mQ.PASS)return Mw.failure(XW.CANNOT_PASS());const n=this.isMovablePiece(t,e.coord);if(n.isFailure())return n.toFailedFallible();const r=t.getPieceAt(e.coord);return e.length()!==r.getSize()?Mw.failure(yQ.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?Mw.failure(yQ.EMPTY_TARGET_STACK()):Mw.success(void 0)}getGameStatus(e){return vQ.getGameStatus(e)}}class CQ extends JW{getListMoves(e){const t=e.move,n=e.gameState,r=[];return vQ.getMovablePieces(n).forEach(e=>vQ.pieceTargets(n,e).forEach(t=>{const n=mQ.of(e,t);r.push(n)})),0===r.length&&!1===t.equalsValue(mQ.PASS)&&r.push(mQ.PASS),r}getBoardValue(e){const t=e.gameState,n=vQ.getScores(t);return 0===vQ.getMovablePieces(t).length?new ej(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new ej(n[0]-n[1])}}class _Q extends CQ{getListMoves(e){const t=e.gameState,n=super.getListMoves(e),r=t.getCurrentPlayer().getOpponent();return AZ.sortByDescending(n,e=>{cZ(e!==mQ.PASS,"Cannot sort with DvonnMove.PASS");const n=t.getPieceAt(e.end);return n.belongsTo(r)?n.getSize():0}),n}getBoardValue(e){const t=vQ.getGameStatus(e);if(t.isEndGame)return new ej(t.toBoardValue());const n=e.gameState,r=vQ.getScores(n),i=n.getAllPieces(),s=i.length,o=i.filter(e=>n.getPieceAt(e).belongsTo(bZ.ZERO)).length,a=i.filter(e=>n.getPieceAt(e).belongsTo(bZ.ONE)).length;return new ej((a*r[1]-o*r[0])/s)}}const EQ=pQ.EMPTY,wQ=pQ.UNREACHABLE,PQ=pQ.SOURCE,SQ=pQ.PLAYER_ZERO,bQ=pQ.PLAYER_ONE,OQ=new pQ(bZ.ZERO,2,!1),kQ=new pQ(bZ.ONE,2,!1),TQ=new pQ(bZ.ZERO,4,!1),IQ=new pQ(bZ.ONE,4,!1);class AQ{constructor(){this.tutorial=[Cj.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,gQ.getInitialState(),mQ.of(new HW(2,0),new HW(3,0)),$localize`Congratulations!`),Cj.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new gQ([[wQ,wQ,bQ,PQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ],[wQ,EQ,SQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ],[EQ,EQ,IQ,EQ,EQ,EQ,EQ,bQ,PQ,EQ,EQ],[EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,wQ],[EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,wQ,wQ]],0,!1),mQ.of(new HW(2,1),new HW(2,0)),(e,t,n)=>e.end.equals(new HW(3,0))?xw.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(cZ(e.end.equals(new HW(2,0)),"player made an impossible move"),xw.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),Cj.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new gQ([[wQ,wQ,PQ,bQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ],[wQ,SQ,SQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ],[EQ,bQ,SQ,bQ,EQ,EQ,SQ,kQ,PQ,EQ,EQ],[EQ,EQ,bQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,wQ],[EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,wQ,wQ]],0,!1),mQ.of(new HW(2,1),new HW(2,0)),(e,t,n)=>e.end.equals(new HW(2,0))?xw.SUCCESS:xw.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),Cj.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new gQ([[wQ,wQ,PQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ],[wQ,EQ,OQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ],[EQ,EQ,kQ,EQ,EQ,EQ,EQ,kQ,PQ,TQ,EQ],[EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,wQ],[EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,wQ,wQ]],0,!1)),Cj.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>
        Make your last move.`,new gQ([[wQ,wQ,PQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ],[wQ,EQ,SQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ],[EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,PQ,TQ,EQ],[EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,wQ],[EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,EQ,wQ,wQ]],0,!1),[mQ.of(new HW(2,1),new HW(2,0))],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}}function MQ(e,t){if(1&e&&(_n(),ga(0,"circle",10)),2&e){const e=Sa().$implicit,t=Sa().$implicit,n=Sa();ha("ngClass",n.getPieceClasses(e)),ra("cx",n.getCenterAt(t).x)("cy",n.getCenterAt(t).y)("r",n.SPACE_SIZE)}}function NQ(e,t){if(1&e&&(_n(),ga(0,"polygon",11)),2&e){const e=Sa().$implicit,t=Sa().$implicit,n=Sa();ra("transform",1===e.getSize()?"translate("+(n.getCenterAt(t).x-18)+" "+(n.getCenterAt(t).y-16)+") scale(0.10)":"translate("+(n.getCenterAt(t).x-3)+" "+(n.getCenterAt(t).y-12)+") scale(0.07)")}}function RQ(e,t){if(1&e){const e=va();_n(),fa(0,"text",12),Ea("click",function(){Gt(e);const t=Sa(2).$implicit;return Sa().onClick(t.x,t.y)}),Qa(1),pa()}if(2&e){const e=Sa().$implicit,t=Sa().$implicit,n=Sa();ra("x",e.containsSource()?n.getCenterAt(t).x-7:n.getCenterAt(t).x)("y",n.getCenterAt(t).y),ks(1),Xa(e.getSize())}}function xQ(e,t){if(1&e){const e=va();_n(),fa(0,"g",5),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa().onClick(t.x,t.y)}),ga(1,"polygon",6),la(2,MQ,1,4,"circle",7),la(3,NQ,1,1,"polygon",8),la(4,RQ,2,3,"text",9),pa()}if(2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa();Ta("id","click_",n.x,"_",n.y,""),ks(1),ra("points",r.getHexaCoordsAt(n)),ks(1),ha("ngIf",e.getSize()>0),ks(1),ha("ngIf",e.containsSource()),ks(1),ha("ngIf",e.getSize()>1)}}const DQ=function(e){return[e]};function LQ(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,xQ,5,6,"g",4),pa()),2&e){const e=t.$implicit,n=Sa();ks(1),ha("ngForOf",Pu(1,DQ,n.state.getPieceAt(e)))}}function FQ(e,t){if(1&e&&(_n(),fa(0,"text",16),Qa(1),pa()),2&e){const e=Sa().$implicit,t=Sa();ra("x",t.getCenterAt(e.coord).x)("y",t.getCenterAt(e.coord).y),ks(1),Xa(e.spaceContent.getSize())}}function UQ(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"polygon",13),ga(2,"circle",14),la(3,FQ,2,3,"text",15),pa()),2&e){const e=t.$implicit,n=Sa();ks(1),ra("points",n.getHexaCoordsAt(e.coord)),ks(1),Ta("id","captured_",e.coord.x,"_",e.coord.y,""),ha("ngClass",n.getPieceClasses(e.spaceContent)),ra("cx",n.getCenterAt(e.coord).x)("cy",n.getCenterAt(e.coord).y)("r",n.SPACE_SIZE),ks(1),ha("ngIf",e.spaceContent.getSize()>1)}}function VQ(e,t){if(1&e&&(_n(),ma(0),ga(1,"polygon",17),ga(2,"polygon",17),ya()),2&e){const e=Sa();ks(1),ra("points",e.getHexaCoordsAt(e.lastMove.get().coord)),ks(1),ra("points",e.getHexaCoordsAt(e.lastMove.get().end))}}function BQ(e,t){if(1&e&&(_n(),ga(0,"polygon",18)),2&e){const e=Sa();ra("points",e.getHexaCoordsAt(e.chosen.get()))}}let $Q=(()=>{class e extends ZW{constructor(e){super(e),this.lastMove=Aw.empty(),this.chosen=Aw.empty(),this.disconnecteds=[],this.rules=new vQ(gQ),this.availableMinimaxes=[new CQ(this.rules,"DvonnMinimax"),new _Q(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=mQ.encoder,this.tutorial=(new AQ).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=Aw.of(vQ.getScores(this.getState())),this.hexaLayout=new jW(1.5*this.SPACE_SIZE,new HW(-this.SPACE_SIZE,2*this.SPACE_SIZE),KW.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=Aw.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.getState(),this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=Aw.of(vQ.getScores(this.state))}calculateDisconnecteds(){const e=this.rules.node.mother.get().gameState,t=this.getState();for(let n=0;n<t.board.length;n++)for(let r=0;r<t.board[n].length;r++){const i=new HW(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){const s=t.getPieceAt(i),o=e.getPieceAt(i);if(s.isEmpty()&&!o.isEmpty()){const e={coord:new HW(r,n),spaceContent:o};this.disconnecteds.push(e)}}}}cancelMoveAttempt(){this.chosen=Aw.empty()}pass(){var e=this;return Sw(function*(){return cZ(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(mQ.PASS,e.getState())})()}onClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.chosen.isAbsent()?n.choosePiece(e,t):n.chosen.equalsValue(new HW(e,t))?(n.cancelMoveAttempt(),xw.SUCCESS):yield n.chooseDestination(e,t)})()}choosePiece(e,t){const n=new HW(e,t),r=this.rules.isMovablePiece(this.getState(),n);return r.isSuccess()?(this.chosen=Aw.of(n),xw.SUCCESS):this.cancelMove(r.getReason())}chooseDestination(e,t){var n=this;return Sw(function*(){const r=n.chosen.get(),i=new HW(e,t),s=mQ.of(r,i);return n.chooseMove(s,n.getState())})()}getPieceClasses(e){if(e.containsSource()&&1===e.getSize())return["nonplayer-fill","dashed-stroke"];const t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"nonplayer-stroke","dashed-stroke"]:[t]}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-dvonn"]],features:[Go],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,LQ,2,3,"g",1),la(2,UQ,4,8,"g",1),la(3,VQ,3,2,"ng-container",2),la(4,BQ,1,1,"polygon",3),pa()),2&e&&(ks(1),ha("ngForOf",t.state.allCoords()),ks(1),ha("ngForOf",t.disconnecteds),ks(1),ha("ngIf",t.lastMove.isPresent()),ks(1),ha("ngIf",t.chosen.isPresent()))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();var zQ=(()=>(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}(zQ||(zQ={})),zQ))();class HQ{constructor(e){this.value=e}static of(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}static ofSizeAndPlayer(e,t){return t===bZ.ZERO&&e===zQ.BIG?HQ.BIG_DARK:t===bZ.ZERO&&e===zQ.MEDIUM?HQ.MEDIUM_DARK:t===bZ.ZERO&&e===zQ.SMALL?HQ.SMALL_DARK:t===bZ.ONE&&e===zQ.BIG?HQ.BIG_LIGHT:t===bZ.ONE&&e===zQ.MEDIUM?HQ.MEDIUM_LIGHT:t===bZ.ONE&&e===zQ.SMALL?HQ.SMALL_LIGHT:HQ.NONE}getPlayer(){switch(this){case HQ.SMALL_DARK:case HQ.MEDIUM_DARK:case HQ.BIG_DARK:return bZ.ZERO;case HQ.SMALL_LIGHT:case HQ.MEDIUM_LIGHT:case HQ.BIG_LIGHT:return bZ.ONE;default:return OZ.NONE}}getSize(){switch(this){case HQ.BIG_DARK:case HQ.BIG_LIGHT:return zQ.BIG;case HQ.MEDIUM_DARK:case HQ.MEDIUM_LIGHT:return zQ.MEDIUM;case HQ.SMALL_DARK:case HQ.SMALL_LIGHT:return zQ.SMALL;default:return bw.expectToBe(this,HQ.NONE),zQ.NONE}}belongsTo(e){return this.getPlayer()===e}equals(e){return this===e}toString(){switch(this){case HQ.BIG_DARK:return"BIG_DARK";case HQ.BIG_LIGHT:return"BIG_LIGHT";case HQ.MEDIUM_DARK:return"MEDIUM_DARK";case HQ.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case HQ.SMALL_DARK:return"SMALL_DARK";case HQ.SMALL_LIGHT:return"SMALL_LIGHT";default:return bw.expectToBe(this,HQ.NONE),"EMPTY"}}}HQ.SMALL_DARK=new HQ(0),HQ.SMALL_LIGHT=new HQ(1),HQ.MEDIUM_DARK=new HQ(2),HQ.MEDIUM_LIGHT=new HQ(3),HQ.BIG_DARK=new HQ(4),HQ.BIG_LIGHT=new HQ(5),HQ.NONE=new HQ(6);class GQ extends ij{constructor(e,t,n){super(e,t),this.remainingPieces=n}static getInitialState(){const e=new ZQ(OZ.NONE,OZ.NONE,OZ.NONE).encode(),t=AZ.createTable(3,3,e),n=AZ.mapBiArray(t,e=>ZQ.decode(e));return new GQ(n,0,[HQ.BIG_DARK,HQ.BIG_DARK,HQ.BIG_LIGHT,HQ.BIG_LIGHT,HQ.MEDIUM_DARK,HQ.MEDIUM_DARK,HQ.MEDIUM_LIGHT,HQ.MEDIUM_LIGHT,HQ.SMALL_DARK,HQ.SMALL_DARK,HQ.SMALL_LIGHT,HQ.SMALL_LIGHT])}getRemainingPieces(){return AZ.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(e){return this.getRemainingPieces().filter(t=>t.getPlayer()===e)}pieceBelongsToCurrentPlayer(e){return e.belongsTo(this.getCurrentPlayer())}isDroppable(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}isInRemainingPieces(e){return this.remainingPieces.some(t=>t===e)}getPlayerRemainingPieces(){return this.remainingPieces.filter(e=>this.pieceBelongsToCurrentPlayer(e))}}class ZQ{constructor(e,t,n){this.small=e,this.medium=t,this.big=n}static decode(e){cZ(e%1==0,"EncapsuleSpace must be encoded as integer: "+e),cZ(e>=0,"To small representation for EncapsuleSpace: "+e),cZ(e<=26,"To big representation for EncapsuleSpace: "+e);const t=bZ.numberEncoder.decodeNumber(e%3);e-=t.value;const n=bZ.numberEncoder.decodeNumber((e/=3)%3);e-=n.value;const r=bZ.numberEncoder.decodeNumber(e/=3);return new ZQ(t,n,r)}isEmpty(){return this.small===OZ.NONE&&this.medium===OZ.NONE&&this.big===OZ.NONE}toList(){const e=[];return this.small.isPlayer()&&e.push(HQ.ofSizeAndPlayer(zQ.SMALL,this.small)),this.medium.isPlayer()&&e.push(HQ.ofSizeAndPlayer(zQ.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(HQ.ofSizeAndPlayer(zQ.BIG,this.big)),e}toOrderedPieceNames(){const e=HQ.ofSizeAndPlayer(zQ.SMALL,this.small),t=HQ.ofSizeAndPlayer(zQ.MEDIUM,this.medium),n=HQ.ofSizeAndPlayer(zQ.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}getBiggest(){return this.big===bZ.ZERO?HQ.BIG_DARK:this.big===bZ.ONE?HQ.BIG_LIGHT:this.medium===bZ.ZERO?HQ.MEDIUM_DARK:this.medium===bZ.ONE?HQ.MEDIUM_LIGHT:this.small===bZ.ZERO?HQ.SMALL_DARK:this.small===bZ.ONE?HQ.SMALL_LIGHT:HQ.NONE}tryToSuperposePiece(e){const t=this.getBiggest().getSize();if(e===HQ.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?Aw.of(this.put(e)):Aw.empty()}removeBiggest(){const e=this.getBiggest();if(e===HQ.NONE)throw new Error("Cannot removed piece from empty space");let t;const n=e.getSize();switch(n){case zQ.BIG:t=new ZQ(this.small,this.medium,OZ.NONE);break;case zQ.MEDIUM:t=new ZQ(this.small,OZ.NONE,OZ.NONE);break;default:bw.expectToBe(n,zQ.SMALL),t=new ZQ(OZ.NONE,OZ.NONE,OZ.NONE)}return{removedSpace:t,removedPiece:e}}put(e){if(e===HQ.NONE)throw new Error("Cannot put NONE on space");const t=e.getPlayer(),n=e.getSize();switch(n){case zQ.BIG:return new ZQ(this.small,this.medium,t);case zQ.MEDIUM:return cZ(this.big===OZ.NONE,"Cannot put a piece on top of a bigger one"),new ZQ(this.small,t,this.big);default:return bw.expectToBe(n,zQ.SMALL),cZ(this.big===OZ.NONE,"Cannot put a piece on top of a bigger one"),cZ(this.medium===OZ.NONE,"Cannot put a piece on top of a bigger one"),new ZQ(t,this.medium,this.big)}}encode(){return this.small.value+3*this.medium.value+9*this.big.value}belongsTo(e){return this.getBiggest().getPlayer()===e}toString(){const e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}ZQ.EMPTY=new ZQ(OZ.NONE,OZ.NONE,OZ.NONE);let qQ=(()=>{class e{}return e.PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`,e.INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`,e.NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`,e.INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`,e.END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`,e})();class WQ extends gj{static isVictory(e){const t=e.getCopiedBoard();for(const n of WQ.LINES){const e=WQ.isVictoriousLine([t[n[0].y][n[0].x],t[n[1].y][n[1].x],t[n[2].y][n[2].x]]);if(e.isPresent())return e}return Aw.empty()}static isVictoriousLine(e){const t=e.map(e=>e.getBiggest()).map(e=>e.getPlayer());return t[0]===OZ.NONE?Aw.empty():t[0]===t[1]&&t[1]===t[2]?Aw.of(t[0]):Aw.empty()}static isLegal(e,t){let n;if(Ow(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return Mw.failure(XW.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return Mw.failure(qQ.PIECE_OUT_OF_STOCK())}else{const r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return Mw.failure(XW.MUST_CHOOSE_PLAYER_PIECE())}const r=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return r.isPresent()?Mw.success(r.get()):Mw.failure(qQ.INVALID_PLACEMENT())}isLegal(e,t){return WQ.isLegal(e,t)}applyLegalMove(e,t,n){const r=t.getCopiedBoard();let i=t.getRemainingPieces();const s=t.turn+1;let o;if(r[e.landingCoord.y][e.landingCoord.x]=ZQ.decode(n.encode()),e.isDropping()){o=e.piece.get();const t=i.indexOf(o);i=i.slice(0,t).concat(i.slice(t+1))}else{const t=e.startingCoord.get(),n=r[t.y][t.x].encode(),i=ZQ.decode(n).removeBiggest();r[t.y][t.x]=ZQ.decode(i.removedSpace.encode()),o=i.removedPiece}return new GQ(r,s,i)}static getGameStatus(e){const t=WQ.isVictory(e.gameState);return t.isPresent()?pj.getVictory(t.get()):pj.ONGOING}getGameStatus(e){return WQ.getGameStatus(e)}}WQ.LINES=[[new HW(0,0),new HW(0,1),new HW(0,2)],[new HW(1,0),new HW(1,1),new HW(1,2)],[new HW(2,0),new HW(2,1),new HW(2,2)],[new HW(0,0),new HW(1,0),new HW(2,0)],[new HW(0,1),new HW(1,1),new HW(2,1)],[new HW(0,2),new HW(1,2),new HW(2,2)],[new HW(0,0),new HW(1,1),new HW(2,2)],[new HW(0,2),new HW(1,1),new HW(2,0)]];class jQ extends oj{constructor(e,t,n){super(),this.startingCoord=e,this.landingCoord=t,this.piece=n}static fromMove(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new jQ(Aw.of(e),t,Aw.empty())}static fromDrop(e,t){return new jQ(Aw.empty(),t,Aw.of(e))}isDropping(){return this.startingCoord.isAbsent()}equals(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}jQ.encoder=new class extends PZ{maxValue(){return 161}encodeNumber(e){const t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){const r=0;return 18*e.piece.get().value+6*t+2*n+r}{const r=1,i=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*i+6*t+2*n+r}}decodeNumber(e){const t=e%2;e-=t;const n=(e/=2)%3;e-=n;const r=(e/=3)%3;e-=r,e/=3;const i=new HW(r,n);if(0===t){const t=HQ.of(e);return jQ.fromDrop(t,i)}{const t=e%3;e-=t;const n=new HW((e/=3)%3,t);return jQ.fromMove(n,i)}}};class YQ extends JW{getBoardValue(e){const t=WQ.getGameStatus(e);return new ej(t.toBoardValue())}getListMoves(e){const t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),s=tj.toComparableObjectSet(n.getPlayerRemainingPieces());for(let o=0;o<3;o++)for(let e=0;e<3;e++){const a=new HW(e,o);for(const e of s){const r=jQ.fromDrop(e,a);WQ.isLegal(r,n).isSuccess()&&t.push(r)}if(r[o][e].belongsTo(i))for(let e=0;e<3;e++)for(let r=0;r<3;r++){const i=new HW(r,e);if(!i.equals(a)){const e=jQ.fromMove(a,i);WQ.isLegal(e,n).isSuccess()&&t.push(e)}}}return t}}const KQ=new ZQ(OZ.NONE,OZ.NONE,OZ.NONE),QQ=new ZQ(bZ.ZERO,OZ.NONE,OZ.NONE),XQ=new ZQ(OZ.NONE,bZ.ZERO,OZ.NONE),JQ=new ZQ(OZ.NONE,OZ.NONE,bZ.ZERO),eX=new ZQ(bZ.ONE,OZ.NONE,OZ.NONE),tX=new ZQ(OZ.NONE,OZ.NONE,bZ.ONE),nX=new ZQ(bZ.ONE,bZ.ZERO,OZ.NONE),rX=new ZQ(bZ.ZERO,bZ.ZERO,OZ.NONE);class iX{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new GQ([[QQ,eX,tX],[KQ,XQ,KQ],[KQ,KQ,JQ]],0,[HQ.SMALL_DARK,HQ.MEDIUM_DARK,HQ.BIG_DARK,HQ.SMALL_LIGHT,HQ.MEDIUM_LIGHT,HQ.MEDIUM_LIGHT,HQ.BIG_LIGHT])),Cj.anyMove($localize`Putting a piece`,$localize`This is the initial board. You're playing Dark.<br/><br/>
        Pick one of your piece on the side of the board and put it on the board.`,GQ.getInitialState(),jQ.fromDrop(HQ.SMALL_DARK,new HW(1,1)),$localize`Congratulations!`),Cj.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        Click on your dark piece and then on any empty square of the board.`,new GQ([[QQ,tX,KQ],[KQ,KQ,KQ],[KQ,KQ,KQ]],0,[]),[jQ.fromMove(new HW(0,0),new HW(2,0)),jQ.fromMove(new HW(0,0),new HW(0,1)),jQ.fromMove(new HW(0,0),new HW(1,1)),jQ.fromMove(new HW(0,0),new HW(2,1)),jQ.fromMove(new HW(0,0),new HW(0,2)),jQ.fromMove(new HW(0,0),new HW(1,2)),jQ.fromMove(new HW(0,0),new HW(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),Cj.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        You're playing Dark and you can win now in various ways.<br/><br/>
        Try to win by making a move, and not by putting a new piece on the board.`,new GQ([[nX,KQ,eX],[rX,tX,tX],[KQ,KQ,KQ]],0,[HQ.MEDIUM_DARK,HQ.BIG_DARK,HQ.MEDIUM_LIGHT,HQ.MEDIUM_LIGHT]),jQ.fromMove(new HW(0,1),new HW(0,2)),(e,t,n)=>{if(e.landingCoord.equals(new HW(0,2))){if(e.isDropping())return xw.failure($localize`You won, but the exercise is to win while moving a piece!`);if(e.startingCoord.equalsValue(new HW(0,1)))return xw.SUCCESS}return xw.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)]}}function sX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"circle",6),Ea("click",function(){const t=Gt(e),n=t.$implicit,r=t.index;return Sa().onPieceClick(0,n,r)}),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa();ks(1),Ta("id","piece_0_",e.toString(),"_",n,""),ha("ngClass",r.getSidePieceClasses(e,n)),ra("r",r.getPieceRadius(e))("cx",r.getPieceLeftX(0,n)+r.getPieceRadius(e))("cy",r.SPACE_SIZE/2)}}function oX(e,t){if(1&e){const e=va();_n(),fa(0,"circle",9),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onBoardClick(t,n)}),pa()}if(2&e){const e=t.$implicit,n=Sa().index,r=Sa().index,i=Sa();ha("ngClass",i.getPieceClasses(e)),ra("r",i.getPieceRadius(e))("cx",i.SPACE_SIZE*n+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.STROKE_WIDTH+i.SPACE_SIZE/2)}}function aX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",7),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onBoardClick(t,n)}),pa(),la(2,oX,1,4,"circle",8),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();ks(1),Ta("id","click_",n,"_",r,""),ha("ngClass",i.getRectClasses(n,r)),ra("x",i.SPACE_SIZE*n+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),ks(1),ha("ngForOf",i.getListPieces(e))}}function lX(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,aX,3,8,"g",2),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function cX(e,t){if(1&e){const e=va();_n(),fa(0,"rect",10),Ea("click",function(){Gt(e);const t=Sa();return t.onBoardClick(t.chosenCoord.get().x,t.chosenCoord.get().y)}),pa()}if(2&e){const e=Sa();Ta("id","chosenCoord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),ra("x",e.SPACE_SIZE*e.chosenCoord.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.chosenCoord.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function uX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"circle",6),Ea("click",function(){const t=Gt(e),n=t.$implicit,r=t.index;return Sa().onPieceClick(1,n,r)}),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa();ks(1),Ta("id","piece_1_",e.toString(),"_",n,""),ha("ngClass",r.getSidePieceClasses(e,n)),ra("r",r.getPieceRadius(e))("cx",r.getPieceLeftX(1,n)+r.getPieceRadius(e))("cy",r.SPACE_SIZE/2)}}let hX=(()=>{class e extends eY{constructor(e){super(e),this.INTER_PIECE_SPACE=20,this.lastLandingCoord=Aw.empty(),this.lastStartingCoord=Aw.empty(),this.chosenCoord=Aw.empty(),this.chosenPiece=Aw.empty(),this.remainingPieceLeftX=[],this.rules=new WQ(GQ),this.availableMinimaxes=[new YQ(this.rules,"EncapsuleMinimax")],this.encoder=jQ.encoder,this.tutorial=(new iX).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard();const t=this.rules.node.move;this.calculateLeftX(),t.isPresent()?(this.lastLandingCoord=Aw.of(t.get().landingCoord),this.lastStartingCoord=t.get().startingCoord):(this.lastLandingCoord=Aw.empty(),this.lastStartingCoord=Aw.empty())}getListPieces(e){return e.toList()}getRemainingPieces(e){return this.getState().getRemainingPiecesOfPlayer(bZ.of(e))}onBoardClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new HW(e,t),s=n.getState();if(n.chosenCoord.isAbsent()){if(n.chosenCoord=Aw.of(i),n.chosenPiece.isPresent()){const e=jQ.fromDrop(n.chosenPiece.get(),i);return n.chooseMove(e,n.getState())}return!1===s.getPieceAt(i).belongsTo(s.getCurrentPlayer())?n.cancelMove(qQ.INVALID_PIECE_SELECTED()):xw.SUCCESS}if(n.chosenCoord.equalsValue(i))return n.cancelMoveAttempt(),xw.SUCCESS;{const e=jQ.fromMove(n.chosenCoord.get(),i);return n.chooseMove(e,n.getState())}})()}cancelMoveAttempt(){this.chosenCoord=Aw.empty(),this.chosenPiece=Aw.empty(),this.chosenPieceIndex=Aw.empty()}onPieceClick(e,t,n){var r=this;return Sw(function*(){const i="#piece_"+e+"_"+t.toString()+"_"+n,s=r.canUserPlay(i);return s.isFailure()?r.cancelMove(s.getReason()):!1===r.getState().isDroppable(t)?r.cancelMove(qQ.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece.equalsValue(t)&&r.chosenPieceIndex.equalsValue(n)?(r.chosenPiece=Aw.empty(),r.chosenPieceIndex=Aw.empty()):(r.chosenPiece=Aw.of(t),r.chosenPieceIndex=Aw.of(n)),xw.SUCCESS):r.cancelMove(qQ.END_YOUR_MOVE())})()}getRectClasses(e,t){return this.isSelected(e,t)?"moved-fill":""}isSelected(e,t){const n=new HW(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}getPieceClasses(e){return[this.getPieceStrokeClass(e)]}getPieceStrokeClass(e){const t=e.getPlayer();return cZ(t.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+t.value+"-stroke"}getPieceRadius(e){switch(e.getSize()){case zQ.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case zQ.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return bw.expectToBe(e.getSize(),zQ.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(e,t){const n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(t)&&n.push("selected-stroke"),n}isSelectedPiece(e){return this.chosenPiece.equalsValue(e)}calculateLeftX(){this.remainingPieceLeftX=[];for(let e=0;e<=1;e++){this.remainingPieceLeftX.push([]);const t=this.getRemainingPieces(e);for(let n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{const r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}getPieceLeftX(e,t){return this.remainingPieceLeftX[e][t]}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-encapsule"]],features:[Go],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingPiecePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPiecePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"g",null,1),la(3,sX,2,6,"g",2),pa(),fa(4,"g",null,3),la(6,lX,2,1,"g",2),la(7,cX,1,6,"rect",4),pa(),fa(8,"g",null,5),la(10,uX,2,6,"g",2),pa(),pa()),2&e&&(ks(1),ra("transform","translate("+t.STROKE_WIDTH+", 0)"),ks(2),ha("ngForOf",t.getRemainingPieces(0)),ks(1),ra("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),ks(2),ha("ngForOf",t.board),ks(1),ha("ngIf",t.chosenCoord.isPresent()),ks(1),ra("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),ks(2),ha("ngForOf",t.getRemainingPieces(1)))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class dX extends aj{constructor(e,t,n,r,i){if(super(e,t),this.movedPieces=n,this.stepSize=r,this.direction=i,this.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+this.coord.toString()+".");if(n<1)throw new Error("Must select minimum one piece (got "+n+").");if(r<1)throw new Error("Step size must be minimum one (got "+r+").");if(r>n)throw new Error("Cannot move a phalanx further than its size (got step size "+r+" for "+n+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}dX.encoder=new class extends PZ{maxValue(){return 122303}encodeNumber(e){const t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}decodeNumber(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");const t=e%8;e-=t;const n=(e/=8)%7;e-=n;const r=(e/=7)%13;e-=r;const i=(e/=13)%12;e-=i;const s=e/=12,o=VW.factory.fromInt(t);return new dX(s,i,r+1,n+1,o.get())}};class fX extends ij{static getInitialState(){const e=OZ.NONE,t=OZ.ZERO,n=OZ.ONE;return new fX([[n,n,n,n,n,n,n,n,n,n,n,n,n,n],[n,n,n,n,n,n,n,n,n,n,n,n,n,n],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t]],0)}count(e,t){let n=0;for(let r=0;r<14;r++)this.board[t][r]===e&&n++;return n}doesOwnPiece(e){for(let t=0;t<12;t++)for(let n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}let pX=(()=>{class e{}return e.PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`,e.SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`,e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`,e.SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`,e.SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`,e.SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`,e.SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`,e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`,e.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`,e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`,e})();class gX extends gj{static isLegal(e,t){const n=this.getPhalanxValidity(t,e);if(n.isFailure())return Mw.failure(n.getReason());const r=this.getLandingStatus(t,e);if(r.isFailure())return r;const i=AZ.copyBiArray(r.get()),s=t.getCurrentOpponent(),o=gX.getCaptureValidity(t,i,e,s);return o.isFailure()?o:Mw.success(o.get())}static getPhalanxValidity(e,t){let n=t.coord,r=0;const i=e.getCurrentOpponent();for(;r<t.movedPieces;){if(n.isNotInRange(14,12))return xw.failure(pX.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const s=e.getPieceAt(n);if(s===OZ.NONE)return xw.failure(pX.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(s===i)return xw.failure(pX.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),r++}return xw.SUCCESS}static getLandingStatus(e,t){const n=e.getCopiedBoard(),r=e.getCurrentPlayer();let i=t.coord,s=t.coord.getNext(t.direction,t.movedPieces),o=0;for(;o+1<t.stepSize;){if(n[i.y][i.x]=OZ.NONE,n[s.y][s.x]=r,s.isNotInRange(14,12))return Mw.failure(pX.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(s).isPlayer())return Mw.failure(pX.SOMETHING_IN_PHALANX_WAY());o++,s=s.getNext(t.direction,1),i=i.getNext(t.direction,1)}return s.isNotInRange(14,12)?Mw.failure(pX.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(s)===r?Mw.failure(XW.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=OZ.NONE,n[s.y][s.x]=r,Mw.success(n))}static getCaptureValidity(e,t,n,r){let i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),s=0;for(;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(s>0&&(t[i.y][i.x]=OZ.NONE),s++,s>=n.movedPieces)return Mw.failure(pX.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return Mw.success(t)}isLegal(e,t){return gX.isLegal(e,t)}applyLegalMove(e,t,n){return new fX(n,t.turn+1)}getGameStatus(e){const t=e.gameState,n=t.count(bZ.ZERO,0),r=t.count(bZ.ONE,11);if(t.turn%2==0){if(n>r)return pj.ZERO_WON}else if(r>n)return pj.ONE_WON;return!1===t.doesOwnPiece(bZ.ZERO)?pj.ONE_WON:!1===t.doesOwnPiece(bZ.ONE)?pj.ZERO_WON:pj.ONGOING}}class mX extends JW{static getListMoves(e){const t=e.gameState.getCurrentPlayer(),n=e.gameState.getCurrentOpponent(),r=OZ.NONE;let i=[];const s=e.gameState;let o;for(let a=0;a<12;a++)for(let e=0;e<14;e++){const l=new HW(e,a);if(s.getPieceAt(l)===t)for(const c of VW.DIRECTIONS){let u=1,h=l.getNext(c,1);for(;h.isInRange(14,12)&&s.getPieceAt(h)===t;)u+=1,h=h.getNext(c,1);let d=1;for(;h.isInRange(14,12)&&d<=u&&s.getPieceAt(h)===r;)o=new dX(e,a,u,d,c),i=this.addMove(i,o,s),d++,h=h.getNext(c,1);h.isInRange(14,12)&&d<=u&&s.getPieceAt(h)===n&&(o=new dX(e,a,u,d,c),i=this.addMove(i,o,s))}}return i}static addMove(e,t,n){return gX.isLegal(t,n).isSuccess()&&e.push(t),e}getListMoves(e){const t=mX.getListMoves(e);return AZ.sortByDescending(t,e=>e.stepSize),t}getBoardValue(e){const t=this.ruler.getGameStatus(e);return new ej(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}getPieceCountPlusRowDomination(e){let t=0;for(let n=0;n<12;n++){let r=0;const i=[0,0];for(let s=0;s<14;s++){const o=new HW(s,n),a=e.getPieceAt(o);if(a.isPlayer()){const n=a.getScoreModifier();t+=2002*n,i[a.value]=n,r+=n;for(const r of[VW.UP_LEFT,VW.UP,VW.UP_RIGHT]){let i=o.getNext(r,1);for(;i.isInRange(14,12)&&e.getPieceAt(i)===a;)t+=1*n,i=i.getNext(r,1)}}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce((e,t)=>e+t)}return t}}class yX extends JW{getListMoves(e){const t=mX.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}orderMovesByPhalanxSizeAndFilter(e,t){return AZ.sortByDescending(e,e=>e.movedPieces),e.length>40?e.filter(e=>!!this.moveIsCapture(e,t)||e.movedPieces*Math.random()>1):e}moveIsCapture(e,t){const n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}getBoardValue(e){const t=this.ruler.getGameStatus(e);return new ej(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}getPieceCountThenSupportThenAdvancement(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=new HW(r,n),s=e.getPieceAt(i);if(s.isPlayer()){let r,o;s===bZ.ZERO?(r=12-n,o=[VW.UP_LEFT,VW.UP,VW.UP_RIGHT]):(r=n+1,o=[VW.DOWN_LEFT,VW.DOWN,VW.DOWN_RIGHT]);const a=s.getScoreModifier();t+=r*a,t+=149629*a;for(const n of o){let r=i.getNext(n,1);for(;r.isInRange(14,12)&&e.getPieceAt(r)===s;)t+=337*a,r=r.getNext(n,1)}}}return t}}class vX extends mX{constructor(){super(...arguments),this.DOMINANCE_FACTOR=20,this.DEFENSE_FACTOR=5,this.TERRITORY_FACTOR=2,this.OFFENSE_FACTOR=10,this.CENTER_FACTOR=5,this.MOBILITY_FACTOR=.12}getDominance(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=e.getPieceAt(new HW(r,n));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}getDefense(e){let t=0;for(let n=0;n<14;n++)e.getPieceAt(new HW(n,11))===bZ.ZERO&&(t+=bZ.ZERO.getScoreModifier()),e.getPieceAt(new HW(n,0))===bZ.ONE&&(t+=bZ.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}getTerritory(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=e.getPieceAt(new HW(r,n));if(i.isPlayer()){for(let s=-1;s<=1;s++)for(let o=-1;o<=1;o++){const a=new HW(r+s,n+o);if(a.isInRange(14,12)){const n=e.getPieceAt(a);(n===i||n===OZ.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}getOffense(e){let t=0;for(let n=0;n<14;n++)e.getPieceAt(new HW(n,0))===bZ.ZERO&&(t+=bZ.ZERO.getScoreModifier()),e.getPieceAt(new HW(n,11))===bZ.ONE&&(t+=bZ.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}getCenter(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=e.getPieceAt(new HW(r,n));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}getMobility(e){let t=0,n=0,r=0;for(let i=0;i<12;i++)for(let s=0;s<14;s++){const o=new HW(s,i),a=e.getPieceAt(o);if(a.isPlayer())for(const i of VW.DIRECTIONS){let s=1,l=o.getNext(i,1);for(;l.isInRange(14,12)&&e.getPieceAt(l)===a;)s+=1,l=l.getNext(i,1);let c=1;for(;l.isInRange(14,12)&&c<=s&&e.getPieceAt(l)===OZ.NONE;)c++,l=l.getNext(i,1);t+=c*c*a.getScoreModifier(),a===bZ.ZERO?n=Math.max(n,c):a===bZ.ONE&&(r=Math.max(r,c))}}return(t+n*bZ.ZERO.getScoreModifier()+r*bZ.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(e){const t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new ej(n.toBoardValue());const r=this.getDominance(t),i=this.getDefense(t),s=this.getTerritory(t),o=this.getCenter(t),a=this.getOffense(t),l=this.getMobility(t);return new ej(r+i+s+o+a+l)}}const CX=OZ.NONE,_X=OZ.ZERO,EX=OZ.ONE;class wX{constructor(){this.tutorial=[Cj.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,fX.getInitialState()),Cj.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new fX([[CX,CX,CX,CX,CX,_X,CX,CX,EX,EX,EX,EX,EX,EX],[CX,CX,CX,CX,CX,_X,CX,CX,CX,CX,CX,CX,EX,EX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,EX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,_X,_X,_X,_X,CX,CX,CX]],0)),Cj.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new fX([[CX,CX,CX,CX,CX,_X,CX,CX,CX,CX,EX,EX,EX,EX],[CX,CX,CX,CX,CX,_X,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,EX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,EX,EX,CX,CX,CX,_X,_X,CX,_X,_X,_X,_X]],1)),Cj.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol>`,fX.getInitialState(),new dX(0,10,1,1,VW.UP),(e,t,n)=>1===e.movedPieces?xw.SUCCESS:xw.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),Cj.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        Move a phalanx!`,fX.getInitialState(),new dX(0,11,2,1,VW.UP),(e,t,n)=>e.movedPieces>1?xw.SUCCESS:xw.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),Cj.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        Capture a phalanx.`,new fX([[CX,CX,CX,CX,CX,CX,CX,CX,EX,EX,EX,EX,EX,EX],[CX,CX,CX,CX,CX,CX,EX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,EX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,EX,CX,EX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,EX,EX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,EX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,_X,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,_X,CX,CX,CX,CX,EX,CX,CX,CX,CX,CX,CX],[CX,CX,_X,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,_X,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX,CX],[CX,CX,CX,CX,CX,CX,CX,_X,_X,_X,_X,_X,_X,_X]],0),[new dX(2,10,4,2,VW.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}}function PX(e,t){if(1&e){const e=va();_n(),fa(0,"circle",4),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onClick(t,n)}),pa()}if(2&e){const e=Sa().index,t=Sa().index,n=Sa();ha("ngClass",n.getPieceClasses(e,t)),ra("cx",n.SPACE_SIZE*e+n.STROKE_WIDTH+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.STROKE_WIDTH+n.SPACE_SIZE/2)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}function SX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",2),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),pa(),la(2,PX,1,4,"circle",3),pa()}if(2&e){const e=t.index,n=Sa().index,r=Sa();ks(1),Ta("id","click_",e,"_",n,""),ha("ngClass",r.getRectClasses(e,n)),ra("x",r.SPACE_SIZE*e+r.STROKE_WIDTH)("y",r.SPACE_SIZE*n+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),ks(1),ha("ngIf",r.board[n][e]!==r.NONE)}}function bX(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,SX,3,8,"g",1),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function OX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",5),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();ks(1),ra("x",n.SPACE_SIZE*e.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*e.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let kX=(()=>{class e extends eY{constructor(e){super(e),this.NONE=OZ.NONE,this.firstPiece=Aw.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=Aw.empty(),this.phalanxDirection=Aw.empty(),this.phalanxMiddles=[],this.moveds=[],this.captureds=[],this.hasAsymetricBoard=!0,this.rules=new gX(fX),this.availableMinimaxes=[new mX(this.rules,"Normal"),new yX(this.rules,"Positional"),new vX(this.rules,"Attack")],this.encoder=dX.encoder,this.tutorial=(new wX).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=Aw.empty(),this.lastPiece=Aw.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.getState().getCopiedBoard()}showPreviousMove(){const e=this.rules.node.move.get();let t=e.coord;this.moveds=[t];for(let i=1;i<e.stepSize+e.movedPieces;i++)t=t.getNext(e.direction,1),this.moveds.push(t);const n=this.rules.node.mother.get(),r=n.gameState.getCurrentOpponent();for(;t.isInRange(14,12)&&n.gameState.getPieceAt(t)===r;)this.captureds.push(t),t=t.getNext(e.direction,1)}onClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t)})()}firstClick(e,t){var n=this;return Sw(function*(){const r=n.getState().getCurrentOpponent(),i=n.getState().getCurrentPlayer();switch(n.board[t][e]){case i:return n.firstPiece=Aw.of(new HW(e,t)),n.validExtensions=n.getValidExtensions(i),n.phalanxValidLandings=n.getPhalanxValidLandings(),xw.SUCCESS;case r:return n.cancelMove(XW.CANNOT_CHOOSE_OPPONENT_PIECE());default:return bw.expectToBe(n.board[t][e],OZ.NONE),n.cancelMove(XW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.captureds=[],this.moveds=[]}getValidExtensions(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}getFirstPieceExtensions(e){const t=[];for(const n of VW.DIRECTIONS){let r=this.firstPiece.get().getNext(n,1);for(;r.isInRange(14,12)&&this.board[r.y][r.x]===e;)t.push(r),r=r.getNext(n,1)}return t}getPhalanxValidExtensions(e){let t=VW.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();const i=this.firstPiece.get().getNext(t,1),s=this.getExtensionsToward(i,t,e);return r.concat(s)}getExtensionsToward(e,t,n){const r=[];for(;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1;let s=VW.factory.fromMove(e,t).get();const o=t.getNext(s,1),a=this.getLandingsToward(o,s,i);s=s.getOpposite();const l=e.getNext(s,1);return this.getLandingsToward(l,s,i).concat(a)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const e=[];for(const t of VW.DIRECTIONS){const n=this.firstPiece.get().getNext(t,1);n.isInRange(14,12)&&this.board[n.y][n.x]===OZ.NONE&&e.push(n)}return e}getLandingsToward(e,t,n){const r=this.getState().getCurrentPlayer(),i=this.getState().getCurrentOpponent(),s=[];for(;e.isInRange(14,12)&&s.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&s.push(e),s;s.push(e),e=e.getNext(t,1)}return s}getPhalanxLength(e,t,n){let r=0;for(;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}cancelMoveAttempt(){this.firstPiece=Aw.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=Aw.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(e,t){var n=this;return Sw(function*(){const r=new HW(e,t),i=n.firstPiece.get();if(r.equals(i))return n.cancelMoveAttempt(),xw.SUCCESS;const s=n.getState().getCurrentOpponent(),o=n.getState().getCurrentPlayer();if(!r.isAlignedWith(i))return n.cancelMove(pX.SQUARE_NOT_ALIGNED_WITH_SELECTED());const a=r.getDistance(i),l=i.getDirectionToward(r).get();switch(n.board[t][e]){case OZ.NONE:return 1===a?n.tryMove(new dX(i.x,i.y,1,1,l)):n.cancelMove(pX.SINGLE_PIECE_MUST_MOVE_BY_ONE());case s:return n.cancelMove(pX.SINGLE_PIECE_CANNOT_CAPTURE());default:bw.expectToBe(n.board[t][e],o);const c=new dX(i.x,i.y,a,1,l),u=n.getState(),h=gX.getPhalanxValidity(u,c);return h.isFailure()?n.cancelMove(h.getReason()):(n.lastPiece=Aw.of(r),n.validExtensions=n.getValidExtensions(o),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=i.getCoordsToward(r),n.phalanxDirection=Aw.of(l),xw.SUCCESS)}})()}thirdClick(e,t){var n=this;return Sw(function*(){const r=n.getState().getCurrentPlayer(),i=new HW(e,t);if(n.firstPiece.equalsValue(i))return n.moveFirstPiece(r);if(n.lastPiece.equalsValue(i))return n.moveLastPiece(r);const s=n.firstPiece.get(),o=n.lastPiece.get();if(!i.isAlignedWith(s))return n.cancelMove(pX.SQUARE_NOT_ALIGNED_WITH_PHALANX());let a=VW.factory.fromMove(s,o).get();const l=VW.factory.fromMove(s,i).get();if(a===l.getOpposite()&&(n.firstPiece=Aw.of(o),n.lastPiece=Aw.of(s),a=l),a!==l)return n.cancelMove(pX.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(n.board[t][e]===r)return n.thirdClickOnPlayerPiece(i,a,r);{const e=n.firstPiece.get().getDistance(n.lastPiece.get())+1,t=n.lastPiece.get().getDistance(i),r=new dX(n.firstPiece.get().x,n.firstPiece.get().y,e,t,a);return n.tryMove(r)}})()}thirdClickOnPlayerPiece(e,t,n){var r=this;return Sw(function*(){r.lastPiece=Aw.of(e);const i=r.firstPiece.get().getDistance(e)+1,s=new dX(r.firstPiece.get().x,r.firstPiece.get().y,i,1,t),o=gX.getPhalanxValidity(r.rules.node.gameState,s);return o.isFailure()?r.cancelMove(o.getReason()):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getValidExtensions(n),r.phalanxValidLandings=r.getPhalanxValidLandings(),xw.SUCCESS)})()}moveFirstPiece(e){var t=this;return Sw(function*(){return t.firstPiece=Aw.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?yield t.moveOnlyPiece(e):(t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e)),t.phalanxValidLandings=t.getPhalanxValidLandings(),xw.SUCCESS})()}moveLastPiece(e){var t=this;return Sw(function*(){return t.lastPiece=Aw.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),xw.SUCCESS)})()}moveOnlyPiece(e){var t=this;return Sw(function*(){return t.lastPiece=Aw.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=Aw.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),xw.SUCCESS})()}tryMove(e){const t=this.getState();return this.cancelMove(),this.chooseMove(e,t)}getPieceClasses(e,t){const n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}getPieceStrokeClasses(e,t){const n=new HW(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(e=>e.equals(n))?["selected-stroke"]:[]}getRectClasses(e,t){const n=new HW(e,t);return this.captureds.some(e=>e.equals(n))?["captured-fill"]:this.moveds.some(e=>e.equals(n))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const e=[],t=this.getState().getCurrentPlayer();for(let n=0;n<this.board.length;n++)for(let r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new HW(r,n));return e}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-epaminondas"]],features:[Go],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,bX,2,1,"g",1),la(2,OX,2,4,"g",1),pa()),2&e&&(ra("transform",t.rotation),ks(1),ha("ngForOf",t.board),ks(1),ha("ngForOf",t.getHighlightedCoords()))},directives:[Jd,Qd,tf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();function TX(e){return new class extends EZ{encode(t){return t.isPresent()?e.encode(t.get()):null}decode(t){return null===t?Aw.empty():Aw.of(e.decode(t))}}}class IX{constructor(e){if(e.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===dQ.areOnSameLine(e))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=AZ.copyImmutableArray(e).sort((e,t)=>{if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate coords");return e.y>t.y?1:-1}return e.x>t.x?1:-1});let t=Aw.empty();for(const n of this.capturedSpaces){if(t.isPresent()&&1!==t.get().getDistance(n))throw new Error("Cannot create a GipfCapture with non-consecutive coords");t=Aw.of(n)}}toString(){let e="";for(const t of this.capturedSpaces)""!==e&&(e+=","),e+=t.toString();return e}size(){return this.capturedSpaces.length}forEach(e){this.capturedSpaces.forEach(e)}contains(e){for(let t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}intersectsWith(e){return this.capturedSpaces.some(t=>e.contains(t))}getLine(){return dQ.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(let t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}IX.encoder=new class extends EZ{encode(e){return e.capturedSpaces.map(e=>HW.encoder.encode(e))}decode(e){return new IX(e.map(e=>HW.encoder.decode(e)))}};class AX{constructor(e,t){this.coord=e,this.direction=t}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}AX.encoder=new class extends EZ{constructor(){super(...arguments),this.optionalDirectionEncoder=TX(WW.encoder)}encode(e){return{coord:HW.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}decode(e){const t=e;return cZ(null!=t.coord,"Invalid encoded GipfPlacement"),new AX(HW.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}};class MX extends oj{constructor(e,t,n){super(),this.placement=e,this.initialCaptures=t,this.finalCaptures=n}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}equals(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===AZ.compareArray(this.initialCaptures,e.initialCaptures)||!1===AZ.compareArray(this.finalCaptures,e.finalCaptures))}encode(){return MX.encoder.encode(this)}decode(e){return MX.encoder.decode(e)}}MX.encoder=new class extends wZ{encodeMove(e){const t={placement:AX.encoder.encode(e.placement)};return e.initialCaptures.map((e,n)=>{t["initialCapture"+n]=IX.encoder.encode(e)}),e.finalCaptures.map((e,n)=>{t["finalCapture"+n]=IX.encoder.encode(e)}),t}decodeMove(e){const t=e;return cZ(null!=t.placement,"Invalid encoded GipfMove"),new MX(AX.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",IX.encoder.decode),this.decodeArray(t,"finalCapture",IX.encoder.decode))}decodeArray(e,t,n){const r=[];for(let i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}};class NX extends fQ{constructor(e,t,n,r){super(t,e,7,7,[3,2,1],qW.EMPTY),this.sidePieces=n,this.capturedPieces=r}static getInitialState(){const e=qW.EMPTY,t=qW.UNREACHABLE,n=qW.ZERO,r=qW.ONE;return new NX([[t,t,t,r,e,e,n],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[n,e,e,e,e,e,r],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[r,e,e,n,t,t,t]],0,[12,12],[0,0])}equals(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&AZ.compareTable(this.board,e.board)}getNumberOfPiecesToPlace(e){return this.sidePieces[e.value]}getNumberOfPiecesCaptured(e){return this.capturedPieces[e.value]}setAtUnsafe(e,t){const n=AZ.copyBiArray(this.board);return n[e.y][e.x]=t,new NX(n,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==qW.UNREACHABLE}}let RX=(()=>{class e{}return e.CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`,e.INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`,e.MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`,e.PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`,e.INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`,e.PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`,e.PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`,e.AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`,e.NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`,e})();class xX extends gj{applyLegalMove(e,t,n){return new NX(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}static applyCaptures(e,t){let n=t;return e.forEach(e=>{n=xX.applyCapture(e,n)}),n}static applyCapture(e,t){const n=t.getCurrentPlayer();let r=t;const i=[t.sidePieces[0],t.sidePieces[1]],s=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(e=>{const o=t.getPieceAt(e);r=r.setAt(e,qW.EMPTY),o.is(n)?i[n.value]+=1:s[n.value]+=1}),new NX(r.board,t.turn,i,s)}static getPlacements(e){const t=[];return QW.INSTANCE.getAllBorders(e).forEach(n=>{e.getPieceAt(n)===qW.EMPTY?t.push(new AX(n,Aw.empty())):xX.getAllDirectionsForEntrance(e,n).forEach(r=>{!1===xX.isLineComplete(e,n,r)&&t.push(new AX(n,Aw.of(r)))})}),t}static isLineComplete(e,t,n){return xX.nextGapInLine(e,t,n).isAbsent()}static nextGapInLine(e,t,n){for(let r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===qW.EMPTY)return Aw.of(r);return Aw.empty()}static applyPlacement(e,t){const n=t.getCurrentPlayer();let r=t,i=qW.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){const n=e.coord;if(t.getPieceAt(n)!==qW.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(n,i)}else for(let o=e.coord;r.isOnBoard(o)&&i!==qW.EMPTY;o=o.getNext(e.direction.get())){const e=t.getPieceAt(o);r=r.setAt(o,i),i=e}const s=[t.sidePieces[0],t.sidePieces[1]];return s[n.value]-=1,new NX(r.board,t.turn,s,t.capturedPieces)}getPiecesMoved(e,t,n){const r=xX.applyCaptures(t,e);if(n.direction.isAbsent())return[n.coord];{const e=n.direction.get(),t=[];t.push(n.coord);let i=n.coord.getNext(e);for(;r.isOnBoard(i)&&r.getPieceAt(i)!==qW.EMPTY;)t.push(i),i=i.getNext(e);return cZ(r.isOnBoard(i)&&r.getPieceAt(i)===qW.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),t.push(i),t}}static getAllDirectionsForEntrance(e,t){if(QW.INSTANCE.isTopLeftCorner(e,t))return[WW.RIGHT,WW.DOWN,WW.UP_RIGHT];if(QW.INSTANCE.isTopCorner(e,t))return[WW.DOWN,WW.DOWN_LEFT,WW.RIGHT];if(QW.INSTANCE.isTopRightCorner(e,t))return[WW.DOWN_LEFT,WW.DOWN,WW.LEFT];if(QW.INSTANCE.isBottomLeftCorner(e,t))return[WW.UP_RIGHT,WW.UP,WW.RIGHT];if(QW.INSTANCE.isBottomCorner(e,t))return[WW.UP,WW.LEFT,WW.UP_RIGHT];if(QW.INSTANCE.isBottomRightCorner(e,t))return[WW.LEFT,WW.UP,WW.DOWN_LEFT];if(QW.INSTANCE.isOnTopLeftBorder(e,t))return[WW.RIGHT,WW.DOWN];if(QW.INSTANCE.isOnLeftBorder(e,t))return[WW.UP_RIGHT,WW.RIGHT];if(QW.INSTANCE.isOnBottomLeftBorder(e,t))return[WW.UP,WW.UP_RIGHT];if(QW.INSTANCE.isOnBottomRightBorder(e,t))return[WW.LEFT,WW.UP];if(QW.INSTANCE.isOnRightBorder(e,t))return[WW.LEFT,WW.DOWN_LEFT];if(QW.INSTANCE.isOnTopRightBorder(e,t))return[WW.DOWN_LEFT,WW.DOWN];throw new Error("not a border")}isLegal(e,t){const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();const r=xX.applyCaptures(e.initialCaptures,t),i=this.noMoreCapturesValidity(r);if(i.isFailure())return i.toFailedFallible();const s=this.placementValidity(r,e.placement);if(s.isFailure())return s.toFailedFallible();const o=xX.applyPlacement(e.placement,r),a=this.capturesValidity(o,e.finalCaptures);if(a.isFailure())return a.toFailedFallible();const l=xX.applyCaptures(e.finalCaptures,o),c=this.noMoreCapturesValidity(l);return c.isFailure()?c.toFailedFallible():Mw.success(l)}capturesValidity(e,t){let n=e;for(const r of t){const e=this.captureValidity(n,r);if(e.isFailure())return e;n=xX.applyCapture(r,n)}return xw.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer(),r=xX.getLinePortionWithFourPiecesOfPlayer(e,n,t.getLine());if(r.isAbsent())return xw.failure(RX.CAPTURE_MUST_BE_ALIGNED());const i=r.get();return xX.getCapturable(e,i).equals(t)?xw.SUCCESS:xw.failure(RX.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(r=>{const i=xX.getLinePortionWithFourPiecesOfPlayer(e,t,r);i.isPresent()&&n.push(i.get())}),n}static getLinePortionWithFourPiecesOfPlayer(e,t,n){let r=0;const i=e.getEntranceOnLine(n),s=n.getDirection();let o=i;for(let a=i;e.isOnBoard(a);a=a.getNext(s))if(e.getPieceAt(a).is(t)?(0===r&&(o=a),r+=1):r=0,4===r)return Aw.of({0:o,1:a,2:s});return Aw.empty()}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===xX.getLinePortionsWithFourPiecesOfPlayer(e,t).length?xw.SUCCESS:xw.failure(RX.MISSING_CAPTURES())}placementValidity(e,t){const n=this.placementCoordValidity(e,t.coord);if(n.isFailure())return n;if(e.getPieceAt(t.coord)!==qW.EMPTY){if(t.direction.isAbsent())return xw.failure(RX.PLACEMENT_WITHOUT_DIRECTION());if(xX.isLineComplete(e,t.coord,t.direction.get()))return xw.failure(RX.PLACEMENT_ON_COMPLETE_LINE());for(const n of xX.getAllDirectionsForEntrance(e,t.coord))if(n===t.direction.get())return xw.SUCCESS;return xw.failure(RX.INVALID_PLACEMENT_DIRECTION())}return xw.SUCCESS}placementCoordValidity(e,t){return QW.INSTANCE.isOnBorder(e,t)?xw.SUCCESS:xw.failure(RX.PLACEMENT_NOT_ON_BORDER())}static getCapturable(e,t){const n=[],r=t[0],i=t[1],s=t[2],o=s.getOpposite();let a=r.getNext(o);for(;e.isOnBoard(a)&&e.getPieceAt(a)!==qW.EMPTY;)n.push(a),a=a.getNext(o);for(let l=r;!l.equals(i);l=l.getNext(s))n.push(l);for(let l=i;e.isOnBoard(l)&&e.getPieceAt(l)!==qW.EMPTY;l=l.getNext(s))n.push(l);return new IX(n)}static getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return xX.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(t=>{n.push(xX.getCapturable(e,t))}),n}static getPlayerScore(e,t){const n=e.getNumberOfPiecesToPlace(t);if(0===n&&0===xX.getPossibleCaptures(e).length)return Aw.empty();const r=e.getNumberOfPiecesCaptured(t);return Aw.of(n+3*r)}static isGameOver(e){const t=xX.getPlayerScore(e,bZ.ZERO),n=xX.getPlayerScore(e,bZ.ONE);return t.isAbsent()||n.isAbsent()}getGameStatus(e){const t=e.gameState,n=xX.getPlayerScore(t,bZ.ZERO),r=xX.getPlayerScore(t,bZ.ONE);return n.isAbsent()?pj.ONE_WON:r.isAbsent()?pj.ZERO_WON:pj.ONGOING}}class DX extends JW{static getPossibleCaptureCombinationsFromPossibleCaptures(e){const t=DX.computeIntersections(e);let n=[[]];return e.forEach((e,r)=>{if(0===t[r].length)n.forEach(e=>{e.push(r)});else{const e=[],i=t[r].some(e=>e>r);for(const s of n)!0===s.some(e=>t[r].some(t=>e===t))?e.push(AZ.copyImmutableArray(s)):i?(e.push(AZ.copyImmutableArray(s)),s.push(r),e.push(AZ.copyImmutableArray(s))):(s.push(r),e.push(AZ.copyImmutableArray(s)));n=e}}),n.map(t=>t.map(t=>e[t]))}static computeIntersections(e){const t=[];return e.forEach((n,r)=>{t.push([]),e.forEach((e,i)=>{r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}getBoardValue(e){const t=e.gameState,n=xX.getPlayerScore(t,bZ.ZERO),r=xX.getPlayerScore(t,bZ.ONE);return n.isAbsent()?new ej(bZ.ONE.getVictoryValue()):r.isAbsent()?new ej(bZ.ZERO.getVictoryValue()):new ej(n.get()-r.get())}getListMoves(e){return this.getListMoveFromState(e.gameState)}getListMoveFromState(e){const t=[];return xX.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(n=>{const r=xX.applyCaptures(n,e);xX.getPlacements(r).forEach(e=>{const i=xX.applyPlacement(e,r);this.getPossibleCaptureCombinations(i).forEach(r=>{const i=new MX(e,n,r);t.push(i)})})}),t}getPossibleCaptureCombinations(e){const t=xX.getPossibleCaptures(e);return DX.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}class LX{constructor(e,t,n,r,i,s){this.source=e,this.destination=t,this.x1=n,this.y1=r,this.x2=i,this.y2=s}}const FX=qW.UNREACHABLE,UX=qW.EMPTY,VX=qW.ZERO,BX=qW.ONE;class $X{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,NX.getInitialState()),Cj.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,NX.getInitialState(),new MX(new AX(new HW(3,0),Aw.of(WW.DOWN)),[],[]),$localize`Congratulations!`),Cj.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new NX([[FX,FX,FX,VX,BX,UX,UX],[FX,FX,UX,UX,UX,UX,UX],[FX,UX,UX,UX,UX,UX,UX],[VX,VX,VX,UX,UX,UX,UX],[BX,UX,UX,UX,UX,UX,FX],[UX,UX,UX,BX,UX,FX,FX],[UX,UX,UX,BX,FX,FX,FX]],42,[8,8],[0,0]),[new MX(new AX(new HW(0,3),Aw.of(WW.RIGHT)),[],[new IX([new HW(0,3),new HW(1,3),new HW(2,3),new HW(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed!`),Cj.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways of capturing.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/><br/>
        Pick the last one.`,new NX([[FX,FX,FX,UX,UX,UX,UX],[FX,FX,UX,BX,UX,UX,UX],[FX,UX,UX,VX,UX,UX,UX],[VX,VX,VX,BX,UX,UX,UX],[UX,UX,UX,VX,UX,UX,FX],[UX,UX,UX,VX,UX,FX,FX],[UX,UX,UX,BX,FX,FX,FX]],42,[8,4],[2,3]),[new MX(new AX(new HW(0,3),Aw.of(WW.RIGHT)),[],[new IX([new HW(3,1),new HW(3,2),new HW(3,3),new HW(3,4),new HW(3,5),new HW(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),Cj.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.`,new NX([[FX,FX,FX,VX,UX,UX,VX],[FX,FX,UX,VX,UX,UX,VX],[FX,VX,VX,UX,VX,BX,VX],[UX,UX,UX,VX,UX,UX,VX],[UX,UX,UX,VX,UX,UX,FX],[VX,VX,VX,BX,BX,FX,FX],[UX,UX,UX,VX,FX,FX,FX]],42,[8,4],[2,3]),[new MX(new AX(new HW(3,6),Aw.of(WW.UP)),[new IX([new HW(6,0),new HW(6,1),new HW(6,2),new HW(6,3)])],[new IX([new HW(0,5),new HW(1,5),new HW(2,5),new HW(3,5),new HW(4,5)]),new IX([new HW(1,2),new HW(2,2),new HW(3,2),new HW(4,2),new HW(5,2)])]),new MX(new AX(new HW(4,6),Aw.of(WW.UP)),[new IX([new HW(6,0),new HW(6,1),new HW(6,2),new HW(6,3)])],[new IX([new HW(0,5),new HW(1,5),new HW(2,5),new HW(3,5),new HW(4,5)]),new IX([new HW(3,0),new HW(3,1),new HW(3,2),new HW(3,3),new HW(3,4)])]),new MX(new AX(new HW(3,6),Aw.of(WW.UP)),[new IX([new HW(6,0),new HW(6,1),new HW(6,2),new HW(6,3)])],[new IX([new HW(1,2),new HW(2,2),new HW(3,2),new HW(4,2),new HW(5,2)]),new IX([new HW(0,5),new HW(1,5),new HW(2,5),new HW(3,5),new HW(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}}function zX(e,t){if(1&e&&(_n(),ga(0,"circle",13)),2&e){const e=Sa().$implicit,t=Sa();ha("ngClass",t.getPieceClass(e)),ra("cx",t.getCenterAt(e).x)("cy",t.getCenterAt(e).y)("r",t.SPACE_SIZE)}}function HX(e,t){if(1&e){const e=va();_n(),fa(0,"g",10),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t)}),ga(1,"polygon",11),la(2,zX,1,4,"circle",12),pa()}if(2&e){const e=t.$implicit,n=Sa();Ta("id","click_",e.x,"_",e.y,""),ks(1),Ta("id","space_",e.x,"_",e.y,""),ha("ngClass",n.getSpaceClass(e)),ra("points",n.getHexaCoordsAt(e)),ks(1),ha("ngIf",n.isPiece(e))}}function GX(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",16),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).onClick(t)}),pa()}if(2&e){const e=t.$implicit;ra("points",Sa(2).getHexaCoordsAt(e))}}function ZX(e,t){if(1&e&&(_n(),fa(0,"g",14),la(1,GX,1,1,"polygon",15),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e.capturedSpaces)}}function qX(e,t){if(1&e){const e=va();_n(),fa(0,"line",17),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.destination)}),pa()}if(2&e){const e=t.$implicit;ra("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function WX(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",18),pa()),2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa();ks(1),Ta("id","piece_",n.value,"_",e,""),ha("ngClass",r.getPlayerClass(n)),ra("cx",r.getRemainingPieceCx(n,e))("cy",r.getRemainingPieceCy(n))("r",.5*r.SPACE_SIZE)}}function jX(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,WX,2,6,"g",8),pa()),2&e){const e=t.$implicit,n=Sa();ks(1),ha("ngForOf",n.getPlayerSidePieces(e))}}function YX(e,t){if(1&e&&(_n(),ga(0,"line",19)),2&e){const e=Sa();ra("x1",e.inserted.get().x1)("y1",e.inserted.get().y1)("x2",e.inserted.get().x2)("y2",e.inserted.get().y2)}}let KX=(()=>{class e extends ZW{constructor(t){super(t),this.inserted=Aw.empty(),this.arrows=[],this.captured=[],this.moved=[],this.HEXAGON_WIDTH=this.SPACE_SIZE,this.SHARED_HEXAGON_X=Math.cos(30)*this.HEXAGON_WIDTH*.5,this.BOARD_WIDTH=this.HEXAGON_WIDTH+6*(this.HEXAGON_WIDTH-this.SHARED_HEXAGON_X)+3*this.STROKE_WIDTH/2,this.BOARD_HEIGHT=7*this.HEXAGON_WIDTH+4.5*this.STROKE_WIDTH,this.movePhase=e.PHASE_PLACEMENT_COORD,this.possibleCaptures=[],this.initialCaptures=[],this.placement=Aw.empty(),this.placementEntrance=Aw.empty(),this.finalCaptures=[],this.hasAsymetricBoard=!0,this.scores=Aw.of([0,0]),this.rules=new xX(NX),this.availableMinimaxes=[new DX(this.rules,"GipfMinimax")],this.encoder=MX.encoder,this.tutorial=(new $X).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new jW(1.5*this.SPACE_SIZE,new HW(this.HEXAGON_WIDTH/2+3*this.STROKE_WIDTH/4,-this.HEXAGON_WIDTH),QW.INSTANCE)}updateBoard(){this.showLastMove(),this.cancelMoveAttempt()}showLastMove(){this.inserted=Aw.empty();const e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){const t=e.get().placement;this.inserted=Aw.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}arrowTowards(e,t){const n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new LX(n,e,i.x,i.y,r.x,r.y)}markCapture(e){e.forEach(e=>{this.captured.push(e)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(e){const t=this.constructedState.getNumberOfPiecesToPlace(e),n=[];for(let r=0;r<t;r+=1)n.push(r);return n}isPiece(e){return this.getPiece(e)!==qW.EMPTY}getPiece(e){return this.constructedState.getPieceAt(e)}onClick(t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+t.x+"_"+t.y);if(r.isFailure())return n.cancelMove(r.getReason());switch(n.movePhase){case e.PHASE_INITIAL_CAPTURE:case e.PHASE_FINAL_CAPTURE:return n.selectCapture(t);case e.PHASE_PLACEMENT_COORD:return n.selectPlacementCoord(t);default:return bw.expectToBe(n.movePhase,e.PHASE_PLACEMENT_DIRECTION),n.selectPlacementDirectionOrPlacementCoord(t)}})()}selectCapture(t){var n=this;return Sw(function*(){const r=[];if(n.possibleCaptures.forEach(e=>{e.contains(t)&&r.push(e)}),r.length>1)return n.cancelMove(RX.AMBIGUOUS_CAPTURE_COORD());if(0===r.length)return n.cancelMove(RX.MISSING_CAPTURES());const i=r[0];return n.constructedState=xX.applyCapture(i,n.constructedState),n.markCapture(i),n.possibleCaptures=xX.getPossibleCaptures(n.constructedState),n.movePhase===e.PHASE_INITIAL_CAPTURE?(n.initialCaptures.push(i),0===n.possibleCaptures.length?n.moveToPlacementPhase():xw.SUCCESS):(bw.expectToBe(n.movePhase,e.PHASE_FINAL_CAPTURE),n.finalCaptures.push(i),0===n.possibleCaptures.length?n.tryMove(n.initialCaptures,n.placement.get(),n.finalCaptures):xw.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=e.PHASE_PLACEMENT_COORD,xw.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=xX.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?e.PHASE_PLACEMENT_COORD:e.PHASE_INITIAL_CAPTURE,xw.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var t=this;return Sw(function*(){return t.possibleCaptures=xX.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):(t.movePhase=e.PHASE_FINAL_CAPTURE,xw.SUCCESS)})()}computeArrows(e){this.arrows=[];for(const t of xX.getAllDirectionsForEntrance(this.constructedState,e))if(!1===xX.isLineComplete(this.constructedState,e,t)){const n=e.getNext(t),r=this.getCenterAt(e),i=this.getCenterAt(n);this.arrows.push(new LX(e,n,r.x,r.y,i.x,i.y))}}selectPlacementCoord(t){var n=this;return Sw(function*(){const r=n.rules.placementCoordValidity(n.constructedState,t);return r.isFailure()?n.cancelMove(r.getReason()):n.placementEntrance.equalsValue(t)?(n.cancelMoveAttempt(),xw.SUCCESS):(n.placementEntrance=Aw.of(t),n.constructedState.getPieceAt(t)===qW.EMPTY?n.selectPlacementDirection(Aw.empty()):(n.movePhase=e.PHASE_PLACEMENT_DIRECTION,n.computeArrows(t),0===n.arrows.length&&n.cancelMove(RX.NO_DIRECTIONS_AVAILABLE()),xw.SUCCESS))})()}selectPlacementDirection(e){var t=this;return Sw(function*(){t.placement=Aw.of(new AX(t.placementEntrance.get(),e));const n=t.rules.placementValidity(t.constructedState,t.placement.get());return n.isFailure()?t.cancelMove(n.getReason()):(t.arrows=[],t.constructedState=xX.applyPlacement(t.placement.get(),t.constructedState),t.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(e){var t=this;return Sw(function*(){const n=t.placementEntrance.get();if(!1===n.isAlignedWith(e)||1!==n.getDistance(e))return t.selectPlacementCoord(e);const r=WW.factory.fromMove(n,e);return t.selectPlacementDirection(r.toOptional())})()}tryMove(e,t,n){var r=this;return Sw(function*(){const i=new MX(t,e,n);return yield r.chooseMove(i,r.getState(),r.scores.get())})()}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const e=this.rules.node.move;if(e.isPresent()){const t=e.get(),n=this.rules.node.mother.get().gameState;t.initialCaptures.forEach(e=>this.markCapture(e)),t.finalCaptures.forEach(e=>this.markCapture(e)),this.moved=this.rules.getPiecesMoved(n,t.initialCaptures,t.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=Aw.empty(),this.placement=Aw.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(e){return this.captured.some(t=>t.equals(e))?"captured-fill":this.moved.some(t=>t.equals(e))?"moved-fill":""}getPieceClass(e){const t=this.getPiece(e);return this.getPlayerClass(bZ.of(t.value))}getRemainingPieceCy(e){return e===bZ.ONE?25:this.BOARD_HEIGHT-25}getRemainingPieceCx(e,t){const n=20+t*this.SPACE_SIZE*.5;return e===bZ.ONE?n:this.BOARD_WIDTH-(15+n)}}return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-gipf"]],features:[Go],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"defs"),fa(2,"marker",1),ga(3,"polygon",2),pa(),fa(4,"marker",3),ga(5,"polygon",4),pa(),pa(),la(6,HX,3,7,"g",5),la(7,ZX,2,1,"g",6),la(8,qX,1,4,"line",7),la(9,jX,2,1,"g",8),la(10,YX,1,4,"line",9),pa()),2&e&&(ra("viewBox",-t.STROKE_WIDTH+" 0 "+t.BOARD_WIDTH+" "+t.BOARD_HEIGHT)("transform",t.rotation),ks(6),ha("ngForOf",t.getAllCoords()),ks(1),ha("ngForOf",t.possibleCaptures),ks(1),ha("ngForOf",t.arrows),ks(1),ha("ngForOf",t.Player.PLAYERS),ks(1),ha("ngIf",t.inserted.isPresent()))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class QX extends aj{equals(e){return this===e||this.coord.equals(e.coord)}toString(){return this===QX.PASS?"GoMove.PASS":this===QX.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}QX.PASS=new QX(-1,0),QX.ACCEPT=new QX(-2,0),QX.PASS_NUMBER=-1,QX.ACCEPT_NUMBER=-2,QX.encoder=new class extends PZ{maxValue(){return 360}encodeNumber(e){return 19*e.coord.y+e.coord.x}decodeNumber(e){if(e===QX.PASS_NUMBER)return QX.PASS;const t=e%19;return new QX(t,(e-t)/19)}};class XX{constructor(e,t){this.player=e,this.type=t}equals(e){return e===this}toString(){switch(this){case XX.DARK:return"GoPiece.DARK";case XX.LIGHT:return"GoPiece.LIGHT";case XX.EMPTY:return"GoPiece.EMPTY";case XX.DEAD_DARK:return"GoPiece.DEAD_DARK";case XX.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case XX.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return cZ(this===XX.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(e,t){return t===e.player&&"territory"!==e.type}static ofPlayer(e){return e===bZ.ZERO?XX.DARK:XX.LIGHT}isOccupied(){return[XX.DARK,XX.LIGHT,XX.DEAD_DARK,XX.DEAD_LIGHT].includes(this)}isEmpty(){return[XX.DARK_TERRITORY,XX.LIGHT_TERRITORY,XX.EMPTY].includes(this)}isDead(){return[XX.DEAD_DARK,XX.DEAD_LIGHT].includes(this)}isTerritory(){return[XX.DARK_TERRITORY,XX.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return cZ(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),XX.EMPTY}}XX.DARK=new XX(bZ.ZERO,"alive"),XX.LIGHT=new XX(bZ.ONE,"alive"),XX.EMPTY=new XX(OZ.NONE,"empty"),XX.DEAD_DARK=new XX(bZ.ZERO,"dead"),XX.DEAD_LIGHT=new XX(bZ.ONE,"dead"),XX.DARK_TERRITORY=new XX(OZ.NONE,"territory"),XX.LIGHT_TERRITORY=new XX(OZ.NONE,"territory");var JX=(()=>(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(JX||(JX={})),JX))();let eJ=(()=>{class e extends ij{constructor(e,t,n,r,i){super(e,n),this.captured=t,this.koCoord=r,this.phase=i}static getInitialState(){const t=e.getStartingBoard();return new e(t,[0,0],0,Aw.empty(),JX.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return AZ.createTable(e.WIDTH,e.HEIGHT,XX.EMPTY)}copy(){return new e(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}return e.WIDTH=13,e.HEIGHT=13,e})(),tJ=(()=>{class e{constructor(e){this.color=e}selfContains(e){return this.getCoords().some(t=>t.equals(e))}static insertAsEntryPoint(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}return e.VERBOSE=!1,e})();class nJ extends tJ{constructor(e,t,n,r,i,s){super(e),this.emptyCoords=t,this.darkCoords=n,this.lightCoords=r,this.deadDarkCoords=i,this.deadLightCoords=s}getCoords(){return this.color===XX.DARK?this.darkCoords:this.color===XX.LIGHT?this.lightCoords:this.color===XX.DEAD_DARK?this.deadDarkCoords:this.color===XX.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(t=>t.equals(e))}addPawn(e,t){switch(cZ(!1===this.contains(e),"This group already contains "+e.toString()),t){case XX.DARK:this.darkCoords=tJ.insertAsEntryPoint(this.darkCoords,e);break;case XX.LIGHT:this.lightCoords=tJ.insertAsEntryPoint(this.lightCoords,e);break;case XX.DEAD_DARK:this.deadDarkCoords=tJ.insertAsEntryPoint(this.deadDarkCoords,e);break;case XX.DEAD_LIGHT:this.deadLightCoords=tJ.insertAsEntryPoint(this.deadLightCoords,e);break;default:bw.expectToBeMultiple(t,[XX.EMPTY,XX.DARK_TERRITORY,XX.LIGHT_TERRITORY]),this.emptyCoords=tJ.insertAsEntryPoint(this.emptyCoords,e)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const e=new uj;e.set(XX.EMPTY,this.emptyCoords.length),e.set(XX.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(XX.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);const t=e.filter((e,t)=>t>0);if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const e=[];return this.color!==XX.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==XX.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==XX.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==XX.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==XX.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}class rJ extends class{getGroupDatas(e,t){Ow(tJ.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");const n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}_getGroupDatas(e,t,n){Ow(tJ.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});const r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color)for(const i of this.getDirections()){const r=e.getNext(i);r.isInRange(t[0].length,t.length)&&(n.contains(r)||(n=this._getGroupDatas(r,t,n)))}return n}}{getNewInstance(e){return new nJ(e,[],[],[],[],[])}getDirections(){return BW.ORTHOGONALS}}let iJ=(()=>{class e{}return e.ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`,e.CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`,e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`,e.OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`,e.CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`,e})(),sJ=(()=>{class e extends gj{static isLegal(t,n){const r=!1;if(Ow(e.VERBOSE||r,{isLegal:{move:t,state:n}}),e.isPass(t)){const t=n.phase===JX.PLAYING,i=n.phase===JX.PASSED;return Ow(e.VERBOSE||r,"GoRules.isLegal at "+n.phase+(t||i?" forbid":" allowed")+" passing on "+n.getCopiedBoard()),t||i?Mw.success([]):Mw.failure(iJ.CANNOT_PASS_AFTER_PASSED_PHASE())}if(e.isAccept(t)){const e=n.phase===JX.ACCEPT;return n.phase===JX.COUNTING||e?Mw.success([]):Mw.failure(iJ.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return e.isOccupied(t.coord,n.getCopiedBoard())?(Ow(e.VERBOSE||r,"GoRules.isLegal: move is marking"),e.isLegalDeadMarking(t,n)?Mw.success([]):Mw.failure(iJ.OCCUPIED_INTERSECTION())):(Ow(e.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+t.toString()),e.isLegalNormalMove(t,n))}static getNewKo(e,t,n){if(1===n.length){const r=n[0],i=e.coord,s=t[i.y][i.x],o=(new rJ).getGroupDatas(i,t),a=o.emptyCoords,l=XX.pieceBelongTo(s,bZ.ZERO)?o.darkCoords:o.lightCoords;if(1===a.length&&a[0].equals(r)&&1===l.length)return Aw.of(r)}return Aw.empty()}static markTerritoryAndCount(t){Ow(e.VERBOSE,{markTerritoryAndCount:{state:t}});const n=t.getCopiedBoard(),r=e.getTerritoryLikeGroup(t),i=t.getCapturedCopy();for(const e of r){const t=e.getWrapper();if(t===XX.LIGHT){i[1]+=e.emptyCoords.length;for(const t of e.getCoords())n[t.y][t.x]=XX.LIGHT_TERRITORY}else{cZ(t===XX.DARK,"territory should be wrapped by dark or light, not by "+t.toString()),i[0]+=e.emptyCoords.length;for(const t of e.getCoords())n[t.y][t.x]=XX.DARK_TERRITORY}}return new eJ(n,i,t.turn,t.koCoord,t.phase)}static removeAndSubstractTerritory(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy();let r;for(let i=0;i<e.board.length;i++)for(let s=0;s<e.board[0].length;s++)r=t[i][s],r===XX.DARK_TERRITORY?(t[i][s]=XX.EMPTY,n[0]=n[0]-1):r===XX.LIGHT_TERRITORY&&(t[i][s]=XX.EMPTY,n[1]=n[1]-1);return new eJ(t,n,e.turn,e.koCoord,e.phase)}static getEmptyZones(t){return e.getGroupsDatasWhere(t.getCopiedBoard(),e=>e.isEmpty())}static getGroupsDatasWhere(e,t){const n=[];let r,i,s;const o=new rJ;for(let a=0;a<e.length;a++)for(let l=0;l<e[0].length;l++)r=new HW(l,a),s=e[a][l],t(s)&&(n.some(e=>e.selfContains(r))||(i=o.getGroupDatas(r,e),n.push(i)));return n}static addDeadToScore(e){const t=e.getCapturedCopy();let n,r=t[1],i=t[0];for(let s=0;s<e.board.length;s++)for(let t=0;t<e.board[0].length;t++)n=e.getPieceAtXY(t,s),n===XX.DEAD_DARK?r++:n===XX.DEAD_LIGHT&&i++;return[i,r]}static switchAliveness(e,t){const n=t.getCopiedBoard();cZ(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");const r=(new rJ).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case XX.DEAD_DARK:i[1]-=2*r.deadDarkCoords.length;for(const e of r.deadDarkCoords)n[e.y][e.x]=XX.DARK;break;case XX.DEAD_LIGHT:i[0]-=2*r.deadLightCoords.length;for(const e of r.deadLightCoords)n[e.y][e.x]=XX.LIGHT;break;case XX.LIGHT:i[0]+=2*r.lightCoords.length;for(const e of r.lightCoords)n[e.y][e.x]=XX.DEAD_LIGHT;break;default:bw.expectToBe(r.color,XX.DARK),i[1]+=2*r.darkCoords.length;for(const e of r.darkCoords)n[e.y][e.x]=XX.DEAD_DARK}return new eJ(n,i,t.turn,t.koCoord,t.phase)}static getGameStatus(e){const t=e.gameState;return t.phase===JX.FINISHED?t.captured[0]>t.captured[1]?pj.ZERO_WON:t.captured[1]>t.captured[0]?pj.ONE_WON:pj.DRAW:pj.ONGOING}static isPass(e){return e.equals(QX.PASS)}static isAccept(e){return e.equals(QX.ACCEPT)}static isLegalDeadMarking(t,n){return e.isOccupied(t.coord,n.getCopiedBoard())&&(n.phase===JX.COUNTING||n.phase===JX.ACCEPT)}static isLegalNormalMove(t,n){const r=n.getCopiedBoard();if(e.isKo(t,n))return Mw.failure(iJ.ILLEGAL_KO());[JX.COUNTING,JX.ACCEPT].includes(n.phase)&&(n=e.resurrectStones(n));const i=e.getCaptureState(t,n);if(oJ.isCapturing(i))return Mw.success(i.capturedCoords);{r[t.coord.y][t.coord.x]=n.turn%2==0?XX.DARK:XX.LIGHT;const e=0===(new rJ).getGroupDatas(t.coord,r).emptyCoords.length;return r[t.coord.y][t.coord.x]=XX.EMPTY,e?Mw.failure(iJ.CANNOT_COMMIT_SUICIDE()):Mw.success([])}}static isOccupied(e,t){return t[e.y][e.x].isOccupied()}static isKo(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}static getCaptureState(t,n){Ow(e.VERBOSE||!1,{getCaptureState:{move:t,state:n}});const r=new oJ;let i;for(const s of BW.ORTHOGONALS)i=e.getCapturedInDirection(t.coord,s,n),i.length>0&&r.capturedCoords.every(e=>!i[0].equals(e))&&(r.capturedCoords=r.capturedCoords.concat(i));return r}static getCapturedInDirection(t,n,r){const i=r.getCopiedBoard(),s=t.getNext(n);if(s.isInRange(r.board[0].length,r.board.length)&&i[s.y][s.x]===(r.turn%2==0?XX.LIGHT:XX.DARK)){Ow(e.VERBOSE||!1,"a group could be captured");const t=(new rJ).getGroupDatas(s,i);if(e.isCapturableGroup(t,r.koCoord))return Ow(e.VERBOSE||!1,{neightbooringGroupCoord:t.getCoords(),message:"is capturable"}),t.getCoords()}return[]}static isCapturableGroup(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(t){return e.getEmptyZones(t).filter(e=>e.isMonoWrapped())}static applyPass(t){const n=t.getCopiedBoard(),r=t.getCapturedCopy(),i=t.turn;let s,o;return t.phase===JX.PASSED?(s=JX.COUNTING,o=new eJ(n,r,i+1,Aw.empty(),s),o=e.markTerritoryAndCount(o)):(cZ(t.phase===JX.PLAYING,"Cannot pass in counting phase!"),s=JX.PASSED,o=new eJ(n,r,i+1,Aw.empty(),s)),o}static applyLegalAccept(e){const t=e.getCopiedBoard();let n;return n=e.phase===JX.COUNTING?JX.ACCEPT:JX.FINISHED,new eJ(t,e.getCapturedCopy(),e.turn+1,Aw.empty(),n)}static applyNormalLegalMove(t,n,r){let i;Ow(e.VERBOSE,{applyNormalLegal:{currentState:n,legalMove:t,status}}),i=[JX.COUNTING,JX.ACCEPT].includes(n.phase)?e.resurrectStones(n):n.copy();const s=t.coord.x,o=t.coord.y,a=i.getCopiedBoard(),l=i.turn,c=XX.ofPlayer(i.getCurrentPlayer()),u=l+1;a[o][s]=c;for(const e of r)a[e.y][e.x]=XX.EMPTY;const h=e.getNewKo(t,a,r),d=i.getCapturedCopy();return d[c.player.value]+=r.length,new eJ(a,d,u,h,JX.PLAYING)}static resurrectStones(t){for(let n=0;n<t.board.length;n++)for(let r=0;r<t.board[0].length;r++)t.getPieceAtXY(r,n).isDead()&&(t=e.switchAliveness(new HW(r,n),t));return e.removeAndSubstractTerritory(t)}static applyDeadMarkingMove(t,n){Ow(e.VERBOSE,{applyDeadMarkingMove:{legalMove:t,state:n}});const r=e.removeAndSubstractTerritory(n),i=e.switchAliveness(t.coord,r),s=new eJ(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,Aw.empty(),JX.COUNTING);return e.markTerritoryAndCount(s)}isLegal(t,n){return e.isLegal(t,n)}applyLegalMove(t,n,r){return Ow(e.VERBOSE,{applyLegalMove:{legalMove:t,state:n,status:r}}),e.isPass(t)?(Ow(e.VERBOSE,"GoRules.applyLegalMove: isPass"),e.applyPass(n)):e.isAccept(t)?(Ow(e.VERBOSE,"GoRules.applyLegalMove: isAccept"),e.applyLegalAccept(n)):e.isLegalDeadMarking(t,n)?(Ow(e.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),e.applyDeadMarkingMove(t,n)):(Ow(e.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),e.applyNormalLegalMove(t,n,r))}getGameStatus(t){return e.getGameStatus(t)}}return e.VERBOSE=!1,e})();class oJ{constructor(){this.capturedCoords=[]}static isCapturing(e){return e.capturedCoords.length>0}}class aJ extends JW{getListMoves(e){Ow(sJ.VERBOSE||!1,"GoRules.getListMoves");const t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===JX.PLAYING||t.phase===JX.PASSED)return n.push(QX.PASS),n;{Ow(sJ.VERBOSE||!1,"GoRules.getListMoves in counting phase");const e=this.getCountingMovesList(t);return 0===e.length?[QX.ACCEPT]:e}}getPlayingMovesList(e){const t=[];let n;for(let r=0;r<e.board.length;r++)for(let i=0;i<e.board[0].length;i++)n=new QX(i,r),e.getPieceAt(n.coord)===XX.EMPTY&&sJ.isLegal(n,e).isSuccess()&&t.push(n);return t}getCountingMovesList(e){const t=[],n=this.getCorrectBoard(e).getCopiedBoard(),r=sJ.getGroupsDatasWhere(n,e=>e!==XX.EMPTY);for(const i of r){const r=i.getCoords()[0],s=n[r.y][r.x];if(e.getPieceAt(r)!==s){const e=new QX(r.x,r.y);return t.push(e),t}}return t}getCorrectBoard(e){const t=this.mapBoard(e.getCopiedBoard(),e=>e===XX.DARK?XX.DEAD_DARK:e===XX.LIGHT?XX.DEAD_LIGHT:e.isTerritory()?XX.EMPTY:e),n=new eJ(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=sJ.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}mapBoard(e,t){for(let n=0;n<e.length;n++)for(let r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}setAliveUniqueWrapper(e,t){let n,r=e.copy();for(const i of t){n=i.deadDarkCoords.concat(i.deadLightCoords);for(const e of n)r.isDead(e)&&(r=sJ.switchAliveness(e,r))}return r}getBoardValue(e){const t=e.gameState,n=sJ.getGameStatus(e);if(n.isEndGame)return new ej(n.toBoardValue());Ow(sJ.VERBOSE||!1,"GoRules.getBoardValue");const r=sJ.markTerritoryAndCount(t),i=r.getCapturedCopy(),s=this.getDeadStones(r);return new ej(i[1]+2*s[0]-(i[0]+2*s[1]))}getDeadStones(e){const t=[0,0];for(let n=0;n<e.board.length;n++)for(let r=0;r<e.board[0].length;r++){const i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}const lJ=XX.LIGHT,cJ=XX.DARK,uJ=XX.DEAD_LIGHT,hJ=XX.LIGHT_TERRITORY,dJ=XX.DARK_TERRITORY,fJ=XX.EMPTY;class pJ{constructor(){this.tutorial=[Cj.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,eJ.getInitialState()),Cj.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new eJ([[fJ,cJ,fJ,fJ,lJ,lJ],[fJ,cJ,fJ,fJ,lJ,fJ],[fJ,cJ,cJ,lJ,lJ,fJ],[fJ,fJ,cJ,lJ,fJ,fJ],[fJ,fJ,cJ,lJ,fJ,fJ],[fJ,fJ,cJ,lJ,fJ,fJ]],[0,0],0,Aw.empty(),JX.PLAYING)),Cj.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        The light piece only has one liberty left, play there.`,new eJ([[fJ,fJ,fJ,fJ,fJ],[fJ,fJ,cJ,fJ,fJ],[fJ,cJ,lJ,fJ,fJ],[fJ,fJ,cJ,fJ,fJ],[fJ,fJ,fJ,fJ,fJ]],[0,0],0,Aw.empty(),JX.PLAYING),[new QX(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),Cj.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        The light group here only has one liberty left, capture it.`,new eJ([[fJ,cJ,fJ,fJ,fJ],[cJ,lJ,fJ,fJ,fJ],[cJ,lJ,lJ,cJ,fJ],[fJ,cJ,cJ,fJ,fJ],[fJ,fJ,fJ,fJ,fJ]],[0,0],0,Aw.empty(),JX.PLAYING),[new QX(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),Cj.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new eJ([[fJ,cJ,fJ,fJ,fJ],[cJ,fJ,fJ,fJ,fJ],[cJ,fJ,fJ,fJ,lJ],[lJ,cJ,fJ,lJ,fJ],[fJ,lJ,fJ,lJ,cJ]],[0,0],0,Aw.empty(),JX.PLAYING)),Cj.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new eJ([[fJ,fJ,fJ,fJ,fJ],[cJ,cJ,cJ,fJ,fJ],[lJ,lJ,cJ,fJ,fJ],[fJ,lJ,cJ,fJ,fJ],[lJ,lJ,cJ,fJ,fJ]],[0,0],0,Aw.empty(),JX.PLAYING)),Cj.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new eJ([[fJ,cJ,lJ,fJ,fJ],[lJ,cJ,lJ,fJ,fJ],[cJ,cJ,lJ,fJ,fJ],[lJ,cJ,lJ,fJ,fJ],[fJ,cJ,lJ,fJ,fJ]],[0,0],0,Aw.empty(),JX.PLAYING)),Cj.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new eJ([[fJ,lJ,cJ,fJ,lJ,cJ,fJ],[fJ,lJ,cJ,cJ,lJ,cJ,fJ],[fJ,lJ,cJ,cJ,lJ,cJ,fJ],[fJ,lJ,cJ,cJ,lJ,cJ,fJ],[fJ,lJ,cJ,lJ,lJ,cJ,fJ],[fJ,lJ,cJ,lJ,lJ,cJ,fJ],[fJ,lJ,cJ,fJ,lJ,cJ,fJ]],[0,0],0,Aw.empty(),JX.PLAYING)),Cj.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        Capture the light stone.`,new eJ([[fJ,fJ,fJ,fJ,fJ,fJ,fJ],[fJ,fJ,fJ,fJ,fJ,fJ,fJ],[fJ,fJ,fJ,cJ,lJ,fJ,fJ],[fJ,fJ,cJ,lJ,fJ,lJ,fJ],[fJ,fJ,fJ,cJ,lJ,fJ,fJ],[fJ,fJ,fJ,fJ,fJ,fJ,fJ],[fJ,fJ,fJ,fJ,fJ,fJ,fJ]],[0,0],0,Aw.empty(),JX.PLAYING),[new QX(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed!`),Cj.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        A last stone is dead, mark it.`,new eJ([[lJ,cJ,cJ,cJ,cJ,cJ,dJ,dJ,dJ],[lJ,lJ,lJ,lJ,cJ,cJ,cJ,dJ,dJ],[lJ,hJ,lJ,lJ,cJ,uJ,uJ,cJ,dJ],[cJ,lJ,lJ,lJ,lJ,cJ,dJ,dJ,dJ],[fJ,lJ,hJ,lJ,cJ,cJ,uJ,cJ,dJ],[lJ,hJ,lJ,lJ,cJ,cJ,cJ,cJ,cJ],[lJ,lJ,cJ,cJ,cJ,lJ,lJ,cJ,lJ],[cJ,cJ,cJ,lJ,lJ,lJ,hJ,lJ,lJ],[dJ,dJ,cJ,cJ,cJ,lJ,lJ,hJ,hJ]],[0,0],0,Aw.empty(),JX.COUNTING),[new QX(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)]}}function gJ(e,t){if(1&e&&(_n(),ga(0,"circle",10)),2&e){const e=Sa(2).index,t=Sa().index;ra("cx",25+50*e)("cy",25+50*t)("r",22)}}function mJ(e,t){if(1&e){const e=va();_n(),fa(0,"line",11),Ea("click",function(){Gt(e);const t=Sa(2).index,n=Sa().index;return Sa().onClick(t,n)}),pa()}if(2&e){const e=Sa(2).index,t=Sa().index;ra("x1",50*e)("y1",50*t)("x2",50+50*e)("y2",50+50*t)}}function yJ(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"circle",7),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onClick(t,n)}),pa(),la(2,gJ,1,3,"circle",8),la(3,mJ,1,4,"line",9),pa()}if(2&e){const e=Sa().index,t=Sa().index,n=Sa();ks(1),ha("ngClass",n.getSpaceClass(e,t)),ra("cx",25+50*e)("cy",25+50*t)("r",22),ks(1),ha("ngIf",n.isLastSpace(e,t)),ks(1),ha("ngIf",n.isDead(e,t))}}function vJ(e,t){if(1&e){const e=va();_n(),fa(0,"circle",15),Ea("click",function(){Gt(e);const t=Sa(2).index,n=Sa().index;return Sa().onClick(t,n)}),pa()}if(2&e){const e=Sa(2),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();ra("cx",25+50*t)("cy",25+50*r)("r",10)("class",n===i.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function CJ(e,t){if(1&e){const e=va();_n(),fa(0,"rect",12),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onClick(t,n)}),pa(),fa(1,"line",13),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onClick(t,n)}),pa(),fa(2,"line",13),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onClick(t,n)}),pa(),la(3,vJ,1,4,"circle",14)}if(2&e){const e=Sa().index,t=Sa().index,n=Sa();Ta("id","click_",e,"_",t,""),ra("x",50*e)("y",50*t),ks(1),ra("x1",50*e)("y1",25+50*t)("x2",50+50*e)("y2",25+50*t),ks(1),ra("x1",25+50*e)("y1",50*t)("x2",25+50*e)("y2",50+50*t),ks(1),ha("ngIf",n.isTerritory(e,t))}}function _J(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,yJ,4,6,"g",5),la(2,CJ,4,13,"ng-template",null,6,ju),pa()),2&e){const e=t.index,n=ca(3),r=Sa().index,i=Sa();ks(1),ha("ngIf",i.spaceIsFull(e,r))("ngIfElse",n)}}function EJ(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,_J,4,2,"g",2),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function wJ(e,t){if(1&e&&(_n(),ga(0,"rect",16)),2&e){const e=Sa();ra("x",12.5+50*e.ko.get().x)("y",12.5+50*e.ko.get().y)}}function PJ(e,t){if(1&e){const e=va();_n(),fa(0,"circle",17),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.x,t.y)}),pa()}if(2&e){const e=t.$implicit;ra("cx",25+50*e.x)("cy",25+50*e.y)("r",7)}}let SJ=(()=>{class e extends eY{constructor(e){super(e),this.ko=Aw.empty(),this.last=Aw.empty(),this.captures=[],this.GoPiece=XX,this.scores=Aw.of([0,0]),this.rules=new sJ(eJ),this.availableMinimaxes=[new aJ(this.rules,"GoMinimax")],this.encoder=QX.encoder,this.tutorial=(new pJ).tutorial,this.canPass=!0,this.updateBoard()}onClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());n.last=Aw.empty();const i=new QX(e,t);return n.chooseMove(i,n.getState(),n.scores.get())})()}updateBoard(){Ow(e.VERBOSE,"updateBoard");const t=this.getState(),n=this.rules.node.move,r=t.phase;this.board=t.getCopiedBoard(),this.scores=Aw.of(t.getCapturedCopy()),this.ko=t.koCoord,n.isPresent()?this.showCaptures():this.captures=[],this.last=n.map(e=>e.coord),this.canPass=r!==JX.FINISHED}showCaptures(){const e=this.rules.node.mother.get().gameState;this.captures=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const r=new HW(n,t),i=!1===e.getPieceAt(r).isEmpty(),s=this.board[t][n]===XX.EMPTY,o=!1===this.ko.equalsValue(r);i&&s&&o&&this.captures.push(r)}}pass(){var e=this;return Sw(function*(){const t=e.getState().phase;return t===JX.PLAYING||t===JX.PASSED?e.onClick(QX.PASS.coord.x,QX.PASS.coord.y):(cZ(t===JX.COUNTING||t===JX.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(QX.ACCEPT.coord.x,QX.ACCEPT.coord.y))})()}getSpaceClass(e,t){const n=this.getState().getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}spaceIsFull(e,t){return this.getState().getPieceAtXY(e,t)!==XX.EMPTY&&!this.isTerritory(e,t)}isLastSpace(e,t){if(this.last.isPresent()){const n=this.last.get();return e===n.x&&t===n.y}return!1}isDead(e,t){return this.getState().isDead(new HW(e,t))}isTerritory(e,t){return this.getState().isTerritory(new HW(e,t))}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-go"]],features:[Go],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),ga(1,"rect",1),la(2,EJ,2,1,"g",2),la(3,wJ,1,2,"rect",3),la(4,PJ,1,3,"circle",4),pa()),2&e&&(ra("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),ks(1),ra("width",50*t.board.length)("height",50*t.board.length),ks(1),ha("ngForOf",t.board),ks(1),ha("ngIf",t.ko.isPresent()),ks(1),ha("ngForOf",t.captures))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class bJ extends fY{static of(e,t){return new bJ(e,t)}static from(e,t){try{const n=new bJ(e,t);return Mw.success(n)}catch(n){return Mw.failure(n.message)}}getMaximalDistance(){return 11}}bJ.encoder=hY.getEncoder(11,11,bJ.of);const OJ={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:bZ.ZERO};class kJ extends vY{static getInitialState(){const e=mY.UNOCCUPIED,t=mY.INVADERS,n=mY.DEFENDERS;return new kJ([[e,e,e,t,t,t,t,t,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,n,e,e,e,e,t],[t,e,e,e,n,n,n,e,e,e,t],[t,t,e,n,n,mY.PLAYER_ONE_KING,n,n,e,t,t],[t,e,e,e,n,n,n,e,e,e,t],[t,e,e,e,e,n,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,t,t,t,t,t,e,e,e]],0)}from(e,t){return new kJ(e,t)}}class TJ extends _Y{constructor(){super(kJ,OJ,bJ.of)}static get(){return null==TJ.singleton&&(TJ.singleton=new TJ),fj.ruler=this.singleton,TJ.singleton}}const IJ=mY.UNOCCUPIED,AJ=mY.INVADERS,MJ=mY.DEFENDERS,NJ=mY.PLAYER_ONE_KING;class RJ{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,kJ.getInitialState()),Cj.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,kJ.getInitialState(),bJ.of(new HW(5,1),new HW(1,1)),$localize`Congratulations!`),Cj.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it.`,new kJ([[IJ,IJ,IJ,IJ,AJ,AJ,AJ,AJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,AJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[AJ,IJ,IJ,IJ,IJ,MJ,IJ,IJ,IJ,IJ,AJ],[AJ,IJ,IJ,AJ,MJ,MJ,MJ,IJ,IJ,IJ,AJ],[AJ,AJ,IJ,MJ,MJ,NJ,MJ,MJ,IJ,AJ,AJ],[AJ,IJ,IJ,IJ,MJ,MJ,MJ,IJ,IJ,IJ,AJ],[AJ,IJ,IJ,IJ,IJ,MJ,IJ,IJ,IJ,IJ,AJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,AJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,AJ,AJ,AJ,AJ,AJ,IJ,IJ,IJ]],1),[bJ.of(new HW(5,3),new HW(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(bJ.of(new HW(3,0),new HW(3,4))).withPreviousState(kJ.getInitialState()),Cj.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it.`,new kJ([[IJ,IJ,IJ,AJ,AJ,AJ,AJ,AJ,IJ,IJ,IJ],[IJ,MJ,IJ,IJ,IJ,AJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,MJ,IJ,IJ,IJ,IJ,AJ],[AJ,IJ,IJ,IJ,IJ,MJ,MJ,IJ,IJ,IJ,AJ],[AJ,AJ,NJ,IJ,MJ,IJ,MJ,MJ,IJ,IJ,AJ],[IJ,IJ,AJ,IJ,IJ,MJ,MJ,IJ,IJ,IJ,AJ],[AJ,IJ,IJ,IJ,IJ,MJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,AJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,AJ,AJ,AJ,AJ,IJ,AJ,IJ,IJ]],12),[bJ.of(new HW(3,0),new HW(3,5)),bJ.of(new HW(3,10),new HW(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),Cj.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king.`,new kJ([[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,AJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[AJ,NJ,IJ,AJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,AJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ]],72),[bJ.of(new HW(3,4),new HW(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),Cj.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king.`,new kJ([[IJ,IJ,AJ,NJ,AJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,MJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,AJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ],[IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ,IJ]],72),[bJ.of(new HW(3,3),new HW(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`)]}}function xJ(e,t){1&e&&(_n(),ga(0,"polygon",8))}function DJ(e,t){1&e&&(_n(),ga(0,"rect",9))}function LJ(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,xJ,1,0,"polygon",6),la(2,DJ,1,0,"ng-template",null,7,ju),pa()),2&e){const e=ca(3),t=Sa().index,n=Sa().index,r=Sa();ks(1),ha("ngIf",r.isCentralThrone(t,n))("ngIfElse",e)}}function FJ(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"line",13),ga(2,"line",13),ga(3,"line",13),ga(4,"line",13),ga(5,"line",13),pa()),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.04*n.SPACE_SIZE)("x2",.5*n.SPACE_SIZE)("y2",.96*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.1*n.SPACE_SIZE)("y2",.6*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.9*n.SPACE_SIZE)("y2",.6*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.4*n.SPACE_SIZE)("x2",.15*n.SPACE_SIZE)("y2",.75*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.4*n.SPACE_SIZE)("x2",.85*n.SPACE_SIZE)("y2",.75*n.SPACE_SIZE)}}function UJ(e,t){if(1&e&&(_n(),ga(0,"polyline",16)),2&e){const e=Sa(3).index,t=Sa().index;ha("ngClass",Sa().viewInfo.pieceClasses[t][e])}}function VJ(e,t){if(1&e&&(_n(),ga(0,"line",13),ga(1,"line",13),ga(2,"line",13),ga(3,"line",13)),2&e){const e=Sa(3).index,t=Sa().index,n=Sa();ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.04*n.SPACE_SIZE)("x2",.5*n.SPACE_SIZE)("y2",.96*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.04*n.SPACE_SIZE)("y1",.5*n.SPACE_SIZE)("x2",.96*n.SPACE_SIZE)("y2",.5*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.2*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.8*n.SPACE_SIZE)("y2",.8*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.8*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.2*n.SPACE_SIZE)("y2",.8*n.SPACE_SIZE)}}function BJ(e,t){if(1&e&&(_n(),la(0,UJ,1,1,"polyline",14),la(1,VJ,4,20,"ng-template",null,15,ju)),2&e){const e=ca(2),t=Sa(2).index,n=Sa().index;ha("ngIf",Sa().isKing(t,n))("ngIfElse",e)}}function $J(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",10),la(2,FJ,6,25,"g",11),la(3,BJ,3,2,"ng-template",null,12,ju),pa()),2&e){const e=ca(4),t=Sa().index,n=Sa().index,r=Sa();ks(1),Ta("id","piece_",t,"_",n,""),ha("ngClass",r.viewInfo.pieceClasses[n][t]),ra("r",r.SPACE_SIZE/2-r.STROKE_WIDTH)("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE),ks(1),ha("ngIf",r.isInvader(t,n))("ngIfElse",e)}}function zJ(e,t){if(1&e){const e=va();_n(),fa(0,"g",3),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),ga(1,"rect",4),la(2,LJ,4,2,"g",5),la(3,$J,5,8,"g",5),pa()}if(2&e){const e=t.index,n=Sa().index,r=Sa();Ta("id","click_",e,"_",n,""),ra("transform","translate("+r.SPACE_SIZE*e+", "+r.SPACE_SIZE*n+")"),ks(1),ha("ngClass",r.getRectClasses(e,n)),ra("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),ks(1),ha("ngIf",r.board[n][e]===r.EMPTY&&r.isThrone(e,n)),ks(1),ha("ngIf",r.board[n][e]!==r.EMPTY)}}function HJ(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,zJ,4,8,"g",2),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function GJ(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",17),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();ks(1),Ta("id","click_",e.x,"_",e.y,""),ra("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let ZJ=(()=>{class e extends wY{constructor(e){super(e,!1,bJ.from),this.rules=TJ.get(),this.availableMinimaxes=[new PY(this.rules,"DummyBot"),new TY(this.rules,"Piece > Influence"),new IY(this.rules,"Piece > Control"),new AY(this.rules,"Escape > Piece > Control")],this.encoder=bJ.encoder,this.tutorial=(new RJ).tutorial}ngOnInit(){this.updateBoard()}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-hnefatafl"]],features:[Go],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,HJ,2,1,"g",1),la(2,GJ,2,6,"g",1),pa()),2&e&&(ra("viewBox",t.getViewBox()),ks(1),ha("ngForOf",t.board),ks(1),ha("ngForOf",t.getClickables()))},directives:[Jd,Qd,tf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class qJ{constructor(e,t,n){this.value=e,this.name=t,this.rgb=n}static of(e){switch(e){case 0:return qJ.ANY;case 1:return qJ.ORANGE;case 2:return qJ.BLUE;case 3:return qJ.PURPLE;case 4:return qJ.PINK;case 5:return qJ.YELLOW;case 6:return qJ.RED;case 7:return qJ.GREEN;default:return bw.expectToBe(e,8,"Invalid value "+e+" for KamisadoColor"),qJ.BROWN}}}qJ.ANY=new qJ(0,"any","#000"),qJ.ORANGE=new qJ(1,"orange","#d67421"),qJ.BLUE=new qJ(2,"blue","#006bac"),qJ.PURPLE=new qJ(3,"purple","#6f3787"),qJ.PINK=new qJ(4,"pink","#d2719e"),qJ.YELLOW=new qJ(5,"yellow","#e2c200"),qJ.RED=new qJ(6,"red","#d23339"),qJ.GREEN=new qJ(7,"green","#009157"),qJ.BROWN=new qJ(8,"brown","#562500");class WJ{constructor(e,t){this.player=e,this.color=t}static of(e,t){return new WJ(e,qJ.of(t))}static createPlayerColors(e){return{ORANGE:new WJ(e,qJ.ORANGE),BLUE:new WJ(e,qJ.BLUE),PURPLE:new WJ(e,qJ.PURPLE),PINK:new WJ(e,qJ.PINK),YELLOW:new WJ(e,qJ.YELLOW),RED:new WJ(e,qJ.RED),GREEN:new WJ(e,qJ.GREEN),BROWN:new WJ(e,qJ.BROWN)}}equals(e){return e.player===this.player&&e.color===this.color}isEmpty(){return this.player.equals(OZ.NONE)}belongsTo(e){return this.player===e}}WJ.EMPTY=new WJ(OZ.NONE,qJ.ANY),WJ.ZERO=WJ.createPlayerColors(bZ.ZERO),WJ.ONE=WJ.createPlayerColors(bZ.ONE);class jJ{static getColorAt(e,t){return jJ.COLORS[t][e]}static getInitialBoard(){const e=WJ.EMPTY;return[[1,2,3,4,5,6,7,8].map(e=>WJ.of(bZ.ONE,e)),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(e=>WJ.of(bZ.ZERO,e))]}static isEmptyAt(e,t){return e[t.y][t.x].equals(WJ.EMPTY)}static allPieceCoords(e){const t=[];for(let n=0;n<e.length;n++)for(let r=0;r<e[n].length;r++){const i=new HW(r,n);jJ.isEmptyAt(e,i)||t.push(i)}return t}}jJ.INITIAL=jJ.getInitialBoard(),jJ.SIZE=8,jJ.COLORS=AZ.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],qJ.of);class YJ extends oj{constructor(){super()}isPieceMove(){return!1}length(){return 0}equals(e){return this===e}toString(){return"KamisadoMove(PASS)"}}YJ.PASS=new YJ;class KJ extends hY{constructor(e,t){super(e,t)}static of(e,t){if(e.isNotInRange(jJ.SIZE,jJ.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(jJ.SIZE,jJ.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new KJ(e,t)}isPieceMove(){return!0}equals(e){return e===this||!!e.isPieceMove()&&!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return"KamisadoMove("+this.coord+"->"+this.end+")"}}var QJ;!function(e){e.PASS=YJ.PASS,e.of=function(e,t){return KJ.of(e,t)},e.encoder=new class extends PZ{maxValue(){return 34952}encodeNumber(e){return e.isPieceMove()?4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y:0}decodeNumber(t){if(0===t)return e.PASS;const n=t%16,r=(t=t/16|0)%16,i=(t=t/16|0)%16;return e.of(new HW((t=t/16|0)%16,i),new HW(r,n))}}}(QJ||(QJ={}));class XJ extends ij{constructor(e,t,n,r,i){super(AZ.copyBiArray(i),e),this.colorToPlay=t,this.coordToPlay=n,this.alreadyPassed=r}static getInitialState(){return new XJ(0,qJ.ANY,Aw.empty(),!1,jJ.INITIAL)}}let JJ=(()=>{class e{}return e.NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`,e.DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`,e.MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`,e.PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`,e})();class e1 extends gj{static getColorMatchingPiece(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new HW(0,7),new HW(1,7),new HW(2,7),new HW(3,7),new HW(4,7),new HW(5,7),new HW(6,7),new HW(7,7)]}static getMovablePieces(e){return e1.getColorMatchingPiece(e).filter(t=>{for(const n of this.playerDirections(e.getCurrentPlayer())){const r=t.getNext(n);if(e.isOnBoard(r)&&jJ.isEmptyAt(e.board,r))return!0}return!1})}static playerDirections(e){return e===bZ.ONE?[VW.DOWN,VW.DOWN_LEFT,VW.DOWN_RIGHT]:[VW.UP,VW.UP_LEFT,VW.UP_RIGHT]}static directionAllowedForPlayer(e,t){return t===bZ.ZERO?e.y<0:e.y>0}static getListMovesFromState(e){const t=e1.getMovablePieces(e);return 0===t.length?(cZ(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[QJ.PASS]):e1.getListMovesFromNonBlockedState(e,t)}static getListMovesFromNonBlockedState(e,t){const n=[],r=e.getCurrentPlayer();for(const i of t)for(const t of e1.playerDirections(r))for(let r=1;r<jJ.SIZE;r++){const s=i.getNext(t,r);if(!e.isOnBoard(s)||!jJ.isEmptyAt(e.board,s))break;{const e=QJ.of(i,s);n.push(e)}}return n}static mustPass(e){return 0===this.getMovablePieces(e).length}static getFurthestPiecePositions(e){let t=7,n=0;return jJ.allPieceCoords(e.board).forEach(r=>{const i=e.getPieceAt(r);cZ(i!==WJ.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===bZ.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}static isLegal(e,t){if(e.isPieceMove()){const n=e.coord,r=e.end,i=t.colorToPlay,s=t.getPieceAt(n);if(!s.belongsTo(t.getCurrentPlayer()))return Mw.failure(XW.MUST_CHOOSE_PLAYER_PIECE());if(i!==qJ.ANY&&s.color!==i)return Mw.failure(JJ.NOT_RIGHT_COLOR());if(!t.getPieceAt(r).isEmpty())return Mw.failure(XW.MUST_CLICK_ON_EMPTY_SPACE());const o=VW.factory.fromMove(n,r);if(o.isFailure())return Mw.failure(JJ.DIRECTION_NOT_ALLOWED());const a=o.get();if(!e1.directionAllowedForPlayer(a,t.getCurrentPlayer()))return Mw.failure(JJ.DIRECTION_NOT_ALLOWED());let l=n;for(;!l.equals(r);)if(l=l.getNext(a),!t.getPieceAt(l).isEmpty())return Mw.failure(JJ.MOVE_BLOCKED());return Mw.success(void 0)}return this.isLegalPass(t)}static isLegalPass(e){return this.mustPass(e)&&!e.alreadyPassed?Mw.success(void 0):Mw.failure(XW.CANNOT_PASS())}nextCoordToPlay(e,t){return Aw.ofNullable(jJ.allPieceCoords(e.board).find(n=>{const r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}applyLegalMove(e,t,n){if(e.isPieceMove()){const n=e.coord,r=e.end,i=t.getCopiedBoard();i[r.y][r.x]=i[n.y][n.x],i[n.y][n.x]=WJ.EMPTY;const s=jJ.getColorAt(r.x,r.y),o=this.nextCoordToPlay(t,s);return new XJ(t.turn+1,s,o,!1,i)}{const e=this.nextCoordToPlay(t,t.colorToPlay);return new XJ(t.turn+1,t.colorToPlay,e,!0,t.board)}}isLegal(e,t){return e1.isLegal(e,t)}getGameStatus(e){const t=e.gameState,n=t.getCurrentPlayer();if(e1.mustPass(t)&&t.alreadyPassed)return pj.getDefeat(n);const[r,i]=e1.getFurthestPiecePositions(t);return 7===i?pj.ONE_WON:0===r?pj.ZERO_WON:pj.ONGOING}}class t1 extends JW{getListMoves(e){const t=e1.getListMovesFromState(e.gameState);return AZ.sortByDescending(t,e=>e.length()),t}getBoardValue(e){const t=e.gameState,n=t.getCurrentPlayer();if(e1.mustPass(t)&&t.alreadyPassed)return new ej(n.getDefeatValue());const[r,i]=e1.getFurthestPiecePositions(t);return new ej(7===i?bZ.ONE.getVictoryValue():0===r?bZ.ZERO.getVictoryValue():i-(7-r))}}const n1=WJ.EMPTY,r1=WJ.ZERO.ORANGE,i1=WJ.ONE.ORANGE,s1=WJ.ZERO.BLUE,o1=WJ.ONE.BLUE,a1=WJ.ZERO.PURPLE,l1=WJ.ONE.PURPLE,c1=WJ.ZERO.PINK,u1=WJ.ONE.PINK,h1=WJ.ZERO.YELLOW,d1=WJ.ONE.YELLOW,f1=WJ.ZERO.RED,p1=WJ.ONE.RED,g1=WJ.ZERO.GREEN,m1=WJ.ONE.GREEN,y1=WJ.ZERO.BROWN,v1=WJ.ONE.BROWN;class C1{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new XJ(5,qJ.ORANGE,Aw.empty(),!1,[[y1,o1,l1,u1,d1,p1,m1,v1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,i1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,g1,f1,h1,c1,a1,s1,r1]])).withPreviousMove(QJ.of(new HW(0,7),new HW(0,0))),Cj.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        Click on the piece of your choice and click on the landing square.`,XJ.getInitialState(),QJ.of(new HW(7,7),new HW(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),Cj.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        Move it on a blue square.`,new XJ(1,qJ.PINK,Aw.of(new HW(3,0)),!1,[[i1,o1,l1,u1,d1,p1,m1,v1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,s1,n1],[n1,n1,n1,n1,n1,n1,n1,n1],[y1,g1,f1,h1,c1,a1,n1,r1]]),[QJ.of(new HW(3,0),new HW(3,6)),QJ.of(new HW(3,0),new HW(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(QJ.of(new HW(6,7),new HW(6,5))),Cj.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new XJ(1,qJ.PINK,Aw.of(new HW(3,6)),!1,[[i1,o1,l1,n1,d1,p1,m1,v1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,n1,s1],[n1,n1,n1,n1,n1,n1,n1,n1],[n1,n1,n1,u1,n1,n1,n1,n1],[y1,g1,f1,h1,c1,a1,n1,r1]])).withPreviousMove(QJ.of(new HW(6,5),new HW(7,4))),Cj.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        Try to make this move.`,new XJ(2,qJ.RED,Aw.of(new HW(2,4)),!1,[[n1,o1,l1,n1,n1,p1,n1,n1],[n1,n1,n1,d1,n1,n1,n1,n1],[n1,n1,n1,u1,n1,l1,n1,n1],[n1,n1,n1,h1,n1,n1,n1,n1],[n1,n1,f1,n1,n1,n1,n1,n1],[n1,n1,n1,n1,n1,n1,m1,n1],[i1,n1,n1,n1,n1,c1,n1,v1],[y1,g1,n1,n1,n1,n1,s1,r1]]),[QJ.of(new HW(2,4),new HW(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed!`).withPreviousMove(QJ.of(new HW(4,0),new HW(3,1)))]}}function _1(e,t){if(1&e&&(_n(),ga(0,"circle",8)),2&e){const e=Sa(),t=e.$implicit,n=e.index,r=Sa().index,i=Sa();ha("ngClass",i.piecePlayerClass(t)),ra("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function E1(e,t){if(1&e&&(_n(),ga(0,"rect",9)),2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();ra("x",i.SPACE_SIZE/2+t*i.SPACE_SIZE-i.SPACE_SIZE/8)("y",i.SPACE_SIZE/2+r*i.SPACE_SIZE-i.SPACE_SIZE/8)("rx",i.isPlayerZero(n)?i.SPACE_SIZE:0)("ry",i.isPlayerZero(n)?i.SPACE_SIZE:0)("width",i.SPACE_SIZE/4)("height",i.SPACE_SIZE/4)("fill",i.pieceColor(n))}}function w1(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"g",4),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),ga(2,"rect",5),la(3,_1,1,4,"circle",6),la(4,E1,1,7,"rect",7),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();ks(1),Ta("id","click_",n,"_",r,""),ks(1),ra("x",n*i.SPACE_SIZE)("y",r*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("fill",i.backgroundColor(n,r)),ks(1),ha("ngIf",e!==i.UNOCCUPIED),ks(1),ha("ngIf",e!==i.UNOCCUPIED)}}function P1(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,w1,5,9,"g",1),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function S1(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"rect",10),ga(2,"rect",10),pa()),2&e){const e=Sa();ks(1),ra("x",e.lastPieceMove.get().coord.x*e.SPACE_SIZE)("y",e.lastPieceMove.get().coord.y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),ks(1),ra("x",e.lastPieceMove.get().end.x*e.SPACE_SIZE)("y",e.lastPieceMove.get().end.y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function b1(e,t){if(1&e&&(_n(),ga(0,"circle",11)),2&e){const e=Sa();ra("cx",e.SPACE_SIZE/2+e.chosen.get().x*e.SPACE_SIZE)("cy",e.SPACE_SIZE/2+e.chosen.get().y*e.SPACE_SIZE)("r",e.SPACE_SIZE/2-e.STROKE_WIDTH)}}let O1=(()=>{class e extends eY{constructor(e){super(e),this.UNOCCUPIED=WJ.EMPTY,this.lastMove=Aw.empty(),this.lastPieceMove=Aw.empty(),this.chosen=Aw.empty(),this.chosenAutomatically=!1,this.hasAsymetricBoard=!0,this.rules=new e1(XJ),this.availableMinimaxes=[new t1(this.rules,"KamisadoMinimax")],this.encoder=QJ.encoder,this.tutorial=(new C1).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(e,t){return jJ.getColorAt(e,t).rgb}isPlayerZero(e){return e.player===bZ.ZERO}pieceColor(e){return e.color.rgb}piecePlayerClass(e){return this.getPlayerClass(e.player)}updateBoard(){const e=this.getState();if(this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.lastPieceMove=Aw.empty(),this.lastMove.isPresent()){const e=this.lastMove.get();e.isPieceMove()&&(this.lastPieceMove=Aw.of(e))}this.canPass=e1.mustPass(e);const t=this.rules.getGameStatus(this.rules.node)!==pj.ONGOING;this.canPass||e.coordToPlay.isAbsent()||t?(this.chosenAutomatically=!1,this.chosen=Aw.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}pass(){var e=this;return Sw(function*(){return cZ(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(QJ.PASS,e.getState())})()}onClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new HW(e,t);if(n.canPass)return n.cancelMove(XW.MUST_PASS());if(n.chosen.isAbsent())return n.choosePiece(e,t);if(!1===n.chosenAutomatically&&n.chosen.equalsValue(i))return n.cancelMoveAttempt(),xw.SUCCESS;{const r=n.getState().getPieceAtXY(e,t),s=n.getState().getCurrentPlayer();return r.belongsTo(s)?n.chosenAutomatically?n.cancelMove(JJ.PLAY_WITH_SELECTED_PIECE()):(n.chosen=Aw.of(i),xw.SUCCESS):yield n.chooseDestination(e,t)}})()}choosePiece(e,t){const n=this.getState().getPieceAtXY(e,t),r=this.getState().getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(XW.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=Aw.of(new HW(e,t)),xw.SUCCESS)}chooseDestination(e,t){var n=this;return Sw(function*(){const r=n.chosen.get(),i=new HW(e,t),s=QJ.of(r,i);return n.chooseMove(s,n.getState())})()}cancelMoveAttempt(){this.chosenAutomatically||(this.chosen=Aw.empty())}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-kamisado"]],features:[Go],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,P1,2,1,"g",1),la(2,S1,3,8,"g",2),la(3,b1,1,3,"circle",3),pa()),2&e&&(ra("viewBox",t.getViewBox())("transform",t.rotation),ks(1),ha("ngForOf",t.board),ks(1),ha("ngIf",t.lastPieceMove.isPresent()),ks(1),ha("ngIf",t.chosen.isPresent()))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),k1=(()=>{class e extends ij{static getInitialState(){const t=OZ.NONE,n=OZ.ZERO,r=OZ.ONE;return new e([[t,n,n,n,n,n,n,t],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[t,n,n,n,n,n,n,t]],0)}static isOnBoard(t){return t.isInRange(e.SIZE,e.SIZE)}}return e.SIZE=8,e})();class T1 extends hY{constructor(e,t,n){super(e,t),this.direction=n,this.direction=VW.factory.fromMove(e,t).get()}static of(e,t){const n=VW.factory.fromMove(e,t);return n.isFailure()?Mw.failure(n.getReason()):e.isNotInRange(k1.SIZE,k1.SIZE)?Mw.failure("start coord is not in range"):t.isNotInRange(k1.SIZE,k1.SIZE)?Mw.failure("end coord is not in range"):Mw.success(new T1(e,t,n.get()))}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}encode(){return T1.encoder.encode(this)}decode(e){return T1.encoder.decode(e)}}T1.encoder=hY.getEncoder(k1.SIZE,k1.SIZE,(e,t)=>T1.of(e,t).get());let I1=(()=>{class e{}return e.INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`,e.CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`,e.PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`,e})();class A1 extends gj{static getListMovesFromState(e){const t=[];if(A1.getVictory(e).isPresent())return t;for(let n=0;n<k1.SIZE;n++)for(let r=0;r<k1.SIZE;r++){const i=new HW(r,n);if(e.getPieceAt(i).isPlayer())for(const n of A1.possibleTargets(e,i)){const e=T1.of(i,n).get();t.push(e)}}return t}static getNumberOfGroups(e){const t=AZ.createTable(k1.SIZE,k1.SIZE,-1),n=[0,0];let r=0;for(let i=0;i<k1.SIZE;i++)for(let s=0;s<k1.SIZE;s++)if(-1===t[i][s]){const o=e.getPieceAt(new HW(s,i));o.isPlayer()&&(r+=1,A1.markGroupStartingAt(e,t,new HW(s,i),r),n[o.value]+=1)}return n}static markGroupStartingAt(e,t,n,r){const i=[n],s=e.getPieceAt(n);for(;i.length>0;){const n=bw.getNonNullable(i.pop());if(-1===t[n.y][n.x]){const o=e.getPieceAt(n);if(o===s){t[n.y][n.x]=r;for(const t of VW.DIRECTIONS){const r=n.getNext(t);e.isOnBoard(r)&&i.push(r)}}else o===OZ.NONE&&(t[n.y][n.x]=0)}}}applyLegalMove(e,t,n){const r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=OZ.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new k1(r,t.turn+1)}static isLegal(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?Mw.failure(XW.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?Mw.failure(I1.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(e=>t.getPieceAt(e)===t.getCurrentOpponent())?Mw.failure(I1.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?Mw.failure(XW.CANNOT_SELF_CAPTURE()):Mw.success(void 0)}isLegal(e,t){return A1.isLegal(e,t)}static numberOfPiecesOnLine(e,t,n){let r=0;for(const i of A1.getLineCoords(t,n))e.getPieceAt(i).isPlayer()&&(r+=1);return r}static getLineCoords(e,t){const n=A1.getEntranceAndForwardDirection(e,t);let r=n[0];const i=n[1],s=[];for(;k1.isOnBoard(r);)s.push(r),r=r.getNext(i);return s}static getEntranceAndForwardDirection(e,t){switch(t){case VW.UP:case VW.DOWN:return[new HW(e.x,0),VW.DOWN];case VW.LEFT:case VW.RIGHT:return[new HW(0,e.y),VW.RIGHT];case VW.UP_RIGHT:case VW.DOWN_LEFT:return[new HW(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),VW.UP_RIGHT];default:return bw.expectToBeMultiple(t,[VW.UP_LEFT,VW.DOWN_RIGHT]),[new HW(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),VW.DOWN_RIGHT]}}static getVictory(e){const[t,n]=A1.getNumberOfGroups(e);return 1===t&&1===n?Aw.of(OZ.NONE):1===t?Aw.of(bZ.ZERO):1===n?Aw.of(bZ.ONE):Aw.empty()}static possibleTargets(e,t){const n=[];for(const r of VW.DIRECTIONS){const i=A1.numberOfPiecesOnLine(e,t,r),s=t.getNext(r,i);if(e.isOnBoard(s)){const r=T1.of(t,s).get();A1.isLegal(r,e).isSuccess()&&n.push(s)}}return n}getGameStatus(e){const t=e.gameState,[n,r]=A1.getNumberOfGroups(t);return 1===n&&r>1?pj.ZERO_WON:n>1&&1===r?pj.ONE_WON:pj.ONGOING}}class M1 extends JW{getListMoves(e){return A1.getListMovesFromState(e.gameState)}getBoardValue(e){const t=e.gameState,[n,r]=A1.getNumberOfGroups(t);return new ej(1===n&&r>1?bZ.ZERO.getVictoryValue():n>1&&1===r?bZ.ONE.getVictoryValue():100/n*bZ.ZERO.getScoreModifier()+100/r*bZ.ONE.getScoreModifier())}}const N1=OZ.NONE,R1=OZ.ZERO,x1=OZ.ONE;class D1{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new k1([[N1,N1,N1,N1,N1,N1,N1,N1],[x1,N1,N1,N1,R1,N1,N1,x1],[N1,N1,R1,R1,x1,N1,N1,N1],[N1,N1,N1,R1,N1,N1,N1,N1],[N1,N1,N1,N1,N1,N1,N1,N1],[N1,N1,N1,N1,N1,N1,N1,N1],[N1,N1,N1,N1,N1,N1,N1,N1],[N1,N1,N1,N1,N1,N1,N1,N1]],0)),Cj.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,k1.getInitialState(),T1.of(new HW(1,7),new HW(1,5)).get(),$localize`Congratulations!`),Cj.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new k1([[N1,N1,N1,N1,N1,N1,N1,N1],[N1,N1,x1,R1,R1,N1,N1,N1],[N1,N1,N1,N1,N1,N1,N1,N1],[N1,N1,N1,N1,N1,N1,N1,N1],[N1,N1,N1,N1,N1,N1,N1,N1],[N1,N1,N1,N1,N1,N1,N1,N1],[N1,N1,N1,N1,N1,N1,N1,x1],[N1,N1,N1,N1,N1,N1,N1,R1]],0),[T1.of(new HW(3,1),new HW(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),Cj.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        Horizontally, this piece can move only of one square because it is the only piece on this line.
        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
        But it can only go up, as below it the landing square is occupied by one of your pieces.
        Diagonally, only one move is possible: on the diagonal that contains three pieces,
        only in the direction where it does not jump over one of the opponent's pieces.
        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>
        Make one of these moves.`,new k1([[N1,N1,N1,N1,N1,N1,x1,N1],[N1,N1,N1,N1,N1,R1,N1,N1],[N1,N1,N1,N1,x1,N1,N1,N1],[N1,N1,N1,R1,N1,N1,N1,N1],[N1,N1,N1,N1,N1,N1,N1,x1],[N1,N1,N1,N1,N1,x1,N1,x1],[N1,N1,N1,R1,N1,N1,x1,x1],[N1,N1,N1,R1,N1,N1,N1,N1]],0),[T1.of(new HW(3,3),new HW(3,0)).get(),T1.of(new HW(3,3),new HW(0,0)).get(),T1.of(new HW(3,3),new HW(2,3)).get(),T1.of(new HW(3,3),new HW(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),Cj.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new k1([[N1,R1,N1,R1,R1,R1,R1,N1],[x1,N1,N1,N1,N1,N1,N1,x1],[N1,N1,R1,N1,x1,N1,N1,N1],[x1,N1,N1,N1,N1,N1,N1,x1],[x1,N1,N1,N1,N1,N1,N1,x1],[x1,N1,N1,N1,N1,N1,N1,x1],[x1,N1,N1,N1,N1,N1,N1,x1],[N1,R1,R1,R1,R1,R1,R1,N1]],0),T1.of(new HW(2,2),new HW(4,2)).get(),(e,t,n)=>t.getPieceAt(e.end)===OZ.ONE?xw.SUCCESS:xw.failure($localize`Failed!`),$localize`Congratulations!`),Cj.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new k1([[N1,N1,N1,N1,N1,N1,N1,N1],[N1,N1,N1,N1,N1,N1,N1,N1],[R1,N1,N1,R1,x1,R1,N1,N1],[N1,N1,N1,R1,N1,N1,N1,x1],[N1,N1,N1,N1,N1,N1,N1,x1],[N1,N1,N1,N1,N1,N1,N1,x1],[N1,N1,N1,N1,N1,N1,N1,x1],[N1,N1,N1,N1,N1,N1,N1,N1]],0),[T1.of(new HW(0,2),new HW(4,2)).get()],$localize`Congratulations!`,$localize`Failed!`)]}}function L1(e,t){if(1&e&&(_n(),ga(0,"circle",6)),2&e){const e=Sa().index,t=Sa().index,n=Sa();Ta("id","piece_",e,"_",t,""),ha("ngClass",n.getPieceClasses(e,t)),ra("cx",n.SPACE_SIZE/2+e*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+t*n.SPACE_SIZE)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}function F1(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"g",3),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),ga(2,"rect",4),la(3,L1,1,6,"circle",5),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();ks(1),Ta("id","click_",n,"_",r,""),ks(1),ha("ngClass",i.getSquareClasses(n,r)),ra("x",n*i.SPACE_SIZE)("y",r*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),ks(1),ha("ngIf",e!==i.EMPTY)}}function U1(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,F1,4,8,"g",1),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function V1(e,t){if(1&e){const e=va();_n(),fa(0,"rect",7),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.x,t.y)}),pa()}if(2&e){const e=t.$implicit,n=Sa();ra("x",e.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",e.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}let B1=(()=>{class e extends eY{constructor(e){super(e),this.INDICATOR_SIZE=20,this.EMPTY=OZ.NONE,this.targets=[],this.selected=Aw.empty(),this.lastMove=Aw.empty(),this.captured=Aw.empty(),this.rules=new A1(k1),this.availableMinimaxes=[new M1(this.rules,"LinesOfActionMinimax")],this.encoder=T1.encoder,this.tutorial=(new D1).tutorial,this.updateBoard()}onClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new HW(e,t);if(n.selected.equalsValue(i))return n.cancelMoveAttempt(),xw.SUCCESS;const s=n.getState().getCurrentPlayer();return n.selected.isAbsent()||n.getState().getPieceAt(i)===s?n.select(i):n.concludeMove(i)})()}concludeMove(e){var t=this;return Sw(function*(){const n=T1.of(t.selected.get(),e);return n.isSuccess()?t.chooseMove(n.get(),t.rules.node.gameState):t.cancelMove(n.getReason())})()}select(e){var t=this;return Sw(function*(){return t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(XW.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=Aw.of(e),t.targets=A1.possibleTargets(t.getState(),t.selected.get()),0===t.targets.length?t.cancelMove(I1.PIECE_CANNOT_MOVE()):xw.SUCCESS)})()}updateBoard(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?Aw.of(e.end):Aw.empty()}}cancelMoveAttempt(){this.selected=Aw.empty(),this.targets=[]}getSquareClasses(e,t){const n=new HW(e,t);if(this.lastMove.isPresent()){const e=this.lastMove.get().coord,t=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured-fill"];if(n.equals(e)||n.equals(t))return["moved-fill"]}return[]}getPieceClasses(e,t){const n=this.board[t][e],r=new HW(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected-stroke"),i}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-linesofaction"]],features:[Go],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,U1,2,1,"g",1),la(2,V1,1,4,"rect",2),pa()),2&e&&(ks(1),ha("ngForOf",t.board),ks(1),ha("ngForOf",t.targets))},directives:[Jd,Qd,tf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class $1 extends aj{constructor(e,t,n,r={top:0,bottom:0,left:0,right:0}){super(e.x,e.y),this.direction=t,this.orientation=n,this.captures=r}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}$1.encoder=new class extends wZ{encodeMove(e){return{coord:HW.encoder.encode(e.coord),direction:e.direction,orientation:e.orientation,captures:e.captures}}decodeMove(e){const t=e;return cZ(null!=t.coord,"Invalid encoded LodestoneMove"),cZ(null!=t.direction,"Invalid encoded LodestoneMove"),cZ(null!=t.orientation,"Invalid encoded LodestoneMove"),cZ(null!=t.captures,"Invalid encoded LodestoneMove"),new $1(HW.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}};let z1=(()=>{class e{}return e.MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`,e.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`,e.TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`,e.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`,e.MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`,e.NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`,e})();class H1{constructor(e){this.unreachable=e}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(e){return this===e}}H1.UNREACHABLE=new H1(!0),H1.EMPTY=new H1(!1);class G1{constructor(e){this.owner=e}static of(e){return e===bZ.ZERO?G1.ZERO:G1.ONE}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}G1.ZERO=new G1(bZ.ZERO),G1.ONE=new G1(bZ.ONE);class Z1{constructor(e,t,n){this.owner=e,this.direction=t,this.orientation=n}static of(e,t){return Z1.LODESTONES[e.value][t.direction][t.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}Z1.LODESTONES={0:{push:{diagonal:new Z1(bZ.ZERO,"push","diagonal"),orthogonal:new Z1(bZ.ZERO,"push","orthogonal")},pull:{diagonal:new Z1(bZ.ZERO,"pull","diagonal"),orthogonal:new Z1(bZ.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new Z1(bZ.ONE,"push","diagonal"),orthogonal:new Z1(bZ.ONE,"push","orthogonal")},pull:{diagonal:new Z1(bZ.ONE,"pull","diagonal"),orthogonal:new Z1(bZ.ONE,"pull","orthogonal")}}};class q1{constructor(e,t){this.width=e,this.pieces=t}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(e,t){if(this.pieces.length+t>=this.width)return 5===this.width?q1.EMPTY_3.addCaptured(e,t+this.pieces.length-5):(cZ(this.pieces.length+t===3,"should never put more pieces than the plate can support"),Aw.empty());{const n=AZ.copyImmutableArray(this.pieces);for(let r=0;r<t;r++)n.push(G1.of(e));return Aw.of(new q1(this.width,n))}}getPieceAt(e){return e<this.pieces.length?this.pieces[e]:H1.EMPTY}}q1.POSITIONS=["top","bottom","left","right"],q1.EMPTY_5=new q1(5,[]),q1.EMPTY_3=new q1(3,[]);let W1=(()=>{class e extends ij{constructor(e,t,n,r){super(e,t),this.lodestones=n,this.pressurePlates=r}static getInitialState(){const t=H1.EMPTY,n=G1.ZERO,r=G1.ONE;return new e([[t,t,n,r,n,r,t,t],[t,n,r,n,r,n,r,t],[n,r,n,r,n,r,n,r],[r,n,r,t,t,n,r,n],[n,r,n,t,t,r,n,r],[r,n,r,n,r,n,r,n],[t,r,n,r,n,r,n,t],[t,t,r,n,r,n,t,t]],0,new uj,{top:Aw.of(q1.EMPTY_5),bottom:Aw.of(q1.EMPTY_5),left:Aw.of(q1.EMPTY_5),right:Aw.of(q1.EMPTY_5)})}withBoard(t){return new e(t,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}remainingSpacesDetails(){const e={top:0,bottom:0,left:0,right:0};for(const t of q1.POSITIONS){const n=this.pressurePlates[t];n.isPresent()&&(e[t]=n.get().remainingSpaces())}return e}numberOfPieces(){const t=[0,0];for(let n=0;n<e.SIZE;n++)for(let r=0;r<e.SIZE;r++){const e=this.getPieceAtXY(r,n);e.isPlayerPiece()&&(t[e.owner.value]+=1)}return t}getScores(){const e=this.numberOfPieces();return[24-e[1],24-e[0]]}nextLodestoneDirection(){const e=this.getCurrentPlayer(),t=this.lodestones.get(e);if(!t.isPresent())return Aw.empty();{const e=this.getPieceAt(t.get());switch(cZ(e.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+t.get()),e.direction){case"push":return Aw.of("pull");case"pull":return Aw.of("push")}}}}return e.SIZE=8,e})();class j1 extends gj{constructor(){super(W1)}static get(){return j1.singleton.isAbsent()&&(j1.singleton=Aw.of(new j1)),j1.singleton.get()}applyLegalMove(e,t,n){const r=t.getCurrentPlayer(),i=r.getOpponent(),s=AZ.copyBiArray(n.board),o=t.lodestones.getCopy();o.put(r,e.coord);const a={...t.pressurePlates};return this.updatePressurePlates(s,a,o,i,e.captures),new W1(s,t.turn+1,o,a)}updatePressurePlates(e,t,n,r,i){for(const s of q1.POSITIONS)t[s]=this.updatePressurePlate(e,s,t[s],n,r,i[s])}updatePressurePlate(e,t,n,r,i,s){if(n.isPresent()){const o=n.get().addCaptured(i,s),a=j1.THREATENED_COORD_RANGE.get(t).get();return o.isAbsent()?(this.removePressurePlate(e,a.startForBigPlate,a.direction,r),this.removePressurePlate(e,a.startForSmallPlate,a.direction,r)):o.get().width<n.get().width&&this.removePressurePlate(e,a.startForBigPlate,a.direction,r),o}return n}removePressurePlate(e,t,n,r){for(let i=t;i.isInRange(W1.SIZE,W1.SIZE);i=i.getNext(n)){for(const e of bZ.PLAYERS)r.get(e).equalsValue(i)&&r.delete(e);e[i.y][i.x]=H1.UNREACHABLE}}isLegal(e,t){const n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return Mw.failure(n.getReason());const r=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(r.captures.length,t.remainingSpaces()))return Mw.failure(z1.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const i of q1.POSITIONS){const n=t.pressurePlates[i];if(n.isPresent()&&n.get().remainingSpaces()<e.captures[i])return Mw.failure(z1.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return Mw.success(r)}applyMoveWithoutPlacingCaptures(e,t,n){let r;const i=AZ.copyBiArray(e.board),s=e.lodestones.get(e.getCurrentPlayer());if(s.isPresent()){const e=s.get();i[e.y][e.x]=H1.EMPTY}return r="pull"===n.direction?this.applyPull(e,i,t,n.orientation):this.applyPush(e,i,t,n.orientation),r.board[t.y][t.x]=Z1.of(e.getCurrentPlayer(),n),r.moved.push(t),r}applyPull(e,t,n,r){const i=e.getCurrentPlayer(),s=i.getOpponent(),o=[],a=[],l="diagonal"===r?VW.DIAGONALS:VW.ORTHOGONALS;for(const c of l)for(let r=n.getNext(c);e.isOnBoard(r);r=r.getNext(c)){const n=t[r.y][r.x],l=r.getNext(c);if(e.isOnBoard(l)){const e=t[l.y][l.x];e.isPlayerPiece()&&e.owner===i&&(n.isEmpty()?(a.push(r),t[r.y][r.x]=e,a.push(l),t[l.y][l.x]=H1.EMPTY):n.isPlayerPiece()&&n.owner===s&&(o.push(r),t[r.y][r.x]=e,a.push(l),t[l.y][l.x]=H1.EMPTY))}}return{board:t,captures:o,moved:a}}applyPush(e,t,n,r){const i=e.getCurrentPlayer().getOpponent(),s=[],o=[],a="diagonal"===r?VW.DIAGONALS:VW.ORTHOGONALS;for(const l of a)for(let r=n.getNext(l,W1.SIZE);!1===r.equals(n);r=r.getPrevious(l))if(e.isOnBoard(r)){const n=t[r.y][r.x];if(n.isPlayerPiece()&&n.owner===i){const i=r.getNext(l);if(e.isOnBoard(i)){const e=t[i.y][i.x];e.isUnreachable()?(s.push(r),t[r.y][r.x]=H1.EMPTY):e.isEmpty()&&(o.push(i),t[i.y][i.x]=n,o.push(r),t[r.y][r.x]=H1.EMPTY)}else s.push(r),t[r.y][r.x]=H1.EMPTY}}return{board:t,captures:s,moved:o}}isLegalWithoutCaptures(e,t,n){const r=this.isTargetLegal(e,t);if(r.isFailure())return r;const i=e.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(n))?xw.failure(z1.MUST_FLIP_LODESTONE()):xw.SUCCESS}isTargetLegal(e,t){const n=e.getPieceAt(t);if(n.isUnreachable())return xw.failure(z1.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return xw.failure(XW.MUST_CLICK_ON_EMPTY_SQUARE());const r=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==r?xw.failure(XW.MUST_CLICK_ON_EMPTY_SQUARE()):xw.SUCCESS}getGameStatus(e){const t=e.gameState.numberOfPieces();return 0===t[0]&&0===t[1]?pj.DRAW:0===t[0]?pj.ONE_WON:0===t[1]?pj.ZERO_WON:pj.ONGOING}}j1.THREATENED_COORD_RANGE=uj.from({top:{startForBigPlate:new HW(0,0),startForSmallPlate:new HW(0,1),direction:VW.RIGHT},bottom:{startForBigPlate:new HW(0,W1.SIZE-1),startForSmallPlate:new HW(0,W1.SIZE-2),direction:VW.RIGHT},left:{startForBigPlate:new HW(0,0),startForSmallPlate:new HW(1,0),direction:VW.DOWN},right:{startForBigPlate:new HW(W1.SIZE-1,0),startForSmallPlate:new HW(W1.SIZE-2,0),direction:VW.DOWN}}),j1.singleton=Aw.empty();class Y1 extends JW{getListMoves(e){const t=e.gameState;return this.flatMapEmptyCoords(t,e=>{const n=[];for(const r of this.nextDirection(t)){const i=["diagonal","orthogonal"];for(const s of i){const i=j1.get().applyMoveWithoutPlacingCaptures(t,e,{direction:r,orientation:s}).captures.length;for(const o of this.captureCombinations(t,i))n.push(new $1(e,r,s,o))}}return n})}captureCombinations(e,t){if(0===t)return new nj([{top:0,bottom:0,left:0,right:0}]);{const n=new nj,r=e.remainingSpacesDetails(),i=this.captureCombinations(e,t-1);for(const e of i)e.top+1<=r.top&&n.add({...e,top:e.top+1}),e.bottom+1<=r.bottom&&n.add({...e,bottom:e.bottom+1}),e.left+1<=r.left&&n.add({...e,left:e.left+1}),e.right+1<=r.right&&n.add({...e,right:e.right+1});return 0===n.size()?i:n}}flatMapEmptyCoords(e,t){let n=[];for(let r=0;r<W1.SIZE;r++)for(let i=0;i<W1.SIZE;i++){const s=new HW(i,r),o=e.getPieceAt(s);(o.isEmpty()&&!1===o.isUnreachable()||o.isLodestone()&&o.owner===e.getCurrentPlayer())&&(n=n.concat(t(s)))}return n}nextDirection(e){const t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}getBoardValue(e){const t=e.gameState.getScores();let n;return n=24===t[0]&&24!==t[1]?bZ.ZERO.getVictoryValue():24!==t[0]&&24===t[1]?bZ.ONE.getVictoryValue():t[0]*bZ.ZERO.getScoreModifier()+t[1]*bZ.ONE.getScoreModifier(),new ej(n)}}const K1=H1.UNREACHABLE,Q1=H1.EMPTY,X1=G1.ZERO,J1=G1.ONE,e0=Z1.of(bZ.ONE,{direction:"push",orientation:"orthogonal"}),t0={top:Aw.of(q1.EMPTY_5),bottom:Aw.of(q1.EMPTY_5),left:Aw.of(q1.EMPTY_5),right:Aw.of(q1.EMPTY_5)};class n0{constructor(){this.tutorial=[Cj.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,W1.getInitialState()),Cj.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,W1.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),Cj.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,W1.getInitialState()),Cj.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,W1.getInitialState()),Cj.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,W1.getInitialState()),Cj.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,W1.getInitialState(),new $1(new HW(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(e,t,n)=>32===n.remainingSpaces()?xw.failure($localize`You have not captured any of the opponent's pieces, try again!`):xw.SUCCESS,"Congratulations!"),Cj.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new W1([[Q1,Q1,Q1,Q1,J1,Q1,Q1,Q1],[Q1,Q1,X1,Q1,Q1,J1,Q1,Q1],[Q1,Q1,e0,Q1,Q1,Q1,Q1,X1],[Q1,Q1,Q1,Q1,J1,Q1,Q1,X1],[Q1,Q1,Q1,Q1,Q1,X1,Q1,Q1],[Q1,Q1,Q1,Q1,Q1,Q1,Q1,Q1],[Q1,Q1,Q1,Q1,Q1,Q1,Q1,Q1],[Q1,Q1,Q1,Q1,Q1,Q1,Q1,Q1]],0,new uj([{key:bZ.ONE,value:new HW(2,2)}]),{...t0,top:q1.EMPTY_5.addCaptured(bZ.ONE,4)}),new $1(new HW(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(e,t,n)=>5===n.pressurePlates.top.get().width?xw.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):xw.SUCCESS,"Congratulations!"),Cj.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new W1([[K1,K1,K1,K1,K1,K1,K1,K1],[Q1,Q1,Q1,Q1,Q1,Q1,Q1,Q1],[Q1,Q1,Q1,Q1,Q1,Q1,Q1,X1],[Q1,Q1,Q1,Q1,Q1,X1,Q1,X1],[Q1,e0,Q1,Q1,J1,Q1,Q1,Q1],[Q1,Q1,Q1,Q1,Q1,Q1,Q1,Q1],[Q1,Q1,Q1,Q1,J1,Q1,Q1,Q1],[Q1,Q1,Q1,Q1,Q1,Q1,Q1,Q1]],0,new uj([{key:bZ.ONE,value:new HW(1,4)}]),{...t0,top:q1.EMPTY_3.addCaptured(bZ.ONE,2)}),new $1(new HW(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(e,t,n)=>n.pressurePlates.top.isPresent()?xw.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):xw.SUCCESS,"Congratulations!"),Cj.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new W1([[K1,K1,K1,K1,K1,K1,K1,K1],[K1,K1,K1,K1,K1,K1,K1,K1],[K1,K1,X1,J1,Q1,Q1,K1,K1],[K1,K1,e0,J1,Q1,Q1,K1,K1],[K1,K1,Q1,X1,X1,Q1,K1,K1],[K1,K1,X1,Q1,Q1,Q1,K1,K1],[K1,K1,K1,K1,K1,K1,K1,K1],[K1,K1,K1,K1,K1,K1,K1,K1]],0,new uj([{key:bZ.ONE,value:new HW(2,3)}]),{top:Aw.empty(),bottom:Aw.empty(),left:Aw.empty(),right:Aw.empty()})),Cj.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new W1([[Q1,Q1,Q1,Q1,Q1,Q1,Q1,Q1],[Q1,Q1,Q1,Q1,Q1,J1,Q1,Q1],[Q1,Q1,Q1,e0,Q1,Q1,X1,Q1],[Q1,Q1,X1,X1,J1,Q1,Q1,X1],[Q1,Q1,Q1,Q1,Q1,X1,Q1,Q1],[Q1,Q1,X1,Q1,Q1,Q1,Q1,Q1],[Q1,Q1,J1,Q1,Q1,Q1,Q1,Q1],[Q1,Q1,Q1,Q1,Q1,Q1,Q1,Q1]],0,new uj([{key:bZ.ONE,value:new HW(3,2)}]),{...t0,top:q1.EMPTY_5.addCaptured(bZ.ONE,4)}),[new $1(new HW(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),Cj.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new W1([[K1,K1,K1,K1,K1,K1,K1,K1],[K1,K1,K1,K1,K1,K1,K1,K1],[K1,J1,X1,J1,Q1,Q1,K1,K1],[K1,J1,e0,Q1,J1,Q1,K1,K1],[K1,Q1,Q1,X1,X1,Q1,K1,K1],[K1,J1,X1,Q1,J1,Q1,K1,K1],[K1,Q1,Q1,Q1,X1,Q1,K1,K1],[K1,K1,K1,K1,K1,K1,K1,K1]],0,new uj([{key:bZ.ONE,value:new HW(2,3)}]),{top:Aw.empty(),bottom:q1.EMPTY_3.addCaptured(bZ.ZERO,2),left:Aw.of(q1.EMPTY_3),right:Aw.empty()}),[new $1(new HW(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)]}}function r0(e,t){if(1&e&&(_n(),ga(0,"circle",10)),2&e){const e=Sa(2),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ta("id","piece_",t,"_",r,""),ha("ngClass",n.pieceClasses),ra("r",i.PIECE_RADIUS)("cx",i.SPACE_SIZE*t+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.STROKE_WIDTH+i.SPACE_SIZE/2)}}function i0(e,t){if(1&e&&(_n(),ga(0,"polygon",15)),2&e){const e=Sa().$implicit,t=Sa(3).$implicit,n=Sa(2);aa("transform","rotate(",90*e,")"),ha("ngClass",t.lodestone.movingClass),ra("points",n.TRIANGLE_OUT)}}function s0(e,t){if(1&e&&(_n(),ga(0,"polygon",15)),2&e){const e=Sa().$implicit,t=Sa(3).$implicit,n=Sa(2);aa("transform","rotate(",90*e,")"),ha("ngClass",t.lodestone.movingClass),ra("points",n.TRIANGLE_IN)}}function o0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,i0,1,3,"polygon",14),la(2,s0,1,3,"polygon",14),pa()),2&e){const e=Sa(3).$implicit;ks(1),ha("ngIf","push"===e.lodestone.direction),ks(1),ha("ngIf","pull"===e.lodestone.direction)}}const a0=function(){return[0,1,2,3]};function l0(e,t){if(1&e&&(_n(),fa(0,"g",11),ga(1,"circle",12),ga(2,"circle",13),fa(3,"g"),la(4,o0,3,2,"g",1),pa(),pa()),2&e){const e=Sa(2),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();ra("transform",i.getSquareTransform(t,r)),ks(1),ha("ngClass",n.lodestone.selectedClass),ra("r",i.PIECE_RADIUS),ks(1),ha("ngClass",n.lodestone.pieceClasses),ra("r",i.PIECE_RADIUS/4),ks(1),aa("transform","rotate(","diagonal"===n.lodestone.orientation?45:0,")"),ks(1),ha("ngForOf",wu(7,a0))}}function c0(e,t){if(1&e){const e=va();_n(),fa(0,"g",6),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa(2).selectCoord(t.coord)}),ga(1,"rect",7),la(2,r0,1,6,"circle",8),la(3,l0,5,8,"g",9),pa()}if(2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ta("id","square_",t,"_",r,""),ks(1),ha("ngClass",n.squareClasses),ra("x",i.SPACE_SIZE*t+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),ks(1),ha("ngIf",n.hasPiece),ks(1),ha("ngIf",n.lodestone)}}function u0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,c0,4,9,"g",5),pa()),2&e){const e=t.$implicit;ks(1),ha("ngIf",!1===e.crumbled)}}function h0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,u0,2,1,"g",1),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function d0(e,t){if(1&e&&(_n(),fa(0,"g",16),ga(1,"circle",17),pa()),2&e){const e=t.$implicit,n=t.index,r=Sa();ka("id","capture_",n,""),ra("transform",r.getCaptureTransform(n)),ks(1),ha("ngClass",e.pieceClasses),ra("r",r.PIECE_RADIUS)}}function f0(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"polygon",15),pa()),2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa();ks(1),aa("transform","rotate(",90*e,")"),ha("ngClass",n.movingClass),ra("points","push"===n.direction?r.TRIANGLE_OUT:r.TRIANGLE_IN)}}function p0(e,t){if(1&e){const e=va();_n(),fa(0,"g",6),Ea("click",function(){const t=Gt(e).$implicit;return Sa().selectLodestone(t)}),ga(1,"circle",12),ga(2,"circle",13),fa(3,"g"),la(4,f0,2,3,"g",1),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa();Ta("id","lodestone_",e.direction,"_",e.orientation,""),ra("transform",r.getAvailableLodestoneTransform(n)),ks(1),ha("ngClass",e.selectedClass),ra("r",r.PIECE_RADIUS),ks(1),ha("ngClass",e.pieceClasses),ra("r",r.PIECE_RADIUS/4),ks(1),aa("transform","rotate(","diagonal"===e.orientation?45:0,")"),ks(1),ha("ngForOf",wu(9,a0))}}function g0(e,t){if(1&e&&(_n(),ga(0,"circle",10)),2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().$implicit,i=Sa();Ta("id","platePiece_",r.position,"_",t,""),ha("ngClass",n.pieceClasses),ra("r",i.PIECE_RADIUS)("cx",i.SPACE_SIZE*n.coord.x+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n.coord.y+i.STROKE_WIDTH+i.SPACE_SIZE/2)}}function m0(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"g",6),Ea("click",function(){const t=Gt(e),n=t.$implicit,r=t.index,i=Sa().$implicit;return Sa().onPressurePlateClick(n.temporary,i.position,r)}),ga(2,"rect",18),la(3,g0,1,6,"circle",8),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().$implicit,i=Sa();ra("transform",i.getPressurePlateTransform(r.position)),ks(1),Ta("id","plate_",r.position,"_",n,""),ks(1),Ta("id","plateSquare_",r.position,"_",n,""),ha("ngClass",e.squareClasses),ra("x",i.SPACE_SIZE*e.coord.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*e.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),ks(1),ha("ngIf",e.hasPiece)}}function y0(e,t){if(1&e&&(_n(),fa(0,"g",16),la(1,m0,4,11,"g",1),pa()),2&e){const e=t.$implicit;ka("id","pressurePlate_",e.position,""),ks(1),ha("ngForOf",e.coords)}}function v0(e,t){if(1&e&&(_n(),ga(0,"rect",19)),2&e){const e=Sa();Ta("id","selection_",e.viewInfo.selected.get().x,"_",e.viewInfo.selected.get().y,""),ra("x",e.SPACE_SIZE*e.viewInfo.selected.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.viewInfo.selected.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}class C0 extends GW{constructor(e){super(e),this.viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:Aw.empty(),pressurePlateShift:{top:new LW(0,0),left:new LW(0,0),right:new LW(0,0),bottom:new LW(0,0)}},this.stateAfterPlacingLodestone=Aw.empty(),this.lastInfos=Aw.empty(),this.capturesToPlace=0,this.selectedCoord=Aw.empty(),this.selectedLodestone=Aw.empty(),this.captures={top:0,bottom:0,left:0,right:0},this.rules=j1.get(),this.tutorial=(new n0).tutorial,this.availableMinimaxes=[new Y1(this.rules,"LodestoneDummyMinimax")],this.encoder=$1.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const t=.8*this.PIECE_RADIUS,n=.3*this.PIECE_RADIUS,r=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${t},0 ${n},${r} ${n},-${r}`,this.TRIANGLE_IN=`${n},0 ${t},${n} ${t},-${n}`,this.displayedState=this.getState(),this.scores=Aw.of([0,0])}ngOnInit(){this.updateBoard()}selectCoord(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#square_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.capturesToPlace>0)return t.cancelMove(z1.MUST_PLACE_CAPTURES());const r=j1.get().isTargetLegal(t.getState(),e);return r.isFailure()?t.cancelMove(r.getReason()):t.selectedCoord.equalsValue(e)?(t.cancelMoveAttempt(),xw.SUCCESS):(t.selectedCoord=Aw.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),xw.SUCCESS))})()}selectLodestone(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation);if(n.isFailure())return t.cancelMove(n.getReason());cZ(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const r=t.getCurrentPlayer(),i=Z1.of(r,e);return t.selectedLodestone.equalsValue(i)?(t.cancelMoveAttempt(),xw.SUCCESS):(t.selectedLodestone=Aw.of(i),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),xw.SUCCESS))})()}putLodestone(){var e=this;return Sw(function*(){cZ(e.selectedCoord.isPresent(),"coord should have been selected"),cZ(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),r=e.getState();cZ(j1.get().isLegalWithoutCaptures(r,t,n.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const i=j1.get().applyMoveWithoutPlacingCaptures(r,t,n);return e.lastInfos=Aw.of(i),e.capturesToPlace=Math.min(i.captures.length,r.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(i.board),e.stateAfterPlacingLodestone=Aw.of(e.displayedState),e.updateViewInfo(),xw.SUCCESS)})()}applyMove(){var e=this;return Sw(function*(){cZ(e.selectedCoord.isPresent(),"coord should have been selected"),cZ(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),r=new $1(t,n.direction,n.orientation,e.captures);return e.chooseMove(r,e.getState())})()}onPressurePlateClick(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}selectPressurePlate(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#plate_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(0===n.capturesToPlace)return n.cancelMove(z1.NO_CAPTURES_TO_PLACE_YET());n.capturesToPlace--,n.captures[e]++;const i=n.stateAfterPlacingLodestone.get(),s=n.getCurrentPlayer().getOpponent(),o=AZ.copyBiArray(i.board),a={...i.pressurePlates},l=i.lodestones.getCopy();return j1.get().updatePressurePlates(o,a,l,s,n.captures),n.displayedState=new W1(o,i.turn,l,a),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),xw.SUCCESS)})()}deselectPressurePlate(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#plate_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());n.capturesToPlace++,n.captures[e]--;const i=n.stateAfterPlacingLodestone.get(),s=n.getCurrentPlayer().getOpponent(),o=AZ.copyBiArray(i.board),a={...i.pressurePlates},l=i.lodestones.getCopy();return j1.get().updatePressurePlates(o,a,l,s,n.captures),n.displayedState=new W1(o,i.turn,l,a),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),xw.SUCCESS})()}updateBoard(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=Aw.of(this.getState().getScores())}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=Aw.empty(),this.lastInfos=Aw.empty();const e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){const t=AZ.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=H1.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=Aw.empty(),this.selectedLodestone=Aw.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let e=0;e<W1.SIZE;e++){this.viewInfo.boardInfo.push([]);for(let t=0;t<W1.SIZE;t++){const n=new HW(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:Aw.empty()}getSquareInfo(e){const t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){const n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const e=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(let t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}nextLodestone(e,t){const n=Z1.of(e,t),r={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return r.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(r.selectedClass="selected-stroke"),r}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const e of q1.POSITIONS){const t=[],n=this.displayedState.pressurePlates[e];if(n.isPresent()){const r=C0.PRESSURE_PLATES_POSITIONS.get(e).get(),i=n.get().width;let s=5===i?r.startForBigPlate:r.startForSmallPlate;for(let e=0;e<i;e++){s=s.getNext(r.direction);const i=n.get().getPieceAt(e);let o="";i.isPlayerPiece()&&(o=this.getPlayerClass(i.owner)),t.push({coord:s,hasPiece:i.isPlayerPiece(),pieceClasses:[o],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:e,coords:t})}}showLastMove(){const e=this.rules.node.mother.get().gameState,t=this.rules.node.move.get();this.lastInfos=Aw.of(j1.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();const n=this.getState();this.showPressurePlateDifferences(e,n,!1)}showPressurePlateDifferences(e,t,n){for(const r of q1.POSITIONS)this.showPressurePlateDifference(e.pressurePlates[r],t.pressurePlates[r],r,n)}showPressurePlateDifference(e,t,n,r){if(e.isPresent()&&t.isPresent()){const i=e.get(),s=t.get(),o=bw.getNonNullable(this.viewInfo.pressurePlates.find(e=>e.position===n));if(i.width===s.width)for(let e=0;e<s.width;e++){const t=i.getPieceAt(e),n=s.getPieceAt(e);!1===t.equals(n)&&(o.coords[e].squareClasses.push("moved-fill"),o.coords[e].temporary=r,r&&o.coords[e].pieceClasses.push("semi-transparent"))}else for(const e of o.coords)e.squareClasses.push("moved-fill")}}showMovedAndCaptured(e){for(const t of e.moved)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved-fill");for(const t of e.captures)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),r=this.getPressurePlateShift(e.pressurePlates.top),i=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new HW(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new HW(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new HW(0,.5*(r-i)),this.viewInfo.pressurePlateShift.right=new HW(0,.5*(r-i))}getPressurePlateShift(e){return e.isAbsent()?2:3===e.get().width?1:0}getSquareTransform(e,t){return`translate(${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(e){return`translate(${(e+(W1.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(e){return`translate(${(e+(W1.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(e){return`translate(${this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE})`}}C0.PRESSURE_PLATE_EXTRA_SHIFT=.2,C0.PRESSURE_PLATES_POSITIONS=uj.from({top:{startForBigPlate:new HW(.5,-1-C0.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new HW(1.5,0-C0.PRESSURE_PLATE_EXTRA_SHIFT),direction:VW.RIGHT},bottom:{startForBigPlate:new HW(.5,8+C0.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new HW(1.5,7+C0.PRESSURE_PLATE_EXTRA_SHIFT),direction:VW.RIGHT},left:{startForBigPlate:new HW(-1-C0.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new HW(0-C0.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:VW.DOWN},right:{startForBigPlate:new HW(8+C0.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new HW(7+C0.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:VW.DOWN}}),C0.\u0275fac=function(e){return new(e||C0)(ua(aZ))},C0.\u0275cmp=Je({type:C0,selectors:[["app-lodestone"]],features:[Go],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,h0,2,1,"g",1),la(2,d0,2,4,"g",2),la(3,p0,5,10,"g",3),la(4,y0,2,2,"g",2),la(5,v0,1,6,"rect",4),pa()),2&e&&(ks(1),ha("ngForOf",t.viewInfo.boardInfo),ks(1),ha("ngForOf",t.viewInfo.capturesToPlace),ks(1),ha("ngForOf",t.viewInfo.availableLodestones),ks(1),ha("ngForOf",t.viewInfo.pressurePlates),ks(1),ha("ngIf",t.viewInfo.selected.isPresent()))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let _0=(()=>{class e{}return e.START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`,e.END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`,e.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`,e.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`,e})();class E0 extends hY{constructor(e,t,n){super(e,t),this.calledTheClock=n}static from(e,t,n=!1){if(e.isNotInRange(4,8))return Mw.failure(_0.START_COORD_OUT_OF_RANGE());if(t.isNotInRange(4,8))return Mw.failure(_0.END_COORD_OUT_OF_RANGE());if(t.equals(e))return Mw.failure(XW.MOVE_CANNOT_BE_STATIC());const r=VW.factory.fromDelta(t.x-e.x,t.y-e.y);return r.isFailure()?Mw.failure(r.getReason()):Mw.success(new E0(e,t,n))}toString(){return"MartianChessMove(("+this.coord.x+", "+this.coord.y+") -> ("+this.end.x+", "+this.end.y+")"+(this.calledTheClock?", CALL_THE_CLOCK":"")+")"}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.end.equals(e.end)&&this.calledTheClock===e.calledTheClock}isValidForPawn(){const e=Math.abs(this.coord.x-this.end.x),t=Math.abs(this.coord.y-this.end.y);return 1===e&&1===t}isValidForDrone(){return this.coord.getDistance(this.end)<=2}isUndoneBy(e){if(e.isAbsent())return!1;const t=e.get();return t.end.equals(this.coord)&&t.coord.equals(this.end)}}E0.encoder=PZ.tuple([HW.numberEncoder(4,8),HW.numberEncoder(4,8),PZ.booleanEncoder],e=>[e.coord,e.end,e.calledTheClock],e=>E0.from(e[0],e[1],e[2]).get());class w0{constructor(e){this.value=e}static tryMerge(e,t){cZ(e!==w0.EMPTY&&t!==w0.EMPTY,"tryMerge cannot be called with empty pieces");const n=e.value+t.value;return 2===n||3===n?Aw.of(w0.from(n)):Aw.empty()}static from(e){return e===w0.DRONE.value?w0.DRONE:(bw.expectToBe(e,w0.QUEEN.value),w0.QUEEN)}getValue(){return this.value}equals(e){return this.getValue()===e.getValue()}}w0.EMPTY=new w0(0),w0.PAWN=new w0(1),w0.DRONE=new w0(2),w0.QUEEN=new w0(3);class P0 extends JW{constructor(e,t){super(e,t),this.ruler=e}getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),r=t.getPlayerTerritory(n);let i=[];for(const s of r)for(let e=0;e<4;e++)switch(t.getPieceAtXY(e,s)){case w0.PAWN:i=i.concat(this.getMovesForPawnAt(t,e,s));break;case w0.DRONE:i=i.concat(this.getMovesForDroneAt(t,e,s));break;case w0.QUEEN:i=i.concat(this.getMovesForQueenAt(t,e,s))}return i}getMovesForPawnAt(e,t,n){const r=new HW(t,n),i=[];for(const s of VW.DIAGONALS){const e=r.getNext(s);e.isInRange(4,8)&&i.push(e)}return this.addLegalMoves(e,r,i)}addLegalMoves(e,t,n){const r=[],i=e.getPieceAt(t),s=!1===e.isTherePieceOnPlayerSide(w0.DRONE),o=!1===e.isTherePieceOnPlayerSide(w0.QUEEN),a=e.lastMove;for(const l of n){const n=e.getPieceAt(l);if(n===w0.EMPTY)this.add(r,E0.from(t,l).get(),a);else if(e.isInPlayerTerritory(l)){const e=w0.tryMerge(n,i);if(e.isPresent()){const n=e.get(),i=E0.from(t,l).get();(n===w0.DRONE&&s||n===w0.QUEEN&&o)&&this.add(r,i,a)}}else this.add(r,E0.from(t,l).get(),a)}return r}add(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}getMovesForDroneAt(e,t,n){const r=new HW(t,n),i=this.getLandingCoordsForLinearMove(r,e,2);return this.addLegalMoves(e,r,i)}getLandingCoordsForLinearMove(e,t,n){const r=[];for(const i of VW.DIRECTIONS){let s=1,o=e.getNext(i,s),a=t.tryToGetPieceAt(o),l=a.equalsValue(w0.EMPTY);for(;l;)r.push(o),s++,o=e.getNext(i,s),a=t.tryToGetPieceAt(o),l=a.equalsValue(w0.EMPTY)&&s<n;a.isPresent()&&r.push(o)}return r}getMovesForQueenAt(e,t,n){const r=new HW(t,n),i=this.getLandingCoordsForQueen(r,e);return this.addLegalMoves(e,r,i)}getLandingCoordsForQueen(e,t){return this.getLandingCoordsForLinearMove(e,t,8)}getBoardValue(e){const t=this.ruler.getGameStatus(e);let n;if(t.isEndGame)n=t.toBoardValue();else{const t=e.gameState.getScoreOf(bZ.ZERO);n=e.gameState.getScoreOf(bZ.ONE)-t}return new ej(n)}}class S0{constructor(e){this.captures=e,e.makeImmutable()}static from(e){const t=new uj;for(const n of e)S0.addToMap(t,n);return new S0(t)}static addToMap(e,t){const n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}toValue(){let e=0;return this.captures.forEach(t=>{e+=t.key.getValue()*t.value}),e}add(e){const t=this.captures.getCopy();return S0.addToMap(t,e),new S0(t)}}class b0 extends ij{constructor(e,t,n=Aw.empty(),r=Aw.empty(),i){super(e,t),this.lastMove=n,this.countDown=r,null==i&&(i=new uj([{key:bZ.ZERO,value:S0.from([])},{key:bZ.ONE,value:S0.from([])}])),i.makeImmutable(),this.captured=i}static getInitialState(){const e=w0.EMPTY,t=w0.PAWN,n=w0.DRONE,r=w0.QUEEN;return new b0([[r,r,n,e],[r,n,t,e],[n,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,n],[e,t,n,r],[e,n,r,r]],0,Aw.empty())}getPlayerTerritory(e){return e===bZ.ZERO?b0.PLAYER_ZERO_TERRITORY:b0.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(e){const t=this.getCurrentPlayer(),n=this.getPlayerTerritory(t);for(const r of n)for(let t=0;t<4;t++)if(this.getPieceAtXY(t,r)===e)return!0;return!1}getScoreOf(e){return this.captured.get(e).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(bZ.ZERO)?Aw.of(bZ.ZERO):this.isTerritoryEmpty(bZ.ONE)?Aw.of(bZ.ONE):Aw.empty()}isTerritoryEmpty(e){const t=this.getPlayerTerritory(e);for(const n of t)for(let e=0;e<4;e++)if(this.getPieceAtXY(e,n)!==w0.EMPTY)return!1;return!0}isInOpponentTerritory(e){const t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}isInPlayerTerritory(e){const t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}getCapturesOf(e){const t=this.captured.get(e).get();return[t.captures.get(w0.PAWN).getOrElse(0),t.captures.get(w0.DRONE).getOrElse(0),t.captures.get(w0.QUEEN).getOrElse(0)]}}b0.PLAYER_ZERO_TERRITORY=new nj([4,5,6,7]),b0.PLAYER_ONE_TERRITORY=new nj([0,1,2,3]);let O0=(()=>{class e{}return e.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`,e.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`,e.CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`,e})();class k0 extends gj{applyLegalMove(e,t,n){const r=t.getCopiedBoard();r[e.coord.y][e.coord.x]=w0.EMPTY,r[e.end.y][e.end.x]=n.finalPiece;const i=n.score;let s=t.countDown;if(s.isPresent())if(this.isCapture(e,t))s=k0.STARTING_COUNT_DOWN;else{const e=t.countDown.get();s=Aw.of(e-1)}return e.calledTheClock&&(s=k0.STARTING_COUNT_DOWN),new b0(r,t.turn+1,Aw.of(e),s,i)}isLegal(e,t){this.assertNonDoubleClockCall(e,t);const n=this.isLegalMove(e,t);if(n.isFailure())return Mw.failure(n.getReason());if(e.isUndoneBy(t.lastMove))return Mw.failure(O0.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);const r=t.getPieceAt(e.coord),i=t.captured.getCopy();if(this.isCapture(e,t)){const n=t.getCurrentPlayer();let r=i.get(n).get();const s=t.getPieceAt(e.end);r=r.add(s),i.replace(n,r),i.makeImmutable()}return Mw.success({finalPiece:r,score:i})}assertNonDoubleClockCall(e,t){cZ(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}isCapture(e,t){const n=t.isInOpponentTerritory(e.end),r=t.getPieceAt(e.end)!==w0.EMPTY;return n&&r}isFieldPromotion(e,t){const n=t.isInPlayerTerritory(e.end),r=t.getPieceAt(e.end)!==w0.EMPTY;return n&&r}isLegalFieldPromotion(e,t){const n=this.getPromotedPiece(e,t);if(n.isAbsent())return Mw.failure(O0.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const r=n.get();if(t.isTherePieceOnPlayerSide(r))return Mw.failure(O0.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const e={finalPiece:r,score:t.captured.getCopy()};return Mw.success(e)}}isLegalMove(e,t){if(!1===t.isInPlayerTerritory(e.coord))return Mw.failure(O0.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const n=t.getPieceAt(e.coord);if(n===w0.EMPTY)return Mw.failure(XW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===w0.PAWN)return e.isValidForPawn()?Mw.success(void 0):Mw.failure(_0.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(n===w0.DRONE&&!1===e.isValidForDrone())return Mw.failure(_0.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const r of e.coord.getUntil(e.end))if(t.getPieceAt(r)!==w0.EMPTY)return Mw.failure(XW.SOMETHING_IN_THE_WAY());return Mw.success(void 0)}getPromotedPiece(e,t){const n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end);return w0.tryMerge(n,r)}getGameStatus(e){const t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,pj.DRAW);if(t.getEmptyTerritory().isPresent()){const e=t.getCurrentOpponent(),n=pj.getVictory(e);return this.getGameStatusScoreVictoryOr(t,n)}return pj.ONGOING}getGameStatusScoreVictoryOr(e,t){const n=e.getScoreOf(bZ.ZERO),r=e.getScoreOf(bZ.ONE);return n>r?pj.ZERO_WON:r>n?pj.ONE_WON:t}}k0.STARTING_COUNT_DOWN=Aw.of(7);let T0=(()=>{class e{}return e.YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`,e})();const I0=w0.EMPTY,A0=w0.PAWN,M0=w0.DRONE,N0=w0.QUEEN,R0=()=>$localize`This is not a field promotion!`;class x0{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,b0.getInitialState()),Cj.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,b0.getInitialState()),Cj.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,b0.getInitialState(),E0.from(new HW(2,5),new HW(1,4)).get(),(e,t,n)=>n.getPieceAt(e.end)===w0.PAWN?xw.SUCCESS:xw.failure($localize`This is not a pawn!`),$localize`Congratulations!`),Cj.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,b0.getInitialState(),E0.from(new HW(1,7),new HW(0,7)).get(),(e,t,n)=>n.getPieceAt(e.end)===w0.DRONE?xw.SUCCESS:xw.failure($localize`This is not a drone!`),$localize`Congratulations!`),Cj.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new b0([[M0,A0,I0,I0],[N0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,N0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[N0,M0,A0,I0]],1),E0.from(new HW(2,3),new HW(2,7)).get(),(e,t,n)=>n.getPieceAt(e.end)===w0.QUEEN?xw.SUCCESS:xw.failure($localize`This is not a queen!`),$localize`Congratulations!`),Cj.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new b0([[M0,A0,A0,I0],[I0,I0,I0,I0],[N0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,A0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,M0,A0,I0]],1),[E0.from(new HW(0,2),new HW(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,T0.YOU_DID_NOT_CAPTURE_ANY_PIECE()),Cj.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new b0([[I0,I0,I0,N0],[I0,A0,I0,I0],[I0,I0,A0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,N0],[I0,I0,M0,I0],[I0,A0,I0,I0]],1),[E0.from(new HW(1,1),new HW(2,2)).get(),E0.from(new HW(2,2),new HW(1,1)).get()],$localize`Congratulations!`,R0()),Cj.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new b0([[A0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,M0,I0],[I0,A0,I0,I0]],0),E0.from(new HW(1,7),new HW(2,6)).get(),(e,t,n)=>n.getPieceAt(e.end)===w0.QUEEN?xw.SUCCESS:xw.failure(R0()),$localize`Congratulations!`),Cj.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,b0.getInitialState(),E0.from(new HW(1,5),new HW(0,4),!0).get(),(e,t,n)=>e.calledTheClock?xw.SUCCESS:xw.failure($localize`You did not call the clock!`),$localize`Congratulations!`),Cj.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You are playing Dark, do a capture to restart the countdown.`,new b0([[I0,I0,I0,I0],[I0,A0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,A0],[I0,I0,M0,I0],[I0,A0,I0,I0]],15,Aw.empty(),Aw.of(1)),[E0.from(new HW(1,1),new HW(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),Cj.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You are playing Dark, do the last move.`,new b0([[I0,I0,I0,N0],[I0,A0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[M0,I0,I0,I0],[I0,I0,I0,I0],[I0,M0,I0,I0]],15,Aw.empty(),Aw.of(1)),E0.from(new HW(1,1),new HW(2,2)).get(),$localize`Congratulations!`),Cj.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new b0([[I0,I0,I0,N0],[I0,A0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,A0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0],[I0,I0,I0,I0]],0),E0.from(new HW(2,4),new HW(1,3)).get(),(e,t,n)=>3===e.end.y?xw.SUCCESS:xw.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)]}}function D0(e,t){if(1&e&&(_n(),ga(0,"g",19)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();Ba(n.style),Ta("mainShapeId","pawn_",e,"_",t,""),ha("pieceClasses",n.getPieceClasses(e,t))}}function L0(e,t){if(1&e&&(_n(),ga(0,"g",20)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();Ba(n.style),Ta("mainShapeId","drone_",e,"_",t,""),ha("pieceClasses",n.getPieceClasses(e,t))}}function F0(e,t){if(1&e&&(_n(),ga(0,"g",21)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();Ba(n.style),Ta("mainShapeId","queen_",e,"_",t,""),ha("pieceClasses",n.getPieceClasses(e,t))}}function U0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,D0,1,5,"g",16),la(2,L0,1,5,"g",17),la(3,F0,1,5,"g",18),pa()),2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();ra("transform",i.getPieceLocation(t,r)),ks(1),ha("ngIf",n===i.pieces.PAWN),ks(1),ha("ngIf",n===i.pieces.DRONE),ks(1),ha("ngIf",n===i.pieces.QUEEN)}}function V0(e,t){if(1&e){const e=va();_n(),fa(0,"g",14),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),ga(1,"rect",15),la(2,U0,4,4,"g",13),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();Ta("id","click_",n,"_",r,""),ra("transform","translate(0,  "+(r<=3?0:2*i.STROKE_WIDTH)+")"),ks(1),Ta("id","square_",n,"_",r,""),ha("ngClass",i.getSquareClasses(n,r)),ra("x",n*i.SPACE_SIZE)("y",r*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),ks(1),ha("ngIf",e!==i.pieces.EMPTY)}}function B0(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",22),Ea("click",function(){const t=Gt(e).$implicit;return Sa(3).onClick(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa(3);ks(1),Ta("id","indicator_",e.x,"_",e.y,""),ra("transform","translate(0,  "+(e.y<=3?0:2*n.STROKE_WIDTH)+")")("x",e.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",e.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function $0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,B0,2,7,"g",1),pa()),2&e){const e=Sa(2);ks(1),ha("ngForOf",e.selectedPieceInfo.get().legalLandings)}}function z0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,V0,3,11,"g",12),la(2,$0,2,1,"g",13),pa()),2&e){const e=t.$implicit,n=Sa();ra("transform","translate("+n.SPACE_SIZE+", 0)"),ks(1),ha("ngForOf",e),ks(1),ha("ngIf",n.selectedPieceInfo.isPresent())}}function H0(e,t){if(1&e&&(_n(),fa(0,"text",23),Qa(1),pa()),2&e){const e=Sa();ha("ngClass","player"+e.getCurrentPlayer().value)("ngClass",e.getClockCircleClasses()),ra("x",.5*e.SPACE_SIZE)("y",.5*e.SPACE_SIZE),ks(1),Xa(e.countDown.get())}}function G0(e,t){if(1&e&&(_n(),ga(0,"polyline",24)),2&e){const e=Sa();ha("ngClass",e.getClockCircleClasses()),ra("points",e.clockNeedlesPoints)}}const Z0=function(e){return[e]};function q0(e,t){if(1&e){const e=va();_n(),ma(0),fa(1,"g",27),Ea("click",function(){const t=Gt(e).index;return Sa(2).chooseStyle(t)}),pa(),ya()}if(2&e){const e=t.$implicit,n=t.index,r=Sa(2);ks(1),Ba(e.style),ha("id",e.name)("pieceClasses",Pu(5,Z0,"player"+r.getCurrentPlayer().value+"-fill")),ra("transform","translate(0, "+-(n+1)*r.SPACE_SIZE+")")}}function W0(e,t){if(1&e&&(_n(),fa(0,"g",25),ga(1,"rect",26),la(2,q0,2,7,"ng-container",1),pa()),2&e){const e=Sa();ks(1),ra("x",0)("y",-e.listOfStyles.length*e.SPACE_SIZE)("width",1*e.SPACE_SIZE)("height",e.listOfStyles.length*e.SPACE_SIZE),ks(1),ha("ngForOf",e.listOfStyles)}}function j0(e,t){if(1&e&&(_n(),fa(0,"text",33),Qa(1),pa()),2&e){const e=Sa(2).$implicit,t=Sa().$implicit,n=Sa();ha("ngClass","player"+(0===t.value?1:0)+"-fill"),ra("x",n.SPACE_SIZE/2)("y",n.SPACE_SIZE/2),ks(1),Xa(e+" x ")}}function Y0(e,t){if(1&e&&(_n(),ga(0,"g",34)),2&e){const e=Sa(3).$implicit;Ba(Sa().style),ha("pieceClasses",Pu(3,Z0,"player"+(0===e.value?1:0)+"-fill"))}}function K0(e,t){if(1&e&&(_n(),ga(0,"g",35)),2&e){const e=Sa(3).$implicit;Ba(Sa().style),ha("pieceClasses",Pu(3,Z0,"player"+(0===e.value?1:0)+"-fill"))}}function Q0(e,t){if(1&e&&(_n(),ga(0,"g",36)),2&e){const e=Sa(3).$implicit;Ba(Sa().style),ha("pieceClasses",Pu(3,Z0,"player"+(0===e.value?1:0)+"-fill"))}}function X0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,j0,2,4,"text",29),fa(2,"g",28),la(3,Y0,1,5,"g",30),la(4,K0,1,5,"g",31),la(5,Q0,1,5,"g",32),pa(),pa()),2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().$implicit,i=Sa();ra("transform","translate(0, "+2*t*i.SPACE_SIZE+")"),ks(1),ha("ngIf",n>1),ks(1),Ta("id","piece_",t,"_player_",r.value,""),ra("transform","translate("+i.SPACE_SIZE+", 0)"),ks(1),ha("ngIf",0===t),ks(1),ha("ngIf",1===t),ks(1),ha("ngIf",2===t)}}function J0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,X0,6,8,"g",13),pa()),2&e){const e=t.$implicit;ks(1),ha("ngIf",e>0)}}function e2(e,t){if(1&e&&(_n(),fa(0,"g"),fa(1,"g",28),la(2,J0,2,1,"g",1),pa(),pa()),2&e){const e=t.$implicit,n=Sa();ks(1),ka("id","capture_of_player_",e.value,""),ra("transform","scale(0.5, 0.5) translate("+-n.SPACE_SIZE/2+", "+(n.SPACE_SIZE/2+e.value*(10*n.SPACE_SIZE+4*n.STROKE_WIDTH))+")"),ks(1),ha("ngForOf",n.state.getCapturesOf(e))}}let t2=(()=>{class e extends eY{constructor(t){super(t),this.INDICATOR_SIZE=20,this.LEFT=e.SPACE_SIZE/-4+e.STROKE_WIDTH/-2,this.UP=-e.STROKE_WIDTH/2,this.WIDTH=6.5*e.SPACE_SIZE+e.STROKE_WIDTH,this.HEIGHT=8*e.SPACE_SIZE+3*e.STROKE_WIDTH,this.MartianChessComponent=e,this.style={shape:"Circle",points:"Horizontal Points"},this.pieces=w0,this.selectedPieceInfo=Aw.empty(),this.countDown=Aw.empty(),this.callTheClock=!1,this.displayModePanel=!1,this.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],this.hasAsymetricBoard=!0,this.rules=new k0(b0),this.availableMinimaxes=[new P0(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=e.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=E0.encoder,this.tutorial=(new x0).tutorial,this.scores=Aw.of([0,0]),this.updateBoard()}static getRegularPolygon(t,n=0){const r=e.getRegularPolygonCoords(t,n);return e.mapCoordsToString(r)}static getNPointedStar(t,n){const r=this.getNPointedStarCoords(t,n);return e.mapCoordsToString(r)}static getNPointedStarCoords(t,n){const r=[],i=.5*e.SPACE_SIZE,s=.5*e.SPACE_SIZE;t*=2;for(let o=0;o<t;o++){const a=(o*(360/t)+n)/180*Math.PI,l=o%2==0?e.SPACE_SIZE/2:e.SPACE_SIZE/6,c=i+.8*l*Math.cos(a),u=s+.8*l*Math.sin(a);r.push(new HW(c,u))}return r}static getRegularPolygonCoords(t,n=0){const r=[],i=.5*e.SPACE_SIZE,s=.5*e.SPACE_SIZE;for(let o=0;o<t;o++){const a=(o*(360/t)-90)/180*Math.PI,l=.5*e.SPACE_SIZE,c=i+.8*l*Math.cos(a),u=s+.8*l*Math.sin(a)+n;r.push(new HW(c,u))}return r}static mapCoordsToString(e){let t="";for(const n of e)t+=n.x+", "+n.y+" ";return t}static getRadius(e){return this.SPACE_SIZE*e/10}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const e=this.STROKE_WIDTH,t=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+t+" "+t+")"}getClockNeedlesPoints(){const e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}updateBoard(){this.state=this.getState(),this.board=this.state.board;const e=this.state.getScoreOf(bZ.ZERO),t=this.state.getScoreOf(bZ.ONE);this.countDown=this.state.countDown,this.scores=Aw.of([e,t])}getPieceLocation(e,t){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*t+")"}getPieceClasses(e,t){const n=new HW(e,t),r=[];return r.push(t>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(n)&&r.push("selected-stroke"),this.rules.node.move.isPresent()&&this.rules.node.move.get().end.equals(n)&&this.rules.node.mother.get().gameState.getPieceAt(n)!==w0.EMPTY&&this.getState().isInOpponentTerritory(new HW(0,t))&&r.push("last-move-stroke"),r}onClick(e,t){var n=this;return Sw(function*(){n.displayModePanel=!1;const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new HW(e,t);return n.selectedPieceInfo.isPresent()?n.secondClick(i):n.firstClick(i)})()}firstClick(e){var t=this;return Sw(function*(){return t.isOneOfUsersPieces(e)?t.selectAsFirstPiece(e):(t.cancelMoveAttempt(),xw.SUCCESS)})()}selectAsFirstPiece(e){var t=this;return Sw(function*(){const n=t.getLegalLandings(e);return t.selectedPieceInfo=Aw.of({selectedPiece:e,legalLandings:n}),xw.SUCCESS})()}getLegalLandings(e){const t=this.state.getPieceAt(e);let n;return n=t===w0.PAWN?VW.DIAGONALS.map(t=>e.getNext(t)):this.getValidLinearLandingSquareUntil(e,t===w0.DRONE?2:8),n.filter(t=>{const n=E0.from(e,t);return!!n.isSuccess()&&this.rules.isLegal(n.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(e,t){return VW.DIRECTIONS.flatMap(n=>{const r=[];let i=e.getNext(n),s=1;for(;i.isInRange(4,8)&&s<=t&&(r.push(i),this.getState().getPieceAt(i)===w0.EMPTY);)i=i.getNext(n),s++;return r})}secondClick(e){var t=this;return Sw(function*(){const n=t.selectedPieceInfo.get();if(n.selectedPiece.equals(e))return t.cancelMoveAttempt(),xw.SUCCESS;if(n.legalLandings.some(t=>t.equals(e))){const r=E0.from(n.selectedPiece,e,t.callTheClock);cZ(r.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!");const i=t.getState();return t.chooseMove(r.get(),i)}if(t.isOneOfUsersPieces(e))return t.selectAsFirstPiece(e);{const r=E0.from(n.selectedPiece,e,t.callTheClock);return r.isSuccess()?t.chooseMove(r.get(),t.getState()):t.cancelMove(r.getReason())}})()}isOneOfUsersPieces(e){return this.state.getPieceAt(e)!==w0.EMPTY&&this.state.isInPlayerTerritory(e)}cancelMoveAttempt(){this.selectedPieceInfo=Aw.empty(),this.callTheClock=!1}onClockClick(){var e=this;return Sw(function*(){const t=e.canUserPlay("#clockOrCountDownView");return t.isFailure()?e.cancelMove(t.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),xw.SUCCESS)})()}getClockCircleClasses(){const e=["base"];return this.callTheClock&&e.push("selected-stroke"),this.getCurrentPlayer()===bZ.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}getSquareClasses(e,t){const n=new HW(e,t),r=["base"];if(this.rules.node.move.isPresent()){const e=this.rules.node,i=e.move.get();i.coord.equals(n)?r.push("moved-fill"):i.end.equals(n)&&(e.mother.get().gameState.getPieceAt(n)===w0.EMPTY||e.gameState.isInOpponentTerritory(new HW(0,t))?r.push("moved-fill"):r.push("captured-fill"))}return r}onModeCogClick(){this.displayModePanel=!this.displayModePanel}chooseStyle(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}}return e.SPACE_SIZE=100,e.STROKE_WIDTH=8,e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-martian-chess"]],features:[Go],decls:14,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,z0,3,3,"g",1),fa(2,"g",2),Ea("click",function(){return t.onClockClick()}),ga(3,"rect",3),ga(4,"circle",4),la(5,H0,2,5,"text",5),la(6,G0,1,2,"polyline",6),pa(),fa(7,"g",7),fa(8,"g",8),Ea("click",function(){return t.onModeCogClick()}),ga(9,"rect",3),ga(10,"path",9),pa(),la(11,W0,3,5,"g",10),pa(),fa(12,"g",11),la(13,e2,3,3,"g",1),pa(),pa()),2&e&&(ra("viewBox",t.LEFT+" "+t.UP+" "+t.WIDTH+" "+t.HEIGHT)("transform",t.rotation),ks(1),ha("ngForOf",t.board),ks(1),ra("transform","translate("+5.25*t.SPACE_SIZE+", 0)"),ks(1),ra("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),ks(1),ha("ngClass",t.getClockCircleClasses()),ra("cx",.5*t.SPACE_SIZE)("cy",.5*t.SPACE_SIZE)("r",.4*t.SPACE_SIZE),ks(1),ha("ngIf",t.countDown.isPresent()),ks(1),ha("ngIf",t.countDown.isAbsent()),ks(1),ra("transform",t.configViewTranslation),ks(2),ra("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),ks(1),ha("ngClass",t.getPlayerClass(t.getCurrentPlayer())),ra("transform",t.configCogTransformation),ks(1),ha("ngIf",t.displayModePanel),ks(2),ha("ngForOf",t.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();const n2=Number.MAX_SAFE_INTEGER,r2=Number.MIN_SAFE_INTEGER;class i2 extends ij{constructor(e,t){super(AZ.copyBiArray(i2.initialBoard),e),this.turn=e,this.location=t}static getInitialState(){return new i2(0,new HW(0,0))}}i2.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],i2.BOARD_1=[[0,+n2,-1,-1],[1,2,+n2,-1],[+r2,3,4,-1],[-1,+r2,+r2,-1]],i2.BOARD_2=[[0,+n2,-1,-1],[+n2,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],i2.BOARD_3=[[0,1,+r2,-1],[1,+r2,-1,-1],[+r2,-1,-1,-1],[-1,-1,-1,-1]],i2.BOARD_4=[[0,1,+r2,-1],[1,+r2,-1,-1],[+r2,-1,-1,-1],[-1,-1,-1,1]],i2.initialBoard=i2.BOARD_0;class s2 extends gj{static getGameStatus(e){const t=e.gameState,n=t.getPieceAt(t.location);return n===bZ.ZERO.getVictoryValue()?pj.ZERO_WON:n===bZ.ONE.getVictoryValue()?pj.ONE_WON:t.location.equals(new HW(3,3))?0===n?pj.DRAW:n>0?pj.ONE_WON:pj.ZERO_WON:pj.ONGOING}applyLegalMove(e,t,n){const r=new HW(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new i2(t.turn+1,r)}isLegal(e,t){const n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?Mw.failure("incorrect move"):Mw.success(void 0)}getGameStatus(e){return s2.getGameStatus(e)}}class o2 extends oj{constructor(e){super(),this.right=e}equals(e){return this===e||this.right===e.right}toString(){return this.right?"Move RIGHT":"Move DOWN"}}o2.RIGHT=new o2(!0),o2.DOWN=new o2(!1),o2.encoder=new class extends PZ{maxValue(){return 1}decodeNumber(e){return 0===e?o2.RIGHT:o2.DOWN}encodeNumber(e){return e.right?0:1}};class a2 extends JW{getBoardValue(e){const t=s2.getGameStatus(e);if(t.isEndGame)return new ej(t.toBoardValue());const n=e.gameState;return new ej(n.getPieceAt(n.location))}getListMoves(e){const t=[],n=e.gameState;return n.location.x<3&&t.push(o2.RIGHT),n.location.y<3&&t.push(o2.DOWN),t}}function l2(e,t){1&e&&(ma(0),Qa(1,"("),ya())}function c2(e,t){1&e&&(ma(0),Qa(1,")"),ya())}function u2(e,t){if(1&e&&(fa(0,"td"),la(1,l2,2,0,"ng-container",3),Qa(2),la(3,c2,2,0,"ng-container",3),pa()),2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();ks(1),ha("ngIf",i.coord.x===n&&i.coord.y===r),ks(1),Ja(" ",e," "),ks(1),ha("ngIf",i.coord.x===n&&i.coord.y===r)}}function h2(e,t){if(1&e&&(fa(0,"tr"),la(1,u2,4,3,"td",0),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}let d2=(()=>{class e extends eY{constructor(e){super(e),this.coord=new HW(-1,-1),this.rules=new s2(i2),this.availableMinimaxes=[new a2(this.rules,"MinimaxTestingMinimax")],this.encoder=o2.encoder}chooseRight(){var e=this;return Sw(function*(){const t=e.canUserPlay("#click_right");return t.isFailure()?e.cancelMove(t.getReason()):e.chooseMove(o2.RIGHT,e.getState())})()}chooseDown(){var e=this;return Sw(function*(){const t=e.canUserPlay("#click_down");return t.isFailure()?e.cancelMove(t.getReason()):e.chooseMove(o2.DOWN,e.getState())})()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.coord=e.location}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-minimax-testing"]],features:[Go],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(fa(0,"table"),la(1,h2,2,1,"tr",0),fa(2,"div",1),Ea("click",function(){return t.chooseRight()}),Qa(3," goRight "),pa(),fa(4,"div",2),Ea("click",function(){return t.chooseDown()}),Qa(5," goDown "),pa(),fa(6,"div"),Qa(7),pa(),pa()),2&e&&(ks(1),ha("ngForOf",t.board),ks(6),Ja(" ",t.coord," "))},directives:[Jd,tf],encapsulation:2}),e})();class f2 extends ij{static getInitialState(){const e=AZ.createTable(7,6,OZ.NONE);return new f2(e,0)}}class p2 extends oj{constructor(e){super(),this.x=e}static of(e){switch(e){case 0:return p2.ZERO;case 1:return p2.ONE;case 2:return p2.TWO;case 3:return p2.THREE;case 4:return p2.FOUR;case 5:return p2.FIVE;case 6:return p2.SIX;default:throw new Error("Invalid P4Move")}}equals(e){return this===e}toString(){return"P4Move("+this.x+")"}}p2.ZERO=new p2(0),p2.ONE=new p2(1),p2.TWO=new p2(2),p2.THREE=new p2(3),p2.FOUR=new p2(4),p2.FIVE=new p2(5),p2.SIX=new p2(6),p2.encoder=new class extends PZ{maxValue(){return 6}encodeNumber(e){return e.x}decodeNumber(e){return p2.of(e)}};let g2=(()=>{class e{}return e.COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`,e})(),m2=(()=>{class e extends gj{static getVictoriousCoords(t){const n=[];for(let r=0;r<7;r++)for(let i=5;-1!==i&&t.board[i][r].isPlayer();i--){const s=e.getSquareScore(t.board,new HW(r,i));(s===bZ.ZERO.getVictoryValue()||s===bZ.ONE.getVictoryValue())&&n.push(new HW(r,i))}return n}static getBoardValueFromScratch(t){Ow(e.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:t}});let n=0;for(let r=0;r<7;r++)for(let i=5;-1!==i&&t.board[i][r].isPlayer();i--){const s=e.getSquareScore(t.board,new HW(r,i));if(fj.getScoreStatus(s)!==cj.DEFAULT)return Ow(e.VERBOSE,{preVictoryOrVictory:{state:t,tmpScore:s,coord:{x:r,y:i}}}),new ej(s);n+=s}return new ej(n)}static getLowestUnoccupiedSpace(e,t){let n=0;for(;n<6&&e[n][t]===OZ.NONE;)n++;return n-1}static getNumberOfFreeSpacesAndAllies(e,t,n,r,i){let s=0,o=0,a=!0,l=new HW(t.x+n.x,t.y+n.y);for(;l.isInRange(7,6)&&3!==s;){const t=e[l.y][l.x];if(t===r)return[s,o];t===i&&a?o++:a=!1,t!==r&&t!==i&&s++,l=l.getNext(n)}return[s,o]}static getOpponent(e,t){const n=e[t.y][t.x];return cZ(n.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),n===bZ.ONE?bZ.ZERO:bZ.ONE}static getSquareScore(t,n){Ow(e.VERBOSE,"getSquareScore(board, "+n.x+", "+n.y+") called"),Ow(e.VERBOSE,t);let r=0;const i=e.getOpponent(t,n),s=i.getOpponent(),o=new uj,a=new uj;for(const l of VW.DIRECTIONS){const r=e.getNumberOfFreeSpacesAndAllies(t,n,l,i,s);o.set(l,r[0]),a.set(l,r[1])}for(const l of[VW.UP,VW.UP_RIGHT,VW.RIGHT,VW.DOWN_RIGHT]){const i=a.get(l).get()+a.get(l.getOpposite()).get();if(i>2)return Ow(e.VERBOSE,{text:"there is some kind of victory here ("+n.x+", "+n.y+")\nline allies : "+i+"\n",board:t}),s.getVictoryValue();const c=o.get(l).get()+o.get(l.getOpposite()).get();3===c?r+=2:c>3&&(r+=c-2)}return r*s.getScoreModifier()}static getListMoves(t){Ow(e.VERBOSE,{context:"P4Rules.getListMoves",node:t});const n=t.gameState,r=[];for(let e=0;e<7;e++)if(n.getPieceAtXY(e,0)===OZ.NONE){const t=p2.of(e);r.push(t)}return r}static getBoardValue(t){return Ow(e.VERBOSE,{text:"P4Rules.getBoardValue called",board:t.getCopiedBoard()}),e.getBoardValueFromScratch(t)}applyLegalMove(t,n,r){const i=t.x,s=n.getCopiedBoard(),o=e.getLowestUnoccupiedSpace(s,i),a=n.turn;return s[o][i]=n.getCurrentPlayer(),new f2(s,a+1)}isLegal(t,n){return Ow(e.VERBOSE,{context:"P4Rules.isLegal",move:t.toString(),state:n}),n.getPieceAtXY(t.x,0).isPlayer()?Mw.failure(g2.COLUMN_IS_FULL()):Mw.success(void 0)}getGameStatus(t){const n=t.gameState;for(let r=0;r<7;r++)for(let t=5;t>=0&&n.board[t][r].isPlayer();t--){const i=e.getSquareScore(n.board,new HW(r,t));if(fj.getScoreStatus(i)===cj.VICTORY)return pj.getVictory(n.getCurrentOpponent())}return 42===n.turn?pj.DRAW:pj.ONGOING}}return e.VERBOSE=!1,e})();class y2 extends JW{getListMoves(e){return m2.getListMoves(e)}getBoardValue(e){const t=e.gameState;return Ow(m2.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),m2.getBoardValue(t)}}const v2=OZ.NONE,C2=OZ.ZERO,_2=OZ.ONE;class E2{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,f2.getInitialState()),Cj.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,f2.getInitialState(),p2.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),Cj.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new f2([[v2,v2,v2,v2,v2,v2,v2],[v2,v2,v2,v2,v2,v2,v2],[v2,v2,v2,v2,v2,v2,v2],[v2,v2,v2,_2,v2,v2,v2],[v2,v2,v2,_2,v2,v2,v2],[v2,v2,C2,C2,C2,_2,v2]],0),[p2.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),Cj.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new f2([[v2,v2,v2,v2,v2,v2,v2],[v2,v2,v2,v2,v2,v2,v2],[v2,v2,v2,v2,v2,v2,v2],[v2,v2,v2,C2,_2,v2,v2],[v2,v2,C2,C2,_2,v2,v2],[v2,C2,_2,C2,C2,v2,v2]],0),[p2.of(3),p2.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}}function w2(e,t){if(1&e&&(_n(),ga(0,"circle",8)),2&e){const e=Sa().index,t=Sa().index,n=Sa();ha("ngClass",n.getSquareFillClass(e,t)),ra("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}function P2(e,t){if(1&e){const e=va();_n(),fa(0,"g",5),Ea("click",function(){const t=Gt(e).index;return Sa(2).onClick(t)}),ga(1,"rect",6),la(2,w2,1,4,"circle",7),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();ka("id","click_",n,""),ks(1),ra("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),ks(1),ha("ngIf",e!==i.EMPTY)}}function S2(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,P2,3,6,"g",4),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function b2(e,t){if(1&e&&(_n(),ga(0,"rect",9)),2&e){const e=Sa();ra("x",e.SPACE_SIZE*e.last.get().x)("y",e.SPACE_SIZE*e.last.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function O2(e,t){if(1&e&&(_n(),ga(0,"rect",10)),2&e){const e=t.$implicit,n=Sa();Ta("id","victory_coord_",e.x,"_",e.y,""),ra("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let k2=(()=>{class e extends eY{constructor(e){super(e),this.EMPTY=OZ.NONE,this.victoryCoords=[],this.rules=new m2(f2),this.availableMinimaxes=[new y2(this.rules,"P4Minimax")],this.encoder=p2.encoder,this.tutorial=(new E2).tutorial,this.updateBoard()}onClick(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#click_"+e);if(n.isFailure())return t.cancelMove(n.getReason());const r=p2.of(e);return yield t.chooseMove(r,t.getState())})()}updateBoard(){const e=this.getState(),t=this.rules.node.move;this.victoryCoords=m2.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.getState(),t=this.rules.node.move,n=m2.getLowestUnoccupiedSpace(e.board,t.get().x)+1;this.last=Aw.of(new HW(t.get().x,n))}hideLastMove(){this.last=Aw.empty()}getSquareFillClass(e,t){return[this.getPlayerClass(this.board[t][e])]}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-p4"]],features:[Go],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,S2,2,1,"g",1),la(2,b2,1,4,"rect",2),la(3,O2,1,6,"rect",3),pa()),2&e&&(ks(1),ha("ngForOf",t.board),ks(1),ha("ngIf",t.last.isPresent()),ks(1),ha("ngForOf",t.victoryCoords))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class T2 extends aj{constructor(e,t,n,r=!1){if(super(e,t),this.blockTurned=n,this.turnedClockwise=r,this.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+this.coord.toString())}static withRotation(e,t,n,r){if(n<0||3<n)throw new Error("This block do not exist: "+n);return new T2(e,t,Aw.of(n),r)}static rotationless(e,t){return new T2(e,t,Aw.empty())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}T2.encoder=new class extends wZ{encodeMove(e){const t={coord:HW.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}decodeMove(e){const t=e,n=HW.encoder.decode(t.coord),r=Aw.ofNullable(t.blockTurned);if(r.isPresent()){const e=t.turnedClockwise;return T2.withRotation(n.x,n.y,r.get(),e)}return T2.rotationless(n.x,n.y)}};let I2=(()=>{class e{}return e.CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`,e.MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`,e})();class A2 extends ij{constructor(e,t){super(e,t),this.neutralBlocks=this.getBlocksNeutralities()}static getInitialState(){const e=AZ.createTable(6,6,OZ.NONE);return new A2(e,0)}getBlocksNeutralities(){const e=[];for(let t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}getBlockNeutrality(e){const t=A2.getBlockCenter(e),n=this.getPieceAt(t.getNext(VW.UP,1)),r=this.getPieceAt(t.getNext(VW.UP_LEFT,1));return this.getPieceAt(t.getNext(VW.RIGHT,1))===n&&this.getPieceAt(t.getNext(VW.DOWN,1))===n&&this.getPieceAt(t.getNext(VW.LEFT,1))===n&&this.getPieceAt(t.getNext(VW.UP_RIGHT,1))===r&&this.getPieceAt(t.getNext(VW.DOWN_RIGHT,1))===r&&this.getPieceAt(t.getNext(VW.DOWN_LEFT,1))===r}static getBlockCenter(e){return new HW(1+(e%2==0?0:3),1+(e<2?0:3))}applyLegalDrop(e){const t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new A2(t,this.turn)}applyLegalMove(e){const t=this.applyLegalDrop(e),n=t.getCopiedBoard();if(e.blockTurned.isPresent()){const r=A2.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise)for(const e of A2.ROTATION_MAP){const i=e[0].getNext(r),s=e[1].getNext(r),o=t.getPieceAt(i);n[s.y][s.x]=o}else for(const e of A2.ROTATION_MAP){const i=e[1].getNext(r),s=e[0].getNext(r),o=t.getPieceAt(i);n[s.y][s.x]=o}}return new A2(n,this.turn+1)}blockIsNeutral(e){return this.neutralBlocks.includes(e)}}A2.ROTATION_MAP=[[new HW(-1,-1),new HW(1,-1)],[new HW(0,-1),new HW(1,0)],[new HW(1,-1),new HW(1,1)],[new HW(1,0),new HW(0,1)],[new HW(1,1),new HW(-1,1)],[new HW(0,1),new HW(-1,0)],[new HW(-1,1),new HW(-1,-1)],[new HW(-1,0),new HW(0,-1)]];class M2 extends gj{static get(){return M2.singleton.isAbsent()&&(M2.singleton=Aw.of(new M2(A2))),M2.singleton.get()}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){if(t.getPieceAt(e.coord).isPlayer())return Mw.failure(XW.MUST_LAND_ON_EMPTY_SPACE());const n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return Mw.failure(I2.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){const t=e.blockTurned.get();if(n.neutralBlocks.includes(t))return Mw.failure(I2.CANNOT_ROTATE_NEUTRAL_BLOCK())}return Mw.success(void 0)}getVictoryCoords(e){let t=[];for(const n of M2.VICTORY_SOURCE){const r=e.getPieceAt(n[0]),i=[n[0]];if(r.isPlayer()){let s=n[0].getNext(n[1]),o=!0;for(let t=0;t<3&&o;t++)e.getPieceAt(s)!==r?o=!1:(i.push(s),s=s.getNext(n[1]));if(o&&(e.getPieceAt(s)===r&&(i.push(s),t=t.concat(i)),n[2])){const s=n[0].getPrevious(n[1],1);e.getPieceAt(s)===r&&(i.push(s),t=t.concat(i))}}}return t}getGameStatus(e){const t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1];for(let i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?pj.DRAW:pj.ZERO_WON:!0===r[1]?pj.ONE_WON:36===t.turn?pj.DRAW:pj.ONGOING}}M2.singleton=Aw.empty(),M2.VICTORY_SOURCE=[[new HW(1,0),new LW(1,1),!1],[new HW(0,1),new LW(1,1),!1],[new HW(4,0),new LW(-1,1),!1],[new HW(5,1),new LW(-1,1),!1],[new HW(1,1),new LW(1,1),!0],[new HW(4,1),new LW(-1,1),!0],[new HW(0,1),new LW(0,1),!0],[new HW(1,1),new LW(0,1),!0],[new HW(2,1),new LW(0,1),!0],[new HW(3,1),new LW(0,1),!0],[new HW(4,1),new LW(0,1),!0],[new HW(5,1),new LW(0,1),!0],[new HW(1,0),new LW(1,0),!0],[new HW(1,1),new LW(1,0),!0],[new HW(1,2),new LW(1,0),!0],[new HW(1,3),new LW(1,0),!0],[new HW(1,4),new LW(1,0),!0],[new HW(1,5),new LW(1,0),!0]];class N2 extends JW{getListMoves(e){const t=[],n=e.gameState.neutralBlocks;if(0===e.gameState.turn)return N2.FIRST_TURN_MOVES;const r=this.getLegalDrops(e.gameState);for(const i of r){const r=T2.rotationless(i.x,i.y),s=e.gameState.applyLegalDrop(r),o=this.getLegalRotations(s,n);for(const e of o)t.push(T2.withRotation(i.x,i.y,e[0],e[1]));0===s.neutralBlocks.length==0&&t.push(r)}return t}getLegalDrops(e){const t=[];for(let n=0;n<6;n++)for(let r=0;r<6;r++){const i=new HW(r,n);e.getPieceAt(i)===OZ.NONE&&t.push(i)}return t}getLegalRotations(e,t){const n=0===e.neutralBlocks.length,r=[];for(let i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}getBoardValue(e){return new ej(M2.get().getGameStatus(e).toBoardValue())}}N2.FIRST_TURN_MOVES=[T2.rotationless(0,0),T2.rotationless(1,0),T2.rotationless(2,0),T2.rotationless(0,1),T2.rotationless(1,1),T2.rotationless(0,2)];const R2=OZ.NONE,x2=OZ.ZERO,D2=OZ.ONE;class L2{constructor(){this.tutorial=[Cj.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,A2.getInitialState()),Cj.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new A2([[x2,R2,R2,x2,D2,R2],[x2,D2,R2,R2,R2,R2],[x2,R2,D2,R2,R2,R2],[x2,R2,R2,R2,R2,D2],[x2,R2,R2,R2,D2,R2],[R2,R2,R2,R2,R2,R2]],10)).withPreviousMove(T2.withRotation(0,0,0,!1)),Cj.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        Do it.`,new A2([[R2,R2,R2,R2,R2,R2],[R2,x2,R2,R2,D2,R2],[R2,R2,R2,R2,R2,R2],[R2,R2,R2,R2,R2,R2],[R2,D2,R2,R2,x2,R2],[R2,R2,R2,R2,R2,R2]],10),T2.rotationless(2,2),(e,t,n)=>e.blockTurned.isPresent()?xw.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):xw.SUCCESS,$localize`Congratulations!`),Cj.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        Click on one of them and see the rotation!`,new A2([[R2,R2,R2,R2,R2,R2],[R2,x2,R2,R2,D2,R2],[R2,R2,R2,R2,R2,R2],[R2,R2,R2,R2,R2,R2],[R2,D2,R2,R2,x2,R2],[R2,R2,R2,R2,R2,R2]],10),T2.withRotation(0,0,0,!0),(e,t,n)=>e.blockTurned.isPresent()?xw.SUCCESS:xw.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}}function F2(e,t){if(1&e){const e=va();_n(),ma(0),fa(1,"circle",9),Ea("click",function(){const t=Gt(e).$implicit,n=Sa().$implicit,r=Sa().index,i=Sa().index;return Sa().onClick(3*r+t,3*i+n)}),pa(),ya()}if(2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa(),i=r.index,s=r.$implicit,o=Sa(),a=o.index,l=o.$implicit,c=Sa();ks(1),Ta("id","click_",3*i+e,"_",3*a+n,""),ha("ngClass",c.getSquareClasses(3*i+e,3*a+n)),ra("cx",s+2*c.STROKE_WIDTH+(e+.5)*c.SPACE_SIZE)("cy",l+2*c.STROKE_WIDTH+(n+.5)*c.SPACE_SIZE)("r",(c.SPACE_SIZE-c.STROKE_WIDTH)/2)}}const U2=function(){return[0,1,2]};function V2(e,t){1&e&&(_n(),ma(0),la(1,F2,2,6,"ng-container",3),ya()),2&e&&(ks(1),ha("ngForOf",wu(1,U2)))}function B2(e,t){if(1&e&&(_n(),ma(0),ga(1,"rect",8),la(2,V2,2,2,"ng-container",3),ya()),2&e){const e=t.$implicit,n=t.index,r=Sa(),i=r.index,s=r.$implicit,o=Sa();ks(1),ha("ngClass",o.getBlockClasses(n,i)),ra("x",o.STROKE_WIDTH+e)("y",o.STROKE_WIDTH+s)("rx",3*o.STROKE_WIDTH)("ry",3*o.STROKE_WIDTH)("width",o.BLOCK_WIDTH)("height",o.BLOCK_WIDTH),ks(1),ha("ngForOf",wu(8,U2))}}const $2=function(e){return[0,e]};function z2(e,t){if(1&e&&(_n(),ma(0),la(1,B2,3,9,"ng-container",3),ya()),2&e){const e=Sa();ks(1),ha("ngForOf",Pu(1,$2,e.BLOCK_SEPARATION))}}function H2(e,t){if(1&e&&(_n(),ga(0,"circle",10)),2&e){const e=Sa();Ta("id","currentDrop_",e.currentDrop.get().x,"_",e.currentDrop.get().y,""),ha("ngClass",e.getPlayerClass(e.getCurrentPlayer())),ra("cx",e.getCenter(e.currentDrop.get().x))("cy",e.getCenter(e.currentDrop.get().y))("r",(e.SPACE_SIZE-e.STROKE_WIDTH)/2)}}function G2(e,t){if(1&e){const e=va();_n(),fa(0,"path",11),Ea("click",function(){const t=Gt(e).$implicit;return Sa().rotate(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa();Ta("id","rotate_",e[1],"_",e[2]?"clockwise":"counterclockwise",""),ra("d",e[0])("stroke-width",2*n.STROKE_WIDTH)}}function Z2(e,t){if(1&e&&(_n(),ga(0,"circle",12)),2&e){const e=t.$implicit,n=Sa();Ta("id","victoryCoord_",e.x,"_",e.y,""),ha("ngClass",n.getSquareClasses(e.x,e.y)),ra("cx",n.getCenter(e.x))("cy",n.getCenter(e.y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)("stroke-width",n.STROKE_WIDTH)}}function q2(e,t){if(1&e){const e=va();_n(),fa(0,"g",13),Ea("click",function(){return Gt(e),Sa().skipRotation()}),ga(1,"circle",14),ga(2,"line",15),pa()}if(2&e){const e=Sa();ks(1),ra("cx",e.BLOCK_SEPARATION)("cy",e.BLOCK_SEPARATION)("r",.75*e.SPACE_SIZE)("stroke-width",2*e.STROKE_WIDTH),ks(1),ra("x1",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("y1",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("x2",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("y2",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("stroke-width",2*e.STROKE_WIDTH)}}let W2=(()=>{class e extends eY{constructor(e){super(e),this.arrows=[],this.victoryCoords=[],this.rules=new M2(A2),this.availableMinimaxes=[new N2(this.rules,"PentagoMinimax")],this.encoder=T2.encoder,this.tutorial=(new L2).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.showLastMove()}showLastMove(){const e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{const t=e.get();this.movedBlock=t.blockTurned;const n=new HW(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new HW(0,0))&&this.coordBelongToBlock(t)){let e;e=t.turnedClockwise?bw.getNonNullable(A2.ROTATION_MAP.find(e=>e[0].equals(n)))[1]:bw.getNonNullable(A2.ROTATION_MAP.find(e=>e[1].equals(n)))[0];const r=t.blockTurned.get();e=e.getNext(new LW(r%2==0?1:4,r<2?1:4),1),this.lastDrop=Aw.of(e)}else this.lastDrop=Aw.of(t.coord)}}coordBelongToBlock(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=Aw.empty(),this.movedBlock=Aw.empty(),this.victoryCoords=[]}generateArrowsCoord(){const e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=Aw.empty(),this.canSkipRotation=!1}onClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(n.board[t][e].isPlayer())return n.cancelMove(XW.MUST_LAND_ON_EMPTY_SPACE());const i=T2.rotationless(e,t),s=n.getState(),o=s.applyLegalDrop(i);if(4===o.neutralBlocks.length)return n.chooseMove(i,s);const a=n.rules.getGameStatus(n.rules.node);return n.canSkipRotation=o.neutralBlocks.length>0&&!1===a.isEndGame,n.currentDrop=Aw.of(new HW(e,t)),n.displayArrows(o.neutralBlocks),xw.SUCCESS})()}getCenter(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}displayArrows(e){this.arrows=[];for(let t=0;t<4;t++)if(!1===e.includes(t)){const e=this.ARROWS.filter(e=>e[1]===t);this.arrows=this.arrows.concat(e)}}getBlockClasses(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved-fill"]:[]}getSquareClasses(e,t){const n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new HW(e,t))&&n.push("last-move-stroke"),n}rotate(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"));if(n.isFailure())return t.cancelMove(n.getReason());const r=t.currentDrop.get(),i=T2.withRotation(r.x,r.y,e[1],e[2]);return t.chooseMove(i,t.getState())})()}skipRotation(){var e=this;return Sw(function*(){const t=e.canUserPlay("#skipRotation");if(t.isFailure())return e.cancelMove(t.getReason());const n=e.currentDrop.get(),r=T2.rotationless(n.x,n.y);return e.chooseMove(r,e.getState())})()}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-pentago"]],features:[Go],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"defs"),fa(2,"marker",1),ga(3,"polygon",2),pa(),pa(),la(4,z2,2,3,"ng-container",3),la(5,H2,1,6,"circle",4),la(6,G2,1,4,"path",5),la(7,Z2,1,7,"circle",6),la(8,q2,3,9,"g",7),pa()),2&e&&(ks(4),ha("ngForOf",Pu(5,$2,t.BLOCK_SEPARATION)),ks(1),ha("ngIf",t.currentDrop.isPresent()),ks(1),ha("ngForOf",t.arrows),ks(1),ha("ngForOf",t.victoryCoords),ks(1),ha("ngIf",t.canSkipRotation))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class j2 extends HW{constructor(e,t,n){if(super(e,t),this.z=n,e<0||e>3)throw new Error(`PylosCoord: Invalid X: ${e}.`);if(t<0||t>3)throw new Error(`PylosCoord: Invalid Y: ${t}.`);if(n<0||n>3)throw new Error(`PylosCoord: Invalid Z: ${n}.`);const r=4-n;if(this.isNotInRange(r,r))throw new Error(this.toString()+" is not in range.")}static encodeOptional(e){let t;return t=e.isPresent()?j2.encode(e.get())+1:0,t}static encode(e){return 16*e.x+4*e.y+e.z}static decodeToOptional(e){return 0===e?Aw.empty():Aw.of(j2.decode(e-1))}static decode(e){const t=e%4;e-=t;const n=(e/=4)%4;return e-=n,new j2(e/=4,n,t)}toString(){return"PylosCoord"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}isUpperThan(e){return this.z>e.z}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const e=this.z-1;return[new j2(this.x,this.y,e),new j2(this.x+1,this.y,e),new j2(this.x,this.y+1,e),new j2(this.x+1,this.y+1,e)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const e=this.z+1,t=new HW(this.x-1,this.y-1),n=new HW(this.x,this.y-1),r=new HW(this.x-1,this.y),i=new HW(this.x,this.y),s=4-e;return[t,n,r,i].filter(e=>e.isInRange(s,s)).map(t=>new j2(t.x,t.y,e))}getNextValid(e){const t=new HW(this.x,this.y).getNext(e),n=4-this.z;return t.isNotInRange(n,n)?Aw.empty():Aw.of(new j2(t.x,t.y,this.z))}}let Y2=(()=>{class e{}return e.MUST_CAPTURE_MAXIMUM_TWO_PIECES=()=>$localize`You must capture one or two pieces, not more.`,e})();class K2 extends oj{constructor(e,t,n,r){super(),this.startingCoord=e,this.landingCoord=t,this.firstCapture=n,this.secondCapture=r}static fromClimb(e,t,n){const r=Aw.of(e),i=K2.checkCaptures(n),s=new K2(r,t,i.firstCapture,i.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return s}static checkCaptures(e){let t=Aw.empty(),n=Aw.empty();if(e.length>0&&(t=Aw.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=Aw.of(e[1]),e[1].isUpperThan(e[0])&&(t=Aw.of(e[1]),n=Aw.of(e[0])),e.length>2)throw new Error(Y2.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:n}}static fromDrop(e,t){const n=Aw.empty(),r=K2.checkCaptures(t);return new K2(n,e,r.firstCapture,r.secondCapture)}static changeCapture(e,t){const n=K2.checkCaptures(t);return new K2(e.startingCoord,e.landingCoord,n.firstCapture,n.secondCapture)}isClimb(){return this.startingCoord.isPresent()}toString(){const e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}equals(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}K2.encoder=new class extends PZ{maxValue(){return 17575999}encodeNumber(e){const t=j2.encode(e.landingCoord),n=j2.encodeOptional(e.startingCoord),r=j2.encodeOptional(e.firstCapture);return 270400*j2.encodeOptional(e.secondCapture)+4160*r+64*n+t}decodeNumber(e){const t=j2.decode(e%64);e-=e%64;const n=j2.decodeToOptional((e/=64)%65);e-=e%65;const r=j2.decodeToOptional((e/=65)%65);e-=e%65;const i=j2.decodeToOptional(e/=65);return new K2(n,t,r,i)}};class Q2 extends rj{constructor(e,t){super(t),this.boards=e}static getInitialState(){const e=AZ.createTable(4,4,OZ.NONE),t=AZ.createTable(3,3,OZ.NONE),n=AZ.createTable(2,2,OZ.NONE);return new Q2([e,t,n,[[OZ.NONE]]],0)}static getLevelRange(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return bw.expectToBe(e,2),[0,1]}}getPieceAt(e){return this.boards[e.z][e.y][e.x]}applyLegalMove(e,t=!0){const n=[];let r;return n.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&n.push({coord:e.startingCoord.get(),value:OZ.NONE}),e.firstCapture.isPresent()&&n.push({coord:e.firstCapture.get(),value:OZ.NONE}),e.secondCapture.isPresent()&&n.push({coord:e.secondCapture.get(),value:OZ.NONE}),r=t?this.turn+1:this.turn,this.setBoardAtCoords(n,r)}setBoardAtCoords(e,t){const n=[AZ.copyBiArray(this.boards[0]),AZ.copyBiArray(this.boards[1]),AZ.copyBiArray(this.boards[2]),AZ.copyBiArray(this.boards[3])];for(const r of e){const e=r.coord;n[e.z][e.y][e.x]=r.value}return new Q2(n,t)}isLandable(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;const t=e.getLowerPieces();for(const n of t)if(this.getPieceAt(n)===OZ.NONE)return!1;return!0}isSupporting(e){if(3===e.z)return!1;const t=e.getHigherCoords();for(const n of t)if(this.getPieceAt(n).isPlayer())return!0;return!1}getPiecesRepartition(){const e={};e[OZ.NONE.value]=0,e[bZ.ZERO.value]=0,e[bZ.ONE.value]=0;for(let t=0;t<3;t++)for(let n=0;n<4-t;n++)for(let r=0;r<4-t;r++){const i=new j2(r,n,t),s=this.getPieceAt(i);e[s.value]=1+e[s.value]}return e}removePieceAt(e){return this.setBoardAtCoords([{coord:e,value:OZ.NONE}],this.turn)}dropCurrentPlayersPieceAt(e){const t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}getFreeToMoves(){const e=[],t=this.getCurrentPlayer();for(let n=0;n<=2;n++){const r=Q2.getLevelRange(n);for(const i of r)for(const s of r){const r=new j2(s,i,n);this.getPieceAt(r).equals(t)&&!1===this.isSupporting(r)&&e.push(r)}}return e}}let X2=(()=>{class e{}return e.MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`,e.SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`,e.CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`,e.CANNOT_CAPTURE=()=>$localize`You cannot capture.`,e.INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`,e.INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`,e})();class J2 extends gj{static getStateInfo(e){const t=[],n=[];for(let r=0;r<3;r++)for(let i=0;i<4-r;i++)for(let s=0;s<4-r;s++){const o=new j2(s,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}static getClimbingMoves(e){const t=[];for(const n of e.freeToMove)for(const r of e.landable)if(r.isUpperThan(n)&&!1===r.getLowerPieces().some(e=>n.equals(e))){const e=K2.fromClimb(n,r,[]);t.push(e)}return t}static getDropMoves(e){const t=[];for(const n of e.landable){const e=K2.fromDrop(n,[]);t.push(e)}return t}static canCapture(e,t){const n=e.getCurrentPlayer();for(const r of[BW.UP,BW.DOWN]){const i=t.getNextValid(r);if(i.isPresent()&&e.getPieceAt(i.get())===n)for(const t of[BW.LEFT,BW.RIGHT]){const s=i.get().getNextValid(t);if(s.isPresent()&&e.getPieceAt(s.get())===n){const t=r.getOpposite(),i=s.get().getNextValid(t).get();if(e.getPieceAt(i)===n)return!0}}}return!1}static getPossibleCaptures(e){const t=new nj,n=e.getFreeToMoves();for(const r of n){t.add(new nj([r]));const n=e.removePieceAt(r).getFreeToMoves();for(const e of n){const n=new nj([r,e]);t.add(n)}}return t}static applyLegalMove(e,t,n){return t.applyLegalMove(e)}static isValidCapture(e,t,n){const r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r)&&0===n.getHigherCoords().filter(n=>e.getPieceAt(n).isPlayer()&&!1===n.equals(t.firstCapture.get())).length}static getGameStatus(e){const t=e.gameState.getPiecesRepartition();return 15===t[bZ.ZERO.value]?pj.ONE_WON:15===t[bZ.ONE.value]?pj.ZERO_WON:pj.ONGOING}applyLegalMove(e,t,n){return J2.applyLegalMove(e,t,n)}isLegal(e,t){const n=this.isLegalStartingCoord(e,t);if(n.isFailure())return Mw.failure(n.getReason());const r=n.get(),i=this.isLegalLandingCoord(e,r);if(i.isFailure())return Mw.failure(i.getReason());const s=i.get(),o=this.isLegalCaptures(e,s);return o.isFailure()?o:Mw.success(void 0)}isLegalStartingCoord(e,t){const n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){const r=e.startingCoord.get(),i=t.getPieceAt(r);if(i===n)return Mw.failure(XW.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===OZ.NONE)return Mw.failure(XW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===r.getHigherCoords().filter(e=>t.getPieceAt(e).isPlayer()).length){const n=t.removePieceAt(e.startingCoord.get());return Mw.success(n)}return Mw.failure(X2.CANNOT_MOVE_SUPPORTING_PIECE())}return Mw.success(t)}isLegalLandingCoord(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?Mw.failure(XW.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?Mw.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):Mw.failure(X2.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(e,t){if(e.firstCapture.isAbsent())return Mw.success(void 0);if(!1===J2.canCapture(t,e.landingCoord))return Mw.failure(X2.CANNOT_CAPTURE());if(J2.isValidCapture(t,e,e.firstCapture.get())){const n=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||J2.isValidCapture(n,e,e.secondCapture.get())?Mw.success(void 0):Mw.failure(X2.INVALID_SECOND_CAPTURE())}return Mw.failure(X2.INVALID_FIRST_CAPTURE())}getGameStatus(e){return J2.getGameStatus(e)}}class e3 extends JW{static getListMoves(e){const t=e.gameState,n=[],r=J2.getStateInfo(t),i=J2.getClimbingMoves(r),s=J2.getDropMoves(r),o=i.concat(s);for(const a of o){const e=t.applyLegalMove(a,!1);let r=new nj;J2.canCapture(e,a.landingCoord)?r=J2.getPossibleCaptures(e):n.push(a);for(const t of r){const e=K2.changeCapture(a,t.toList());n.push(e)}}return n}getListMoves(e){return e3.getListMoves(e)}getBoardValue(e){const t=J2.getGameStatus(e);if(t.isEndGame)return new ej(t.toBoardValue());{const t=e.gameState.getPiecesRepartition();return new ej(t[bZ.ZERO.value]-t[bZ.ONE.value])}}}class t3 extends e3{static countStoneUsed(e){let t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}static sumMoveEmplacementByValue(e){let t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}getListMoves(e){const t=e3.getListMoves(e);return this.orderMoves(t)}orderMoves(e){return e.sort((e,t)=>{const n=12*t3.countStoneUsed(e),r=12*t3.countStoneUsed(t);return n+t3.sumMoveEmplacementByValue(e)-(r+t3.sumMoveEmplacementByValue(t))})}}const n3=OZ.NONE,r3=OZ.ZERO,i3=OZ.ONE;class s3{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,Q2.getInitialState()),Cj.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,Q2.getInitialState(),K2.fromDrop(new j2(1,1,0),[]),$localize`There you go, as simple as that.`),Cj.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        Go ahead, climb!`,new Q2([[[r3,i3,n3,n3],[i3,r3,n3,n3],[n3,n3,n3,n3],[n3,n3,n3,r3]],[[n3,n3,n3],[n3,n3,n3],[n3,n3,n3]],[[n3,n3],[n3,n3]],[[n3]]],0),[K2.fromClimb(new j2(3,3,0),new j2(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed!`),Cj.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.
        You're playing Dark.<br/><br/>
        Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new Q2([[[r3,r3,n3,n3],[n3,r3,n3,n3],[n3,n3,n3,n3],[n3,n3,n3,n3]],[[n3,n3,n3],[n3,n3,n3],[n3,n3,n3]],[[n3,n3],[n3,n3]],[[n3]]],0),[K2.fromDrop(new j2(0,1,0),[new j2(0,0,0)]),K2.fromDrop(new j2(0,1,0),[new j2(0,1,0)]),K2.fromDrop(new j2(0,1,0),[new j2(1,0,0)]),K2.fromDrop(new j2(0,1,0),[new j2(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed!`),Cj.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new Q2([[[r3,r3,n3,n3],[n3,r3,n3,n3],[n3,n3,n3,n3],[n3,n3,n3,n3]],[[n3,n3,n3],[n3,n3,n3],[n3,n3,n3]],[[n3,n3],[n3,n3]],[[n3]]],0),K2.fromDrop(new j2(0,1,0),[new j2(0,0,0),new j2(1,0,0)]),(e,t,n)=>e.secondCapture.isPresent()?xw.SUCCESS:e.firstCapture.isPresent()?xw.failure($localize`Failed, you only captured one piece.`):xw.failure(T0.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}}function o3(e,t){if(1&e&&(_n(),ga(0,"circle",8)),2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa();Ta("id","piece_",n.value,"_",e,""),ha("ngClass",r.getPlayerClass(n)),ra("cx",r.SPACE_SIZE/4+e/15*(r.BOARD_WIDTH-r.SPACE_SIZE/4))("cy",r.getPiecesCyForPlayer(n))("r",r.SPACE_SIZE/4-r.STROKE_WIDTH)}}function a3(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,o3,1,6,"circle",7),pa()),2&e){const e=t.$implicit,n=Sa();ks(1),ha("ngForOf",n.getPlayerSidePieces(e))}}function l3(e,t){if(1&e){const e=va();_n(),fa(0,"circle",12),Ea("click",function(){Gt(e);const t=Sa(2).$implicit,n=Sa().$implicit,r=Sa().$implicit;return Sa().onPieceClick(t,n,r)}),pa()}if(2&e){const e=Sa(2).$implicit,t=Sa().$implicit,n=Sa().$implicit,r=Sa();Ia("id","piece_",e,"_",t,"_",n,""),ha("ngClass",r.getPieceClasses(e,t,n)),ra("r",r.getPieceRadius(n)-r.STROKE_WIDTH)("cx",r.getPieceCx(e,t,n))("cy",r.getPieceCy(e,t,n))}}function c3(e,t){if(1&e){const e=va();_n(),fa(0,"rect",12),Ea("click",function(){Gt(e);const t=Sa(2).$implicit,n=Sa().$implicit,r=Sa().$implicit;return Sa().onDrop(t,n,r)}),pa()}if(2&e){const e=Sa(2).$implicit,t=Sa().$implicit,n=Sa().$implicit,r=Sa();Ia("id","drop_",e,"_",t,"_",n,""),ha("ngClass",r.getSquareClasses(e,t,n)),ra("width",2*r.getPieceRadius(n))("height",2*r.getPieceRadius(n))("x",r.getPieceCx(e,t,n)-r.getPieceRadius(n))("y",r.getPieceCy(e,t,n)-r.getPieceRadius(n))}}function u3(e,t){if(1&e&&(_n(),ma(0),la(1,l3,1,7,"circle",10),la(2,c3,1,8,"ng-template",null,11,ju),ya()),2&e){const e=ca(3),t=Sa().$implicit,n=Sa().$implicit,r=Sa().$implicit,i=Sa();ks(1),ha("ngIf",i.isOccupied(t,n,r))("ngIfElse",e)}}function h3(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,u3,4,2,"ng-container",9),pa()),2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa().$implicit,i=Sa();ks(1),ha("ngIf",i.mustDraw(e,n,r))}}function d3(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,h3,2,1,"g",1),pa()),2&e){const e=Sa().$implicit,t=Sa();ks(1),ha("ngForOf",t.getLevelRange(e))}}function f3(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,d3,2,1,"g",1),pa()),2&e){const e=t.$implicit,n=Sa();ks(1),ha("ngForOf",n.getLevelRange(e))}}function p3(e,t){if(1&e&&(_n(),ga(0,"rect",13)),2&e){const e=Sa();Ia("id","highCapture_",e.highCapture.get().x,"_",e.highCapture.get().y,"_",e.highCapture.get().z,""),ra("width",2*e.getPieceRadius(e.highCapture.get().z))("height",2*e.getPieceRadius(e.highCapture.get().z))("x",e.getPieceCxByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))("y",e.getPieceCyByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))}}function g3(e,t){if(1&e){const e=va();_n(),fa(0,"g",14),Ea("click",function(){return Gt(e),Sa().validateCapture()}),ga(1,"circle",15),ga(2,"polygon",16),pa()}if(2&e){const e=Sa();ra("transform","translate("+4*e.SPACE_SIZE+" "+4*e.SPACE_SIZE+")"),ks(1),ha("ngClass",e.getCaptureValidationButtonClasses()),ra("cx",e.STROKE_WIDTH/2)("cy",e.STROKE_WIDTH/2)("r",e.SPACE_SIZE/2)}}function m3(e,t){if(1&e){const e=va();_n(),fa(0,"g",17),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onPieceClick(t.x,t.y,t.z)}),ga(1,"line",18),ga(2,"line",18),pa()}if(2&e){const e=t.$implicit,n=Sa();Ia("id","capturable_",e.x,"_",e.y,"_",e.z,""),ra("transform","translate("+n.getPieceCxByCoord(e)+" "+n.getPieceCyByCoord(e)+")"),ks(1),ra("x1",-.25*n.getPieceRadius(e.z))("y1",-.25*n.getPieceRadius(e.z))("x2",.25*n.getPieceRadius(e.z))("y2",.25*n.getPieceRadius(e.z)),ks(1),ra("x1",.25*n.getPieceRadius(e.z))("y1",-.25*n.getPieceRadius(e.z))("x2",-.25*n.getPieceRadius(e.z))("y2",.25*n.getPieceRadius(e.z))}}const y3=function(){return[0,1,2]};let v3=(()=>{class e extends GW{constructor(e){super(e),this.BOARD_WIDTH=4*this.SPACE_SIZE+this.STROKE_WIDTH,this.PIECE_ROW_HEIGHT=this.SPACE_SIZE/2,this.BOARD_HEIGHT=this.BOARD_WIDTH+2*this.PIECE_ROW_HEIGHT,this.lastLandingCoord=Aw.empty(),this.lastStartingCoord=Aw.empty(),this.lastFirstCapture=Aw.empty(),this.lastSecondCapture=Aw.empty(),this.highCapture=Aw.empty(),this.capturables=[],this.chosenStartingCoord=Aw.empty(),this.chosenLandingCoord=Aw.empty(),this.chosenFirstCapture=Aw.empty(),this.chosenSecondCapture=Aw.empty(),this.lastMove=Aw.empty(),this.remainingPieces={0:15,1:15},this.hasAsymetricBoard=!0,this.rules=new J2(Q2),this.availableMinimaxes=[new e3(this.rules,"PylosMinimax"),new t3(this.rules,"PylosOrderedMinimax")],this.encoder=K2.encoder,this.tutorial=(new s3).tutorial,this.updateBoard()}getPiecesCyForPlayer(e){return e===bZ.ONE?this.PIECE_ROW_HEIGHT/2:this.BOARD_WIDTH+1.5*this.PIECE_ROW_HEIGHT}getLevelRange(e){return Q2.getLevelRange(e)}mustDraw(e,t,n){const r=new j2(e,t,n);return!!(this.constructedState.getPieceAt(r).isPlayer()||this.justClimbed(r)||this.isCaptured(r))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(r)}isCaptured(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}onPieceClick(e,t,n){var r=this;return Sw(function*(){const i=r.canUserPlay("#piece_"+e+"_"+t+"_"+n);if(i.isFailure())return r.cancelMove(i.getReason());const s=new j2(e,t,n);return r.state.getPieceAt(s)===r.state.getCurrentOpponent()?r.cancelMove(XW.CANNOT_CHOOSE_OPPONENT_PIECE()):r.isSupporting(s)?r.cancelMove(X2.CANNOT_MOVE_SUPPORTING_PIECE()):r.chosenStartingCoord.equalsValue(s)?(r.cancelMoveAttempt(),xw.SUCCESS):r.chosenLandingCoord.isAbsent()?r.onClimbClick(s):r.onCaptureClick(s)})()}isSupporting(e){return this.constructedState.isSupporting(e)}onClimbClick(e){var t=this;return Sw(function*(){return t.chosenStartingCoord=Aw.of(e),t.constructedState=t.constructedState.removePieceAt(e),xw.SUCCESS})()}onCaptureClick(e){var t=this;return Sw(function*(){return t.chosenFirstCapture.equalsValue(e)?(t.chosenFirstCapture=Aw.empty(),t.constructedState=t.constructedState.dropCurrentPlayersPieceAt(e),t.updateCapturableList(),xw.SUCCESS):t.chosenSecondCapture.equalsValue(e)?(t.chosenSecondCapture=Aw.empty(),t.constructedState=t.constructedState.dropCurrentPlayersPieceAt(e),t.updateCapturableList(),xw.SUCCESS):t.chosenFirstCapture.isAbsent()?(t.chosenFirstCapture=Aw.of(e),t.constructedState=t.constructedState.removePieceAt(e),t.updateCapturableList(),xw.SUCCESS):t.chosenSecondCapture.isAbsent()?(t.chosenSecondCapture=Aw.of(e),t.constructedState=t.constructedState.removePieceAt(e),t.updateCapturableList(),xw.SUCCESS):t.cancelMove(Y2.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var e=this;return Sw(function*(){const t=e.canUserPlay("#capture_validation");return t.isFailure()?e.cancelMove(t.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?xw.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()])})()}concludeMoveWithCapture(e){var t=this;return Sw(function*(){let n;return n=t.chosenStartingCoord.isAbsent()?K2.fromDrop(t.chosenLandingCoord.get(),e):K2.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(n,t.state)})()}tryMove(e,t){var n=this;return Sw(function*(){return n.cancelMove(),n.chooseMove(e,t)})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=Aw.empty(),this.chosenLandingCoord=Aw.empty(),this.chosenFirstCapture=Aw.empty(),this.chosenSecondCapture=Aw.empty(),this.capturables=[]}onDrop(e,t,n){var r=this;return Sw(function*(){const i=r.canUserPlay("#drop_"+e+"_"+t+"_"+n);if(i.isFailure())return r.cancelMove(i.getReason());const s=new j2(e,t,n);return J2.canCapture(r.constructedState,s)?(r.chosenLandingCoord=Aw.of(s),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(s),r.updateCapturableList(),xw.SUCCESS):r.isCapturelessMoveFinished(s)?(r.chosenLandingCoord=Aw.of(s),r.concludeMoveWithCapture([])):r.cancelMove(X2.MUST_MOVE_UPWARD())})()}isCapturelessMoveFinished(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}getSquareClasses(e,t,n){const r=new j2(e,t,n);if(this.lastMove.isPresent()){const e=this.lastMove.get();if(e.firstCapture.equalsValue(r)||e.secondCapture.equalsValue(r))return["captured-fill"];if(r.equals(e.landingCoord)||e.startingCoord.equalsValue(r))return["moved-fill"]}else if(this.justClimbed(r))return["moved-fill"];return[]}justClimbed(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}getPieceRadius(e){return this.SPACE_SIZE*(.45+.025*e)}getPieceCx(e,t,n){return this.SPACE_SIZE/2+.5*n*this.SPACE_SIZE+e*this.SPACE_SIZE}getPieceCy(e,t,n){return this.SPACE_SIZE/2+.5*n*this.SPACE_SIZE+t*this.SPACE_SIZE}getPieceCxByCoord(e){return this.getPieceCx(e.x,e.y,e.z)}getPieceCyByCoord(e){return this.getPieceCy(e.x,e.y,e.z)}isOccupied(e,t,n){const r=new j2(e,t,n);if(this.justClimbed(r))return!1;const i=this.getState().getPieceAt(r).isPlayer(),s=this.chosenLandingCoord.equalsValue(r);return i||s}getPieceClasses(e,t,n){const r=new j2(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected-stroke"),this.isCaptured(r)&&i.push("pre-captured-fill"),i}getPieceFillClass(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}getPlayerSidePieces(e){const t=this.remainingPieces[e.value],n=[];for(let r=0;r<t;r++)n.push(r);return n}updateBoard(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.rules.node.move;const e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=Aw.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.lastMove.get();this.lastLandingCoord=Aw.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}hideLastMove(){this.lastStartingCoord=Aw.empty(),this.lastLandingCoord=Aw.empty(),this.lastFirstCapture=Aw.empty(),this.lastSecondCapture=Aw.empty()}mustDrawCoord(e){return this.mustDraw(e.x,e.y,e.z)}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-pylos"]],features:[Go],decls:9,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],[1,"base","captured","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,a3,2,1,"g",1),fa(2,"g",null,2),ga(4,"rect",3),la(5,f3,2,1,"g",1),la(6,p3,1,7,"rect",4),la(7,g3,3,5,"g",5),la(8,m3,3,12,"g",6),pa(),pa()),2&e&&(ra("viewBox","0 0 "+t.BOARD_WIDTH+" "+t.BOARD_HEIGHT)("transform",t.rotation),ks(1),ha("ngForOf",t.Player.PLAYERS),ks(1),ra("transform","translate("+t.STROKE_WIDTH/2+" "+(t.STROKE_WIDTH/2+t.PIECE_ROW_HEIGHT)+")"),ks(2),ra("width",4*t.SPACE_SIZE)("height",4*t.SPACE_SIZE),ks(1),ha("ngForOf",wu(10,y3)),ks(1),ha("ngIf",t.highCapture.isPresent()),ks(1),ha("ngIf",t.chosenLandingCoord.isPresent()),ks(1),ha("ngForOf",t.capturables))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class C3{constructor(e){this.value=e}static fromInt(e){if(0<=e&&e<=15)return C3.pieces[e];if(16===e)return C3.EMPTY;throw new Error("Invalid piece ("+e+")")}equals(e){return this===e}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}C3.AAAA=new C3(0),C3.AAAB=new C3(1),C3.AABA=new C3(2),C3.AABB=new C3(3),C3.ABAA=new C3(4),C3.ABAB=new C3(5),C3.ABBA=new C3(6),C3.ABBB=new C3(7),C3.BAAA=new C3(8),C3.BAAB=new C3(9),C3.BABA=new C3(10),C3.BABB=new C3(11),C3.BBAA=new C3(12),C3.BBAB=new C3(13),C3.BBBA=new C3(14),C3.BBBB=new C3(15),C3.EMPTY=new C3(16),C3.pieces=[C3.AAAA,C3.AAAB,C3.AABA,C3.AABB,C3.ABAA,C3.ABAB,C3.ABBA,C3.ABBB,C3.BAAA,C3.BAAB,C3.BABA,C3.BABB,C3.BBAA,C3.BBAB,C3.BBBA,C3.BBBB];class _3 extends aj{constructor(e,t,n){super(e,t),this.piece=n}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}_3.encoder=new class extends PZ{maxValue(){return 496}encodeNumber(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}decodeNumber(e){const t=e%32;e-=t;const n=(e/=32)%4;return e-=n,new _3(e/=4,n,C3.fromInt(t))}};class E3 extends ij{constructor(e,t,n){super(e,t),this.pieceInHand=n}static getInitialState(){const e=AZ.createTable(4,4,C3.EMPTY);return new E3(e,0,C3.AAAA)}static isGivable(e,t,n){return e!==n&&!1===E3.isAlreadyOnBoard(e,t)}static isAlreadyOnBoard(e,t){for(let n=0;n<4;n++)for(let r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}getRemainingPieces(){const e=C3.pieces,t=[];for(const n of e)E3.isGivable(n,this.board,this.pieceInHand)&&t.push(n);return t}}let w3=(()=>{class e{}return e.MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`,e.PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`,e.CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`,e})();class P3{constructor(e){this.subCriterion=[Aw.empty(),Aw.empty(),Aw.empty(),Aw.empty()],this.subCriterion[0]=Aw.of(8==(8&e.value)),this.subCriterion[1]=Aw.of(4==(4&e.value)),this.subCriterion[2]=Aw.of(2==(2&e.value)),this.subCriterion[3]=Aw.of(1==(1&e.value))}mergeWith(e){let t=4;for(let n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=Aw.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}mergeWithQuartoPiece(e){const t=new P3(e);return this.mergeWith(t)}areAllAbsent(){for(let e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}match(e){for(let t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}matchPiece(e){return this.match(new P3(e))}toString(){return"Criterion{"+this.subCriterion.map(e=>e.isPresent()?e.get()?"1":"0":"x").join(" ")+"}"}}class S3{constructor(e,t){this.initialCoord=e,this.direction=t}allCoords(){const e=[];for(let t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}class b3 extends gj{static isOccupied(e){return e!==C3.EMPTY}static isLegal(e,t){const n=e.coord.x,r=e.coord.y,i=e.piece,s=t.getCopiedBoard(),o=t.pieceInHand;return b3.isOccupied(s[r][n])?xw.failure(XW.MUST_LAND_ON_EMPTY_SPACE()):i===C3.EMPTY?15===t.turn?xw.SUCCESS:xw.failure(w3.MUST_GIVE_A_PIECE()):E3.isAlreadyOnBoard(i,s)?xw.failure(w3.PIECE_ALREADY_ON_BOARD()):o===i?xw.failure(w3.CANNOT_GIVE_PIECE_IN_HAND()):xw.SUCCESS}isLegal(e,t){return b3.isLegal(e,t).toFallible(void 0)}applyLegalMove(e,t){const n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new E3(n,t.turn+1,e.piece)}static updateBoardStatus(e,t,n){return n.score===cj.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:cj.VICTORY,sensitiveSquares:new kY}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}static isThereAVictoriousLine(e,t){let n=e.initialCoord,r=t.getPieceAt(n);const i=new P3(r);for(let s=0;s<3&&!1!==b3.isOccupied(r)&&!i.areAllAbsent();s++)n=n.getNext(e.direction,1),r=t.getPieceAt(n),i.mergeWithQuartoPiece(r);return!(!b3.isOccupied(r)||i.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(e,t,n){const r=b3.getLineInfos(e,t,n);if(r.boardStatus.isPresent())return r.boardStatus.get();const i=r.commonCriterion,s=r.sensitiveCoord;if(i.isPresent()&&!1===i.get().areAllAbsent()){if(s.isAbsent())return{score:cj.VICTORY,sensitiveSquares:new kY};{i.get().matchPiece(t.pieceInHand)&&(n.score=cj.PRE_VICTORY);const e=s.get();n.sensitiveSquares.add(e)}}return n}static getLineInfos(e,t,n){let r=Aw.empty(),i=Aw.empty(),s=e.initialCoord;for(let o=0;o<4;o++){const o=t.getPieceAt(s);if(o===C3.EMPTY){if(!r.isAbsent())return{sensitiveCoord:Aw.of(s),commonCriterion:i,boardStatus:Aw.of(n)};r=Aw.of(s)}else i.isAbsent()?(i=Aw.of(new P3(o)),Ow(b3.VERBOSE,"set commonCrit to "+i.toString())):(i.get().mergeWithQuartoPiece(o),Ow(b3.VERBOSE,"update commonCrit: "+i.toString()));s=s.getNext(e.direction,1)}return{commonCriterion:i,sensitiveCoord:r,boardStatus:Aw.empty()}}static scoreToGameStatus(e,t){const n=bZ.of(t%2);return e===cj.VICTORY?pj.getDefeat(n):16===t?pj.DRAW:pj.ONGOING}getGameStatus(e){const t=e.gameState;let n={score:cj.DEFAULT,sensitiveSquares:new kY};for(const r of b3.lines)if(n=b3.updateBoardStatus(r,t,n),n.score===cj.VICTORY)return b3.scoreToGameStatus(n.score,t.turn);return b3.scoreToGameStatus(n.score,t.turn)}getVictoriousCoords(e){for(const t of b3.lines)if(b3.isThereAVictoriousLine(t,e))return t.allCoords();return[]}}b3.VERBOSE=!1,b3.lines=[new S3(new HW(0,0),VW.DOWN),new S3(new HW(1,0),VW.DOWN),new S3(new HW(2,0),VW.DOWN),new S3(new HW(3,0),VW.DOWN),new S3(new HW(0,0),VW.RIGHT),new S3(new HW(0,1),VW.RIGHT),new S3(new HW(0,2),VW.RIGHT),new S3(new HW(0,3),VW.RIGHT),new S3(new HW(0,0),VW.DOWN_RIGHT),new S3(new HW(0,3),VW.UP_RIGHT)];class O3 extends JW{static scoreToBoardValue(e,t){if(e===cj.DEFAULT)return new ej(0);{const n=bZ.of(t%2);return new ej(e===cj.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}getListMoves(e){const t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),s=n.pieceInHand;let o;for(let a=0;a<4;a++)for(let e=0;e<4;e++)if(r[a][e]===C3.EMPTY){if(o=n.getCopiedBoard(),o[a][e]=s,15===n.turn){const n=new _3(e,a,C3.EMPTY);return t.push(n),t}for(const n of i){const r=new _3(e,a,n);t.push(r)}}return t}getBoardValue(e){const t=e.gameState;let n={score:cj.DEFAULT,sensitiveSquares:new kY};for(const r of b3.lines)if(n=b3.updateBoardStatus(r,t,n),n.score===cj.VICTORY)break;return O3.scoreToBoardValue(n.score,t.turn)}}const k3=C3.AABA,T3=C3.AABB,I3=C3.ABAA,A3=C3.ABAB,M3=C3.ABBA,N3=C3.BAAA,R3=C3.BAAB,x3=C3.BABB,D3=C3.BBAA,L3=C3.BBAB,F3=C3.BBBA,U3=C3.BBBB,V3=C3.EMPTY;class B3{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.`,new E3([[F3,D3,I3,k3],[V3,V3,V3,V3],[V3,V3,V3,V3],[V3,V3,V3,V3]],7,C3.ABAB)),Cj.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new E3([[F3,T3,M3,V3],[V3,V3,V3,V3],[V3,N3,V3,V3],[V3,V3,V3,V3]],7,C3.ABAA),new _3(2,2,C3.BAAB),$localize`Perfect!`),Cj.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new E3([[U3,F3,L3,V3],[I3,x3,D3,V3],[A3,N3,R3,V3],[V3,V3,V3,V3]],7,C3.AABA),[new _3(3,3,C3.AABB)],$localize`Well done!`,$localize`Failed!`)]}}function $3(e,t){if(1&e&&(_n(),ga(0,"rect",12)),2&e){const e=Sa(2),t=e.$implicit,n=e.index,r=Sa().index,i=Sa();ha("ngClass",i.getPieceClasses(t.value)),ra("x",i.SPACE_SIZE*n+(i.SPACE_SIZE/2-i.getPieceSize(t.value)))("y",i.SPACE_SIZE*r+(i.SPACE_SIZE/2-i.getPieceSize(t.value)))("width",2*i.getPieceSize(t.value))("height",2*i.getPieceSize(t.value))}}function z3(e,t){if(1&e&&(_n(),ga(0,"circle",12)),2&e){const e=Sa(2),t=e.$implicit,n=e.index,r=Sa().index,i=Sa();ha("ngClass",i.getPieceClasses(t.value)),ra("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(t.value))}}function H3(e,t){if(1&e&&(_n(),ga(0,"circle")),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ra("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",10)}}function G3(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,$3,1,5,"rect",10),la(2,z3,1,4,"ng-template",null,11,ju),la(4,H3,1,3,"circle",7),pa()),2&e){const e=ca(3),t=Sa().$implicit,n=Sa(2);ks(1),ha("ngIf",t.isRectangle())("ngIfElse",e),ks(3),ha("ngIf",n.pieceHasDot(t.value))}}function Z3(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",9),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().chooseCoord(t,n)}),pa(),la(2,G3,5,3,"g",7),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();ks(1),Ta("id","chooseCoord_",n,"_",r,""),ha("ngClass",i.getSquareClasses(n,r)),ra("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),ks(1),ha("ngIf",e!==i.EMPTY)}}function q3(e,t){if(1&e&&(_n(),fa(0,"g",null,8),la(2,Z3,3,8,"g",2),pa()),2&e){const e=t.$implicit;ks(2),ha("ngForOf",e)}}function W3(e,t){if(1&e&&(_n(),ga(0,"rect",17)),2&e){const e=Sa(2);ha("ngClass",e.getPieceClasses(e.pieceInHand.value)),ra("x",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("y",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function j3(e,t){if(1&e&&(_n(),ga(0,"circle",12)),2&e){const e=Sa(2);ha("ngClass",e.getPieceClasses(e.pieceInHand.value)),ra("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",e.getPieceSize(e.pieceInHand.value))}}function Y3(e,t){if(1&e&&(_n(),ga(0,"circle")),2&e){const e=Sa(2);ra("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",10)}}function K3(e,t){if(1&e){const e=va();_n(),fa(0,"g",13,14),Ea("click",function(){return Gt(e),Sa().deselectDroppedPiece()}),ga(2,"rect",15),la(3,W3,1,5,"rect",16),la(4,j3,1,4,"ng-template",null,11,ju),la(6,Y3,1,3,"circle",7),pa()}if(2&e){const e=ca(5),t=Sa();Ta("id","droppedPiece_",t.chosen.get().x,"_",t.chosen.get().y,""),ra("transform","translate("+t.chosen.get().x*t.SPACE_SIZE+" "+t.chosen.get().y*t.SPACE_SIZE+")"),ks(2),ra("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),ks(1),ha("ngIf",t.pieceInHand.isRectangle())("ngIfElse",e),ks(3),ha("ngIf",t.pieceHasDot(t.pieceInHand.value))}}function Q3(e,t){if(1&e&&(_n(),fa(0,"g",null,18),ga(2,"rect",19),pa()),2&e){const e=t.$implicit,n=Sa();ks(2),ra("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)("transform","translate("+e.x*n.SPACE_SIZE+" "+e.y*n.SPACE_SIZE+")")}}function X3(e,t){if(1&e&&(_n(),ga(0,"rect",12)),2&e){const e=Sa(2);ha("ngClass",e.getPieceClasses(e.pieceInHand.value)),ra("x",0)("y",.75*e.SPACE_SIZE)("transform","translate("+-e.getPieceSize(e.pieceInHand.value)+", "+-e.getPieceSize(e.pieceInHand.value)+")")("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function J3(e,t){if(1&e&&(_n(),ga(0,"circle",21)),2&e){const e=Sa(2);ha("ngClass",e.getPieceClasses(e.pieceInHand.value)),ra("cy",.75*e.SPACE_SIZE)("r",e.getPieceSize(e.pieceInHand.value))}}function e4(e,t){1&e&&(_n(),ga(0,"circle",22)),2&e&&ra("cy",.75*Sa(2).SPACE_SIZE)("r",10)}function t4(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,X3,1,6,"rect",10),la(2,J3,1,3,"ng-template",null,11,ju),la(4,e4,1,2,"circle",20),pa()),2&e){const e=ca(3),t=Sa();ks(1),ha("ngIf",t.pieceInHand.isRectangle())("ngIfElse",e),ks(3),ha("ngIf",t.pieceHasDot(t.pieceInHand.value))}}function n4(e,t){if(1&e&&(_n(),ga(0,"rect",27)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ka("id","chosenPiece_",4*t+e,""),ra("x",n.SPACE_SIZE*e)("y",n.SPACE_SIZE*t)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function r4(e,t){if(1&e&&(_n(),ga(0,"rect",12)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ha("ngClass",n.getPieceClasses(4*t+e)),ra("x",n.SPACE_SIZE*e+n.SPACE_SIZE/2-n.getPieceSize(4*t+e))("y",n.SPACE_SIZE*t+n.SPACE_SIZE/2-n.getPieceSize(4*t+e))("width",2*n.getPieceSize(4*t+e))("height",2*n.getPieceSize(4*t+e))}}function i4(e,t){if(1&e&&(_n(),ga(0,"circle",12)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ha("ngClass",n.getPieceClasses(4*t+e)),ra("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",n.getPieceSize(4*t+e))}}function s4(e,t){if(1&e&&(_n(),ga(0,"circle")),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ra("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",10)}}function o4(e,t){if(1&e){const e=va();_n(),fa(0,"g",13),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().choosePiece(4*n+t)}),la(1,n4,1,5,"rect",26),la(2,r4,1,5,"rect",10),la(3,i4,1,4,"ng-template",null,11,ju),la(5,s4,1,3,"circle",7),pa()}if(2&e){const e=ca(4),t=Sa().index,n=Sa().index,r=Sa();ka("id","choosePiece_",4*n+t,""),ks(1),ha("ngIf",r.pieceToGive.equalsValue(r.QuartoPiece.fromInt(4*n+t))),ks(1),ha("ngIf",(4*n+t)%4<2)("ngIfElse",e),ks(3),ha("ngIf",r.pieceHasDot(4*n+t))}}function a4(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,o4,6,5,"g",3),pa()),2&e){const e=t.index,n=Sa().index,r=Sa();ks(1),ha("ngIf",r.isRemaining(4*n+e))}}function l4(e,t){if(1&e&&(_n(),fa(0,"g",null,23),ga(2,"rect",24,25),la(4,a4,2,1,"g",2),pa()),2&e){const e=t.$implicit,n=Sa();ra("transform","translate(0 "+6.5*n.SPACE_SIZE+")"),ks(2),ra("x",-.125*n.SPACE_SIZE)("y",-.125*n.SPACE_SIZE)("width",4.25*n.SPACE_SIZE)("height",4.25*n.SPACE_SIZE),ks(2),ha("ngForOf",e)}}let c4=(()=>{class e extends eY{constructor(e){super(e),this.EMPTY=C3.EMPTY,this.QuartoPiece=C3,this.chosen=Aw.empty(),this.lastMove=Aw.empty(),this.pieceInHand=C3.EMPTY,this.pieceToGive=Aw.empty(),this.victoriousCoords=[],this.rules=new b3(E3),this.availableMinimaxes=[new O3(this.rules,"QuartoMinimax")],this.encoder=_3.encoder,this.tutorial=(new B3).tutorial,this.pieceInHand=this.getState().pieceInHand,this.updateBoard()}updateBoard(){const e=this.getState(),t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=Aw.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(e=>e.coord)}chooseCoord(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#chooseCoord_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(n.hideLastMove(),n.board[t][e]===C3.EMPTY){if(n.showPieceInHandOnBoard(e,t),15===n.getState().turn){const r=new _3(e,t,C3.EMPTY);return n.chooseMove(r,n.getState())}if(n.pieceToGive.isAbsent())return xw.SUCCESS;{const r=new _3(e,t,n.pieceToGive.get());return n.chooseMove(r,n.getState())}}return n.cancelMove(XW.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#choosePiece_"+e);if(n.isFailure())return t.cancelMove(n.getReason());if(t.hideLastMove(),t.pieceToGive.equalsValue(C3.fromInt(e)))return t.cancelMoveAttempt(),xw.SUCCESS;if(t.pieceToGive=Aw.of(C3.fromInt(e)),t.chosen.isAbsent())return xw.SUCCESS;{const e=t.chosen.get(),n=new _3(e.x,e.y,t.pieceToGive.get());return t.chooseMove(n,t.rules.node.gameState)}})()}hideLastMove(){this.lastMove=Aw.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=Aw.empty(),this.chosen=Aw.empty()}deselectDroppedPiece(){const e=this.chosen.getOrElse(new HW(404,404)),t=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return t.isFailure()?this.cancelMove(t.getReason()):(this.cancelMoveAttempt(),xw.SUCCESS)}showPieceInHandOnBoard(e,t){this.chosen=Aw.of(new HW(e,t))}isRemaining(e){return E3.isGivable(C3.fromInt(e),this.board,this.pieceInHand)}getSquareClasses(e,t){const n=new HW(e,t);return this.lastMove.equalsValue(n)?["moved-fill"]:[]}getPieceClasses(e){const t=[];return t.push(e%2==0?"player0-fill":"player1-fill"),t}getPieceSize(e){return e<8?40:25}pieceHasDot(e){return e!==C3.EMPTY.value&&e%8<4}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-quarto"]],features:[Go],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"g",1),la(2,q3,3,1,"g",2),la(3,K3,7,8,"g",3),la(4,Q3,3,3,"g",2),fa(5,"g",null,4),ga(7,"rect",5,6),la(9,t4,5,3,"g",7),pa(),la(10,l4,5,6,"g",2),pa(),pa()),2&e&&(ra("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),ks(2),ha("ngForOf",t.board),ks(1),ha("ngIf",t.chosen.isPresent()),ks(1),ha("ngForOf",t.victoriousCoords),ks(1),ra("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),ks(2),ra("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),ks(2),ha("ngIf",t.chosen.isAbsent()),ks(1),ha("ngForOf",t.board))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),u4=(()=>{class e{}return e.NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`,e})();class h4 extends aj{constructor(e,t,n){super(e,t),this.direction=n;const r=h4.isValidCoord(this.coord);if(r.isFailure())throw new Error(r.getReason());if(0===e&&n===BW.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&n===BW.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===t&&n===BW.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===t&&n===BW.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}static isValidCoord(e){return e.isNotInRange(5,5)?xw.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?xw.failure(u4.NO_INSIDE_CLICK()):xw.SUCCESS}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}h4.encoder=new class extends PZ{maxValue(){return 128}encodeNumber(e){const t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}decodeNumber(e){const t=BW.factory.fromInt(e%4).get();e-=e%4;const n=(e/=4)%5;return e-=e%5,new h4(e/=5,n,t)}};class d4 extends ij{static getInitialState(){const e=AZ.createTable(5,5,OZ.NONE);return new d4(e,0)}applyLegalMove(e){const t=this.getCopiedBoard(),n=this.turn+1;let r=e.coord,i=e.coord.getNext(e.direction);for(;i.isInRange(5,5);)t[r.y][r.x]=t[i.y][i.x],r=r.getNext(e.direction),i=i.getNext(e.direction);return t[r.y][r.x]=this.getCurrentPlayer(),new d4(t,n)}}class f4 extends gj{static getVerticalCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new HW(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new HW(4,r));return n}static getHorizontalCenterCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new HW(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new HW(r,4));return n}static getPossibleDirections(e){const t=[];return 0!==e.x&&t.push(BW.LEFT),0!==e.y&&t.push(BW.UP),4!==e.x&&t.push(BW.RIGHT),4!==e.y&&t.push(BW.DOWN),t}static getLinesSums(e){const t={};t[bZ.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[bZ.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(let n=0;n<5;n++)for(let r=0;r<5;r++){const i=e.getPieceAtXY(r,n);if(i.isPlayer()){const e=i.value;t[e].columns[r]=t[e].columns[r]+1,t[e].rows[n]=t[e].rows[n]+1,r===n&&(t[e].diagonals[0]=t[e].diagonals[0]+1),r+n===4&&(t[e].diagonals[1]=t[e].diagonals[1]+1)}}return t}static getVictoriousCoords(e){const t=f4.getLinesSums(e),n=[];for(let r=0;r<2;r++){for(let e=0;e<5;e++){if(5===t[r].columns[e])for(let t=0;t<5;t++)n.push(new HW(e,t));if(5===t[r].rows[e])for(let t=0;t<5;t++)n.push(new HW(t,e))}if(5===t[r].diagonals[0])for(let e=0;e<5;e++)n.push(new HW(e,e));if(5===t[r].diagonals[1])for(let e=0;e<5;e++)n.push(new HW(e,4-e))}return n}static getFullestLine(e){const t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max(...t)}applyLegalMove(e,t,n){return f4.applyLegalMove(e,t,n)}static applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?Mw.failure(XW.CANNOT_CHOOSE_OPPONENT_PIECE()):Mw.success(void 0)}getGameStatus(e){const t=e.gameState,n=f4.getLinesSums(t),r=f4.getFullestLine(n[bZ.ZERO.value]),i=f4.getFullestLine(n[bZ.ONE.value]),s=t.getCurrentPlayer();return 5===r&&(s===bZ.ZERO||i<5)?pj.ZERO_WON:5===i?pj.ONE_WON:pj.ONGOING}}class p4 extends JW{getListMoves(e){const t=[],n=f4.getVerticalCoords(e),r=f4.getHorizontalCenterCoords(e).concat(n);for(const i of r){const e=f4.getPossibleDirections(i);for(const n of e){const e=new h4(i.x,i.y,n);t.push(e)}}return t}getBoardValue(e){const t=e.gameState,n=f4.getLinesSums(t),r=f4.getFullestLine(n[bZ.ZERO.value]),i=f4.getFullestLine(n[bZ.ONE.value]),s=t.getCurrentPlayer();return new ej(5===r&&(s===bZ.ZERO||i<5)?bZ.ZERO.getVictoryValue():5===i?bZ.ONE.getVictoryValue():i-r)}}const g4=OZ.NONE,m4=OZ.ZERO,y4=OZ.ONE;class v4{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,d4.getInitialState()),Cj.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new d4([[g4,g4,g4,g4,g4],[g4,g4,g4,g4,g4],[g4,g4,g4,g4,g4],[g4,g4,g4,g4,g4],[m4,m4,m4,m4,g4]],1),[new h4(4,4,BW.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed!`),Cj.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new d4([[g4,y4,g4,y4,y4],[g4,m4,m4,g4,m4],[y4,y4,y4,m4,y4],[m4,g4,m4,y4,y4],[y4,m4,g4,y4,m4]],31),[new h4(3,0,BW.DOWN)],$localize`Congratulations, you won!`,$localize`Failed!`)]}}function C4(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"circle",4),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onBoardClick(t,n)}),pa(),pa()}if(2&e){const e=t.index,n=Sa().index,r=Sa();ks(1),Ta("id","click_",e,"_",n,""),ha("ngClass",r.getPieceClasses(e,n)),ra("r",.45*r.SPACE_SIZE)("cx",(e+.5)*r.SPACE_SIZE)("cy",(n+.5)*r.SPACE_SIZE)}}function _4(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,C4,2,6,"g",2),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function E4(e,t){if(1&e){const e=va();_n(),fa(0,"use",6),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).chooseDirection(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa(2);ka("id","chooseDirection_",e,""),ra("transform",n.getArrowTransform(e))}}function w4(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,E4,1,2,"use",5),pa()),2&e){const e=Sa();ks(1),ha("ngForOf",e.getPossiblesDirections())}}let P4=(()=>{class e extends eY{constructor(e){super(e),this.lastMoveCoord=Aw.empty(),this.chosenCoord=Aw.empty(),this.victoriousCoords=[],this.rules=new f4(d4),this.availableMinimaxes=[new p4(this.rules,"QuixoMinimax")],this.encoder=h4.encoder,this.tutorial=(new v4).tutorial,this.updateBoard()}updateBoard(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(e=>e.coord),this.victoriousCoords=f4.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=Aw.empty()}getPieceClasses(e,t){const n=new HW(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected-stroke"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move-stroke"),this.victoriousCoords.some(e=>e.equals(n))&&r.push("victory-stroke"),r}onBoardClick(e,t){const n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());const r=new HW(e,t),i=h4.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(XW.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(r)?this.cancelMoveAttempt():this.chosenCoord=Aw.of(r),xw.SUCCESS)}getPossiblesDirections(){const e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push(BW.RIGHT),0!==t.x&&e.push(BW.LEFT),4!==t.y&&e.push(BW.DOWN),0!==t.y&&e.push(BW.UP),e}chooseDirection(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#chooseDirection_"+e.toString());return n.isFailure()?t.cancelMove(n.getReason()):(t.chosenDirection=e,yield t.tryMove())})()}tryMove(){var e=this;return Sw(function*(){const t=e.chosenCoord.get(),n=new h4(t.x,t.y,e.chosenDirection);return e.cancelMove(),e.chooseMove(n,e.getState())})()}getArrowTransform(e){return class{static getArrowTransform(e,t,n){let r,i,s;switch(n){case BW.UP:r=1,i=0,s=-90;break;case BW.DOWN:r=1,i=2,s=90;break;case BW.LEFT:r=0,i=1,s=180;break;default:bw.expectToBe(n,BW.RIGHT),r=2,i=1,s=0}return["scale("+e/300+")",`translate(${100*r} ${100*i})`,"rotate("+s+" 50 50)"].join(" ")}}.getArrowTransform(5*this.SPACE_SIZE,new HW(0,0),e)}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-quixo"]],features:[Go],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"defs"),ga(2,"polygon",1),pa(),la(3,_4,2,1,"g",2),la(4,w4,2,1,"g",3),pa()),2&e&&(ra("viewBox","0 0 "+5*t.SPACE_SIZE+" "+5*t.SPACE_SIZE),ks(3),ha("ngForOf",t.board),ks(1),ha("ngIf",t.chosenCoord.isPresent()))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),S4=(()=>{class e extends ij{static getInitialState(){const t=AZ.createTable(e.BOARD_WIDTH,e.BOARD_HEIGHT,OZ.NONE);return t[3][3]=bZ.ZERO,t[4][4]=bZ.ZERO,t[3][4]=bZ.ONE,t[4][3]=bZ.ONE,new e(t,0)}static getNeighboringPawnLike(e,t,n,r){let i;const s=[];for(let o=-1;o<2;o++)for(let a=-1;a<2;a++)i=new HW(n+a,r+o),i.isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&s.push(i);return s}countScore(){const t=[0,0];for(let n=0;n<e.BOARD_HEIGHT;n++)for(let r=0;r<e.BOARD_WIDTH;r++){const e=this.board[n][r];e.isPlayer()&&(t[e.value]+=1)}return t}}return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e})();class b4 extends aj{equals(e){return e===this||e.coord.equals(this.coord)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}b4.encoder=new class extends PZ{maxValue(){return(S4.BOARD_HEIGHT-1)*S4.BOARD_WIDTH+(S4.BOARD_WIDTH-1)}encodeNumber(e){return e.coord.y*S4.BOARD_WIDTH+e.coord.x}decodeNumber(e){const t=e%S4.BOARD_WIDTH;return new b4(t,(e-t)/S4.BOARD_WIDTH)}},b4.PASS=new b4(-1,-1),b4.PASS_NUMBER=b4.encoder.encodeNumber(b4.PASS);let O4=(()=>{class e{}return e.NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`,e})();class k4{constructor(e,t){this.move=e,this.switched=t}}let T4=(()=>{class e extends gj{static getGameStatus(t){const n=t.gameState;if(!1===e.isGameEnded(n))return pj.ONGOING;const r=n.countScore(),i=r[1]-r[0];return i<0?pj.ZERO_WON:i>0?pj.ONE_WON:pj.DRAW}applyLegalMove(e,t,n){const r=t.turn,i=t.getCurrentPlayer(),s=t.getCopiedBoard();if(e.equals(b4.PASS))return new S4(s,r+1);for(const o of n)s[o.y][o.x]=i;return s[e.coord.y][e.coord.x]=i,new S4(s,r+1)}static getAllSwitcheds(t,n,r){const i=[],s=n.getOpponent();for(const o of VW.DIRECTIONS){const a=t.coord.getNext(o);if(a.isInRange(S4.BOARD_WIDTH,S4.BOARD_HEIGHT)&&r[a.y][a.x]===s){const t=e.getSandwicheds(n,o,a,r);for(const e of t)i.push(e)}}return i}static getSandwicheds(e,t,n,r){const i=[n];let s=n.getNext(t);for(;s.isInRange(S4.BOARD_WIDTH,S4.BOARD_HEIGHT);){const n=r[s.y][s.x];if(n===e)return i;if(n===OZ.NONE)return[];i.push(s),s=s.getNext(t)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(t){return e.getGameStatus(t)}static playerCanOnlyPass(e){const t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(b4.PASS)}static nextPlayerCantOnlyPass(e){const t=e.getCopiedBoard(),n=new S4(t,e.turn+1);return this.playerCanOnlyPass(n)}static getListMoves(t){const n=[];let r;const i=t.getCurrentPlayer(),s=t.getCurrentOpponent();for(let o=0;o<8;o++)for(let a=0;a<8;a++)if(t.getPieceAtXY(a,o)===OZ.NONE&&(r=t.getCopiedBoard(),S4.getNeighboringPawnLike(r,s,a,o).length>0)){const s=new b4(a,o),l=e.getAllSwitcheds(s,i,r);if(l.length>0){for(const e of l)cZ(i!==t.getPieceAt(e),e+"was already switched!"),r[e.y][e.x]=i;r[o][a]=i,n.push(new k4(s,l.length))}}return 0===n.length&&n.push(new k4(b4.PASS,0)),n}isLegal(t,n){if(t.equals(b4.PASS))return e.playerCanOnlyPass(n)?Mw.success([]):Mw.failure(XW.MUST_PASS());if(n.getPieceAt(t.coord).isPlayer())return Ow(e.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),Mw.failure(XW.MUST_CLICK_ON_EMPTY_SPACE());const r=n.getCopiedBoard(),i=e.getAllSwitcheds(t,n.getCurrentPlayer(),r);return Ow(e.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?Mw.failure(O4.NO_ELEMENT_SWITCHED()):Mw.success(i)}}return e.VERBOSE=!1,e})();class I4 extends JW{getBoardValue(e){const t=T4.getGameStatus(e);if(t.isEndGame)return ej.fromWinner(t.winner);const n=e.gameState.getCopiedBoard();let r=0,i=0;for(let s=0;s<S4.BOARD_HEIGHT;s++)for(let e=0;e<S4.BOARD_WIDTH;e++){const t=(0===e||e===S4.BOARD_WIDTH-1?4:1)*(0===s||s===S4.BOARD_HEIGHT-1?4:1);n[s][e]===bZ.ZERO&&(r+=t),n[s][e]===bZ.ONE&&(i+=t)}return r*=bZ.ZERO.getScoreModifier(),i*=bZ.ONE.getScoreModifier(),new ej(i+r)}getListMoves(e){const t=T4.getListMoves(e.gameState);return AZ.sortByDescending(t,e=>I4.bestCoords.some(t=>e.move.coord.equals(t))?100:e.switched),t.map(e=>e.move)}}I4.bestCoords=[new HW(0,0),new HW(0,S4.BOARD_HEIGHT-1),new HW(S4.BOARD_WIDTH-1,0),new HW(S4.BOARD_WIDTH-1,S4.BOARD_HEIGHT-1)];const A4=OZ.NONE,M4=OZ.ZERO,N4=OZ.ONE;class R4{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new S4([[M4,M4,M4,M4,M4,M4,M4,M4],[M4,N4,N4,N4,N4,N4,N4,M4],[M4,N4,N4,N4,N4,N4,N4,M4],[M4,N4,N4,N4,N4,N4,N4,M4],[M4,N4,N4,N4,N4,N4,N4,M4],[M4,N4,N4,N4,N4,N4,N4,M4],[M4,N4,N4,N4,N4,N4,N4,M4],[M4,M4,M4,M4,M4,M4,M4,M4]],60)),Cj.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,S4.getInitialState(),new b4(2,4),$localize`Congratulations!`),Cj.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one lines at a time
        You're playing light here.<br/><br/>
        Play on the bottom left to see an example.`,new S4([[A4,A4,A4,A4,A4,A4,A4,A4],[A4,A4,A4,A4,A4,A4,A4,A4],[A4,A4,A4,A4,A4,A4,A4,A4],[A4,A4,A4,A4,N4,A4,A4,A4],[A4,A4,A4,M4,A4,A4,A4,A4],[A4,A4,M4,A4,A4,A4,A4,A4],[M4,M4,A4,A4,A4,A4,A4,A4],[A4,M4,N4,M4,N4,M4,A4,A4]],1),[new b4(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),Cj.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new S4([[N4,M4,M4,M4,M4,M4,N4,M4],[M4,N4,N4,N4,N4,N4,N4,M4],[M4,N4,N4,N4,N4,N4,N4,M4],[M4,N4,N4,N4,N4,N4,N4,M4],[M4,N4,N4,N4,N4,N4,N4,M4],[M4,N4,N4,N4,N4,N4,N4,M4],[N4,N4,N4,N4,N4,N4,A4,A4],[M4,M4,M4,M4,M4,M4,A4,A4]],60))]}}function x4(e,t){if(1&e&&(_n(),ga(0,"circle",4)),2&e){const e=Sa().index,t=Sa().index,n=Sa();ha("ngClass",n.getPieceClass(e,t)),ra("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)}}function D4(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",2),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),pa(),la(2,x4,1,4,"circle",3),pa()}if(2&e){const e=t.index,n=Sa().index,r=Sa();ks(1),Ta("id","click_",e,"_",n,""),ha("ngClass",r.getRectClasses(e,n)),ra("x",r.SPACE_SIZE*e)("y",r.SPACE_SIZE*n)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),ks(1),ha("ngIf",r.board[n][e]!==r.EMPTY)}}function L4(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,D4,3,8,"g",1),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}let F4=(()=>{class e extends eY{constructor(e){super(e),this.EMPTY=OZ.NONE,this.lastMove=new HW(-2,-2),this.captureds=[],this.scores=Aw.of([2,2]),this.rules=new T4(S4),this.availableMinimaxes=[new I4(this.rules,"ReversiMinimax")],this.encoder=b4.encoder,this.tutorial=(new R4).tutorial,this.canPass=!1,this.updateBoard()}onClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new b4(e,t);return yield n.chooseMove(i,n.getState(),n.scores.get())})()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new HW(-2,-2),this.scores=Aw.of(e.countScore()),this.canPass=T4.playerCanOnlyPass(e)}showPreviousMove(){this.lastMove=this.rules.node.move.get().coord;const e=this.getState().getCurrentPlayer(),t=this.getState().getCurrentOpponent();for(const n of VW.DIRECTIONS){let r=this.lastMove.getNext(n,1);for(;r.isInRange(S4.BOARD_WIDTH,S4.BOARD_HEIGHT)&&this.getState().getPieceAt(r)===t&&this.rules.node.mother.get().gameState.getPieceAt(r)===e;)this.captureds.push(r),r=r.getNext(n,1)}}getRectClasses(e,t){const n=new HW(e,t);return this.captureds.some(e=>e.equals(n))?["captured-fill"]:n.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(e,t){return this.getPlayerClass(this.board[t][e])}pass(){var e=this;return Sw(function*(){return cZ(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(b4.PASS.coord.x,b4.PASS.coord.y)})()}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-reversi"]],features:[Go],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,L4,2,1,"g",1),pa()),2&e&&(ra("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),ks(1),ha("ngForOf",t.board))},directives:[Jd,Qd,tf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),U4=(()=>{class e extends JY{static getInitialState(){const t=qW.UNREACHABLE,n=qW.ZERO,r=qW.ONE,i=qW.EMPTY;return new e([[t,t,n,r,i,i,i,n,r,t,t],[t,i,i,i,i,i,i,i,i,i,t],[r,i,i,i,i,i,i,i,i,i,n],[n,i,i,i,i,i,i,i,i,i,r],[t,i,i,i,i,i,i,i,i,i,t],[t,t,r,n,i,i,i,r,n,t,t]],0)}}return e.HEIGHT=6,e.WIDTH=11,e})(),V4=(()=>{class e{}return e.CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`,e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`,e.MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`,e.MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`,e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`,e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`,e})();class B4 extends hY{constructor(e,t){super(e,t)}static checkDistanceAndLocation(e,t){const n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return xw.failure(XW.MOVE_CANNOT_BE_STATIC());if(1===n){const n=XY.getFakeNeighbors(e);if(t.equals(n))return xw.failure(V4.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return xw.failure($localize`You can move one or two spaces, not ${n}.`);if(XY.isSpaceDark(e))return xw.failure(V4.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return xw.failure(V4.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return xw.SUCCESS}static from(e,t){if(!e.isInRange(U4.WIDTH,U4.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(U4.WIDTH,U4.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");const n=B4.checkDistanceAndLocation(e,t);return n.isFailure()?n.toFailedFallible():Mw.success(new B4(e,t))}isSimpleStep(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return"SaharaMove("+this.coord+"->"+this.end+")"}}B4.encoder=new class extends PZ{maxValue(){return 396*U4.WIDTH+66*U4.HEIGHT+6*U4.WIDTH+U4.HEIGHT}encodeNumber(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}decodeNumber(e){const t=e%6;e-=t;const n=(e/=6)%11;e-=n;const r=(e/=11)%6;return e-=r,B4.from(new HW(e/=6,r),new HW(n,t)).get()}};let $4=(()=>{class e extends gj{static getStartingCoords(e,t){const n=[];for(let r=0;r<U4.HEIGHT;r++)for(let i=0;i<U4.WIDTH;i++)e[r][i].is(t)&&n.push(new HW(i,r));return n}static getBoardValuesFor(t,n){const r=e.getStartingCoords(t,n),i=[];for(const e of r){const n=JY.getEmptyNeighbors(t,e,qW.EMPTY).length;if(0===n)return[0];i.push(n)}return i.sort((e,t)=>e-t)}applyLegalMove(t,n,r){Ow(e.VERBOSE,"Legal move "+t.toString()+" applied");const i=n.getCopiedBoard();return i[t.end.y][t.end.x]=i[t.coord.y][t.coord.x],i[t.coord.y][t.coord.x]=qW.EMPTY,new U4(i,n.turn+1)}isLegal(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return Mw.failure(XW.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==qW.EMPTY)return Mw.failure(XW.MUST_LAND_ON_EMPTY_SPACE());const n=XY.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===qW.EMPTY?Mw.success(void 0):Mw.failure(V4.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):Mw.success(void 0)}getGameStatus(t){const n=t.gameState.getCopiedBoard(),r=e.getBoardValuesFor(n,bZ.ZERO),i=e.getBoardValuesFor(n,bZ.ONE);return e.getGameStatusFromFreedoms(r,i)}getLandingCoords(e,t){const n=t=>t.isInRange(U4.WIDTH,U4.HEIGHT)&&e[t.y][t.x]===qW.EMPTY,r=new nj(XY.getNeighbors(t).filter(n));if(!0===XY.isSpaceDark(t))return r.toList();{const e=new nj(r.toList());for(const t of r){const r=XY.getNeighbors(t).filter(n);for(const t of r)e.add(t)}return e.toList()}}static getGameStatusFromFreedoms(e,t){return 0===e[0]?pj.ONE_WON:0===t[0]?pj.ZERO_WON:pj.ONGOING}}return e.VERBOSE=!1,e})();class z4 extends JW{getListMoves(e){const t=[],n=e.gameState.getCopiedBoard(),r=e.gameState.getCurrentPlayer(),i=$4.getStartingCoords(n,r);for(const s of i){const e=JY.getEmptyNeighbors(n,s,qW.EMPTY);for(const r of e){const e=B4.from(s,r).get();if(n[r.y][r.x]=n[s.y][s.x],n[s.y][s.x]=qW.EMPTY,t.push(e),(r.y+r.x)%2==0){const e=JY.getEmptyNeighbors(n,r,qW.EMPTY);for(const i of e)if(!i.equals(s)){const e=B4.from(s,i).get();n[i.y][i.x]=n[r.y][r.x],n[r.y][r.x]=qW.EMPTY,t.push(e),n[r.y][r.x]=n[i.y][i.x],n[i.y][i.x]=qW.EMPTY}}n[s.y][s.x]=n[r.y][r.x],n[r.y][r.x]=qW.EMPTY}}return t}getBoardValue(e){const t=e.gameState.getCopiedBoard(),n=$4.getBoardValuesFor(t,bZ.ZERO),r=$4.getBoardValuesFor(t,bZ.ONE),i=$4.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return ej.fromWinner(i.winner);let s=0;for(;s<6&&n[s]===r[s];)s++;return new ej(r[s%6]-n[s%6])}}const H4=qW.UNREACHABLE,G4=qW.ZERO,Z4=qW.ONE,q4=qW.EMPTY;class W4{constructor(){this.tutorial=[Cj.informational($localize`Initial board`,$localize`Shr is played on a board where each space is a triangle.
        Each player has six pyramids.`,U4.getInitialState()),Cj.informational($localize`Goal of the game`,$localize`At Shr, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new U4([[H4,H4,q4,q4,Z4,q4,q4,G4,Z4,H4,H4],[H4,q4,q4,q4,q4,q4,q4,q4,q4,q4,H4],[Z4,G4,q4,q4,q4,q4,q4,q4,q4,q4,G4],[G4,q4,q4,q4,q4,q4,q4,q4,q4,q4,Z4],[H4,q4,q4,q4,q4,q4,q4,q4,q4,q4,H4],[H4,H4,Z4,G4,q4,q4,q4,Z4,G4,H4,H4]],3)),Cj.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        You're the first player, playing with the dark pyramids.
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        Do any simple step.`,U4.getInitialState(),B4.from(new HW(2,0),new HW(2,1)).get(),(e,t,n)=>e.isSimpleStep()?xw.SUCCESS:xw.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),Cj.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol>`,U4.getInitialState(),B4.from(new HW(7,0),new HW(5,0)).get(),(e,t,n)=>e.isSimpleStep()?xw.failure($localize`Failed! You have made a single step.`):xw.SUCCESS,$localize`Congratulations!`)]}}function j4(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"polygon",7),pa()),2&e){const e=Sa().index,t=Sa().index,n=Sa();ks(1),ha("ngClass",n.getPlayerClassFor(e,t)),ra("points",n.getPyramidCoordinate(e,t))}}function Y4(e,t){if(1&e&&(_n(),ga(0,"polygon",10)),2&e){const e=Sa(2).index,t=Sa().index;ra("points",Sa().getTriangleCoordinate(e,t))}}function K4(e,t){if(1&e&&(_n(),ga(0,"polygon",11)),2&e){const e=Sa(2).index,t=Sa().index;ra("points",Sa().getTriangleCoordinate(e,t))}}function Q4(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,Y4,1,1,"polygon",8),la(2,K4,1,1,"polygon",9),pa()),2&e){const e=Sa().index,t=Sa().index;ks(1),ha("ngIf",(e+t)%2==1),ks(1),ha("ngIf",(e+t)%2==0)}}function X4(e,t){if(1&e){const e=va();_n(),fa(0,"g",5),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),la(1,j4,2,2,"g",6),la(2,Q4,3,2,"g",6),pa()}if(2&e){const e=t.$implicit;Ta("id","click_",t.index,"_",Sa().index,""),ks(1),ha("ngIf",e.isPlayer()),ks(1),ha("ngIf",2===e.value)}}function J4(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,X4,3,4,"g",4),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function e5(e,t){if(1&e&&(_n(),ga(0,"polygon",14)),2&e){const e=t.$implicit,n=Sa(2);Ta("id","possible_landing_",e.x,"_",e.y,""),ra("points",n.getTriangleCoordinate(e.x,e.y))}}function t5(e,t){if(1&e&&(_n(),ga(0,"polygon",14)),2&e){const e=Sa(2);Ta("id","chosen_coord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),ra("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function n5(e,t){if(1&e&&(_n(),ma(0),la(1,e5,1,3,"polygon",12),la(2,t5,1,3,"polygon",13),ya()),2&e){const e=Sa();ks(1),ha("ngForOf",e.possibleLandings),ks(1),ha("ngIf",e.chosenCoord.isPresent())}}function r5(e,t){if(1&e&&(_n(),ma(0),ga(1,"polygon",15),ga(2,"polygon",15),ya()),2&e){const e=Sa(2);ks(1),ra("points",e.getTriangleCoordinate(e.lastCoord.get().x,e.lastCoord.get().y)),ks(1),ra("points",e.getTriangleCoordinate(e.lastMoved.get().x,e.lastMoved.get().y))}}function i5(e,t){1&e&&(_n(),la(0,r5,3,2,"ng-container",6)),2&e&&ha("ngIf",Sa().lastMoved.isPresent())}let s5=(()=>{class e extends jY{constructor(e){super(e),this.lastCoord=Aw.empty(),this.lastMoved=Aw.empty(),this.chosenCoord=Aw.empty(),this.possibleLandings=[],this.rules=new $4(U4),this.availableMinimaxes=[new z4(this.rules,"SaharaMinimax")],this.encoder=B4.encoder,this.tutorial=(new W4).tutorial,this.updateBoard()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=Aw.empty()}onClick(e,t){var n=this;return Sw(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=n.getState().getCurrentPlayer(),s=qW.ofPlayer(i);return n.chosenCoord.equalsValue(new HW(e,t))?(n.cancelMoveAttempt(),xw.SUCCESS):n.chosenCoord.isAbsent()||n.board[t][e]===s?n.choosePiece(e,t):n.chooseLandingCoord(e,t)})()}choosePiece(e,t){if(this.board[t][e]===qW.EMPTY)return this.cancelMove(V4.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[t][e].is(bZ.fromTurn(this.getTurn()))){const n=new HW(e,t);return this.selectPiece(n),xw.SUCCESS}return this.cancelMove(V4.MUST_CHOOSE_OWN_PYRAMID())}selectPiece(e){this.chosenCoord=Aw.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}chooseLandingCoord(e,t){var n=this;return Sw(function*(){const r=new HW(e,t),i=B4.from(n.chosenCoord.get(),r);return i.isFailure()?n.cancelMove(i.getReason()):yield n.chooseMove(i.get(),n.getState())})()}updateBoard(){const e=this.rules.node.move;this.lastCoord=e.map(e=>e.coord),this.lastMoved=e.map(e=>e.end),this.board=this.getState().board}getPlayerClassFor(e,t){return this.getPlayerClass(bZ.of(this.board[t][e].value))}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-sahara"]],features:[Go],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","selected-stroke",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,t){if(1&e&&(_n(),fa(0,"svg",0),la(1,J4,2,1,"g",1),la(2,n5,3,2,"ng-container",2),la(3,i5,1,1,"ng-template",null,3,ju),pa()),2&e){const e=ca(4);ks(1),ha("ngForOf",t.board),ks(1),ha("ngIf",t.chosenCoord.isPresent())("ngIfElse",e)}},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class o5 extends aj{constructor(e,t,n,r){super(e,t),this.x=e,this.y=t,this.direction=n,this.landingOrientation=r}static of(e,t,n,r){const i=new o5(e,t,n,r),s=i.coord.isNotInRange(5,5);if(i.isRotation()){if(s)return Mw.failure("Cannot rotate piece outside the board: "+i.toString())}else if(i.coord.getNext(i.direction.get()).isNotInRange(5,5)){if(s)return Mw.failure("SiamMove should end or start on the board: "+i.toString());if(i.direction.get()!==i.landingOrientation)return Mw.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+i.toString())}return Mw.success(i)}isRotation(){return this.direction.isAbsent()}equals(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.direction.equals(e.direction))&&this.landingOrientation===e.landingOrientation}toString(){const e=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}o5.encoder=PZ.tuple([PZ.numberEncoder(6),PZ.numberEncoder(6),function(e){return new class extends PZ{maxValue(){return e.maxValue()+1}encodeNumber(t){return t.isPresent()?e.encodeNumber(t.get()):e.maxValue()+1}decodeNumber(t){return t===this.maxValue()?Aw.empty():Aw.of(e.decodeNumber(t))}}}(new $W),new $W],e=>[e.x+1,e.y+1,e.direction,e.landingOrientation],e=>o5.of(e[0]-1,e[1]-1,e[2],e[3]).get());class a5{constructor(e){this.value=e}static decode(e){switch(e){case 0:return a5.EMPTY;case 1:return a5.LIGHT_UP;case 2:return a5.LIGHT_RIGHT;case 3:return a5.LIGHT_DOWN;case 4:return a5.LIGHT_LEFT;case 5:return a5.DARK_UP;case 6:return a5.DARK_RIGHT;case 7:return a5.DARK_DOWN;case 8:return a5.DARK_LEFT;case 9:return a5.MOUNTAIN}}belongTo(e){return e===bZ.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?bZ.ZERO:5<=this.value&&this.value<=8?bZ.ONE:OZ.NONE}getOptionalDirection(){switch(this.value){case 0:return Aw.empty();case 1:case 5:return Aw.of(BW.UP);case 2:case 6:return Aw.of(BW.RIGHT);case 3:case 7:return Aw.of(BW.DOWN);case 4:case 8:return Aw.of(BW.LEFT);default:return bw.expectToBe(this.value,9),Aw.empty()}}static of(e,t){return t===bZ.ZERO?e===BW.UP?a5.LIGHT_UP:e===BW.RIGHT?a5.LIGHT_RIGHT:e===BW.DOWN?a5.LIGHT_DOWN:a5.LIGHT_LEFT:e===BW.UP?a5.DARK_UP:e===BW.RIGHT?a5.DARK_RIGHT:e===BW.DOWN?a5.DARK_DOWN:a5.DARK_LEFT}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return bw.expectToBe(this.value,9),"MOUNTAIN"}}}a5.EMPTY=new a5(0),a5.LIGHT_UP=new a5(1),a5.LIGHT_RIGHT=new a5(2),a5.LIGHT_DOWN=new a5(3),a5.LIGHT_LEFT=new a5(4),a5.DARK_UP=new a5(5),a5.DARK_RIGHT=new a5(6),a5.DARK_DOWN=new a5(7),a5.DARK_LEFT=new a5(8),a5.MOUNTAIN=new a5(9);class l5 extends ij{static getInitialState(){const e=AZ.createTable(5,5,a5.EMPTY);return e[2][1]=a5.MOUNTAIN,e[2][2]=a5.MOUNTAIN,e[2][3]=a5.MOUNTAIN,new l5(e,0)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const e=[0,0];for(let t=0;t<5;t++)for(let n=0;n<5;n++)this.board[t][n]!==a5.EMPTY&&e[this.getPieceAtXY(n,t).getOwner().value]++;return e}}let c5=(()=>{class e{}return e.NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`,e.NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`,e.MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`,e.ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`,e.MUST_SELECT_VALID_DESTINATION=()=>$localize`You must select a valid destination (highlighted on the board) for your piece`,e.MUST_SELECT_ORIENTATION=()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`,e})();class u5{constructor(e,t){this.resultingBoard=e,this.moved=t}}class h5 extends gj{constructor(){super(l5)}static get(){return h5.singleton.isAbsent()&&(h5.singleton=Aw.of(new h5)),h5.singleton.get()}isLegal(e,t){if(Ow(h5.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return Mw.failure(XW.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return Ow(h5.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);{let n;if(e.isInsertion()){Ow(h5.VERBOSE,"Move is insertion");const r=this.isLegalInsertion(e.coord,t);if(r.legal.isFailure())return Mw.failure(r.legal.getReason());n=r.insertedPiece}else Ow(h5.VERBOSE,"Move is forward"),n=t.getPieceAt(e.coord);return this.isLegalForwarding(e,t,n)}}isLegalInsertion(e,t){const n=t.countCurrentPlayerPawn(),r=t.getCurrentPlayer(),i=n<5?xw.SUCCESS:xw.failure(c5.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(e,r),legal:i}}getInsertedPiece(e,t){return a5.of(-1===e.x?BW.RIGHT:-1===e.y?BW.DOWN:5===e.x?BW.LEFT:BW.UP,t)}isLegalForwarding(e,t,n){Ow(h5.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:n}}),cZ(n!==a5.MOUNTAIN&&n!==a5.EMPTY,"forwarding must be done with player piece");const r=[];let i=a5.of(e.landingOrientation,t.getCurrentPlayer());const s=e.direction.get();let o=e.coord.getNext(s);if(o.isInRange(5,5)&&t.getPieceAt(o)!==a5.EMPTY&&!1===this.isStraight(n,e))return Ow(h5.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),Mw.failure(c5.ILLEGAL_PUSH());let a=Aw.of(s);const l=s.getOpposite();let c=0;const u=t.getCopiedBoard();e.coord.isInRange(5,5)&&(u[e.coord.y][e.coord.x]=a5.EMPTY,r.push(e.coord));let h=o.isInRange(5,5)&&i!==a5.EMPTY;for(;h;){a.equalsValue(s)?c++:a.equalsValue(l)&&c--,Ow(h5.VERBOSE,{totalForce:c,movingPiece:i,landingCoord:o});const e=u[o.y][o.x];e===a5.MOUNTAIN&&(c-=.9),u[o.y][o.x]=i,r.push(o),i=e,o=o.getNext(s),a=i.getOptionalDirection(),h=o.isInRange(5,5)&&i!==a5.EMPTY&&c>0}return o.isNotInRange(5,5)&&(Ow(h5.VERBOSE,"This movement would push "+i+" outside the board"),a.equalsValue(s)?c++:a.equalsValue(l)&&c--),c<=0?(Ow(h5.VERBOSE,"This move is an illegal push: "+u),Mw.failure(c5.NOT_ENOUGH_FORCE_TO_PUSH())):(Ow(h5.VERBOSE,"This move is a legal push: "+u),Mw.success(new u5(u,r)))}isStraight(e,t){const n=e.getDirection();return t.direction.equalsValue(n)&&n===t.landingOrientation}isLegalRotation(e,t){Ow(h5.VERBOSE,{isLegalRotation:{rotation:e,state:t}});const n=e.coord,r=t.getPieceAt(n),i=t.getCurrentPlayer();if(r.getDirection()===e.landingOrientation)return Mw.failure(c5.MUST_MOVE_OR_ROTATE());const s=t.getCopiedBoard();return s[n.y][n.x]=a5.of(e.landingOrientation,i),Mw.success(new u5(s,[n]))}applyLegalMove(e,t,n){const r=AZ.copyBiArray(n.resultingBoard);return new l5(r,t.turn+1)}getBoardValueInfo(e,t){const n=this.getMountainsRowsAndColumns(t),r=n.rows,i=n.columns,s=this.getWinner(t,e,n.nbMountain);if(s.isPlayer())return s===bZ.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const e=this.getPushers(t,i,r);let n=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER;const o=t.getCurrentPlayer();for(const r of e)r.coord.isInRange(5,5)?t.getPieceAt(r.coord).belongTo(bZ.ZERO)?n=Math.min(n,r.distance):s=Math.min(s,r.distance):o===bZ.ZERO?n=Math.min(n,r.distance):s=Math.min(s,r.distance);return{shortestZero:n,shortestOne:s,boardValue:this.getScoreFromShortestDistances(n,s,o)}}}getScoreFromShortestDistances(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);const r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}getMountainsRowsAndColumns(e){const t=[],n=[];let r=0;for(let i=0;i<5;i++)for(let s=0;s<5;s++)e.getPieceAtXY(s,i)===a5.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(s)||n.push(s),r++);return{rows:t,columns:n,nbMountain:r}}getWinner(e,t,n){return 2===n?this.getPusher(e,t.get()):OZ.NONE}getPusher(e,t){const n=t.coord;let r;r=n.isInRange(5,5)?e.getPieceAt(n.getNext(t.landingOrientation)):this.getInsertedPiece(n,e.getCurrentOpponent());const i=r.getDirection(),s=this.getPusherCoord(e,i,n),o=e.getPieceAt(s).getOwner();return Ow(h5.VERBOSE,n.toString()+" belong to "+e.getCurrentOpponent().value+", "+s.toString()+" belong to "+o.value+", "+o.value+" win"),o}getPusherCoord(e,t,n){let r=n.getNext(t),i=n;for(;r.isInRange(5,5);){n=r,r=r.getNext(t);const s=e.getPieceAt(n);s!==a5.MOUNTAIN&&s.getDirection()===t&&(i=n)}return i}getPushers(e,t,n){Ow(h5.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:n}});let r=[];const i=[];for(const s of t){let e=BW.DOWN,t=new HW(s,4);i.push({direction:e,fallingCoord:t}),e=BW.UP,t=new HW(s,0),i.push({direction:e,fallingCoord:t})}for(const s of n){let e=BW.LEFT,t=new HW(0,s);i.push({direction:e,fallingCoord:t}),e=BW.RIGHT,t=new HW(4,s),i.push({direction:e,fallingCoord:t})}for(const s of i)r=this.addPotentialDirectionPusher(e,s.fallingCoord,s.direction,r);return r}addPotentialDirectionPusher(e,t,n,r){const i=this.getLineClosestPusher(e,t,n);if(i.isAbsent())return r;const s=i.get(),o=s.distance;return Ow(h5.VERBOSE,"new closest challenger"),r.push({coord:s.coord,distance:o}),r}getLineClosestPusher(e,t,n){Ow(h5.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:n.toString()}});const r=n.getOpposite();let i=1,s=e.getPieceAt(t),o=t,a=Aw.empty(),l=!1,c=!1,u=0;for(;o.isInRange(5,5)&&!1===l;){const t=e.getPieceAt(o);if(t.isEmptyOrMountain())t===a5.MOUNTAIN?(u+=.9,c=!0):i++;else{const e=t.getDirection();e===n?c&&(u-=1,u<=0&&(l=!0,o=o.getNext(n))):e===r?(u+=1,c||i++):c?(a=Aw.of(o),s!==a5.EMPTY&&i++):i++}s=t,o=o.getPrevious(n)}if(!1===l&&a.isPresent())for(i++,u-=1;!1===o.equals(a.get());)o=o.getNext(n),i--;return o.isNotInRange(5,5)&&(u-=1,5===e.countCurrentPlayerPawn())||u>0?Aw.empty():Aw.of({distance:i,coord:o})}getInsertions(e){let t=[];for(let n=1;n<4;n++)t=t.concat(this.getInsertionsAt(e,0,n)),t=t.concat(this.getInsertionsAt(e,4,n)),t=t.concat(this.getInsertionsAt(e,n,0)),t=t.concat(this.getInsertionsAt(e,n,4));return t=t.concat(this.getInsertionsAt(e,0,0)),t=t.concat(this.getInsertionsAt(e,0,4)),t=t.concat(this.getInsertionsAt(e,4,0)),t=t.concat(this.getInsertionsAt(e,4,4)),t}getInsertionsAt(e,t,n){const r=[];for(const i of BW.ORTHOGONALS){const s=new HW(t,n).getPrevious(i);if(s.isNotInRange(5,5))for(const t of BW.ORTHOGONALS){const n=o5.of(s.x,s.y,Aw.of(i),t);cZ(n.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(n.get(),e).isSuccess()&&r.push(n.get())}}return r}getMovesFrom(e,t,n,r){const i=new HW(n,r);let s=this.getRotationMovesAt(i,t);for(const o of BW.ORTHOGONALS){const t=i.getNext(o);s=s.concat(this.getForwardMovesBetween(e,i,t))}return s}getMovesBetween(e,t,n,r){return n.equals(r)?this.getRotationMovesAt(n,t):BW.factory.fromMove(n,r).isSuccess()&&1===n.getDistance(r)?this.getForwardMovesBetween(e,n,r):[]}getRotationMovesAt(e,t){const n=[],r=t.getDirection();for(const i of BW.ORTHOGONALS)if(i!==r){const t=o5.of(e.x,e.y,Aw.empty(),i).get();n.push(t)}return n}getForwardMovesBetween(e,t,n){const r=[];let i;const s=BW.factory.fromMove(t,n).get(),o=e.getPieceAt(t);i=n.isInRange(5,5)?BW.ORTHOGONALS:[s];for(const a of i){const n=o5.of(t.x,t.y,Aw.of(s),a).get();this.isLegalForwarding(n,e,o).isSuccess()&&r.push(n)}return r}getGameStatus(e){const t=this.getMountainsRowsAndColumns(e.gameState),n=this.getWinner(e.gameState,e.move,t.nbMountain);return n.isPlayer()?pj.getVictory(n):pj.ONGOING}}h5.singleton=Aw.empty(),h5.VERBOSE=!1;class d5 extends JW{getBoardValue(e){return new ej(h5.get().getBoardValueInfo(e.move,e.gameState).boardValue)}getListMoves(e){let t=[];const n=e.gameState.getCurrentPlayer();for(let r=0;r<5;r++)for(let i=0;i<5;i++){const s=e.gameState.getPieceAtXY(i,r);s.belongTo(n)&&(t=t.concat(h5.get().getMovesFrom(e.gameState,s,i,r)))}if(e.gameState.countCurrentPlayerPawn()<5)for(const r of h5.get().getInsertions(e.gameState))if(r.direction.get().getOpposite()!==r.landingOrientation){if(this.isOnBorder(r)&&r.direction.get()!==r.landingOrientation)continue;t.push(r)}return Ow(h5.VERBOSE,{getListMovesResult:t}),t}isOnBorder(e){return 0===e.coord.x||4===e.coord.x||0===e.coord.y||4===e.coord.y}}const f5=a5.EMPTY,p5=a5.MOUNTAIN,g5=a5.LIGHT_UP,m5=a5.LIGHT_LEFT,y5=a5.LIGHT_RIGHT,v5=a5.LIGHT_DOWN,C5=a5.DARK_UP,_5=a5.DARK_LEFT,E5=a5.DARK_RIGHT,w5=a5.DARK_DOWN;class P5{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,l5.getInitialState()),Cj.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Light, insert a piece on the board.`,l5.getInitialState(),o5.of(2,-1,Aw.of(BW.DOWN),BW.DOWN).get(),$localize`Congratulations!`),Cj.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new l5([[f5,f5,f5,f5,f5],[f5,f5,f5,f5,f5],[f5,p5,p5,p5,f5],[f5,f5,f5,f5,f5],[f5,f5,g5,f5,f5]],0),[o5.of(2,4,Aw.of(BW.UP),BW.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed!`),Cj.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        Get that piece out of the board!`,new l5([[f5,f5,f5,f5,f5],[f5,f5,f5,f5,f5],[f5,p5,p5,p5,f5],[f5,f5,f5,f5,f5],[f5,f5,g5,f5,f5]],0),[o5.of(2,4,Aw.of(BW.DOWN),BW.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),Cj.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new l5([[f5,y5,_5,f5,f5],[y5,E5,m5,f5,f5],[f5,f5,g5,f5,f5],[f5,f5,f5,f5,f5],[f5,f5,f5,f5,f5]],0),[o5.of(2,2,Aw.of(BW.UP),BW.UP).get()],$localize`Congratulations!`,$localize`Failed!`),Cj.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.<br/><br/>
        On the fourth row, you can push as there is one more pusher than resistant pieces. Do it.`,new l5([[f5,f5,y5,p5,f5],[f5,f5,y5,p5,m5],[f5,y5,p5,p5,f5],[f5,y5,E5,_5,p5],[f5,f5,f5,f5,f5]],0),[o5.of(1,3,Aw.of(BW.RIGHT),BW.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed!`),Cj.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, you can push a mountain off the board and either win, or lose. Choose correctly!`,new l5([[f5,f5,f5,f5,f5],[f5,f5,f5,f5,f5],[p5,C5,m5,f5,v5],[f5,f5,f5,f5,w5],[f5,f5,f5,f5,p5]],0),[o5.of(2,2,Aw.of(BW.LEFT),BW.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)]}}function S5(e,t){if(1&e){const e=va();_n(),fa(0,"use",11),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().clickSquare(t,n)}),pa()}if(2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ta("id","piece_",t,"_",r,""),ha("ngClass",i.getPieceClasses(t,r,n)),ra("transform",i.getPieceTransform(t,r))}}function b5(e,t){if(1&e){const e=va();_n(),fa(0,"use",12),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().clickSquare(t,n)}),pa()}if(2&e){const e=Sa().index,t=Sa().index,n=Sa();ra("transform","translate("+(e+1)*n.SPACE_SIZE+" "+(t+1)*n.SPACE_SIZE+")")}}function O5(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",8),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().clickSquare(t,n)}),pa(),la(2,S5,1,4,"use",9),la(3,b5,1,1,"use",10),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();ks(1),Ta("id","square_",n,"_",r,""),ha("ngClass",i.getSquareClasses(n,r)),ra("x",i.SPACE_SIZE*(n+1))("y",i.SPACE_SIZE*(r+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),ks(1),ha("ngIf",e.isPiece()),ks(1),ha("ngIf",i.isMountain(e))}}function k5(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,O5,4,9,"g",4),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function T5(e,t){if(1&e){const e=va();_n(),fa(0,"rect",15),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa().clickSquare(t.x,t.y)}),pa()}if(2&e){const e=Sa().$implicit,t=Sa();Ta("id","square_",e.x,"_",e.y,""),ha("ngClass",t.getSquareClasses(e.x,e.y)),ra("x",t.SPACE_SIZE*(e.x+1))("y",t.SPACE_SIZE*(e.y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function I5(e,t){if(1&e){const e=va();_n(),fa(0,"g"),la(1,T5,1,7,"rect",13),fa(2,"rect",14),Ea("click",function(){const t=Gt(e).$implicit;return Sa().clickSquare(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();ks(1),ha("ngIf",!1===e.isInRange(5,5)),ks(1),ra("x",n.SPACE_SIZE*(e.x+1))("y",n.SPACE_SIZE*(e.y+1))("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function A5(e,t){if(1&e){const e=va();_n(),fa(0,"rect",16),Ea("click",function(){Gt(e);const t=Sa();return t.clickSquare(t.selectedLanding.get().x,t.selectedLanding.get().y)}),pa()}if(2&e){const e=Sa();ra("x",e.SPACE_SIZE*(e.selectedLanding.get().x+1))("y",e.SPACE_SIZE*(e.selectedLanding.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function M5(e,t){if(1&e){const e=va();_n(),fa(0,"rect",16),Ea("click",function(){Gt(e);const t=Sa();return t.clickSquare(t.selectedPiece.get().x,t.selectedPiece.get().y)}),pa()}if(2&e){const e=Sa();ra("x",e.SPACE_SIZE*(e.selectedPiece.get().x+1))("y",e.SPACE_SIZE*(e.selectedPiece.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function N5(e,t){if(1&e&&(_n(),ga(0,"use",19)),2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa();Ta("id","remainingPieces_",n.value,"_",e,""),ha("ngClass",r.getRemainingPieceClasses(n,e)),ra("transform",r.getRemainingPieceTransform(e,n))}}function R5(e,t){if(1&e){const e=va();_n(),fa(0,"g",17),Ea("click",function(){const t=Gt(e).$implicit;return Sa().selectPieceForInsertion(t)}),la(1,N5,1,4,"use",18),pa()}if(2&e){const e=t.$implicit,n=Sa();ka("id","remainingPieces_",e.value,""),ks(1),ha("ngForOf",n.range(n.playerPieces(e)))}}function x5(e,t){if(1&e){const e=va();_n(),fa(0,"use",22),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa().clickSquare(t.source.get().coord.x,t.source.get().coord.y)}),pa()}if(2&e){const e=Sa().$implicit,t=Sa();ha("ngClass",t.getPieceClasses(e.source.get().coord.x,e.source.get().coord.y,e.source.get().piece)),ra("transform",t.getPieceTransform(e.source.get().coord.x,e.source.get().coord.y))}}function D5(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"use",20),Ea("click",function(){const t=Gt(e).$implicit;return Sa().clickArrow(t)}),pa(),la(2,x5,1,2,"use",21),pa()}if(2&e){const e=t.$implicit,n=Sa();ks(1),Ia("id","indicator_",e.target.x,"_",e.target.y,"_",e.direction.toString(),""),ra("transform",n.getIndicatorTransform(e)),ks(1),ha("ngIf",e.source.isPresent())}}function L5(e,t){if(1&e){const e=va();_n(),fa(0,"use",23),Ea("click",function(){const t=Gt(e).$implicit;return Sa().selectOrientation(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa();ka("id","orientation_",e.landingOrientation,""),ha("ngClass",n.getCurrentPlayerClass()),ra("transform",n.getOrientationTransform(e.landingOrientation))}}let F5=(()=>{class e extends eY{constructor(e){super(e),this.lastMove=Aw.empty(),this.movedPieces=[],this.selectedPiece=Aw.empty(),this.selectedLanding=Aw.empty(),this.orientations=[],this.clickableCoords=new nj,this.indicatorArrows=[],this.insertingPiece=!1,this.rules=h5.get(),this.availableMinimaxes=[new d5(this.rules,"SiamMinimax")],this.encoder=o5.encoder,this.tutorial=(new P5).tutorial,this.updateBoard()}updateBoard(){Ow(e.VERBOSE,"updateBoard");const t=this.getState();if(this.board=t.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=Aw.empty(),this.selectedLanding=Aw.empty(),this.orientations=[],this.clickableCoords=new nj,this.indicatorArrows=[]}selectPieceForInsertion(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#remainingPieces_"+e.value);if(n.isFailure())return t.cancelMove(n.getReason());if(e!==t.getCurrentPlayer())return t.cancelMove(XW.MUST_CHOOSE_PLAYER_PIECE());if(t.insertingPiece)return t.cancelMoveAttempt(),xw.SUCCESS;t.cancelMoveAttempt();for(const e of h5.get().getInsertions(t.getState())){const n=e.coord.getNext(e.direction.get());if(t.board[n.y][n.x]!==a5.EMPTY){const r={source:Aw.empty(),target:n,direction:e.direction.get(),move:e};t.indicatorArrows.push(r)}t.clickableCoords.add(n)}return t.insertingPiece=!0,xw.SUCCESS})()}selectOrientation(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#orientation_"+e.landingOrientation.toString());return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e,t.getState())})()}clickSquare(t,n,r=!1){var i=this;return Sw(function*(){if(Ow(e.VERBOSE,"SiamComponent.clickSquare("+t+", "+n+")"),!1===r){const e=i.canUserPlay("#square_"+t+"_"+n);if(e.isFailure())return i.cancelMove(e.getReason())}const s=new HW(t,n);if(i.insertingPiece)return i.insertPiece(s);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),xw.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=Aw.of(s);const e=h5.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),s);return 0===e.length?i.changeMoveDestinationClick(s):i.performMoveOrShowOrientationArrows(e)}{cZ(i.getState().isOnBoard(s),"SiamComponent: user clicked outside of board when it should not be possible");const e=i.board[n][t];return e.getOwner()!==i.getCurrentPlayer()?i.cancelMove(XW.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(s,e)}})()}insertPiece(e){var t=this;return Sw(function*(){if(t.selectedLanding.isPresent())return t.cancelMove(c5.MUST_SELECT_ORIENTATION()),xw.SUCCESS;t.selectedLanding=Aw.of(e);const n=h5.get().getInsertionsAt(t.getState(),e.x,e.y);return 0===n.length?t.changeMoveDestinationClick(e):t.performMoveOrShowOrientationArrows(n)})()}changeMoveDestinationClick(e){var t=this;return Sw(function*(){return t.cancelMoveAttempt(),t.getState().getPieceAt(e).getOwner()===t.getCurrentPlayer()?t.clickSquare(e.x,e.y,!0):t.cancelMove(c5.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var t=this;return Sw(function*(){return cZ(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(t.cancelMove(),t.chooseMove(e[0],t.getState())):(t.clickableCoords=new nj,t.indicatorArrows=[],t.orientations=e,xw.SUCCESS)})()}selectPiece(e,t){this.cancelMoveAttempt();const n=this.getState();this.selectedPiece=Aw.of(e);const r=h5.get().getMovesFrom(n,t,e.x,e.y);for(const i of r)if(i.direction.isPresent()){const r=i.coord.getNext(i.direction.get());if(this.clickableCoords.add(r),n.isOnBoard(r)&&n.getPieceAt(r)!==a5.EMPTY){const n={source:Aw.of({coord:e,piece:t}),target:r,direction:i.direction.get(),move:i};this.indicatorArrows.push(n)}}else this.clickableCoords.add(i.coord);return xw.SUCCESS}clickArrow(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e.move,t.getState())})()}isMountain(e){return e===a5.MOUNTAIN}getArrowTransform(e,t,n){const r=`rotate(${90*(n.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}getPieceTransform(e,t){return this.getArrowTransform(e+1,t+1,this.board[t][e].getDirection())}getIndicatorTransform(e){const t=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(t.x+1,t.y+1,e.direction)}getRemainingPieceTransform(e,t){const n=this.playerPieces(t);let r,i,s=2;return t===bZ.ONE?(s+=(n-e+(5-n)/2)/3,r=-1,i=BW.RIGHT):(s+=(e+1+(5-n)/2)/3,r=7,i=BW.LEFT),this.getArrowTransform(s,r,i)}getOrientationTransform(e){const t=`translate(0, ${this.SPACE_SIZE/1.6})`,n=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",n,t].join(" ")}getPieceClasses(e,t,n){const r=new HW(e,t),i=[this.getPlayerClass(n.getOwner())];return this.selectedPiece.equalsValue(r)&&i.push("selected-stroke"),i}getSquareClasses(e,t){const n=new HW(e,t);return this.movedPieces.some(e=>e.equals(n))?["moved-fill"]:[]}getRemainingPieceClasses(e,t){const n=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&t===this.playerPieces(e)-1&&n.push("selected-stroke"),n}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-siam"]],features:[Go],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"defs"),ga(2,"polygon",1),ga(3,"polygon",2),ga(4,"polygon",3),pa(),la(5,k5,2,1,"g",4),la(6,I5,3,5,"g",4),la(7,A5,1,4,"rect",5),la(8,M5,1,4,"rect",5),la(9,R5,2,2,"g",6),la(10,D5,3,5,"g",4),la(11,L5,1,3,"use",7),pa()),2&e&&(ks(5),ha("ngForOf",t.board),ks(1),ha("ngForOf",t.clickableCoords),ks(1),ha("ngIf",t.selectedLanding.isPresent()),ks(1),ha("ngIf",t.selectedPiece.isPresent()),ks(1),ha("ngForOf",t.Player.PLAYERS),ks(1),ha("ngForOf",t.indicatorArrows),ks(1),ha("ngForOf",t.orientations))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),U5=(()=>{class e{}return e.NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`,e.MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`,e.CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`,e.CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`,e.MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`,e.CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`,e.MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`,e})();class V5 extends rj{constructor(e,t,n){super(t),this.pieces=e;const r=this.getCalculatedScale();this.pieces=r.pieces,this.width=r.width,this.height=r.height,this.offset=n??r.offset,this.pieces.makeImmutable()}static getInitialState(){return V5.fromRepresentation([[bZ.ZERO.value],[bZ.ONE.value]],0)}static fromRepresentation(e,t,n){const r=new hj;for(let i=0;i<e.length;i++)for(let t=0;t<e[0].length;t++)e[i][t]!==OZ.NONE.value&&r.set(new HW(t,i),bZ.of(e[i][t]));return new V5(r,t,n)}static deplacePiece(e,t){const n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}static getGroups(e,t){let n=new hj,r=0;for(const o of WW.factory.all){const i=t.getNext(o,1);n=V5.putCoordInGroup(e,i,n,""+r),r++}const i=n.reverse(),s=new nj;for(let o=0;o<i.size();o++)s.add(i.getByIndex(o).value);return s}static putCoordInGroup(e,t,n,r){if(e.get(t).isPresent()&&n.get(t).isAbsent()){n.set(t,r);for(const i of WW.factory.all){const s=t.getNext(i,1);n=V5.putCoordInGroup(e,s,n,r)}}return n}getCalculatedScale(){let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER;for(const o of this.pieces.listKeys())e=Math.min(o.x,e),t=Math.max(o.x,t),n=Math.min(o.y,n),r=Math.max(o.y,r);let i=new hj;const s=new LW(-e,-n);if(0!==e||0!==n)for(const o of this.pieces.listKeys()){const e=this.pieces.delete(o),t=o.getNext(s);i.set(t,e)}else i=this.pieces;return{width:t+1-e,height:r+1-n,pieces:i,offset:s}}toRepresentation(){const e=AZ.createTable(this.width,this.height,OZ.NONE.value);for(const t of this.pieces.listKeys()){const n=this.getPieceAt(t).value;e[t.y][t.x]=n}return e}isIllegalLandingZone(e,t){return this.pieces.containsKey(e)?xw.failure(XW.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?xw.SUCCESS:xw.failure(U5.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(e,t){for(const n of WW.factory.all){const r=e.getNext(n,1);if(this.pieces.containsKey(r)&&!1===t.equalsValue(r))return!0}return!1}isOnBoard(e){return this.pieces.containsKey(e)}getPieceAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():OZ.NONE}applyLegalDrop(e){const t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new V5(t,this.turn+1)}applyLegalDeplacement(e,t){const n=V5.deplacePiece(this,e);let r=new hj;if(t.size()>0){r=new hj;for(const e of t)r.set(e,n.get(e).get())}else r=n.getCopy();return new V5(r,this.turn+1)}countPieces(){const e=this.pieces.reverse(),t=e.get(bZ.ZERO).getOrElse(new kY),n=e.get(bZ.ONE).getOrElse(new kY);return[t.size(),n.size()]}switchPiece(e){const t=this.pieces.getCopy(),n=this.getPieceAt(e);if(n.isPlayer())return t.replace(e,n.getOpponent()),new V5(t,this.turn,this.offset);lZ.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}equals(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}class B5 extends oj{constructor(e,t,n){if(super(),this.start=e,this.landing=t,this.keep=n,e.equalsValue(t))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(n))throw new Error("Cannot keep starting coord, since it will always be empty after move!")}static fromDrop(e){return new B5(Aw.empty(),e,Aw.empty())}static fromMovement(e,t){return new B5(Aw.of(e),t,Aw.empty())}static fromCut(e,t,n){return new B5(Aw.of(e),t,Aw.of(n))}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}B5.encoder=new class extends wZ{encodeMove(e){return{start:e.start.isPresent()?HW.encoder.encode(e.start.get()):null,landing:HW.encoder.encode(e.landing),keep:e.keep.isPresent()?HW.encoder.encode(e.keep.get()):null}}decodeMove(e){const t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");const n=HW.encoder.decode(t.landing);if(null==t.start)return B5.fromDrop(n);const r=HW.encoder.decode(t.start);if(null==t.keep)return B5.fromMovement(r,n);{const e=HW.encoder.decode(t.keep);return B5.fromCut(r,n,e)}}};class $5 extends gj{constructor(){super(...arguments),this.VERBOSE=!1}applyLegalMove(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}isLegal(e,t){Ow(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});const n=t.isIllegalLandingZone(e.landing,e.start);return n.isFailure()?n.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):$5.isLegalPhaseTwoMove(e,t)}static getLegalLandings(e){const t=new kY;for(const n of e.pieces.listKeys())for(const r of WW.factory.all){const i=n.getNext(r,1);e.getPieceAt(i)===OZ.NONE&&t.add(i)}return t.toList()}isLegalDrop(e,t){return!1===e.isDrop()?Mw.failure(U5.NO_MOVEMENT_BEFORE_TURN_40()):Mw.success(t.pieces.getKeySet())}static isLegalPhaseTwoMove(e,t){if(e.isDrop())return Mw.failure(U5.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case OZ.NONE:return Mw.failure(XW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return Mw.failure(XW.CANNOT_CHOOSE_OPPONENT_PIECE())}const n=V5.deplacePiece(t,e),r=V5.getGroups(n,e.start.get());if($5.isSplit(r)){const t=this.getBiggerGroups(r);return 1===t.size()?e.keep.isPresent()?Mw.failure(U5.CANNOT_CHOOSE_TO_KEEP()):Mw.success(t.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,t,n)}return Mw.success(new kY)}static isSplit(e){return e.size()>1}static getBiggerGroups(e){let t=0,n=new nj;for(const r of e){const e=r.size();e>t?(t=e,n=new nj([r])):e===t&&n.add(r)}return n}static moveKeepBiggerGroup(e,t,n){if(e.isAbsent())return Mw.failure(U5.MUST_CUT());if(n.get(e.get()).isAbsent())return Mw.failure(U5.CANNOT_KEEP_EMPTY_COORD());const r=e.get();for(const i of t)if(i.contains(r))return Mw.success(i);return Mw.failure(U5.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return pj.getVictory(n);if(t.turn>39){const e=t.countPieces(),n=e[0],r=e[1];return n<6&&r<6?n<r?pj.ONE_WON:r<n?pj.ZERO_WON:pj.DRAW:n<6?pj.getDefeat(bZ.ZERO):r<6?pj.getDefeat(bZ.ONE):pj.ONGOING}return pj.ONGOING}startSearchingVictorySources(){Ow(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const r=t.landing.getNext(n.offset,1);switch(Ow(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}searchVictoryOnlyForCircle(e,t,n){Ow(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent(),i=[t];let s=t.getNext(WW.factory.all[e],1);for(;i.length<6;){if(n.getPieceAt(s)!==r)return[];const t=(e+i.length)%6;i.push(s),s=s.getNext(WW.factory.all[t],1)}return i}searchVictoryOnlyForLine(e,t,n){const r=n.getCurrentOpponent();let i=WW.factory.all[e],s=t.getNext(i,1);const o=[t];let a=!1;for(;o.length<6;){if(n.getPieceAt(s)===r)o.push(s);else{if(a)return[];a=!0,i=i.getOpposite(),s=s.getNext(i,o.length)}s=s.getNext(i,1)}return o}searchVictoryOnlyForTriangleCorner(e,t,n){Ow(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=WW.factory.all[e];const s=[t];let o=t.getNext(i,1);for(;s.length<6;){if(n.getPieceAt(o)!==r)return[];s.length%2==0&&(i=WW.factory.all[(e+s.length)%6]),s.push(o),o=o.getNext(i,1)}return s}searchVictoryOnlyForTriangleEdge(e,t,n){Ow(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=WW.factory.all[e];const s=[t];let o=t.getNext(i,1);for(;s.length<6;){if(n.getPieceAt(o)!==r)return[];s.push(o),s.length%2==0&&(i=WW.factory.all[(e+s.length)%6]),o=o.getNext(i,1)}return s}}class z5 extends JW{calculateBoardValue(e,t){this.startSearchingVictorySources();let n={status:cj.DEFAULT,victory:Aw.empty(),preVictory:Aw.empty(),sum:0};for(;this.hasNextVictorySource();){const r=this.getNextVictorySource();let i;if(i=n.status===cj.PRE_VICTORY?this.searchVictoryOnly(r,e,t):this.getBoardInfo(r,e,t,n),i.status===cj.VICTORY)return i;n={status:i.status,victory:Aw.empty(),preVictory:i.preVictory,sum:n.sum+i.sum}}return n}}class H5 extends ej{constructor(e,t){super(e),this.value=e,this.preVictory=t}}class G5 extends z5{constructor(){super(...arguments),this.VERBOSE=!1}static get(){if(G5.singleton.isAbsent()){const e=new $5(V5);G5.singleton=Aw.of(new G5(e,"SixMinimax"))}return G5.singleton.get()}getListMoves(e){const t=G5.get(),n=e.getOwnValue(t);if(n.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(n):this.createForcedDeplacement(e,n);const r=$5.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(r):this.getListDeplacement(e.gameState,r)}createForcedDrop(e){Ow(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});const t=[],n=B5.fromDrop(e.preVictory.get());return t.push(n),t}createForcedDeplacement(e,t){Ow(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});const n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}getDeplacementFrom(e,t,n){const r=[];for(const i of t)for(const t of n){const n=B5.fromMovement(i,t);if(e.isCoordConnected(t,Aw.of(i))){const s=V5.deplacePiece(e,n),o=V5.getGroups(s,n.start.get());if($5.isSplit(o))for(const e of o){const n=e.getAnyElement().get(),s=B5.fromCut(i,t,n);r.push(s)}else r.push(n)}}return r}getSafelyMovablePieceOrFirstOne(e){const t=e.gameState,n=t.pieces.reverse(),r=t.getCurrentPlayer(),i=n.get(r).get(),s=i.getAnyElement().get(),o=[];for(const a of i)!1===this.isPieceBlockingAVictory(t,a)&&o.push(a);return new kY(0===o.length?[s]:o)}isPieceBlockingAVictory(e,t){const n=e.switchPiece(t),r=B5.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===cj.VICTORY)return!0;return!1}getListDrop(e){const t=[];for(const n of e){const e=B5.fromDrop(n);t.push(e)}return t}getListDeplacement(e,t){const n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}getBoardValue(e){const t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue();let s={status:cj.DEFAULT,victory:Aw.empty(),preVictory:Aw.empty(),sum:0};t.isPresent()&&(s=this.calculateBoardValue(t.get(),n));let o=Aw.empty();if(s.status===cj.DEFAULT&&s.preVictory.isPresent()&&(o=Aw.of(s.preVictory.get())),s.status===cj.VICTORY)return new H5(i,Aw.empty());if(n.turn>39){const e=n.countPieces(),t=e[0],r=e[1];return t<6&&r<6?new H5(t<r?bZ.ONE.getVictoryValue():r<t?bZ.ZERO.getVictoryValue():0,Aw.empty()):t<6?new H5(bZ.ZERO.getDefeatValue(),Aw.empty()):r<6?new H5(bZ.ONE.getDefeatValue(),Aw.empty()):new H5(t-r,o)}return new H5(s.status===cj.PRE_VICTORY?r.getPreVictory():s.sum*r.getScoreModifier(),o)}startSearchingVictorySources(){Ow(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const r=t.landing.getNext(n.offset,1);switch(Ow(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}searchVictoryOnlyForCircle(e,t,n){Ow(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent(),i=[t];let s=t.getNext(WW.factory.all[e],1);for(;i.length<6;){if(n.getPieceAt(s)!==r)return{status:cj.PRE_VICTORY,victory:Aw.empty(),preVictory:Aw.empty(),sum:0};const t=(e+i.length)%6;i.push(s),s=s.getNext(WW.factory.all[t],1)}return{status:cj.VICTORY,victory:Aw.of(i),preVictory:Aw.empty(),sum:0}}searchVictoryOnlyForLine(e,t,n){const r=n.getCurrentOpponent();let i=WW.factory.all[e],s=t.getNext(i,1);const o=[t];let a=!1;for(;o.length<6;){if(n.getPieceAt(s)===r)o.push(s);else{if(a)return{status:cj.PRE_VICTORY,victory:Aw.empty(),preVictory:Aw.empty(),sum:0};a=!0,i=i.getOpposite(),s=s.getNext(i,o.length-1)}s=s.getNext(i,1)}return{status:cj.VICTORY,victory:Aw.of(o),preVictory:Aw.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(e,t,n){Ow(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=WW.factory.all[e];const s=[t];let o=t.getNext(i,1);for(;s.length<6;){if(n.getPieceAt(o)!==r)return{status:cj.PRE_VICTORY,victory:Aw.empty(),preVictory:Aw.empty(),sum:0};s.length%2==0&&(i=WW.factory.all[(e+s.length)%6]),s.push(o),o=o.getNext(i,1)}return{status:cj.VICTORY,victory:Aw.of(s),preVictory:Aw.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(e,t,n){Ow(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=WW.factory.all[e];const s=[t];let o=t.getNext(i,1);for(;s.length<6;){if(n.getPieceAt(o)!==r)return{status:cj.PRE_VICTORY,victory:Aw.empty(),preVictory:Aw.empty(),sum:0};s.push(o),s.length%2==0&&(i=WW.factory.all[(e+s.length)%6]),o=o.getNext(i,1)}return{status:cj.VICTORY,victory:Aw.of(s),preVictory:Aw.empty(),sum:0}}getBoardInfo(e,t,n,r){Ow(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});const i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}getBoardInfoForCircle(e,t,n,r){Ow(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});const i=n.getCurrentPlayer(),s=[t];let o=t.getNext(WW.factory.all[e],1),a=0,l=Aw.empty();for(;s.length<6;){const t=n.getPieceAt(o);if(t===i)return r;const c=(e+s.length)%6;s.push(o);const u=WW.factory.all[c];t===OZ.NONE?(a+=.16,l=Aw.of(o)):a++,o=o.getNext(u,1)}return this.getBoardInfoResult(a,l,s,r)}getBoardInfoResult(e,t,n,r){let i=r.preVictory;if(4.16===e){if(Ow(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:cj.PRE_VICTORY,victory:Aw.empty(),preVictory:Aw.empty(),sum:0};i=t}else if(5===e)return{status:cj.VICTORY,victory:Aw.of(n),preVictory:Aw.empty(),sum:0};return{status:r.status,victory:Aw.empty(),preVictory:i,sum:r.sum+e}}getBoardInfoForLine(e,t,n,r){Ow(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});const i=WW.factory.all[e];let s=t.getPrevious(i,5),o=[],a=[],l=Aw.empty();for(let p=0;p<6;p++){const e=this.updateEncounterAndReturnLastEmpty(n,s,a);e.isPresent()&&(l=e),o.push(s),s=s.getNext(i,1)}let c=r.status,u=r.preVictory,h=0,d=0;for(;h<6;){const e=a.reduce((e,t)=>e+t);if(6===e)return{status:cj.VICTORY,victory:Aw.of(o),preVictory:Aw.empty(),sum:0};5.16===e&&c===cj.DEFAULT&&(u.isPresent()?(cZ(!1===u.equals(l),"Impossible to have point aligned with differents line to a same point"),c=cj.PRE_VICTORY):u=l),d=Math.max(d,e),o=o.slice(1,6),o.push(s),a=a.slice(1,6);const t=this.updateEncounterAndReturnLastEmpty(n,s,a);t.isPresent()&&(l=t),h++,s=s.getNext(i,1)}const f={status:c,victory:Aw.of(o),preVictory:u,sum:d};return this.getBoardInfoResult(d,l,o,f)}updateEncounterAndReturnLastEmpty(e,t,n){const r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),Aw.empty();case OZ.NONE:return n.push(.16),Aw.of(t);default:return n.push(1),Aw.empty()}}getBoardInfoForTriangleCorner(e,t,n,r){Ow(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});const i=n.getCurrentPlayer();let s=WW.factory.all[e];const o=[t];let a=t.getNext(s,1),l=0,c=Aw.empty();for(;o.length<6;){const t=n.getPieceAt(a);if(t===i)return r;t===OZ.NONE?(l+=.16,c=Aw.of(a)):l++,o.length%2==0&&(s=WW.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(s,1)}return this.getBoardInfoResult(l,c,o,r)}getBoardInfoForTriangleEdge(e,t,n,r){Ow(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});const i=n.getCurrentPlayer();let s=WW.factory.all[e];const o=[t];let a=t.getNext(s,1),l=0,c=Aw.empty();for(;o.length<6;){const t=n.getPieceAt(a);if(t===i)return r;t===OZ.NONE?(l+=.16,c=Aw.of(a)):l++,o.push(a),o.length%2==0&&(s=WW.factory.all[(e+o.length)%6]),a=a.getNext(s,1)}return this.getBoardInfoResult(l,c,o,r)}}G5.singleton=Aw.empty();const Z5=OZ.NONE.value,q5=bZ.ZERO.value,W5=bZ.ONE.value;let j5=(()=>{class e{}return e.MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`,e.MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`,e})();class Y5{constructor(){this.tutorial=[Cj.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,V5.getInitialState()),Cj.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,V5.fromRepresentation([[q5,W5,W5,W5,W5,q5],[Z5,q5,W5,Z5,q5,Z5],[W5,W5,q5,Z5,Z5,Z5],[Z5,Z5,q5,Z5,Z5,Z5],[Z5,q5,Z5,Z5,Z5,Z5],[q5,Z5,Z5,Z5,Z5,Z5]],0),[B5.fromDrop(new HW(3,2))],$localize`Congratulations!`,$localize`Failed!`),Cj.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,V5.fromRepresentation([[Z5,Z5,Z5,W5,Z5,Z5],[Z5,Z5,W5,W5,q5,q5],[Z5,W5,Z5,q5,W5,Z5],[W5,q5,q5,q5,q5,W5]],0),[B5.fromDrop(new HW(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed!`),Cj.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,V5.fromRepresentation([[Z5,Z5,Z5,W5,Z5,Z5],[Z5,q5,W5,q5,q5,q5],[Z5,q5,Z5,q5,q5,Z5],[W5,W5,W5,Z5,W5,Z5]],0),[B5.fromDrop(new HW(3,3))],$localize`Congratulations!`,$localize`Failed!`),Cj.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,V5.fromRepresentation([[Z5,Z5,Z5,Z5,Z5,Z5,Z5,W5,Z5],[Z5,Z5,Z5,Z5,Z5,Z5,q5,Z5,Z5],[Z5,Z5,Z5,Z5,q5,q5,q5,Z5,Z5],[Z5,Z5,Z5,Z5,W5,W5,Z5,W5,q5],[Z5,q5,W5,W5,q5,q5,W5,Z5,Z5],[q5,q5,q5,q5,W5,W5,W5,q5,Z5],[W5,W5,q5,Z5,W5,W5,q5,Z5,Z5],[Z5,q5,Z5,q5,q5,Z5,Z5,Z5,Z5],[W5,W5,W5,W5,Z5,Z5,Z5,Z5,Z5],[Z5,q5,Z5,W5,Z5,Z5,Z5,Z5,Z5]],40),B5.fromMovement(new HW(6,1),new HW(5,1)),(e,t,n)=>{const r=n.countPieces();return 19===r[0]?18===r[1]?xw.SUCCESS:xw.failure(j5.MOVEMENT_NOT_DISCONNECTING()):xw.failure(j5.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),Cj.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,V5.fromRepresentation([[Z5,Z5,Z5,Z5,Z5,W5],[Z5,Z5,Z5,Z5,q5,W5],[Z5,Z5,Z5,W5,q5,q5],[Z5,Z5,q5,Z5,W5,q5],[W5,W5,Z5,Z5,Z5,q5],[q5,W5,Z5,Z5,Z5,Z5],[q5,Z5,Z5,Z5,Z5,Z5]],40),B5.fromMovement(new HW(2,3),new HW(3,3)),(e,t,n)=>e.start.equalsValue(new HW(2,3))?xw.SUCCESS:xw.failure(j5.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),Cj.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,V5.fromRepresentation([[Z5,Z5,Z5,Z5,Z5,W5],[Z5,Z5,Z5,Z5,q5,W5],[Z5,Z5,Z5,W5,q5,q5],[q5,Z5,q5,Z5,Z5,W5],[W5,W5,Z5,Z5,Z5,Z5],[q5,q5,Z5,Z5,Z5,Z5],[q5,Z5,Z5,Z5,Z5,Z5]],40),B5.fromCut(new HW(2,3),new HW(2,5),new HW(2,5)),(e,t,n)=>e.keep.isAbsent()?xw.failure($localize`This move has not cut the board in two equal halves.`):n.getPieceAt(e.landing.getNext(n.offset))===OZ.NONE?xw.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):xw.SUCCESS,$localize`Congratulations, you won!`)]}}function K5(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",10),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onPieceClick(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa();Ta("id","piece_",e.x,"_",e.y,""),ha("ngClass",n.getPieceClass(e)),ra("points",n.getHexaCoordsAt(e))}}function Q5(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",11),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onNeighborClick(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa();Ta("id","neighbor_",e.x,"_",e.y,""),ra("points",n.getHexaCoordsAt(e))}}function X5(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",10),Ea("click",function(){Gt(e);const t=Sa();return t.onPieceClick(t.chosenLanding.get())}),pa()}if(2&e){const e=Sa();Ta("id","chosenLanding_",e.chosenLanding.get().x,"_",e.chosenLanding.get().y,""),ha("ngClass",e.getPlayerClass(e.state.getCurrentPlayer())),ra("points",e.getHexaCoordsAt(e.chosenLanding.get()))}}function J5(e,t){if(1&e&&(_n(),ga(0,"polygon",12)),2&e){const e=t.$implicit,n=Sa();Ta("id","disconnected_",e.x,"_",e.y,""),ra("points",n.getHexaCoordsAt(e))}}function e6(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",13),Ea("click",function(){Gt(e);const t=Sa();return t.onNeighborClick(t.leftCoord.get())}),pa()}if(2&e){const e=Sa();Ta("id","leftCoord_",e.leftCoord.get().x,"_",e.leftCoord.get().y,""),ra("points",e.getHexaCoordsAt(e.leftCoord.get()))}}function t6(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",14),Ea("click",function(){Gt(e);const t=Sa();return t.onPieceClick(t.lastDrop.get())}),pa()}if(2&e){const e=Sa();Ta("id","lastDrop_",e.lastDrop.get().x,"_",e.lastDrop.get().y,""),ra("points",e.getHexaCoordsAt(e.lastDrop.get()))}}function n6(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",15),Ea("click",function(){Gt(e);const t=Sa();return t.onPieceClick(t.selectedPiece.get())}),pa()}if(2&e){const e=Sa();Ta("id","selectedPiece_",e.selectedPiece.get().x,"_",e.selectedPiece.get().y,""),ha("ngClass",e.getSelectedPieceClass()),ra("points",e.getHexaCoordsAt(e.selectedPiece.get()))}}function r6(e,t){if(1&e&&(_n(),ga(0,"polygon",16)),2&e){const e=t.$implicit,n=Sa();Ta("id","victoryCoord_",e.x,"_",e.y,""),ra("points",n.getHexaCoordsAt(e))}}function i6(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",19),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).onPieceClick(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa(2);Ta("id","cuttable_",e.x,"_",e.y,""),ra("points",n.getHexaCoordsAt(e))}}function s6(e,t){if(1&e&&(_n(),fa(0,"g",17),la(1,i6,1,3,"polygon",18),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}let o6=(()=>{class e extends ZW{constructor(e){super(e),this.disconnecteds=[],this.cuttableGroups=[],this.leftCoord=Aw.empty(),this.lastDrop=Aw.empty(),this.selectedPiece=Aw.empty(),this.chosenLanding=Aw.empty(),this.nextClickShouldSelectGroup=!1,this.rules=new $5(V5),this.availableMinimaxes=[new G5(this.rules,"SixMinimax")],this.encoder=B5.encoder,this.tutorial=(new Y5).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new jW(1.5*this.SPACE_SIZE,new HW(2*this.SPACE_SIZE,0),QW.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=Aw.empty(),this.chosenLanding=Aw.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=Aw.empty(),this.lastDrop=Aw.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}getViewBox(){const e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}mapAbstractCoordToCornerCoords(){const e=this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(e=>this.hexaLayout.getHexaCoordsAt(e));let t=[];for(const n of e)t=t.concat(n);return t}getLimits(e){let t=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;for(const s of e)s.x<r&&(r=s.x),s.y<i&&(i=s.y),t=Math.max(t,s.x),n=Math.max(n,s.y);return{minX:r,minY:i,maxX:t,maxY:n}}showLastMove(){const e=this.rules.node.move.get();this.lastDrop=Aw.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?Aw.of(e.start.get().getNext(this.state.offset,1)):Aw.empty();const t=this.getState();this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const e=this.rules.node.mother.get().gameState.pieces.listKeys(),t=this.getState().pieces.listKeys(),n=[];for(const i of e)!1===this.rules.node.move.get().start.equalsValue(i)&&!1===t.some(e=>e.equals(i.getNext(this.state.offset,1)))&&n.push(i.getNext(this.state.offset,1));const r=this.lastDrop.get();return!1===this.pieces.some(e=>e.equals(r))&&!1===t.some(e=>e.equals(r))&&n.push(r),n}getEmptyNeighbors(){let e=$5.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const t=this.chosenLanding.get();e=e.filter(e=>!1===e.equals(t))}return e}getPieceClass(e){const t=this.getState().getPieceAt(e);return this.getPlayerClass(t)}onPieceClick(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#piece_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.state.turn<40)return t.cancelMove(U5.NO_MOVEMENT_BEFORE_TURN_40());if(t.chosenLanding.isAbsent())return t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(XW.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=t.selectedPiece.equalsValue(e)?Aw.empty():Aw.of(e),xw.SUCCESS);{const n=B5.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e);return t.chooseMove(n,t.state)}})()}onNeighborClick(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#neighbor_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.nextClickShouldSelectGroup)return t.cancelMove(U5.MUST_CUT());if(t.state.turn<40)return t.chooseMove(B5.fromDrop(e),t.state);if(t.selectedPiece.isAbsent())return t.cancelMove(U5.CAN_NO_LONGER_DROP());{const n=B5.fromMovement(t.selectedPiece.get(),e),r=$5.isLegalPhaseTwoMove(n,t.state);return t.neededCutting(r)?(t.chosenLanding=Aw.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,xw.SUCCESS):t.chooseMove(n,t.state)}})()}neededCutting(e){return e.isFailure()&&e.getReason()===U5.MUST_CUT()}moveVirtuallyPiece(){const e=this.selectedPiece.get();this.pieces=this.pieces.filter(t=>!1===t.equals(e)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const e=B5.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=V5.deplacePiece(this.state,e),n=V5.getGroups(t,e.start.get()),r=$5.getBiggerGroups(n);this.cuttableGroups=[];for(const i of r)this.cuttableGroups.push(i.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-six"]],features:[Go],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-fill mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-fill","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,K5,1,4,"polygon",1),la(2,Q5,1,3,"polygon",2),la(3,X5,1,4,"polygon",3),la(4,J5,1,3,"polygon",4),la(5,e6,1,3,"polygon",5),la(6,t6,1,3,"polygon",6),la(7,n6,1,4,"polygon",7),la(8,r6,1,3,"polygon",8),la(9,s6,2,1,"g",9),pa()),2&e&&(ra("viewBox",t.viewBox),ks(1),ha("ngForOf",t.pieces),ks(1),ha("ngForOf",t.neighbors),ks(1),ha("ngIf",t.chosenLanding.isPresent()),ks(1),ha("ngForOf",t.disconnecteds),ks(1),ha("ngIf",t.leftCoord.isPresent()),ks(1),ha("ngIf",t.lastDrop.isPresent()),ks(1),ha("ngIf",t.selectedPiece.isPresent()),ks(1),ha("ngForOf",t.victoryCoords),ks(1),ha("ngForOf",t.cuttableGroups))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class a6 extends fY{static of(e,t){return new a6(e,t)}static from(e,t){try{const n=new a6(e,t);return Mw.success(n)}catch(n){return Mw.failure(n.message)}}getMaximalDistance(){return 9}}a6.encoder=hY.getEncoder(9,9,a6.of);const l6={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:bZ.ZERO};class c6 extends vY{static getInitialState(){const e=mY.UNOCCUPIED,t=mY.INVADERS,n=mY.DEFENDERS;return new c6([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,n,e,e,e,e],[t,e,e,e,n,e,e,e,t],[t,t,n,n,mY.PLAYER_ONE_KING,n,n,t,t],[t,e,e,e,n,e,e,e,t],[e,e,e,e,n,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}from(e,t){return new c6(e,t)}}class u6 extends _Y{constructor(){super(c6,l6,a6.of)}static get(){return null==u6.singleton&&(u6.singleton=new u6),fj.ruler=this.singleton,u6.singleton}}const h6=mY.UNOCCUPIED,d6=mY.INVADERS,f6=mY.DEFENDERS,p6=mY.PLAYER_ONE_KING;class g6{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,c6.getInitialState()),Cj.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,c6.getInitialState(),a6.of(new HW(4,1),new HW(1,1)),$localize`Congratulations!`),Cj.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it.`,new c6([[h6,h6,h6,d6,d6,d6,h6,h6,h6],[h6,h6,h6,h6,d6,h6,h6,h6,h6],[h6,h6,h6,h6,f6,h6,h6,h6,h6],[h6,h6,h6,d6,f6,h6,h6,h6,d6],[d6,d6,f6,f6,p6,f6,f6,d6,d6],[h6,h6,h6,h6,f6,h6,h6,h6,d6],[h6,h6,h6,h6,f6,h6,h6,h6,h6],[h6,h6,h6,h6,d6,h6,h6,h6,h6],[h6,h6,h6,d6,d6,d6,h6,h6,h6]],1),[a6.of(new HW(2,4),new HW(2,3)),a6.of(new HW(4,2),new HW(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),Cj.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it.`,new c6([[h6,h6,h6,d6,d6,d6,h6,h6,h6],[h6,h6,h6,h6,d6,h6,h6,h6,h6],[h6,h6,h6,h6,f6,h6,h6,h6,h6],[h6,h6,f6,h6,p6,h6,f6,h6,d6],[d6,d6,h6,f6,h6,f6,f6,d6,d6],[h6,h6,h6,h6,f6,h6,h6,h6,d6],[h6,h6,h6,h6,f6,h6,h6,h6,h6],[h6,h6,h6,h6,d6,h6,h6,h6,h6],[h6,h6,h6,d6,d6,d6,h6,h6,h6]],12),[a6.of(new HW(1,4),new HW(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),Cj.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king.`,new c6([[h6,h6,h6,h6,h6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6],[h6,d6,h6,h6,h6,h6,h6,h6,h6],[d6,p6,h6,d6,h6,h6,h6,h6,h6],[h6,d6,h6,h6,h6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6]],72),[a6.of(new HW(3,4),new HW(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),Cj.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king.`,new c6([[h6,h6,d6,p6,d6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6],[h6,h6,h6,d6,h6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6],[h6,h6,h6,h6,h6,h6,h6,h6,h6]],72),[a6.of(new HW(3,3),new HW(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`)]}}function m6(e,t){1&e&&(_n(),ga(0,"polygon",8))}function y6(e,t){1&e&&(_n(),ga(0,"rect",9))}function v6(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,m6,1,0,"polygon",6),la(2,y6,1,0,"ng-template",null,7,ju),pa()),2&e){const e=ca(3),t=Sa().index,n=Sa().index,r=Sa();ks(1),ha("ngIf",r.isCentralThrone(t,n))("ngIfElse",e)}}function C6(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"line",13),ga(2,"line",13),ga(3,"line",13),ga(4,"line",13),ga(5,"line",13),pa()),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.04*n.SPACE_SIZE)("x2",.5*n.SPACE_SIZE)("y2",.96*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.1*n.SPACE_SIZE)("y2",.6*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.9*n.SPACE_SIZE)("y2",.6*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.4*n.SPACE_SIZE)("x2",.15*n.SPACE_SIZE)("y2",.75*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.4*n.SPACE_SIZE)("x2",.85*n.SPACE_SIZE)("y2",.75*n.SPACE_SIZE)}}function _6(e,t){if(1&e&&(_n(),ga(0,"polyline",16)),2&e){const e=Sa(3).index,t=Sa().index;ha("ngClass",Sa().viewInfo.pieceClasses[t][e])}}function E6(e,t){if(1&e&&(_n(),ga(0,"line",13),ga(1,"line",13),ga(2,"line",13),ga(3,"line",13)),2&e){const e=Sa(3).index,t=Sa().index,n=Sa();ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.04*n.SPACE_SIZE)("x2",.5*n.SPACE_SIZE)("y2",.96*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.04*n.SPACE_SIZE)("y1",.5*n.SPACE_SIZE)("x2",.96*n.SPACE_SIZE)("y2",.5*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.2*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.8*n.SPACE_SIZE)("y2",.8*n.SPACE_SIZE),ks(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.8*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.2*n.SPACE_SIZE)("y2",.8*n.SPACE_SIZE)}}function w6(e,t){if(1&e&&(_n(),la(0,_6,1,1,"polyline",14),la(1,E6,4,20,"ng-template",null,15,ju)),2&e){const e=ca(2),t=Sa(2).index,n=Sa().index;ha("ngIf",Sa().isKing(t,n))("ngIfElse",e)}}function P6(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",10),la(2,C6,6,25,"g",11),la(3,w6,3,2,"ng-template",null,12,ju),pa()),2&e){const e=ca(4),t=Sa().index,n=Sa().index,r=Sa();ks(1),Ta("id","piece_",t,"_",n,""),ha("ngClass",r.viewInfo.pieceClasses[n][t]),ra("r",r.SPACE_SIZE/2-r.STROKE_WIDTH)("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE),ks(1),ha("ngIf",r.isInvader(t,n))("ngIfElse",e)}}function S6(e,t){if(1&e){const e=va();_n(),fa(0,"g",3),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),ga(1,"rect",4),la(2,v6,4,2,"g",5),la(3,P6,5,8,"g",5),pa()}if(2&e){const e=t.index,n=Sa().index,r=Sa();Ta("id","click_",e,"_",n,""),ra("transform","translate("+r.SPACE_SIZE*e+", "+r.SPACE_SIZE*n+")"),ks(1),ha("ngClass",r.getRectClasses(e,n)),ra("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),ks(1),ha("ngIf",r.board[n][e]===r.EMPTY&&r.isThrone(e,n)),ks(1),ha("ngIf",r.board[n][e]!==r.EMPTY)}}function b6(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,S6,4,8,"g",2),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function O6(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",17),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();ks(1),Ta("id","click_",e.x,"_",e.y,""),ra("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let k6=(()=>{class e extends wY{constructor(e){super(e,!1,a6.from),this.rules=u6.get(),this.availableMinimaxes=[new PY(this.rules,"DummyBot"),new TY(this.rules,"Piece > Influence"),new IY(this.rules,"Piece > Control"),new AY(this.rules,"Escape > Piece > Control")],this.encoder=a6.encoder,this.tutorial=(new g6).tutorial,this.updateBoard()}}return e.\u0275fac=function(t){return new(t||e)(ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["app-tablut"]],features:[Go],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,b6,2,1,"g",1),la(2,O6,2,6,"g",1),pa()),2&e&&(ra("viewBox",t.getViewBox()),ks(1),ha("ngForOf",t.board),ks(1),ha("ngForOf",t.getClickables()))},directives:[Jd,Qd,tf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class T6{}T6.PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`,T6.NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`,T6.MISSING_CAPTURES=RX.MISSING_CAPTURES,T6.MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`,T6.CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`,T6.SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`,T6.SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`,T6.MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`,T6.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`,T6.AMBIGUOUS_CAPTURE_COORD=RX.AMBIGUOUS_CAPTURE_COORD,T6.CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`;class I6{constructor(e,t){this.player=e,this.isRing=t}static of(e,t){return e===OZ.NONE?I6.EMPTY:t?I6.RINGS[e.value]:I6.MARKERS[e.value]}equals(e){return this===e}flip(){return cZ(!1===this.isRing,"cannot flip a ring (it should never happen)"),cZ(this.player.isPlayer(),"cannot flip a non-player piece"),I6.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case I6.UNREACHABLE:return"NONE";case I6.EMPTY:return"EMPTY";case I6.MARKER_ZERO:return"MARKER_ZERO";case I6.MARKER_ONE:return"MARKER_ONE";case I6.RING_ZERO:return"RING_ZERO";default:return bw.expectToBe(this,I6.RING_ONE),"RING_ONE"}}}I6.encoder=PZ.tuple([bZ.numberEncoder,PZ.booleanEncoder],e=>[e.player,e.isRing],e=>I6.of(e[0],e[1])),I6.UNREACHABLE=new I6(OZ.NONE,!1),I6.EMPTY=new I6(OZ.NONE,!1),I6.MARKER_ZERO=new I6(bZ.ZERO,!1),I6.MARKER_ONE=new I6(bZ.ONE,!1),I6.MARKERS=[I6.MARKER_ZERO,I6.MARKER_ONE],I6.RING_ZERO=new I6(bZ.ZERO,!0),I6.RING_ONE=new I6(bZ.ONE,!0),I6.RINGS=[I6.RING_ZERO,I6.RING_ONE];let A6=(()=>{class e extends fQ{constructor(t,n,r){super(r,t,e.SIZE,e.SIZE,[6,4,3,2,1],I6.EMPTY),this.sideRings=n}static getInitialState(){const t=I6.EMPTY,n=I6.UNREACHABLE;return new e([[n,n,n,n,n,n,t,t,t,t,n],[n,n,n,n,t,t,t,t,t,t,t],[n,n,n,t,t,t,t,t,t,t,t],[n,n,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,n,n],[t,t,t,t,t,t,t,t,n,n,n],[t,t,t,t,t,t,t,n,n,n,n],[n,t,t,t,t,n,n,n,n,n,n]],[5,5],0)}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&AZ.compareTable(this.board,e.board)}getRingCoords(e){const t=[];return this.forEachCoord((n,r)=>{r.isRing&&r.player===e&&t.push(n)}),t}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==I6.UNREACHABLE}setAtUnsafe(t,n){const r=AZ.copyBiArray(this.board);return r[t.y][t.x]=n,new e(r,this.sideRings,this.turn)}}return e.SIZE=11,e})();class M6 extends IX{constructor(e,t){if(super(e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=Aw.ofNullable(t)}static of(e,t,n){const r=[],i=WW.factory.fromMove(e,t).get();for(let s=e;!1===s.equals(t);s=s.getNext(i))r.push(s);return r.push(t),new M6(r,n)}setRingTaken(e){return new M6(this.capturedSpaces,e)}equals(e){return!(!1===super.equals(e)||!1===this.ringTaken.equals(e.ringTaken))}}M6.encoder=new class extends EZ{encode(e){return{captured:e.capturedSpaces.map(e=>HW.encoder.encode(e)),ringTaken:HW.encoder.encode(e.ringTaken.get())}}decode(e){const t=e;return cZ(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new M6(t.captured.map(e=>HW.encoder.decode(e)),HW.encoder.decode(t.ringTaken))}};class N6 extends oj{constructor(e,t,n,r){super(),this.initialCaptures=e,this.start=t,this.end=n,this.finalCaptures=r}isInitialPlacement(){return this.end.isAbsent()}equals(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===AZ.compareArray(this.initialCaptures,e.initialCaptures)||!1===AZ.compareArray(this.finalCaptures,e.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}}N6.coordOptionalEncoder=TX(HW.encoder),N6.encoder=new class extends wZ{encodeMove(e){const t={moveStart:HW.encoder.encode(e.start),moveEnd:N6.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map((e,n)=>{t["initialCapture"+n]=M6.encoder.encode(e)}),e.finalCaptures.map((e,n)=>{t["finalCapture"+n]=M6.encoder.encode(e)}),t}decodeMove(e){const t=e;return cZ(null!=t.moveStart,"Invalid encoded YinshMove"),new N6(this.decodeArray(t,"initialCapture",M6.encoder.decode),HW.encoder.decode(t.moveStart),N6.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",M6.encoder.decode))}decodeArray(e,t,n){const r=[];for(let i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}};class R6 extends JW{getBoardValue(e){const t=this.ruler.getGameStatus(e);return t.isEndGame?ej.fromWinner(t.winner):new ej(e.gameState.sideRings[0]*bZ.ZERO.getScoreModifier()+e.gameState.sideRings[1]*bZ.ONE.getScoreModifier())}getListMoves(e){const t=[],n=e.gameState;if(n.isInitialPlacementPhase())for(const[r,i]of n.getCoordsAndContents())i===I6.EMPTY&&t.push(new N6([],r,Aw.empty(),[]));else{const e=this.ruler;this.getPossibleCaptureCombinations(n).forEach(r=>{const i=e.applyCaptures(r,n);this.getRingMoves(i).forEach(n=>{const s=e.applyRingMoveAndFlip(n.start,n.end,i);this.getPossibleCaptureCombinations(s).forEach(e=>{const i=new N6(r,n.start,Aw.of(n.end),e);t.push(i)})})})}return t}getPossibleCaptureCombinations(e){const t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return DX.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(e=>class{static getCombinations(e,t){return cZ(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(e=>this.getPermutations(e)).reduce((e,t)=>e.concat(t))}static getPermutations(e){const t=e.length,n=[e.slice()],r=new Array(t).fill(0);let i=1;for(;i<t;)if(r[i]<i){const t=i%2&&r[i],s=e[i];e[i]=e[t],e[t]=s,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}static getSubsetsOfSize(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];{const i=[];for(;r<=e.length-n;){const s=e[r];for(const e of t(n-1,r+1))e.push(s),i.push(e);++r}return i}}(t,0)}}.getCombinations(n,e.length).map(t=>e.map((e,n)=>new M6(e.capturedSpaces,t[n])))).reduce((e,t)=>e.concat(t),[])}getRingMoves(e){const t=this.ruler,n=[];for(const r of this.getRingCoords(e))for(const i of t.getRingTargets(e,r))n.push({start:r,end:i});return n}getRingCoords(e){const t=e.getCurrentPlayer().value,n=[];return e.forEachCoord((e,r)=>{r===I6.RINGS[t]&&n.push(e)}),n}}class x6 extends gj{applyLegalMove(e,t,n){return new A6(n.board,n.sideRings,n.turn+1)}applyCaptures(e,t){let n=t;return e.forEach(e=>{n=this.applyCapture(e,n)}),n}applyCapture(e,t){const n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new A6(n,t.sideRings,t.turn),e.ringTaken.get())}takeRing(e,t){const n=e.getCurrentPlayer().value,r=e.setAt(t,I6.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new A6(r,i,e.turn)}applyCaptureWithoutTakingRing(e,t){return t.forEach(t=>{e=e.setAt(t,I6.EMPTY)}),e.board}ringSelectionValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)===I6.RINGS[n]?xw.SUCCESS:xw.failure(T6.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(e,t,n){const r=n.getCurrentPlayer().value;let i=n.setAt(e,I6.MARKERS[r]);i=i.setAt(t,I6.RINGS[r]);const s=WW.factory.fromMove(e,t).get();for(let o=e.getNext(s);!1===o.equals(t);o=o.getNext(s)){const e=i.getPieceAt(o);e!==I6.EMPTY&&(i=i.setAt(o,e.flip()))}return i}isLegal(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return Mw.failure(T6.NO_MARKERS_IN_INITIAL_PHASE());const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();const r=this.applyCaptures(e.initialCaptures,t),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();const s=this.applyRingMoveAndFlip(e.start,e.end.get(),r),o=this.capturesValidity(s,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();const a=this.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(a);return l.isFailure()?l.toFailedFallible():Mw.success(a)}initialPlacementValidity(e,t){if(!0!==e.isInitialPlacementPhase())return Mw.failure(T6.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==I6.EMPTY)return Mw.failure(XW.MUST_CLICK_ON_EMPTY_SPACE());const n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;const i=e.setAt(t,I6.of(n,!0)).board,s=new A6(i,r,e.turn);return Mw.success(s)}moveStartValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==I6.RINGS[n]?xw.failure(T6.SHOULD_SELECT_PLAYER_RING()):xw.SUCCESS}moveValidity(e,t,n){const r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==I6.EMPTY)return xw.failure(T6.SHOULD_END_MOVE_ON_EMPTY_SPACE());const i=WW.factory.fromMove(t,n);if(i.isFailure())return xw.failure(T6.MOVE_DIRECTION_INVALID());const s=i.get();let o=!1;for(let a=t.getNext(s);!1===a.equals(n);a=a.getNext(s)){const t=e.getPieceAt(a);if(t===I6.EMPTY){if(o)return xw.failure(T6.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(t.isRing)return xw.failure(T6.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return xw.SUCCESS}capturesValidity(e,t){let n=e;for(const r of t){const e=this.captureValidity(n,r);if(e.isFailure())return e;n=this.applyCapture(r,n)}return xw.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer().value;for(const r of t.capturedSpaces)if(e.getPieceAt(r)!==I6.MARKERS[n])return xw.failure(T6.CAN_ONLY_CAPTURE_YOUR_MARKERS());return e.getPieceAt(t.ringTaken.get())!==I6.RINGS[n]?xw.failure(T6.CAPTURE_SHOULD_TAKE_RING()):xw.SUCCESS}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?xw.SUCCESS:xw.failure(T6.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(r=>{const i=this.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,r);i.isPresent()&&n.push(i.get())}),n}getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,n){let r=0;const i=e.getEntranceOnLine(n),s=n.getDirection();let o,a=i;for(o=i;e.isOnBoard(o);o=o.getNext(s)){const n=e.getPieceAt(o);if(n.player===t&&!1===n.isRing)0===r&&(a=o),r+=1;else{if(r>=5)break;r=0}}return r>=5?Aw.of({start:a,end:o,dir:s}):Aw.empty()}getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(e=>{for(let t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(M6.of(t,t.getNext(e.dir,4)))}),n}getRingTargets(e,t){const n=[];for(const r of WW.factory.all){let i=!1;for(let s=t.getNext(r);e.isOnBoard(s);s=s.getNext(r)){const t=e.getPieceAt(s);if(t===I6.EMPTY){if(n.push(s),i)break}else{if(t.isRing)break;i=!0}}}return n}getGameStatus(e){return e.gameState.isInitialPlacementPhase()?pj.ONGOING:e.gameState.sideRings[0]>=3?pj.ZERO_WON:e.gameState.sideRings[1]>=3?pj.ONE_WON:pj.ONGOING}}const D6=I6.EMPTY,L6=I6.UNREACHABLE,F6=I6.MARKER_ZERO,U6=I6.RING_ZERO,V6=I6.MARKER_ONE,B6=I6.RING_ONE;let $6=(()=>{class e{}return e.MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`,e.MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`,e})();class z6{constructor(){this.tutorial=[Cj.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new A6([[L6,L6,L6,L6,L6,L6,D6,D6,D6,D6,L6],[L6,L6,L6,L6,D6,D6,D6,D6,D6,D6,D6],[L6,L6,L6,F6,B6,D6,D6,D6,D6,D6,D6],[L6,L6,D6,F6,D6,B6,D6,V6,D6,D6,D6],[L6,D6,U6,V6,D6,D6,B6,F6,D6,D6,D6],[L6,D6,D6,F6,V6,D6,D6,D6,D6,D6,L6],[D6,D6,D6,F6,D6,D6,D6,B6,D6,D6,L6],[D6,D6,D6,V6,F6,U6,D6,D6,D6,L6,L6],[D6,D6,D6,D6,D6,D6,D6,D6,L6,L6,L6],[D6,D6,D6,D6,D6,D6,D6,L6,L6,L6,L6],[L6,D6,D6,D6,D6,L6,L6,L6,L6,L6,L6]],[3,1],20)),Cj.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.
        Put one of your ring on the board by clicking the space where you want to place it.`,new A6(A6.getInitialState().board,[5,5],0),new N6([],new HW(5,5),Aw.empty(),[]),$localize`Congratulations!`),Cj.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new A6([[L6,L6,L6,L6,L6,L6,D6,D6,D6,D6,L6],[L6,L6,L6,L6,D6,D6,D6,D6,D6,D6,D6],[L6,L6,L6,B6,D6,D6,D6,D6,D6,D6,D6],[L6,L6,B6,D6,D6,B6,D6,D6,D6,D6,D6],[L6,D6,U6,V6,D6,D6,B6,D6,D6,D6,D6],[L6,D6,D6,V6,D6,D6,D6,D6,D6,D6,L6],[D6,D6,D6,D6,U6,D6,D6,B6,D6,D6,L6],[D6,D6,D6,D6,D6,U6,D6,D6,D6,L6,L6],[D6,D6,D6,U6,D6,D6,D6,L6,L6,L6,L6],[D6,D6,D6,D6,D6,D6,D6,L6,L6,L6,L6],[L6,D6,D6,D6,D6,L6,L6,L6,L6,L6,L6]],[0,0],20),new N6([],new HW(2,4),Aw.of(new HW(4,4)),[]),$localize`Congratulations!`),Cj.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new A6([[L6,L6,L6,L6,L6,L6,D6,D6,D6,D6,L6],[L6,L6,L6,L6,D6,D6,D6,D6,D6,D6,D6],[L6,L6,L6,B6,D6,D6,D6,D6,D6,D6,D6],[L6,L6,B6,D6,D6,B6,D6,D6,D6,D6,D6],[L6,D6,F6,F6,U6,V6,V6,D6,D6,D6,D6],[L6,D6,D6,B6,D6,D6,D6,D6,D6,D6,L6],[D6,D6,D6,D6,U6,D6,D6,B6,D6,D6,L6],[D6,D6,D6,D6,D6,U6,D6,D6,D6,L6,L6],[D6,D6,D6,U6,D6,D6,D6,U6,L6,L6,L6],[D6,D6,D6,D6,D6,D6,D6,L6,L6,L6,L6],[L6,D6,D6,D6,D6,L6,L6,L6,L6,L6,L6]],[0,0],20),new N6([],new HW(4,4),Aw.of(new HW(7,4)),[M6.of(new HW(2,4),new HW(6,4),new HW(7,4))]),(e,t,n)=>1===n.sideRings[bZ.ZERO.value]?xw.SUCCESS:xw.failure($6.MUST_ALIGN_FIVE()),$localize`Congratulations!`),Cj.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, you can capture two rings, do it!`,new A6([[L6,L6,L6,L6,L6,L6,D6,D6,D6,D6,L6],[L6,L6,L6,L6,U6,D6,D6,B6,B6,U6,D6],[L6,L6,L6,U6,D6,D6,V6,B6,D6,U6,D6],[L6,L6,D6,U6,D6,D6,D6,D6,D6,B6,D6],[L6,D6,D6,D6,D6,F6,D6,D6,B6,D6,D6],[L6,D6,D6,D6,F6,F6,D6,V6,D6,D6,L6],[D6,D6,D6,F6,D6,F6,D6,D6,D6,D6,L6],[D6,D6,F6,D6,D6,F6,D6,D6,D6,L6,L6],[D6,F6,D6,D6,D6,F6,D6,D6,L6,L6,L6],[D6,D6,D6,D6,D6,F6,D6,L6,L6,L6,L6],[L6,D6,D6,D6,D6,L6,L6,L6,L6,L6,L6]],[0,0],10),new N6([M6.of(new HW(5,4),new HW(1,8),new HW(3,2)),M6.of(new HW(5,9),new HW(5,5),new HW(3,3))],new HW(4,1),Aw.of(new HW(4,2)),[]),(e,t,n)=>2===n.sideRings[bZ.ZERO.value]?xw.SUCCESS:xw.failure($6.MUST_CAPTURE_TWO()),$localize`Congratulations!`)]}}function H6(e,t){if(1&e&&(_n(),ga(0,"circle",12)),2&e){const e=Sa(2).$implicit,t=Sa(2);ra("cx",e.center.x)("cy",e.center.y)("r",t.viewInfo.ringOuterSize)}}function G6(e,t){if(1&e&&(_n(),ga(0,"circle",13)),2&e){const e=Sa(2),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ta("id","ring_",t,"_",r,""),ha("ngClass",n.ringClasses),ra("cx",n.center.x)("cy",n.center.y)("r",i.viewInfo.ringMidSize)}}function Z6(e,t){if(1&e&&(_n(),ga(0,"circle",12)),2&e){const e=Sa(2).$implicit,t=Sa(2);ra("cx",e.center.x)("cy",e.center.y)("r",t.viewInfo.ringInnerSize)}}function q6(e,t){if(1&e&&(_n(),ga(0,"circle",14)),2&e){const e=Sa(2),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ta("id","marker_",t,"_",r,""),ha("ngClass",n.markerClasses),ra("cx",n.center.x)("cy",n.center.y)("r",i.viewInfo.markerSize)}}function W6(e,t){if(1&e){const e=va();_n(),fa(0,"g",6),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa(2).onClick(t.coord)}),ga(1,"polygon",7),fa(2,"g",8),la(3,H6,1,3,"circle",9),la(4,G6,1,6,"circle",10),la(5,Z6,1,3,"circle",9),la(6,q6,1,6,"circle",11),pa(),pa()}if(2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index;Ta("id","click_",t,"_",r,""),ks(1),Ta("id","space_",t,"_",r,""),ha("ngClass",n.spaceClasses),ra("points",n.coordinates),ks(1),Ta("id","pieceGroup_",t,"_",r,""),ha("ngClass",n.removedClass),ks(1),ha("ngIf",n.isRing),ks(1),ha("ngIf",n.isRing),ks(1),ha("ngIf",n.isRing),ks(1),ha("ngIf",n.isMarker)}}function j6(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,W6,7,13,"g",5),pa()),2&e){const e=t.$implicit;ks(1),ha("ngIf",null!=e)}}function Y6(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,j6,2,1,"g",1),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}function K6(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",15),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa();Ta("id","selected_",e.x,"_",e.y,""),ra("points",n.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function Q6(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",17),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).onClick(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa(2);Ta("id","selectable_",e.x,"_",e.y,""),ra("points",n.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function X6(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,Q6,1,3,"polygon",16),pa()),2&e){const e=Sa();ks(1),ha("ngForOf",e.viewInfo.selectableCoords)}}function J6(e,t){if(1&e){const e=va();_n(),fa(0,"rect",18),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa();Ta("id","indicator_",e.x,"_",e.y,""),ra("x",n.viewInfo.spaceInfo[e.y][e.x].center.x-n.viewInfo.indicatorSize/2)("y",n.viewInfo.spaceInfo[e.y][e.x].center.y-n.viewInfo.indicatorSize/2)("width",n.viewInfo.indicatorSize)("height",n.viewInfo.indicatorSize)}}function e8(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",19),ga(2,"circle",12),ga(3,"circle",20),pa()),2&e){const e=t.index,n=Sa().$implicit,r=Sa();ks(1),Ta("id","player_",n.value,"_sideRing_",e+1,""),ra("cx",(0===n.value?0:1050)+1.2*(0===n.value?1:-1)*r.viewInfo.ringOuterSize*(e+1))("cy",0===n.value?300:1260)("r",r.viewInfo.ringOuterSize),ks(1),ra("cx",(0===n.value?0:1050)+1.2*(0===n.value?1:-1)*r.viewInfo.ringOuterSize*(e+1))("cy",0===n.value?300:1260)("r",r.viewInfo.ringInnerSize),ks(1),ha("ngClass",r.viewInfo.sideRingClass[n.value]),ra("cx",(0===n.value?0:1050)+1.2*(0===n.value?1:-1)*r.viewInfo.ringOuterSize*(e+1))("cy",0===n.value?300:1260)("r",r.viewInfo.ringMidSize)}}const t8=function(){return[]};function n8(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,e8,4,12,"g",1),pa()),2&e){const e=t.$implicit,n=Sa();ra("transform","rotate("+180*n.role.value+" 532.5 780)"),ks(1),ha("ngForOf",wu(2,t8).constructor(n.viewInfo.sideRings[e.value]))}}class r8 extends ZW{constructor(e){super(e),this.movePhase="MOVE_START",this.moveStart=Aw.empty(),this.moveEnd=Aw.empty(),this.currentlyMoved=[],this.currentCapture=Aw.empty(),this.initialCaptures=[],this.finalCaptures=[],this.possibleCaptures=[],this.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:r8.MARKER_SIZE,ringOuterSize:r8.RING_OUTER_SIZE,ringMidSize:r8.RING_MID_SIZE,ringInnerSize:r8.RING_INNER_SIZE,indicatorSize:r8.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},this.scores=Aw.of([0,0]),this.rules=new x6(A6),this.availableMinimaxes=[new R6(this.rules,"YinshMinimax")],this.encoder=N6.encoder,this.tutorial=(new z6).tutorial,this.hexaLayout=new jW(1.5*r8.RING_OUTER_SIZE,new HW(2*r8.RING_OUTER_SIZE,0),QW.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(e=>{null==this.viewInfo.spaceInfo[e.y]&&(this.viewInfo.spaceInfo[e.y]=[]),this.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:this.getHexaCoordsAt(e),center:this.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt();const e=this.getState();this.scores=Aw.of(e.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(e=>{this.viewInfo.spaceInfo[e.y][e.x].spaceClasses=this.getSpaceClasses(e);const t=this.constructedState.getPieceAt(e);this.viewInfo.spaceInfo[e.y][e.x].removedClass="",this.setRingInfo(e,t),this.setMarkerInfo(e,t)});for(const e of bZ.PLAYERS)this.viewInfo.sideRings[e.value]=this.constructedState.sideRings[e.value];switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const e of this.possibleCaptures)for(const t of e.capturedSpaces)this.viewInfo.selectableCoords.push(t);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const e of this.initialCaptures)this.markCurrentCapture(e);for(const e of this.finalCaptures)this.markCurrentCapture(e)}getSpaceClasses(e){return this.currentlyMoved.some(t=>t.equals(e))?["moved-fill"]:[]}setRingInfo(e,t){t.isRing?(this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=["player"+t.player.value+"-stroke"]):(this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[])}setMarkerInfo(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==I6.EMPTY&&(!t.isRing||this.moveStart.equalsValue(e))){const n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=Aw.empty(),this.moveStart=Aw.empty(),this.moveEnd=Aw.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(){const e=this.rules.node.move;if(e.isPresent()){const t=e.get();if(t.isInitialPlacement())this.viewInfo.spaceInfo[t.start.y][t.start.x].spaceClasses=["moved-fill"];else{for(const n of this.coordsBetween(t.start,t.end.get()))this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["moved-fill"];const e=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();t.initialCaptures.forEach(t=>this.showLastMoveCapture(t,e)),t.finalCaptures.forEach(t=>this.showLastMoveCapture(t,e))}}}coordsBetween(e,t){const n=[],r=WW.factory.fromMove(e,t).get();for(let i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==I6.EMPTY&&n.push(i),n.push(t);return n}showLastMoveCapture(e,t){for(const n of e.capturedSpaces)this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["captured-fill"],t&&this.markRemovedMarker(n,this.getState().getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured-fill"],t&&this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),xw.SUCCESS}onClick(e){var t=this;return Sw(function*(){const n=t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());switch(t.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return t.selectCaptureFirstCoord(e);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return t.selectCaptureLastCoord(e);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return t.selectRing(e);case"MOVE_START":return t.selectMoveStart(e);case"MOVE_END":return t.selectMoveEnd(e)}})()}selectCaptureFirstCoord(e){var t=this;return Sw(function*(){const n=[];if(t.possibleCaptures.forEach(t=>{t.contains(e)&&n.push(t)}),n.length>1)t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(n);else{if(0===n.length)return t.cancelMove(T6.MISSING_CAPTURES());t.selectCapture(n[0])}return xw.SUCCESS})()}moveToCaptureSelectLast(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;for(const t of e)for(const e of t.capturedSpaces)this.viewInfo.selectableCoords.push(e);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(bw.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(e){var t=this;return Sw(function*(){const n=[];return t.possibleCaptures.forEach(t=>{t.contains(e)&&n.push(t)}),n.length>1?t.cancelMove(T6.AMBIGUOUS_CAPTURE_COORD()):0===n.length?t.cancelMove(T6.MISSING_CAPTURES()):t.selectCapture(n[0])})()}selectCapture(e){return this.currentCapture=Aw.of(e),this.constructedState=new A6(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(cZ("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),xw.SUCCESS}markCurrentCapture(e){for(const t of e.capturedSpaces)this.viewInfo.selectedCoords.push(t),this.markRemovedMarker(t,this.getState().getCurrentPlayer());e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,I6.MARKERS[t.value])}markRemovedRing(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,I6.RINGS[t.value])}selectRing(e){var t=this;return Sw(function*(){const n=t.rules.ringSelectionValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.constructedState=t.rules.takeRing(t.constructedState,e);const r=t.currentCapture.get().setRingTaken(e);return"INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=Aw.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(r),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),xw.SUCCESS)):(bw.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(r),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),xw.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),xw.SUCCESS}tryMove(){var e=this;return Sw(function*(){const t=new N6(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures);return yield e.chooseMove(t,e.getState(),e.scores.get())})()}selectMoveStart(e){var t=this;return Sw(function*(){if(t.constructedState.isInitialPlacementPhase()){const n=t.rules.initialPlacementValidity(t.constructedState,e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveStart=Aw.of(e),t.tryMove())}{const n=t.rules.moveStartValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.moveStart=Aw.of(e),t.movePhase="MOVE_END",t.updateViewInfo()}return xw.SUCCESS})()}selectMoveEnd(e){var t=this;return Sw(function*(){if(t.moveStart.equalsValue(e))return t.cancelMoveAttempt(),xw.SUCCESS;const n=I6.RINGS[t.getState().getCurrentPlayer().value];if(t.constructedState.getPieceAt(e)===n)return t.cancelMoveAttempt(),t.selectMoveStart(e);const r=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e);return r.isFailure()?t.cancelMove(r.getReason()):(t.moveEnd=Aw.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var e=this;return Sw(function*(){return e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),xw.SUCCESS)})()}}function i8(e,t){if(1&e&&(fa(0,"option",5),Qa(1),pa()),2&e){const e=t.$implicit;ha("value",e.urlName),ks(1),Xa(e.name)}}r8.RING_OUTER_SIZE=40,r8.RING_MID_SIZE=34,r8.RING_INNER_SIZE=28,r8.MARKER_SIZE=r8.RING_INNER_SIZE,r8.INDICATOR_SIZE=10,r8.\u0275fac=function(e){return new(e||r8)(ua(aZ))},r8.\u0275cmp=Je({type:r8,selectors:[["app-yinsh"]],features:[Go],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,Y6,2,1,"g",1),la(2,K6,1,3,"polygon",2),la(3,X6,2,1,"g",3),la(4,J6,1,6,"rect",4),la(5,n8,2,3,"g",1),pa()),2&e&&(ks(1),ha("ngForOf",t.viewInfo.spaceInfo),ks(1),ha("ngForOf",t.viewInfo.selectedCoords),ks(1),ha("ngIf",t.isPlayerTurn()),ks(1),ha("ngForOf",t.viewInfo.targets),ks(1),ha("ngForOf",t.Player.PLAYERS))},directives:[Jd,tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let s8=(()=>{class e{}return e.ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`,e.APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`,e.AWALE=()=>$localize`The international version of the famous African strategy game!`,e.BRANDHUB=()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,e.COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`,e.CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`,e.DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`,e.DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`,e.ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`,e.EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`,e.GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`,e.GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`,e.HNEFATAFL=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`,e.KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`,e.LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`,e.LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`,e.MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`,e.P4=()=>$localize`The classical 4 in a row game!`,e.PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`,e.PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`,e.QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`,e.QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`,e.REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`,e.SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`,e.SIAM=()=>$localize`Be the first to push a mountain out of the board!`,e.SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`,e.TABLUT=()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,e.YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`,e})(),o8=(()=>{class e{constructor(e,t,n,r,i,s=!0){this.name=e,this.urlName=t,this.component=n,this.creationDate=r,this.description=i,this.display=s}}return e.ALL_GAMES=()=>[new e("MinimaxTesting","MinimaxTesting",d2,new Date("1970-01-01"),"",!1),new e($localize`Four in a Row`,"P4",k2,new Date("2018-08-28"),s8.P4()),new e($localize`Awal`,"Awale",uY,new Date("2018-11-29"),s8.AWALE()),new e($localize`Quarto`,"Quarto",c4,new Date("2018-12-09"),s8.QUARTO()),new e($localize`Tablut`,"Tablut",k6,new Date("2018-12-27"),s8.TABLUT()),new e($localize`Reversi`,"Reversi",F4,new Date("2019-01-16"),s8.REVERSI()),new e($localize`Go`,"Go",SJ,new Date("2019-12-21"),s8.GO()),new e($localize`Encapsule`,"Encapsule",hX,new Date("2019-12-30"),s8.ENCAPSULE()),new e($localize`Siam`,"Siam",F5,new Date("2020-01-11"),s8.SIAM()),new e($localize`Sahara`,"Sahara",s5,new Date("2020-02-29"),s8.SAHARA()),new e($localize`Pylos`,"Pylos",v3,new Date("2020-10-02"),s8.PYLOS()),new e($localize`Kamisado`,"Kamisado",O1,new Date("2020-10-03"),s8.KAMISADO()),new e($localize`Quixo`,"Quixo",P4,new Date("2020-10-15"),s8.QUIXO()),new e($localize`Dvonn`,"Dvonn",$Q,new Date("2020-10-21"),s8.DVONN()),new e($localize`Epaminondas`,"Epaminondas",kX,new Date("2021-01-16"),s8.EPAMINONDAS()),new e($localize`Gipf`,"Gipf",KX,new Date("2021-02-22"),s8.GIPF()),new e($localize`Coerceo`,"Coerceo",wK,new Date("2021-03-21"),s8.COERCEO()),new e($localize`Six`,"Six",o6,new Date("2021-04-08"),s8.SIX()),new e($localize`Lines of Action`,"LinesOfAction",B1,new Date("2021-04-28"),s8.LINES_OF_ACTION()),new e($localize`Pentago`,"Pentago",W2,new Date("2021-05-23"),s8.PENTAGO()),new e($localize`Abalone`,"Abalone",Uj,new Date("2021-07-13"),s8.ABALONE()),new e($localize`Yinsh`,"Yinsh",r8,new Date("2021-07-31"),s8.YINSH()),new e($localize`Apagos`,"Apagos",Jj,new Date("2021-11-04"),s8.APAGOS()),new e($localize`Diam`,"Diam",hQ,new Date("2021-11-30"),s8.DIAM()),new e($localize`Brandhub`,"Brandhub",WY,new Date("2021-12-07"),s8.BRANDHUB()),new e($localize`Conspirateurs`,"Conspirateurs",HK,new Date("2021-12-30"),s8.CONSPIRATEURS()),new e($localize`Lodestone`,"Lodestone",C0,new Date("2022-06-24"),s8.LODESTONE()),new e($localize`Martian Chess`,"MartianChess",t2,new Date("2022-07-01"),s8.MARTIAN_CHESS()),new e($localize`Hnefatafl`,"Hnefatafl",ZJ,new Date("2022-09-21"),s8.HNEFATAFL())].sort((e,t)=>e.name.localeCompare(t.name)),e})(),a8=(()=>{class e{constructor(){this.games=o8.ALL_GAMES().filter(e=>!0===e.display),this.pickGame=new Nu}onChange(e){this.pickGame.emit(e.target.value)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Je({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let e;return e=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],e,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"select",1),Ea("change",function(e){return t.onChange(e)}),fa(2,"option",2),sc(3,3),pa(),la(4,i8,2,2,"option",4),pa(),pa()),2&e&&(ks(4),ha("ngForOf",t.games))},directives:[Sg,Tg,Jd],encapsulation:2}),e})();function l8(e,t){if(1&e){const e=va();fa(0,"div",26),fa(1,"div",27),Ea("click",function(){return Gt(e),Sa().closeInfo()}),pa(),fa(2,"div",28),fa(3,"header",29),fa(4,"p",30),Qa(5),pa(),fa(6,"button",31),Ea("click",function(){return Gt(e),Sa().closeInfo()}),pa(),pa(),fa(7,"section",32),fa(8,"div",6),fa(9,"div",33),fa(10,"p",34),ga(11,"img",35),pa(),pa(),fa(12,"div",7),fa(13,"div",13),Qa(14),pa(),pa(),pa(),fa(15,"div",6),fa(16,"div",33),fa(17,"a",36),Ea("click",function(){Gt(e);const t=Sa();return t.createGame(t.gameInfoDetails.get().urlName)}),ga(18,"fa-icon",37),Qa(19,"\xa0"),fa(20,"span"),sc(21,38),pa(),pa(),pa(),fa(22,"div",33),fa(23,"a",36),Ea("click",function(){Gt(e);const t=Sa();return t.createLocalGame(t.gameInfoDetails.get().urlName)}),ga(24,"fa-icon",37),Qa(25,"\xa0"),fa(26,"span"),sc(27,39),pa(),pa(),pa(),fa(28,"div",33),fa(29,"a",36),Ea("click",function(){Gt(e);const t=Sa();return t.createTutorial(t.gameInfoDetails.get().urlName)}),ga(30,"fa-icon",37),Qa(31,"\xa0"),fa(32,"span"),sc(33,40),pa(),pa(),pa(),pa(),pa(),pa(),pa()}if(2&e){const e=Sa();ks(5),Xa(e.gameInfoDetails.get().name),ks(6),Ta("src","assets/images/",e.theme,"/",e.gameInfoDetails.get().urlName,".png",Ci),ks(3),Ja(" ",e.gameInfoDetails.get().description," "),ks(4),ha("icon",e.iconOnlineGame),ks(6),ha("icon",e.iconLocalGame),ks(6),ha("icon",e.iconTutorial)}}function c8(e,t){if(1&e){const e=va();fa(0,"div",8),fa(1,"div",9),fa(2,"p",10),Qa(3),pa(),pa(),fa(4,"div",42),fa(5,"figure",34),fa(6,"img",43),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).openInfo(t)}),pa(),fa(7,"figcaption",44),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).openInfo(t)}),fa(8,"div",45),Qa(9,"?"),pa(),pa(),fa(10,"figcaption",46),fa(11,"a",47),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).createGame(t.urlName)}),ga(12,"fa-icon",37),pa(),fa(13,"a",48),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).createLocalGame(t.urlName)}),ga(14,"fa-icon",37),pa(),fa(15,"a",49),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).createTutorial(t.urlName)}),ga(16,"fa-icon",37),pa(),pa(),pa(),pa(),fa(17,"div",50),Qa(18),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa(2);ks(3),Xa(e.name),ks(3),ka("id","image_",e.urlName,""),Ta("src","assets/images/",n.theme,"/",e.urlName,".png",Ci),ks(5),ka("id","playOnline_",e.urlName,""),ks(1),ha("icon",n.iconOnlineGame),ks(1),ka("id","playLocally_",e.urlName,""),ks(1),ha("icon",n.iconLocalGame),ks(1),ka("id","startTutorial_",e.urlName,""),ks(1),ha("icon",n.iconTutorial),ks(2),Ja(" ",e.description," ")}}function u8(e,t){if(1&e&&(fa(0,"div",7),la(1,c8,19,11,"div",41),pa()),2&e){const e=t.$implicit;ks(1),ha("ngForOf",e)}}let h8=(()=>{class e{constructor(e,t){this.router=e,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=qZ,this.iconLocalGame=GZ,this.iconTutorial=zZ,this.gameInfoDetails=Aw.empty(),this.theme=t.getTheme();const n=o8.ALL_GAMES().filter(e=>!0===e.display);let r=0;for(let i=0;i<n.length;i++)i<this.numberOfColumns&&this.games.push([]),this.games[r].push(n[i]),r=(r+1)%this.numberOfColumns}createGame(e){var t=this;return Sw(function*(){return t.router.navigate(["/play",e])})()}createLocalGame(e){var t=this;return Sw(function*(){return t.router.navigate(["/local",e])})()}createTutorial(e){return this.router.navigate(["/tutorial",e])}openInfo(e){this.gameInfoDetails=Aw.of(e)}closeInfo(){this.gameInfoDetails=Aw.empty()}}return e.\u0275fac=function(t){return new(t||e)(ua(fC),ua($Z))},e.\u0275cmp=Je({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h,d,f;return e=$localize`EveryBoard`,t=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,n=$localize`Play online`,r=$localize`Create an online game`,i=$localize`See the game list`,s=$localize`Play offline`,o=$localize`Play`,a=$localize`Learn`,l=$localize`Play online`,c=$localize`Play offline`,u=$localize`Learn the rules`,h=$localize`Play online`,d=$localize`Play offline`,f=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],e,[1,"subtitle"],t,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],n,[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],r,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],i,s,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],o,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],a,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],l,c,u,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",h,1,"button",3,"id","click"],["data-tooltip",d,1,"button",3,"id","click"],["data-tooltip",f,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(fa(0,"section",0),fa(1,"div",1),fa(2,"p",2),sc(3,3),pa(),fa(4,"p",4),rc(5,5),ga(6,"br"),ic(),pa(),pa(),fa(7,"div",6),fa(8,"div",7),fa(9,"div",8),fa(10,"header",9),fa(11,"p",10),sc(12,11),pa(),pa(),fa(13,"div",12),fa(14,"div",13),fa(15,"button",14),sc(16,15),pa(),fa(17,"button",16),sc(18,17),pa(),pa(),pa(),pa(),pa(),fa(19,"div",7),fa(20,"div",8),fa(21,"header",9),fa(22,"p",10),sc(23,18),pa(),pa(),fa(24,"div",12),fa(25,"div",19),fa(26,"button",20),sc(27,21),pa(),fa(28,"button",22),sc(29,23),pa(),pa(),pa(),pa(),pa(),pa(),la(30,l8,34,7,"div",24),fa(31,"div",6),la(32,u8,2,1,"div",25),pa(),pa()),2&e&&(ks(30),ha("ngIf",t.gameInfoDetails.isPresent()),ks(2),ha("ngForOf",t.games))},directives:[gC,tf,Jd,_W],encapsulation:2}),e})(),d8=(()=>{class e{constructor(e){this.element=e}ngAfterViewInit(){this.element.nativeElement.focus()}}return e.\u0275fac=function(t){return new(t||e)(ua(Pc))},e.\u0275dir=st({type:e,selectors:[["","autofocus",""]]}),e})(),f8=(()=>{class e{constructor(e){this.shown=!1,this.input=e.nativeElement.parentNode.previousSibling,e.nativeElement.addEventListener("click",e=>{this.toggle()})}toggle(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return e.\u0275fac=function(t){return new(t||e)(ua(Pc))},e.\u0275dir=st({type:e,selectors:[["","toggleVisibility",""]]}),e})();function p8(e,t){if(1&e&&(fa(0,"div",29),fa(1,"div",30),sc(2,31),pa(),fa(3,"div",32),Qa(4),pa(),pa()),2&e){const e=Sa();ks(4),Xa(e.errorMessage)}}const g8=function(){return["/register"]},m8=function(){return["/reset-password"]};let y8=(()=>{class e{constructor(e,t){this.router=e,this.connectedUserService=t,this.faEye=ZZ,this.loginForm=new ig({email:new rg,password:new rg})}ngOnInit(){var e=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var t=Sw(function*(t){t!==pZ.NOT_CONNECTED&&(yield e.redirect())});return function(e){return t.apply(this,arguments)}}())}loginWithEmail(e){var t=this;return Sw(function*(){const n=yield t.connectedUserService.doEmailLogin(e.email,e.password);n.isFailure()&&(t.errorMessage=n.getReason())})()}loginWithGoogle(){var e=this;return Sw(function*(){const t=yield e.connectedUserService.doGoogleLogin();t.isFailure()&&(e.errorMessage=t.getReason())})()}redirect(){var e=this;return Sw(function*(){return e.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(ua(fC),ua(gZ))},e.\u0275cmp=Je({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h;return e=$localize`Log in`,t=$localize`Email`,n=$localize`Email`,r=$localize`Password`,i=$localize`Password`,s=$localize`Log in`,o=$localize`Log in with Google`,a=$localize`No account?`,l=$localize`Register`,c=$localize`Forgot your password?`,u=$localize`Reset your password`,h=$localize`Connection error`,[[1,"box"],[1,"title"],e,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],t,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",n,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],r,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",i,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],s,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],o,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],a,[3,"routerLink"],l,c,u,["role","alert",1,"message","is-danger"],[1,"message-header"],h,["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"p",1),sc(2,2),pa(),fa(3,"form",3),fa(4,"div",4),fa(5,"div",5),fa(6,"label",6),sc(7,7),pa(),pa(),fa(8,"div",8),fa(9,"div",9),fa(10,"div",10),ga(11,"input",11),pa(),pa(),pa(),pa(),fa(12,"div",4),fa(13,"div",5),fa(14,"label",12),sc(15,13),pa(),pa(),fa(16,"div",8),fa(17,"div",9),fa(18,"div",14),ga(19,"input",15),fa(20,"span",16),ga(21,"fa-icon",17),pa(),pa(),pa(),pa(),pa(),fa(22,"div",4),ga(23,"div",5),fa(24,"div",8),fa(25,"div",9),fa(26,"div",10),fa(27,"button",18),Ea("click",function(){return t.loginWithEmail(t.loginForm.value)}),sc(28,19),pa(),pa(),pa(),pa(),pa(),fa(29,"div",4),ga(30,"div",5),fa(31,"div",8),fa(32,"div",9),fa(33,"div",10),fa(34,"button",20),Ea("click",function(){return t.loginWithGoogle()}),sc(35,21),pa(),pa(),pa(),pa(),pa(),la(36,p8,5,1,"div",22),fa(37,"p",23),ma(38),sc(39,24),ya(),Qa(40,"\xa0 "),fa(41,"a",25),sc(42,26),pa(),pa(),fa(43,"p",23),ma(44),sc(45,27),ya(),Qa(46,"\xa0 "),fa(47,"a",25),sc(48,28),pa(),pa(),pa(),pa()),2&e&&(ks(3),ha("formGroup",t.loginForm),ks(18),ha("icon",t.faEye),ks(6),ha("disabled",!t.canLogin()),ks(9),ha("ngIf",t.errorMessage),ks(5),ha("routerLink",wu(6,g8)),ks(6),ha("routerLink",wu(7,m8)))},directives:[dg,xp,vg,rp,Rp,_g,d8,Ag,_W,f8,tf,mC],encapsulation:2}),e})(),v8=(()=>{class e{constructor(e){this.userDAO=e}subscribeToActiveUsers(t){Ow(e.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");let n=[];const r=new NZ(r=>{Ow(e.VERBOSE,"our DAO gave us "+r.length+" new user(s)"),n=this.sort(n.concat(...r)),t(n)},r=>{let i=n;Ow(e.VERBOSE,"our DAO updated "+r.length+" user(s)");for(const e of r)i.forEach(t=>{t.id===e.id&&(t.data=e.data)}),i=this.sort(i);n=i,t(n)},e=>{n=n.filter(t=>!e.some(e=>e.id===t.id)),t(n)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],r)}sort(e){return e.sort((e,t)=>{const n=bw.getNonNullable(e.data).lastUpdateTime,r=bw.getNonNullable(n).seconds,i=bw.getNonNullable(t.data).lastUpdateTime;return r-bw.getNonNullable(i).seconds})}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(uZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),C8=(()=>{class e{constructor(e){this.partDAO=e}subscribeToActiveParts(e){let t=[];const n=new NZ(n=>{t=t.concat(...n),e(t)},n=>{const r=t;for(const e of n)r.forEach(t=>{t.id===e.id&&(t.data=e.data)});t=r,e(t)},n=>{const r=[];for(const e of t)n.some(t=>t.id===e.id)||r.push(e);t=r,e(t)});return this.partDAO.observingWhere([["result","==",mZ.UNACHIEVED.value]],n)}userHasActivePart(e){var t=this;return Sw(function*(){const n=yield t.partDAO.findWhere([["playerZero","==",e],["result","==",mZ.UNACHIEVED.value]]),r=yield t.partDAO.findWhere([["playerOne","==",e],["result","==",mZ.UNACHIEVED.value]]);return n.length>0||r.length>0})()}}return e.\u0275fac=function(t){return new(t||e)(Or(MZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"any"}),e})(),_8=(()=>{class e{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}navigateToOnlineGameCreation(){var e=this;return Sw(function*(){yield e.router.navigate(["/play",e.selectedGame])})()}}return e.\u0275fac=function(t){return new(t||e)(ua(fC))},e.\u0275cmp=Je({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Create an online game`,[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(e,t){1&e&&(fa(0,"app-pick-game",0),Ea("pickGame",function(e){return t.pickGame(e)}),pa(),fa(1,"button",1),Ea("click",function(){return t.navigateToOnlineGameCreation()}),sc(2,2),pa()),2&e&&(ks(1),ha("disabled",!t.selectedGame))},directives:[a8],encapsulation:2}),e})(),E8=(()=>{class e{transform(e){return Nd(1e3*e.seconds,"HH:mm:ss","en-US")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=ot({name:"firebaseDate",type:e,pure:!0}),e})();const w8=["chatDiv"];function P8(e,t){1&e&&(ma(0),sc(1,5),ya())}function S8(e,t){1&e&&sc(0,6),2&e&&(oc(Sa().unreadMessagesText),ac(0))}function b8(e,t){if(1&e){const e=va();fa(0,"button",11),Ea("click",function(){return Gt(e),Sa(2).scrollToBottom()}),Qa(1),pa()}if(2&e){const e=Sa(2);ks(1),Ja("",e.unreadMessagesText," \u2193")}}function O8(e,t){if(1&e&&(fa(0,"p"),Qa(1),Ou(2,"firebaseDate"),fa(3,"b",12),Qa(4),pa(),fa(5,"span",13),Qa(6),pa(),pa()),2&e){const e=t.$implicit;ks(1),Ja(" [",ku(2,3,e.postedTime),"] "),ks(3),Ja("",e.sender.name," : "),ks(2),Xa(e.content)}}function k8(e,t){if(1&e){const e=va();fa(0,"div"),la(1,b8,2,1,"button",7),fa(2,"div",8,9),Ea("scroll",function(){return Gt(e),Sa().updateCurrentScrollPosition()}),la(4,O8,7,5,"p",10),pa(),pa()}if(2&e){const e=Sa();ks(1),ha("ngIf",e.showUnreadMessagesButton),ks(3),ha("ngForOf",e.chat)}}const T8=function(){return{standalone:!0}};function I8(e,t){if(1&e){const e=va();fa(0,"form",14),Ea("onSubmit",function(){return Gt(e),Sa().sendMessage()}),fa(1,"div",15),fa(2,"div",16),fa(3,"input",17,18),Ea("ngModelChange",function(t){return Gt(e),Sa().userMessage=t}),pa(),fa(5,"p",19),Qa(6),pa(),pa(),fa(7,"div",20),fa(8,"button",21),Ea("click",function(){return Gt(e),Sa().sendMessage()}),ga(9,"fa-icon",22),pa(),pa(),pa(),fa(10,"div",23),fa(11,"p"),fa(12,"strong"),sc(13,24),pa(),pa(),pa(),pa()}if(2&e){const e=ca(4),t=Sa();ks(3),ha("ngModel",t.userMessage)("ngModelOptions",wu(4,T8)),ks(3),Ja("",e.value.length,"/128"),ks(3),ha("icon",t.faReply)}}let A8=(()=>{class e{constructor(t,n){this.chatService=t,this.connectedUserService=n,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=WZ,this.isNearBottom=!0,this.notYetScrolled=!0,Ow(e.VERBOSE,"ChatComponent constructor")}ngOnInit(){Ow(e.VERBOSE,`ChatComponent.ngOnInit for chat ${this.chatId}`),cZ(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=e=>{this.updateMessages(e.flatMap(e=>null==e.data.postedTime?[]:[e.data]))},t=new NZ(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,t)}updateMessages(e){this.chat=this.chat.concat(e);const t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return Sw(function*(){const t=e.userMessage;e.userMessage="";const n=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,n,t,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(iZ),ua(gZ))},e.\u0275cmp=Je({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){if(1&e&&Zu(w8,5),2&e){let e;Gu(e=qu())&&(t.chatDiv=e.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let e,t,n,r;return e=$localize`Hide chat`,t=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,n=$localize`Type your message here`,r=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],e,t,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",n,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],r]},template:function(e,t){if(1&e&&(fa(0,"div"),fa(1,"button",0),Ea("click",function(){return t.switchChatVisibility()}),la(2,P8,2,0,"ng-container",1),la(3,S8,1,1,"ng-template",null,2,ju),pa(),la(5,k8,5,2,"div",3),la(6,I8,14,5,"form",4),pa()),2&e){const e=ca(4);ks(2),ha("ngIf",t.visible)("ngIfElse",e),ks(3),ha("ngIf",t.visible),ks(1),ha("ngIf",t.visible)}},directives:[tf,Jd,dg,xp,lg,rp,Ng,Rp,hg,_W],pipes:[E8],encapsulation:2}),e})();function M8(e,t){if(1&e&&(ma(0),Qa(1),ya()),2&e){const e=Sa().$implicit;ks(1),Xa(e.data.playerOne.name)}}function N8(e,t){1&e&&(ma(0),sc(1,26),ya())}function R8(e,t){if(1&e){const e=va();fa(0,"tr",22),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).joinGame(t.id,t.data.typeGame)}),fa(1,"td",23),Qa(2),pa(),fa(3,"td",23),Qa(4),pa(),fa(5,"td",23),la(6,M8,2,1,"ng-container",24),la(7,N8,2,0,"ng-template",null,25,ju),pa(),fa(9,"td",23),Qa(10),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=ca(8);ka("id","part_",n,""),ks(2),Xa(e.data.typeGame),ks(2),Xa(e.data.playerZero.name),ks(2),ha("ngIf",e.data.playerOne)("ngIfElse",r),ks(4),Xa(e.data.turn)}}function x8(e,t){if(1&e&&(fa(0,"div",13),fa(1,"div",14),fa(2,"table",15),fa(3,"thead"),fa(4,"tr"),fa(5,"th",16),sc(6,17),pa(),fa(7,"th",16),sc(8,18),pa(),fa(9,"th",16),sc(10,19),pa(),fa(11,"th",16),sc(12,20),pa(),pa(),pa(),fa(13,"tbody"),la(14,R8,11,6,"tr",21),pa(),pa(),pa(),pa()),2&e){const e=Sa();ks(14),ha("ngForOf",e.activeParts)}}function D8(e,t){1&e&&(fa(0,"div",27),ga(1,"app-online-game-selection",28),pa())}function L8(e,t){if(1&e&&(fa(0,"li",39),Qa(1),Ou(2,"firebaseDate"),pa()),2&e){const e=Sa().$implicit;Oa("id",e.data.username),ks(1),el("",e.data.username,": ",ku(2,3,e.data.lastUpdateTime),"")}}function F8(e,t){if(1&e&&(ma(0),la(1,L8,3,5,"li",38),ya()),2&e){const e=t.$implicit;ks(1),ha("ngIf",e.data.lastUpdateTime)}}function U8(e,t){if(1&e&&(fa(0,"div",29),fa(1,"div",30),fa(2,"div",31),ga(3,"app-chat",32),pa(),pa(),fa(4,"div",33),fa(5,"div",34),fa(6,"p"),sc(7,35),pa(),fa(8,"ul",36),la(9,F8,2,1,"ng-container",37),pa(),pa(),pa(),pa()),2&e){const e=Sa();ks(3),ha("turn",-1),ks(6),ha("ngForOf",e.activeUsers)}}let V8=(()=>{class e{constructor(e,t,n){this.router=e,this.activeUsersService=t,this.activePartsService=n,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}ngOnInit(){Ow(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(e=>{this.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e})}ngOnDestroy(){Ow(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}joinGame(e,t){var n=this;return Sw(function*(){yield n.router.navigate(["/play",t,e])})()}selectTab(e){this.currentTab=e}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(fC),ua(v8),ua(C8))},e.\u0275cmp=Je({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){let e,t,n,r,i,s,o,a,l;return e=$localize`Games`,t=$localize`Create`,n=$localize`Chat`,r=$localize`Game`,i=$localize`First player`,s=$localize`Second player`,o=$localize`Turn`,a=$localize`Waiting for opponent`,l=$localize`Connected users:`,[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],e,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],t,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],n,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],r,i,s,o,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],a,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],l,["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"ul"),fa(2,"li",1),fa(3,"a",2),Ea("click",function(){return t.selectTab("games")}),sc(4,3),pa(),pa(),fa(5,"li",4),fa(6,"a",5),Ea("click",function(){return t.selectTab("create")}),sc(7,6),pa(),pa(),fa(8,"li",7),fa(9,"a",8),Ea("click",function(){return t.selectTab("chat")}),sc(10,9),pa(),pa(),pa(),pa(),la(11,x8,15,1,"div",10),la(12,D8,2,0,"div",11),la(13,U8,10,2,"div",12)),2&e&&(ks(11),ha("ngIf","games"===t.currentTab),ks(1),ha("ngIf","create"===t.currentTab),ks(1),ha("ngIf","chat"===t.currentTab))},directives:[Qd,tf,Jd,_8,A8],pipes:[E8],encapsulation:2}),e})(),B8=(()=>{class e{constructor(e){this.route=e,this.message=e.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return e.\u0275fac=function(t){return new(t||e)(ua(Zy))},e.\u0275cmp=Je({type:e,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let e;return e=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],e,[1,"message-body"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"div",1),sc(2,2),pa(),fa(3,"div",3),Qa(4),pa(),pa()),2&e&&(ks(4),Xa(t.message))},encapsulation:2}),e})();function $8(e,t){}let z8=(()=>{class e{constructor(t){this.viewContainerRef=t,Ow(e.VERBOSE,"GameIncluderComponent constructor")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(au))},e.\u0275cmp=Je({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&la(0,$8,0,0,"ng-template")},encapsulation:2}),e})(),H8=(()=>{class e{static NO_MATCHING_GAME(e){return $localize`This game (${e}) does not exist.`}}return e.NOT_YOUR_TURN=()=>$localize`It is not your turn!`,e.NO_CLONING_FEATURE=()=>$localize`You cannot clone a game. This feature might be implemented later.`,e})(),G8=(()=>{class e{constructor(t,n,r,i,s){this.componentFactoryResolver=t,this.actRoute=n,this.connectedUserService=r,this.router=i,this.messageDisplayer=s,this.players=[Aw.empty(),Aw.empty()],this.role=OZ.NONE,this.endGame=!1,this.Player=bZ,Ow(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}getMatchingComponent(t){return Ow(e.VERBOSE,"GameWrapper.getMatchingComponent"),Aw.ofNullable(o8.ALL_GAMES().find(e=>e.urlName===t)).map(e=>e.component)}afterGameIncluderViewInit(){var t=this;return Sw(function*(){Ow(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit");const n=yield t.createGameComponent();return n&&(t.gameComponent.rules.setInitialBoard(),t.gameComponent.updateBoard()),n})()}createGameComponent(){var t=this;return Sw(function*(){Ow(e.VERBOSE,"GameWrapper.createGameComponent");const n=bw.getNonNullable(t.actRoute.snapshot.paramMap.get("compo")),r=t.getMatchingComponent(n);if(r.isAbsent())return yield t.router.navigate(["/notFound",H8.NO_MATCHING_GAME(n)],{skipLocationChange:!0}),!1;cZ(null!=t.gameIncluder,"GameIncluder should be present");const i=t.componentFactoryResolver.resolveComponentFactory(r.get()),s=t.gameIncluder.viewContainerRef.createComponent(i);return t.gameComponent=s.instance,t.gameComponent.chooseMove=(e,n,r)=>t.receiveValidMove(e,n,r),t.gameComponent.canUserPlay=e=>t.onUserClick(e),t.gameComponent.isPlayerTurn=()=>t.isPlayerTurn(),t.gameComponent.cancelMoveOnWrapper=e=>{t.onCancelMove(e)},t.setRole(t.role),t.canPass=t.gameComponent.canPass,!0})()}setRole(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")")}receiveValidMove(t,n,r){var i=this;return Sw(function*(){if(Ow(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),!i.isPlayerTurn())return xw.failure(H8.NOT_YOUR_TURN());if(i.endGame)return xw.failure($localize`The game has ended.`);const s=i.gameComponent.rules.isLegal(t,n);return s.isFailure()?(i.gameComponent.cancelMove(s.getReason()),xw.ofFallible(s)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(t,r),Ow(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),xw.SUCCESS)})()}onUserClick(e){if(this.role===OZ.NONE){const e=H8.NO_CLONING_FEATURE();return xw.failure(e)}return this.isPlayerTurn()?xw.SUCCESS:xw.failure(H8.NOT_YOUR_TURN())}onCancelMove(e){}isPlayerTurn(){if(this.role===OZ.NONE||null==this.gameComponent)return!1;const t=this.gameComponent.getTurn(),n=t%2,r=this.getPlayer();return Ow(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,player:r,observer:this.role,areYouPlayer:this.players[n].isPresent()&&Iw(this.players[n].get(),r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(Cc),ua(Zy),ua(gZ),ua(fC),ua(aZ))},e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&Zu(z8,5),2&e){let e;Gu(e=qu())&&(t.gameIncluder=e.first)}},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();class Z8{constructor(e,t,n){this.added=e,this.modified=t,this.removed=n}static from(e,t){const n=new Z8({},{},{});if(null==e)return n.added={...t},n;if(null==t)return n.removed={...e},n;const r=Object.keys(e),i=Object.keys(t),s=r.filter(e=>!1===i.includes(e)),o=r.filter(e=>i.includes(e)),a=i.filter(e=>!1===r.includes(e));return n.addNewKeys(a,t),n.addCommonKeys(o,t,e),n.addRemovedKeys(s,e),n}static differs(e,t){return Z8.from(e,t).countChanges()>0}addNewKeys(e,t){for(const n of e)null!=t[n]&&(this.added[n]=t[n])}addCommonKeys(e,t,n){for(const r of e)this.addCommonKey(r,n[r],t[r])}addCommonKey(e,t,n){if(null==n)null!=t&&(this.removed[e]=t);else if(null==t)this.added[e]=n;else if(["string","boolean","number"].includes(typeof t))t!==n&&(this.modified[e]=n);else if(Array.isArray(t)){if(!Array.isArray(n))throw new Error("Thing should not change type");t.length===n.length?this.addCommonKeyList(e,t,n):this.modified[e]=n}else{cZ("object"==typeof t,`ObjectDifference: expected JSON, but got a ${typeof t} in ${e}`),cZ("object"==typeof n,`ObjectDifference: expected JSON, but got a ${typeof n} in ${e}`);const r=Z8.from(t,n);r.countChanges()>0&&(this.modified[e]=r)}}addCommonKeyList(e,t,n){let r=!0;for(let i=0;r&&i<t.length;i++)typeof t[i]==typeof n[i]&&"object"==typeof t[i]?Z8.differs(t[i],n[i])&&(r=!1,this.modified[e]=n):t[i]!==n[i]&&(r=!1,this.modified[e]=n)}addRemovedKeys(e,t){for(const n of e)this.removed[n]=t[n]}countChanges(){const e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}isPresent(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}function q8(e){return 1e3*e.seconds+e.nanoseconds/1e6}function W8(e,t){return q8(t)-q8(e)}function j8(e){return R((t,n)=>{Y(e).subscribe(new x(n,()=>n.complete(),p)),!n.closed&&t.subscribe(n)})}let Y8=(()=>{class e{transform(e){const t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize`${r} hours`):1===r&&i.push($localize`1 hour`),n>1?i.push($localize`${n} minutes`):1===n&&i.push($localize`1 minute`),t>1?i.push($localize`${t} seconds`):1===t&&i.push($localize`1 second`),0===i.length)return $localize`0 seconds`;if(1===i.length)return i[0];{const e=i.slice(0,-1).join(", "),t=i.slice(-1)[0];return $localize`${e} and ${t}`}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=ot({name:"humanDuration",type:e,pure:!0}),e})();function K8(e,t){if(1&e&&(ma(0),Qa(1),ya()),2&e){const e=Sa(3);ks(1),Xa(e.viewInfo.chosenOpponent)}}function Q8(e,t){1&e&&sc(0,44)}function X8(e,t){if(1&e&&(fa(0,"div",45),fa(1,"div",8),fa(2,"label",46),ma(3),sc(4,47),ya(),fa(5,"output"),Qa(6),Ou(7,"humanDuration"),pa(),pa(),fa(8,"div",37),ga(9,"input",48),pa(),pa(),fa(10,"div",8),fa(11,"label",49),rc(12,50),ga(13,"output"),Ou(14,"humanDuration"),ic(),pa(),fa(15,"div",37),ga(16,"input",51),pa(),pa(),pa()),2&e){const e=Sa(3);ks(6),Xa(ku(7,2,e.viewInfo.maximalMoveDuration||0)),ks(8),oc(ku(14,4,e.viewInfo.totalPartDuration||0)),ac(12)}}function J8(e,t){1&e&&(fa(0,"div"),rc(1,52),ga(2,"br"),ic(),pa())}function e7(e,t){1&e&&(fa(0,"button",64),sc(1,65),pa())}function t7(e,t){if(1&e){const e=va();fa(0,"tr",60),Ea("click",function(){const t=Gt(e).$implicit;return Sa(4).selectOpponent(t)}),fa(1,"td",61),Qa(2),pa(),fa(3,"td",62),la(4,e7,2,0,"button",63),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa(4);ka("id","presenceOf_",e,""),ha("ngClass",n.viewInfo.candidateClasses[e]),ks(1),ha("id",n.viewInfo.chosenOpponent===e?"selected_"+e:"candidate_"+e),ks(1),Xa(e),ks(2),ha("ngIf",n.viewInfo.chosenOpponent!==e)}}function n7(e,t){if(1&e&&(ma(0),sc(1,53),ya(),fa(2,"div",54),fa(3,"table",55),fa(4,"thead"),fa(5,"tr"),fa(6,"th",56),sc(7,57),pa(),fa(8,"th",56),sc(9,58),pa(),pa(),pa(),fa(10,"tbody"),la(11,t7,5,5,"tr",59),pa(),pa(),pa()),2&e){const e=Sa(3);ks(11),ha("ngForOf",e.viewInfo.candidates)}}function r7(e,t){if(1&e){const e=va();fa(0,"button",66),Ea("click",function(){return Gt(e),Sa(3).changeConfig()}),sc(1,67),pa()}}function i7(e,t){if(1&e){const e=va();fa(0,"div"),fa(1,"h1",4),sc(2,5),pa(),fa(3,"form",6),fa(4,"fieldset",7),fa(5,"div",8),fa(6,"label",9),sc(7,10),pa(),fa(8,"div",11),fa(9,"button",12),Ea("click",function(){return Gt(e),Sa(2).selectFirstPlayer("RANDOM")}),sc(10,13),pa(),fa(11,"button",14),Ea("click",function(){return Gt(e),Sa(2).selectFirstPlayer("CREATOR")}),sc(12,15),pa(),fa(13,"button",16),Ea("click",function(){return Gt(e),Sa(2).selectFirstPlayer("CHOSEN_PLAYER")}),la(14,K8,2,1,"ng-container",17),la(15,Q8,1,0,"ng-template",null,18,ju),pa(),pa(),pa(),fa(17,"div",8),fa(18,"label",9),sc(19,19),pa(),fa(20,"div",11),fa(21,"div",20),Ea("click",function(){return Gt(e),Sa(2).selectPartType("STANDARD")}),fa(22,"div",21),fa(23,"span"),sc(24,22),pa(),pa(),fa(25,"div",23),fa(26,"div",24),fa(27,"div",25),fa(28,"p"),ma(29),sc(30,26),ya(),fa(31,"strong"),Qa(32),Ou(33,"humanDuration"),pa(),ga(34,"br"),ma(35),rc(36,27),ga(37,"strong"),Ou(38,"humanDuration"),ic(),ya(),pa(),pa(),pa(),pa(),pa(),fa(39,"div",28),Ea("click",function(){return Gt(e),Sa(2).selectPartType("BLITZ")}),fa(40,"div",21),fa(41,"span"),sc(42,29),pa(),pa(),fa(43,"div",23),fa(44,"div",24),fa(45,"div",25),fa(46,"p"),ma(47),sc(48,30),ya(),fa(49,"strong"),Qa(50),Ou(51,"humanDuration"),pa(),ga(52,"br"),ma(53),rc(54,31),ga(55,"strong"),Ou(56,"humanDuration"),ic(),ya(),pa(),pa(),pa(),pa(),pa(),fa(57,"button",32),Ea("click",function(){return Gt(e),Sa(2).selectPartType("CUSTOM")}),sc(58,33),pa(),pa(),pa(),la(59,X8,17,6,"div",34),fa(60,"div",8),fa(61,"label",35),sc(62,36),pa(),fa(63,"div",37),la(64,J8,3,0,"div",17),la(65,n7,12,1,"ng-template",null,38,ju),pa(),pa(),pa(),fa(67,"div",8),fa(68,"div",11),fa(69,"button",39),Ea("click",function(){return Gt(e),Sa(2).proposeConfig()}),sc(70,40),pa(),la(71,r7,2,0,"button",41),fa(72,"button",42),Ea("click",function(){return Gt(e),Sa(2).cancelGameCreation()}),sc(73,43),pa(),pa(),pa(),pa(),pa()}if(2&e){const e=ca(16),t=ca(66),n=Sa(2);ks(3),ha("formGroup",n.configFormGroup),ks(1),ha("disabled",!n.viewInfo.canEditConfig),ks(5),ha("ngClass",n.viewInfo.firstPlayerClasses.RANDOM),ks(2),ha("ngClass",n.viewInfo.firstPlayerClasses.CREATOR),ks(2),ha("ngClass",n.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),ks(1),ha("ngIf",n.viewInfo.chosenOpponent)("ngIfElse",e),ks(7),ha("ngClass",n.viewInfo.partTypeClasses.STANDARD),ks(11),Xa(ku(33,19,n.partType.NORMAL_MOVE_DURATION)),ks(6),oc(ku(38,21,n.partType.NORMAL_PART_DURATION)),ac(36),ks(1),ha("ngClass",n.viewInfo.partTypeClasses.BLITZ),ks(11),Xa(ku(51,23,n.partType.BLITZ_MOVE_DURATION)),ks(6),oc(ku(56,25,n.partType.BLITZ_PART_DURATION)),ac(54),ks(1),ha("ngClass",n.viewInfo.partTypeClasses.CUSTOM),ks(2),ha("ngIf",n.viewInfo.showCustomTime),ks(5),ha("ngIf",0===n.viewInfo.candidates.length)("ngIfElse",t),ks(5),ha("disabled",!n.viewInfo.canProposeConfig),ks(2),ha("ngIf",n.viewInfo.canReviewConfig)}}function s7(e,t){if(1&e&&(fa(0,"div",74),fa(1,"p"),rc(2,75),ga(3,"br"),ic(),pa(),pa()),2&e){const e=Sa(3);ks(3),oc(e.viewInfo.creator),ac(2)}}function o7(e,t){if(1&e&&(fa(0,"span"),sc(1,81),pa()),2&e){const e=Sa(4);ks(1),oc(e.viewInfo.creator),ac(1)}}function a7(e,t){1&e&&(fa(0,"span"),sc(1,82),pa())}function l7(e,t){1&e&&(fa(0,"span"),sc(1,83),pa())}function c7(e,t){if(1&e){const e=va();fa(0,"div",74),fa(1,"p"),sc(2,76),pa(),fa(3,"ul"),fa(4,"li"),la(5,o7,2,1,"span",2),la(6,a7,2,0,"span",2),la(7,l7,2,0,"span",2),pa(),fa(8,"li"),rc(9,77),ga(10,"strong"),Ou(11,"humanDuration"),ic(),pa(),fa(12,"li"),rc(13,78),ga(14,"strong"),Ou(15,"humanDuration"),ic(),pa(),pa(),fa(16,"button",79),Ea("click",function(){return Gt(e),Sa(3).acceptConfig()}),sc(17,80),pa(),pa()}if(2&e){const e=Sa(3);ks(2),oc(e.viewInfo.creator)(e.viewInfo.partTypeName),ac(2),ks(3),ha("ngIf","CREATOR"===e.viewInfo.firstPlayer),ks(1),ha("ngIf","CHOSEN_PLAYER"===e.viewInfo.firstPlayer),ks(1),ha("ngIf","RANDOM"===e.viewInfo.firstPlayer),ks(4),oc(ku(11,7,e.viewInfo.maximalMoveDuration||0)),ac(9),ks(4),oc(ku(15,9,e.viewInfo.totalPartDuration||0)),ac(13)}}function u7(e,t){if(1&e&&(fa(0,"div"),fa(1,"div",68),fa(2,"div",69),fa(3,"p"),sc(4,70),pa(),pa(),fa(5,"div",71),la(6,s7,4,1,"div",72),la(7,c7,18,11,"ng-template",null,73,ju),pa(),pa(),pa()),2&e){const e=ca(8),t=Sa(2);ks(6),ha("ngIf",t.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function h7(e,t){if(1&e&&(ma(0),sc(1,86),ya()),2&e){const e=Sa(3);ks(1),oc(e.viewInfo.creator),ac(1)}}function d7(e,t){if(1&e&&sc(0,87),2&e){const e=Sa(3);oc(e.viewInfo.creator)(e.viewInfo.chosenOpponent),ac(0)}}function f7(e,t){if(1&e&&(fa(0,"div",68),fa(1,"div",69),fa(2,"p"),sc(3,84),pa(),pa(),fa(4,"div",71),fa(5,"p"),la(6,h7,2,1,"ng-container",17),la(7,d7,1,2,"ng-template",null,85,ju),pa(),pa(),pa()),2&e){const e=ca(8),t=Sa(2);ks(6),ha("ngIf",t.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function p7(e,t){if(1&e&&(fa(0,"div",1),la(1,i7,74,27,"div",2),la(2,u7,9,2,"div",2),la(3,f7,9,2,"div",3),pa()),2&e){const e=Sa();ks(1),ha("ngIf",e.viewInfo.userIsCreator),ks(1),ha("ngIf",e.viewInfo.userIsChosenOpponent),ks(1),ha("ngIf",e.viewInfo.userIsObserver)}}class g7{constructor(e,t,n,r,i,s,o,l){this.router=e,this.connectedUserService=t,this.gameService=n,this.configRoomService=r,this.chatService=i,this.userService=s,this.formBuilder=o,this.messageDisplayer=l,this.partType=CZ,this.gameStartNotification=new Nu,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new A,this.allUserInterval=Aw.empty(),this.ownTokenInterval=Aw.empty(),this.selfSubscription=new a,this.configRoomSubscription=new a,this.candidatesSubscription=new a,this.allDocDeleted=!1,Ow(g7.VERBOSE,"PartCreationComponent constructed")}ngOnInit(){var e=this;return Sw(function*(){Ow(g7.VERBOSE,"PartCreationComponent.ngOnInit"),e.checkInputs(),e.createForms();const t=yield e.configRoomService.joinGame(e.partId);if(t.isFailure()){const n=t.getReason();e.messageDisplayer.criticalMessage(n)}else yield e.updateUserDocWithObservedPart(),yield e.startSendingPresenceTokens(),e.subscribeToConfigRoomDoc(),e.subscribeToFormElements(),Ow(g7.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds")})()}checkInputs(){const e=this.connectedUserService.user;cZ(e.isPresent()&&e.get()!==pZ.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),cZ(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[vZ.RANDOM.value,cp.required],maximalMoveDuration:[CZ.NORMAL_MOVE_DURATION,cp.required],partType:["STANDARD",cp.required],totalPartDuration:[CZ.NORMAL_PART_DURATION,cp.required],chosenOpponent:["",cp.required]})}updateUserDocWithObservedPart(){return Ow(g7.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'"),this.connectedUserService.updateObservedPart(this.partId)}subscribeToConfigRoomDoc(){var e=this;const t=function(){var t=Sw(function*(t){yield e.onCurrentConfigRoomUpdate(t)});return function(e){return t.apply(this,arguments)}}(),n=function(){var t=Sw(function*(t){yield e.onCandidatesUpdate(t)});return function(e){return t.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,t),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,n)}getForm(e){return bw.getNonNullable(this.configFormGroup.get(e))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(j8(this.ngUnsubscribe)).subscribe(e=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[e]=["is-selected"],this.viewInfo.chosenOpponent=e;const t=bw.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=t!==_Z.CONFIG_PROPOSED.value&&""!==e}),this.getForm("partType").valueChanges.pipe(j8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[e]=["is-primary","is-selected"],this.viewInfo.partType=e,this.viewInfo.showCustomTime="CUSTOM"===e}),this.getForm("maximalMoveDuration").valueChanges.pipe(j8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.maximalMoveDuration=e}),this.getForm("totalPartDuration").valueChanges.pipe(j8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.totalPartDuration=e}),this.getForm("firstPlayer").valueChanges.pipe(j8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[e]=["is-primary","is-selected"],this.viewInfo.firstPlayer=e})}updateViewInfo(){const e=bw.getNonNullable(this.currentConfigRoom),t=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=e.partStatus===_Z.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==_Z.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=t.id===e.creator.id,this.viewInfo.userIsChosenOpponent=t.id===e.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==_Z.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator.name,this.viewInfo.candidates=this.candidates.map(e=>e.name),t.id===e.creator.id?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenOpponent?.name,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??e.totalPartDuration;let t=this.viewInfo.chosenOpponent;null==t||""===t?t=e.chosenOpponent?.name??"":!1===this.candidates.some(e=>e.name===t)&&(t=""),this.getForm("chosenOpponent").setValue(t)}selectFirstPlayer(e){this.getForm("firstPlayer").setValue(e)}selectPartType(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(CZ.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(CZ.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(CZ.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(CZ.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}selectOpponent(e){var t=this;return Sw(function*(){Ow(g7.VERBOSE,"PartCreationComponent.setChosenOpponent("+e+")");const n=t.getUserFromName(e);return t.configRoomService.setChosenOpponent(t.partId,n)})()}getUserFromName(e){const t=this.candidates.find(t=>t.name===e);return bw.getNonNullable(t)}changeConfig(){var e=this;return Sw(function*(){return e.configRoomService.reviewConfig(e.partId)})()}proposeConfig(){var e=this;return Sw(function*(){const t=e.getForm("chosenOpponent").value,n=e.getForm("partType").value,r=e.getForm("maximalMoveDuration").value,i=e.getForm("firstPlayer").value,s=e.getForm("totalPartDuration").value,o=e.getUserFromName(t);return e.configRoomService.proposeConfig(e.partId,o,CZ.of(n),r,vZ.of(i),s)})()}cancelGameCreation(){var e=this;return Sw(function*(){e.allDocDeleted=!0,yield e.connectedUserService.removeObservedPart(),Ow(g7.VERBOSE,"PartCreationComponent.cancelGameCreation"),yield e.chatService.deleteChat(e.partId),Ow(g7.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),yield e.gameService.deletePart(e.partId),Ow(g7.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),yield e.configRoomService.deleteConfigRoom(e.partId,e.candidates),Ow(g7.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(e){var t=this;return Sw(function*(){if(Ow(g7.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(t.currentConfigRoom),then:JSON.stringify(e)}}),e.isAbsent())return Ow(g7.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),t.onGameCancelled();if(t.chosenOpponentJustLeft(e.get())){const e=bw.getNonNullable(t.currentConfigRoom),n=bw.getNonNullable(e.chosenOpponent).name;t.messageDisplayer.infoMessage($localize`${n} left the game, please pick another opponent.`)}t.currentConfigRoom=e.get(),t.allUserInterval.isAbsent()&&(yield t.observePlayers()),t.updateViewInfo(),t.isGameStarted()&&(Ow(g7.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),t.onGameStarted())})()}onCandidatesUpdate(e){var t=this;return Sw(function*(){t.candidates=e,t.updateViewInfo()})()}chosenOpponentJustLeft(e){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent)}onGameCancelled(){var e=this;return Sw(function*(){Ow(g7.VERBOSE,"PartCreationComponent.onGameCancelled"),e.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield e.router.navigate(["/lobby"])})()}isGameStarted(){return bw.getNonNullable(this.currentConfigRoom).partStatus===_Z.PART_STARTED.value}onGameStarted(){const e=bw.getNonNullable(this.currentConfigRoom);Ow(g7.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:e}}),this.gameStartNotification.emit(e),this.gameStarted=!0,Ow(g7.VERBOSE,"PartCreationComponent.onGameStarted finished")}observePlayers(){var e=this;return Sw(function*(){cZ(e.allUserInterval.isAbsent(),"Cannot observe players multiple times");const t=e.connectedUserService.user.get().id;e.allUserInterval=Aw.of(window.setInterval(Sw(function*(){const n=bw.getNonNullable(e.currentConfigRoom),r=e.lastToken;t===n.creator.id?yield e.checkCandidatesTokensFreshness(r):yield e.checkCreatorTokenFreshness(r)}),g7.TOKEN_INTERVAL))})()}checkCreatorTokenFreshness(e){var t=this;return Sw(function*(){const n=bw.getNonNullable(t.currentConfigRoom);(yield t.didUserTimeout(n.creator.id,e))&&(yield t.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var e=this;return Sw(function*(){cZ(!1==(bw.getNonNullable(e.currentConfigRoom).partStatus===_Z.PART_STARTED.value),"Should not try to cancelGameCreation when part started!"),cZ(!1===e.allDocDeleted,"Should not delete doc twice"),yield e.cancelGameCreation()})()}checkCandidatesTokensFreshness(e){var t=this;return Sw(function*(){for(const n of t.candidates)(yield t.didUserTimeout(n.id,e))&&(yield t.removeCandidateFromLobby(n))})()}didUserTimeout(e,t){var n=this;return Sw(function*(){const r=yield n.userService.getUserLastUpdateTime(e);return r.isAbsent()?(lZ.logError("PartCreationComponent","found no user while observing "+e+" !"),!0):W8(r.get(),t)>g7.TOKEN_TIMEOUT})()}removeCandidateFromLobby(e){var t=this;return Sw(function*(){const n=bw.getNonNullable(t.currentConfigRoom);return e.id===n.chosenOpponent?.id&&(yield t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId)),t.configRoomService.removeCandidate(t.partId,e)})()}startSendingPresenceTokens(){var e=this;return Sw(function*(){yield e.connectedUserService.sendPresenceToken(),cZ(e.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),e.ownTokenInterval=Aw.of(window.setInterval(()=>{e.connectedUserService.sendPresenceToken()},g7.TOKEN_INTERVAL));const t=e.connectedUserService.user.get().id;e.selfSubscription=e.userService.observeUser(t,t=>{cZ(t.isPresent(),"connected user should exist");const n=t.get();null!=n.lastUpdateTime&&(e.lastToken=n.lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=Aw.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return Ow(g7.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,bw.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var e=this;return Sw(function*(){Ow(g7.VERBOSE,"PartCreationComponent.ngOnDestroy"),e.ngUnsubscribe.next(),e.ngUnsubscribe.complete(),e.configRoomSubscription.unsubscribe(),e.candidatesSubscription.unsubscribe(),e.stopSendingPresenceTokensAndObservingUsersIfNeeded();const t=e.connectedUserService.user.get();!0!==e.gameStarted&&(null===e.currentConfigRoom?Ow(g7.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"):!0===e.allDocDeleted?Ow(g7.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"):t.id===e.currentConfigRoom.creator.id?(Ow(g7.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),yield e.cancelGameCreation()):(Ow(g7.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),yield e.connectedUserService.removeObservedPart(),yield e.configRoomService.cancelJoining(e.partId)))})()}}function m7(e,t){if(1&e){const e=va();fa(0,"button",3),Ea("click",function(){return Gt(e),Sa().addTime()}),sc(1,4),pa()}if(2&e){const e=Sa();ks(1),oc(e.timeToAdd),ac(1)}}g7.VERBOSE=!1,g7.TOKEN_INTERVAL=5e3,g7.TOKEN_TIMEOUT=2*g7.TOKEN_INTERVAL,g7.\u0275fac=function(e){return new(e||g7)(ua(fC),ua(gZ),ua(DZ),ua(xZ),ua(iZ),ua(hZ),ua(Lg),ua(aZ))},g7.\u0275cmp=Je({type:g7,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h,d,f,p,g,m,y,v,C,_,E,w,P,S,b,O,k,T,I,A,M,N,R,x,D;return e=$localize`Game creation`,t=$localize`First player`,n=$localize`Random`,r=$localize`You`,i=$localize`Game type`,s=$localize`Standard`,o=$localize`Maximal turn duration: `,a=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,l=$localize`Blitz`,c=$localize`Maximal turn duration: `,u=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,h=$localize`Custom`,d=$localize`Opponents`,f=$localize`Propose configuration`,p=$localize`Cancel game`,g=$localize`The opponent`,m=$localize`Maximal turn duration: `,y=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,v=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,C=$localize`Click on the opponent against which you would like to play.`,_=$localize`Name`,E=$localize`Actions`,w=$localize`Pick`,P=$localize`Change configuration`,S=$localize`Configuration proposal`,b=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,O=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,k=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,T=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,I=$localize`Accept and start`,A=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,M=$localize`you play first`,N=$localize`the first player is selected randomly`,R=$localize`One moment...`,x=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,D=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],e,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],t,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],n,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],r,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],i,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],s,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,a,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],l,c,u,["id","partTypeCustom",1,"button",3,"ngClass","click"],h,["id","customTime",4,"ngIf"],[1,"label"],d,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],f,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],p,g,["id","customTime"],["for","maximalMoveDuration",1,"label"],m,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],y,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],v,C,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],_,E,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],w,["id","reviewConfig",1,"button",3,"click"],P,[1,"message","is-primary"],[1,"message-header"],S,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],b,O,k,T,["id","acceptConfig",1,"button","is-primary",3,"click"],I,A,M,N,R,["proposalSent",""],x,D]},template:function(e,t){1&e&&la(0,p7,4,3,"div",0),2&e&&ha("ngIf",t.viewInfo)},directives:[tf,dg,xp,vg,Qd,rp,gg,Rp,_g,Jd],pipes:[Y8],encapsulation:2});let y7=(()=>{class e{constructor(){this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new Nu,this.addTimeToOpponent=new Nu,this.cssClasses=e.SAFE_TIME}ngOnInit(){Ow(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}setDuration(t){if(Ow(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}changeDuration(e){let t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){if(Ow(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}resume(){if(Ow(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();const t=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},t),this.countSeconds()}onEndReached(){Ow(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){if(Ow(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){if(Ow(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){Ow(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}}return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Je({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let e;return e=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],e]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"p",1),Qa(2),Ou(3,"number"),pa(),la(4,m7,2,1,"button",2),pa()),2&e&&(ha("ngClass",t.getTimeClass()),ks(2),el("",t.displayedMinute,":",Tu(3,4,t.displayedSec,"2.0-0"),""),ks(2),ha("ngIf",t.canAddTime))},directives:[Qd,tf],pipes:[sf],encapsulation:2}),e})();const v7=["partCreation"],C7=["chatComponent"],_7=["chronoZeroGlobal"],E7=["chronoOneGlobal"],w7=["chronoZeroTurn"],P7=["chronoOneTurn"];function S7(e,t){if(1&e){const e=va();fa(0,"app-part-creation",5,6),Ea("gameStartNotification",function(t){return Gt(e),Sa().startGame(t)}),pa()}2&e&&ha("partId",Sa().currentPartId)}function b7(e,t){1&e&&(ma(0),sc(1,40),ya())}function O7(e,t){if(1&e&&(ma(0),sc(1,41),ya()),2&e){const e=Sa(4);ks(1),oc(null==e.currentPlayer?null:e.currentPlayer.name),ac(1)}}function k7(e,t){if(1&e&&(fa(0,"p",37),la(1,b7,2,0,"ng-container",38),la(2,O7,2,1,"ng-template",null,39,ju),pa()),2&e){const e=ca(3),t=Sa(3);ks(1),ha("ngIf",(null==t.currentPlayer?null:t.currentPlayer.name)===t.getPlayer().name)("ngIfElse",e)}}function T7(e,t){if(1&e&&(fa(0,"div",33),fa(1,"p",34),sc(2,35),pa(),la(3,k7,4,2,"p",36),pa()),2&e){const e=Sa(2);ks(2),oc(e.currentPart.getTurn()+1),ac(2),ks(1),ha("ngIf",!1===e.endGame)}}function I7(e,t){if(1&e&&(fa(0,"p",42),Qa(1),pa()),2&e){const e=Sa(2);ha("ngClass",e.getPlayerNameClass(e.Player.ZERO)),ks(1),Xa(e.players[0].get().name)}}function A7(e,t){if(1&e&&(fa(0,"p",43),sc(1,44),pa()),2&e){const e=Sa(2);ks(1),oc(e.gameComponent.scores.get()[0]),ac(1)}}function M7(e,t){if(1&e&&(fa(0,"p",45),Qa(1),pa()),2&e){const e=Sa(2);ha("ngClass",e.getPlayerNameClass(e.Player.ONE)),ks(1),Xa(e.players[1].get().name)}}function N7(e,t){if(1&e&&(fa(0,"p",46),sc(1,47),pa()),2&e){const e=Sa(2);ks(1),oc(e.gameComponent.scores.get()[1]),ac(1)}}function R7(e,t){if(1&e){const e=va();fa(0,"button",56),Ea("click",function(){return Gt(e),Sa(3).resign()}),sc(1,57),pa()}}function x7(e,t){if(1&e){const e=va();fa(0,"button",58),Ea("click",function(){return Gt(e),Sa(3).proposeDraw()}),sc(1,59),pa()}}function D7(e,t){if(1&e){const e=va();fa(0,"button",60),Ea("click",function(){return Gt(e),Sa(3).acceptDraw()}),sc(1,61),pa()}}function L7(e,t){if(1&e){const e=va();fa(0,"button",62),Ea("click",function(){return Gt(e),Sa(3).refuseDraw()}),sc(1,63),pa()}}function F7(e,t){if(1&e){const e=va();fa(0,"button",64),Ea("click",function(){return Gt(e),Sa(3).gameComponent.pass()}),sc(1,65),pa()}}function U7(e,t){if(1&e){const e=va();fa(0,"button",66),Ea("click",function(){return Gt(e),Sa(3).acceptTakeBack()}),sc(1,67),pa()}}function V7(e,t){if(1&e){const e=va();fa(0,"button",68),Ea("click",function(){return Gt(e),Sa(3).refuseTakeBack()}),sc(1,69),pa()}}function B7(e,t){if(1&e){const e=va();fa(0,"button",70),Ea("click",function(){return Gt(e),Sa(3).askTakeBack()}),sc(1,71),pa()}}function $7(e,t){if(1&e&&(ma(0),la(1,R7,2,0,"button",48),la(2,x7,2,0,"button",49),la(3,D7,2,0,"button",50),la(4,L7,2,0,"button",51),la(5,F7,2,0,"button",52),la(6,U7,2,0,"button",53),la(7,V7,2,0,"button",54),la(8,B7,2,0,"button",55),ya()),2&e){const e=Sa(2);ks(1),ha("ngIf",e.canResign()),ks(1),ha("ngIf",e.canProposeDraw()),ks(1),ha("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),ks(1),ha("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),ks(1),ha("ngIf",!1===e.endGame&&e.isPlaying()&&e.gameComponent.canPass&&(null==e.currentPlayer?null:e.currentPlayer.name)===e.getPlayer().name),ks(1),ha("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),ks(1),ha("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),ks(1),ha("ngIf",!1===e.endGame&&!1===e.isOpponentWaitingForTakeBackResponse()&&e.canAskTakeBack())}}function z7(e,t){1&e&&(fa(0,"div"),fa(1,"p",73),sc(2,74),pa(),pa())}function H7(e,t){1&e&&(fa(0,"p",78),sc(1,79),pa())}function G7(e,t){1&e&&(fa(0,"p",80),sc(1,81),pa())}function Z7(e,t){1&e&&(fa(0,"p",82),sc(1,83),pa())}function q7(e,t){if(1&e&&(fa(0,"div"),la(1,H7,2,0,"p",75),la(2,G7,2,0,"p",76),la(3,Z7,2,0,"p",77),pa()),2&e){const e=Sa(3);ks(1),ha("ngIf",e.currentPart.getDrawAccepter().name===e.getPlayer().name),ks(1),ha("ngIf",e.currentPart.getDrawAccepter().name!==e.getPlayer().name&&e.isPlaying()),ks(1),ha("ngIf",!1===e.isPlaying())}}function W7(e,t){1&e&&(fa(0,"p",86),sc(1,87),pa())}function j7(e,t){1&e&&(fa(0,"p",88),sc(1,89),pa())}function Y7(e,t){if(1&e&&(fa(0,"p",88),sc(1,90),pa()),2&e){const e=Sa(4);ks(1),oc(e.currentPart.getWinner().get().name),ac(1)}}function K7(e,t){if(1&e&&(fa(0,"div"),la(1,W7,2,0,"p",84),la(2,j7,2,0,"p",85),la(3,Y7,2,1,"p",85),pa()),2&e){const e=Sa(3);ks(1),ha("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),ks(1),ha("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),ks(1),ha("ngIf",!1===e.isPlaying())}}function Q7(e,t){if(1&e&&(fa(0,"p",86),sc(1,91),pa()),2&e){const e=Sa(4);ks(1),oc(e.currentPart.getLoser().get().name),ac(1)}}function X7(e,t){1&e&&(fa(0,"p",88),sc(1,92),pa())}function J7(e,t){if(1&e&&(fa(0,"p",88),sc(1,93),pa()),2&e){const e=Sa(4);ks(1),oc(e.currentPart.getLoser().get().name),ac(1)}}function e9(e,t){if(1&e&&(fa(0,"div"),la(1,Q7,2,1,"p",84),la(2,X7,2,0,"p",85),la(3,J7,2,1,"p",85),pa()),2&e){const e=Sa(3);ks(1),ha("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),ks(1),ha("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),ks(1),ha("ngIf",!1===e.isPlaying())}}function t9(e,t){1&e&&(fa(0,"p",95),sc(1,96),pa())}function n9(e,t){if(1&e&&(fa(0,"p",95),sc(1,97),pa()),2&e){const e=Sa(4);ks(1),oc(e.currentPart.getLoser().get().name),ac(1)}}function r9(e,t){if(1&e&&(fa(0,"div"),la(1,t9,2,0,"p",94),la(2,n9,2,1,"p",94),pa()),2&e){const e=Sa(3);ks(1),ha("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),ks(1),ha("ngIf",!1===e.isPlaying()||e.currentPart.getWinner().get().name===e.getPlayer().name)}}function i9(e,t){if(1&e&&(fa(0,"div",72),ga(1,"hr"),la(2,z7,3,0,"div",26),la(3,q7,4,3,"div",26),la(4,K7,4,3,"div",26),la(5,e9,4,3,"div",26),la(6,r9,3,2,"div",26),pa()),2&e){const e=Sa(2);ks(2),ha("ngIf",e.currentPart.isHardDraw()),ks(1),ha("ngIf",e.currentPart.isAgreedDraw()),ks(1),ha("ngIf",e.currentPart.isWin()),ks(1),ha("ngIf",e.currentPart.isTimeout()),ks(1),ha("ngIf",e.currentPart.isResign())}}function s9(e,t){1&e&&(fa(0,"button",98),sc(1,99),pa())}function o9(e,t){if(1&e){const e=va();fa(0,"button",100),Ea("click",function(){return Gt(e),Sa(2).proposeRematch()}),sc(1,101),pa()}}function a9(e,t){if(1&e){const e=va();fa(0,"button",102),Ea("click",function(){return Gt(e),Sa(2).acceptRematch()}),sc(1,103),pa()}}function l9(e,t){if(1&e){const e=va();fa(0,"div",7),fa(1,"div",8),fa(2,"div",9),la(3,T7,4,2,"div",10),fa(4,"div",11),la(5,I7,2,2,"p",12),la(6,A7,2,1,"p",13),fa(7,"app-count-down",14,15),Ea("outOfTimeAction",function(){Gt(e);const t=Sa();return t.reachedOutOfTime(t.Player.ZERO)})("addTimeToOpponent",function(){return Gt(e),Sa().addGlobalTime()}),pa(),fa(9,"app-count-down",16,17),Ea("outOfTimeAction",function(){Gt(e);const t=Sa();return t.reachedOutOfTime(t.Player.ZERO)})("addTimeToOpponent",function(){return Gt(e),Sa().addTurnTime()}),pa(),pa(),fa(11,"p",18),sc(12,19),pa(),fa(13,"div",11),la(14,M7,2,2,"p",20),la(15,N7,2,1,"p",21),fa(16,"app-count-down",22,23),Ea("outOfTimeAction",function(){Gt(e);const t=Sa();return t.reachedOutOfTime(t.Player.ONE)})("addTimeToOpponent",function(){return Gt(e),Sa().addGlobalTime()}),pa(),fa(18,"app-count-down",24,25),Ea("outOfTimeAction",function(){Gt(e);const t=Sa();return t.reachedOutOfTime(t.Player.ONE)})("addTimeToOpponent",function(){return Gt(e),Sa().addTurnTime()}),pa(),pa(),ga(20,"hr"),la(21,$7,9,8,"ng-container",26),la(22,i9,7,5,"div",27),la(23,s9,2,0,"button",28),la(24,o9,2,0,"button",29),la(25,a9,2,0,"button",30),pa(),pa(),fa(26,"div",31),fa(27,"div",32),ga(28,"app-game-includer"),pa(),pa(),pa()}if(2&e){const e=Sa();ks(3),ha("ngIf",e.currentPart),ks(2),ha("ngIf",e.players[0].isPresent()),ks(1),ha("ngIf",e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),ks(1),ha("dangerTimeLimit",6e4)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),ks(2),ha("dangerTimeLimit",15e3)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),ks(5),ha("ngIf",e.players[1].isPresent()),ks(1),ha("ngIf",e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),ks(1),ha("dangerTimeLimit",6e4)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),ks(2),ha("dangerTimeLimit",15e3)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),ks(3),ha("ngIf",e.isPlaying()),ks(1),ha("ngIf",e.endGame),ks(1),ha("ngIf",e.endGame),ks(1),ha("ngIf",e.endGame&&e.isPlaying()&&!1===e.rematchProposed),ks(1),ha("ngIf",e.endGame&&e.isPlaying()&&e.rematchProposed&&e.opponentProposedRematch),ks(1),ha("ngClass",e.getBoardHighlight())}}let c9=(()=>{class e{}return e.NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`,e})();class u9{constructor(e){this.value=e}}u9.PRE_START_DOC=new u9("PRE_START_DOC"),u9.STARTING_DOC=new u9("STARTING_DOC"),u9.DUPLICATE=new u9("DUPLICATE"),u9.MOVE_WITHOUT_TIME=new u9("MOVE_WITHOUT_TIME"),u9.MOVE=new u9("MOVE"),u9.REQUEST=new u9("REQUEST"),u9.END_GAME=new u9("END_GAME"),u9.END_GAME_WITHOUT_TIME=new u9("END_GAME_WITHOUT_TIME"),u9.ACCEPT_TAKE_BACK_WITHOUT_TIME=new u9("ACCEPT_TAKE_BACK_WITHOUT_TIME");let h9=(()=>{class e extends G8{constructor(t,n,r,i,s,o,l){super(t,n,s,r,i),this.userService=o,this.gameService=l,this.gameStarted=!1,this.opponent=null,this.rematchProposed=!1,this.opponentProposedRematch=!1,this.hasUserPlayed=[!1,!1],this.msToSubstract=[0,0],this.opponentSubscription=new a,this.partSubscription=new a,this.OFFLINE_FONT_COLOR={color:"lightgrey"},this.globalTimeMessage=$localize`5 minutes`,this.turnTimeMessage=$localize`30 seconds`,Ow(e.VERBOSE,"OnlineGameWrapperComponent constructed")}extractPartIdFromURL(){return bw.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return bw.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}isPlayer(e){return this.role===e}isOpponent(e){return this.role!==e}redirectIfPartOrGameIsInvalid(){var e=this;return Sw(function*(){const t=e.extractGameNameFromURL();if(o8.ALL_GAMES().some(e=>e.urlName===t)){if((yield e.gameService.getPartValidity(e.currentPartId,t)).isFailure()){e.routerEventsSub.unsubscribe();const t=c9.NO_MATCHING_PART();yield e.router.navigate(["/notFound",t],{skipLocationChange:!0})}}else{e.routerEventsSub.unsubscribe();const n=H8.NO_MATCHING_GAME(t);yield e.router.navigate(["/notFound",n],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var t=this;return Sw(function*(){Ow(e.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),t.routerEventsSub=t.router.events.subscribe(function(){var e=Sw(function*(e){e instanceof Vm&&(yield t.setCurrentPartIdOrRedirect())});return function(t){return e.apply(this,arguments)}}()),t.userSub=t.connectedUserService.subscribeToUser(e=>{t.authUser=e}),yield t.setCurrentPartIdOrRedirect(),Ow(e.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done")})()}startGame(t){var n=this;return Sw(function*(){Ow(e.VERBOSE,"OnlineGameWrapperComponent.startGame"),cZ(!1===n.gameStarted,"Should not start already started game"),n.configRoom=t,n.gameStarted=!0,window.setTimeout(Sw(function*(){cZ(yield n.afterGameIncluderViewInit(),"Game should be created successfully, otherwise part-creation would have redirected"),n.startPart()}),1)})()}startPart(){var t=this;Ow(e.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,function(){var e=Sw(function*(e){cZ(e.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),yield t.onCurrentPartUpdate(e.get())});return function(t){return e.apply(this,arguments)}}())}onCurrentPartUpdate(t){var n=this;return Sw(function*(){const r=new yZ(n.currentPartId,t);Ow(e.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:n.currentPart,then:t.data,before_part_turn:r.data.turn,before_state_turn:n.gameComponent.getTurn(),nbPlayedMoves:r.data.listMoves.length}});const i=n.getUpdateType(r),s=t.turn;Ow(e.VERBOSE,i===u9.REQUEST?"UpdateType: Request("+bw.getNonNullable(r.data.request).code+") ("+s+")":"UpdateType: "+i.value+"("+s+")");const o=n.currentPart;switch(n.currentPart=r,i){case u9.REQUEST:return yield n.onRequest(bw.getNonNullable(r.data.request),o);case u9.ACCEPT_TAKE_BACK_WITHOUT_TIME:return void(n.currentPart=o);case u9.DUPLICATE:return;case u9.END_GAME_WITHOUT_TIME:return void(n.currentPart=o);case u9.END_GAME:return n.applyEndGame();case u9.MOVE_WITHOUT_TIME:return void(n.currentPart=o);case u9.MOVE:return n.msToSubstract=n.getLastUpdateTime(o,r,i),n.doNewMoves(r);case u9.PRE_START_DOC:const e=null==n.currentPart||null!=n.currentPart.data.beginning;return void cZ(null==o||null==o.data.beginning||e,"old part had no beginning time or new part has, we did not expect this!");default:return cZ(i===u9.STARTING_DOC,"Unexpected update type "+i),n.setChronos(),n.setPlayersDatas(r),n.startCountDownFor(bZ.ZERO)}})()}getUpdateType(t){const n=Z8.from(null!=this.currentPart?this.currentPart.data:null,t.data);Ow(e.VERBOSE,{diff:n});const r=n.countChanges();if(0===r)return u9.DUPLICATE;if(t.data.request){const e=null!=n.removed.lastUpdateTime;return"TakeBackAccepted"===t.data.request.code&&e?u9.ACCEPT_TAKE_BACK_WITHOUT_TIME:u9.REQUEST}if(this.isMove(n,r))return 1===t.data.turn?null==t.data.lastUpdateTime?u9.MOVE_WITHOUT_TIME:u9.MOVE:null==n.modified.lastUpdateTime?u9.MOVE_WITHOUT_TIME:u9.MOVE;if(null==t.data.beginning)return u9.PRE_START_DOC;if(t.data.result!==mZ.UNACHIEVED.value){const e=null==n.modified.lastUpdateTime;return null!=n.modified.turn&&e?u9.END_GAME_WITHOUT_TIME:u9.END_GAME}return cZ(null!=t.data.beginning&&0===t.data.listMoves.length,"Unexpected update: "+JSON.stringify(n)),u9.STARTING_DOC}isMove(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){const n=3;return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+n}return!1}getLastUpdateTime(e,t,n){const r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);cZ(null!=r,"oldTime should not be null"),cZ(null!=i,"updateTime should not be null");const s=bZ.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(bw.getNonNullable(r),bw.getNonNullable(i),n,s)}getMoreRecentTime(e){return e.data.lastUpdateTime??e.data.beginning}getTimeUsedForLastTurn(e,t,n,r){const i=W8(e,t),s=[0,0];return s[r.value]=i,s}setChronos(){Ow(e.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}didUserPlay(e){return this.hasUserPlayed[e.value]}doNewMoves(t){Ow(e.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"),this.switchPlayer();const n=AZ.copyImmutableArray(t.data.listMoves),r=this.gameComponent.rules;for(;this.gameComponent.getTurn()<n.length;){const e=this.gameComponent.getTurn(),t=this.gameComponent.encoder.decode(n[e]),i=r.isLegal(t,this.gameComponent.getState()),s="We received an incorrect db move: "+t.toString()+" in "+n+" at turn "+e+'because "'+i.getReasonOr("")+'"';cZ(i.isSuccess(),s),r.choose(t)}this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.updateBoard()}switchPlayer(){Ow(e.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");const t=bZ.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get();const n=t.getOpponent();this.didUserPlay(n)&&this.pauseCountDownsFor(n),this.didUserPlay(t)?(Ow(e.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(t)):this.startCountDownFor(t)}resetChronoFor(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}applyEndGame(){const t=this.currentPart,n=bZ.fromTurn(t.data.turn);this.endGame=!0,[mZ.VICTORY,mZ.HARD_DRAW].some(e=>e.value===t.data.result)?this.doNewMoves(this.currentPart):(cZ(!0===[mZ.RESIGN,mZ.TIMEOUT,mZ.HARD_DRAW,mZ.AGREED_DRAW_BY_ZERO,mZ.AGREED_DRAW_BY_ONE].some(e=>e.value===t.data.result),"Unknown type of end game ("+t.data.result+")"),Ow(e.VERBOSE,"endGame est true et winner est "+t.getWinner())),this.stopCountdownsFor(n)}notifyDraw(e,t){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],t,!0)}notifyTimeoutVictory(e,t,n,r){var i=this;return Sw(function*(){i.endGame=!0;const s=i.currentPart.setWinnerAndLoser(e,r);i.currentPart=s,yield i.gameService.notifyTimeout(i.currentPartId,t,n,e,r)})()}notifyVictory(t,n){Ow(e.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");const r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);return r===pj.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(cZ(r===pj.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,t,[0,0],n,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}canAskTakeBack(){return cZ(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.role.value||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.role.isPlayer()&&this.currentPart.data.request.data.player===this.role.getOpponent().value)&&this.getTakeBackRequester()===OZ.NONE}isOpponentWaitingForTakeBackResponse(){const e=this.getTakeBackRequester();return!!e.isPlayer()&&this.isOpponent(e)}getTakeBackRequester(){if(null==this.currentPart)return OZ.NONE;const e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?kZ.getPlayer(e):OZ.NONE}canProposeDraw(){return cZ(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&this.role.isPlayer()&&kZ.getPlayer(this.currentPart.data.request)===this.role.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===OZ.NONE}isOpponentWaitingForDrawResponse(){const e=this.getDrawRequester();return e!==OZ.NONE&&this.isOpponent(e)}getDrawRequester(){if(null==this.currentPart)return OZ.NONE;const e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?kZ.getPlayer(e):OZ.NONE}onRequest(t,n){var r=this;return Sw(function*(){switch(Ow(e.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:t,oldPart:n}),t.code){case"TakeBackAsked":case"TakeBackRefused":case"DrawProposed":case"DrawRefused":break;case"TakeBackAccepted":r.takeBackTo(r.currentPart.data.turn);break;case"RematchProposed":r.rematchProposed=!0;const n=kZ.getPlayer(t).getOpponent();r.isPlayer(n)&&(Ow(e.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0);break;case"RematchAccepted":yield r.router.navigate(["/nextGameLoading"]),yield r.router.navigate(["/play",kZ.getTypeGame(t),kZ.getPartId(t)]);break;case"AddTurnTime":const i=3e4,s=bZ.of(t.data.player);r.addTurnTimeTo(s,i);break;case"AddGlobalTime":const o=3e5,a=bZ.of(t.data.player);r.addGlobalTimeTo(a,o);break;default:bw.expectToBe(t.code,"DrawAccepted","Unknown RequestType : "+t.code+" for "+JSON.stringify(t)),yield r.acceptDraw()}})()}takeBackTo(t){if(Ow(e.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.getTurn()===t)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();const e=bZ.fromTurn(t);this.resetChronoFor(e)}this.gameComponent.updateBoard()}setPlayersDatas(t){Ow(e.VERBOSE,{OnlineGameWrapper_setPlayersDatas:t}),this.players=[Aw.of(t.data.playerZero),Aw.ofNullable(t.data.playerOne)],cZ(null!=t.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[t.data.turn%2].get();let n=Aw.empty();if(this.players[0].get().id===this.authUser.id?(this.setRole(bZ.ZERO),n=this.players[1]):this.players[1].get().id===this.authUser.id?(this.setRole(bZ.ONE),n=this.players[0]):this.setRole(OZ.NONE),n.isPresent()){const e=e=>{cZ(e.isPresent(),"opponent was deleted, what sorcery is this"),this.opponent={id:n.get().id,name:bw.getNonNullable(e.get().username)}};this.opponentSubscription=this.userService.observeUser(n.get().id,e)}}onLegalUserMove(t,n){var r=this;return Sw(function*(){if(Ow(e.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),!r.isOpponentWaitingForTakeBackResponse())return r.updateDBBoard(t,r.msToSubstract,n);r.gameComponent.message("You must answer to take back request")})()}updateDBBoard(t,n,r){var i=this;return Sw(function*(){const s=i.gameComponent.encoder.encodeMove(t);Ow(e.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+t.toString()+", "+r+")"),i.gameComponent.rules.choose(t);const o=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node);return o.isEndGame?o===pj.DRAW?i.notifyDraw(s,r):i.notifyVictory(s,r):i.gameService.updateDBBoard(i.currentPartId,i.role,s,n,r)})()}resign(){var t=this;return Sw(function*(){Ow(e.VERBOSE,"OnlineGameWrapperComponent.resign");const n=t.getLastIndex(),r=t.role,i=t.getPlayer(),s=t.players[(t.role.value+1)%2].get();yield t.gameService.resign(t.currentPartId,n,r,s,i)})()}getLastIndex(){return this.currentPart.data.lastUpdate.index}reachedOutOfTime(t){var n=this;return Sw(function*(){Ow(e.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+t+")");const r=n.getLastIndex(),i=n.role;if(n.stopCountdownsFor(t),t===n.role){const e=bw.getNonNullable(n.opponent);yield n.notifyTimeoutVictory(e,i,r,n.authUser.toMinimalUser())}else if(cZ(!1===n.endGame,"time might be better handled in the future"),n.opponentIsOffline()){const e=bw.getNonNullable(n.opponent);yield n.notifyTimeoutVictory(n.authUser.toMinimalUser(),i,t.value,e),n.endGame=!0}})()}acceptRematch(){var e=this;return Sw(function*(){cZ(e.isPlaying(),"Non playing should not call acceptRematch");const t=new yZ(e.currentPartId,e.currentPart.data);return yield e.gameService.acceptRematch(t,e.getLastIndex(),e.role),!0})()}proposeRematch(){var e=this;return Sw(function*(){return cZ(e.isPlaying(),"Non playing should not call proposeRematch"),yield e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.role),!0})()}proposeDraw(){return cZ(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.role)}acceptDraw(){return cZ(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.role)}refuseDraw(){return cZ(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.role)}askTakeBack(){return cZ(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.role)}acceptTakeBack(){var e=this;return Sw(function*(){cZ(e.isPlaying(),"Non playing should not call acceptTakeBack");const t=e.role;yield e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,t,e.msToSubstract),e.msToSubstract=[0,0]})()}refuseTakeBack(){return cZ(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.role)}startCountDownFor(t){Ow(e.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+t.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[t.value]=!0,t===bZ.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}resumeCountDownFor(t,n=!0){let r;Ow(e.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+t.toString()+") (turn "+this.currentPart.data.turn+")"),t===bZ.ZERO?(this.chronoZeroGlobal.changeDuration(bw.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),r=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(bw.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),r=this.chronoOneTurn),n?(r.setDuration(1e3*this.configRoom.maximalMoveDuration),r.start()):r.resume()}pauseCountDownsFor(t,n=!0){let r;Ow(e.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+t.value+") (turn "+this.currentPart.data.turn+")"),t===bZ.ZERO?(this.chronoZeroGlobal.pause(),r=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),r=this.chronoOneTurn),n?r.stop():r.pause()}stopCountdownsFor(t){Ow(e.VERBOSE,"cdc::stopCountDownsFor("+t.toString()+") (turn "+this.currentPart.data.turn+")"),t===bZ.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===bZ.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}canResign(){return cZ(this.isPlaying(),"Non playing should not call canResign"),!(!0===this.endGame||null==this.opponent)}addGlobalTime(){const e=this.role,t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}addTurnTime(){return this.gameService.addTurnTime(this.role,this.getLastIndex(),this.currentPartId)}addTurnTimeTo(e,t){const n=bZ.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===bZ.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}addGlobalTimeTo(e,t){e===bZ.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}ngOnDestroy(){Ow(e.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),this.routerEventsSub.unsubscribe(),this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.unsubscribe(),this.partSubscription.unsubscribe()),Ow(e.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(Cc),ua(Zy),ua(fC),ua(aZ),ua(gZ),ua(hZ),ua(DZ))},e.\u0275cmp=Je({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){if(1&e&&(Zu(v7,5),Zu(C7,5),Zu(_7,5),Zu(E7,5),Zu(w7,5),Zu(P7,5)),2&e){let e;Gu(e=qu())&&(t.partCreation=e.first),Gu(e=qu())&&(t.chatComponent=e.first),Gu(e=qu())&&(t.chronoZeroGlobal=e.first),Gu(e=qu())&&(t.chronoOneGlobal=e.first),Gu(e=qu())&&(t.chronoZeroTurn=e.first),Gu(e=qu())&&(t.chronoOneTurn=e.first)}},features:[Go],decls:5,vars:4,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h,d,f,p,g,m,y,v,C,_,E,w,P,S,b,O,k,T;return e=$localize`vs.`,t=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,n=$localize`It is your turn.`,r=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Resign`,a=$localize`Propose a draw`,l=$localize`Accept draw`,c=$localize`Reject draw`,u=$localize`Pass a turn`,h=$localize`Accept take back`,d=$localize`Reject take back`,f=$localize`Ask to take back one move`,p=$localize`Draw`,g=$localize`You agreed to draw.`,m=$localize`Your draw proposal has been accepted.`,y=$localize`Players agreed to draw.`,v=$localize`You won.`,C=$localize`You lost.`,_=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,E=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,w=$localize`You reached your time limit.`,P=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,S=$localize`You resigned.`,b=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,O=$localize`Go back to the game list`,k=$localize`Propose to play again`,T=$localize`Accept to play again`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],e,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],n,r,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],s,["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],o,["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],a,["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],l,["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],c,["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],u,["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],h,["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],d,["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],f,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],p,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],g,["id","yourOpponentAgreedToDrawIndicator",1,"title"],m,["id","playersAgreedToDraw",1,"title"],y,["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],v,[1,"title"],C,_,E,w,P,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],S,b,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],O,["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],k,["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],T]},template:function(e,t){1&e&&(la(0,S7,2,1,"app-part-creation",0),la(1,l9,29,27,"div",1),fa(2,"div",2),fa(3,"div",3),ga(4,"app-chat",4),pa(),pa()),2&e&&(ha("ngIf",!1===t.gameStarted),ks(1),ha("ngIf",t.gameStarted),ks(3),ha("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[tf,A8,g7,y7,Qd,z8,gC],encapsulation:2}),e})();function d9(e,t){if(1&e&&(fa(0,"option",25),Qa(1),pa()),2&e){const e=t.$implicit;ha("value",e.name),ks(1),Xa(e.name)}}function f9(e,t){if(1&e&&(fa(0,"option",25),sc(1,29),pa()),2&e){const e=t.$implicit;ha("value",e),ks(1),oc(e),ac(1)}}const p9=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function g9(e,t){if(1&e){const e=va();fa(0,"select",26),Ea("ngModelChange",function(t){return Gt(e),Sa(2).aiDepths[0]=t})("change",function(){Gt(e);const t=Sa(2);return t.updatePlayer(t.Player.ZERO)}),fa(1,"option",27),sc(2,28),pa(),la(3,f9,2,2,"option",16),pa()}2&e&&(ha("ngModel",Sa(2).aiDepths[0]),ks(3),ha("ngForOf",wu(2,p9)))}function m9(e,t){if(1&e&&(fa(0,"p",30),sc(1,31),pa()),2&e){const e=Sa(2);ks(1),oc(e.gameComponent.scores.get()[0]),ac(1)}}function y9(e,t){if(1&e&&(fa(0,"option",25),Qa(1),pa()),2&e){const e=t.$implicit;ha("value",e.name),ks(1),Xa(e.name)}}function v9(e,t){if(1&e&&(fa(0,"option",25),sc(1,34),pa()),2&e){const e=t.$implicit;ha("value",e),ks(1),oc(e),ac(1)}}function C9(e,t){if(1&e){const e=va();fa(0,"select",32),Ea("ngModelChange",function(t){return Gt(e),Sa(2).aiDepths[1]=t})("change",function(){Gt(e);const t=Sa(2);return t.updatePlayer(t.Player.ONE)}),fa(1,"option",27),sc(2,33),pa(),la(3,v9,2,2,"option",16),pa()}2&e&&(ha("ngModel",Sa(2).aiDepths[1]),ks(3),ha("ngForOf",wu(2,p9)))}function _9(e,t){if(1&e&&(fa(0,"p",35),sc(1,36),pa()),2&e){const e=Sa(2);ks(1),oc(e.gameComponent.scores.get()[1]),ac(1)}}function E9(e,t){if(1&e&&(fa(0,"h4"),sc(1,40),pa()),2&e){const e=Sa(3);ks(1),oc(e.winner.get()),ac(1)}}function w9(e,t){1&e&&(fa(0,"h4",41),sc(1,42),pa())}function P9(e,t){if(1&e&&(fa(0,"div",37),la(1,E9,2,1,"h4",38),la(2,w9,2,0,"h4",39),pa()),2&e){const e=Sa(2);ks(1),ha("ngIf",e.winner.isPresent()),ks(1),ha("ngIf",e.winner.isAbsent())}}function S9(e,t){if(1&e){const e=va();fa(0,"div",6),fa(1,"div",7),fa(2,"p",8),sc(3,9),pa(),pa(),fa(4,"div",10),fa(5,"div",11),fa(6,"div",12),fa(7,"select",13),Ea("change",function(){Gt(e);const t=Sa();return t.updatePlayer(t.Player.ZERO)})("ngModelChange",function(t){return Gt(e),Sa().playerSelection[0]=t}),fa(8,"option",14),sc(9,15),pa(),la(10,d9,2,2,"option",16),pa(),pa(),fa(11,"div",12),la(12,g9,4,3,"select",17),pa(),la(13,m9,2,1,"p",18),pa(),fa(14,"div",19),fa(15,"div",12),fa(16,"select",20),Ea("change",function(){Gt(e);const t=Sa();return t.updatePlayer(t.Player.ONE)})("ngModelChange",function(t){return Gt(e),Sa().playerSelection[1]=t}),fa(17,"option",14),sc(18,21),pa(),la(19,y9,2,2,"option",16),pa(),pa(),fa(20,"div",12),la(21,C9,4,3,"select",22),pa(),la(22,_9,2,1,"p",23),pa(),pa(),la(23,P9,3,2,"div",24),pa()}if(2&e){const e=Sa();ks(3),oc(e.gameComponent.getTurn()+1),ac(3),ks(4),ha("ngModel",e.playerSelection[0]),ks(3),ha("ngForOf",e.gameComponent.availableMinimaxes),ks(2),ha("ngIf",!1===e.players[0].equalsValue("human")),ks(1),ha("ngIf",e.gameComponent.scores.isPresent()),ks(3),ha("ngModel",e.playerSelection[1]),ks(3),ha("ngForOf",e.gameComponent.availableMinimaxes),ks(2),ha("ngIf",!1===e.players[1].equalsValue("human")),ks(1),ha("ngIf",e.gameComponent.scores.isPresent()),ks(1),ha("ngIf",e.endGame)}}function b9(e,t){if(1&e&&(ma(0),Qa(1),ga(2,"br"),ya()),2&e){const e=t.$implicit,n=Sa(3);ks(1),Ja(" ",e.name+": "+e.getBoardValue(n.gameComponent.rules.node)," ")}}function O9(e,t){if(1&e&&(ma(0),la(1,b9,3,1,"ng-container",48),Qa(2),ga(3,"br"),Qa(4),ga(5,"br"),ya()),2&e){const e=Sa(2);ks(1),ha("ngForOf",e.gameComponent.availableMinimaxes),ks(1),Ja(" Created ",e.getCreatedNodes()," nodes."),ks(2),Ja(" Minimax time: ",e.getMinimaxTime(),"ms.")}}function k9(e,t){if(1&e){const e=va();fa(0,"button",49),Ea("click",function(){return Gt(e),Sa(2).gameComponent.pass()}),sc(1,50),pa()}}function T9(e,t){if(1&e){const e=va();fa(0,"button",51),Ea("click",function(){return Gt(e),Sa(2).takeBack()}),sc(1,52),pa()}}function I9(e,t){if(1&e){const e=va();fa(0,"div",43),la(1,O9,6,3,"ng-container",38),la(2,k9,2,0,"button",44),la(3,T9,2,0,"button",45),fa(4,"button",46),Ea("click",function(){return Gt(e),Sa().restartGame()}),sc(5,47),pa(),pa()}if(2&e){const e=Sa();ks(1),ha("ngIf",e.gameComponent.rules.node.move),ks(1),ha("ngIf",!1===e.endGame&&e.gameComponent.canPass),ks(1),ha("ngIf",e.canTakeBack())}}let A9=(()=>{class e extends G8{constructor(t,n,r,i,s,o){super(t,n,r,i,s),this.cdr=o,this.aiDepths=["0","0"],this.playerSelection=["human","human"],this.winner=Aw.empty(),this.botTimeOut=1e3,this.players=[Aw.of(this.playerSelection[0]),Aw.of(this.playerSelection[1])],this.role=bZ.ZERO,Ow(e.VERBOSE,"LocalGameWrapper.constructor")}getCreatedNodes(){return dj.createdNodes}getMinimaxTime(){return dj.minimaxTime}ngAfterViewInit(){var e=this;setTimeout(Sw(function*(){(yield e.afterGameIncluderViewInit())&&(e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){this.players[e.value]=Aw.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?bZ.ONE:bZ.ZERO),this.proposeAIToPlay()}onLegalUserMove(t){var n=this;return Sw(function*(){Ow(e.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),n.gameComponent.rules.choose(t),n.updateBoard(),n.proposeAIToPlay()})()}updateBoard(){this.gameComponent.updateBoard();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer()&&(this.winner=Aw.of($localize`Player ${e.winner.value+1}`)))}proposeAIToPlay(){var e=this;const t=this.getPlayingAI();t.isPresent()&&window.setTimeout(Sw(function*(){yield e.doAIMove(t.get())}),this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return Aw.empty();const e=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[e]?Aw.empty():Aw.ofNullable(this.gameComponent.availableMinimaxes.find(t=>this.players[e].isPresent()&&this.players[e].get()===t.name))}doAIMove(e){var t=this;return Sw(function*(){const n=t.gameComponent.rules;cZ(n.getGameStatus(n.node)===pj.ONGOING,"AI should not try to play when game is over!");const r=Number.parseInt(t.aiDepths[n.node.gameState.turn%2%2]),i=n.node.findBestMove(r,e,!0);return n.choose(i)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),xw.SUCCESS):(t.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),lZ.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:i.toString()}))})()}canTakeBack(){return this.gameComponent.getTurn()>0}takeBack(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){this.gameComponent.rules.setInitialBoard(),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=Aw.empty(),this.proposeAIToPlay()}getPlayer(){return"human"}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(Cc),ua(Zy),ua(gZ),ua(fC),ua(aZ),ua(Yc))},e.\u0275cmp=Je({type:e,selectors:[["app-local-game-wrapper"]],features:[Go],decls:7,vars:3,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h,d,f;return e=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,t=$localize`Human`,n=$localize`Human`,r=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Pick the level`,a=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,l=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won`,u=$localize`Draw`,h=$localize`Start a new game`,d=$localize`Pass a turn`,f=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],t,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],n,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],r,i,["id","scoreOne",1,"block"],s,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],o,a,["id","scoreZero",1,"block"],l,["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],c,["id","draw"],u,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],h,[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],d,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],f]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"div",1),la(2,S9,24,10,"div",2),la(3,I9,6,3,"div",3),pa(),fa(4,"div",4),fa(5,"div",5),ga(6,"app-game-includer"),pa(),pa(),pa()),2&e&&(ks(2),ha("ngIf",t.gameComponent),ks(1),ha("ngIf",t.gameComponent),ks(1),ha("ngClass",t.getBoardHighlight()))},directives:[tf,Qd,z8,Pg,Rp,hg,Sg,Tg,Jd],encapsulation:2,changeDetection:0}),e})(),M9=(()=>{class e{}return e.STEP_FINISHED=()=>$localize`Step finished!`,e.INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`,e})();function N9(e,t){if(1&e&&(fa(0,"div",20),fa(1,"div",21),sc(2,22),pa(),fa(3,"div",23),Qa(4),pa(),pa()),2&e){const e=Sa();ks(4),Xa(e.currentReason.get())}}function R9(e,t){if(1&e){const e=va();fa(0,"button",24),Ea("click",function(){return Gt(e),Sa().retry()}),sc(1,25),pa()}}function x9(e,t){1&e&&(ma(0),sc(1,30),ya())}function D9(e,t){1&e&&(ma(0),sc(1,31),ya())}function L9(e,t){if(1&e&&la(0,D9,2,0,"ng-container",27),2&e){Sa();const e=ca(5),t=Sa();ha("ngIf",t.stepFinished&&t.stepFinished[t.stepIndex])("ngIfElse",e)}}function F9(e,t){1&e&&(ma(0),sc(1,32),ya())}function U9(e,t){if(1&e){const e=va();fa(0,"button",26),Ea("click",function(){return Gt(e),Sa().next()}),la(1,x9,2,0,"ng-container",27),la(2,L9,1,2,"ng-template",null,28,ju),la(4,F9,2,0,"ng-template",null,29,ju),pa()}if(2&e){const e=ca(3),t=Sa();ks(1),ha("ngIf",t.steps[t.stepIndex]&&t.steps[t.stepIndex].isInformation())("ngIfElse",e)}}function V9(e,t){if(1&e){const e=va();fa(0,"button",33),Ea("click",function(){return Gt(e),Sa().start()}),sc(1,34),pa()}}function B9(e,t){if(1&e){const e=va();fa(0,"button",35),Ea("click",function(){return Gt(e),Sa().playLocally()}),sc(1,36),pa()}}function $9(e,t){if(1&e){const e=va();fa(0,"button",37),Ea("click",function(){return Gt(e),Sa().createGame()}),sc(1,38),pa()}}function z9(e,t){if(1&e){const e=va();fa(0,"button",39),Ea("click",function(){return Gt(e),Sa().showSolution()}),sc(1,40),pa()}}function H9(e,t){if(1&e&&(ma(0),fa(1,"option",42),Qa(2),pa(),ya()),2&e){const e=Sa(),t=e.index,n=e.$implicit;ks(1),ka("id","step_",t,""),ha("value",t),ks(1),Xa(n.title)}}function G9(e,t){1&e&&(ma(0),Qa(1,"v "),ya())}function Z9(e,t){1&e&&Qa(0,"x ")}function q9(e,t){if(1&e&&(fa(0,"option",43),la(1,G9,2,0,"ng-container",27),la(2,Z9,1,0,"ng-template",null,44,ju),fa(4,"span",45),Qa(5),pa(),pa()),2&e){const e=ca(3),t=Sa(),n=t.index,r=t.$implicit,i=Sa();ha("value",n),ks(1),ha("ngIf",i.stepFinished[n])("ngIfElse",e),ks(3),ka("id","step_",n,""),ks(1),Xa(r.title)}}function W9(e,t){if(1&e&&(ma(0),la(1,H9,3,3,"ng-container",27),la(2,q9,6,5,"ng-template",null,41,ju),ya()),2&e){const e=t.index,n=ca(3),r=Sa();ks(1),ha("ngIf",e===r.stepIndex)("ngIfElse",n)}}let j9=(()=>{class e extends G8{constructor(t,n,r,i,s,o){super(t,n,o,r,i),this.cdr=s,this.connectedUserService=o,this.COMPLETED_TUTORIAL_MESSAGE=$localize`Congratulations, you completed the tutorial.`,this.steps=[],this.successfulSteps=0,this.stepIndex=-1,this.currentMessage="",this.currentReason=Aw.empty(),this.moveAttemptMade=!1,this.stepFinished=[],this.tutorialOver=!1,Ow(e.VERBOSE,"TutorialGameWrapperComponent.constructor"),this.role=bZ.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var t=this;return Sw(function*(){Ow(e.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),(yield t.afterGameIncluderViewInit())&&t.start()})()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(t){Ow(e.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:t}}),this.steps=t,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(t){Ow(e.VERBOSE,"tutorialGameWrapperComponent.showStep("+t+")"),this.moveAttemptMade=!1,this.stepFinished[t]=!1,this.updateSuccessCount(),this.stepIndex=t;const n=this.steps[this.stepIndex];let r;if(this.currentMessage=n.instruction,this.currentReason=Aw.empty(),n.previousState.isPresent()){const e=new fj(n.previousState.get());r=Aw.of(e)}else r=Aw.empty();this.gameComponent.rules.node=new fj(n.state,r,n.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}onLegalUserMove(t){var n=this;return Sw(function*(){Ow(e.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:t}});const r=n.steps[n.stepIndex];if(cZ(n.gameComponent.rules.choose(t),"It should be impossible to call onLegalUserMove with an illegal move"),Ow(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),n.gameComponent.updateBoard(),n.moveAttemptMade=!0,r.isPredicate()){const e=n.gameComponent.getPreviousState(),i=n.gameComponent.getState(),s=bw.getNonNullable(r.predicate)(t,e,i);s.isSuccess()?n.showStepSuccess(r.getSuccessMessage()):n.currentReason=Aw.of(s.getReason())}else if(r.isAnyMove())Ow(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),n.showStepSuccess(r.getSuccessMessage());else{cZ(r.isMove(),"cannot reach here with a click step");const i=r;i.acceptedMoves.some(e=>e.equals(t))?(Ow(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),n.showStepSuccess(i.getSuccessMessage())):(Ow(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),n.currentReason=Aw.of(i.getFailureMessage()))}n.cdr.detectChanges()})()}retry(){Ow(e.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}onUserClick(t){if(Ow(e.VERBOSE,"tutorialGameWrapper.onUserClick("+t+")"),this.currentReason=Aw.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return xw.failure(M9.STEP_FINISHED());const n=this.steps[this.stepIndex];return n.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,bw.getNonNullable(n.acceptedClicks).some(e=>e===t)?this.showStepSuccess(n.getSuccessMessage()):this.currentMessage=n.getFailureMessage(),xw.SUCCESS):n.isMove()||n.isPredicate()||n.isAnyMove()?(window.setTimeout(()=>{this.cdr.detectChanges()},10),xw.SUCCESS):xw.failure(M9.INFORMATIONAL_STEP())}onCancelMove(t){Ow(e.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+t+")"),void 0!==t&&(this.currentReason=Aw.of(t)),this.cdr.detectChanges()}showStepSuccess(t){Ow(e.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=t,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const t of this.stepFinished)t&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var t=this;return Sw(function*(){Ow(e.VERBOSE,"tutorialGameWrapper.showSolution()");const n=t.steps[t.stepIndex];cZ(n.hasSolution(),"step must have solution");const r=n,i=r.getSolution();i instanceof oj?(t.showStep(t.stepIndex),t.gameComponent.rules.choose(i),t.gameComponent.updateBoard()):(t.showStep(t.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),t.currentMessage=r.getSuccessMessage(),t.moveAttemptMade=!0,t.cdr.detectChanges()})()}playLocally(){var e=this;return Sw(function*(){const t=bw.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",t])})()}createGame(){var e=this;return Sw(function*(){const t=bw.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",t])})()}getPlayer(){return"tutorial-player"}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(Cc),ua(Zy),ua(fC),ua(aZ),ua(Yc),ua(gZ))},e.\u0275cmp=Je({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[Go],decls:22,vars:15,consts:function(){let e,t,n,r,i,s,o,a,l;return e=$localize`Failure`,t=$localize`Try again`,n=$localize`Ok`,r=$localize`Continue`,i=$localize`Skip`,s=$localize`Try again`,o=$localize`Play locally`,a=$localize`Create an online game`,l=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],e,["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],t,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],n,r,i,["id","restartButton",1,"button",3,"click"],s,["id","playLocallyButton",1,"button",3,"click"],o,["id","playOnlineButton",1,"button",3,"click"],a,["id","showSolutionButton",1,"button",3,"click"],l,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"div",1),fa(2,"div",2),ga(3,"progress",3),fa(4,"div",4),fa(5,"p",5),Qa(6),pa(),ga(7,"p",6),pa(),la(8,N9,5,1,"div",7),fa(9,"div",8),la(10,R9,2,0,"button",9),la(11,U9,6,2,"button",10),la(12,V9,2,0,"button",11),la(13,B9,2,0,"button",12),la(14,$9,2,0,"button",13),la(15,z9,2,0,"button",14),fa(16,"div",15),fa(17,"select",16),Ea("change",function(e){return t.changeStep(e)}),la(18,W9,4,2,"ng-container",17),pa(),pa(),pa(),pa(),pa(),fa(19,"div",18),fa(20,"div",19),ga(21,"app-game-includer"),pa(),pa(),pa()),2&e&&(ks(3),ra("value",t.successfulSteps)("max",t.getNumberOfSteps()),ks(3),tl("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),ks(1),ha("innerHTML",t.currentMessage,vi),ks(1),ha("ngIf",t.currentReason.isPresent()),ks(2),ha("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),ks(1),ha("ngIf",!1===t.tutorialOver),ks(1),ha("ngIf",t.tutorialOver),ks(1),ha("ngIf",t.tutorialOver),ks(1),ha("ngIf",t.tutorialOver),ks(1),ha("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),ks(3),ha("ngForOf",t.steps),ks(1),ha("ngClass",t.getBoardHighlight()))},directives:[tf,Jd,Qd,z8,Sg,Tg],encapsulation:2,changeDetection:0}),e})();function Y9(e,t){if(1&e&&(fa(0,"div",35),fa(1,"div",36),sc(2,37),pa(),fa(3,"div",38),Qa(4),pa(),pa()),2&e){const e=Sa();ks(4),Xa(e.errorMessage)}}const K9=function(){return["/login"]};let Q9=(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.faEye=ZZ,this.registrationForm=new ig({email:new rg,username:new rg,password:new rg})}registerWithEmail(){var e=this;return Sw(function*(){const t=e.registrationForm.value.username,n=e.registrationForm.value.email,r=e.registrationForm.value.password;if(null==t||null==n||null==r)e.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const i=yield e.authService.doRegister(t,n,r);if(i.isSuccess()){const t=yield e.authService.sendEmailVerification();t.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=t.getReason()}else e.errorMessage=i.getReason()}})()}registerWithGoogle(){var e=this;return Sw(function*(){const t=yield e.authService.doGoogleLogin();t.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=t.getReason()})()}getPasswordHelpClass(){const e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}canRegister(){const e=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===e||e.length<6)}}return e.\u0275fac=function(t){return new(t||e)(ua(gZ),ua(fC))},e.\u0275cmp=Je({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h,d,f;return e=$localize`Registering`,t=$localize`Email`,n=$localize`Email`,r=$localize`A confirmation email will be sent to validate your account.`,i=$localize`Username`,s=$localize`Username`,o=$localize`Password`,a=$localize`Password`,l=$localize`The password should be at least 6 characters long`,c=$localize`Register`,u=$localize`Register with Google`,h=$localize`Have an account?`,d=$localize`Log in`,f=$localize`Registration error`,[[1,"box"],[1,"title"],e,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],t,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",n,"type","email","autofocus","","required","",1,"input"],[1,"help"],r,["for","username",1,"label"],i,["id","username","formControlName","username","name","username","placeholder",s,"type","text","required","",1,"input"],["for","password",1,"label"],o,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",a,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],l,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],c,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],u,[1,"help","level-right"],h,[3,"routerLink"],d,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],f,["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"p",1),sc(2,2),pa(),fa(3,"form",3),fa(4,"div",4),fa(5,"div",5),fa(6,"label",6),sc(7,7),pa(),pa(),fa(8,"div",8),fa(9,"div",9),fa(10,"div",10),ga(11,"input",11),fa(12,"p",12),sc(13,13),pa(),pa(),pa(),pa(),pa(),fa(14,"div",4),fa(15,"div",5),fa(16,"label",14),sc(17,15),pa(),pa(),fa(18,"div",8),fa(19,"div",9),fa(20,"div",10),ga(21,"input",16),pa(),pa(),pa(),pa(),fa(22,"div",4),fa(23,"div",5),fa(24,"label",17),sc(25,18),pa(),pa(),fa(26,"div",8),fa(27,"div",9),fa(28,"div",19),ga(29,"input",20),fa(30,"span",21),ga(31,"fa-icon",22),pa(),fa(32,"p",23),sc(33,24),pa(),pa(),pa(),pa(),pa(),fa(34,"div",4),ga(35,"div",5),fa(36,"div",8),fa(37,"div",9),fa(38,"div",10),fa(39,"button",25),Ea("click",function(){return t.registerWithEmail()}),sc(40,26),pa(),pa(),pa(),pa(),pa(),fa(41,"div",4),ga(42,"div",5),fa(43,"div",27),la(44,Y9,5,1,"div",28),pa(),pa(),fa(45,"div",4),ga(46,"div",5),fa(47,"div",8),fa(48,"button",29),Ea("click",function(){return t.registerWithGoogle()}),sc(49,30),pa(),pa(),pa(),fa(50,"p",31),ma(51),sc(52,32),ya(),Qa(53,"\xa0 "),fa(54,"a",33),sc(55,34),pa(),pa(),pa(),pa()),2&e&&(ks(3),ha("formGroup",t.registrationForm),ks(28),ha("icon",t.faEye),ks(1),ha("ngClass",t.getPasswordHelpClass()),ks(7),ha("disabled",!t.canRegister()),ks(5),ha("ngIf",t.errorMessage),ks(10),ha("routerLink",wu(6,K9)))},directives:[dg,xp,vg,rp,Rp,_g,d8,Ag,_W,f8,Qd,tf,mC],encapsulation:2}),e})(),X9=(()=>{class e{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}playLocally(){var e=this;return Sw(function*(){yield e.router.navigate(["local/"+e.selectedGame])})()}}return e.\u0275fac=function(t){return new(t||e)(ua(fC))},e.\u0275cmp=Je({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Play offline`,[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(e,t){1&e&&(fa(0,"app-pick-game",0),Ea("pickGame",function(e){return t.pickGame(e)}),pa(),fa(1,"button",1),Ea("click",function(){return t.playLocally()}),sc(2,2),pa()),2&e&&(ks(1),ha("disabled",!t.selectedGame))},directives:[a8],encapsulation:2}),e})(),J9=(()=>{class e{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}launchTutorial(){var e=this;return Sw(function*(){yield e.router.navigate(["/tutorial/",e.selectedGame])})()}}return e.\u0275fac=function(t){return new(t||e)(ua(fC))},e.\u0275cmp=Je({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(e,t){1&e&&(fa(0,"app-pick-game",0),Ea("pickGame",function(e){return t.pickGame(e)}),pa(),fa(1,"button",1),Ea("click",function(){return t.launchTutorial()}),sc(2,2),pa()),2&e&&(ks(1),ha("disabled",!t.selectedGame))},directives:[a8],encapsulation:2}),e})(),eee=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Je({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let e;return e=$localize`The replay game is loading, please wait, it should not take long.`,[e]},template:function(e,t){1&e&&(fa(0,"p"),sc(1,0),pa())},encapsulation:2}),e})();function tee(e,t){if(1&e&&(_n(),ga(0,"polygon",4)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessQueenComponent.HEPTAGON)}}function nee(e,t){if(1&e&&(_n(),ga(0,"polygon",4)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function ree(e,t){if(1&e&&(_n(),ga(0,"circle",5)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function iee(e,t){if(1&e&&(ma(0),_n(),ga(1,"circle",6),ga(2,"circle",6),ga(3,"circle",6),ya()),2&e){const e=Sa();ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(3)),ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function see(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",7),ga(2,"circle",7),ga(3,"circle",7),pa()),2&e){const e=Sa();ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.45*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),ks(1),ra("cx",.45*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),ks(1),ra("cx",.55*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function oee(e,t){if(1&e&&(_n(),fa(0,"g",8),ga(1,"circle",9),ga(2,"circle",9),ga(3,"circle",9),pa()),2&e){const e=Sa();ha("ngClass",e.pieceClasses),ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE-3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE+3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class aee{constructor(){this.MartianChessQueenComponent=aee,this.MartianChessComponent=t2,this.horizontalDotsRadius=t2.SPACE_SIZE/15}}function lee(e,t){if(1&e&&(_n(),ga(0,"polygon",4)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessDroneComponent.PENTAGON)}}function cee(e,t){if(1&e&&(_n(),ga(0,"polygon",4)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function uee(e,t){if(1&e&&(_n(),ga(0,"circle",5)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function hee(e,t){if(1&e&&(ma(0),_n(),ga(1,"circle",6),ga(2,"circle",6),ya()),2&e){const e=Sa();ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function dee(e,t){if(1&e&&(_n(),fa(0,"g",7),ga(1,"circle",8),ga(2,"circle",8),pa()),2&e){const e=Sa();ha("ngClass",e.pieceClasses),ks(1),ra("cx",.4*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),ks(1),ra("cx",.6*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function fee(e,t){if(1&e&&(_n(),fa(0,"g",7),ga(1,"circle",9),ga(2,"circle",9),pa()),2&e){const e=Sa();ha("ngClass",e.pieceClasses),ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE-2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE+2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}aee.HEPTAGON=t2.getRegularPolygon(7),aee.EIGHT_POINTED_STAR=t2.getNPointedStar(8,0),aee.\u0275fac=function(e){return new(e||aee)},aee.\u0275cmp=Je({type:aee,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(la(0,tee,1,3,"polygon",0),la(1,nee,1,3,"polygon",0),la(2,ree,1,5,"circle",1),la(3,iee,4,9,"ng-container",2),la(4,see,4,9,"g",2),la(5,oee,4,10,"g",3)),2&e&&(ha("ngIf","Polygon"===t.style.shape),ks(1),ha("ngIf","Star"===t.style.shape),ks(1),ha("ngIf","Circle"===t.style.shape),ks(1),ha("ngIf","Concentric Circles"===t.style.points),ks(1),ha("ngIf","Dots"===t.style.points),ks(1),ha("ngIf","Horizontal Points"===t.style.points))},directives:[tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class pee{constructor(){this.MartianChessComponent=t2,this.MartianChessDroneComponent=pee,this.horizontalDotsRadius=t2.SPACE_SIZE/15}}function gee(e,t){if(1&e&&(_n(),ga(0,"polygon",5)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessPawnComponent.TRIANGLE)}}function mee(e,t){if(1&e&&(_n(),ga(0,"polygon",5)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function yee(e,t){if(1&e&&(_n(),ga(0,"circle",6)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function vee(e,t){if(1&e&&(_n(),ga(0,"circle",7)),2&e){const e=Sa();ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE+e.getConcreteTriangleYOffset())("r",e.MartianChessComponent.getRadius(1))}}function Cee(e,t){if(1&e&&(_n(),ga(0,"circle",8)),2&e){const e=Sa();ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function _ee(e,t){if(1&e&&(_n(),fa(0,"g",9),ga(1,"circle",10),pa()),2&e){const e=Sa();ha("ngClass",e.pieceClasses),ks(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}pee.FOUR_POINTED_STAR_VERTICAL=t2.getNPointedStar(4,0),pee.PENTAGON=t2.getRegularPolygon(5),pee.\u0275fac=function(e){return new(e||pee)},pee.\u0275cmp=Je({type:pee,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(la(0,lee,1,3,"polygon",0),la(1,cee,1,3,"polygon",0),la(2,uee,1,5,"circle",1),la(3,hee,3,6,"ng-container",2),la(4,dee,3,7,"g",3),la(5,fee,3,7,"g",3)),2&e&&(ha("ngIf","Polygon"===t.style.shape),ks(1),ha("ngIf","Star"===t.style.shape),ks(1),ha("ngIf","Circle"===t.style.shape),ks(1),ha("ngIf","Concentric Circles"===t.style.points),ks(1),ha("ngIf","Dots"===t.style.points),ks(1),ha("ngIf","Horizontal Points"===t.style.points))},directives:[tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Eee{constructor(){this.MartianChessComponent=t2,this.MartianChessPawnComponent=Eee,this.horizontalDotsRadius=t2.SPACE_SIZE/15}static getTriangle(){return t2.getRegularPolygon(3,Eee.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const e=t2.getRegularPolygonCoords(3).map(e=>e.y);return(e.reduce((e,t)=>Math.min(e,t))+(100-e.reduce((e,t)=>Math.max(e,t))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?Eee.TRIANGLE_Y_OFFSET:0}}Eee.FOUR_POINTED_STAR_DIAGONAL=t2.getNPointedStar(4,45),Eee.TRIANGLE_Y_OFFSET=Eee.yOffsetForVerticalCentering(),Eee.TRIANGLE=Eee.getTriangle(),Eee.\u0275fac=function(e){return new(e||Eee)},Eee.\u0275cmp=Je({type:Eee,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(la(0,gee,1,3,"polygon",0),la(1,mee,1,3,"polygon",0),la(2,yee,1,5,"circle",1),la(3,vee,1,3,"circle",2),la(4,Cee,1,3,"circle",3),la(5,_ee,2,4,"g",4)),2&e&&(ha("ngIf","Polygon"===t.style.shape),ks(1),ha("ngIf","Star"===t.style.shape),ks(1),ha("ngIf","Circle"===t.style.shape),ks(1),ha("ngIf","Concentric Circles"===t.style.points),ks(1),ha("ngIf","Dots"===t.style.points),ks(1),ha("ngIf","Horizontal Points"===t.style.points))},directives:[tf,Qd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});const wee={apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631",appId:"1:936588361631:web:2c059886d8d427edbac7aa"};let Pee=(()=>{class e{constructor(e){this.authService=e}canActivate(){var e=this;return Sw(function*(){return new Promise(t=>{e.userSub=e.authService.subscribeToUser(function(){var n=Sw(function*(n){yield e.evaluateUserPermission(n).then(t)});return function(e){return n.apply(this,arguments)}}())})})()}ngOnDestroy(){this.userSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(Or(gZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),See=(()=>{class e extends Pee{constructor(e,t){super(e),this.router=t}evaluateUserPermission(e){var t=this;return Sw(function*(){return!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account")})()}}return e.\u0275fac=function(t){return new(t||e)(Or(gZ),Or(fC))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function bee(e,t){1&e&&(fa(0,"p",20),sc(1,21),pa())}function Oee(e,t){if(1&e){const e=va();fa(0,"div",7),fa(1,"p",8),sc(2,9),pa(),fa(3,"div",10),fa(4,"p",11),sc(5,12),pa(),fa(6,"button",13),Ea("click",function(){return Gt(e),Sa().finalizeEmailVerification()}),sc(7,14),pa(),pa(),fa(8,"div",15),fa(9,"p",11),sc(10,16),pa(),fa(11,"button",17),Ea("click",function(){return Gt(e),Sa().sendEmailVerification()}),sc(12,18),pa(),pa(),la(13,bee,2,0,"p",19),pa()}if(2&e){const e=Sa();ks(2),oc(e.emailAddress),ac(2),ks(11),ha("ngIf",e.success)}}function kee(e,t){if(1&e){const e=va();fa(0,"div",24),fa(1,"div",8),sc(2,25),pa(),fa(3,"form",26),fa(4,"div",27),fa(5,"div",28),ga(6,"input",29),pa(),fa(7,"div",28),fa(8,"button",30),Ea("click",function(){Gt(e);const t=Sa(2);return t.pickUsername(t.usernameForm.value)}),sc(9,31),pa(),pa(),pa(),pa(),pa()}if(2&e){const e=Sa(2);ks(3),ha("formGroup",e.usernameForm)}}const Tee=function(){return["/lobby"]};function Iee(e,t){1&e&&(fa(0,"div",32),rc(1,33),ga(2,"a",34),ic(),pa()),2&e&&(ks(2),ha("routerLink",wu(1,Tee)))}function Aee(e,t){if(1&e&&(ma(0),la(1,kee,10,1,"div",22),la(2,Iee,3,2,"div",23),ya()),2&e){const e=Sa();ks(1),ha("ngIf",!e.success),ks(1),ha("ngIf",e.success)}}function Mee(e,t){if(1&e&&(fa(0,"div",35),fa(1,"div",36),Qa(2),pa(),pa()),2&e){const e=Sa();ks(2),Xa(e.errorMessage)}}let Nee=(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new ig({username:new rg})}ngOnInit(){var e=this;return Sw(function*(){e.userSub=e.authService.subscribeToUser(function(){var t=Sw(function*(t){e.emailAddress=t.email.get(),t.username.isAbsent()?e.verificationType="enter-username":(e.verificationType="send-email",!0===e.triedToFinalize&&!1===t.verified&&(e.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===t.verified&&(yield e.router.navigate(["/lobby"])))});return function(e){return t.apply(this,arguments)}}())})()}pickUsername(e){var t=this;return Sw(function*(){const n=yield t.authService.setUsername(e.username);n.isSuccess()?t.success=!0:t.errorMessage=n.getReason()})()}sendEmailVerification(){var e=this;return Sw(function*(){const t=yield e.authService.sendEmailVerification();t.isSuccess()?e.success=!0:e.errorMessage=t.getReason()})()}finalizeEmailVerification(){var e=this;return Sw(function*(){e.triedToFinalize=!0,yield e.authService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(ua(gZ),ua(fC))},e.\u0275cmp=Je({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let e,t,n,r,i,s,o,a,l,c,u;return e=$localize`Account verification`,t=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,n=$localize`Once you have verified your email, click on the following button:`,r=$localize`Finalize email verification`,i=$localize`If you have not received the verification email, click on the following button:`,s=$localize`Send verification email again`,o=$localize`The email has been sent`,a=$localize`In order to finalize your account, you must choose a username.`,l=$localize`Username`,c=$localize`Pick username`,u=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],e,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],t,[1,"block","level-left"],[1,"level-item"],n,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],r,[1,"level-left"],i,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],s,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],o,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],a,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",l,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],c,["id","success",1,"message-body"],u,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"div",1),fa(2,"div",2),sc(3,3),pa(),la(4,Oee,14,2,"div",4),la(5,Aee,3,2,"ng-container",5),pa(),la(6,Mee,3,1,"div",6),pa()),2&e&&(ks(4),ha("ngIf","send-email"===t.verificationType),ks(1),ha("ngIf","enter-username"===t.verificationType),ks(1),ha("ngIf",t.errorMessage))},directives:[tf,dg,xp,vg,rp,Ag,Rp,_g,mC],encapsulation:2}),e})(),Ree=(()=>{class e extends Pee{constructor(e,t){super(e),this.router=t}evaluateUserPermission(e){var t=this;return Sw(function*(){return!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/")})()}}return e.\u0275fac=function(t){return new(t||e)(Or(gZ),Or(fC))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),xee=(()=>{class e extends Pee{constructor(e,t){super(e),this.router=t}evaluateUserPermission(e){var t=this;return Sw(function*(){return!1===e.isConnected()||t.router.parseUrl("/")})()}}return e.\u0275fac=function(t){return new(t||e)(Or(gZ),Or(fC))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Dee(e,t){1&e&&(fa(0,"p",12),sc(1,13),pa())}function Lee(e,t){if(1&e&&(fa(0,"div",14),fa(1,"div",15),sc(2,16),pa(),fa(3,"div",17),Qa(4),pa(),pa()),2&e){const e=Sa();ks(4),Xa(e.errorMessage.get())}}const Fee=function(){return{standalone:!0}};let Uee=(()=>{class e{constructor(e){this.authService=e,this.success=!1,this.errorMessage=Aw.empty(),this.email=""}resetPassword(){var e=this;return Sw(function*(){cZ(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=Aw.empty(),e.success=!1;const t=yield e.authService.sendPasswordResetEmail(e.email);t.isSuccess()?e.success=!0:e.errorMessage=Aw.of(t.getReason())})()}}return e.\u0275fac=function(t){return new(t||e)(ua(gZ))},e.\u0275cmp=Je({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){let e,t,n,r,i,s;return e=$localize`Password reset`,t=$localize`Email`,n=$localize`An email will be sent with instruction to reset your password.`,r=$localize`Reset password`,i=$localize`The email has been sent, please follow the instructions from that email.`,s=$localize`Error`,[[1,"box"],[1,"title"],e,[1,"field"],[1,"control"],["id","email","name","email","placeholder",t,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],n,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],r,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],i,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],s,["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"p",1),sc(2,2),pa(),fa(3,"div",3),fa(4,"div",4),fa(5,"input",5),Ea("ngModelChange",function(e){return t.email=e}),pa(),fa(6,"p",6),sc(7,7),pa(),la(8,Dee,2,0,"p",8),pa(),pa(),fa(9,"button",9),Ea("click",function(){return t.resetPassword()}),sc(10,10),pa(),la(11,Lee,5,1,"div",11),pa()),2&e&&(ks(5),ha("ngModel",t.email)("ngModelOptions",wu(5,Fee)),ks(3),ha("ngIf",t.success),ks(1),ha("disabled",""===t.email),ks(2),ha("ngIf",t.errorMessage.isPresent()))},directives:[rp,d8,Ag,Rp,hg,tf],encapsulation:2}),e})();function Vee(e,t){if(1&e&&(fa(0,"option",13),Qa(1),pa()),2&e){const e=t.$implicit,n=Sa();ha("value",e.value)("selected",e.value===n.currentTheme),ks(1),Ja(" ",e.name," ")}}function Bee(e,t){if(1&e&&(fa(0,"option",13),Qa(1),pa()),2&e){const e=t.$implicit,n=Sa();ha("value",e.value)("selected",e.value===n.currentLanguage),ks(1),Ja(" ",e.name," ")}}let $ee=(()=>{class e{constructor(e,t){this.userSettingsService=e,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}],this.currentTheme=t.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}changeTheme(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return e.\u0275fac=function(t){return new(t||e)(ua(BZ),ua($Z))},e.\u0275cmp=Je({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let e,t,n;return e=$localize`User settings`,t=$localize`Theme`,n=$localize`Language`,[[1,"box"],[1,"title"],e,[1,"field"],["for","theme",1,"label"],t,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],n,["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"p",1),sc(2,2),pa(),fa(3,"div",3),fa(4,"label",4),sc(5,5),pa(),fa(6,"div",6),fa(7,"div",7),fa(8,"select",8),Ea("change",function(e){return t.changeTheme(e)}),la(9,Vee,2,3,"option",9),pa(),pa(),pa(),pa(),fa(10,"div",3),fa(11,"label",10),sc(12,11),pa(),fa(13,"div",6),fa(14,"div",7),fa(15,"select",12),Ea("change",function(e){return t.changeLanguage(e)}),la(16,Bee,2,3,"option",9),pa(),pa(),pa(),pa(),pa()),2&e&&(ks(9),ha("ngForOf",t.availableThemes),ks(7),ha("ngForOf",t.availableLanguages))},directives:[Jd,Sg,Tg],encapsulation:2}),e})(),zee=(()=>{class e{}return e.ALREADY_INGAME=()=>$localize`You are already in a game. Finish it or cancel it first.`,e})(),Hee=(()=>{class e{constructor(e,t,n,r,i,s){this.route=e,this.router=t,this.connectedUserService=n,this.messageDisplayer=r,this.activePartsService=i,this.gameService=s}ngOnInit(){var e=this;return Sw(function*(){yield e.createGameAndRedirectOrShowError(e.extractGameFromURL())})()}extractGameFromURL(){return bw.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(e){var t=this;return Sw(function*(){const n=t.connectedUserService.user.get();cZ(n.isConnected(),"User must be connected and have a username to reach this page");const r=n.toMinimalUser();if(!1===t.gameExists(e))return yield t.router.navigate(["/notFound",H8.NO_MATCHING_GAME(e)],{skipLocationChange:!0}),!1;if(yield t.canCreateOnlineGame(r)){const n=yield t.gameService.createPartConfigRoomAndChat(e);return yield t.router.navigate(["/play",e,n]),!0}return t.messageDisplayer.infoMessage(zee.ALREADY_INGAME()),yield t.router.navigate(["/lobby"]),!1})()}gameExists(e){return Aw.ofNullable(o8.ALL_GAMES().find(t=>t.urlName===e)).isPresent()}canCreateOnlineGame(e){var t=this;return Sw(function*(){return!1===(yield t.activePartsService.userHasActivePart(e))})()}}return e.\u0275fac=function(t){return new(t||e)(ua(Zy),ua(fC),ua(gZ),ua(aZ),ua(C8),ua(DZ))},e.\u0275cmp=Je({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let e;return e=$localize`Creating online game, please wait, it should not take long.`,[e]},template:function(e,t){1&e&&(fa(0,"p"),sc(1,0),pa())},encapsulation:2}),e})();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[cl.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),sl[t]=e,n&&(sl[t][cl.ExtraData]=n)}(e,void 0,void 0)}(ww());const Gee=[{path:"login",component:y8},{path:"lobby",component:V8,canActivate:[See]},{path:"settings",component:$ee},{path:"register",component:Q9,canActivate:[xee]},{path:"reset-password",component:Uee,canActivate:[xee]},{path:"notFound/:message",component:B8},{path:"nextGameLoading",component:eee,canActivate:[See]},{path:"verify-account",component:Nee,canActivate:[Ree]},{path:"play",component:_8,canActivate:[See]},{path:"play/:compo",component:Hee,canActivate:[See]},{path:"play/:compo/:id",component:h9,canActivate:[See]},{path:"local",component:X9},{path:"local/:compo",component:A9},{path:"tutorial",component:J9},{path:"tutorial/:compo",component:j9},{path:"",component:h8},{path:"**",component:B8}];class Zee{static app(){return function(e,...t){return{ngModule:CB,providers:[{provide:gB,useFactory:vB(e),multi:!0,deps:[mh,zo,oB,...t]}]}}(()=>_B(wee))}static firestore(){return function(e,...t){return{ngModule:BG,providers:[{provide:LG,useFactory:FG(e),multi:!0,deps:[mh,zo,oB,pB,[new Nr,EG],[new Nr,JB],...t]}]}}(()=>{const e=WG();e.toJSON();return e})}static auth(){return function(e,...t){return{ngModule:OG,providers:[{provide:wG,useFactory:PG(e),multi:!0,deps:[mh,zo,oB,pB,[new Nr,JB],...t]}]}}(()=>{const e=TG();return e})}}let qee=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e,bootstrap:[DW]}),e.\u0275inj=Se({providers:[gZ,DZ,xZ,hZ,iZ,$Z,{provide:ih,useValue:VZ.getLocale()}],imports:[[Zee.app(),Zee.firestore(),Zee.auth(),Hf,Cm,TC.forRoot(Gee,{useHash:!1}),Dg,xg,_w,EW]]}),e})();!function(e,t,n){const r=e.\u0275cmp;r.directiveDefs=()=>t.map(et),r.pipeDefs=()=>n.map(tt)}(t2,[Jd,Qd,tf,Eee,pee,aee],[]);"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self;"undefined"!=typeof global&&global;class Wee{constructor(e){this.digits=e}static zero(){return new Wee([0])}static one(){return new Wee([1])}clone(){return new Wee(this.digits.slice())}add(e){const t=this.clone();return t.addToSelf(e),t}addToSelf(e){const t=Math.max(this.digits.length,e.digits.length);let n=0;for(let r=0;r<t;r++){let t=n;r<this.digits.length&&(t+=this.digits[r]),r<e.digits.length&&(t+=e.digits[r]),t>=10?(this.digits[r]=t-10,n=1):(this.digits[r]=t,n=0)}n>0&&(this.digits[t]=1)}toString(){let e="";for(let t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}class jee{constructor(e){this.powerOfTwos=[e]}getValue(){return this.powerOfTwos[0]}multiplyBy(e){const t=Wee.zero();return this.multiplyByAndAddTo(e,t),t}multiplyByAndAddTo(e,t){for(let n=0;0!==e;e>>>=1,n++)if(1&e){const e=this.getMultipliedByPowerOfTwo(n);t.addToSelf(e)}}getMultipliedByPowerOfTwo(e){for(let t=this.powerOfTwos.length;t<=e;t++){const e=this.powerOfTwos[t-1];this.powerOfTwos[t]=e.add(e)}return this.powerOfTwos[e]}}class Yee{constructor(e){this.base=e,this.exponents=[new jee(Wee.one())]}toThePowerOf(e){for(let t=this.exponents.length;t<=e;t++){const e=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new jee(e)}return this.exponents[e]}}function Kee(e){const t=function(e){let t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){const t=e.charCodeAt(n+1);t>=56320&&t<=57343&&(n++,r=(r-55296<<10)+t-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e);let n=Qee(t,0),r=Qee(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function Qee(e,t){let n,r=2654435769,i=2654435769;const s=e.length;for(n=0;n+12<=s;n+=12){r=ete(r,ite(e,n,Jee.Little)),i=ete(i,ite(e,n+4,Jee.Little));const s=Xee(r,i,t=ete(t,ite(e,n+8,Jee.Little)));r=s[0],i=s[1],t=s[2]}return r=ete(r,ite(e,n,Jee.Little)),i=ete(i,ite(e,n+4,Jee.Little)),t=ete(t,s),Xee(r,i,t=ete(t,ite(e,n+8,Jee.Little)<<8))[2]}function Xee(e,t,n){return e=nte(e,t),e=nte(e,n),e^=n>>>13,t=nte(t,n),t=nte(t,e),t^=e<<8,n=nte(n,e),n=nte(n,t),n^=t>>>13,e=nte(e,t),e=nte(e,n),e^=n>>>12,t=nte(t,n),t=nte(t,e),t^=e<<16,n=nte(n,e),n=nte(n,t),n^=t>>>5,e=nte(e,t),e=nte(e,n),e^=n>>>3,t=nte(t,n),t=nte(t,e),t^=e<<10,n=nte(n,e),n=nte(n,t),[e,t,n^=t>>>15]}var Jee=(()=>((Jee=Jee||{})[Jee.Little=0]="Little",Jee[Jee.Big=1]="Big",Jee))();function ete(e,t){return tte(e,t)[1]}function tte(e,t){const n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function nte(e,t){const n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function rte(e,t){return t>=e.length?0:e[t]}function ite(e,t,n){let r=0;if(n===Jee.Big)for(let i=0;i<4;i++)r+=rte(e,t+i)<<24-8*i;else for(let i=0;i<4;i++)r+=rte(e,t+i)<<8*i;return r}const ste=new Yee(256);function ote(e,t,n,r,i=[]){const s={},o={},a=function(e,t){const{text:n,block:r}=ate(e,t);if(void 0===r)return{text:n};{const[e,...t]=r.split("\u241f"),[i,s]=e.split("@@",2);let[o,a]=i.split("|",2);return void 0===a&&(a=o,o=void 0),""===a&&(a=void 0),{text:n,meaning:o,description:a,customId:s,legacyIds:t}}}(e[0],e.raw[0]),l=[a.text],c=[];let u=a.text;for(let f=1;f<e.length;f++){const{text:n,block:r=lte(f)}=ate(e[f],e.raw[f]);u+=`{$${r}}${n}`,void 0!==t&&(s[r]=t[f-1],o[r]=i[f-1]),c.push(r),l.push(n)}const h=a.customId||function(e,t=""){let n=Kee(e);if(t){const e=Kee(t);n=function(e,t){const n=e[0],r=t[0],i=tte(e[1],t[1]),s=i[0],o=i[1];return[ete(ete(n,r),s),o]}(function(e,t){const n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),e)}return function(e,t){const n=ste.toThePowerOf(0).multiplyBy(t);return ste.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(u,a.meaning||""),d=a.legacyIds?a.legacyIds.filter(e=>e!==h):[];return{id:h,legacyIds:d,substitutions:s,substitutionLocations:o,text:u,customId:a.customId,meaning:a.meaning||"",description:a.description||"",messageParts:l,messagePartLocations:r,placeholderNames:c,location:n}}function ate(e,t){if(":"!==t.charAt(0))return{text:e};{const n=function(e,t){for(let n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error(`Unterminated $localize metadata block in "${t}".`)}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}}function lte(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});class cte extends Error{constructor(e){super(`No translation found for ${hte(e)}.`),this.parsedMessage=e,this.type="MissingTranslationError"}}function ute(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function hte(e){const t=e.meaning&&` - "${e.meaning}"`,n=e.legacyIds&&e.legacyIds.length>0?` [${e.legacyIds.map(e=>`"${e}"`).join(", ")}]`:"";return`"${e.id}"${n} ("${e.text}"${t})`}function dte(e,t){try{return function(e,t,n){const r=ote(t,n);let i=e[r.id];if(void 0!==r.legacyIds)for(let s=0;s<r.legacyIds.length&&void 0===i;s++)i=e[r.legacyIds[s]];if(void 0===i)throw new cte(r);return[i.messageParts,i.placeholderNames.map(e=>{if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${hte(r)}.\nThe translation contains a placeholder with name ${e}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function fte(){(function(){if(Th)throw new Error("Cannot enable prod mode after platform setup.");kh=!1})(),$f().bootstrapModule(qee).catch(e=>console.error(e))}const pte=VZ.getLocale();"en"!==pte?fetch("/assets/"+pte+".json").then(e=>e.ok?e.json():{locale:"en",translations:{}}).then(e=>{(function(e){$localize.translate||($localize.translate=dte),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(t=>{$localize.TRANSLATIONS[t]=function(e){const t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[];for(let s=1;s<t.length-1;s+=2)r.push(t[s]),n.push(`${t[s+1]}`);const i=n.map(e=>":"===e.charAt(0)?"\\"+e:e);return{text:e,messageParts:ute(n,i),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,fte()}).catch(function(e){console.log(e)}):fte()}},function(e){e(e.s=2791)}]);